<!DOCTYPE html>
<html lang="en-US" class="no-js ">
<head><meta charset="UTF-8"><script>if(navigator.userAgent.match(/MSIE|Internet Explorer/i)||navigator.userAgent.match(/Trident\/7\..*?rv:11/i)){var href=document.location.href;if(!href.match(/[?&]nowprocket/)){if(href.indexOf("?")==-1){if(href.indexOf("#")==-1){document.location.href=href+"?nowprocket=1"}else{document.location.href=href.replace("#","?nowprocket=1#")}}else{if(href.indexOf("#")==-1){document.location.href=href+"&nowprocket=1"}else{document.location.href=href.replace("#","&nowprocket=1#")}}}}</script><script>(()=>{class RocketLazyLoadScripts{constructor(){this.v="1.2.6",this.triggerEvents=["keydown","mousedown","mousemove","touchmove","touchstart","touchend","wheel"],this.userEventHandler=this.t.bind(this),this.touchStartHandler=this.i.bind(this),this.touchMoveHandler=this.o.bind(this),this.touchEndHandler=this.h.bind(this),this.clickHandler=this.u.bind(this),this.interceptedClicks=[],this.interceptedClickListeners=[],this.l(this),window.addEventListener("pageshow",(t=>{this.persisted=t.persisted,this.everythingLoaded&&this.m()})),this.CSPIssue=sessionStorage.getItem("rocketCSPIssue"),document.addEventListener("securitypolicyviolation",(t=>{this.CSPIssue||"script-src-elem"!==t.violatedDirective||"data"!==t.blockedURI||(this.CSPIssue=!0,sessionStorage.setItem("rocketCSPIssue",!0))})),document.addEventListener("DOMContentLoaded",(()=>{this.k()})),this.delayedScripts={normal:[],async:[],defer:[]},this.trash=[],this.allJQueries=[]}p(t){document.hidden?t.t():(this.triggerEvents.forEach((e=>window.addEventListener(e,t.userEventHandler,{passive:!0}))),window.addEventListener("touchstart",t.touchStartHandler,{passive:!0}),window.addEventListener("mousedown",t.touchStartHandler),document.addEventListener("visibilitychange",t.userEventHandler))}_(){this.triggerEvents.forEach((t=>window.removeEventListener(t,this.userEventHandler,{passive:!0}))),document.removeEventListener("visibilitychange",this.userEventHandler)}i(t){"HTML"!==t.target.tagName&&(window.addEventListener("touchend",this.touchEndHandler),window.addEventListener("mouseup",this.touchEndHandler),window.addEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.addEventListener("mousemove",this.touchMoveHandler),t.target.addEventListener("click",this.clickHandler),this.L(t.target,!0),this.S(t.target,"onclick","rocket-onclick"),this.C())}o(t){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler),t.target.removeEventListener("click",this.clickHandler),this.L(t.target,!1),this.S(t.target,"rocket-onclick","onclick"),this.M()}h(){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler)}u(t){t.target.removeEventListener("click",this.clickHandler),this.L(t.target,!1),this.S(t.target,"rocket-onclick","onclick"),this.interceptedClicks.push(t),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.M()}O(){window.removeEventListener("touchstart",this.touchStartHandler,{passive:!0}),window.removeEventListener("mousedown",this.touchStartHandler),this.interceptedClicks.forEach((t=>{t.target.dispatchEvent(new MouseEvent("click",{view:t.view,bubbles:!0,cancelable:!0}))}))}l(t){EventTarget.prototype.addEventListenerWPRocketBase=EventTarget.prototype.addEventListener,EventTarget.prototype.addEventListener=function(e,i,o){"click"!==e||t.windowLoaded||i===t.clickHandler||t.interceptedClickListeners.push({target:this,func:i,options:o}),(this||window).addEventListenerWPRocketBase(e,i,o)}}L(t,e){this.interceptedClickListeners.forEach((i=>{i.target===t&&(e?t.removeEventListener("click",i.func,i.options):t.addEventListener("click",i.func,i.options))})),t.parentNode!==document.documentElement&&this.L(t.parentNode,e)}D(){return new Promise((t=>{this.P?this.M=t:t()}))}C(){this.P=!0}M(){this.P=!1}S(t,e,i){t.hasAttribute&&t.hasAttribute(e)&&(event.target.setAttribute(i,event.target.getAttribute(e)),event.target.removeAttribute(e))}t(){this._(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.R.bind(this)):this.R()}k(){let t=[];document.querySelectorAll("script[type=rocketlazyloadscript][data-rocket-src]").forEach((e=>{let i=e.getAttribute("data-rocket-src");if(i&&!i.startsWith("data:")){0===i.indexOf("//")&&(i=location.protocol+i);try{const o=new URL(i).origin;o!==location.origin&&t.push({src:o,crossOrigin:e.crossOrigin||"module"===e.getAttribute("data-rocket-type")})}catch(t){}}})),t=[...new Map(t.map((t=>[JSON.stringify(t),t]))).values()],this.T(t,"preconnect")}async R(){this.lastBreath=Date.now(),this.j(this),this.F(this),this.I(),this.W(),this.q(),await this.A(this.delayedScripts.normal),await this.A(this.delayedScripts.defer),await this.A(this.delayedScripts.async);try{await this.U(),await this.H(this),await this.J()}catch(t){console.error(t)}window.dispatchEvent(new Event("rocket-allScriptsLoaded")),this.everythingLoaded=!0,this.D().then((()=>{this.O()})),this.N()}W(){document.querySelectorAll("script[type=rocketlazyloadscript]").forEach((t=>{t.hasAttribute("data-rocket-src")?t.hasAttribute("async")&&!1!==t.async?this.delayedScripts.async.push(t):t.hasAttribute("defer")&&!1!==t.defer||"module"===t.getAttribute("data-rocket-type")?this.delayedScripts.defer.push(t):this.delayedScripts.normal.push(t):this.delayedScripts.normal.push(t)}))}async B(t){if(await this.G(),!0!==t.noModule||!("noModule"in HTMLScriptElement.prototype))return new Promise((e=>{let i;function o(){(i||t).setAttribute("data-rocket-status","executed"),e()}try{if(navigator.userAgent.indexOf("Firefox/")>0||""===navigator.vendor||this.CSPIssue)i=document.createElement("script"),[...t.attributes].forEach((t=>{let e=t.nodeName;"type"!==e&&("data-rocket-type"===e&&(e="type"),"data-rocket-src"===e&&(e="src"),i.setAttribute(e,t.nodeValue))})),t.text&&(i.text=t.text),i.hasAttribute("src")?(i.addEventListener("load",o),i.addEventListener("error",(function(){i.setAttribute("data-rocket-status","failed-network"),e()})),setTimeout((()=>{i.isConnected||e()}),1)):(i.text=t.text,o()),t.parentNode.replaceChild(i,t);else{const i=t.getAttribute("data-rocket-type"),s=t.getAttribute("data-rocket-src");i?(t.type=i,t.removeAttribute("data-rocket-type")):t.removeAttribute("type"),t.addEventListener("load",o),t.addEventListener("error",(i=>{this.CSPIssue&&i.target.src.startsWith("data:")?(console.log("WPRocket: data-uri blocked by CSP -> fallback"),t.removeAttribute("src"),this.B(t).then(e)):(t.setAttribute("data-rocket-status","failed-network"),e())})),s?(t.removeAttribute("data-rocket-src"),t.src=s):t.src="data:text/javascript;base64,"+window.btoa(unescape(encodeURIComponent(t.text)))}}catch(i){t.setAttribute("data-rocket-status","failed-transform"),e()}}));t.setAttribute("data-rocket-status","skipped")}async A(t){const e=t.shift();return e&&e.isConnected?(await this.B(e),this.A(t)):Promise.resolve()}q(){this.T([...this.delayedScripts.normal,...this.delayedScripts.defer,...this.delayedScripts.async],"preload")}T(t,e){var i=document.createDocumentFragment();t.forEach((t=>{const o=t.getAttribute&&t.getAttribute("data-rocket-src")||t.src;if(o&&!o.startsWith("data:")){const s=document.createElement("link");s.href=o,s.rel=e,"preconnect"!==e&&(s.as="script"),t.getAttribute&&"module"===t.getAttribute("data-rocket-type")&&(s.crossOrigin=!0),t.crossOrigin&&(s.crossOrigin=t.crossOrigin),t.integrity&&(s.integrity=t.integrity),i.appendChild(s),this.trash.push(s)}})),document.head.appendChild(i)}j(t){let e={};function i(i,o){return e[o].eventsToRewrite.indexOf(i)>=0&&!t.everythingLoaded?"rocket-"+i:i}function o(t,o){!function(t){e[t]||(e[t]={originalFunctions:{add:t.addEventListener,remove:t.removeEventListener},eventsToRewrite:[]},t.addEventListener=function(){arguments[0]=i(arguments[0],t),e[t].originalFunctions.add.apply(t,arguments)},t.removeEventListener=function(){arguments[0]=i(arguments[0],t),e[t].originalFunctions.remove.apply(t,arguments)})}(t),e[t].eventsToRewrite.push(o)}function s(e,i){let o=e[i];e[i]=null,Object.defineProperty(e,i,{get:()=>o||function(){},set(s){t.everythingLoaded?o=s:e["rocket"+i]=o=s}})}o(document,"DOMContentLoaded"),o(window,"DOMContentLoaded"),o(window,"load"),o(window,"pageshow"),o(document,"readystatechange"),s(document,"onreadystatechange"),s(window,"onload"),s(window,"onpageshow");try{Object.defineProperty(document,"readyState",{get:()=>t.rocketReadyState,set(e){t.rocketReadyState=e},configurable:!0}),document.readyState="loading"}catch(t){console.log("WPRocket DJE readyState conflict, bypassing")}}F(t){let e;function i(e){return t.everythingLoaded?e:e.split(" ").map((t=>"load"===t||0===t.indexOf("load.")?"rocket-jquery-load":t)).join(" ")}function o(o){function s(t){const e=o.fn[t];o.fn[t]=o.fn.init.prototype[t]=function(){return this[0]===window&&("string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=i(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach((t=>{const e=arguments[0][t];delete arguments[0][t],arguments[0][i(t)]=e}))),e.apply(this,arguments),this}}o&&o.fn&&!t.allJQueries.includes(o)&&(o.fn.ready=o.fn.init.prototype.ready=function(e){return t.domReadyFired?e.bind(document)(o):document.addEventListener("rocket-DOMContentLoaded",(()=>e.bind(document)(o))),o([])},s("on"),s("one"),t.allJQueries.push(o)),e=o}o(window.jQuery),Object.defineProperty(window,"jQuery",{get:()=>e,set(t){o(t)}})}async H(t){const e=document.querySelector("script[data-webpack]");e&&(await async function(){return new Promise((t=>{e.addEventListener("load",t),e.addEventListener("error",t)}))}(),await t.K(),await t.H(t))}async U(){this.domReadyFired=!0;try{document.readyState="interactive"}catch(t){}await this.G(),document.dispatchEvent(new Event("rocket-readystatechange")),await this.G(),document.rocketonreadystatechange&&document.rocketonreadystatechange(),await this.G(),document.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this.G(),window.dispatchEvent(new Event("rocket-DOMContentLoaded"))}async J(){try{document.readyState="complete"}catch(t){}await this.G(),document.dispatchEvent(new Event("rocket-readystatechange")),await this.G(),document.rocketonreadystatechange&&document.rocketonreadystatechange(),await this.G(),window.dispatchEvent(new Event("rocket-load")),await this.G(),window.rocketonload&&window.rocketonload(),await this.G(),this.allJQueries.forEach((t=>t(window).trigger("rocket-jquery-load"))),await this.G();const t=new Event("rocket-pageshow");t.persisted=this.persisted,window.dispatchEvent(t),await this.G(),window.rocketonpageshow&&window.rocketonpageshow({persisted:this.persisted}),this.windowLoaded=!0}m(){document.onreadystatechange&&document.onreadystatechange(),window.onload&&window.onload(),window.onpageshow&&window.onpageshow({persisted:this.persisted})}I(){const t=new Map;document.write=document.writeln=function(e){const i=document.currentScript;i||console.error("WPRocket unable to document.write this: "+e);const o=document.createRange(),s=i.parentElement;let n=t.get(i);void 0===n&&(n=i.nextSibling,t.set(i,n));const c=document.createDocumentFragment();o.setStart(c,0),c.appendChild(o.createContextualFragment(e)),s.insertBefore(c,n)}}async G(){Date.now()-this.lastBreath>45&&(await this.K(),this.lastBreath=Date.now())}async K(){return document.hidden?new Promise((t=>setTimeout(t))):new Promise((t=>requestAnimationFrame(t)))}N(){this.trash.forEach((t=>t.remove()))}static run(){const t=new RocketLazyLoadScripts;t.p(t)}}RocketLazyLoadScripts.run()})();</script>
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<script>
var gform;gform||(document.addEventListener("gform_main_scripts_loaded",function(){gform.scriptsLoaded=!0}),window.addEventListener("DOMContentLoaded",function(){gform.domLoaded=!0}),gform={domLoaded:!1,scriptsLoaded:!1,initializeOnLoaded:function(o){gform.domLoaded&&gform.scriptsLoaded?o():!gform.domLoaded&&gform.scriptsLoaded?window.addEventListener("DOMContentLoaded",o):document.addEventListener("gform_main_scripts_loaded",o)},hooks:{action:{},filter:{}},addAction:function(o,n,r,t){gform.addHook("action",o,n,r,t)},addFilter:function(o,n,r,t){gform.addHook("filter",o,n,r,t)},doAction:function(o){gform.doHook("action",o,arguments)},applyFilters:function(o){return gform.doHook("filter",o,arguments)},removeAction:function(o,n){gform.removeHook("action",o,n)},removeFilter:function(o,n,r){gform.removeHook("filter",o,n,r)},addHook:function(o,n,r,t,i){null==gform.hooks[o][n]&&(gform.hooks[o][n]=[]);var e=gform.hooks[o][n];null==i&&(i=n+"_"+e.length),gform.hooks[o][n].push({tag:i,callable:r,priority:t=null==t?10:t})},doHook:function(n,o,r){var t;if(r=Array.prototype.slice.call(r,1),null!=gform.hooks[n][o]&&((o=gform.hooks[n][o]).sort(function(o,n){return o.priority-n.priority}),o.forEach(function(o){"function"!=typeof(t=o.callable)&&(t=window[t]),"action"==n?t.apply(null,r):r[0]=t.apply(null,r)})),"filter"==n)return r[0]},removeHook:function(o,n,t,i){var r;null!=gform.hooks[o][n]&&(r=(r=gform.hooks[o][n]).filter(function(o,n,r){return!!(null!=i&&i!=o.tag||null!=t&&t!=o.priority)}),gform.hooks[o][n]=r)}});
</script>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
	<meta name="format-detection" content="telephone=no">
	<script type="rocketlazyloadscript">document.documentElement.className = document.documentElement.className.replace("no-js","js");</script>
	
	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://harfanglab.io/insidethelab/unpacking-packxor/" />
<link rel="alternate" hreflang="x-default" href="https://harfanglab.io/insidethelab/unpacking-packxor/" />
<link rel="shortcut icon" type="image/x-icon" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.ico" />
<link rel="shortcut icon" type="image/png" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.png" />
<link rel="icon" type="image/x-icon" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.ico" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.4 (Yoast SEO v23.4) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Unpacking the unpleasant FIN7 gift: PackXOR</title>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/basementgrotesqueblack-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/prestigeelitestd-bd-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/prestigeelitestd-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/proximanovabold-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/proximanovaregular-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/helveticaneue-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/icons/harfanglab.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/icons/harfanglab.ttf" crossorigin>
	<link rel="canonical" href="https://harfanglab.io/insidethelab/unpacking-packxor/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Unpacking the unpleasant FIN7 gift: PackXOR" />
	<meta property="og:description" content="Summary In early July 2024, the Sentinel Labs researchers released an extensive article1 about &#8220;FIN7 reboot&#8221; tooling, notably introducing &#8220;AvNeutralizer&#8221;, an anti-EDR tool. This tool has been found in the wild as a packed payload. In this article, we offer a thorough analysis of the associated private packer that we named &#8220;PackXOR&#8221;, as well as [&hellip;]" />
	<meta property="og:url" content="https://harfanglab.io/insidethelab/unpacking-packxor/" />
	<meta property="og:site_name" content="HarfangLab | Your endpoints, our protection" />
	<meta property="article:modified_time" content="2024-10-11T09:34:53+00:00" />
	<meta property="og:image" content="https://harfanglab.io/medias/2024/09/image.png" />
	<meta property="og:image:width" content="1456" />
	<meta property="og:image:height" content="816" />
	<meta property="og:image:type" content="image/png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@harfanglab" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://harfanglab.io/insidethelab/unpacking-packxor/","url":"https://harfanglab.io/insidethelab/unpacking-packxor/","name":"Unpacking the unpleasant FIN7 gift: PackXOR","isPartOf":{"@id":"https://harfanglab.io/#website"},"primaryImageOfPage":{"@id":"https://harfanglab.io/insidethelab/unpacking-packxor/#primaryimage"},"image":{"@id":"https://harfanglab.io/insidethelab/unpacking-packxor/#primaryimage"},"thumbnailUrl":"https://harfanglab.io/medias/2024/09/image.png","datePublished":"2024-09-04T14:02:09+00:00","dateModified":"2024-10-11T09:34:53+00:00","breadcrumb":{"@id":"https://harfanglab.io/insidethelab/unpacking-packxor/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://harfanglab.io/insidethelab/unpacking-packxor/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://harfanglab.io/insidethelab/unpacking-packxor/#primaryimage","url":"https://harfanglab.io/medias/2024/09/image.png","contentUrl":"https://harfanglab.io/medias/2024/09/image.png","width":1456,"height":816,"caption":"Header image for PackXor"},{"@type":"BreadcrumbList","@id":"https://harfanglab.io/insidethelab/unpacking-packxor/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://harfanglab.io/"},{"@type":"ListItem","position":2,"name":"Inside","item":"https://harfanglab.io/insidethelab/"},{"@type":"ListItem","position":3,"name":"Unpacking the unpleasant FIN7 gift: PackXOR"}]},{"@type":"WebSite","@id":"https://harfanglab.io/#website","url":"https://harfanglab.io/","name":"HarfangLab","description":"Empower your analysts, overcome the threats","publisher":{"@id":"https://harfanglab.io/#organization"},"alternateName":"HarfangLab","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://harfanglab.io/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://harfanglab.io/#organization","name":"HarfangLab","alternateName":"harfangLab","url":"https://harfanglab.io/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://harfanglab.io/#/schema/logo/image/","url":"https://harfanglab.io/medias/2023/09/logo-harfanglab-1.svg","contentUrl":"https://harfanglab.io/medias/2023/09/logo-harfanglab-1.svg","width":650,"height":187,"caption":"HarfangLab"},"image":{"@id":"https://harfanglab.io/#/schema/logo/image/"},"sameAs":["https://x.com/harfanglab","https://www.linkedin.com/company/harfanglab"]}]}</script>
	<!-- / Yoast SEO Premium plugin. -->


<link rel='dns-prefetch' href='//js.chilipiper.com' />

<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<link rel='stylesheet' id='harfanglab-styles-css' href='https://harfanglab.io/files/themes/harfangLab/assets/css/styles.min.css?ver=1.5.4' media='all' />
<style id='rocket-lazyload-inline-css'>
.rll-youtube-player{position:relative;padding-bottom:56.23%;height:0;overflow:hidden;max-width:100%;}.rll-youtube-player:focus-within{outline: 2px solid currentColor;outline-offset: 5px;}.rll-youtube-player iframe{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background:0 0}.rll-youtube-player img{bottom:0;display:block;left:0;margin:auto;max-width:100%;width:100%;position:absolute;right:0;top:0;border:none;height:auto;-webkit-transition:.4s all;-moz-transition:.4s all;transition:.4s all}.rll-youtube-player img:hover{-webkit-filter:brightness(75%)}.rll-youtube-player .play{height:100%;width:100%;left:0;top:0;position:absolute;background:url(/files/plugins/wp-rocket/assets/img/youtube.png) no-repeat center;background-color: transparent !important;cursor:pointer;border:none;}
</style>
<script id="wpml-cookie-js-extra">
var wpml_cookies = {"wp-wpml_current_language":{"value":"en","expires":1,"path":"\/"}};
var wpml_cookies = {"wp-wpml_current_language":{"value":"en","expires":1,"path":"\/"}};
</script>
<script type="rocketlazyloadscript" data-rocket-src="/files/plugins/sitepress-multilingual-cms/res/js/cookies/language-cookie.js?ver=4.6.13" id="wpml-cookie-js" defer data-wp-strategy="defer"></script>
<script type="rocketlazyloadscript" data-rocket-src="https://js.chilipiper.com/marketing.js?ver=1.5.4" id="chilipiper-js" data-rocket-defer defer></script>
<script src="https://harfanglab.io/files/themes/harfangLab/assets/js/init.min.js?ver=1.5.4" id="jquery-js"></script>
<meta name="generator" content="WPML ver:4.6.13 stt:1,4,3;" />
<link rel="icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-32x32.png" sizes="32x32" />
<link rel="icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-180x180.png" />
<meta name="msapplication-TileImage" content="https://harfanglab.io/medias/2024/09/cropped-square-company-270x270.png" />
<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>
	<script type="rocketlazyloadscript" data-rocket-type="text/javascript"><!-- Hotjar Tracking Code for https://www.harfanglab.io --> <script>     (function(h,o,t,j,a,r){         h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};         h._hjSettings={hjid:3792786,hjsv:6};         a=o.getElementsByTagName('head')[0];         r=o.createElement('script');r.async=1;         r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;         a.appendChild(r);     })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv='); </script></script></head>
<body class="inside-template-default single single-inside postid-128863 " >
			<div class="progress fixed-top js_scrollProgress">
		<div class="progress-bar" role="progressbar" aria-label="progressbar" style="0" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
	</div>
		<div id="main-wrapper">
		<header id="main-header" class="sticky">
			<nav id="main-top" class="navbar navbar-top">
				<div class="container">
					<a href="https://harfanglab.io/" class="navbar-brand">
						<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
					</a>
				</div>
			</nav>
			<nav id="main-navbar" class="navbar navbar-expand-lg not-sticky">
				<div class="border-decoration"></div>
				<div class="container">
					<a href="https://harfanglab.io/" class="navbar-brand">
						<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
					</a>
					<button type="button" data-bs-toggle="offcanvas" data-bs-target="#navOffcanvas" class="navbar-toggler collapsed">
    <div class="icons">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </div>
    <span class="visually-hidden-focusable label">
        <span>Menu</span>
        <span class="status">
            <span class="closed">Open</span>
            <span class="opened">Close</span>
        </span>
    </span>
</button>										<section id="navOffcanvas" class="navbar-collapse collapse js_navOffcanvas" tabindex="-1" data-bs-scroll="false" data-bs-backdrop="false">
						<div class="wrapper">
						<a href="https://harfanglab.io/" class="navbar-brand navbar-brand--mobile">
							<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab-mobile.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
						</a>
						<ul id="menu-main-menu-anglais" class="navbar-nav"><li id="menu-item-128780" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-128780"><a href="https://harfanglab.io/connectors/"><div class="menu-item-wrapper"><span class="menu-item-name">Solutions</span></div></a>
<ul class="sub-menu">
	<li id="menu-item-129366" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129366"><a href="https://harfanglab.io/edr/"><div class="menu-item-wrapper"><span class="menu-item-name">EDR</span></div></a></li>
	<li id="menu-item-129365" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129365"><a href="https://harfanglab.io/epp/"><div class="menu-item-wrapper"><span class="menu-item-name">EPP</span></div></a></li>
	<li id="menu-item-128781" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-128781"><a href="https://harfanglab.io/connectors/"><div class="menu-item-wrapper"><span class="menu-item-name">Connectors</span></div></a></li>
</ul>
</li>
<li id="menu-item-129367" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129367"><a href="https://harfanglab.io/plans/"><div class="menu-item-wrapper"><span class="menu-item-name">Plans</span></div></a></li>
<li id="menu-item-127507" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-127507"><a href="https://harfanglab.io/cybersecurity-case-studies/"><div class="menu-item-wrapper"><span class="menu-item-name">Case Studies</span></div></a></li>
<li id="menu-item-24691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24691"><a href="https://harfanglab.io/partners/"><div class="menu-item-wrapper"><span class="menu-item-name">Partners</span></div></a></li>
<li id="menu-item-24692" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-has-children menu-item-24692"><a href="https://harfanglab.io/blog/"><div class="menu-item-wrapper"><span class="menu-item-name">Resources</span></div></a>
<ul class="sub-menu">
	<li id="menu-item-24693" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24693"><a href="https://harfanglab.io/blog/"><div class="menu-item-wrapper"><span class="menu-item-name">HarfangLab – The Blog</span></div></a></li>
	<li id="menu-item-24694" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24694"><a href="https://harfanglab.io/insidethelab/"><div class="menu-item-wrapper"><span class="menu-item-name">Inside The Lab – The blog</span></div></a></li>
	<li id="menu-item-130132" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-130132"><a href="https://harfanglab.io/edr-mitre/"><div class="menu-item-wrapper"><span class="menu-item-name">EDR &#038; MITRE ATT&#038;CK</span></div></a></li>
	<li id="menu-item-130135" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-130135"><a href="https://harfanglab.io/cyber-attacks-types/"><div class="menu-item-wrapper"><span class="menu-item-name">Types of cyber attacks</span></div></a></li>
</ul>
</li>
</ul><ul id="menu-aside-menu-anglais" class="navbar-nav"><li id="menu-item-24696" class="btn-highlighted menu-item menu-item-type-post_type menu-item-object-page menu-item-24696"><a href="https://harfanglab.io/ask-demo/"><div class="menu-item-wrapper"><span class="menu-item-name">Request a demo</span></div><strong class="decoration-arrow-btn"><i  class="icon icon-arrow-btn"></i></strong></a></li>
</ul>						<nav class="socials">
    <p>Follow us on :</p>
    <ul>
            <li>
            <a href="https://x.com/harfanglab" class="social --twitter" target="_blank" rel="noreferrer" aria-label="twitter">
                <i class="social-icon-twitter icon-twitter">twitter</i>    
            </a>
        </li>
            <li>
            <a href="https://www.linkedin.com/company/harfanglab" class="social --linkedin" target="_blank" rel="noreferrer" aria-label="linkedin">
                <i class="social-icon-linkedin icon-linkedin">linkedin</i>    
            </a>
        </li>
        </ul>
</nav>
						</div>
					</section>
									</div>
			</nav>
		</header>
		<!-- <aside class="languages-selector languages-count-3">
    <div class="switch">
                    <a href="https://harfanglab.io/insidethelab/unpacking-packxor/" class="language active" title="English">
                <span>en</span>
            </a>
                    <a href="https://harfanglab.io/fr/" class="language " title="Français">
                <span>fr</span>
            </a>
                    <a href="https://harfanglab.io/de/" class="language " title="Deutsch">
                <span>de</span>
            </a>
          	</div>
</aside>
 -->

<aside class="languages-selector languages-count-3">
    <a href="https://harfanglab.io/insidethelab/unpacking-packxor/" class="language active" title="English"><span>en</span></a>    <div class="switch">
              </div>
</aside>

		<!-- /header#main-header -->
		<main id="main-content" role="main">
		<section id="main-hero" class="page-part page-part--hero --single --single--inside --has-illustration js_ScrollVisibility">
    <div class="inner">
        <div class="inner-pattern">
            <div class="container">
                <div class="wrapper">
                    <div class="card-decoration">
                        <span class="arrow-section">
                            <i class="arrow-big"></i>
                            <i class="arrow-big"></i>
                            <i class="arrow-big large"></i>
                        </span>
                        <span class="arrow-section arrow-section--reverse">
                            <i class="arrow-big large"></i>
                            <i class="arrow-big"></i>
                            <i class="arrow-big"></i>
                        </span>
                    </div>
                    <section class="hero-body  card--color-purple">
                        <a href="https://harfanglab.io/insidethelab/" class="archive--link archive-inside--link">
                <img width="202" height="99" src="https://harfanglab.io/medias/2023/12/logo_itb_purple.svg" alt="">
            </a>
            <!-- <span class="badge-group badge-group--lg"> -->
                                    <span class="badge-group badge-group--lg category--cyber-threat-intelligence-en">
                    CYBER THREAT INTELLIGENCE                </span>
                        <!-- </span> -->
                <h1 class="hero-title">Unpacking the unpleasant FIN7 gift: PackXOR</h1>    
        <section class="hero-details">
        <div class="single-dates">
            <time class="single-date single-date--published" datetime="2024-09-04T16:02:09+02:00" itemprop="datePublished">
                Published on 4 September, 2024            </time>
            <span class="badge-group-item">
                 14 min            </span>
        </div>
    </section>
    </section>

<figure class="hero-featured">
    
			<picture class="no-lazy img-fluid full featured-picture">
											<source srcset="https://harfanglab.io/medias/2024/09/image.png 1x ,https://harfanglab.io/medias/2024/09/image.png 2x " 
				width="1456" height="816"
				media="(max-width: 767.98px)">
														<img srcset="https://harfanglab.io/medias/2024/09/image.png 1x, https://harfanglab.io/medias/2024/09/image.png 2x"
					alt="Header image for PackXor"
					width="1456" height="816"
					src="https://harfanglab.io/medias/2024/09/image.png"
					sizes="100vw">
					</picture>
	</figure>
                </div>
            </div>
        </div>
    </div>
</section>


<article class="page-part page-part--single  card--color-purple" style="--illustration-cat: url('https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg'); --color-inside: #7f1fff;">
    <div class="single-wrapper">
        <main class="single-body">
            <div class="container">
                <div class="wrapper">
                    <section class="single-content wysiwyg">
                        <section class="content">
                            <h2>Summary</h2>
<p>In early July 2024, the Sentinel Labs researchers released an extensive article<sup id="fnref1_SL_article"><a class="footnote-ref" href="#fn_SL_article">1</a></sup> about &#8220;FIN7 reboot&#8221; tooling, notably introducing &#8220;AvNeutralizer&#8221;, an anti-EDR tool. This tool has been found in the wild as a packed payload.</p>
<p>In this article, we offer a thorough analysis of the associated private packer that we named &#8220;PackXOR&#8221;, as well as an unpacking tool. Additionally, while investigating the packer usage, we determined that PackXOR might not be exclusively leveraged by FIN7.</p>
<h2>Background</h2>
<h3>AvNeutralizer and FIN7</h3>
<p>In order to disable EDR (Endpoint Detection and Response) software, AvNeutralizer (also called &#8220;AuKill&#8221;) relies on vulnerable drivers to terminate EDR related processes from the kernel.</p>
<p>According to Sentinel Labs researchers, AvNeutralizer has been sold since 2022 on &#8220;underground&#8221; forums such as <code>xss[.]is</code>, <code>exploit[.]in</code> and &#8220;RAMP&#8221; by individuals they link with high confidence to the &#8220;FIN7&#8221; cluster.</p>
<p>Sentinel Labs states that AvNeutralizer can be delivered to targets as a packed or unprotected payload since April 2023, as part of ransomware operations from various threat actors.</p>
<p>Sentinel Labs also notices that &#8220;the packer code is identical across various usages, suggesting that FIN7 provides a shared obfuscator to their buyers within the AvNeutralizer bundle&#8221;<sup id="fnref2_SL_article"><a class="footnote-ref" href="#fn_SL_article">1</a></sup>.</p>
<p>However, we discovered that PackXOR, the packer for AvNeutralizer, was also used to protect unrelated payloads, such as the &#8220;XMRig&#8221;<sup id="fnref1_XMRig"><a class="footnote-ref" href="#fn_XMRig">2</a></sup> cryptominer or XMRig + the &#8220;R77 rootkit&#8221;<sup id="fnref1_R"><a class="footnote-ref" href="#fn_R">3</a></sup>, which were additionally obfuscated with the open-source &#8220;SilentCryptoMiner&#8221;<sup id="fnref1_Silent"><a class="footnote-ref" href="#fn_Silent">4</a></sup>.</p>
<p>The use of XMRig does not match the known FIN7 TTPs (Tactics, techniques, and procedures). While the packer could still have been used on XMRig payloads to test if it is detected by some security products, we believe such hypothesis is not consistent with the additional use of the SilentCryptoMiner obfuscator.</p>
<p>PackXOR developers might indeed be connected to the FIN7 cluster, but the packer appears to be used for activities that are not related to FIN7.</p>
<h3>A catch-up session to packers</h3>
<p>In malware analysis, a &#8220;packer&#8221; is a tool which is used to compress, encrypt, and/or obfuscate a &#8220;payload&#8221; (which will often be a malicious code).</p>
<p>Packers wrap the original malicious code in &#8220;packed data&#8221;, and produce a &#8220;packed binary&#8221; as a result. This packed binary needs to &#8220;unpack&#8221; packed data before the the payload can be executed:</p>

<figure id="attachment_129000" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-129000 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/packing-workflow.png.webp 930w, https://harfanglab.io/medias/2024/08/packing-workflow-480x188.png.webp 480w, https://harfanglab.io/medias/2024/08/packing-workflow-720x282.png.webp 720w, https://harfanglab.io/medias/2024/08/packing-workflow-360x141.png.webp 360w, https://harfanglab.io/medias/2024/08/packing-workflow-240x94.png.webp 240w" sizes="(max-width: 930px) 100vw, 930px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/packing-workflow.png" alt="Figure 1 - Packing workflow" width="930" height="364" srcset="https://harfanglab.io/medias/2024/08/packing-workflow.png 930w, https://harfanglab.io/medias/2024/08/packing-workflow-480x188.png 480w, https://harfanglab.io/medias/2024/08/packing-workflow-720x282.png 720w, https://harfanglab.io/medias/2024/08/packing-workflow-360x141.png 360w, https://harfanglab.io/medias/2024/08/packing-workflow-240x94.png 240w" sizes="(max-width: 930px) 100vw, 930px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 1 &#8211; Packing workflow</figcaption></figure>

<p>Packers&#8217; products often contain a decryption stub, which is a small piece of code that is executed first when the packed binary is executed. This stub decrypts and/or decompresses the malicious code (packed data) into its original form, allowing it to execute.</p>

<figure id="attachment_129003" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-129003 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/unpacking-workflow.png.webp 930w, https://harfanglab.io/medias/2024/08/unpacking-workflow-480x188.png.webp 480w, https://harfanglab.io/medias/2024/08/unpacking-workflow-720x282.png.webp 720w, https://harfanglab.io/medias/2024/08/unpacking-workflow-360x141.png.webp 360w, https://harfanglab.io/medias/2024/08/unpacking-workflow-240x94.png.webp 240w" sizes="(max-width: 930px) 100vw, 930px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/unpacking-workflow.png" alt="Figure 2 - Unpacking workflow" width="930" height="364" srcset="https://harfanglab.io/medias/2024/08/unpacking-workflow.png 930w, https://harfanglab.io/medias/2024/08/unpacking-workflow-480x188.png 480w, https://harfanglab.io/medias/2024/08/unpacking-workflow-720x282.png 720w, https://harfanglab.io/medias/2024/08/unpacking-workflow-360x141.png 360w, https://harfanglab.io/medias/2024/08/unpacking-workflow-240x94.png 240w" sizes="(max-width: 930px) 100vw, 930px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 2 &#8211; Unpacking workflow</figcaption></figure>

<p>The aim of packing is to hinder the work of malware analysts and antivirus/EDR software, by concealing payloads and delaying their detection.</p>
<h2>PackXOR</h2>
<h3>Packer logic</h3>
<p>Packed data which is produced by the PackXOR packer is structured in 2 sections (see Fig. 3):</p>
<ul>
	<li>A 40 bytes header that contains:

<ul>
	<li>XOR key 1, a XOR key used for a first iteration,</li>
	<li>the compressed size of the packed payload,</li>
	<li>the uncompressed size of the packed data,</li>
	<li>XOR key 2, a XOR key used for a second iteration</li>
</ul>
</li>
	<li>a packed payload.</li>
</ul>
<p>This packed data is usually found at the begining of the PE <code>.data</code> section.</p>

<figure id="attachment_128874" class="wp-caption alignnone"><img decoding="async" class="img-fluid full wp-image-128874 size-full" src="https://harfanglab.io/medias/2024/08/packxor-fig3.png" alt="Figure 3 - Data structure of the packed content" width="410" height="410" /><figcaption class="wp-caption-text"> Figure 3 &#8211; Data structure of the packed content</figcaption></figure>

<p>In order to conceal the packed payload, and as explained in the Sentinel Labs article<sup id="fnref3_SL_article"><a class="footnote-ref" href="#fn_SL_article">1</a></sup>, the packed binary implements (see Fig. 4):</p>
<ol>
	<li>A first XOR iteration (with XOR key 1) on LZNT1 compressed data,</li>
	<li>A decompression of LZNT1 data,</li>
	<li>A second XOR iteration (with XOR key 2) on the decompressed data.</li>
</ol>

<figure id="attachment_128877" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-128877 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/packxor-fig4.png.webp 1418w, https://harfanglab.io/medias/2024/08/packxor-fig4-1080x325.png.webp 1080w, https://harfanglab.io/medias/2024/08/packxor-fig4-480x145.png.webp 480w, https://harfanglab.io/medias/2024/08/packxor-fig4-960x289.png.webp 960w, https://harfanglab.io/medias/2024/08/packxor-fig4-720x217.png.webp 720w, https://harfanglab.io/medias/2024/08/packxor-fig4-360x108.png.webp 360w, https://harfanglab.io/medias/2024/08/packxor-fig4-240x72.png.webp 240w" sizes="(max-width: 1418px) 100vw, 1418px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/packxor-fig4.png" alt="Figure 4 - Unpacking code" width="1418" height="427" srcset="https://harfanglab.io/medias/2024/08/packxor-fig4.png 1418w, https://harfanglab.io/medias/2024/08/packxor-fig4-1080x325.png 1080w, https://harfanglab.io/medias/2024/08/packxor-fig4-480x145.png 480w, https://harfanglab.io/medias/2024/08/packxor-fig4-960x289.png 960w, https://harfanglab.io/medias/2024/08/packxor-fig4-720x217.png 720w, https://harfanglab.io/medias/2024/08/packxor-fig4-360x108.png 360w, https://harfanglab.io/medias/2024/08/packxor-fig4-240x72.png 240w" sizes="(max-width: 1418px) 100vw, 1418px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 4 &#8211; Unpacking code</figcaption></figure>

<p>In a function of the packer that we called <code>Get_and_Call_RtlDecompressBuffer</code> during our analysis, we can see one example of a call to a strings decryption function <code>decrypt_API_DLL_names</code> (see Fig. 5). This strings decryption function is described next.</p>

<figure id="attachment_128880" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-128880 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/packxor-fig5.png.webp 1372w, https://harfanglab.io/medias/2024/08/packxor-fig5-1080x322.png.webp 1080w, https://harfanglab.io/medias/2024/08/packxor-fig5-480x143.png.webp 480w, https://harfanglab.io/medias/2024/08/packxor-fig5-960x286.png.webp 960w, https://harfanglab.io/medias/2024/08/packxor-fig5-720x215.png.webp 720w, https://harfanglab.io/medias/2024/08/packxor-fig5-360x107.png.webp 360w, https://harfanglab.io/medias/2024/08/packxor-fig5-240x72.png.webp 240w" sizes="(max-width: 1372px) 100vw, 1372px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/packxor-fig5.png" alt="Figure 5 - Call to the &quot;decrypt_api_DLL_names&quot; function" width="1372" height="409" srcset="https://harfanglab.io/medias/2024/08/packxor-fig5.png 1372w, https://harfanglab.io/medias/2024/08/packxor-fig5-1080x322.png 1080w, https://harfanglab.io/medias/2024/08/packxor-fig5-480x143.png 480w, https://harfanglab.io/medias/2024/08/packxor-fig5-960x286.png 960w, https://harfanglab.io/medias/2024/08/packxor-fig5-720x215.png 720w, https://harfanglab.io/medias/2024/08/packxor-fig5-360x107.png 360w, https://harfanglab.io/medias/2024/08/packxor-fig5-240x72.png 240w" sizes="(max-width: 1372px) 100vw, 1372px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 5 &#8211; Call to the &#8220;decrypt_api_DLL_names&#8221; function</figcaption></figure>

<h3>Strings encryption</h3>
<p>The packed binary leverages &#8220;Run-Time Dynamic Linking&#8221; <sup id="fnref1_runtime"><a class="footnote-ref" href="#fn_runtime">5</a></sup> for some specific Windows API functions that it needs to use. The associated required DLLs and Windows API functions names are &#8220;encrypted&#8221; strings in the packer.</p>
<p>Strings are decrypted just before usage<sup id="fnref1_runtime2"><a class="footnote-ref" href="#fn_runtime2">6</a></sup> by a dedicated function that we called <code>decrypt_API_DLL_name</code>. The &#8220;encryption&#8221;<sup id="fnref1_xor"><a class="footnote-ref" href="#fn_xor">7</a></sup> is implemented using XOR and substraction operations for each byte of a given string (a string being ASCII-encoded):</p>

<figure id="attachment_128883" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-128883 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/packxor-fig6.png.webp 477w, https://harfanglab.io/medias/2024/08/packxor-fig6-360x239.png.webp 360w, https://harfanglab.io/medias/2024/08/packxor-fig6-240x159.png.webp 240w" sizes="(max-width: 477px) 100vw, 477px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/packxor-fig6.png" alt="Figure 6 - Strings encryption function" width="477" height="317" srcset="https://harfanglab.io/medias/2024/08/packxor-fig6.png 477w, https://harfanglab.io/medias/2024/08/packxor-fig6-360x239.png 360w, https://harfanglab.io/medias/2024/08/packxor-fig6-240x159.png 240w" sizes="(max-width: 477px) 100vw, 477px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 6 &#8211; Strings encryption function</figcaption></figure>

<p>Encrypted strings are stored in &#8220;data blobs&#8221; which match a specific layout:</p>

<figure id="attachment_128886" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-128886 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/packxor-fig7.png.webp 860w, https://harfanglab.io/medias/2024/08/packxor-fig7-480x112.png.webp 480w, https://harfanglab.io/medias/2024/08/packxor-fig7-720x167.png.webp 720w, https://harfanglab.io/medias/2024/08/packxor-fig7-360x84.png.webp 360w, https://harfanglab.io/medias/2024/08/packxor-fig7-240x56.png.webp 240w" sizes="(max-width: 860px) 100vw, 860px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/packxor-fig7.png" alt="Figure 7 - Structure of a blob for an encrypted string" width="860" height="200" srcset="https://harfanglab.io/medias/2024/08/packxor-fig7.png 860w, https://harfanglab.io/medias/2024/08/packxor-fig7-480x112.png 480w, https://harfanglab.io/medias/2024/08/packxor-fig7-720x167.png 720w, https://harfanglab.io/medias/2024/08/packxor-fig7-360x84.png 360w, https://harfanglab.io/medias/2024/08/packxor-fig7-240x56.png 240w" sizes="(max-width: 860px) 100vw, 860px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 7 &#8211; Structure of a blob for an encrypted string</figcaption></figure>

<p>The first byte of the blob (in red) is the <code>XOR</code> key which is used for the byte by byte &#8220;encryption&#8221;.</p>
<p>The second byte (in green) contains the string length in bytes. Between the string length and the first byte of the encrypted string, 3 bytes are unused.</p>
<p>In the packed binary, encrypted data blobs are stored one after the others. The color code used is the same that the one in the illustration below. The non-colored bytes are unused:</p>

<figure id="attachment_128889" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-128889 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/packxor-fig8.png.webp 444w, https://harfanglab.io/medias/2024/08/packxor-fig8-360x293.png.webp 360w, https://harfanglab.io/medias/2024/08/packxor-fig8-240x195.png.webp 240w" sizes="(max-width: 444px) 100vw, 444px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/packxor-fig8.png" alt="Figure 8 - Encrypted data blobs in the packer" width="444" height="361" srcset="https://harfanglab.io/medias/2024/08/packxor-fig8.png 444w, https://harfanglab.io/medias/2024/08/packxor-fig8-360x293.png 360w, https://harfanglab.io/medias/2024/08/packxor-fig8-240x195.png 240w" sizes="(max-width: 444px) 100vw, 444px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 8 &#8211; Encrypted data blobs in the packer</figcaption></figure>

<p>As an example, let&#8217;s decrypt the last encrypted data blob that is shown in the screenshot above (see Fig. 8). Here, the XOR key is <code>0x7C</code>. If we follow the &#8220;decryption&#8221; routine and for each byte of the data blob, we need to: XOR the byte with the key, then substract the current byte position index (in data blob) minus 1 to the result.</p>
<pre><code>((13 xor 7C) - 0) - 1 = 6F - 1 = 6E = n
((0A xor 7C) - 1) - 1 = 75 - 1 = 74 = t
((1B xor 7C) - 2) - 1 = 65 - 1 = 64 = d
((0C xor 7C) - 3) - 1 = 6D - 1 = 6C = l
((0D xor 7C) - 4) - 1 = 6D - 1 = 6C = l
((48 xor 7C) - 5) - 1 = 2F - 1 = 2E = .
((17 xor 7C) - 6) - 1 = 65 - 1 = 64 = d
((08 xor 7C) - 7) - 1 = 6D - 1 = 6C = l
((09 xor 7C) - 8) - 1 = 6D - 1 = 6C = l</code></pre>
<p>The <code>XOR</code> key is different for almost every string in a given binary sample, and changes with every sample. Changing the <code>XOR</code> keys between strings and samples increase the odds of bypassing a static analysis.</p>
<h2>PackXOR usage</h2>
<p>During our research, we could identify 4 different additional payloads (other than AvNeutralizer) that we believe with medium to high confidence were packed with PackXOR, because the unpacking code is identical in all samples.</p>
<p>Three of the identified samples drop the XMRig<sup id="fnref2_XMRig"><a class="footnote-ref" href="#fn_XMRig">2</a></sup> cryptominer or XMRig + the R77 rootkit<sup id="fnref2_R"><a class="footnote-ref" href="#fn_R">3</a></sup>. Between those final payloads and PackXOR-produced code, we discovered a second and sometimes third layer of obfuscation (see Fig. 9):</p>
<ul>
	<li>some payloads (SHA-256 <code>e3505901fd44c8f6597ca9c512375b6ecbf3dc21dbae3d373318c99929d62091</code> and <code>b86612a6d62a1789031248bdb732b8bff51acaeaa687c3559f0980560a8abf2f</code>) were packed with the open-source SilentCryptoMiner<sup id="fnref2_Silent"><a class="footnote-ref" href="#fn_Silent">4</a></sup> obfuscator ,</li>
	<li>a payload (SHA-256 <code>cf1d985a33b39d332d4bac33d971a004dcd18cea82ff1b291c6a5046e073414d</code>) which was obfuscated with SilentCryptoMiner was additionnally obfuscated with a &#8220;commercial&#8221; packing tool (Hidden Malware Builder<sup id="fnref1_crypter"><a class="footnote-ref" href="#fn_crypter">8</a></sup>).</li>
</ul>

<figure id="attachment_128993" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-128993 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/layers-of-obfuscation.png.webp 780w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-404x720.png.webp 404w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-480x855.png.webp 480w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-360x642.png.webp 360w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-240x428.png.webp 240w" sizes="(max-width: 780px) 100vw, 780px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/08/layers-of-obfuscation.png" alt="Figure 9 - Layers of obfuscation" width="780" height="1390" srcset="https://harfanglab.io/medias/2024/08/layers-of-obfuscation.png 780w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-404x720.png 404w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-480x855.png 480w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-720x1283.png 720w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-360x642.png 360w, https://harfanglab.io/medias/2024/08/layers-of-obfuscation-240x428.png 240w" sizes="(max-width: 780px) 100vw, 780px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 9 &#8211; Layers of obfuscation</figcaption></figure>

<p>One of the packed binary samples we identified (SHA-256 <code>632b068e1b8fbc54eb0b30f01455c73396deb5f8e3bbd3b171fb69b6936a6019</code>) dropped another type of payload, which is very similar to a data exfiltration tool that was documented in an article from ReversingLab in 2021<sup id="fnref1_rlabs"><a class="footnote-ref" href="#fn_rlabs">9</a></sup>.</p>
<h2>Unpacker</h2>
<p>According to Sentinel Labs and following our own research, it appears PackXOR is used by different ransomware operators, and to pack different tools. As a result we thought that providing an unpacker could be of use to the cybersecurity community.</p>
<p>We developed one which can be downloaded from <a href="https://github.com/HarfangLab/iocs/tree/main/packxor/unpacker_packXOR.py">our Github repository</a>.</p>
<pre><code>usage: packxor_unpacker.py [-h] [--file FILE] [--offset OFFSET]

Unpacker for PackXOR

options:
  -h, --help       show this help message and exit
  --file FILE      Packed PackXOR Malware
  --offset OFFSET  Optional. Offset of the packed header (in hexadecimal). No prefix (0x, x, etc)</code></pre>
<p>If you already know the offset of the packed data structure header in the binary you want to unpack, you can pass it directly with the <code>--offset</code> argument.</p>
<pre><code>$ python packxor_unpacker.py --file 050637.exe --offset 1a00
XOR key for first iteration : 0x1f
XOR key for second iteration : 0x4f
Size of compressed data (in bytes): 62958
Size of uncompressed data (in bytes): 80896
Unpacking SUCCESS
Unpacked file available in 050637_unpacked.exe</code></pre>
<p>However, if you don&#8217;t have time or don&#8217;t want to reverse the binary to find such offset, no worries! Without <code>--offset</code>, the script will try to automatically the header offset and unpack the data.</p>
<pre><code>$ python packxor_unpacker.py --file 050637.exe
Offset header not provided as an argument. Trying to find it anyway.
Packer header found
XOR key for first iteration : 0x1f
XOR key for second iteration : 0x4f
Size of compressed data (in bytes): 62958
Size of uncompressed data (in bytes): 80896
Unpacking SUCCESS
Unpacked file available in 050637_unpacked.exe</code></pre>
<h2>Appendix</h2>
<h3>Indicators of compromise (IOCs)</h3>
<p>Associated IOCs are also <a href="https://github.com/HarfangLab/iocs/tree/main/packxor">available on our GitHub repository</a>.</p>
<h4>Hashes (SHA-256)</h4>
<h5>Packed</h5>
<pre><code>0506372e2c2b6646c539ac5a08265dd66d0da58a25545e444c25b9a02f8d9a44|AvNeutralizer
146c68ca89b8b0378c2c6fb978892aace0235c7038879e85b3764556b0dbf2a5|AvNeutralizer
cf1d985a33b39d332d4bac33d971a004dcd18cea82ff1b291c6a5046e073414d|XMRig (packed with: PackXOR+Hidden Malware Builder+SilentCryptoMiner)
e3505901fd44c8f6597ca9c512375b6ecbf3dc21dbae3d373318c99929d62091|XMRig (packed with: PackXOR+SilentCryptoMiner)
b86612a6d62a1789031248bdb732b8bff51acaeaa687c3559f0980560a8abf2f|XMRig+R77 (packed with: PackXOR+SilentCryptoMiner)
dcc7fd38fced82cc04cb6fa0d189d2924163494e542f6c516e6588c110ab7554|Data exfiltrator/bot (packed with: PackXOR)</code></pre>
<h5>Unpacked</h5>
<pre><code>f15e6ff7f1ba8f7aad1adb88300a5ea367d6b5388f41d602f978d2885aa2ed38|AvNeutralizer
56af567979acaec20bab9a36064ee5f31b96fceaa5487f6ba2db9ff6360d9a51|AvNeutralizer
40a8ffc5bbcb3befc90f269e32ab96b3ff32768f1fc0317a00f86f9b1161cdeb|XMRig+R77 (packed with: SilentCryptoMiner)
42ca0d62a9516cbf4a1ffcd9097d2f2c3b135f82b1c07adf586ef5b23ce96197|XMRig (packed with: Hidden Malware Builder+SilentCryptoMiner)
1428e14c9c86e8f068e37efc11190ee16f2cdb9bc808308c5450389ee2893c10|XMRig (packed with: SilentCryptoMiner)
632b068e1b8fbc54eb0b30f01455c73396deb5f8e3bbd3b171fb69b6936a6019|Data exfiltrator/bot</code></pre>
<h2>Yara rule</h2>
<pre><code>rule PackXOR
{
    meta:
        description = "Detection rule for PackXOR"
        references = "https://harfanglab.io/insidethelab/unpacking-packxor/"
        hash = "0506372e2c2b6646c539ac5a08265dd66d0da58a25545e444c25b9a02f8d9a44"
        date = "2024-08-05"
        author = "Harfanglab"
        context = "file"
    strings:
        $s_packer_xor = {
            4? 63 [3]                       // movsxd  rax, dword [rsp+0x50 {var_78}]
            4? 8b [2-6]                     // mov     rcx, qword [rsp+0xd0 {arg_8}]
            4? 8b [2-6]                     // mov     rcx, qword [rcx+0x8]
            4? 0? [2]                       // add     rax, qword [rcx+0x50]
            4? 8d [5]                       // lea     rcx, [rel data_140003020]
            0f (b6|b7) [1-5]                // movzx   eax, byte [rcx+rax]
            0f (b6|b7) [1-5]                // movzx   ecx, byte [rel data_14002399c]
            4? 8b [2-6]                     // mov     rdx, qword [rsp+0xd0 {arg_8}]
            4? 8b [2-6]                     // mov     rdx, qword [rdx+0x8]
            4? 0? [2]                       // add     rcx, qword [rdx+0x68]
            0f (b6|b7) [1-5]                // movzx   ecx, cl
            33 ??                           // xor     eax, ecx
            4? 63 [3]                       // movsxd  rcx, dword [rsp+0x50 {var_78}]
            4? 8b [2-6]                     // mov     rdx, qword [rsp+0xd0 {arg_8}]
            4? 8b [2-6]                     // mov     rdx, qword [rdx+0x8]
            4? 0? [2]                       // add     rcx, qword [rdx+0x48]
            4? 8d [5]                       // lea     rdx, [rel data_140003020]
            88 04 0a                        // mov     byte [rdx+rcx], al
            0f (b6|b7)                      // movzx   eax, byte [rel data_14000301e]
        }
        $s_packer_decrypt_conf = {
            8b [1-3]            // mov     eax, dword [rsp+0x4 {i}]
            ff ??               // inc     eax
            89 [1-3]            // mov     dword [rsp+0x4 {i}], eax
            0f b6 [1-3]         // movzx   eax, byte [rsp {var_128}]
            39 [1-3]            // cmp     dword [rsp+0x4 {i}], eax
            73 ??               // jae     0x140001d59
            8b [1-3]            // mov     eax, dword [rsp+0x4 {i}]
            83 ?? 05            // add     eax, 0x5
            8b ??               // mov     eax, eax
            4? 8b [2-6]         // mov     rcx, qword [rsp+0x130 {arg_8}]
            0f be [1-3]         // movsx   eax, byte [rcx+rax]
            85 ??               // test    eax, eax
            74 ??               // je      0x140001d40
            0f b6 [1-3]         // movzx   eax, byte [rsp+0x2 {var_126}]
            8b [3]              // mov     ecx, dword [rsp+0x4 {i}]
            83 ?? 05            // add     ecx, 0x5
            8b ??               // mov     ecx, ecx
            4? 8b [4-6]         // mov     rdx, qword [rsp+0x130 {arg_8}]
            0f (be|bf) [1-3]    // movsx   ecx, byte [rdx+rcx]
            33 ??               // xor     eax, ecx
            2b [1-3]            // sub     eax, dword [rsp+0x4 {i}]
            ff ??               // dec     eax
            8b [1-3]            // mov     ecx, dword [rsp+0x4 {i}]
            88 [1-3]            // mov     byte [rsp+rcx+0x20 {var_108}], al
            eb ??               // jmp     0x140001d57
            b8 01 00 00 00      // mov     eax, 0x1
            4? 6b ?? 00         // imul    rax, rax, 0x0
            4? 8b [4-6]         // mov     rcx, qword [rsp+0x130 {arg_8}]
            c6 [1-3] 00         // mov     byte [rcx+rax], 0x0
            eb ??               // jmp     0x140001d59
            eb                  // jmp     0x140001ce7
        }
        $s_packer_find_entry_point = {
            4? 63 [1-4]             // movsxd  rax, dword [rsp {var_38_1}]
            4? 3b [1-4]             // cmp     rax, qword [rsp+0x20 {var_18_1}]
            73 ??                   // jae     0x140001c7f
            48 8b [1-4]             // mov     rax, qword [rsp+0x10 {var_28_1}]
            0f b7 [1-4]             // movzx   eax, word [rax]
            c1 ?? 0c                // sar     eax, 0xc
            83 ?? 0a                // cmp     eax, 0xa
            75 ??                   // jne     0x140001c7d
            4? 8b [1-4]             // mov     rax, qword [rsp+0x8 {var_30}]
            8b [1-4]                // mov     eax, dword [rax]
            4? 03 [1-4]             // add     rax, qword [rsp+0x40 {arg_8}]
            4? 8b [1-4]             // mov     rcx, qword [rsp+0x10 {var_28_1}]
            0f b7 [1-4]             // movzx   ecx, word [rcx]
            81 ?? ff 0f 00 00       // and     ecx, 0xfff
            4? 63 [1-4]             // movsxd  rcx, ecx
            4? 03 [1-4]             // add     rax, rcx
            4? 89 [1-4]             // mov     qword [rsp+0x18 {var_20_1}], rax
            4? 8b [1-4]             // mov     rax, qword [rsp+0x18 {var_20_1}]
            4? 8b [1-4]             // mov     rax, qword [rax]
            4? 03 [1-4]             // add     rax, qword [rsp+0x50 {arg_18}]
            4? 8b [1-4]             // mov     rcx, qword [rsp+0x18 {var_20_1}]
            4? 89 [1-4]             // mov     qword [rcx], rax
            eb 93                   // jmp     0x140001c12
        }
        $s_packer_find_entry_point_rtlcreateuserthtread = {
            4? 8b [1-4]                // mov     rax, qword [rsp+0x70 {var_58_1}]
            8b [1-4]                   // mov     eax, dword [rax+0x28]
            4? 03 [1-4]                // add     rax, qword [rsp+0x68 {var_60_1}]
            4? 89 [2-6]                // mov     qword [rsp+0x88 {var_40_1}], rax
            ff [2-6]                   // call    qword [rsp+0x88 {var_40_1}]
            4? 8d [2-6]                // lea     rax, [rsp+0x9c {var_2c}]
            4? 89 [1-4]                // mov     qword [rsp+0x48 {var_80_1}], rax {var_2c}
            4? 8d [2-6]                // lea     rax, [rsp+0xb8 {var_10}]
            4? 89 [1-4]                // mov     qword [rsp+0x40 {var_88_1}], rax {var_10}
            4? c7 [3-7]                // mov     qword [rsp+0x38 {var_90}], 0x0
            4? 8b [2-6]                // mov     rax, qword [rsp+0x88 {var_40_1}]
            4? 89 [1-4]                // mov     qword [rsp+0x30 {var_98_1}], rax
            4? c7 [3-7]                // mov     qword [rsp+0x28 {var_a0}], 0x0
            4? c7 [3-7 ]               // mov     qword [rsp+0x20 {var_a8}], 0x0
            4? 33 ??                   // xor     r9d, r9d  {0x0}
            4? ?? 01                   // mov     r8b, 0x1
            33 ??                      // xor     edx, edx  {0x0}
            4? c? ?? ff ff ff ff       // mov     rcx, 0xffffffffffffffff
            ff                         // call    qword [rsp+0xa0 {var_28_1}]
        }
        $s_packer_string_encryption = {
            0f B? [1-2]      // movzx   eax, [rsp+128h+size_string]
            39 [1-3]         // cmp     [rsp+128h+var_124], eax
            73 ??            // jnb     short loc_140001CC9
            8B [1-3]         // mov     eax, [rsp+128h+var_124]
            83 ?? 05         // add     eax, 5
            8B ??            // mov     eax, eax
            4? 8B [1-6]      // mov     rcx, [rsp+128h+arg_0]
            0F B? [1-2]      // movsx   eax, byte ptr [rcx+rax]
            85 ??            // test    eax, eax
            74 ??            // jz      short loc_140001CB0
            0f B? [1-3]      // movzx   eax, [rsp+128h+key]
            8B [1-3]         // mov     ecx, [rsp+128h+var_124]
            83 ?? 05         // add     ecx, 5
            8B ??            // mov     ecx, ecx
            4? 8B [1-6]      // mov     rdx, [rsp+128h+arg_0]
            0F B? [1-2]      // movsx   ecx, byte ptr [rdx+rcx]
            33 ??            // xor     eax, ecx
            2B [1-3]         // sub     eax, [rsp+128h+var_124]
            FF ??            // dec     eax
            8B [1-3]         // mov     ecx, [rsp+128h+var_124]
            88 [1-3]         // mov     [rsp+rcx+128h+decrypted_string], al
            EB               // jmp     short loc_140001CC7
        }
    condition:
        uint16(0) == 0x5A4D
        and uint32(uint32(0x3C)) == 0x00004550
        and filesize &lt; 20MB
        2 of ($s_packer*)
}</code></pre>
<div class="footnotes">
<hr />
<ol>
	<li id="fn_SL_article">
<p><a href="https://www.sentinelone.com/labs/fin7-reboot-cybercrime-gang-enhances-ops-with-new-edr-bypasses-and-automated-attacks/">https://www.sentinelone.com/labs/fin7-reboot-cybercrime-gang-enhances-ops-with-new-edr-bypasses-and-automated-attacks/</a> <a class="footnote-backref" href="#fnref1_SL_article" rev="footnote">↩</a> <a class="footnote-backref" href="#fnref2_SL_article" rev="footnote">↩</a> <a class="footnote-backref" href="#fnref3_SL_article" rev="footnote">↩</a></p>
</li>
	<li id="fn_XMRig">
<p><a href="https://github.com/xmrig/xmrig">https://github.com/xmrig/xmrig</a> <a class="footnote-backref" href="#fnref1_XMRig" rev="footnote">↩</a> <a class="footnote-backref" href="#fnref2_XMRig" rev="footnote">↩</a></p>
</li>
	<li id="fn_R">
<p><a href="https://bytecode77.com/r77-rootkit">https://bytecode77.com/r77-rootkit</a> <a class="footnote-backref" href="#fnref1_R" rev="footnote">↩</a> <a class="footnote-backref" href="#fnref2_R" rev="footnote">↩</a></p>
</li>
	<li id="fn_Silent">
<p><a href="https://github.com/SilentCryptoMiner/SilentCryptoMiner">https://github.com/SilentCryptoMiner/SilentCryptoMiner</a> <a class="footnote-backref" href="#fnref1_Silent" rev="footnote">↩</a> <a class="footnote-backref" href="#fnref2_Silent" rev="footnote">↩</a></p>
</li>
	<li id="fn_runtime">
<p><code>Run-time dynamic linking</code> is a way to load DLLs (Dynamic Link Library) and import functions from them only when needed, rather than at the executable startup. This process involves the Windows API functions <code>GetModuleHandle</code>, <code>LoadLibrary</code>, and <code>GetProcAddress</code>. Malware often uses <code>Run-time dynamic linking</code> in order to evade detection from static analysis tools.  <a class="footnote-backref" href="#fnref1_runtime" rev="footnote">↩</a></p>
</li>
	<li id="fn_runtime2">
<p>Strings are &#8220;decrypted&#8221; just before usage in <code>LoadLibrary</code> and <code>GetProcAddress</code> functions. <a class="footnote-backref" href="#fnref1_runtime2" rev="footnote">↩</a></p>
</li>
	<li id="fn_xor">
<p><a href="https://archive.org/details/flooved1478/page/n1/mode/2up">https://archive.org/details/flooved1478/page/n1/mode/2up</a> <a class="footnote-backref" href="#fnref1_xor" rev="footnote">↩</a></p>
</li>
	<li id="fn_crypter">
<p><a href="https://poison.tools/product/poison-fud-crypter/">https://poison.tools/product/poison-fud-crypter/</a> <a class="footnote-backref" href="#fnref1_crypter" rev="footnote">↩</a></p>
</li>
	<li id="fn_rlabs">
<p><a href="https://www.reversinglabs.com/blog/data-exfiltrator">https://www.reversinglabs.com/blog/data-exfiltrator</a> <a class="footnote-backref" href="#fnref1_rlabs" rev="footnote">↩</a></p>
</li>
</ol>
</div>
                                                            <div class="single-dates">
                                    <time class="single-date single-date--published" datetime="2024-09-04T16:02:09+02:00" itemprop="datePublished">
                                        Published on 4 September, 2024                                    </time>
                                                                        <time class="single-date single-date--modified" datetime="2024-10-11T11:34:53+02:00" itemprop="datePublished">
                                        Last update on 11 October, 2024                                    </time>
                                                                    </div>
                            
                            </section>
                            <section class="single-related">
        <div class="container">
            <div class="wrapper swiper js_relatedSwiper">
                <header>
                    <strong class="title">More <span class="text-gradient">articles</span></strong>
                </header>
                <div class="swiper-wrapper">
                    <a href="https://harfanglab.io/insidethelab/hijackloader-abusing-genuine-certificates/" 
    id="card-130188"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/10/banner-480x360.jpg.webp 1x, https://harfanglab.io/medias/2024/10/banner-960x720.jpg.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/10/banner-480x360.jpg 1x, https://harfanglab.io/medias/2024/10/banner-960x720.jpg 2x" alt="Banner for" width="480" height="360" src="https://harfanglab.io/medias/2024/10/banner-480x360.jpg" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">HijackLoader evolution: abusing genuine signing certificates</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Summary Since mid-September 2024, our telemetry has revealed a significant increase in &#8220;Lumma Stealer&#8221;1 malware deployments via the &#8220;HijackLoader&#8221;2 malicious loader. On October 2, 2024, HarfangLab EDR detected and blocked yet another HijackLoader deployment attempt &#8211; except this time, the&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-10-11T13:52:28+02:00" itemprop="datePublished">
                    Published on 11 October, 2024                </time>
                <span class="post-reading-time"> 16 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/2024-cyber-threatscape-predictions/" 
    id="card-26094"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/01/predictions-bg-480x360.png.webp 1x, https://harfanglab.io/medias/2024/01/predictions-bg-960x720.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/01/predictions-bg-480x360.png 1x, https://harfanglab.io/medias/2024/01/predictions-bg-960x720.png 2x" alt="predictions_bg" width="480" height="360" src="https://harfanglab.io/medias/2024/01/predictions-bg-480x360.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">2024 Threatscape report</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>As we step into 2024, we anticipate a year that is poised to set several significant precedents. In this blogpost, we provide our Threatscape report, presenting our predictions for the global threats that lie ahead in the upcoming year. These&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-01-25T15:27:34+01:00" itemprop="datePublished">
                    Published on 25 January, 2024                </time>
                <span class="post-reading-time"> 9 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/isoon-leak-analysis/" 
    id="card-34169"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/02/isoon-heading-480x360.png.webp 1x, https://harfanglab.io/medias/2024/02/isoon-heading.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/02/isoon-heading-480x360.png 1x, https://harfanglab.io/medias/2024/02/isoon-heading.png 2x" alt="A comprehensive analysis of I-Soon&#039;s commercial offering" width="480" height="360" src="https://harfanglab.io/medias/2024/02/isoon-heading-480x360.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">A comprehensive analysis of I-Soon&#8217;s commercial offering</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Identifier: TRR240301. Key Findings I-Soon&#8217;s commercial offering reveals that their main issue is processing collected data, not breaching their targets in the first place. Their products leverage deep learning to help them sort and classify stolen documents. The company appears&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-03-01T11:31:36+01:00" itemprop="datePublished">
                    Published on 1 March, 2024                </time>
                <span class="post-reading-time"> 38 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/cyclops-replacement-bellaciao/" 
    id="card-128623"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/08/cyclops-banner-480x360.jpg.webp 1x, https://harfanglab.io/medias/2024/08/cyclops-banner-960x720.jpg.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/08/cyclops-banner-480x360.jpg 1x, https://harfanglab.io/medias/2024/08/cyclops-banner-960x720.jpg 2x" alt="Banner for Cyclops: a likely replacement for BellaCiao" width="480" height="360" src="https://harfanglab.io/medias/2024/08/cyclops-banner-480x360.jpg" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">Cyclops: a likely replacement for BellaCiao</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Identifier: TRR240801. Summary This report introduces Cyclops, a newly discovered and previously undocumented malware platform written in Go which dates back to December 2023, and that we believe has been deployed against targets in the Middle-East in 2024. Cyclops allows&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-08-14T11:14:41+02:00" itemprop="datePublished">
                    Published on 14 August, 2024                </time>
                <span class="post-reading-time"> 19 min</span>            </div>
        </footer>
    </div>
</a>                </div>
                <div class="swiper-controls">
                    <div class="swiper-button-prev"><span class="icon icon-arrow-swiper"></span></div>
                    <div class="swiper-button-next"><span class="icon icon-arrow-swiper"></span></div>
                </div>
            </div>
        </div>
    </section>
    <!-- /section.--related -->

                        <footer class="single-footer">
                            <div class="container">
                                <div class="wrapper">
                                                                                                </div>
                            </div>
                        </footer>

                    </section>
                                        <aside class="single-sidebar">
                        <div class="single-aside single-aside--author"><div class="author">
            <figure>
            <img width="512" height="512" src="/files/plugins/avatar-privacy/public/images/mystery.svg" alt="Alice Climent-Pommeret" class="img-fluid full rounded-circle author-avatar">
        </figure>
        <div class="author-informations">
        <strong class="author-name">Alice Climent-Pommeret</strong>                <div class="author-description">Analyste Threat Intelligence</div>    </div>
</div>
</div><div class="single-aside single-aside--author"><div class="author">
        <div class="author-informations">
                            </div>
</div>
</div><div class="single-aside single-aside--shares">
    <p>Share this post :</p>
    <a class="sharer btn-share" id="gtm-share-twitter" target="_blank" href="https://x.com/intent/tweet?url=https://harfanglab.io/insidethelab/unpacking-packxor/&text=Unpacking the unpleasant FIN7 gift: PackXOR&via=" rel="noopener">
        <i class="icon-twitter"></i>
        <span>X</span>
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite?mini=true&url=https://harfanglab.io/insidethelab/unpacking-packxor/&title=Unpacking the unpleasant FIN7 gift: PackXOR" class="sharer btn-share" target="_blank" title="Share on Linkedin">
        <i class="icon-linkedin"></i>
        <span>LinkedIn</span>
    </a>
    <a href="https://reddit.com/submit?url=https://harfanglab.io/insidethelab/unpacking-packxor/&title=Unpacking the unpleasant FIN7 gift: PackXOR" target="_blank" class="sharer btn-share" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" title="Share on Reddit">
        <i class="icon-reddit"></i>
        <span>Reddit</span>
    </a>
</div>
<article id="newsletter" class="newsletter newsletter-itb">
    <div class="newsletter-wrapper">
        <header class="newsletter-header">
            <strong>Newsletter</strong>
            <h2>Our tech content  <span class="text-gradient">in your mailbox !</span></h2>
        </header>
        <section class="newsletter-body">
            <script type="text/javascript"></script>
                <div class='gf_browser_chrome gform_wrapper gravity-theme gform-theme--no-framework' data-form-theme='gravity-theme' data-form-index='0' id='gform_wrapper_10' ><div id='gf_10' class='gform_anchor' tabindex='-1'></div>
                        <div class='gform_heading'>
							<p class='gform_required_legend'>&quot;<span class="gfield_required gfield_required_asterisk">*</span>&quot; indicates required fields</p>
                        </div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_10' id='gform_10'  action='/insidethelab/unpacking-packxor/#gf_10' data-formid='10' novalidate autocomplete="off">
                        <div class='gform-body gform_body'><div id='gform_fields row_10' class='gform_fields row top_label form_sublabel_above description_below validation_below'><div class="gfield gfield--type-email gfield_contains_required field_sublabel_above gfield--no-description field_description_below field_validation_below gfield_visibility_visible col-12 mb-3"><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml encoding="utf-8" ?><html><body><label class="form-label gfield_label gform-field-label" for="input_10_1">E-mail<span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class="ginput_container ginput_container_email">
                            <input autocomplete="off"  name="input_1" id="input_10_1" type="email" value="" class="form-control-lg form-control" aria-required="true" aria-invalid="false" required="required">
                        </div></body></html>
</div></div></div>
        <div class='gform_footer top_label'> <button type="submit" class="gform_button button btn" id="gform_submit_button_10" value="Sign me up!"><span>Sign me up!<i class="icon icon-arrow-btn"></i></span></button> <input type='hidden' name='gform_ajax' value='form_id=10&amp;title=&amp;description=&amp;tabindex=0&amp;theme=gravity-theme' />
            <input type='hidden' class='gform_hidden' name='is_submit_10' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='10' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_10' value='WyJbXSIsIjYyYTI3NDUxNTJiNGZmN2ZmZmUzZjc5NGIwZTcyNDYxIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_10' id='gform_target_page_number_10' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_10' id='gform_source_page_number_10' value='1' />
            <input type='hidden' name='gform_field_values' value='' />
            
        </div>
                        </form>
                        </div>
		                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_10' id='gform_ajax_frame_10' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
		                <script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() {gformInitSpinner( 10, 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', true );jQuery('#gform_ajax_frame_10').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_10');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_10').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_10').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_10').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_10').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_10').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_10').val();gformInitSpinner( 10, 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', true );jQuery(document).trigger('gform_page_loaded', [10, current_page]);window['gf_submitting_10'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}jQuery('#gform_wrapper_10').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_10').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [10]);window['gf_submitting_10'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_10').text());}else{jQuery('#gform_10').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger("gform_pre_post_render", [{ formId: "10", currentPage: "current_page", abort: function() { this.preventDefault(); } }]);                if (event && event.defaultPrevented) {                return;         }        const gformWrapperDiv = document.getElementById( "gform_wrapper_10" );        if ( gformWrapperDiv ) {            const visibilitySpan = document.createElement( "span" );            visibilitySpan.id = "gform_visibility_test_10";            gformWrapperDiv.insertAdjacentElement( "afterend", visibilitySpan );        }        const visibilityTestDiv = document.getElementById( "gform_visibility_test_10" );        let postRenderFired = false;                function triggerPostRender() {            if ( postRenderFired ) {                return;            }            postRenderFired = true;            jQuery( document ).trigger( 'gform_post_render', [10, current_page] );            gform.utils.trigger( { event: 'gform/postRender', native: false, data: { formId: 10, currentPage: current_page } } );            if ( visibilityTestDiv ) {                visibilityTestDiv.parentNode.removeChild( visibilityTestDiv );            }        }        function debounce( func, wait, immediate ) {            var timeout;            return function() {                var context = this, args = arguments;                var later = function() {                    timeout = null;                    if ( !immediate ) func.apply( context, args );                };                var callNow = immediate && !timeout;                clearTimeout( timeout );                timeout = setTimeout( later, wait );                if ( callNow ) func.apply( context, args );            };        }        const debouncedTriggerPostRender = debounce( function() {            triggerPostRender();        }, 200 );        if ( visibilityTestDiv && visibilityTestDiv.offsetParent === null ) {            const observer = new MutationObserver( ( mutations ) => {                mutations.forEach( ( mutation ) => {                    if ( mutation.type === 'attributes' && visibilityTestDiv.offsetParent !== null ) {                        debouncedTriggerPostRender();                        observer.disconnect();                    }                });            });            observer.observe( document.body, {                attributes: true,                childList: false,                subtree: true,                attributeFilter: [ 'style', 'class' ],            });        } else {            triggerPostRender();        }    } );} );
});</script>
        </section>
    </div>
        <figure class="newsletter-thumbnail">
        
										<img width="500" height="540" srcset="https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg 1x, https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg 2x"
					class="card-img img-fluid full"
					alt=""
				
					src="https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg"
					sizes="100vw">
						    </figure>
    </article>                    </aside>
                                    </div>
            </div>
        </main>

    </div>
</article>
<!-- /article.single -->



	</main>
	<!-- /main#main-content -->

	<footer id="main-footer">

		<div class="wrapper--widgets">
			<div class="container">
				<section class="footer-part footer-part--widgets" role="complementary" aria-label="Footer widget area">
									<section id="harfanglab_company-2" class="widget footer-widget widget_harfanglab_company"><div class="widget-wrapper">

        <section class="widget-body">
        <figure class="widget-company">
                            <img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="img-fluid company-logo" width="225" height="65">
                    </figure>
        <div class="description">5, rue Feydeau 75002 Paris <br>
</div>    </section>
    
</div>
</section><section id="nav_menu-2" class="widget footer-widget widget_nav_menu"><div class="menu-menu-footer-widget-anglais-container"><ul id="menu-menu-footer-widget-anglais" class="menu"><li id="menu-item-24701" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24701"><a href="https://harfanglab.io/about/"><div class="menu-item-wrapper"><span class="menu-item-name">About us</span></div></a></li>
<li id="menu-item-24702" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24702"><a href="https://harfanglab.io/press/"><div class="menu-item-wrapper"><span class="menu-item-name">Newsroom</span></div></a></li>
</ul></div></section>									<nav class="socials">
    <p>Follow us on :</p>
    <ul>
            <li>
            <a href="https://x.com/harfanglab" class="social --twitter" target="_blank" rel="noreferrer" aria-label="twitter">
                <i class="social-icon-twitter icon-twitter">twitter</i>    
            </a>
        </li>
            <li>
            <a href="https://www.linkedin.com/company/harfanglab" class="social --linkedin" target="_blank" rel="noreferrer" aria-label="linkedin">
                <i class="social-icon-linkedin icon-linkedin">linkedin</i>    
            </a>
        </li>
        </ul>
</nav>
				</section>
			</div>
		</div>
		<div class="wrapper--legals">
			<div class="container">
				<section class="footer-part footer-part--mentions">
					<span class="copyright">Copyright &copy; 2024, All Rights Reserved.</span>
					<ul id="mentions" class="navbar-links">
            <li id="nav-item-24697" class="nav-item">
                            <a href="https://harfanglab.io/legal-notices/" class="nav-link" >
                                        <span>Terms of use</span>
                </a>
                    </li>
            <li id="nav-item-24698" class="nav-item">
                            <a href="https://harfanglab.io/terms-of-use/" class="nav-link" >
                                        <span>General terms and conditions</span>
                </a>
                    </li>
            <li id="nav-item-24699" class="nav-item">
                            <a href="https://harfanglab.io/legal-notices/#cookies" class="nav-link" >
                                        <span>Cookie management</span>
                </a>
                    </li>
            <li id="nav-item-104384" class="nav-item">
                            <a href="https://harfanglab.io/security/" class="nav-link" >
                                        <span>Security</span>
                </a>
                    </li>
    </ul>
				</section>
			</div>
		</div>
	</footer>
	<!-- /footer#main-footer -->

</div>
<!-- /div#main-wrapper -->

    <script>window.addEventListener('DOMContentLoaded', function() {
        jQuery(document).bind('gform_post_render', function(e, formID) {
            if (!jQuery('.gform_validation_errors').length) {
                return;
            }
            const form = document.getElementById('gform_' + formID);
            form.classList.add('was-validated');
        });
    });</script>
<!-- Start of Async HubSpot Analytics Code -->
<script type="rocketlazyloadscript" data-rocket-type="text/javascript">
(function(d,s,i,r) {
if (d.getElementById(i)){return;}
var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/25847055.js';
e.parentNode.insertBefore(n, e);
})(document,"script","hs-analytics",300000);
</script>
<!-- End of Async HubSpot Analytics Code -->
<script type="rocketlazyloadscript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script id="rocket-preload-links-js-extra">
var RocketPreloadLinksConfig = {"excludeUris":"\/(?:.+\/)?feed(?:\/(?:.+\/?)?)?$|\/(?:.+\/)?embed\/|\/(index.php\/)?(.*)wp-json(\/.*|$)|\/refer\/|\/go\/|\/recommend\/|\/recommends\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php|html|htm","siteUrl":"https:\/\/harfanglab.io","onHoverDelay":"100","rateThrottle":"3"};
</script>
<script type="rocketlazyloadscript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>
<script id="harfanglab-pkg-js-extra">
var $_wp = {"ajaxurl":"https:\/\/harfanglab.io\/wp-admin\/admin-ajax.php?wpml_lang=en","current_lang":["en"]};
</script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/files/themes/harfangLab/assets/js/pkg.min.js?ver=1.5.4" id="harfanglab-pkg-js" data-rocket-defer defer></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/dom-ready.min.js?ver=f77871ff7694fffea381" id="wp-dom-ready-js" data-rocket-defer defer></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/hooks.min.js?ver=2810c76e705dd1a53b18" id="wp-hooks-js"></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/i18n.min.js?ver=5e580eb46a90c2b997e6" id="wp-i18n-js"></script>
<script type="rocketlazyloadscript" id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/a11y.min.js?ver=d90eebea464f6c09bfd5" id="wp-a11y-js" data-rocket-defer defer></script>
<script defer='defer' src="/files/plugins/gravityforms/js/jquery.json.min.js?ver=2.8.17" id="gform_json-js"></script>
<script id="gform_gravityforms-js-extra">
var gform_i18n = {"datepicker":{"days":{"monday":"Mo","tuesday":"Tu","wednesday":"We","thursday":"Th","friday":"Fr","saturday":"Sa","sunday":"Su"},"months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"firstDay":1,"iconText":"Select date"}};
var gf_legacy_multi = [];
var gform_gravityforms = {"strings":{"invalid_file_extension":"This type of file is not allowed. Must be one of the following:","delete_file":"Delete this file","in_progress":"in progress","file_exceeds_limit":"File exceeds size limit","illegal_extension":"This type of file is not allowed.","max_reached":"Maximum number of files reached","unknown_error":"There was a problem while saving the file on the server","currently_uploading":"Please wait for the uploading to complete","cancel":"Cancel","cancel_upload":"Cancel this upload","cancelled":"Cancelled"},"vars":{"images_url":"\/files\/plugins\/gravityforms\/images"}};
var gf_global = {"gf_currency_config":{"name":"Euro","symbol_left":"","symbol_right":"&#8364;","symbol_padding":" ","thousand_separator":".","decimal_separator":",","decimals":2,"code":"EUR"},"base_url":"\/files\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"\/files\/plugins\/gravityforms\/images\/spinner.svg","version_hash":"523413a6fbba0dd581b944eb64c54e66","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
</script>
<script defer='defer' src="/files/plugins/gravityforms/js/gravityforms.min.js?ver=2.8.17" id="gform_gravityforms-js"></script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/utils.min.js?ver=50c7bea9c2320e16728e44ae9fde5f26" id="gform_gravityforms_utils-js"></script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/vendor-theme.min.js?ver=54e7080aa7a02c83aa61fae430b9d869" id="gform_gravityforms_theme_vendors-js"></script>
<script id="gform_gravityforms_theme-js-extra">
var gform_theme_config = {"common":{"form":{"honeypot":{"version_hash":"523413a6fbba0dd581b944eb64c54e66"}}},"hmr_dev":"","public_path":"\/files\/plugins\/gravityforms\/assets\/js\/dist\/"};
</script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/scripts-theme.min.js?ver=bab19fd84843dabc070e73326d787910" id="gform_gravityforms_theme-js"></script>
<script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() { jQuery(document).on('gform_post_render', function(event, formId, currentPage){if(formId == 10) {jQuery( "#gform_10" ).on( 'submit', function( event ) {
	jQuery( '<input>' )
		.attr( 'type', 'hidden' )
		.attr( 'name', 'gf_zero_spam_key' )
		.attr( 'value', 'jBPTBQnMnCKnxqDa1jhRL1gqpst2CpBbB3f2t9XcxfRpAIgypEkrVbZzx0iLnZeb' )
		.attr( 'autocomplete', 'new-password' )
		.appendTo( jQuery( this ) );
} );} } );jQuery(document).on('gform_post_conditional_logic', function(event, formId, fields, isInit){} ) } );
});</script>
<script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() {jQuery(document).trigger("gform_pre_post_render", [{ formId: "10", currentPage: "1", abort: function() { this.preventDefault(); } }]);                if (event && event.defaultPrevented) {                return;         }        const gformWrapperDiv = document.getElementById( "gform_wrapper_10" );        if ( gformWrapperDiv ) {            const visibilitySpan = document.createElement( "span" );            visibilitySpan.id = "gform_visibility_test_10";            gformWrapperDiv.insertAdjacentElement( "afterend", visibilitySpan );        }        const visibilityTestDiv = document.getElementById( "gform_visibility_test_10" );        let postRenderFired = false;                function triggerPostRender() {            if ( postRenderFired ) {                return;            }            postRenderFired = true;            jQuery( document ).trigger( 'gform_post_render', [10, 1] );            gform.utils.trigger( { event: 'gform/postRender', native: false, data: { formId: 10, currentPage: 1 } } );            if ( visibilityTestDiv ) {                visibilityTestDiv.parentNode.removeChild( visibilityTestDiv );            }        }        function debounce( func, wait, immediate ) {            var timeout;            return function() {                var context = this, args = arguments;                var later = function() {                    timeout = null;                    if ( !immediate ) func.apply( context, args );                };                var callNow = immediate && !timeout;                clearTimeout( timeout );                timeout = setTimeout( later, wait );                if ( callNow ) func.apply( context, args );            };        }        const debouncedTriggerPostRender = debounce( function() {            triggerPostRender();        }, 200 );        if ( visibilityTestDiv && visibilityTestDiv.offsetParent === null ) {            const observer = new MutationObserver( ( mutations ) => {                mutations.forEach( ( mutation ) => {                    if ( mutation.type === 'attributes' && visibilityTestDiv.offsetParent !== null ) {                        debouncedTriggerPostRender();                        observer.disconnect();                    }                });            });            observer.observe( document.body, {                attributes: true,                childList: false,                subtree: true,                attributeFilter: [ 'style', 'class' ],            });        } else {            triggerPostRender();        }    } );
});</script>
<script>window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(var i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="/files/plugins/wp-rocket/assets/js/lazyload/17.8.3/lazyload.min.js"></script><script>function lazyLoadThumb(e,alt,l){var t='<img src="https://i.ytimg.com/vi/ID/hqdefault.jpg" alt="" width="480" height="360">',a='<button class="play" aria-label="play Youtube video"></button>';if(l){t=t.replace('data-lazy-','');t=t.replace('loading="lazy"','');t=t.replace(/<noscript>.*?<\/noscript>/g,'');}t=t.replace('alt=""','alt="'+alt+'"');return t.replace("ID",e)+a}function lazyLoadYoutubeIframe(){var e=document.createElement("iframe"),t="ID?autoplay=1";t+=0===this.parentNode.dataset.query.length?"":"&"+this.parentNode.dataset.query;e.setAttribute("src",t.replace("ID",this.parentNode.dataset.src)),e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","1"),e.setAttribute("allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"),this.parentNode.parentNode.replaceChild(e,this.parentNode)}document.addEventListener("DOMContentLoaded",function(){var exclusions=["*.svg","no-lazy"];var e,t,p,u,l,a=document.getElementsByClassName("rll-youtube-player");for(t=0;t<a.length;t++)(e=document.createElement("div")),(u='https://i.ytimg.com/vi/ID/hqdefault.jpg'),(u=u.replace('ID',a[t].dataset.id)),(l=exclusions.some(exclusion=>u.includes(exclusion))),e.setAttribute("data-id",a[t].dataset.id),e.setAttribute("data-query",a[t].dataset.query),e.setAttribute("data-src",a[t].dataset.src),(e.innerHTML=lazyLoadThumb(a[t].dataset.id,a[t].dataset.alt,l)),a[t].appendChild(e),(p=e.querySelector(".play")),(p.onclick=lazyLoadYoutubeIframe)});</script>
	<script type="rocketlazyloadscript" data-rocket-type="text/javascript">window.axeptioSettings = {
      clientId: "651abc3de8845f401f9b0009",
      cookiesVersion: 'harfanglab-en'
};

 
(function(d, s) {
  var t = d.getElementsByTagName(s)[0], e = d.createElement(s);
  e.async = true; e.src = "//static.axept.io/sdk.js";
  t.parentNode.insertBefore(e, t);
})(document, "script");



function launchGA(){
var el = document.createElement('script');
el.setAttribute('type', 'text/javascript');
el.setAttribute('async', true);
el.setAttribute('src', '//www.googletagmanager.com/gtag/js?id=G-WPZQYJHVT1');
document.body.append(el); window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WPZQYJHVT1', { 'anonymize_ip': true });
gtag('config', 'G-WPZQYJHVT1', {'link_attribution': true});
}


// La fonction qui relie Axeptio au lancement du cookie Google Analytics
void 0 === window._axcb && (window._axcb = []);
window._axcb.push(function(axeptio) {
     axeptio.on("cookies:complete", function(choices) {
    if(choices.google_analytics) {
       launchGA();
      }
     });
});</script>

</body>

</html>

<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->