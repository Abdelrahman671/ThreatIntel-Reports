<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments</title>
	<meta name="description" content="We recount an extensive cloud extortion campaign leveraging exposed .env files of at least 110k domains to compromise organizations&#039; AWS environments." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments" />
	<meta property="og:description" content="We recount an extensive cloud extortion campaign leveraging exposed .env files of at least 110k domains to compromise organizations&#039; AWS environments." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2024-08-15T10:00:09+00:00" />
	<meta property="article:modified_time" content="2024-09-03T20:10:05+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Margaret Kelley, Sean Johnstone, William Gamazo, Nathaniel Quist" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments Comments Feed" href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:large-scale-cloud-extortion-operation";
webData.pageURL = "https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation";
webData.article_title = "Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments";
webData.author = "Margaret Kelley,Sean Johnstone,William Gamazo,Nathaniel Quist";
webData.published_time = "2024-08-15T03:00:09-07:00";
webData.description = "We recount an extensive cloud extortion campaign leveraging exposed .env files of at least 110k domains to compromise organizations&#039; AWS environments.";
webData.keywords = "Cloud Cybersecurity Research,Threat Research,AWS,credential theft,data exfiltration,ENV files,environment variable files,Exploit Kits,exposed environment files,Extortion,HoneyCloud,MITRE,onion routing,Tor";
webData.resourceAssetID = "58af1e0c2c4b874b77238276ba7a9935";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="18"/>
<meta property="og:views" content="24,066"/>
<meta property="og:date_created" content="August 15, 2024 at 3:00 AM"/>
<meta property="og:post_length" content="5003"/>
<meta property="og:category" content="Cloud Cybersecurity Research"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Margaret Kelley"/>
<meta property="og:author" content="Sean Johnstone"/>
<meta property="og:author" content="William Gamazo"/>
<meta property="og:author" content="Nathaniel Quist"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/nathaniel-quist/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="AWS,credential theft,data exfiltration,ENV files,environment variable files,Exploit Kits,exposed environment files,Extortion,HoneyCloud,MITRE,onion routing,Tor"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments","name":"Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments","description":"We recount an extensive cloud extortion campaign leveraging exposed .env files of at least 110k domains to compromise organizations' AWS environments.","url":"https:\/\/unit42.paloaltonetworks.com\/large-scale-cloud-extortion-operation\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/large-scale-cloud-extortion-operation\/","datePublished":"August 15, 2024","articleBody":"Executive Summary\r\nUnit 42 researchers found an extortion campaign's cloud operation that successfully compromised and extorted multiple victim organizations. It did so by leveraging exposed environment variable files (.env files) that contained sensitive variables such as credentials belonging to various applications.\r\n\r\nMultiple security missteps were present in the course of this campaign, including the following:\r\n\r\n \tExposing environment variables\r\n \tUsing long-lived credentials\r\n \tAbsence of least privilege architecture\r\n\r\nThe campaign operation set up its attack infrastructure within various organizations\u2019 Amazon Web Services (AWS) environments and used that groundwork to scan more than 230 million unique targets for sensitive information.\r\n\r\nThis campaign targeted 110,000 domains resulting in over 90,000 unique variables in the .env files. Of those variables, 7,000 belonged to organizations' cloud services and we traced 1,500 variables back to social media accounts. Additionally, attackers used multiple source networks to facilitate the operation.\r\n\r\nBased on our research, the attackers used the following for this extortion campaign:\r\n\r\n \tThe onion router (Tor) network to perform reconnaissance and initial access operations\r\n \tVirtual private networks (VPN) to achieve lateral movement and perform data exfiltration\r\n \tVirtual private server (VPS) endpoints for other aspects of the campaign\r\n\r\nThe campaign involved attackers successfully ransoming data hosted within cloud storage containers. The event did not include attackers encrypting the data before ransom, but rather they exfiltrated the data and placed the ransom note in the compromised cloud storage container.\r\n\r\nMoreover, the attackers behind this campaign likely leveraged extensive automation techniques to operate successfully and rapidly. This indicates that these threat actor groups are both skilled and knowledgeable in advanced cloud architectural processes and techniques.\r\n\r\nNote that the attackers\u2019 success relied on misconfigurations in victim organizations that inadvertently exposed their .env files. It did not result from vulnerabilities or misconfigurations in cloud providers\u2019 services.\r\n\r\nThis post will detail the cloud extortion campaign by examining different tactics from the MITRE ATT&amp;CK framework as we recount and explain the events.\r\n\r\nPalo Alto Networks customers are better protected from the threats discussed in this article through detection mechanisms available from the following products:\r\n\r\n \tNext-Generation Firewall\r\n \tAdvanced WildFire\r\n \tAdvanced DNS Security\r\n \tAdvanced URL Filtering\r\n \tPrisma Cloud, Cortex XDR and XSIAM can be leveraged to protect and monitor your cloud environments.\r\n\r\nIf you think you might have been compromised or have an urgent matter, contact the Unit 42 Incident Response team.\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nExtortion\r\n\r\n\r\n\r\nBackground\r\nThis article exposes an extortion operation that targeted cloud environments and leveraged the dynamic scalability of cloud platforms. It also leveraged multiple cloud services to successfully hold organizations\u2019 cloud data to ransom.\r\n\r\nThe events discussed within this post took place within a cloud environment where the account operators deployed and used overly permissive IAM credentials. These credentials allowed the threat actors to perform several operations that would not have been possible if the account operators followed cloud security best practices.\r\n\r\nAttackers obtained initial access to victims' cloud environments through exposed environment files (.env) files within the victim organization's web applications. Due to the security risks associated with authentication data stored inside .env files, organizations should follow security best practices to never expose environment files publicly.\r\n\r\nEnvironment files allow users to define configuration variables used within applications and platforms. These files often contain secrets such as hard-coded cloud provider access keys, software-as-a-service (SaaS) API keys and database login information then used by the threat actor for initial access.\r\n\r\nThe attack pattern of scanning the internet for domains and exploiting credentials obtained from exposed environment variable files follows a larger pattern we believe propagates through other compromised AWS environments.\r\n\r\nNote: The presence of these secrets resulted from misconfigurations of victim organizations who inadvertently exposed their .env files. None of the listed vendors\u2019 applications or services had vulnerabilities or misconfigurations that resulted in this exposure.\r\nInitial Access (MITRE ATT&amp;CK Technique TA0001)\r\nThe activity discussed in this post resulted from exposed AWS Identity and Access Management (IAM) access keys obtained from publicly accessible .env files. The threat actors located these access keys by scanning and identifying exposed .env files hosted on unsecured web applications. Once the actors identified the exposed access keys, they used those keys to gain access to the hosting cloud environment.\r\n\r\nUnit 42 has responded to a variety of incidents involving AWS environments over the last 12 months, including a previously reported incident involving a zero-day vulnerability within the SugarCRM platform. We continue to see a growing trend of attackers targeting cloud IAM credentials leading to initial access of organizations\u2019 cloud environments.\r\n\r\nThe most common initial access vectors for this particular threat originate from organizations inadvertently misconfiguring servers, subsequently exposing sensitive files to the public internet, with the most frequently exposed files being .env files.\r\nDiscovery (MITRE ATT&amp;CK Technique TA0007)\r\nThe threat actor behind this activity performed various discovery API calls to learn more about the environment and select services to exploit. These discovery operations targeted various services such as the following:\r\n\r\n \tIAM\r\n \tSecurity Token Service (STS)\r\n \tSimple Storage Service (S3)\r\n \tSimple Email Service (SES).\r\n\r\nWe found these aforementioned services targeted by threat actors while they looked to expand their operation\u2019s control over an organization's cloud environment.\r\n\r\nAt the beginning of every operation for the discovery phase in this campaign, attackers ran the GetCallerIdentity API call to verify the identity of the user or role assigned to the exposed IAM credential. GetCallerIdentity is the AWS version of whoami. It returns information about the IAM credentials \u2013 associated UserID, AWS account number and the Amazon Resource Name (ARN) \u2013 of the principal used to initiate the request, as shown in Figure 1.\r\n\r\n[caption id=\"attachment_136317\" align=\"alignnone\" width=\"500\"] Figure 1. Example GetCallerIdentity and response.[\/caption]\r\n\r\nFor background, the AWS UserID is a unique identifier of the entity that performed the call. The AWS account number is the unique 12-digit identifier of the AWS account to which the UserID belongs.\r\n\r\nThe ARN includes the AWS account number and human-readable name of the principal performing the call. Every cloud resource has a unique ARN within an AWS account that, for example, can be subsequently used as a reference to that entity in CloudTrail logs or CloudFormation templates.\r\n\r\nThe ARN states the following information:\r\n\r\n \tThe AWS service it\u2019s associated with\r\n \tRegion hosting the AWS resource, but for global services like IAM the region is left blank\r\n \tThe AWS account it's located in\r\n \tThe IAM resource type associated with this IAM credential (e.g., user, role, or group)\r\n\r\nAttackers also successfully attempted the AWS API request ListUsers to gather a list of IAM users in the AWS account as well as the API request ListBuckets to identify all the existing S3 buckets. These operations give the attackers additional insight into what IAM users exist that they could exploit for future lateral movement, and they provide S3 bucket names for data exfiltration targets.\r\n\r\nThe threat actors then successfully performed more extensive discovery operations against AWS SES with the following API calls:\r\n\r\n \tGetSendQuota\r\n \tListVerifiedEmailAddresses\r\n \tGetAccountSendingEnabled\r\n \tGetAccount\r\n \tListIdentities\r\n\r\nWhile the threat actor did not successfully use SES beyond the initial discovery operations listed above during this campaign, we have found that attackers often target and leverage the SES service to send phishing messages to potential victims. By leveraging legitimate SES services for phishing attacks, a threat actor's malicious emails originate from a trusted source, often allowing them to evade an organization\u2019s defenses.\r\n\r\nAll of these various events provided the threat actor with a strong baseline understanding of what resources existed throughout the environment and where they could pivot.\r\nPrivilege Escalation (MITRE ATT&amp;CK Tactic TA0004)\r\nFollowing the threat actor\u2019s discovery operations, they identified that the original IAM credential used to gain initial access to the cloud environment did not have administrator access to all cloud resources. We determined that the attackers discovered the original IAM role used for initial access did have the permissions to both create new IAM roles and attach IAM policies to existing roles. Using these capabilities, the attacker successfully escalated their privileges within victim cloud environments by creating new IAM resources with unlimited access.\r\n\r\nTo accomplish this, they first created an IAM role named lambda-ex with the API request CreateRole, then used the API call AttachRolePolicy to attach the AWS-managed policy AdministratorAccess to the newly created lambda-ex role, as shown in Figure 2.\r\n\r\n[caption id=\"attachment_136319\" align=\"alignnone\" width=\"245\"] Figure 2. JSON permissions for the AdministratorAccess policy.[\/caption]\r\n\r\nThese two IAM events resulted in a new IAM role with administrative permissions, within the compromised AWS account, completing the threat actor\u2019s privilege escalation portion of the attacks. In the following section, we discuss how the threat actors used this role to grant unfettered access to their newly created lambda functions.\r\nExecution (MITRE ATT&amp;CK Tactic TA0002)\r\nFollowing the successful creation of the privileged IAM role, the threat actor attempted to create two different infrastructure stacks, one using Amazon Elastic Cloud Compute (EC2) resources and the other with AWS Lambda. By performing these execution tactics, the actors failed to create a security group, key pair and EC2 instance, but they successfully created multiple lambda functions with the newly created IAM role attached.\r\n\r\nThe threat actor attempted to create new EC2 resources to use for cryptomining based on the size of the instance. They successfully created new Lambda functions for their automated scanning operation.\r\nFailed EC2 Creation\r\nDuring these failed operations, the attackers first attempted to perform the API call CreateSecurityGroup and named the group security. Then they ran AuthorizeSecurityGroupIngress to create an ingress rule allowing all ports from 0 - 65535 from any IP address (0.0.0.0\/0). Following that, they attempted to CreateKeyPair and RunInstances with Amazon Machine Image (AMI) ID ami-08e8725a42775740f and an EC2 c6g instance type.\r\n\r\nC-series instances are compute optimized virtual machines, which are ideal for computationally intensive workloads. As such, malicious actors have often used these instances for cryptojacking operations.\r\n\r\nThe AMI ID belonged to a publicly accessible Ubuntu 18.04 LTS image in the us-east-1 region and the c6g instance type family ran on AWS Graviton2 processors built for compute-intensive workloads.\r\n\r\nAll of these actions took place in under a minute, indicating a pre-scripted, automated activity. However, these actions failed due to limited permissions associated with the compromised IAM user.\r\nSuccessful Lambda Function Creation\r\nFollowing the failed EC2 service actions, the threat actor successfully pivoted to the AWS Lambda service, a cloud-based serverless computation service, where they used the granted permissions obtained from the exposed IAM credential. Their first operation created a new lambda function using the CreateFunction20150331 API call in the AWS region\u00a0us-east-1, which created a new lambda function named ex. We will go into a deep dive into the lambda function\u2019s code and its purpose in the next section.\r\n\r\nOnce the threat actor successfully created the first lambda function, they automatically deployed that same lambda function into every other enabled region in the account within a second. As part of the default lambda function creation process, the role attached to the lambda function automatically performs a CreateLogGroup API call followed by CreateLogStream, which begins the process of logging all lambda function operations.\r\n\r\nThe CreateLogGroup event created a new CloudWatch log group containing the name of the newly created lambda \/aws\/lambda\/ex. Each log stream within the log group aggregates various lambda run information by date. This allowed us to successfully follow the threat actor's operations using the lambda function ex they created. It is important to note that the lambda function\u2019s logging creation process is automated and attackers cannot turn it off.\r\n\r\nThe threat actor created a malicious lambda function by leveraging the stolen IAM user credentials. The Unit 42 reverse engineering team analyzed the malicious lambda function, which consisted of a bash script configured to perform internet-wide scanning using a preconfigured set of sources containing millions of domains and IP addresses. Figure 3 displays the complete code of the lambda function.\r\n\r\n[caption id=\"attachment_136321\" align=\"alignnone\" width=\"786\"] Figure 3. The lambda function bash script.[\/caption]\r\n\r\nThe script retrieved a list of potential targets from a publicly accessible third-party S3 bucket exploited by the threat actor. We believe the threat actor hosted these third-party S3 buckets within other compromised and legitimate cloud environments, and the threat actor leveraged these resources in this attack. The list of potential targets the malicious lambda function iterated over contained a record of victim domains. For each domain in the list, the code performed a cURL request, targeting any environment variable files exposed at that domain, (i.e., http:\/\/&lt;target&gt;\/.env).\r\n\r\nUpon successfully retrieving the domain\u2019s exposed environment file, the lambda function uncovered and identified cleartext credentials contained within the file. Once the lambda function identified the credentials, it stored them in a newly created folder within another threat-actor-controlled public S3 bucket.\r\n\r\nThe malicious lambda function specifically targeted instances where the .env file referenced the string mailgun as seen on line 24 within Figure 3. With these compromised Mailgun credentials, threat actors can send large-scale phishing attacks against organizations from legitimate domains, making their attacks more likely to bypass security protections. We accessed the publicly exposed threat actor\u2019s public S3 bucket and assessed that the threat actor could copy the exposed .env files of at least 110,000 domains.\r\n\r\nThe following diagram, Figure 4, shows the threat actor\u2019s architectural design for scanning and retrieving the exposed authentication credentials in the .env files.\r\n\r\n[caption id=\"attachment_136323\" align=\"alignnone\" width=\"1731\"] Figure 4. High-level example of the threat actor's operational architecture.[\/caption]\r\n\r\nWe believe this design is part of a larger, fully automated operation based upon some of the S3 bucket naming conventions alone (e.g., s3:\/\/&lt;REDACTED&gt;\/ref5\/). Due to the large number of targeted domains, we have high confidence that the attackers heavily relied upon automation to achieve their goals.\r\n\r\nFurther evidence for the heavy reliance upon automation came during our analysis of the threat actor\u2019s public S3 bucket. We identified more than 230 million unique targets that the threat actor was scanning for misconfigured and exposed environment files. Figure 5 shows the contents of the threat actor\u2019s public bucket, listing the number of configured targets.\r\n\r\n[caption id=\"attachment_136325\" align=\"alignnone\" width=\"156\"] Figure 5. Target count per scan file and total (the name of the file is on the right).[\/caption]\r\n\r\nAt the time of access to this public S3 bucket, we estimate that multiple compromised AWS accounts were the target of this malicious scanning as part of a compromise-scan-compromise automated operation. In a later section of this article, we will describe more details about the misconfigured .env finding.\r\nExfiltration (MITRE ATT&amp;CK Tactic TA0010)\r\nThese attacks also included data exfiltration operations from S3 buckets through the use of the S3 Browser tool. This tool generates various S3 API calls when used. These events show which S3 buckets the threat actors interacted with regardless of whether the S3 object-level logging was enabled (shown in Figure 6). These API calls include:\r\n\r\n \tListBuckets\r\n \tGetBucketLocation\r\n \tGetBucketObjectLockConfiguration\r\n \tGetBucketLogging\r\n \tGetBucketVersioning\r\n \tGetBucketRequestPayment\r\n \tGetAccelerateConfiguration\r\n \tGetBucketReplication\r\n \tGetBucketLifecycle\r\n \tGetBucketPublicAccessBlock\r\n \tGetBucketOwnershipControls\r\n \tGetBucketAcl\r\n\r\n[caption id=\"attachment_136327\" align=\"alignnone\" width=\"360\"] Figure 6. Example: GetBucketLogging CloudTrail event.[\/caption]\r\n\r\nNote, if an S3 bucket does not have object-level logging enabled, Cost and Usage Reports can provide a way to determine if the S3 Browser activity resulted in data exfiltration.\r\nImpact (MITRE ATT&amp;CK Tactic TA0040)\r\nAfter the threat actor successfully exfiltrated and deleted S3 objects from the target victim\u2019s S3 bucket, they uploaded a ransom note to the now empty bucket. One example is shown in Figure 7.\r\n\r\n[caption id=\"attachment_136329\" align=\"alignnone\" width=\"1164\"] Figure 7. Ransom note left by the threat actor.[\/caption]\r\n\r\nRansom notes are typically the last step in the extortion process and are designed to scare and coerce the victim to pay an often large fee. Victims make the ransom payment to ostensibly prevent the threat actor from selling or leaking their stolen data on the dark web and to hopefully get their deleted data back. See the Unit 42 Ransomware and Extortion Report for additional information regarding ransomware and extortion trends.\r\n\r\nAttackers often upload ransom notes to the impacted S3 bucket. There are also occurrences where the threat actor will email the note to stakeholders of the victim company.\r\nAssessing the Impact of the Leak\r\nAs mentioned earlier, the threat actor created a lambda function to scan an extensive list of domains looking for misconfigured and exposed .env files. Ironically, we found we could access the threat actors\u2019 publicly exposed S3 bucket that they used to store and view the stolen .env files. The data in this exposed S3 bucket consisted of the leaked environment variables collected by the threat actors from the misconfigured publicly exposed .env files.\r\n\r\nSome of the .env files contained multiple variables that revealed information about several services used within a victim\u2019s infrastructure. Figure 8 shows an example of a complex .env file.\r\n\r\n[caption id=\"attachment_136331\" align=\"alignnone\" width=\"490\"] Figure 8. Example of .env file with more than 40 configurations.[\/caption]\r\n\r\nWe found that the exposed .env files contained a variety of credentials, not only related to cloud infrastructure but also to social media accounts and other on-premises applications. Due to the variety of credentials, we categorized them based on related services to better represent the breadth of exposed credentials. The chart in Figure 9 shows the statistics of credential exposures obtained from the exposed .env files, based on the application type.\r\n\r\n[caption id=\"attachment_136333\" align=\"alignnone\" width=\"1178\"] Figure 9. Statistics of categorized leaks from .env variables.[\/caption]\r\n\r\nWe identified over 90,000 unique combinations of leaked environment variables that contained access keys or IAM credentials, with 7,000 access keys directly associated with various cloud services. Not all the leaks necessarily contained user accounts or secrets, but all of them leaked some details about a victim\u2019s internal infrastructure or its configuration.\r\n\r\nThe threat actor discovered exposed access keys within these variables and used select access credentials as an initial attack vector. Most concerningly, 1,515 of the leaked variables were associated with social media platforms; some of them included account names and authentication secret keys.\r\n\r\nWe found that while the threat actor\u2019s lambda function initially targeted Mailgun credentials, they captured many other secrets belonging to cloud service providers and SaaS applications.\r\n\r\nAs noted above, the presence of these secrets resulted from misconfigurations in victim organizations, not from vulnerabilities or misconfigurations in listed vendors\u2019 applications or services.\r\n\r\nFigure 10 below shows the breakdown of the top six unique cloud and SaaS secrets stolen and grouped by their respective provider.\r\n\r\n[caption id=\"attachment_136335\" align=\"alignnone\" width=\"782\"] Figure 10. Top six cloud and SaaS platforms identified in the .env files.[\/caption]\r\n\r\nPlease note that Unit 42 did not assess the validity of these credentials. Through the malicious lambda function, the threat actor gained access to several types of credentials. Unit 42 assesses with high confidence that the threat actor likely leveraged the stolen secrets to carry out further acts against victims.\r\n\r\nWe notified AWS about the availability of the public bucket and its role in an ongoing compromise. Shortly after notification, the public bucket was no longer available.\r\nNetwork Analysis\r\nWhen reviewing the different components discussed in this article, we identified various correlations based on network indicators.\r\n\r\nThe graph displayed in Figure 11 shows network correlations by IP address, user-agent and exit point type. After careful examination of the malicious network traffic, we identified the following exit point categories:\r\n\r\n \tVPN exit node: Known VPN exit point\r\n \tTor exit node: Tor network\r\n \tVPS exit node: Hosting provider\r\n \tInstitution exit node: IP was currently allocated and used by the institution\r\n \tISP exit node: Internet service provider, giving services directly to users\r\n \tCloud exit node: The access was performed from a cloud provider\r\n\r\n[caption id=\"attachment_136337\" align=\"alignnone\" width=\"1562\"] Figure 11. Network graph of malicious access for all incidents.[\/caption]\r\n\r\nWe used internal and public data sources to categorize the originating IP addresses used by the threat actors during this campaign according to the exit node type. The activity in Figure 11 above represents access attempts the threat actor performed using the AWS IAM credentials either discovered from the victim\u2019s exposed environment file or from IAM roles created by the threat actor.\r\n\r\nThe threat actor operated discreetly using Tor network connections when creating the lambda function activities. After that, the threat actor pivoted to using a VPN for all S3 access and exfiltration using the S3 Browser tool. However, the threat actor made a connection from a controlled AWS account to access S3 customer internal buckets. This event left a trace on AWS-hosted infrastructure that we could follow.\r\n\r\nWe assess with medium to high confidence that the threat actor accessed the compromised victims\u2019 AWS environment from IP addresses directly assigned to ISPs. This operational security (OPSEC) misstep allowed us to determine, with medium confidence, the threat actor\u2019s general geographic location.\r\n\r\nUnit 42 determined one ISP IP address was geolocated in Ukraine and appeared in part of the lambda function activity. The second ISP IP address was geolocated in Morocco and was associated with the S3 access and exfiltration. Based on the user-agents and time between API calls, we determined the threat actor manually performed these access operations, which leaked the threat actor's possible physical location.\r\nCost and Usage Reports\r\nLogs are essential for effective incident response, and an ideal environment has all logging options enabled. To identify exfiltration events from S3 buckets with granularity, organizations should enable S3 access logging or CloudTrail data events logging prior to an incident occurring.\r\n\r\nBoth forms of logging help organizations identify GetObject API calls (e.g., the data being fetched) and DeleteObject API calls (e.g., the data being deleted). Both S3 access logging and CloudTrail event logging record the IP addresses and user agents for each request made to the target bucket.\r\n\r\nIt\u2019s important to note that neither of these log sources are enabled by default, and they will increase costs for the organization\u2019s cloud environment. However, enabling logging for these sources will greatly assist in the identification and alerting of malicious cloud operations.\r\n\r\nHowever, if neither CloudTrail event logging nor S3 access logs are enabled at the time of an incident, there is still hope. Leveraging the Cost and Usage report for S3 can allow organizations to identify spikes in the occurrences of the API calls for GetObject (bytes out) and DeleteObject (bytes deleted) events.\r\n\r\nThere are drawbacks in leveraging Cost and Usage Reports to identify exfiltration operations. Organizations can only identify high-level activity that occurred within the bucket and the data can only be aggregated into hourly, daily or monthly time frames as shown in Figure 12. This prevents organizations from investigating individual events or retrieving the metadata associated with each of the events.\r\n\r\n[caption id=\"attachment_136339\" align=\"alignnone\" width=\"937\"] Figure 12. Cost and Usage Report line item examples.[\/caption]\r\n\r\nThe GetObject and DeleteObject Cost and Usage Activity records bytes out or bytes deleted, respectively. Using these reports, we have successfully assessed the likelihood that exfiltration events have occurred, pointing to key time frames when there are anomalous spikes in activity.\r\nRemediation\r\nIn a majority of these attacks, threat actors obtained long-term IAM access keys allowing them to move into the control plane with no time limit to their credentials. Unless an application or workload requires the use of an access key, IAM roles provide the same ability as access keys, but they are temporary. Using temporary credentials limits the amount of time a threat actor has access to an account.\r\n\r\nAnother way to protect against these attacks is following the principle of least privilege when provisioning permissions. Limiting the permissions associated with an IAM resource limits the scope of what a compromised credential can perform (e.g., restricting identities that can perform iam:CreateRole and iam:AttachRolePolicy). That way even if a threat actor were to successfully gain access to long-term or short-term credentials, they wouldn\u2019t have enough permissions to execute their malicious actions.\r\n\r\nAdditionally, disabling all unused regions within an AWS account also protects against these attacks. Threat actors deploy resources in multiple regions to attempt to remain undetected, so disabling all unused regions prevents the threat actors from hiding their attacks.\r\n\r\nAnd finally, enabling logging and establishing a monitoring process is vital to protecting an organization's resources. Regarding AWS, enabling basic logging such as CloudTrail and VPC flow logs provides the base level of visibility into an environment. Amazon GuardDuty also contains a variety of features to help protect against threats to EC2 instances and credential exploitation.\r\n\r\nDepending on the AWS services used, organizations will want to ensure they enable the specific logging unique to that service. After organizations establish the proper logging and retention of that data (90 days minimum retention recommended), then the focus shifts to monitoring those data sources.\r\n\r\nAWS\u2019s GuardDuty provides a base level of alerting, but each organization should review what services they use and how abnormal activity might appear in the logs. From there, organizations should create alerts for abnormal activity.\r\nConclusion\r\nWe identified a wide-scale extortion operation that resulted in the successful compromise of several cloud environments. The initial access used within the extortion campaign was the direct result of exposed environment files (.env) files within the victim organization's web applications.\r\n\r\nBy targeting .env files, the threat actor was able to collect the exposed environment files of at least 110,000 domains. We identified over 90,000 unique leaked environment variables of which 7,000 were associated with cloud services and 1,500 were associated with social media accounts, oftentimes including account names in addition to authentication secret keys.\r\nProtections and Mitigations\r\nFor Palo Alto Networks customers, our products and services provide the following coverage associated with the threats described above:\r\n\r\n \tNext-Generation Firewall and Advanced WildFire accurately identify known samples as malicious.\r\n \tAdvanced URL Filtering and Advanced DNS Security identify domains associated with this group as malicious.\r\n \tCortex XDR and XSIAM\r\n\r\n \tPrevent the execution of known malicious malware, and also prevent the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module.\r\n \tProtect against credential gathering tools and techniques using the new Credential Gathering Protection available from Cortex XDR 3.4.\r\n \tCortex XDR Pro detects post-exploit activity, including credential-based attacks, with behavioral analytics.\r\n\r\n\r\n \tPrisma Cloud\r\n\r\n \tAttack Path Policies are built on a unified data model that automatically correlates findings across cloud misconfigurations, vulnerabilities, excessive IAM permissions and network exposures. When combined with Unit 42 Threat Intelligence, coupled with machine learning (ML) and user and entity behavior analytics (UEBA), security teams can detect exploited attack paths.\r\n \tWhen paired with the WildFire integration, the Prisma Cloud Defender agent will identify malicious binaries and make verdict determinations when analyzing executing processes.\r\n \tWhen paired with XSIAM, the Prisma Cloud Defender is enabled to block malicious processes from operating within the cloud environment.\r\n \tPrevents the execution of known malicious malware, and also prevents the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module.\r\n\r\n\r\n\r\nHunting, Investigation and Detection Queries\r\nThe following queries are intended to assist Palo Alto Networks customers in hunting, investigating and detecting potentially malicious operations within their Cortex XDR and Prisma Cloud platforms. The results of these queries should not be taken as malicious on face value. The queries require careful examination of the resulting events before they can be found malicious.\r\n\r\nPay close attention to the source IP addresses, user agent and the ARNs for each event. If ARNs are being created, modified or deleted, investigate for unwanted modifications to critical infrastructure or the creation of unknown or suspicious ARN names. Unit 42 IR services are available for anyone who\u2019s determined they have been breached, compromised or otherwise affected by malicious events.\r\nCortex XQL Queries\r\nIAM\r\ndataset=amazon_aws_raw\r\n\r\n| filter eventName in (\"CreateRole\", \"AttachRolePolicy\")\r\nSecurity Groups\r\ndataset=amazon_aws_raw \r\n| filter eventName in (\"CreateSecurityGroup\", \r\n\"AuthorizeSecurityGroupIngress\")\r\nEC2\r\ndataset=amazon_aws_raw\r\n\r\n| filter eventName in (\"CreateKeyPair\", \"RunInstances\")\r\nLambda\r\ndataset=amazon_aws_raw\r\n\r\n| filter eventName in (\"CreateFunction20150331\", \"CreateLogGroup\", \"CreateLogStream\")\r\nPrisma Cloud RQL Queries\r\nIAM\r\nevent from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateRole', 'AttachRolePolicy' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn\r\nSecurity Groups\r\nevent from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateSecurityGroup', 'AuthorizeSecurityGroupIngress' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn\r\nEC2\r\nevent from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateKeyPair', 'RunInstances' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn\r\nLambda\r\nevent from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateFunction20150331', 'CreateLogGroup', 'CreateLogStream' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn\r\nPrisma Cloud Attack Path Alerting\r\nPrisma Cloud Attack Paths offer a unique view into the configuration of cloud environments. By linking potential architectural misconfigurations, attack path alerts allow security operation center (SOC) personnel the ability to zero in on potential malicious cloud events.\r\n\r\nBy combining DevOps configurations and behavioral anomaly detection rules, attack path alerts trigger if a combination of event operations takes place. These alerts scale with the dynamic nature of cloud environments and allow SOC teams to maintain awareness of security events across multiple cloud platforms.\r\n\r\nWhile there are many Attack Path Policies that could assist organizations, the following Attack Path Policies could assist SOC and DevOps teams monitor and maintain cloud security:\r\n\r\n \tCredential exposure risk due to a publicly exposed and unauthenticated AWS Lambda function with risky credential exposure permissions\r\n \tCredential exposure risk due to a publicly exposed and vulnerable EC2 instance with risky credential exposure permissions\r\n \tCredential exposure risk due to malware in Amazon EC2 instances with risky credential exposure permissions\r\n \tData breach risk due to a publicly exposed and unauthenticated AWS Lambda function with Amazon RDS database SQL query execution permissions\r\n \tData breach risk due to AWS S3 bucket containing sensitive data not configured with access log feature and is accessible by unmonitored cloud accounts\r\n \tData exposure and data loss risk due to a publicly exposed unauthenticated AWS Lambda function with permissions over sensitive S3 configuration\r\n\r\nIndicators of Compromise\r\nURL\r\n\r\n \thttps[:]\/\/github[.]com\/brentp\/gargs\/releases\/download\/v0.3.9\/gargs_linux (not malicious, used by the lambda function)\r\n\r\nIPv4\r\nTor Exit Nodes\r\n\r\n \t109.70.100[.]71\r\n \t144.172.118[.]62\r\n \t176.123.8[.]245\r\n \t185.100.85[.]25\r\n \t185.100.87[.]41\r\n \t185.220.101[.]190\r\n \t185.220.101[.]19\r\n \t185.220.101[.]21\r\n \t185.220.101[.]29\r\n \t185.220.101[.]30\r\n \t185.220.101[.]86\r\n \t185.220.103[.]113\r\n \t192.42.116[.]181\r\n \t192.42.116[.]187\r\n \t192.42.116[.]18\r\n \t192.42.116[.]192\r\n \t192.42.116[.]199\r\n \t192.42.116[.]201\r\n \t192.42.116[.]208\r\n \t192.42.116[.]218\r\n \t198.251.88[.]142\r\n \t199.249.230[.]161\r\n \t45.83.104[.]137\r\n \t62.171.137[.]169\r\n \t80.67.167[.]81\r\n \t89.234.157[.]254\r\n \t94.142.241[.]194\r\n \t95.214.234[.]103\r\n\r\nVPS Endpoints\r\n\r\n \t125.20.131[.]190\r\n \t196.112.184[.]14\r\n \t46.150.66[.]226\r\n \t49.37.170[.]97\r\n\r\nVPN Endpoints\r\n\r\n \t139.99.68[.]203\r\n \t141.95.89[.]92\r\n \t146.70.184[.]10\r\n \t178.132.108[.]124\r\n \t193.42.98[.]65\r\n \t193.42.99[.]169\r\n \t193.42.99[.]50\r\n \t193.42.99[.]58\r\n \t195.158.248[.]220\r\n \t195.158.248[.]60\r\n \t45.137.126[.]12\r\n \t45.137.126[.]16\r\n \t45.137.126[.]18\r\n \t45.137.126[.]41\r\n \t45.94.208[.]42\r\n \t45.94.208[.]63\r\n \t45.94.208[.]76\r\n \t45.94.208[.]85\r\n \t72.55.136[.]154\r\n \t95.214.216[.]158\r\n \t95.214.217[.]173\r\n \t95.214.217[.]224\r\n \t95.214.217[.]242\r\n \t95.214.217[.]33\r\n\r\nHash\r\n\r\n \tSHA256 for Lambda.sh - 64e6ce23db74aed7c923268e953688fa5cc909cc9d1e84dd46063b62bd649bf6\r\n\r\nUpdated title Sept. 3, 2024, at 1:1o p.m. PT for clarity.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/08\/02_Cloud_cybersecurity_research_Overview_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Margaret Kelley"},{"@type":"Person","name":"Sean Johnstone"},{"@type":"Person","name":"William Gamazo"},{"@type":"Person","name":"Nathaniel Quist"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":136313,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"c3b9727a80","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"d123c4ca65"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/136313" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=136313' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-136313 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/" role="link" title="Cloud Cybersecurity Research" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:breadcrumb:Cloud Cybersecurity Research">Cloud Cybersecurity Research</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Cloud Cybersecurity Research"><span class="ab-title__pre">Cloud Cybersecurity Research</span></a> 
              <h1>Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 18</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-dns-security/" style="--card-color: #ffcb06" role="link" title="Advanced DNS Security" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Advanced DNS Security"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced DNS Security icon">Advanced DNS Security</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-url-filtering/" style="--card-color: #ffcb06" role="link" title="Advanced URL Filtering" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Advanced URL Filtering"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced URL Filtering icon">Advanced URL Filtering</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cloud-delivered-security-services/" style="--card-color: #ffcb06" role="link" title="Cloud-Delivered Security Services" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Cloud-Delivered Security Services"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Cloud-Delivered Security Services icon">Cloud-Delivered Security Services</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/code-to-cloud-platform/" style="--card-color: #00c0e8" role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Code to Cloud Platform"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Code to Cloud Platform icon">Code to Cloud Platform</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex/" style="--card-color: #00cc66" role="link" title="Cortex" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Cortex"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex icon">Cortex</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xsiam/" style="--card-color: #00cc66" role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Cortex XSIAM"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XSIAM icon">Cortex XSIAM</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/next-generation-firewall/" style="--card-color: #ffcb06" role="link" title="Next-Generation Firewall" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Next-Generation Firewall"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Next-Generation Firewall icon">Next-Generation Firewall</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/prisma-cloud/" style="--card-color: #00c0e8" role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Prisma Cloud"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Prisma Cloud icon">Prisma Cloud</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/unit-42-incident-response/" style="--card-color: #c94727" role="link" title="Unit 42 Incident Response" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Unit 42 Incident Response"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Unit 42 Incident Response icon">Unit 42 Incident Response</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Margaret Kelley" href="https://unit42.paloaltonetworks.com/author/margaret-kelley/">Margaret Kelley</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Sean Johnstone" href="https://unit42.paloaltonetworks.com/author/sean-johnstone/">Sean Johnstone</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:William Gamazo" href="https://unit42.paloaltonetworks.com/author/william-gamazo/">William Gamazo</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Nathaniel Quist" href="https://unit42.paloaltonetworks.com/author/nathaniel-quist/">Nathaniel Quist</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>15 August, 2024 at 3:00 AM PDT</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Cloud Cybersecurity Research" href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/">Cloud Cybersecurity Research</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:AWS" href="https://unit42.paloaltonetworks.com/tag/aws/">AWS</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:credential theft" href="https://unit42.paloaltonetworks.com/tag/credential-theft/">Credential theft</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:data exfiltration" href="https://unit42.paloaltonetworks.com/tag/data-exfiltration/">Data exfiltration</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:ENV files" href="https://unit42.paloaltonetworks.com/tag/env-files/">ENV files</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:environment variable files" href="https://unit42.paloaltonetworks.com/tag/environment-variable-files/">Environment variable files</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Exploit Kits" href="https://unit42.paloaltonetworks.com/tag/exploit-kits/">Exploit Kits</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:exposed environment files" href="https://unit42.paloaltonetworks.com/tag/exposed-environment-files/">Exposed environment files</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Extortion" href="https://unit42.paloaltonetworks.com/tag/extortion/">Extortion</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:HoneyCloud" href="https://unit42.paloaltonetworks.com/tag/honeycloud/">HoneyCloud</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:MITRE" href="https://unit42.paloaltonetworks.com/tag/mitre/">MITRE</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:onion routing" href="https://unit42.paloaltonetworks.com/tag/onion-routing/">Onion routing</a></li><li><a data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:Tor" href="https://unit42.paloaltonetworks.com/tag/tor/">Tor</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/?pdf=download&#038;lg=en&#038;_wpnonce=dcff69efdc" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/?pdf=print&#038;lg=en&#038;_wpnonce=dcff69efdc" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" role="link" title="Copy link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Leaked%20Environment%20Variables%20Allow%20Large-Scale%20Extortion%20Operation%20in%20Cloud%20Environments&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F&#038;title=Leaked%20Environment%20Variables%20Allow%20Large-Scale%20Extortion%20Operation%20in%20Cloud%20Environments" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F&#038;text=Leaked%20Environment%20Variables%20Allow%20Large-Scale%20Extortion%20Operation%20in%20Cloud%20Environments" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Leaked%20Environment%20Variables%20Allow%20Large-Scale%20Extortion%20Operation%20in%20Cloud%20Environments%20https%3A%2F%2Funit42.paloaltonetworks.com%2Flarge-scale-cloud-extortion-operation%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <h1><a id="post-136313-_xb4v8ncdmx83"></a>Executive Summary</h1>
<p>Unit 42 researchers found an extortion campaign's cloud operation that successfully compromised and extorted multiple victim organizations. It did so by leveraging exposed environment variable files (<span style="font-family: 'courier new', courier, monospace;">.env</span> files) that contained sensitive variables such as credentials belonging to various applications.</p>
<p>Multiple security missteps were present in the course of this campaign, including the following:</p>
<ul>
<li>Exposing environment variables</li>
<li>Using long-lived credentials</li>
<li>Absence of least privilege architecture</li>
</ul>
<p>The campaign operation set up its attack infrastructure within various organizations’ Amazon Web Services (AWS) environments and used that groundwork to scan more than 230 million unique targets for sensitive information.</p>
<p>This campaign targeted 110,000 domains resulting in over 90,000 unique variables in the <span style="font-family: 'courier new', courier, monospace;">.env</span> files. Of those variables, 7,000 belonged to organizations' cloud services and we traced 1,500 variables back to social media accounts. Additionally, attackers used multiple source networks to facilitate the operation.</p>
<p>Based on our research, the attackers used the following for this extortion campaign:</p>
<ul>
<li>The onion router (Tor) network to perform reconnaissance and initial access operations</li>
<li>Virtual private networks (<a href="https://www.geeksforgeeks.org/what-is-vpn-and-how-it-works/" target="_blank" rel="noopener">VPN</a>) to achieve lateral movement and perform data exfiltration</li>
<li>Virtual private server (<a href="https://www.geeksforgeeks.org/difference-between-vps-and-vds/" target="_blank" rel="noopener">VPS</a>) endpoints for other aspects of the campaign</li>
</ul>
<p>The campaign involved attackers successfully ransoming data hosted within cloud storage containers. The event did not include attackers encrypting the data before ransom, but rather they exfiltrated the data and placed the ransom note in the compromised cloud storage container.</p>
<p>Moreover, the attackers behind this campaign likely leveraged extensive automation techniques to operate successfully and rapidly. This indicates that these threat actor groups are both skilled and knowledgeable in advanced cloud architectural processes and techniques.</p>
<p>Note that the attackers’ success relied on misconfigurations in victim organizations that inadvertently exposed their <span style="font-family: 'courier new', courier, monospace;">.env</span> files. It did not result from vulnerabilities or misconfigurations in cloud providers’ services.</p>
<p>This post will detail the cloud extortion campaign by examining different <a href="https://attack.mitre.org/tactics/enterprise/" target="_blank" rel="noopener">tactics from the MITRE ATT&amp;CK framework</a> as we recount and explain the events.</p>
<p>Palo Alto Networks customers are better protected from the threats discussed in this article through detection mechanisms available from the following products:</p>
<ul>
<li><a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall" target="_blank" rel="noopener">Next-Generation Firewall</a></li>
<li><a href="https://www.paloaltonetworks.com/network-security/advanced-wildfire" target="_blank" rel="noopener">Advanced WildFire</a></li>
<li><a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security" target="_blank" rel="noopener">Advanced DNS Security</a></li>
<li><a href="https://www.paloaltonetworks.com/network-security/advanced-url-filtering" target="_blank" rel="noopener">Advanced URL Filtering</a></li>
<li><a href="https://www.paloaltonetworks.com/prisma/cloud" target="_blank" rel="noopener">Prisma Cloud</a>, <a href="https://www.paloaltonetworks.com/cortex/cortex-xdr" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam" target="_blank" rel="noopener">XSIAM</a> can be leveraged to protect and monitor your cloud environments.</li>
</ul>
<p>If you think you might have been compromised or have an urgent matter, contact the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response</a> team.</p>
<table style="width: 100%;">
<thead>
<tr>
<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/tag/extortion/" target="_blank" rel="noopener"><b>Extortion</b></a></td>
</tr>
</thead>
</table>
<h2><a id="post-136313-_3pf8wq67mcxf"></a>Background</h2>
<p>This article exposes an extortion operation that targeted cloud environments and leveraged the dynamic scalability of cloud platforms. It also leveraged multiple cloud services to successfully hold organizations’ cloud data to ransom.</p>
<p>The events discussed within this post took place within a cloud environment where the account operators deployed and used overly permissive IAM credentials. These credentials allowed the threat actors to perform several operations that would not have been possible if the account operators followed <a href="https://www.paloaltonetworks.com/resources/prisma-resource-center" target="_blank" rel="noopener">cloud security best practices</a>.</p>
<p>Attackers obtained initial access to victims' cloud environments through exposed environment files (<span style="font-family: 'courier new', courier, monospace;">.env</span>) files within the victim organization's web applications. Due to the security risks associated with authentication data stored inside <span style="font-family: 'courier new', courier, monospace;">.env</span> files, <strong>organizations should follow </strong><a href="https://dev.to/khalidk799/environment-variables-its-best-practices-1o1o" target="_blank" rel="noopener"><strong>security best practices</strong></a> to never expose environment files publicly.</p>
<p>Environment files allow users to define configuration variables used within applications and platforms. These files often contain secrets such as hard-coded cloud provider access keys, software-as-a-service (SaaS) API keys and database login information then used by the threat actor for initial access.</p>
<p>The attack pattern of scanning the internet for domains and exploiting credentials obtained from exposed environment variable files follows a larger pattern we believe propagates through other compromised AWS environments.</p>
<p>Note: The presence of these secrets resulted from misconfigurations of victim organizations who inadvertently exposed their <span style="font-family: 'courier new', courier, monospace;">.env</span> files. None of the listed vendors’ applications or services had vulnerabilities or misconfigurations that resulted in this exposure.</p>
<h2><a id="post-136313-_sdajm9gacs7h"></a>Initial Access (MITRE ATT&amp;CK Technique TA0001)</h2>
<p>The activity discussed in this post resulted from exposed AWS Identity and Access Management (IAM) <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html" target="_blank" rel="noopener">access keys</a> obtained from publicly accessible <span style="font-family: 'courier new', courier, monospace;">.env</span> files. The threat actors located these access keys by scanning and identifying exposed <span style="font-family: 'courier new', courier, monospace;">.env</span> files hosted on unsecured web applications. Once the actors identified the exposed access keys, they used those keys to gain access to the hosting cloud environment.</p>
<p>Unit 42 has responded to a variety of incidents involving AWS environments over the last 12 months, including a <a href="https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/" target="_blank" rel="noopener">previously reported incident</a> involving a zero-day vulnerability within the SugarCRM platform. We continue to see a <a href="https://unit42.paloaltonetworks.com/iam-cloud-threat-research" target="_blank" rel="noopener">growing trend</a> of attackers targeting cloud IAM credentials leading to initial access of organizations’ cloud environments.</p>
<p>The most common initial access vectors for this particular threat originate from organizations inadvertently misconfiguring servers, subsequently exposing sensitive files to the public internet, with the most frequently exposed files being <span style="font-family: 'courier new', courier, monospace;">.env</span> files.</p>
<h2><a id="post-136313-_dq8eqn5pvv35"></a>Discovery (MITRE ATT&amp;CK Technique TA0007)</h2>
<p>The threat actor behind this activity performed various discovery API calls to learn more about the environment and select services to exploit. These discovery operations targeted various services such as the following:</p>
<ul>
<li>IAM</li>
<li>Security Token Service (STS)</li>
<li>Simple Storage Service (S3)</li>
<li>Simple Email Service (SES).</li>
</ul>
<p>We found these aforementioned services targeted by threat actors while they looked to expand their operation’s control over an organization's cloud environment.</p>
<p>At the beginning of every operation for the discovery phase in this campaign, attackers ran the <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_GetCallerIdentity.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetCallerIdentity</span></a> API call to verify the identity of the user or role assigned to the exposed IAM credential. <span style="font-family: 'courier new', courier, monospace;">GetCallerIdentity</span> is the AWS version of <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">whoami</span></a>. It returns information about the IAM credentials <span style="font-weight: 400;">–</span> associated UserID, AWS account number and the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference-arns.html" target="_blank" rel="noopener">Amazon Resource Name (ARN)</a> <span style="font-weight: 400;">–</span> of the principal used to initiate the request, as shown in Figure 1.</p>
<figure id="attachment_136317" aria-describedby="caption-attachment-136317" style="width: 500px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136317" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-481578-136313-1-786x251.png" alt="Image 1 is a screenshot of GetCallerIdentity calling a response. " width="500" height="160" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-481578-136313-1-786x251.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-481578-136313-1-768x246.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-481578-136313-1-1536x491.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-481578-136313-1.png 1570w" sizes="(max-width: 500px) 100vw, 500px" /><figcaption id="caption-attachment-136317" class="wp-caption-text">Figure 1. Example <span style="font-family: 'courier new', courier, monospace;">GetCallerIdentity</span> and response.</figcaption></figure>
<p>For background, the AWS UserID is a unique identifier of the entity that performed the call. The AWS account number is the unique 12-digit identifier of the AWS account to which the UserID belongs.</p>
<p>The ARN includes the AWS account number and human-readable name of the principal performing the call. Every cloud resource has a unique ARN within an AWS account that, for example, can be subsequently used as a reference to that entity in CloudTrail logs or <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html" target="_blank" rel="noopener">CloudFormation</a> templates.</p>
<p>The ARN states the following information:</p>
<ul>
<li>The AWS service it’s associated with</li>
<li>Region hosting the AWS resource, but for global services like IAM the region is left blank</li>
<li>The AWS account it's located in</li>
<li>The IAM resource type associated with this IAM credential (e.g., user, role, or group)</li>
</ul>
<p>Attackers also successfully attempted the AWS API request <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_ListUsers.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">ListUsers</span></a> to gather a list of IAM users in the AWS account as well as the API request <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListBuckets.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">ListBuckets</span></a> to identify all the existing S3 buckets. These operations give the attackers additional insight into what IAM users exist that they could exploit for future lateral movement, and they provide S3 bucket names for data exfiltration targets.</p>
<p>The threat actors then successfully performed more extensive discovery operations against AWS SES with the following API calls:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/ses/latest/APIReference/API_GetSendQuota.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetSendQuota</span></a></li>
<li><a href="https://docs.aws.amazon.com/ses/latest/APIReference/API_ListVerifiedEmailAddresses.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">ListVerifiedEmailAddresses</span></a></li>
<li><a href="https://docs.aws.amazon.com/ses/latest/APIReference/API_GetAccountSendingEnabled.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetAccountSendingEnabled</span></a></li>
<li><a href="https://docs.aws.amazon.com/ses/latest/APIReference-V2/API_GetAccount.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetAccount</span></a></li>
<li><a href="https://docs.aws.amazon.com/ses/latest/APIReference/API_ListIdentities.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">ListIdentities</span></a></li>
</ul>
<p>While the threat actor did not successfully use SES beyond the initial discovery operations listed above during this campaign, we have found that attackers often target and leverage the SES service to <a href="https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/" target="_blank" rel="noopener">send phishing messages</a> to potential victims. By leveraging legitimate SES services for phishing attacks, a threat actor's malicious emails originate from a trusted source, often allowing them to evade an organization’s defenses.</p>
<p>All of these various events provided the threat actor with a strong baseline understanding of what resources existed throughout the environment and where they could pivot.</p>
<h2><a id="post-136313-_a0nz3wktwupv"></a>Privilege Escalation (MITRE ATT&amp;CK Tactic TA0004)</h2>
<p>Following the threat actor’s discovery operations, they identified that the original IAM credential used to gain initial access to the cloud environment did not have administrator access to all cloud resources. We determined that the attackers discovered the original IAM role used for initial access did have the permissions to both create new IAM roles and attach IAM policies to existing roles. Using these capabilities, the attacker successfully escalated their privileges within victim cloud environments by creating new IAM resources with unlimited access.</p>
<p>To accomplish this, they first created an IAM role named <span style="font-family: 'courier new', courier, monospace;">lambda-ex</span> with the API request <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateRole.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">CreateRole</span></a>, then used the API call <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachRolePolicy.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">AttachRolePolicy</span></a> to attach the AWS-managed policy <span style="font-family: 'courier new', courier, monospace;">AdministratorAccess</span> to the newly created <span style="font-family: 'courier new', courier, monospace;">lambda-ex</span> role, as shown in Figure 2.</p>
<figure id="attachment_136319" aria-describedby="caption-attachment-136319" style="width: 245px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136319 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-484536-136313-2.png" alt="Image 2 is a screenshot of the JSON permissions for the AdministratorAccess policy." width="245" height="167" /><figcaption id="caption-attachment-136319" class="wp-caption-text">Figure 2. JSON permissions for the <span style="font-family: 'courier new', courier, monospace;">AdministratorAccess</span> policy.</figcaption></figure>
<p>These two IAM events resulted in a new IAM role with administrative permissions, within the compromised AWS account, completing the threat actor’s privilege escalation portion of the attacks. In the following section, we discuss how the threat actors used this role to grant unfettered access to their newly created lambda functions.</p>
<h2><a id="post-136313-_b9qqlj6bq5w2"></a>Execution (MITRE ATT&amp;CK Tactic TA0002)</h2>
<p>Following the successful creation of the privileged IAM role, the threat actor attempted to create two different infrastructure stacks, one using <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html" target="_blank" rel="noopener">Amazon Elastic Cloud Compute</a> (EC2) resources and the other with AWS <a href="https://docs.aws.amazon.com/lambda/latest/dg/welcome.html" target="_blank" rel="noopener">Lambda</a>. By performing these execution tactics, the actors failed to create a security group, key pair and EC2 instance, but they successfully created multiple lambda functions with the newly created IAM role attached.</p>
<p>The threat actor attempted to create new EC2 resources to use for cryptomining based on the size of the instance. They successfully created new Lambda functions for their automated scanning operation.</p>
<h3><a id="post-136313-_6hsyyttfnne4"></a>Failed EC2 Creation</h3>
<p>During these failed operations, the attackers first attempted to perform the API call <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateSecurityGroup.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">CreateSecurityGroup</span></a> and named the group <span style="font-family: 'courier new', courier, monospace;">security</span>. Then they ran <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AuthorizeSecurityGroupIngress.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">AuthorizeSecurityGroupIngress</span></a> to create an ingress rule allowing all ports from <span style="font-family: 'courier new', courier, monospace;">0 - 65535</span> from any IP address (<span style="font-family: 'courier new', courier, monospace;">0.0.0.0/0</span>). Following that, they attempted to <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateKeyPair.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">CreateKeyPair</span></a> and <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_RunInstances.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">RunInstances</span></a> with <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html" target="_blank" rel="noopener">Amazon Machine Image (AMI) ID</a> <span style="font-family: 'courier new', courier, monospace;">ami-08e8725a42775740f</span> and an EC2 <a href="https://aws.amazon.com/ec2/instance-types/" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">c6g</span></a> instance type.</p>
<p>C-series instances are compute optimized virtual machines, which are ideal for computationally intensive workloads. As such, malicious actors have often used these instances for <a href="https://unit42.paloaltonetworks.com/malicious-operations-of-exposed-iam-keys-cryptojacking/" target="_blank" rel="noopener">cryptojacking operations</a>.</p>
<p>The AMI ID belonged to a publicly accessible Ubuntu 18.04 LTS image in the <span style="font-family: 'courier new', courier, monospace;">us-east-1</span> <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html" target="_blank" rel="noopener">region</a> and the <span style="font-family: 'courier new', courier, monospace;">c6g</span> instance type family ran on AWS Graviton2 processors built for compute-intensive workloads.</p>
<p>All of these actions took place in under a minute, indicating a pre-scripted, automated activity. However, these actions failed due to limited permissions associated with the compromised IAM user.</p>
<h3><a id="post-136313-_l50mxhroucv2"></a>Successful Lambda Function Creation</h3>
<p>Following the failed EC2 service actions, the threat actor successfully pivoted to the <a href="https://docs.aws.amazon.com/lambda/latest/dg/welcome.html" target="_blank" rel="noopener">AWS Lambda service</a>, a cloud-based serverless computation service, where they used the granted permissions obtained from the exposed IAM credential. Their first operation created a new lambda function using the <a href="https://docs.aws.amazon.com/lambda/latest/api/API_CreateFunction.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">CreateFunction20150331</span></a> API call in the AWS region<span style="font-family: 'courier new', courier, monospace;"> us-east-1</span>, which created a new lambda function named <span style="font-family: 'courier new', courier, monospace;">ex</span>. We will go into a deep dive into the lambda function’s code and its purpose in the next section.</p>
<p>Once the threat actor successfully created the first lambda function, they automatically deployed that same lambda function into every other enabled region in the account within a second. As part of the default lambda function creation process, the role attached to the lambda function automatically performs a <a href="https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_CreateLogGroup.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">CreateLogGroup</span></a> API call followed by <a href="https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_CreateLogStream.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">CreateLogStream</span></a>, which begins the process of logging all lambda function operations.</p>
<p>The <span style="font-family: 'courier new', courier, monospace;">CreateLogGroup</span> event created a new <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html" target="_blank" rel="noopener">CloudWatch</a> log group containing the name of the newly created lambda <span style="font-family: 'courier new', courier, monospace;">/aws/lambda/ex</span>. Each log stream within the log group aggregates various lambda run information by date. This allowed us to successfully follow the threat actor's operations using the lambda function <span style="font-family: 'courier new', courier, monospace;">ex</span> they created. It is important to note that the lambda function’s logging creation process is automated and attackers cannot turn it off.</p>
<p>The threat actor created a malicious lambda function by leveraging the stolen IAM user credentials. The Unit 42 reverse engineering team analyzed the malicious lambda function, which consisted of a bash script configured to perform internet-wide scanning using a preconfigured set of sources containing millions of domains and IP addresses. Figure 3 displays the complete code of the lambda function.</p>
<figure id="attachment_136321" aria-describedby="caption-attachment-136321" style="width: 786px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136321 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-486806-136313-3-786x336.png" alt="Image 3 is a screenshot of many lines code. Is that it is the lambda function bash script. " width="786" height="336" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-486806-136313-3-786x336.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-486806-136313-3-768x329.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-486806-136313-3.png 1493w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-136321" class="wp-caption-text">Figure 3. The lambda function bash script.</figcaption></figure>
<p>The script retrieved a list of potential targets from a publicly accessible third-party S3 bucket exploited by the threat actor. We believe the threat actor hosted these third-party S3 buckets within other compromised and legitimate cloud environments, and the threat actor leveraged these resources in this attack. The list of potential targets the malicious lambda function iterated over contained a record of victim domains. For each domain in the list, the code performed a <a href="https://curl.se/docs/manpage.html" target="_blank" rel="noopener">cURL</a> request, targeting any environment variable files exposed at that domain, (i.e., <span style="font-family: 'courier new', courier, monospace;">http://&lt;target&gt;/.env</span>).</p>
<p>Upon successfully retrieving the domain’s exposed environment file, the lambda function uncovered and identified cleartext credentials contained within the file. Once the lambda function identified the credentials, it stored them in a newly created folder within another threat-actor-controlled public S3 bucket.</p>
<p>The malicious lambda function specifically targeted instances where the <span style="font-family: 'courier new', courier, monospace;">.env</span> file referenced the string <span style="font-family: 'courier new', courier, monospace;">mailgun</span> as seen on line 24 within Figure 3. With these compromised <a href="https://www.mailgun.com/" target="_blank" rel="noopener">Mailgun</a> credentials, threat actors can send large-scale phishing attacks against organizations from legitimate domains, making their attacks more likely to bypass security protections. We accessed the publicly exposed threat actor’s public S3 bucket and assessed that the threat actor could copy the exposed <span style="font-family: 'courier new', courier, monospace;">.env</span> files of at least 110,000 domains.</p>
<p>The following diagram, Figure 4, shows the threat actor’s architectural design for scanning and retrieving the exposed authentication credentials in the <span style="font-family: 'courier new', courier, monospace;">.env</span> files.</p>
<figure id="attachment_136323" aria-describedby="caption-attachment-136323" style="width: 1731px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136323 size-large" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-489494-136313-4-1731x700.png" alt="Image 4 is a diagram of a high-level operational architecture by a threat actor. From left to right: AWS lambda function created with stolen credentials. The AWS cloud is represented by a blue rectangle. Inside the cloud rectangle are two smaller boxes, outlined in yellow. These represent the threat actor controller owned AWS account (left), and the compromised AWS account (right). In the threat actor controlled account is one bucket that has the Amazon S3 domains, and the IP address sources. Also in the bucket is the amazon S3 .ENV file found leaks. In the compromised AWS account is the AWS lambda. A red arrow goes from the threat actor-controlled box to the AWS lambda account, and then back to the bucket. An arrow leads from the AWS lambda in the compromised AWS account to the HTTP hostname dot env. " width="1731" height="700" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-489494-136313-4-1731x700.png 1731w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-489494-136313-4-786x318.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-489494-136313-4-768x311.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-489494-136313-4-1536x621.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-489494-136313-4.png 2048w" sizes="(max-width: 1731px) 100vw, 1731px" /><figcaption id="caption-attachment-136323" class="wp-caption-text">Figure 4. High-level example of the threat actor's operational architecture.</figcaption></figure>
<p>We believe this design is part of a larger, fully automated operation based upon some of the S3 bucket naming conventions alone (e.g., <span style="font-family: 'courier new', courier, monospace;">s3://&lt;REDACTED&gt;/ref5/)</span>. Due to the large number of targeted domains, we have high confidence that the attackers heavily relied upon automation to achieve their goals.</p>
<p>Further evidence for the heavy reliance upon automation came during our analysis of the threat actor’s public S3 bucket. We identified more than 230 million unique targets that the threat actor was scanning for misconfigured and exposed environment files. Figure 5 shows the contents of the threat actor’s public bucket, listing the number of configured targets.</p>
<figure id="attachment_136325" aria-describedby="caption-attachment-136325" style="width: 156px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136325 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-493423-136313-5-156x440.png" alt="Image 5 is a screenshot of the target count. The left is the total. The right column has the file name." width="156" height="440" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-493423-136313-5-156x440.png 156w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-493423-136313-5.png 188w" sizes="(max-width: 156px) 100vw, 156px" /><figcaption id="caption-attachment-136325" class="wp-caption-text">Figure 5. Target count per scan file and total (the name of the file is on the right).</figcaption></figure>
<p>At the time of access to this public S3 bucket, we estimate that multiple compromised AWS accounts were the target of this malicious scanning as part of a compromise-scan-compromise automated operation. In a later section of this article, we will describe more details about the misconfigured <span style="font-family: 'courier new', courier, monospace;">.env</span> finding.</p>
<h2><a id="post-136313-_vdbcdf1k5ls3"></a>Exfiltration (MITRE ATT&amp;CK Tactic TA0010)</h2>
<p>These attacks also included data exfiltration operations from S3 buckets through the use of the <a href="https://s3browser.com/" target="_blank" rel="noopener">S3 Browser</a> tool. This tool generates various S3 API calls when used. These events show which S3 buckets the threat actors interacted with regardless of whether the S3 object-level logging was enabled (shown in Figure 6). These API calls include:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListBuckets.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">ListBuckets</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketLocation.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketLocation</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetObjectLockConfiguration.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketObjectLockConfiguration</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketLogging.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketLogging</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketVersioning.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketVersioning</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketRequestPayment.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketRequestPayment</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketAccelerateConfiguration.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetAccelerateConfiguration</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketReplication.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketReplication</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketLifecycle.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketLifecycle</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetPublicAccessBlock.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketPublicAccessBlock</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketOwnershipControls.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketOwnershipControls</span></a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketAcl.html" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">GetBucketAcl</span></a></li>
</ul>
<figure id="attachment_136327" aria-describedby="caption-attachment-136327" style="width: 360px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136327 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-496028-136313-6-360x440.png" alt="Image 6 is a screenshot of many lines of code. It is an example CloudTrail event of the GetBucketLogging function." width="360" height="440" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-496028-136313-6-360x440.png 360w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-496028-136313-6.png 490w" sizes="(max-width: 360px) 100vw, 360px" /><figcaption id="caption-attachment-136327" class="wp-caption-text">Figure 6. Example: <span style="font-family: 'courier new', courier, monospace;">GetBucketLogging</span> CloudTrail event.</figcaption></figure>
<p>Note, if an S3 bucket does not have object-level logging enabled, <a href="https://docs.aws.amazon.com/cur/latest/userguide/cur-s3.html" target="_blank" rel="noopener">Cost and Usage Reports</a> can provide a way to determine if the S3 Browser activity resulted in data exfiltration.</p>
<h2><a id="post-136313-_tq9s94hae7jg"></a>Impact (MITRE ATT&amp;CK Tactic TA0040)</h2>
<p>After the threat actor successfully exfiltrated and deleted S3 objects from the target victim’s S3 bucket, they uploaded a ransom note to the now empty bucket. One example is shown in Figure 7.</p>
<figure id="attachment_136329" aria-describedby="caption-attachment-136329" style="width: 1164px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136329 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-498688-136313-7.png" alt="Image 7 is a screenshot of a ransom note left by a threat actor. Hello, urgent! %100 of your S3 files have been exfiltrated to our server. We have all client personal information from json files. In order to prevent their sale, you will need to make a payment in bitcoin to us. Note that if you do not make the payment, the files and personal information will be sold in the dark web and you will take all responsibility and consequences of it being leaked and reputation damage. Once we receive the payment, we will delete all the files we have and will never hear from us. We are giving you the chance to resolve this quietly with no problems or headache. To negotiate with us for a deal contact us. The contact information has been redacted." width="1164" height="374" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-498688-136313-7.png 1164w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-498688-136313-7-786x253.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-498688-136313-7-768x247.png 768w" sizes="(max-width: 1164px) 100vw, 1164px" /><figcaption id="caption-attachment-136329" class="wp-caption-text">Figure 7. Ransom note left by the threat actor.</figcaption></figure>
<p>Ransom notes are typically the last step in the extortion process and are designed to scare and coerce the victim to pay an often large fee. Victims make the ransom payment to ostensibly prevent the threat actor from selling or leaking their stolen data on the dark web and to hopefully get their deleted data back. See the <a href="https://start.paloaltonetworks.com/2023-unit42-ransomware-extortion-report" target="_blank" rel="noopener">Unit 42 Ransomware and Extortion Report</a> for additional information regarding ransomware and extortion trends.</p>
<p>Attackers often upload ransom notes to the impacted S3 bucket. There are also occurrences where the threat actor will email the note to stakeholders of the victim company.</p>
<h2><a id="post-136313-_fwxpepfq8ug0"></a>Assessing the Impact of the Leak</h2>
<p>As mentioned earlier, the threat actor created a lambda function to scan an extensive list of domains looking for misconfigured and exposed <span style="font-family: 'courier new', courier, monospace;">.env</span> files. Ironically, we found we could access the threat actors’ publicly exposed S3 bucket that they used to store and view the stolen <span style="font-family: 'courier new', courier, monospace;">.env</span> files. The data in this exposed S3 bucket consisted of the leaked environment variables collected by the threat actors from the misconfigured publicly exposed<span style="font-family: 'courier new', courier, monospace;"> .env</span> files.</p>
<p>Some of the <span style="font-family: 'courier new', courier, monospace;">.env</span> files contained multiple variables that revealed information about several services used within a victim’s infrastructure. Figure 8 shows an example of a complex <span style="font-family: 'courier new', courier, monospace;">.env</span> file.</p>
<figure id="attachment_136331" aria-describedby="caption-attachment-136331" style="width: 490px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136331 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-501497-136313-8.png" alt="Image 8 is a screenshot of an example .env file. There are 40 lines total. " width="490" height="921" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-501497-136313-8.png 490w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-501497-136313-8-234x440.png 234w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-501497-136313-8-372x700.png 372w" sizes="(max-width: 490px) 100vw, 490px" /><figcaption id="caption-attachment-136331" class="wp-caption-text">Figure 8. Example of <span style="font-family: 'courier new', courier, monospace;">.env</span> file with more than 40 configurations.</figcaption></figure>
<p>We found that the exposed <span style="font-family: 'courier new', courier, monospace;">.env</span> files contained a variety of credentials, not only related to cloud infrastructure but also to social media accounts and other on-premises applications. Due to the variety of credentials, we categorized them based on related services to better represent the breadth of exposed credentials. The chart in Figure 9 shows the statistics of credential exposures obtained from the exposed <span style="font-family: 'courier new', courier, monospace;">.env</span> files, based on the application type.</p>
<figure id="attachment_136333" aria-describedby="caption-attachment-136333" style="width: 1178px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136333 size-large" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-504045-136313-9-1178x700.png" alt="Image 9 is a column graph of the types of leaks from .env variables. From highest to lowest, they are application, database, email, other, cloud and social media." width="1178" height="700" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-504045-136313-9-1178x700.png 1178w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-504045-136313-9-740x440.png 740w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-504045-136313-9-768x456.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-504045-136313-9-1536x913.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-504045-136313-9.png 2048w" sizes="(max-width: 1178px) 100vw, 1178px" /><figcaption id="caption-attachment-136333" class="wp-caption-text">Figure 9. Statistics of categorized leaks from <span style="font-family: 'courier new', courier, monospace;">.env</span> variables.</figcaption></figure>
<p>We identified over 90,000 unique combinations of leaked environment variables that contained access keys or IAM credentials, with 7,000 access keys directly associated with various cloud services. Not all the leaks necessarily contained user accounts or secrets, but all of them leaked some details about a victim’s internal infrastructure or its configuration.</p>
<p>The threat actor discovered exposed access keys within these variables and used select access credentials as an initial attack vector. Most concerningly, 1,515 of the leaked variables were associated with social media platforms; some of them included account names and authentication secret keys.</p>
<p>We found that while the threat actor’s lambda function initially targeted Mailgun credentials, they captured many other secrets belonging to cloud service providers and SaaS applications.</p>
<p>As noted above, the presence of these secrets resulted from misconfigurations in victim organizations, not from vulnerabilities or misconfigurations in listed vendors’ applications or services.</p>
<p>Figure 10 below shows the breakdown of the top six unique cloud and SaaS secrets stolen and grouped by their respective provider.</p>
<figure id="attachment_136335" aria-describedby="caption-attachment-136335" style="width: 782px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136335 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-507176-136313-10-782x440.png" alt="Image 10 is a graphic of the top six cloud and SaaS platforms identified in the dot EV files. 1,185 AWS Access Key. 333 PayPalOauth. 235 GitHub. 111 HubSpot API key. 39 SlackWebHook. 27 DigitalOceanToken." width="782" height="440" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-507176-136313-10-782x440.png 782w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-507176-136313-10-1244x700.png 1244w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-507176-136313-10-768x432.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-507176-136313-10-1536x864.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-507176-136313-10.png 1920w" sizes="(max-width: 782px) 100vw, 782px" /><figcaption id="caption-attachment-136335" class="wp-caption-text">Figure 10. Top six cloud and SaaS platforms identified in the .env files.</figcaption></figure>
<p><em>Please note that Unit 42 did not assess the validity of these credentials.</em> Through the malicious lambda function, the threat actor gained access to several types of credentials. Unit 42 assesses with high confidence that the threat actor likely leveraged the stolen secrets to carry out further acts against victims.</p>
<p>We notified AWS about the availability of the public bucket and its role in an ongoing compromise. Shortly after notification, the public bucket was no longer available.</p>
<h2><a id="post-136313-_rq049h7ai8hf"></a>Network Analysis</h2>
<p>When reviewing the different components discussed in this article, we identified various correlations based on network indicators.</p>
<p>The graph displayed in Figure 11 shows network correlations by IP address, user-agent and exit point type. After careful examination of the malicious network traffic, we identified the following exit point categories:</p>
<ul>
<li>VPN exit node: Known VPN exit point</li>
<li>Tor exit node: Tor network</li>
<li>VPS exit node: Hosting provider</li>
<li>Institution exit node: IP was currently allocated and used by the institution</li>
<li>ISP exit node: Internet service provider, giving services directly to users</li>
<li>Cloud exit node: The access was performed from a cloud provider</li>
</ul>
<figure id="attachment_136337" aria-describedby="caption-attachment-136337" style="width: 1562px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136337 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-510549-136313-11.png" alt="Image 11 is a network graph of malicious access for all incidents. The graph is complex, and color coded as follows: Orange circles are the IP address. Red-pink circles are the user agent. Cream circles are the exit point type. A red arrow points to the lambda function create/access. A blue arrow points to the Ukraine IP address. A purple arrow points to the Morocco IP address. A second red arrow in the bottom right corner points to the S3 browser tool." width="1562" height="1242" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-510549-136313-11.png 1562w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-510549-136313-11-553x440.png 553w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-510549-136313-11-880x700.png 880w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-510549-136313-11-768x611.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/word-image-510549-136313-11-1536x1221.png 1536w" sizes="(max-width: 1562px) 100vw, 1562px" /><figcaption id="caption-attachment-136337" class="wp-caption-text">Figure 11. Network graph of malicious access for all incidents.</figcaption></figure>
<p>We used internal and public data sources to categorize the originating IP addresses used by the threat actors during this campaign according to the exit node type. The activity in Figure 11 above represents access attempts the threat actor performed using the AWS IAM credentials either discovered from the victim’s exposed environment file or from IAM roles created by the threat actor.</p>
<p>The threat actor operated discreetly using Tor network connections when creating the lambda function activities. After that, the threat actor pivoted to using a VPN for all S3 access and exfiltration using the S3 Browser tool. However, the threat actor made a connection from a controlled AWS account to access S3 customer internal buckets. This event left a trace on AWS-hosted infrastructure that we could follow.</p>
<p>We assess with medium to high confidence that the threat actor accessed the compromised victims’ AWS environment from IP addresses directly assigned to ISPs. This operational security (OPSEC) misstep allowed us to determine, with medium confidence, the threat actor’s general geographic location.</p>
<p>Unit 42 determined one ISP IP address was geolocated in Ukraine and appeared in part of the lambda function activity. The second ISP IP address was geolocated in Morocco and was associated with the S3 access and exfiltration. Based on the user-agents and time between API calls, we determined the threat actor manually performed these access operations, which leaked the threat actor's possible physical location.</p>
<h2><a id="post-136313-_d6bvzk45fkcu"></a>Cost and Usage Reports</h2>
<p>Logs are essential for effective incident response, and an ideal environment has all logging options enabled. To identify exfiltration events from S3 buckets with granularity, organizations should enable S3 access logging or <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-cloudtrail-logging-for-s3.html" target="_blank" rel="noopener">CloudTrail data events</a> logging <strong>prior to</strong> an incident occurring.</p>
<p>Both forms of logging help organizations identify <span style="font-family: 'courier new', courier, monospace;">GetObject</span> API calls (e.g., the data being fetched) and <span style="font-family: 'courier new', courier, monospace;">DeleteObject</span> API calls (e.g., the data being deleted). Both S3 access logging and CloudTrail event logging record the IP addresses and user agents for each request made to the target bucket.</p>
<p>It’s important to note that neither of these log sources are enabled by default, and they will increase costs for the organization’s cloud environment. However, enabling logging for these sources will greatly assist in the identification and alerting of malicious cloud operations.</p>
<p>However, if neither CloudTrail event logging nor S3 access logs are enabled at the time of an incident, there is still hope. Leveraging the Cost and Usage report for S3 can allow organizations to identify spikes in the occurrences of the API calls for <span style="font-family: 'courier new', courier, monospace;">GetObject</span> (bytes out) and <span style="font-family: 'courier new', courier, monospace;">DeleteObject</span> (bytes deleted) events.</p>
<p>There are drawbacks in leveraging Cost and Usage Reports to identify exfiltration operations. Organizations can only identify high-level activity that occurred within the bucket and the data can only be aggregated into hourly, daily or monthly time frames as shown in Figure 12. This prevents organizations from investigating individual events or retrieving the metadata associated with each of the events.</p>
<figure id="attachment_136339" aria-describedby="caption-attachment-136339" style="width: 937px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136339" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/example-cost-and-usage-report-showing-exfil-deleti.png" alt="Image 12 is a table of cost use report line item examples. The columns are start time, end time, service, operation, usage type, resource, and the usage value measured in bytes." width="937" height="126" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/example-cost-and-usage-report-showing-exfil-deleti.png 937w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/example-cost-and-usage-report-showing-exfil-deleti-786x106.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/example-cost-and-usage-report-showing-exfil-deleti-768x103.png 768w" sizes="(max-width: 937px) 100vw, 937px" /><figcaption id="caption-attachment-136339" class="wp-caption-text">Figure 12. Cost and Usage Report line item examples.</figcaption></figure>
<p>The <span style="font-family: 'courier new', courier, monospace;">GetObject</span> and <span style="font-family: 'courier new', courier, monospace;">DeleteObject</span> Cost and Usage Activity records bytes out or bytes deleted, respectively. Using these reports, we have successfully assessed the likelihood that exfiltration events have occurred, pointing to key time frames when there are anomalous spikes in activity.</p>
<h2><a id="post-136313-_u2nqatxinbsl"></a>Remediation</h2>
<p>In a majority of these attacks, threat actors obtained long-term IAM access keys allowing them to move into the <a href="https://docs.aws.amazon.com/whitepapers/latest/aws-fault-isolation-boundaries/control-planes-and-data-planes.html" target="_blank" rel="noopener">control plane</a> with no time limit to their credentials. Unless an application or workload requires the use of an access key, <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#bp-workloads-use-roles" target="_blank" rel="noopener">IAM roles</a> provide the same ability as access keys, but they are temporary. Using temporary credentials limits the amount of time a threat actor has access to an account.</p>
<p>Another way to protect against these attacks is following the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html" target="_blank" rel="noopener">principle of least privilege</a> when provisioning permissions. Limiting the permissions associated with an IAM resource limits the scope of what a compromised credential can perform (e.g., restricting identities that can perform <span style="font-family: 'courier new', courier, monospace;">iam:CreateRole</span> and <span style="font-family: 'courier new', courier, monospace;">iam:AttachRolePolicy</span>). That way even if a threat actor were to successfully gain access to long-term or short-term credentials, they wouldn’t have enough permissions to execute their malicious actions.</p>
<p>Additionally, disabling all unused regions within an AWS account also protects against these attacks. Threat actors deploy resources in multiple regions to attempt to remain undetected, so disabling all unused regions prevents the threat actors from hiding their attacks.</p>
<p>And finally, enabling logging and establishing a monitoring process is vital to protecting an organization's resources. Regarding AWS, enabling basic logging such as CloudTrail and <a href="https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html" target="_blank" rel="noopener">VPC flow logs</a> provides the base level of visibility into an environment. Amazon <a href="https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html" target="_blank" rel="noopener">GuardDuty</a> also contains a variety of features to help protect against threats to EC2 instances and credential exploitation.</p>
<p>Depending on the AWS services used, organizations will want to ensure they enable the specific logging unique to that service. After organizations establish the proper logging and retention of that data (90 days minimum retention recommended), then the focus shifts to monitoring those data sources.</p>
<p>AWS’s GuardDuty provides a base level of alerting, but each organization should review what services they use and how abnormal activity might appear in the logs. From there, organizations should create alerts for abnormal activity.</p>
<h2><a id="post-136313-_gz9i4v2vpe0m"></a>Conclusion</h2>
<p>We identified a wide-scale extortion operation that resulted in the successful compromise of several cloud environments. The initial access used within the extortion campaign was the direct result of exposed environment files (<span style="font-family: 'courier new', courier, monospace;">.env</span>) files within the victim organization's web applications.</p>
<p>By targeting <span style="font-family: 'courier new', courier, monospace;">.env</span> files, the threat actor was able to collect the exposed environment files of at least 110,000 domains. We identified over 90,000 unique leaked environment variables of which 7,000 were associated with cloud services and 1,500 were associated with social media accounts, oftentimes including account names in addition to authentication secret keys.</p>
<h2><a id="post-136313-_mf3k1d3b3om7"></a>Protections and Mitigations</h2>
<p>For Palo Alto Networks customers, our products and services provide the following coverage associated with the threats described above:</p>
<ul>
<li><a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall" target="_blank" rel="noopener">Next-Generation Firewall</a> and <a href="https://www.paloaltonetworks.com/products/secure-the-network/wildfire" target="_blank" rel="noopener">Advanced WildFire</a> accurately identify known samples as malicious.</li>
<li><a href="https://www.paloaltonetworks.com/network-security/advanced-url-filtering" target="_blank" rel="noopener">Advanced URL Filtering</a> and <a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security" target="_blank" rel="noopener">Advanced </a><a href="https://www.paloaltonetworks.com/network-security/dns-security" target="_blank" rel="noopener">DNS Security</a> identify domains associated with this group as malicious.</li>
<li><a href="https://www.paloaltonetworks.com/cortex/cortex-xdr" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam" target="_blank" rel="noopener">XSIAM</a>
<ul>
<li>Prevent the execution of known malicious malware, and also prevent the execution of unknown malware using <a href="https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention" target="_blank" rel="noopener">Behavioral Threat Protection and</a> machine learning based on the Local Analysis module.</li>
<li>Protect against credential gathering tools and techniques using the new Credential Gathering Protection available from Cortex XDR 3.4.</li>
<li>Cortex XDR Pro <a href="https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-analytics-alert-reference/analytics-alerts-by-required-data-source" target="_blank" rel="noopener">detects post-exploit activity</a>, including credential-based attacks, with behavioral analytics.</li>
</ul>
</li>
<li><a href="https://www.paloaltonetworks.com/prisma/cloud" target="_blank" rel="noopener">Prisma Cloud</a>
<ul>
<li><a href="https://www.paloaltonetworks.com/blog/prisma-cloud/disrupt-attack-paths-prioritize-security/" target="_blank" rel="noopener">Attack Path Policies</a> are built on a unified data model that automatically correlates findings across cloud misconfigurations, vulnerabilities, excessive IAM permissions and network exposures. When combined with Unit 42 Threat Intelligence, coupled with machine learning (ML) and user and entity behavior analytics (UEBA), security teams can detect exploited attack paths.</li>
<li>When paired with the WildFire integration, the Prisma Cloud Defender agent will identify malicious binaries and make verdict determinations when analyzing executing processes.</li>
<li>When paired with XSIAM, the Prisma Cloud Defender is enabled to block malicious processes from operating within the cloud environment.</li>
<li>Prevents the execution of known malicious malware, and also prevents the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module.</li>
</ul>
</li>
</ul>
<h3><a id="post-136313-_otado6e13bwx"></a>Hunting, Investigation and Detection Queries</h3>
<p>The following queries are intended to assist Palo Alto Networks customers in hunting, investigating and detecting potentially malicious operations within their Cortex XDR and Prisma Cloud platforms. The results of these queries should not be taken as malicious on face value. The queries require careful examination of the resulting events before they can be found malicious.</p>
<p>Pay close attention to the source IP addresses, user agent and the ARNs for each event. If ARNs are being created, modified or deleted, investigate for unwanted modifications to critical infrastructure or the creation of unknown or suspicious ARN names. Unit 42 IR services <a href="https://www.paloaltonetworks.com/unit42/respond/incident-response" target="_blank" rel="noopener">are available</a> for anyone who’s determined they have been breached, compromised or otherwise affected by malicious events.</p>
<h4><a id="post-136313-_2bfqx9i4wy1w"></a>Cortex XQL Queries</h4>
<p>IAM</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c7012a071450181" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
dataset=amazon_aws_raw

| filter eventName in ("CreateRole", "AttachRolePolicy")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c7012a071450181-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b50c7012a071450181-2">2</div><div class="crayon-num" data-line="crayon-6719b50c7012a071450181-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c7012a071450181-1"><span class="crayon-i">dataset</span>=<span class="crayon-i">amazon_aws_raw</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b50c7012a071450181-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b50c7012a071450181-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">eventName </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"CreateRole"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"AttachRolePolicy"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Security Groups</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c70138076856207" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
dataset=amazon_aws_raw 
| filter eventName in ("CreateSecurityGroup", 
"AuthorizeSecurityGroupIngress")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c70138076856207-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b50c70138076856207-2">2</div><div class="crayon-num" data-line="crayon-6719b50c70138076856207-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c70138076856207-1"><span class="crayon-i">dataset</span>=<span class="crayon-i">amazon_aws_raw</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b50c70138076856207-2"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">eventName </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"CreateSecurityGroup"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-6719b50c70138076856207-3"><span class="crayon-s">"AuthorizeSecurityGroupIngress"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>EC2</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c70139520972579" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
dataset=amazon_aws_raw

| filter eventName in ("CreateKeyPair", "RunInstances")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c70139520972579-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b50c70139520972579-2">2</div><div class="crayon-num" data-line="crayon-6719b50c70139520972579-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c70139520972579-1"><span class="crayon-i">dataset</span>=<span class="crayon-i">amazon_aws_raw</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b50c70139520972579-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b50c70139520972579-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">eventName </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"CreateKeyPair"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"RunInstances"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Lambda</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c7013a039099917" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
dataset=amazon_aws_raw

| filter eventName in ("CreateFunction20150331", "CreateLogGroup", "CreateLogStream")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c7013a039099917-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b50c7013a039099917-2">2</div><div class="crayon-num" data-line="crayon-6719b50c7013a039099917-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c7013a039099917-1"><span class="crayon-i">dataset</span>=<span class="crayon-i">amazon_aws_raw</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b50c7013a039099917-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b50c7013a039099917-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">eventName </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"CreateFunction20150331"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"CreateLogGroup"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"CreateLogStream"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4><a id="post-136313-_ofr2so4aboah"></a>Prisma Cloud RQL Queries</h4>
<p>IAM</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c7013b860071786" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
event from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateRole', 'AttachRolePolicy' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c7013b860071786-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c7013b860071786-1"><span class="crayon-e">event </span><span class="crayon-e">from </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-e">audit_logs </span><span class="crayon-e">where </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'aws'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">service</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'iam.amazonaws.com'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-e">operation </span><span class="crayon-st">IN</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'CreateRole'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'AttachRolePolicy'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">ADDCOLUMN</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">userAgent</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">requestParameters</span><span class="crayon-sy">.</span><span class="crayon-i">policyArn</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Security Groups</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c7013c599774107" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
event from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateSecurityGroup', 'AuthorizeSecurityGroupIngress' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c7013c599774107-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c7013c599774107-1"><span class="crayon-e">event </span><span class="crayon-e">from </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-e">audit_logs </span><span class="crayon-e">where </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'aws'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">service</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'iam.amazonaws.com'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-e">operation </span><span class="crayon-st">IN</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'CreateSecurityGroup'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'AuthorizeSecurityGroupIngress'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">ADDCOLUMN</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">userAgent</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">requestParameters</span><span class="crayon-sy">.</span><span class="crayon-i">policyArn</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>EC2</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c7013d158838115" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
event from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateKeyPair', 'RunInstances' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c7013d158838115-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c7013d158838115-1"><span class="crayon-e">event </span><span class="crayon-e">from </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-e">audit_logs </span><span class="crayon-e">where </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'aws'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">service</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'iam.amazonaws.com'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-e">operation </span><span class="crayon-st">IN</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'CreateKeyPair'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'RunInstances'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">ADDCOLUMN</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">userAgent</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">requestParameters</span><span class="crayon-sy">.</span><span class="crayon-i">policyArn</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Lambda</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b50c7013e789676558" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
event from cloud.audit_logs where cloud.type = 'aws' AND cloud.service = 'iam.amazonaws.com' AND operation IN ( 'CreateFunction20150331', 'CreateLogGroup', 'CreateLogStream' ) ADDCOLUMN $.userAgent $.requestParameters.policyArn</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b50c7013e789676558-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b50c7013e789676558-1"><span class="crayon-e">event </span><span class="crayon-e">from </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-e">audit_logs </span><span class="crayon-e">where </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'aws'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-i">cloud</span><span class="crayon-sy">.</span><span class="crayon-i">service</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'iam.amazonaws.com'</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-e">operation </span><span class="crayon-st">IN</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'CreateFunction20150331'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'CreateLogGroup'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'CreateLogStream'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">ADDCOLUMN</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">userAgent</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">.</span><span class="crayon-i">requestParameters</span><span class="crayon-sy">.</span><span class="crayon-i">policyArn</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4><a id="post-136313-_wqbyj3xzo905"></a>Prisma Cloud Attack Path Alerting</h4>
<p>Prisma Cloud Attack Paths offer a unique view into the configuration of cloud environments. By linking potential architectural misconfigurations, attack path alerts allow security operation center (SOC) personnel the ability to zero in on potential malicious cloud events.</p>
<p>By combining DevOps configurations and behavioral anomaly detection rules, attack path alerts trigger if a combination of event operations takes place. These alerts scale with the dynamic nature of cloud environments and allow SOC teams to maintain awareness of security events across multiple cloud platforms.</p>
<p>While there are many Attack Path Policies that could assist organizations, the following Attack Path Policies could assist SOC and DevOps teams monitor and maintain cloud security:</p>
<ul>
<li>Credential exposure risk due to a publicly exposed and unauthenticated AWS Lambda function with risky credential exposure permissions</li>
<li>Credential exposure risk due to a publicly exposed and vulnerable EC2 instance with risky credential exposure permissions</li>
<li>Credential exposure risk due to malware in Amazon EC2 instances with risky credential exposure permissions</li>
<li>Data breach risk due to a publicly exposed and unauthenticated AWS Lambda function with Amazon RDS database SQL query execution permissions</li>
<li>Data breach risk due to AWS S3 bucket containing sensitive data not configured with access log feature and is accessible by unmonitored cloud accounts</li>
<li>Data exposure and data loss risk due to a publicly exposed unauthenticated AWS Lambda function with permissions over sensitive S3 configuration</li>
</ul>
<h2><a id="post-136313-_h2pug7j9j5bc"></a>Indicators of Compromise</h2>
<h3><a id="post-136313-_bkxo9plpi69b"></a>URL</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">https[:]//github[.]com/brentp/gargs/releases/download/v0.3.9/gargs_linux</span> (not malicious, used by the lambda function)</li>
</ul>
<h3><a id="post-136313-_7nb4qn1lvtms"></a>IPv4</h3>
<h4><a id="post-136313-_bs9vnhikqnzi"></a>Tor Exit Nodes</h4>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">109.70.100[.]71</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">144.172.118[.]62</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">176.123.8[.]245</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.100.85[.]25</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.100.87[.]41</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.220.101[.]190</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.220.101[.]19</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.220.101[.]21</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.220.101[.]29</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.220.101[.]30</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.220.101[.]86</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.220.103[.]113</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]181</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]187</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]18</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]192</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]199</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]201</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]208</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">192.42.116[.]218</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">198.251.88[.]142</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">199.249.230[.]161</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.83.104[.]137</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">62.171.137[.]169</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">80.67.167[.]81</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">89.234.157[.]254</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">94.142.241[.]194</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">95.214.234[.]103</span></li>
</ul>
<h4><a id="post-136313-_ttjk4k4t5irk"></a>VPS Endpoints</h4>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">125.20.131[.]190</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">196.112.184[.]14</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">46.150.66[.]226</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">49.37.170[.]97</span></li>
</ul>
<h4><a id="post-136313-_6yu8k3au1ieg"></a>VPN Endpoints</h4>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">139.99.68[.]203</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">141.95.89[.]92</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">146.70.184[.]10</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">178.132.108[.]124</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">193.42.98[.]65</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">193.42.99[.]169</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">193.42.99[.]50</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">193.42.99[.]58</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">195.158.248[.]220</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">195.158.248[.]60</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.137.126[.]12</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.137.126[.]16</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.137.126[.]18</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.137.126[.]41</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.94.208[.]42</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.94.208[.]63</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.94.208[.]76</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">45.94.208[.]85</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">72.55.136[.]154</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">95.214.216[.]158</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">95.214.217[.]173</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">95.214.217[.]224</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">95.214.217[.]242</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">95.214.217[.]33</span></li>
</ul>
<h3><a id="post-136313-_n6ofbkrw6p95"></a>Hash</h3>
<ul>
<li>SHA256 for <span style="font-family: 'courier new', courier, monospace;">Lambda.sh</span> - <span style="font-family: 'courier new', courier, monospace;">64e6ce23db74aed7c923268e953688fa5cc909cc9d1e84dd46063b62bd649bf6</span></li>
</ul>
<p class="p1"><i>Updated title Sept. 3, 2024, at 1:1o p.m. PT for clarity.</i></p>
      
              </div>
              <!--<span class="post__date">Updated 3 September, 2024 at 1:10 PM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/aws/" role="link" title="AWS" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:AWS">AWS</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/credential-theft/" role="link" title="credential theft" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:credential theft">Credential theft</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/data-exfiltration/" role="link" title="data exfiltration" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:data exfiltration">Data exfiltration</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/env-files/" role="link" title="ENV files" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:ENV files">ENV files</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/environment-variable-files/" role="link" title="environment variable files" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:environment variable files">Environment variable files</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/exploit-kits/" role="link" title="Exploit Kits" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:Exploit Kits">Exploit Kits</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/exposed-environment-files/" role="link" title="exposed environment files" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:exposed environment files">Exposed environment files</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/extortion/" role="link" title="Extortion" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:Extortion">Extortion</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/honeycloud/" role="link" title="HoneyCloud" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:HoneyCloud">HoneyCloud</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/mitre/" role="link" title="MITRE" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:MITRE">MITRE</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/onion-routing/" role="link" title="onion routing" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:onion routing">Onion routing</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/tor/" role="link" title="Tor" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:tags:Tor">Tor</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/2024-unit-42-attack-surface-threat-research-internet-connected-exposures/" role="link" title="Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:article-nav:Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure"> 
            <span>Next: Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="large-scale-cloud-extortion-operation:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:sidebar:related-articles:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                      Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/repellent-scorpius-cicada3301-ransomware/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:sidebar:related-articles:Threat Assessment: Repellent Scorpius, Distributors of Cicada3301 Ransomware">
                      Threat Assessment: Repellent Scorpius, Distributors of Cicada3301 Ransomware                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/shinyhunters-ransomware-extortion/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:sidebar:related-articles:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware">
                      Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Cloud Cybersecurity Research Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of ShinyHunters ransomware. An image showing a laptop with security and financial graphics displayed on the screen, surrounded by stacks of coins and a credit card, set against a dark background illuminated by neon lights." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/shinyhunters-ransomware-extortion/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware">
                    <h4 class="post-title">Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/extortion/" title="Extortion" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Extortion">Extortion</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container/" title="Container" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Container">Container</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/shinyhunters-ransomware-extortion/" title="Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                          <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of compromised GitHub repositories. A woman focuses intently on a computer in front of her. Overlaid across the screen are lines of code, suggesting a security technology focus." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/github-repo-artifacts-leak-tokens/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts">
                    <h4 class="post-title">ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/artifacts/" title="artifacts" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:artifacts">Artifacts</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/github/" title="GitHub" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:GitHub">GitHub</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/github-repo-artifacts-leak-tokens/" title="ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Illustration of a futuristic city with glowing orange and blue lights, surrounded by clouds and digital elements, conveying a high-tech, cybernetic theme." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/container-escape-techniques/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Container Breakouts: Escape Techniques in Cloud Environments">
                    <h4 class="post-title">Container Breakouts: Escape Techniques in Cloud Environments</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/containers/" title="Containers" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Containers">Containers</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/docker/" title="Docker" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Docker">Docker</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container-escape/" title="container escape" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:container escape">Container escape</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/container-escape-techniques/" title="Container Breakouts: Escape Techniques in Cloud Environments" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Abstract illustration of a network sppread like a spiderweb, connecting covering the globe and symbolizing data or communication links." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-brief-cve-2024-6387-openssh/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability">
                    <h4 class="post-title">Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/openssh/" title="OpenSSH" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:OpenSSH">OpenSSH</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/ssh/" title="SSH" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:SSH">SSH</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-brief-cve-2024-6387-openssh/" title="Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-786x368.jpg" class="attachment-medium size-medium" alt="" decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Attack Paths Into VMs in the Cloud:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Attack Paths Into VMs in the Cloud">
                    <h4 class="post-title">Attack Paths Into VMs in the Cloud</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Attack Paths Into VMs in the Cloud:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/iaas/" title="IaaS" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Attack Paths Into VMs in the Cloud:IaaS">IaaS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/virtual-machines/" title="virtual machines" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Attack Paths Into VMs in the Cloud:virtual machines">Virtual machines</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/" title="Attack Paths Into VMs in the Cloud" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Attack Paths Into VMs in the Cloud:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Futuristic illustration with glowing neon lights and advanced technology motifs, depicting cloud computing and data flow through interconnected networks. The scene is highlighted by hovering digital clouds and dynamic, illuminated linear structures, set in a dramatic, blue and orange color scheme." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Muddled Libra’s Evolution to the Cloud:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Muddled Libra’s Evolution to the Cloud">
                    <h4 class="post-title">Muddled Libra’s Evolution to the Cloud</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/microsoft-azure/" title="Microsoft Azure" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Muddled Libra’s Evolution to the Cloud:Microsoft Azure">Microsoft Azure</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/muddled-libra/" title="Muddled Libra" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Muddled Libra’s Evolution to the Cloud:Muddled Libra">Muddled Libra</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" title="Muddled Libra’s Evolution to the Cloud" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Muddled Libra’s Evolution to the Cloud:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Close-up side profile of a Black woman wearing glasses, focused intently on something out of frame." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-brief-xz-utils-cve-2024-3094/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)">
                    <h4 class="post-title">Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cve-2024-3094/" title="CVE-2024-3094" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):CVE-2024-3094">CVE-2024-3094</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/linux/" title="Linux" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):Linux">Linux</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/xz-utils/" title="XZ Utils" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):XZ Utils">XZ Utils</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-brief-xz-utils-cve-2024-3094/" title="Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Digital illustration of a cloud composed of binary code floating above a network of dynamic, glowing data streams, symbolizing cloud computing and data connectivity." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques">
                    <h4 class="post-title">Navigating the Cloud: Exploring Lateral Movement Techniques</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/azure/" title="Azure" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Azure">Azure</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/containers/" title="Containers" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Containers">Containers</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/" title="Navigating the Cloud: Exploring Lateral Movement Techniques" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/08_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Digital representation of a cloud computing network over server racks in a data center." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/08_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/08_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/08_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/08_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/08_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/google-kubernetes-engine-privilege-escalation-fluentbit-anthos/" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes">
                    <h4 class="post-title">Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container-escape/" title="container escape" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes:container escape">Container escape</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/kubernetes/" title="Kubernetes" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes:Kubernetes">Kubernetes</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/google/" title="Google" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes:Google">Google</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/google-kubernetes-engine-privilege-escalation-fluentbit-anthos/" title="Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes" role="link" data-page-track="true" data-page-track-value="large-scale-cloud-extortion-operation:related-resources:Dual Privilege Escalation Chain: Exploiting Monitoring and Service Mesh Configurations and Privileges in GKE to Gain Unauthorized Access in Kubernetes:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
