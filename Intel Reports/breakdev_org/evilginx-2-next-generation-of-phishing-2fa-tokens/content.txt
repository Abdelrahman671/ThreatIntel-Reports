<!DOCTYPE html>
<html lang="en" class="dark-mode">
<head>

    <title>Evilginx 2 - Next Generation of Phishing 2FA Tokens</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=5cb0155b50" />

    <meta name="description" content="Evilginx becomes a relay between the real website and the phished user. Phished user interacts with the real website, while Evilginx captures all the data." />
    <link rel="icon" href="https://breakdev.org/content/images/size/w256h256/2022/08/breakdev_logo_512.png" type="image/png" />
    <link rel="canonical" href="https://breakdev.org/evilginx-2-next-generation-of-phishing-2fa-tokens/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://breakdev.org/evilginx-2-next-generation-of-phishing-2fa-tokens/amp/" />
    
    <meta property="og:site_name" content="BREAKDEV" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Evilginx 2 - Next Generation of Phishing 2FA Tokens" />
    <meta property="og:description" content="Evilginx becomes a relay between the real website and the phished user. Phished user interacts with the real website, while Evilginx captures all the data." />
    <meta property="og:url" content="https://breakdev.org/evilginx-2-next-generation-of-phishing-2fa-tokens/" />
    <meta property="og:image" content="https://breakdev.org/content/images/2018/07/evilginx_blog_title2.jpg" />
    <meta property="article:published_time" content="2018-07-26T06:01:06.000Z" />
    <meta property="article:modified_time" content="2018-09-10T04:23:20.000Z" />
    <meta property="article:tag" content="evilginx" />
    <meta property="article:tag" content="mitm" />
    <meta property="article:tag" content="security" />
    <meta property="article:tag" content="phishing" />
    <meta property="article:tag" content="research" />
    <meta property="article:tag" content="golang" />
    <meta property="article:tag" content="2fa" />
    <meta property="article:tag" content="tool" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Evilginx 2 - Next Generation of Phishing 2FA Tokens" />
    <meta name="twitter:description" content="Evilginx becomes a relay between the real website and the phished user. Phished user interacts with the real website, while Evilginx captures all the data." />
    <meta name="twitter:url" content="https://breakdev.org/evilginx-2-next-generation-of-phishing-2fa-tokens/" />
    <meta name="twitter:image" content="https://breakdev.org/content/images/2018/07/evilginx_blog_title2.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Kuba Gretzky" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="evilginx, mitm, security, phishing, research, golang, 2fa, tool" />
    <meta name="twitter:site" content="@mrgretzky" />
    <meta name="twitter:creator" content="@mrgretzky" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="720" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "BREAKDEV",
        "url": "https://breakdev.org/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://breakdev.org/content/images/2022/08/breakdev_logo_with_title.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Kuba Gretzky",
        "image": {
            "@type": "ImageObject",
            "url": "https://breakdev.org/content/images/2022/08/avatar512.png",
            "width": 512,
            "height": 512
        },
        "url": "https://breakdev.org/author/kuba/",
        "sameAs": [
            "https://breakdev.org",
            "https://twitter.com/mrgretzky"
        ]
    },
    "headline": "Evilginx 2 - Next Generation of Phishing 2FA Tokens",
    "url": "https://breakdev.org/evilginx-2-next-generation-of-phishing-2fa-tokens/",
    "datePublished": "2018-07-26T06:01:06.000Z",
    "dateModified": "2018-09-10T04:23:20.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://breakdev.org/content/images/2018/07/evilginx_blog_title2.jpg",
        "width": 1280,
        "height": 720
    },
    "keywords": "evilginx, mitm, security, phishing, research, golang, 2fa, tool",
    "description": "It&#x27;s been over a year since the first release of Evilginx and looking back, it has been an amazing year. I&#x27;ve received tons of feedback, got invited to WarCon by @antisnatchor (thanks man!) and met amazing people from the industry. A year ago, I wouldn&#x27;t have even expected that one day Kevin Mitnick would showcase Evilginx in his live demos around the world and Techcrunch would write about it!\n\n\nAt WarCon I met the legendary @evilsocket (he is a really nice guy), who inspired me with his ideas t",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://breakdev.org/"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.7" />
    <link rel="alternate" type="application/rss+xml" title="BREAKDEV" href="https://breakdev.org/rss/" />
    <script defer src="https://cdn.jsdelivr.net/npm/@tryghost/portal@~2.3/umd/portal.min.js" data-ghost="https://breakdev.org/" data-key="cbe8757390779c577a82afa6ee" data-api="https://breakdev.org/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/npm/@tryghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="cbe8757390779c577a82afa6ee" data-styles="https://cdn.jsdelivr.net/npm/@tryghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://breakdev.org/" crossorigin="anonymous"></script>
    <script defer src="/public/cards.min.js?v=5cb0155b50"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=5cb0155b50">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Questrial&family=Source+Code+Pro&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism-tomorrow.min.css" integrity="sha512-vswe+cgvic/XBoF1OcM/TeJ2FW0OofqAVdCZiEYkd6dwGXthvkSFWOoGGJgS2CW70VK5dQM5Oh+7ne47s74VTg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
.site-logo {
	max-height: 480px;    
}
:root {
    --font-sans: "Questrial", sans-serif;
}
.gh-content>blockquote:not([class]), .gh-content>dl, .gh-content>ol, .gh-content>p, .gh-content>ul {
    font-family: "Questrial", sans-serif; /*var(--font-sans);*/
}
code, kbd, pre, samp {
    font-family: 'Source Code Pro', monospace;
}
::selection {
    background: var(--ghost-accent-color);
}
</style>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DKYFY5BSK5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DKYFY5BSK5');
</script>
<style>:root {--ghost-accent-color: #124559;}</style>

</head>
<body class="post-template tag-evilginx tag-mitm tag-security tag-phishing tag-research tag-golang tag-2fa tag-tool has-sans-body has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <nav class="gh-head-inner inner">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="https://breakdev.org">
                        <img src="https://breakdev.org/content/images/2022/08/breakdev_logo_with_title.png" alt="BREAKDEV" />
                </a>
                <div class="gh-head-brand-wrapper">
                    <button class="gh-search" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <a class="gh-burger" role="button">
                        <div class="gh-burger-box">
                            <div class="gh-burger-inner"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://breakdev.org/">Home</a></li>
    <li class="nav-tools"><a href="https://github.com/kgretzky">Tools</a></li>
    <li class="nav-contact"><a href="https://breakdev.org/contact/">Contact</a></li>
</ul>

            </div>
            <div class="gh-head-actions">
                <button class="gh-search" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <div class="gh-social">
                        <a class="gh-social-link gh-social-twitter" href="https://twitter.com/mrgretzky" title="Twitter" target="_blank" rel="noopener"><svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg></a>
                </div>
                        <a class="gh-head-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
            </div>
        </nav>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-evilginx tag-mitm tag-security tag-phishing tag-research tag-golang tag-2fa tag-tool featured ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="/tag/evilginx/">evilginx</a>
                </span>
                <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
        </div>

        <h1 class="article-title">Evilginx 2 - Next Generation of Phishing 2FA Tokens</h1>


        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/kuba/" class="author-avatar">
                        <img class="author-profile-image" src="/content/images/size/w100/2022/08/avatar512.png" alt="Kuba Gretzky" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/kuba/">Kuba Gretzky</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2018-07-26">Jul 26, 2018</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 22 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="/content/images/size/w300/2018/07/evilginx_blog_title2.jpg 300w,
                            /content/images/size/w600/2018/07/evilginx_blog_title2.jpg 600w,
                            /content/images/size/w1000/2018/07/evilginx_blog_title2.jpg 1000w,
                            /content/images/size/w2000/2018/07/evilginx_blog_title2.jpg 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="/content/images/size/w2000/2018/07/evilginx_blog_title2.jpg"
                    alt="Evilginx 2 - Next Generation of Phishing 2FA Tokens"
                />
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <!--kg-card-begin: markdown--><p>It's been over a year since the <a href="https://breakdev.org/evilginx-advanced-phishing-with-two-factor-authentication-bypass/">first release</a> of Evilginx and looking back, it has been an amazing year. I've received tons of feedback, got invited to <a href="http://warcon.pl/">WarCon</a> by <a href="https://twitter.com/antisnatchor">@antisnatchor</a> (thanks man!) and met amazing people from the industry. A year ago, I wouldn't have even expected that one day <strong>Kevin Mitnick</strong> <a href="https://techcrunch.com/2018/05/10/hacker-kevin-mitnick-shows-how-to-bypass-2fa/">would showcase Evilginx</a> in his live demos around the world and Techcrunch would write about it!</p>
<p>At WarCon I met the legendary <a href="https://twitter.com/evilsocket">@evilsocket</a> (he is a <a href="https://twitter.com/mrgretzky/status/871050014575005696">really nice guy</a>), who inspired me with his ideas to learn GO and rewrite Evilginx as a standalone application. It is amazing how GO seems to be ideal for offensive tools development and <a href="https://github.com/bettercap/bettercap">bettercap</a> is its best proof!</p>
<p>This is where Evilginx is now. No more nginx, just pure evil. My main goal with this tool's release was to focus on minimizing the installation difficulty and maximizing the ease of use. Usability was not necessarily the strongest point of the initial release.</p>
<p>Updated instructions on usage and installation can always be found up-to-date on the tool's official <a href="https://github.com/kgretzky/evilginx2">GitHub project page</a>. In this blog post I only want to explain some general concepts of how it works and its major features.</p>
<p><strong>Update:</strong> <a href="https://breakdev.org/evilginx-2-1-the-first-post-release-update/">Check also version 2.1 release post</a></p>
<h4 id="tldrwhatamilookingat">TL;DR What am I looking at?</h4>
<p>Evilginx is an attack framework for setting up phishing pages. Instead of serving templates of sign-in pages lookalikes, <strong>Evilginx becomes a relay between the real website and the phished user</strong>. Phished user interacts with the real website, while Evilginx captures all the data being transmitted between the two parties.</p>
<p>Evilginx, being the man-in-the-middle, captures not only usernames and passwords, but also <strong>captures authentication tokens sent as cookies</strong>. Captured authentication tokens allow the attacker to <strong>bypass any form of 2FA enabled on user's account</strong> (except for U2F - more about it further below).</p>
<p>Even if phished user has 2FA enabled, <strong>the attacker, outfitted with just a domain and a VPS server, is able to remotely take over his/her account</strong>. It doesn't matter if 2FA is using SMS codes, mobile authenticator app or recovery keys.</p>
<p>Take a look at the video demonstration, showing how attacker's can <strong>remotely hack an Outlook account with enabled 2FA</strong>.</p>
<iframe src="https://player.vimeo.com/video/281220095" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
<blockquote>
<p><strong>Disclaimer:</strong> Evilginx project is released for educational purposes and should be used only in demonstrations or legitimate penetration testing assignments with written permission from to-be-phished parties. Goal is to show that 2FA is not a silver bullet against phishing attempts and people should be aware that their accounts can be compromised, nonetheless, if they are not careful.</p>
</blockquote>
<center><h6>[>> Download Evilginx 2 from GitHub <<](https://github.com/kgretzky/evilginx2)</h6></center>
<center>**Remember - 2FA is not a silver bullet against phishing!**</center>
<p>2FA is very important, though. This is what head of Google Threat Intelligence had to say on the subject:</p>
<center>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">2FA is super important but please, please stop telling people that by itself it will protect people from being phished by the Russians or governments. If attacker can trick users for a password, they can trick them for a 6 digit code.</p>&mdash; Shane Huntley (@ShaneHuntley) <a href="https://twitter.com/ShaneHuntley/status/1020888448360595459?ref_src=twsrc%5Etfw">July 22, 2018</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>
<h4 id="oldphishingtactics">Old phishing tactics</h4>
<p>Common phishing attacks, we see every day, are HTML templates, prepared as lookalikes of popular websites' sign-in pages, luring victims into disclosing their usernames and passwords. When the victim enters his/her username and password, the credentials are logged and attack is considered a success.</p>
<center>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">I love digging through certificate transparency logs. Today, I saw a fake Google Drive landing page freshly registered with Let&#39;s Encrypt. It had a hardcoded picture/email of presumably the target. These can be a wealth of info that I recommend folks checking out. <a href="https://t.co/PRweQsgHKD">pic.twitter.com/PRweQsgHKD</a></p>&mdash; Justin Warner (@sixdub) <a href="https://twitter.com/sixdub/status/1021143236943990785?ref_src=twsrc%5Etfw">July 22, 2018</a></blockquote></center>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>This is where <a href="https://en.wikipedia.org/wiki/Multi-factor_authentication">2FA</a> steps in. If phished user has 2FA enabled on their account, the attacker would require an additional form of authentication, to supplement the username and password they intercepted through phishing. That additional form of authentication may be SMS code coming to your mobile device, <a href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm">TOTP</a> token, PIN number or answer to a question that only the account owner would know. Attacker not having access to any of these <strong>will never be able to successfully authenticate</strong> and login into victim's account.</p>
<p>Old phishing methods which focus solely on capturing usernames and passwords are <strong>completely defeated by 2FA</strong>.</p>
<h4 id="phishing20">Phishing 2.0</h4>
<p>What if it was possible to lure the victim not only to disclose his/her username and password, but also to provide the answer to any 2FA challenge that may come after the credentials are verified? Intercepting a single 2FA answer would not do the attacker any good. Challenge will change with every login attempt, making this approach useless.</p>
<p>After each successful login, website generates an <strong>authentication token</strong> for the user's session. This token (or multiple tokens) is sent to the web browser as a cookie and is saved for future use. From that point, every request sent from the browser to the website will contain that session token, sent as a cookie. This is how websites recognize authenticated users after successful authentication. They do not ask users to log in, every time when page is reloaded.</p>
<p><strong>This session token cookie is pure gold for the attacker</strong>. If you export cookies from your browser and import them into a different browser, on a different computer, in a different country, you will be authorized and get full access to the account, without being asked for usernames, passwords or 2FA tokens.</p>
<p>This is what it looks like, in Evilginx 2, when <strong>session token cookie is successfully captured</strong>:<br>
<img src="https://breakdev.org/content/images/2018/07/sessions1.png" alt="Capturing session cookies" loading="lazy"></p>
<p>Now that we know how valuable the session cookie is, how can the attacker intercept it remotely, without having physical access to the victim's computer?</p>
<p>Common phishing attacks rely on creating <strong>HTML templates</strong> which <strong>take time to make</strong>. Most work is spent on making them look good, being responsive on mobile devices or properly obfuscated to evade phishing detection scanners.</p>
<p><img src="https://breakdev.org/content/images/2018/07/phishing1.png" alt="Image of Evilginx phishing page" loading="lazy"></p>
<p>Evilginx takes the attack one step further and <strong>instead of serving its own HTML lookalike pages, it becomes a web proxy</strong>. Every packet, coming from victim's browser, is intercepted, modified and forwarded to the real website. The same happens with response packets, coming from the website; they are intercepted, modified and sent back to the victim. With Evilginx <strong>there is no need to create your own HTML templates</strong>. On the victim side everything looks as if he/she was communicating with the legitimate website. User has no idea idea that Evilginx <strong>sits as a man-in-the-middle</strong>, analyzing every packet and <strong>logging usernames, passwords and, of course, session cookies</strong>.</p>
<p>You may ask now, what about encrypted HTTPS connection using SSL/TLS that prevents eavesdropping on the communication data? Good question. Problem is that the victim is only talking, over HTTPS, to Evilginx server and not the true website itself. Evilginx initiates its own HTTPS connection with the victim (using its own SSL/TLS certificates), receives and decrypts the packets, only to <strong>act as a client itself</strong> and establish its own HTTPS connection with the destination website, where it sends the re-encrypted packets, as if it was the victim's browser itself. This is how the trust chain is broken and the <strong>victim still sees that green lock icon next to the address bar</strong>, in the browser, thinking that everyone is safe.</p>
<p>When the victim enters the credentials and is asked to provide a 2FA challenge answer, they are still talking to the real website, with Evilginx relaying the packets back and forth, sitting in the middle. Even while being phished, the <strong>victim will still receive the 2FA SMS code</strong> to his/her mobile phone, because he/she is talking to the real website (just through a relay).</p>
<p><img src="https://breakdev.org/content/images/2018/07/evilginx2_diagram.png" alt="Diagram of Evilginx in the middle proxying the connection" loading="lazy"></p>
<p>After the 2FA challenge is completed by the victim and the website confirms its validity, website generates the session token, which it returns in form of a cookie. This <strong>cookie is intercepted by Evilginx</strong> and saved. Evilginx determines that authentication was a success and redirects the victim to any URL it was set up with (online document, video etc.).</p>
<p>At this point the <strong>attacker holds all the keys to the castle</strong> and is able to use the victim's account, <strong>fully bypassing 2FA protection</strong>, after importing the session token cookies into his web browser.</p>
<p>Be aware that: <strong>Every sign-in page, requiring the user to provide their password, with any form of 2FA implemented, can be phished using this technique!</strong></p>
<h4 id="howtoprotectyourself">How to protect yourself?</h4>
<p>There is one major flaw in this phishing technique that anyone can and should exploit to protect themselves - <strong>the attacker must register their own domain</strong>.</p>
<p>By registering a domain, attacker will try to make it look as similar to real, legitimate domain as possible. For example if the attacker is targeting Facebook (real domain is <code>facebook.com</code>), they can, for example, register a domain <code>faceboook.com</code> or <code>faceb00k.com</code>, maximizing their chances that phished victims won't spot the difference in the browser's address bar.</p>
<p>That said - <strong>always check the legitimacy of website's base domain, visible in the address bar, if it asks you to provide any private information</strong>. By base domain I mean the one that precedes the <a href="https://en.wikipedia.org/wiki/Top-level_domain">top-level domain</a>.</p>
<p><img src="https://breakdev.org/content/images/2018/07/phishing2.png" alt="Phished page with phishing URL" loading="lazy"></p>
<p>As an example, imagine this is the URL and the website, you arrived at, asks you to log into Facebook:</p>
<pre><code class="language-language">https://en-gb.facebook.cdn.global.faceboook.com/login.php
</code></pre>
<p>The top-level domain is <code>.com</code> and the base domain would be the preceeding word, with next <code>.</code> as a separator. Combined with TLD, that would be <code>faceboook.com</code>. When you verify that <code>faceboook.com</code> is not the real <code>facebook.com</code>, you will know that someone is trying to phish you.</p>
<p>As a side note - <strong>Green lock icon seen next to the URL, in the browser's address bar, does not mean that you are safe!</strong></p>
<p>Green lock icon only means that the website you've arrived at, <strong>encrypts the transmission between you and the server</strong>, so that no-one can eavesdrop on your communication. <strong>Attackers can easily obtain SSL/TLS certificates</strong> for their phishing sites and give you a false sense of security with the ability to display the green lock icon as well.</p>
<p>Figuring out if the base domain you see is valid, sometimes may not be easy and leaves room for error. It became even harder with the support of Unicode characters in domain names. This made it possible for attackers to register domains with special characters (e.g. in Cyrillic) that would be lookalikes of their Latin counterparts. This technique recieved a name of a <a href="https://en.wikipedia.org/wiki/IDN_homograph_attack">homograph attack</a>.</p>
<p>As a quick example, an attacker could register a domain <code>facebooĸ.com</code>, which would look pretty convincing even though it was a completely different domain name (<code>ĸ</code> is not really <code>k</code>). It got even worse with other Cyrillic characters, allowing for <code>ebаy.com</code> vs <code>ebay.com</code>. The first one has an Cyrillic counterpart for <code>a</code> character, which looks exactly the same.</p>
<p>Major browsers were fast to <a href="https://www.chromium.org/developers/design-documents/idn-in-google-chrome">address the problem</a> and added special filters to prevent domain names from being displayed in Unicode, when suspicious characters were detected.</p>
<p>If you are interested in how it works, check out the <a href="https://github.com/chromium/chromium/blob/998ff8fbb32cb0fdf1b6bdd9e885d2b1d7c48bbe/components/url_formatter/idn_spoof_checker.cc">IDN spoofing filter</a> source code of the Chrome browser.</p>
<p>Now you see that verifying domains visually is not always the best solution, especially <a href="https://www.businessinsider.com/none-of-googles-employees-get-phished-because-of-yubikey-security-key-2018-7">for big companies</a>, where it often <strong>takes just one employee to get phished</strong> and allow attackers to <strong>steal vast amounts of data</strong>.</p>
<p>This is why FIDO Alliance introduced <a href="https://fidoalliance.org/specifications/overview/">U2F</a> (<em>Universal 2nd Factor Authentication</em>) to allow for unphishable 2nd factor authentication.</p>
<p>In short, you have a <strong>physical hardware key</strong> on which you just press a button when the website asks you to. Additionally it may ask you for account password or a complementary 4 digit PIN. The website talks directly with the hardware key plugged into your USB port, with the web browser as the channel provider for the communication.</p>
<p><img src="https://www.yubico.com/wp-content/uploads/2014/10/Slider-U2F-03.png" alt="YubiKey slide" loading="lazy"></p>
<p>What is different with this form of authentication, is that <strong>U2F protocol is designed to take the website's domain as one of the key components in negotiating the handshake</strong>. This means that if the domain in the browser's address bar, does not match the domain used in the data transmission between the website and the U2F device, the <strong>communication will simply fail</strong>. This solution leaves no room for error and is <strong>totally unphishable</strong> using Evilginx method.</p>
<p>Citing the vendor of U2F devices - Yubico (who co-developed U2F with Google):</p>
<blockquote>
<p>With the YubiKey, user login is bound to the origin, meaning that only the real site can authenticate with the key. The authentication will fail on the fake site even if the user was fooled into thinking it was real. This greatly mitigates against the increasing volume and sophistication of phishing attacks and stops account takeovers.</p>
</blockquote>
<p>It is important to note here that Markus Vervier (<a href="https://twitter.com/marver">@marver</a>) and Michele Orrù (<a href="https://twitter.com/antisnatchor">@antisnatchor</a>) did demonstrate a technique on <a href="https://www.wired.com/story/chrome-yubikey-phishing-webusb/">how an attacker can attack U2F devices</a> using the newly implemented WebUSB feature in modern browsers (which allows websites to talk with USB connected devices). It is also important to mention that Yubico, the creator of popular U2F devices YubiKeys, tried to <a href="http://pwnaccelerator.github.io/2018/webusb-yubico-disclosure.html">steal credit for their research</a>, which they later <a href="https://www.yubico.com/2018/06/webusb-and-responsible-disclosure/">apologized for</a>.</p>
<p>You can find the list of all websites supporting U2F authentication <a href="https://www.dongleauth.info/">here</a>.</p>
<p>Coinciding with the release of Evilginx 2, <a href="https://en.wikipedia.org/wiki/WebAuthn">WebAuthn</a> is coming out in all major web browsers. It will introduce the new <a href="https://fidoalliance.org/fido2/">FIDO2</a> password-less authentication standard to every browser. <a href="https://developers.google.com/web/updates/2018/05/webauthn">Chrome</a>, <a href="https://hacks.mozilla.org/2018/01/using-hardware-token-based-2fa-with-the-webauthn-api/">Firefox</a> and <a href="https://docs.microsoft.com/en-us/microsoft-edge/dev-guide/device/web-authentication">Edge</a> are about to receive full support for it.</p>
<p>To wrap up - if you often need to log into various services, make your life easier and <strong>get a U2F device!</strong> This will greatly improve your accounts' security.</p>
<h4 id="underthehood">Under the hood</h4>
<p>Interception of HTTP packets is possible since Evilginx acts as an <strong>HTTP server talking to the victim's browser</strong> and, at the same time, acts as an <strong>HTTP client for the website where the data is being relayed to</strong>. To make it possible, the victim has to be contacting Evilginx server through a custom phishing URL that will point to Evilginx server. Simply forwarding packets from victim to destination website would not work well and that's why Evilginx has to do some on-the-fly modifications.</p>
<p>In order for the phishing experience to be seamless, the proxy overcomes the following obstacles:</p>
<p><strong>1. Making sure that the victim is not redirected to phished website's true domain.</strong></p>
<p>Since the phishing domain will differ from the legitimate domain, used by phished website, relayed scripts and HTML data have to be carefully modified to <strong>prevent unwanted redirection of victim's web browser</strong>. There will be HTML submit forms pointing to legitimate URLs, scripts making AJAX requests or JSON objects containing URLs.</p>
<p>Ideally the most reliable way to solve it would be to perform regular expression string substitution for any occurrence of <code>https://legit-site.com</code> and replacing it with <code>https://our-phishing-site.com</code>. Unfortunately this is not always the case and it requires some trial and error kung-fu, working with web inspector to track down all strings the proxy needs to replace to not break website's functionality. If target website uses multiple options for 2FA, each route has to be inspected and analyzed.</p>
<p>For example, there are JSON objects transporting escaped URLs like <code>https:\/\/legit-site.com</code>. You can see that this will definitely not trigger the regexp mentioned above. If you replaced all occurrences of <code>legit-site.com</code> you may break something by accident.</p>
<p><strong>2. Responding to DNS requests for multiple subdomains.</strong></p>
<p>Websites will often make requests to multiple subdomains under their official domain or even use a totally different domain. In order to proxy these transmissions, Evilginx has to <strong>map each of the custom subdomains to its own IP address</strong>.</p>
<p>Previous version of Evilginx required the user to set up their own DNS server (e.g. <code>bind</code>) and set up DNS zones to properly handle <a href="https://en.wikipedia.org/wiki/List_of_DNS_record_types">DNS A</a> requests. This generated a lot of headache on the user part and was only easier if the hosting provider (like Digital Ocean) provided an easy-to-use admin panel for setting up DNS zones.</p>
<p>With Evilginx 2 <strong>this issue is gone</strong>. Evilginx now runs its own in-built DNS server, listening on port 53, which acts as a nameserver for your domain. All you need to do is set up the nameserver addresses for your domain (<code>ns1.yourdomain.com</code> and <code>ns2.yourdomain.com</code>) to point to your Evilginx server IP, in the admin panel of your domain hosting provider. Evilginx will handle the rest on its own.</p>
<p><strong>3. Modification of various HTTP headers.</strong></p>
<p>Evilginx modifies HTTP headers sent to and received from the destination website. In particular the <code>Origin</code> header, in AJAX requests, will always hold the URL of the requesting site in order to comply with <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>. <strong>Phishing sites will hold a phishing URL as an origin</strong>. When request is forwarded, the destination website will receive an invalid origin and will not respond to such request. Not replacing the phishing hostname with the legitimate one in the request would make it also easy for the website to notice suspicious behavior. Evilginx automatically changes <code>Origin</code> and <code>Referer</code> fields on-the-fly to their legitimate counterparts.</p>
<p>Same way, to avoid any conflicts with CORS from the other side, Evilginx makes sure to set the <code>Access-Control-Allow-Origin</code> header value to <code>*</code> (if it exists in the response) and removes any occurrences of <code>Content-Security-Policy</code> headers. This guarantees that <strong>no request will be restricted by the browser</strong> when AJAX requests are made.</p>
<p>Other header to modify is <code>Location</code>, which is set in HTTP <code>302</code> and <code>301</code> responses to redirect the browser to different location. Naturally the value will come with legitimate website URL and Evilginx makes sure this location is properly switched to corresponding phishing hostname.</p>
<p><strong>4. Cookies filtering.</strong></p>
<p>It is common for websites to manage cookies for various purposes. Each cookie is assigned to a specific domain. Web browser's task is to automatically send the stored cookie, with every request to the domain, the cookie was assigned to. Cookies are also sent as HTTP headers, but I decided to make a separate mention of them here, due to their importance. Example cookie sent from the website to client's web browser would look like this:</p>
<pre><code class="language-language-http">Set-Cookie: qwerty=219ffwef9w0f; Domain=legit-site.com; Path=/; Expires=Wed, 30 Aug 2019 00:00:00 GMT
</code></pre>
<p>As you can see the cookie will be set in client's web browser for <code>legit-site.com</code> domain. Since the phishing victim is only talking to the phishing website with domain <code>our-phishing-site.com</code>, such cookie will never be saved in the browser, because of the fact the <strong>cookie domain differs from the one the browser is communicating with</strong>. Evilginx will parse every occurrence of <code>Set-Cookie</code> in HTTP response headers and modify the domain, replacing it with the phishing one, as follows:</p>
<pre><code class="language-language-http">Set-Cookie: qwerty=219ffwef9w0f; Domain=our-phishing-site.com; Path=/;
</code></pre>
<p>Evilginx will also remove expiration date from cookies, if the expiration date does not indicate that the cookie should be deleted from browser's cache.</p>
<p>Evilginx also sends its own cookies to manage the victim's session. These cookies are filtered out from every HTTP request, to prevent them from being sent to the destination website.</p>
<p><strong>5. SSL splitting.</strong></p>
<p>As the whole world of world-wide-web migrates to serving pages over secure HTTPS connections, phishing pages can't be any worse. Whenever you pick a hostname for your phishing page (e.g. <code>totally.not.fake.linkedin.our-phishing-domain.com</code>), Evilginx will <strong>automatically obtain a valid SSL/TLS certificate from LetsEncrypt</strong> and provide responses to <a href="https://letsencrypt.org/how-it-works/">ACME challenges</a>, using the in-built HTTP server.</p>
<p>This makes sure that <strong>victims will always see a green lock icon next to the URL address bar</strong>, when visiting the phishing page, comforting them that everything is secured using <em>&quot;military-grade&quot;</em> encryption!</p>
<p><strong>6. Anti-phishing tricks</strong></p>
<p>There are rare cases where websites would employ defenses against being proxied. One of such defenses I uncovered during testing is using javascript to check if <code>window.location</code> contains the legitimate domain. These detections may be easy or hard to spot and much harder to remove, if additional code obfuscation is involved.</p>
<h4 id="improvements">Improvements</h4>
<p>The greatest advantage of Evilginx 2 is that it is now a standalone console application. There is no need to compile and install custom version of nginx, which I admit was not a simple feat. I am sure that using nginx site configs to utilize <code>proxy_pass</code> feature for phishing purposes was not what HTTP server's developers had in mind, when developing the software.</p>
<p><img src="https://breakdev.org/content/images/2018/07/start1.png" alt="Evilginx 2 CLI screenshot" loading="lazy"></p>
<p><strong>Evilginx 1 was pretty much a combination of several dirty hacks, duct taped together</strong>. Nonetheless it somehow worked!</p>
<p>Additionally to fully responsive console UI, here are the greatest improvements:</p>
<p><strong>Tokenized phishing URLs</strong></p>
<p>In previous version of Evilginx, entering just the hostname of your phishing URL address in the browser, with root path (e.g. <code>https://totally.not.fake.linkedin.our-phishing-domain.com/</code>), would still proxy the connection to the legitimate website. This turned out to be an issue, as I found out during development of Evilginx 2. Apparently once you obtain SSL/TLS certificates for the domain/hostname of your choice, <strong>external scanners start scanning your domain</strong>. Scanners gonna scan.</p>
<p>The scanners use public <a href="http://www.certificate-transparency.org/known-logs">certificate transparency logs</a> to scan, in real-time, all domains which have obtained valid SSL/TLS certifcates. With public libraries like <a href="https://certstream.calidog.io/">CertStream</a>, you can easily create your <a href="https://blog.0day.rocks/catching-phishing-using-certstream-97177f0d499a">own scanner</a>.</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*irHGbmYEEtDR04aZSHPqgQ.gif" alt="Catching phish!" loading="lazy"></p>
<p>For some phishing pages, <strong>it took usually one hour for the hostname to become banned and blacklisted by popular anti-spam filters</strong> like Spamhaus. After I had three hostnames blacklisted for one domain, the whole domain got blocked. Three strikes and you're out!</p>
<p>I began thinking how such detection can be evaded. Easiest solution was to reply with faked response to every request for path <code>/</code>, but that would not work if scanners probed for any other path.</p>
<p>Then I decided that each phishing URL, generated by Evilginx, should come with a <strong>unique token</strong> in the URL as a GET parameter.</p>
<p>For example, Evilginx responds with redirection response when scanner makes a request to URL:</p>
<pre><code class="language-language">https://totally.not.fake.linkedin.our-phishing-domain.com/auth/signin
</code></pre>
<p>But it <strong>responds with proxied phishing page</strong>, instead, when the URL is properly tokenized, with a valid token:</p>
<pre><code class="language-language">https://totally.not.fake.linkedin.our-phishing-domain.com/auth/signin?tk=secret_l33t_token
</code></pre>
<p>When tokenized URL is opened, Evilginx <strong>sets a validation cookie in victim's browser, whitelisting all subsequent requests</strong>, even for the non-tokenized ones.</p>
<p>This works very well, but there is still risk that scanners will eventually scan tokenized phishing URLs when these get out into the interwebz.</p>
<p><strong>Hiding your phishlets</strong></p>
<p>This thought provoked me to find a solution that allows manual control over when the phishing proxy should respond with proxied website and when it should not. As a result, you can <code>hide</code> and <code>unhide</code> the phishign page whenever you want. <strong>Hidden phishing page will respond with a redirection 302 HTTP code</strong>, redirecting the requester to predefined URL (Rick Astley's famous clip on Youtube is the default).</p>
<p>Temporarily hiding your phishlet may be useful when you want to use a URL shortener, to shorten your phishing URL (like <code>goo.gl</code> or <code>bit.ly</code>) or when you are sending the phishing URL via email and you don't want to trigger any email scanners, on the way.</p>
<h4 id="phishlets">Phishlets</h4>
<p>Phishlets are new site configs. They are plain-text ruleset files, in YAML format, which are fed into the Evilginx engine. Phishlets define which subdomains are needed to properly proxy a specific website, what strings should be replaced in relayed packets and which cookies should be captured, to properly take over the victim's account. There is one phishlet for each phished website. You can deploy as many phishlets as you want, with each phishlet set up for a different website. Phishlets can be enabled and disabled as you please and at any point Evilginx can be running and managing any number of them.</p>
<p>I will do a better job than I did last time, when I released Evilginx 1, and I will try to explain the structure of a phishlet and give you brief insight into how phishlets are created (I promise to release a separate blog post about it later!).</p>
<p>I will dissect the LinkedIn phishlet for the purpose of this short guide:</p>
<pre><code class="language-language-yaml">name: 'linkedin'
author: '@mrgretzky'
min_ver: '2.0.0'
proxy_hosts:
  - {
    phish_sub: 'www',
    orig_sub: 'www',
	domain: 'linkedin.com',
	session: true,
	is_landing: true
	}
sub_filters:
  - {
    hostname: 'www.linkedin.com',
	sub: 'www',
	domain: 'linkedin.com',
	search: 'action=&quot;https://{hostname}',
	replace: 'action=&quot;https://{hostname}',
	mimes: ['text/html', 'application/json']
	}
  - {
    hostname: 'www.linkedin.com',
	sub: 'www',
	domain: 'linkedin.com',
	search: 'href=&quot;https://{hostname}',
	replace: 'href=&quot;https://{hostname}',
	mimes: ['text/html', 'application/json']
	}
  - {
    hostname: 'www.linkedin.com',
	sub: 'www',
	domain: 'linkedin.com',
	search: '//{hostname}/nhome/',
	replace: '//{hostname}/nhome/',
	mimes: ['text/html', 'application/json']
	}
auth_tokens:
  - domain: 'www.linkedin.com'
    keys: ['li_at']
user_regex:
  key: 'session_key'
  re: '(.*)'
pass_regex:
  key: 'session_password'
  re: '(.*)'
landing_path:
  - '/uas/login'
</code></pre>
<p>First things first. I advise you to get familiar with <a href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html">YAML syntax</a> to avoid any errors when editing or creating your own phishlets.</p>
<p>Starting off with simple and rather self-explanatory variables. <code>name</code> is the name of the phishlet, which would usually be the name of the phished website. <code>author</code> is where you can do some self promotion - this will be visible in Evilginx's UI when the phishlet is loaded. <code>version</code> is currently not supported, but will be very likely used when phishlet format changes in future releases of Evilginx, to provide some way of checking phishlet's compatibility with current tool's version.</p>
<p>Following that, we have <code>proxy_hosts</code>. This array holds an array of sub-domains that Evilginx will manage. This provides an array of all hostnames for which you want to intercept the transmission and gives you the capability to make on-the-fly packet modifications.</p>
<ul>
<li><code>phish_sub</code> : subdomain name that will be prefixed in the phishlet's hostname. I advise to leave it the same as the original subdomain name, due to issues that may arise later when doing string replacements properly, as it often requires additional work to support custom subdomain names.</li>
<li><code>orig_sub</code> : the original subdomain name as used on the legitimate website.</li>
<li><code>domain</code> : website's domain that we are targeting.</li>
<li><code>session</code> : set this to <code>true</code> <strong>ONLY</strong> for subdomains that will return authentication cookies. This indicates which subdomain Evilginx should recognize as the one that will initiate the creation of Evilginx session and sets Evilginx session cookie for the domain name of this entry.</li>
<li><code>is_landing</code> : set this to <code>true</code> if you want this subdomain to be used in generation of phishing URLs later.</li>
</ul>
<p>In the LinkedIn example, we only have one subdomain that we need to support, which is <code>www</code>. The phishing hostname for this subdomain will then be: <code>www.totally.not.fake.linkedin.our-phishing-domain.com</code>.</p>
<p>Next are <code>sub_filters</code>, which tell Evilginx all about string substitution magics.</p>
<ul>
<li><code>hostname</code> : original hostname of the website, for which the substitution will take place.</li>
<li><code>sub</code> : subdomain name from the original hostname. This is will be only used as a helper string in substitutions that I will explain below.</li>
<li><code>domain</code> : domain name of the original hostname. Same as <code>sub</code> - used as a helper string in substitutions.</li>
<li><code>search</code> : the regular expression of what to search for in HTTP packet's body. You can use some variables in <code>{...}</code> that Evilginx will prefill for you. I listed all supported variables below.</li>
<li><code>replace</code> : the string that will act as a replacement for all occurrences of <code>search</code> regular expression matches. <code>{...}</code> variables are also supported here.</li>
<li><code>mimes</code> : an array of MIME types that will only be considered before doing search and replace. Any of these defined MIME types must show up in <code>Content-Type</code> header of the HTTP response, before Evilginx considers to do any substitutions, for that packet. Most common MIME types to use here are: <code>text/html</code>, <code>application/json</code>, <code>application/javascript</code> or <code>text/javascript</code>.</li>
<li><code>redirect_only</code> : use this <code>sub_filter</code> only if redirection URL is set in generated phishing URL (<code>true</code> or <code>false</code>).</li>
</ul>
<p>The following is a list of bracket variables that you can use in <code>search</code> and <code>replace</code> parameters:</p>
<ul>
<li><code>{hostname}</code> : a combination of subdomain, defined by <code>sub</code> parameter, and a domain, defined by <code>domain</code> parameter. In <code>search</code> field it will be translated to the original website's hostname (e.g. <code>www.linkedin.com</code>). In the <code>replace</code> field, it will be translated to corresponding phishing hostname of matching <code>proxy_hosts</code> entry (e.g. <code>www.totally.not.fake.linkedin.our-phishing-domain.com</code>).</li>
<li><code>{subdomain}</code> : same as <code>{hostname}</code> but only for the subdomain.</li>
<li><code>{domain}</code> : same as <code>{hostname}</code> but only for the domain.</li>
<li><code>{domain_regexp}</code> : same as <code>{domain}</code> but translates to properly escaped regular expression string. This can sometimes be useful when replacing anti-phishing protections in javascript, that try to verify if <code>window.location</code> contains the legitimate domain.</li>
<li><code>{hostname_regexp}</code> : same as above, but for the hostname.</li>
<li><code>{subdomain_regexp}</code> : same as above, but for the subdomain.</li>
</ul>
<p>In the example we have:</p>
<pre><code class="language-language-yaml">  - {
    hostname: 'www.linkedin.com',
	sub: 'www',
	domain: 'linkedin.com',
	search: 'action=&quot;https://{hostname}',
	replace: 'action=&quot;https://{hostname}',
	mimes: ['text/html', 'application/json']
	}
</code></pre>
<p>This will make Evilginx search for packets with <code>Content-Type</code> of <code>text/html</code> or <code>application/json</code> and look for occurrences of <code>action=&quot;https://www\.linkedin\.com</code> (properly escaped regexp). If found, it will replace every occurrence with <code>action=&quot;https://www.totally.not.fake.linkedin.our-phishing-domain.com</code>.</p>
<p>As you can see this will replace the <code>action</code> URL of the login HTML form to have it point to Evilginx server, so that the victim does not stray off the phishing path.</p>
<p>That was the most complicated part. Now it should be pretty straight forward.</p>
<p>Next up are <code>auth_tokens</code>. This is where you define the <strong>cookies that should be captured on successful login</strong>, which combined together provide the full state of the website's captured session. The cookies defined here, when obtained, can later be imported to any browser (using <a href="https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en">this</a> extension in Chrome) and allow to be immediately logged into the victim's account, bypassing any 2FA challenges.</p>
<ul>
<li><code>domain</code> : original domain for which the cookies will be saved for.</li>
<li><code>keys</code> : array of cookie names that should be captured.</li>
</ul>
<p>In the example, there is only one cookie that LinkedIn uses to verify the session's state. Only <code>li_at</code> cookie, saved for <code>www.linkedin.com</code> domain will be captured and stored.</p>
<p>Once Evilginx captures all of the defined cookies, it will display a message that authentication was successful and will store them in the database.</p>
<p>The two following parameters are similar <code>user_regex</code> and <code>pass_regex</code>. These define the POST request keys that should be searched for occurrences of usernames and passwords. Searching is defined by a regular expression that is ran against the contents of the POST request's key value.</p>
<ul>
<li><code>key</code> : name of the POST request key.</li>
<li><code>re</code> : regular expression defining what data should be captured from the key's value (e.g. <code>(.*)</code> will capture the whole value)</li>
</ul>
<p>Last parameter is <code>landing_path</code> array, which holds URL paths to login pages (usually one), of the phished website.</p>
<p>In our example, there is <code>/uas/login</code> which would translate to <code>https://www.totally.not.fake.linkedin.our-phishing-domain.com/uas/login</code> for the generated phishing URL.</p>
<p>Hope that sheds some light on how you can create your own phishlets and should help you understand the ones that are already shipped with Evilginx in the <code>./phishlets</code> directory.</p>
<h4 id="futuredevelopment">Future development</h4>
<p>I'd like to continue working on Evilginx 2 and there are some things I have in mind that I want to eventually implement.</p>
<p>One of such things is serving an HTML page instead of 302 redirect for hidden phishlets. This could be a page imitating CloudFlare's &quot;checking your browser&quot; that would wait in a loop and redirect, to the phishing page, as soon as you unhide your phishlet.</p>
<p><img src="https://i.stack.imgur.com/8CIiP.png" alt="CloudFlare is checking your browser" loading="lazy"></p>
<p>Another thing to have at some point is to have Evilginx launch as a daemon, without the UI.</p>
<p><strong>Update:</strong> You can find out about version 2.1 release <a href="https://breakdev.org/evilginx-2-1-the-first-post-release-update/">here</a></p>
<h4 id="businessinquiries">Business Inquiries</h4>
<p>If you are a red teaming company interested in <strong>development of custom phishing solutions</strong>, drop me a line and I will be happy to assist in any way I can.</p>
<p>If you are giving presentations on flaws of 2FA and/or promoting the use of FIDO U2F/FIDO2 devices, I'd love to hear how Evilginx can help you raise awareness.</p>
<p>In any case, send me an email at: <a href="mailto:kuba@breakdev.org">kuba@breakdev.org</a></p>
<p><strong>I'll respond as soon as I can!</strong></p>
<h4 id="credits">Credits</h4>
<p>Since the release of Evilginx 1, in April last year, a lot has changed in my life for the better. I met a lot of wonderful, talented people, in front of whom I could exercise my impostor syndrome!</p>
<p>I'd like to thank few people without whom this release would not have been possible:</p>
<p><strong><a href="https://twitter.com/evilsocket">@evilsocket</a></strong> - for letting me know that Evilginx is awesome, inspiring me to learn GO and for developing so many incredible products that I could <s>steal</s> borrow code from!</p>
<p><strong><a href="https://twitter.com/antisnatchor">@antisnatchor</a></strong> and <strong><a href="https://twitter.com/h0wlu">@h0wlu</a></strong> - for organizing <a href="http://warcon.pl/">WarCon</a> and for inviting me!</p>
<p><strong><a href="https://twitter.com/juliocesarfort">@juliocesarfort</a></strong> and <strong><a href="https://twitter.com/Mario_Vilas">@Mario_Vilas</a></strong> - for organizing <a href="https://www.alligatorcon.pl/">AlligatorCon</a> and for being great reptiles!</p>
<p><strong><a href="https://twitter.com/x33fcon">@x33fcon</a></strong> - for organizing <a href="https://www.x33fcon.com">x33fcon</a> and letting me do all these lightning talks!</p>
<p><strong>Vincent Yiu (<a href="https://twitter.com/vysecurity">@vysecurity</a>)</strong> - for all the red tips and invitations to secret security gatherings!</p>
<p><strong>Kevin Mitnick (<a href="https://twitter.com/kevinmitnick">@kevinmitnick</a>)</strong> - for giving Evilginx a try and making me realize its importance!</p>
<p><strong><a href="https://twitter.com/i_bo0om">@i_bo0om</a></strong> - for giving me an idea to play with nginx's <code>proxy_pass</code> feature in his <a href="https://bo0om.ru/telegram-love-phdays-en">post</a>.</p>
<p><strong>Cristofaro Mune (<a href="https://twitter.com/pulsoid">@pulsoid</a>)</strong> &amp; <strong>Denis Laskov (<a href="https://twitter.com/it4sec">@it4sec</a>)</strong> - for spending their precious time to hear out my concerns about releasing such tool to the public.</p>
<p><strong>Giuseppe &quot;Ohpe&quot; Trotta (<a href="https://twitter.com/Giutro">@Giutro</a>)</strong> - for a heads up that there may be other similar tools lurking around in the darkness ;)</p>
<p><strong>#apt</strong> - everyone I met there, for sharing amazing contributions.</p>
<center>**Thank you!**</center>
<hr>
<h6 id="thatsitthanksforbeingabletoreadthisoverlylongpost">That's it! Thanks for being able to read this overly long post!</h6>
<h6 id="enjoythetoolandimwaitingforyourfeedback">Enjoy the tool and I'm waiting for your feedback!</h6>
<center><h6>[>> Follow me on Twitter <<](https://twitter.com/mrgretzky)</h6></center>
<center><h6>[>> Download Evilginx 2 from GitHub <<](https://github.com/kgretzky/evilginx2)</h6></center>
<!--kg-card-end: markdown-->
    </section>


</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post featured">

    <a class="post-card-image-link" href="/evilginx-3-3-go-phish/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2024/04/evilginx33.png 300w,
                    /content/images/size/w600/2024/04/evilginx33.png 600w,
                    /content/images/size/w1000/2024/04/evilginx33.png 1000w,
                    /content/images/size/w2000/2024/04/evilginx33.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2024/04/evilginx33.png"
            alt="Evilginx 3.3 - Go &amp; Phish"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/evilginx-3-3-go-phish/">
            <header class="post-card-header">
                <div class="post-card-tags">
                        <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
                </div>
                <h2 class="post-card-title">
                    Evilginx 3.3 - Go &amp; Phish
                </h2>
            </header>
                <div class="post-card-excerpt">Evilginx 3.3 update is here and it comes packing with the special feature everyone has been waiting for.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2024-04-02">Apr 2, 2024</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">9 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/evilginx-pro-reveal/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2023/09/evilginx-pro-reveal.png 300w,
                    /content/images/size/w600/2023/09/evilginx-pro-reveal.png 600w,
                    /content/images/size/w1000/2023/09/evilginx-pro-reveal.png 1000w,
                    /content/images/size/w2000/2023/09/evilginx-pro-reveal.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2023/09/evilginx-pro-reveal.png"
            alt="Evilginx Pro - The Future of Phishing"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/evilginx-pro-reveal/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Evilginx Pro - The Future of Phishing
                </h2>
            </header>
                <div class="post-card-excerpt">I've teased the idea of Evilginx Pro long enough and I think it is finally time to make a proper reveal of what it exactly is.

Evilginx Pro will be a paid professional version of Evilginx, with extra features and added advanced reverse proxy anti-detection techniques, available only to BREAKDEV</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2023-09-27">Sep 27, 2023</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">11 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/breakdev-red/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2023/08/breakdev_red.png 300w,
                    /content/images/size/w600/2023/08/breakdev_red.png 600w,
                    /content/images/size/w1000/2023/08/breakdev_red.png 1000w,
                    /content/images/size/w2000/2023/08/breakdev_red.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2023/08/breakdev_red.png"
            alt="BREAKDEV RED - Red Team Community"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/breakdev-red/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    BREAKDEV RED - Red Team Community
                </h2>
            </header>
                <div class="post-card-excerpt">Join the vetted Discord community, oriented around using Evilginx and ethical phishing, where everyone can safely share their phishing tips and tricks without worrying about them being misused by unknown parties.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2023-08-30">Aug 30, 2023</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">3 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://breakdev.org">BREAKDEV</a> &copy; 2024</section>
            <nav class="site-footer-nav">
                <ul class="nav">
    <li class="nav-e-mail"><a href="mailto:kuba@breakdev.org">E-mail</a></li>
    <li class="nav-github"><a href="https://github.com/kgretzky">GitHub</a></li>
    <li class="nav-twitter"><a href="https://twitter.com/mrgretzky">Twitter</a></li>
    <li class="nav-linkedin"><a href="https://www.linkedin.com/in/kubagretzky">LinkedIn</a></li>
</ul>

            </nav>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=5cb0155b50"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-core.min.js" integrity="sha512-9khQRAUBYEJDCDVP2yw3LRUQvjJ0Pjx0EShmaQjcHa6AXiOv6qHQu9lCAIR8O+/D8FtaCoJ2c0Tf9Xo7hYH01Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-fTl/qcO1VgvKtOMApX2PdZzkziyr2stM65GYPLGuYMnuMm1z2JLJG6XVU7C/mR+E7xBUqCivykuhlzfqxXBXbg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</body>
</html>
