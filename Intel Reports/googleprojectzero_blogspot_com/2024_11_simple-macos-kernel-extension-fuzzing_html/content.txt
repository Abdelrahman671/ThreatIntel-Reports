<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://googleprojectzero.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Project Zero - RSS" href="https://googleprojectzero.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Project Zero - Atom" href="https://www.blogger.com/feeds/4838136820032157985/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/7116102695364781863/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/s435/image1.png' rel='image_src'/>
<meta content='https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html' property='og:url'/>
<meta content='Simple macOS kernel extension fuzzing in userspace with IDA and TinyInst' property='og:title'/>
<meta content='    Posted by Ivan Fratric, Google Project Zero   Recently, one of the projects I was involved in had to do with video decoding on Apple pla...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/w1200-h630-p-k-no-nu/image1.png' property='og:image'/>
<title>Project Zero: Simple macOS kernel extension fuzzing in userspace with IDA and TinyInst</title>
<style type='text/css'>@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4taVIGxA.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4kaVIGxA.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4saVIGxA.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4jaVIGxA.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4iaVIGxA.woff2)format('woff2');unicode-range:U+0307-0308,U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5caVIGxA.woff2)format('woff2');unicode-range:U+0302-0303,U+0305,U+0307-0308,U+0310,U+0312,U+0315,U+031A,U+0326-0327,U+032C,U+032F-0330,U+0332-0333,U+0338,U+033A,U+0346,U+034D,U+0391-03A1,U+03A3-03A9,U+03B1-03C9,U+03D1,U+03D5-03D6,U+03F0-03F1,U+03F4-03F5,U+2016-2017,U+2034-2038,U+203C,U+2040,U+2043,U+2047,U+2050,U+2057,U+205F,U+2070-2071,U+2074-208E,U+2090-209C,U+20D0-20DC,U+20E1,U+20E5-20EF,U+2100-2112,U+2114-2115,U+2117-2121,U+2123-214F,U+2190,U+2192,U+2194-21AE,U+21B0-21E5,U+21F1-21F2,U+21F4-2211,U+2213-2214,U+2216-22FF,U+2308-230B,U+2310,U+2319,U+231C-2321,U+2336-237A,U+237C,U+2395,U+239B-23B7,U+23D0,U+23DC-23E1,U+2474-2475,U+25AF,U+25B3,U+25B7,U+25BD,U+25C1,U+25CA,U+25CC,U+25FB,U+266D-266F,U+27C0-27FF,U+2900-2AFF,U+2B0E-2B11,U+2B30-2B4C,U+2BFE,U+3030,U+FF5B,U+FF5D,U+1D400-1D7FF,U+1EE00-1EEFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5OaVIGxA.woff2)format('woff2');unicode-range:U+0001-000C,U+000E-001F,U+007F-009F,U+20DD-20E0,U+20E2-20E4,U+2150-218F,U+2190,U+2192,U+2194-2199,U+21AF,U+21E6-21F0,U+21F3,U+2218-2219,U+2299,U+22C4-22C6,U+2300-243F,U+2440-244A,U+2460-24FF,U+25A0-27BF,U+2800-28FF,U+2921-2922,U+2981,U+29BF,U+29EB,U+2B00-2BFF,U+4DC0-4DFF,U+FFF9-FFFB,U+10140-1018E,U+10190-1019C,U+101A0,U+101D0-101FD,U+102E0-102FB,U+10E60-10E7E,U+1D2C0-1D2D3,U+1D2E0-1D37F,U+1F000-1F0FF,U+1F100-1F1AD,U+1F1E6-1F1FF,U+1F30D-1F30F,U+1F315,U+1F31C,U+1F31E,U+1F320-1F32C,U+1F336,U+1F378,U+1F37D,U+1F382,U+1F393-1F39F,U+1F3A7-1F3A8,U+1F3AC-1F3AF,U+1F3C2,U+1F3C4-1F3C6,U+1F3CA-1F3CE,U+1F3D4-1F3E0,U+1F3ED,U+1F3F1-1F3F3,U+1F3F5-1F3F7,U+1F408,U+1F415,U+1F41F,U+1F426,U+1F43F,U+1F441-1F442,U+1F444,U+1F446-1F449,U+1F44C-1F44E,U+1F453,U+1F46A,U+1F47D,U+1F4A3,U+1F4B0,U+1F4B3,U+1F4B9,U+1F4BB,U+1F4BF,U+1F4C8-1F4CB,U+1F4D6,U+1F4DA,U+1F4DF,U+1F4E3-1F4E6,U+1F4EA-1F4ED,U+1F4F7,U+1F4F9-1F4FB,U+1F4FD-1F4FE,U+1F503,U+1F507-1F50B,U+1F50D,U+1F512-1F513,U+1F53E-1F54A,U+1F54F-1F5FA,U+1F610,U+1F650-1F67F,U+1F687,U+1F68D,U+1F691,U+1F694,U+1F698,U+1F6AD,U+1F6B2,U+1F6B9-1F6BA,U+1F6BC,U+1F6C6-1F6CF,U+1F6D3-1F6D7,U+1F6E0-1F6EA,U+1F6F0-1F6F3,U+1F6F7-1F6FC,U+1F700-1F7FF,U+1F800-1F80B,U+1F810-1F847,U+1F850-1F859,U+1F860-1F887,U+1F890-1F8AD,U+1F8B0-1F8BB,U+1F8C0-1F8C1,U+1F900-1F90B,U+1F93B,U+1F946,U+1F984,U+1F996,U+1F9E9,U+1FA00-1FA6F,U+1FA70-1FA7C,U+1FA80-1FA89,U+1FA8F-1FAC6,U+1FACE-1FADC,U+1FADF-1FAE9,U+1FAF0-1FAF8,U+1FB00-1FBFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4vaVIGxA.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4uaVIGxA.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4gaVI.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Group description="Page Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#222222"/>
</Group>
<Group description="Backgrounds" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd"/>
<Variable name="content.background.color" description="Main Background" type="color" default="#ffffff"/>
<Variable name="header.background.color" description="Header Background" type="color" default="transparent"/>
</Group>
<Group description="Links" selector=".main-outer">
<Variable name="link.color" description="Link Color" type="color" default="#2288bb"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#888888"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Font" type="font"
default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#3399bb" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.text.color" description="Description Color" type="color"
default="#777777" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#999999"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, .comments h4">
<Variable name="post.title.font" description="Font" type="font"
default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
</Group>
<Group description="Date Header" selector=".date-header">
<Variable name="date.header.color" description="Text Color" type="color"
default="#000000"/>
<Variable name="date.header.background.color" description="Background Color" type="color"
default="transparent"/>
<Variable name="date.header.font" description="Text Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit"/>
<Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit"/>
<Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit"/>
</Group>
<Group description="Post Footer" selector=".post-footer">
<Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="post.footer.background.color" description="Background Color" type="color"
default="#f9f9f9"/>
<Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadgets" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999"/>
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="#ffffff"/>
<Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee"/>
<Variable name="image.text.color" description="Caption Text Color" type="color" default="#000000"/>
</Group>
<Group description="Accents" selector=".content-inner">
<Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee"/>
<Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="transparent"/>
</Group>
<Variable name="body.background" description="Body Background" type="background"
color="#eeeeee" default="$(color) none repeat scroll top left"/>
<Variable name="body.background.override" description="Body Background Override" type="string" default=""/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png)"/>
<Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner"/>
<Variable name="content.padding" description="Content Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" min="0" max="100px"/>
<Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" min="0" max="100px"/>
<Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" min="0" max="100px"/>
<Variable name="main.border.width" description="Main Border Width" type="length" default="0" min="0" max="10px"/>
<Variable name="header.background.gradient" description="Header Gradient" type="url" default="none"/>
<Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" min="0" max="100px"/>
<Variable name="header.padding" description="Header Padding" type="length" default="30px" min="0" max="100px"/>
<Variable name="header.border.size" description="Header Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="description.text.size" description="Description Text Size" type="string" default="140%"/>
<Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px" min="0" max="100px"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" min="0" max="100px"/>
<Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" min="0" max="10px"/>
<Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" min="0" max="10px"/>
<Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner"/>
<Variable name="page.width" description="Page Width" type="string" default="auto"/>
<Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding" description="Main Padding" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" min="0" max="100px"/>
<Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" min="0" max="100px"/>
<Variable name="paging.background"
color="#ffffff"
description="Background of blog paging area" type="background"
default="transparent none no-repeat scroll top center"/>
<Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" min="0" max="10px"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Open Sans;
color: #000000;
background: #eeeeee none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 40px Open Sans;
color: #000000;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px Open Sans;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Open Sans;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(//www.blogblog.com/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #000000;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1120px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1120px;
max-width: 1120px;
_width: 1120px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<script type='text/javascript'>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-240546891-1', 'auto', 'blogger');
        ga('blogger.send', 'pageview');
      </script>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=638136f2-7118-4e7a-bda3-1dc43ba08f75' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=638136f2-7118-4e7a-bda3-1dc43ba08f75' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4838136820032157985\x26blogName\x3dProject+Zero\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://googleprojectzero.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://googleprojectzero.blogspot.com/\x26targetPostID\x3d7116102695364781863\x26blogPostOrPageUrl\x3dhttps://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html\x26vt\x3d-2489648517118057072',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe",
              messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
              messageHandlers: {
                'blogger-ping': function() {}
              }
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://googleprojectzero.blogspot.com/'>
Project Zero
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>News and updates from the Project Zero team at Google</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Thursday, November 21, 2024</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/s435/image1.png' itemprop='image_url'/>
<meta content='4838136820032157985' itemprop='blogId'/>
<meta content='7116102695364781863' itemprop='postId'/>
<a name='7116102695364781863'></a>
<h3 class='post-title entry-title' itemprop='name'>
Simple macOS kernel extension fuzzing in userspace with IDA and TinyInst
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-7116102695364781863' itemprop='description articleBody'>
<style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=4mNYFHt_IKFsPe52toizH4mR01TXY79of1zCqFsVTVk);.lst-kix_sm5qq1cfkkfw-5>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-5,lower-roman) ". "}.lst-kix_novl1in5rjiw-1>li:before{content:"-  "}.lst-kix_sm5qq1cfkkfw-3>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-3,decimal) ". "}.lst-kix_sm5qq1cfkkfw-4>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-4,lower-latin) ". "}.lst-kix_sm5qq1cfkkfw-2>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-2,lower-roman) ". "}.lst-kix_novl1in5rjiw-0>li:before{content:"-  "}ol.lst-kix_sm5qq1cfkkfw-0.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-0 0}.lst-kix_sm5qq1cfkkfw-0>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-0,decimal) ". "}.lst-kix_sm5qq1cfkkfw-1>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-1,lower-latin) ". "}ol.lst-kix_sm5qq1cfkkfw-3.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-3 0}ul.lst-kix_bo8ddvgukbmp-3{list-style-type:none}.lst-kix_jpktq1lpoaqv-5>li:before{content:"-  "}ul.lst-kix_bo8ddvgukbmp-2{list-style-type:none}ul.lst-kix_bo8ddvgukbmp-5{list-style-type:none}ul.lst-kix_bo8ddvgukbmp-4{list-style-type:none}.lst-kix_jpktq1lpoaqv-3>li:before{content:"-  "}.lst-kix_jpktq1lpoaqv-4>li:before{content:"-  "}.lst-kix_sm5qq1cfkkfw-6>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-6,decimal) ". "}ul.lst-kix_bo8ddvgukbmp-1{list-style-type:none}ul.lst-kix_bo8ddvgukbmp-0{list-style-type:none}.lst-kix_jpktq1lpoaqv-1>li:before{content:"-  "}.lst-kix_jpktq1lpoaqv-2>li:before{content:"-  "}.lst-kix_sm5qq1cfkkfw-7>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-7,lower-latin) ". "}.lst-kix_sm5qq1cfkkfw-8>li:before{content:"" counter(lst-ctn-kix_sm5qq1cfkkfw-8,lower-roman) ". "}ol.lst-kix_sm5qq1cfkkfw-6.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-6 0}ul.lst-kix_bo8ddvgukbmp-7{list-style-type:none}ul.lst-kix_bo8ddvgukbmp-6{list-style-type:none}ul.lst-kix_bo8ddvgukbmp-8{list-style-type:none}.lst-kix_jpktq1lpoaqv-0>li:before{content:"-  "}.lst-kix_bo8ddvgukbmp-1>li:before{content:"-  "}.lst-kix_bo8ddvgukbmp-0>li:before{content:"-  "}.lst-kix_bo8ddvgukbmp-3>li:before{content:"-  "}.lst-kix_bo8ddvgukbmp-5>li:before{content:"-  "}ol.lst-kix_sm5qq1cfkkfw-2.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-2 0}.lst-kix_bo8ddvgukbmp-2>li:before{content:"-  "}.lst-kix_bo8ddvgukbmp-6>li:before{content:"-  "}.lst-kix_7z3fcky94f9t-5>li:before{content:"-  "}.lst-kix_bo8ddvgukbmp-4>li:before{content:"-  "}.lst-kix_7z3fcky94f9t-6>li:before{content:"-  "}.lst-kix_7z3fcky94f9t-7>li:before{content:"-  "}.lst-kix_7z3fcky94f9t-8>li:before{content:"-  "}.lst-kix_sm5qq1cfkkfw-3>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-3}ol.lst-kix_sm5qq1cfkkfw-8.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-8 0}.lst-kix_sm5qq1cfkkfw-0>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-0}.lst-kix_sm5qq1cfkkfw-6>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-6}ol.lst-kix_sm5qq1cfkkfw-1.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-1 0}ol.lst-kix_sm5qq1cfkkfw-0{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-4.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-4 0}.lst-kix_sm5qq1cfkkfw-5>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-5}ol.lst-kix_sm5qq1cfkkfw-3{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-4{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-1{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-2{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-7{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-8{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-5{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-6{list-style-type:none}ol.lst-kix_sm5qq1cfkkfw-7.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-7 0}.lst-kix_sm5qq1cfkkfw-4>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-4}.lst-kix_7z3fcky94f9t-4>li:before{content:"-  "}.lst-kix_7z3fcky94f9t-3>li:before{content:"-  "}ul.lst-kix_7z3fcky94f9t-0{list-style-type:none}ul.lst-kix_7z3fcky94f9t-1{list-style-type:none}.lst-kix_7z3fcky94f9t-0>li:before{content:"-  "}.lst-kix_7z3fcky94f9t-2>li:before{content:"-  "}.lst-kix_bo8ddvgukbmp-7>li:before{content:"-  "}ul.lst-kix_7z3fcky94f9t-4{list-style-type:none}ul.lst-kix_7z3fcky94f9t-5{list-style-type:none}ul.lst-kix_7z3fcky94f9t-2{list-style-type:none}.lst-kix_7z3fcky94f9t-1>li:before{content:"-  "}ul.lst-kix_7z3fcky94f9t-3{list-style-type:none}.lst-kix_bo8ddvgukbmp-8>li:before{content:"-  "}ul.lst-kix_7z3fcky94f9t-8{list-style-type:none}ul.lst-kix_7z3fcky94f9t-6{list-style-type:none}ul.lst-kix_7z3fcky94f9t-7{list-style-type:none}.lst-kix_sm5qq1cfkkfw-2>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-2}ul.lst-kix_novl1in5rjiw-2{list-style-type:none}ul.lst-kix_novl1in5rjiw-1{list-style-type:none}ul.lst-kix_novl1in5rjiw-4{list-style-type:none}ul.lst-kix_novl1in5rjiw-3{list-style-type:none}ul.lst-kix_jpktq1lpoaqv-7{list-style-type:none}ul.lst-kix_jpktq1lpoaqv-8{list-style-type:none}ul.lst-kix_novl1in5rjiw-0{list-style-type:none}.lst-kix_sm5qq1cfkkfw-8>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-8}ul.lst-kix_jpktq1lpoaqv-3{list-style-type:none}ul.lst-kix_jpktq1lpoaqv-4{list-style-type:none}.lst-kix_jpktq1lpoaqv-6>li:before{content:"-  "}ul.lst-kix_jpktq1lpoaqv-5{list-style-type:none}ul.lst-kix_jpktq1lpoaqv-6{list-style-type:none}ul.lst-kix_jpktq1lpoaqv-0{list-style-type:none}.lst-kix_jpktq1lpoaqv-7>li:before{content:"-  "}.lst-kix_jpktq1lpoaqv-8>li:before{content:"-  "}ul.lst-kix_jpktq1lpoaqv-1{list-style-type:none}ul.lst-kix_jpktq1lpoaqv-2{list-style-type:none}.lst-kix_sm5qq1cfkkfw-1>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-1}.lst-kix_sm5qq1cfkkfw-7>li{counter-increment:lst-ctn-kix_sm5qq1cfkkfw-7}ol.lst-kix_sm5qq1cfkkfw-5.start{counter-reset:lst-ctn-kix_sm5qq1cfkkfw-5 0}.lst-kix_novl1in5rjiw-8>li:before{content:"-  "}.lst-kix_novl1in5rjiw-3>li:before{content:"-  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_novl1in5rjiw-2>li:before{content:"-  "}ul.lst-kix_novl1in5rjiw-6{list-style-type:none}ul.lst-kix_novl1in5rjiw-5{list-style-type:none}.lst-kix_novl1in5rjiw-4>li:before{content:"-  "}ul.lst-kix_novl1in5rjiw-8{list-style-type:none}ul.lst-kix_novl1in5rjiw-7{list-style-type:none}.lst-kix_novl1in5rjiw-5>li:before{content:"-  "}.lst-kix_novl1in5rjiw-7>li:before{content:"-  "}.lst-kix_novl1in5rjiw-6>li:before{content:"-  "}ol{margin:0;padding:0}table td,table th{padding:0}.ZuooKffPwP-c21{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#e0e0e0;border-top-width:1pt;border-right-width:1pt;border-left-color:#e0e0e0;vertical-align:top;border-right-color:#e0e0e0;border-left-width:1pt;border-top-style:solid;background-color:#fafafa;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#e0e0e0;border-bottom-style:solid}.ZuooKffPwP-c0{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.ZuooKffPwP-c12{padding-top:20pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;text-align:left}.ZuooKffPwP-c3{font-size:10pt;font-family:Consolas,"Courier New";color:#9c27b0;font-weight:400}.ZuooKffPwP-c19{border-spacing:0;border-collapse:collapse;margin-right:auto}.ZuooKffPwP-c4{font-size:10pt;font-family:Consolas,"Courier New";color:#616161;font-weight:400}.ZuooKffPwP-c1{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:left}.ZuooKffPwP-c8{font-size:10pt;font-family:Consolas,"Courier New";color:#3367d6;font-weight:400}.ZuooKffPwP-c18{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:center}.ZuooKffPwP-c25{padding-top:0pt;padding-bottom:10pt;line-height:1.5;text-align:left}.ZuooKffPwP-c7{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.ZuooKffPwP-c10{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.ZuooKffPwP-c15{color:#000000;font-weight:400;font-size:20pt;font-family:"Arial"}.ZuooKffPwP-c5{font-size:10pt;font-family:Consolas,"Courier New";color:#000000;font-weight:400}.ZuooKffPwP-c6{text-decoration:none;vertical-align:baseline;font-style:normal}.ZuooKffPwP-c23{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.ZuooKffPwP-c26{color:#999999;font-weight:400;font-family:"Google Sans"}.ZuooKffPwP-c22{color:#000000;font-size:11pt}.ZuooKffPwP-c9{font-weight:400;font-family:Consolas,"Courier New"}.ZuooKffPwP-c11{margin-left:36pt;padding-left:0pt}.ZuooKffPwP-c2{orphans:2;widows:2}.ZuooKffPwP-c16{font-size:10pt}.ZuooKffPwP-c20{color:#0f9d58}.ZuooKffPwP-c24{color:#c53929}.ZuooKffPwP-c14{height:0pt}.ZuooKffPwP-c13{height:11pt}.ZuooKffPwP-c17{color:#455a64}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c23 doc-content"><div>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p></div>
 <p class="ZuooKffPwP-c25"><span class="ZuooKffPwP-c26">Posted by Ivan Fratric, Google Project Zero</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Recently, one of the projects I was involved in had to do with video decoding on Apple platforms, specifically AV1 decoding. On Apple devices that</span><span>&nbsp;support AV1 video format</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;(starting from Apple A17 iOS / M3 macOS), decoding is done in hardware. However, despite this, during decoding, a large part of the AV1 format parsing happens in software, inside the kernel, more specifically inside the AppleAVD kernel extension (or at least, that used to be the case in macOS 14/ iOS 17). As fuzzing is one of the techniques we employ regularly, the question of how to effectively fuzz this code inevitably came up.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">It should be noted that I wasn&rsquo;t the first person to look into the problem of Apple kernel extension fuzzing, so before going into the details of my approach, other projects in this space should be mentioned.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>In the </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/pwn0rz/fairplay_research&amp;sa=D&amp;source=editors&amp;ust=1732109826665586&amp;usg=AOvVaw2FnTI8T0cVTT1L2JVZrloR">Fairplay research</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;project, @pwn0rz utilized a custom loader to load the kernel extension into userspace. A coworker tried to run this code on the current AppleAVD extension, however it didn&rsquo;t work for them (at least not out of the box) so we didn&rsquo;t end up using it. It should be noted here that my approach also loads the kernel code into userspace, albeit in a more lightweight way.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>In the </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://2022.hexacon.fr/slides/hexacon2022_AppleAVD.pdf&amp;sa=D&amp;source=editors&amp;ust=1732109826665829&amp;usg=AOvVaw37MzWB_X_wWGPblQWVVSgA">Cinema time!</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;presentation at Hexacon 2022, Andrey Labunets and Nikita Tarakanov presented their approach for fuzzing AppleAVD where the decompiled code was first extracted using IDA and then rebuilt. I used this approach in the past in some more constrained scenarios, however the decompiled code from IDA is not perfect and manual fixing was often required (such as, for example, when IDA would get the stack layout of a function incorrectly).</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>In the </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://www.usenix.org/conference/usenixsecurity23/presentation/yin&amp;sa=D&amp;source=editors&amp;ust=1732109826666172&amp;usg=AOvVaw01DJ5e3AtzVICfDMFA--b9">KextFuzz</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;project, Tingting Yin with the co-authors statically instrumented kernel extensions by replacing pointer authentication instructions with a jump to a coverage-collecting trampoline, which results in a partial coverage.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Most recently, the </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://r00tkitsmm.github.io/fuzzing/2024/11/08/Pishi.html&amp;sa=D&amp;source=editors&amp;ust=1732109826666444&amp;usg=AOvVaw3AlBWiaSYgHpY_zWen8REB">Pishi</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;project by Meysam Firouzi was released just before this research. The project statically instruments kernel extension code by using Ghidra to identify all basic blocks, and then replacing one instruction from each basic block with a branch to a dedicated trampoline. The trampoline records the coverage, executes the replaced instruction and jumps back to the address of the next instruction. This was reported to run on a real device.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Given the existence of these other projects, it is worth saying that my goal was not to create necessarily the &ldquo;best&rdquo; method for kernel extension fuzzing, but what for me was the simplest (if we don&rsquo;t count the underlying complexity of the off-the shelf tools being used). In short, my approach, that will be discussed in detail in other sections, was</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><ol class="lst-kix_sm5qq1cfkkfw-0 start" start="1"><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Load AppleAVD extension or full kernelcache into IDA</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c6 ZuooKffPwP-c7">Rebase the module to an address that can be reliably allocated in userspace</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Export raw memory using an IDA Python script</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Load exported bytes using custom loader</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span>Use custom </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/TinyInst&amp;sa=D&amp;source=editors&amp;ust=1732109826667480&amp;usg=AOvVaw2o31c8GLJoKLv7nsymgTWI">TinyInst</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;module to hook and instrument the extension</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span>Use </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/Jackalope&amp;sa=D&amp;source=editors&amp;ust=1732109826667687&amp;usg=AOvVaw0RtwSfpDaMMyf56zmPPGGc">Jackalope</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;for fuzzing</span></li></ol>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>All the project code can be found </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/tree/master/SimpleKextFuzzing&amp;sa=D&amp;source=editors&amp;ust=1732109826667926&amp;usg=AOvVaw0hlvs1WHxSpAssYFPacajC">here</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">. Various components will be explained in more detail throughout the rest of the blog post.</span></p><h1 class="ZuooKffPwP-c12 ZuooKffPwP-c2" id="h.rluen9gr1cv0"><span class="ZuooKffPwP-c15 ZuooKffPwP-c6">Extracting kernel extension code</span></h1>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Normally, on macOS, kernel extensions are packaged inside &ldquo;kernel collections&rdquo; files that serve as containers for multiple extensions. At first OS boot (and whenever something is changed with regards to kernel extensions), the kernel extensions needed by the machine are repackaged into what is called the &ldquo;kernel cache&rdquo; (</span><span class="ZuooKffPwP-c9">kernelcache</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;file on the filesystem). Kernel extensions can be extracted from these caches and collections, but existing tooling can&rsquo;t really produce individual .dylib files that can be loaded into userspace and run without issues.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">However, reverse engineering tooling, specifically IDA Pro which I used in this research, comes with a surprisingly good loader for Apple kernel cache. I haven&rsquo;t tried how other reverse engineering tools compare, but if they are comparable and someone would like to contribute to the project, I would gladly accept export scripts for these other tools.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">So, instead of writing our own loader, we can simply piggyback on IDA&rsquo;s. The idea is simple:</span></p><ul style="padding: 0;" class="lst-kix_jpktq1lpoaqv-0 start"><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">we let IDA load the kernel extension we want (or even the entire kernelcache)</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">we use IDA to rebase the code so it&rsquo;s in memory range that is mappable in userspace (see image)</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">using a simple IDA Python script, we export for each memory segment its start address, end address, protection flags and raw bytes</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">optionally, we can also, using the same script, export all the symbol names and the corresponding addresses so we can later refer to symbols by name</span></li></ul>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>The following image shows rebasing of the kernel extension. This functionality is accessible in IDA via </span><span class="ZuooKffPwP-c9">Edit-&gt;Segments-&gt;Rebase program&hellip;</span><span>&nbsp;menu. When choosing the new base address, it is convenient to only change the high bits which makes it easy to manually convert rebased to original addresses and vice versa when needed. In the example below the image base was changed from </span><span class="ZuooKffPwP-c9">0xFFFFFE000714C470</span><span>&nbsp;to &nbsp;</span><span class="ZuooKffPwP-c9">0xAB0714C470</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c18 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/s435/image1.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="screenshot with image base selected, with the value set at &#160;0xAB0714C470, with both the fix up the program and rebase the whole image options selected" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/s435/image1.png" style="max-height: 750px; max-width: 600px;" title="screenshot with image base selected, with the value set at &#160;0xAB0714C470, with both the fix up the program and rebase the whole image options selected" /></a></span></p>
 <p class="ZuooKffPwP-c2 ZuooKffPwP-c18"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Figure 1: Rebasing the extension</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>The IDA script for exporting the data can be found </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/blob/master/SimpleKextFuzzing/segexport.py&amp;sa=D&amp;source=editors&amp;ust=1732109826669199&amp;usg=AOvVaw0cWfCbkZ7rLjG453N5Q3gz">here</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">. You can run it using the following commands in IDA:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c6 ZuooKffPwP-c9 ZuooKffPwP-c22">sys.path.append(&#39;/directory/containing/export/script&#39;)</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c6 ZuooKffPwP-c22 ZuooKffPwP-c9">import segexport</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c9">segexport.export(&#39;/path/to/output/file)</span></p><h1 class="ZuooKffPwP-c12 ZuooKffPwP-c2" id="h.yqrcdza0wn2x"><span class="ZuooKffPwP-c15 ZuooKffPwP-c6">Loading and running</span></h1>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Loading the exported data should now be only the matter of memory mapping the correct addresses and copying the corresponding data from the exported file. You can see it in the </span><span class="ZuooKffPwP-c9">load()</span><span>&nbsp;function </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/blob/master/SimpleKextFuzzing/loader.cpp&amp;sa=D&amp;source=editors&amp;ust=1732109826669715&amp;usg=AOvVaw2IxnL8sy18E8TM5QjjM-Jf">here</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>However, since we are now loading and running kernel code in userspace, there will be functions that won&rsquo;t run well or that we would want to change. One example for this are the kernel allocator functions that we&rsquo;ll want to replace with the system </span><span class="ZuooKffPwP-c9">malloc</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>One way of replacing these functions would be to rewrite the prolog of each function we want to replace with a jump to its replacement. However, since we will later be using </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/TinyInst&amp;sa=D&amp;source=editors&amp;ust=1732109826670108&amp;usg=AOvVaw0mV2gyAw6aW4pwSOPW8YVh">TinyInst</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;to extract code coverage, there is a simpler way. We will simply write a breakpoint instruction to each function we want to replace. Since TinyInst is (among other things) a debugger, it will catch each of these breakpoints and, from the TinyInst process, we can replace the instruction pointer with the address of the corresponding replacement function. More details on this can be found in the next section.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Besides replacing the memory allocation functions, logging functions etc., we will also need to replace all functions that interact with the hardware that we can&rsquo;t access from userspace (or, in our case, that isn&rsquo;t even present on the machine). In the case of AV1 parsing code in the AppleAVD kernel extension, a function called </span><span class="ZuooKffPwP-c9">AppleAVD::sendCommandToCommandGate</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;gets called, which I assume is meant to communicate with the decoding hardware. Thus, as a part of the harness, this function was replaced with a function that always returns 0 (success).</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>The final code of the AV1 harness code can be found </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/blob/master/SimpleKextFuzzing/avdharness.cpp&amp;sa=D&amp;source=editors&amp;ust=1732109826670612&amp;usg=AOvVaw1k3F3h5n4vGZnj1aaOcSN7">here</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">. It can be compiled as</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c6 ZuooKffPwP-c22 ZuooKffPwP-c9">clang++ loader.cpp avdharness.cpp -oloader</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">and might need some additional entitlements to run which can be applied with</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c6 ZuooKffPwP-c22 ZuooKffPwP-c9">codesign --entitlements entitlements.txt -f -s - ./loader</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Note that, in the harness code, although I tried to rely on symbol names instead of hardcoded offsets wherever possible, it still contains some struct offsets. This version of the harness was based </span><span>on</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;macos 14.5 kernel, which was the most recent OS version at the time the loader was written.</span></p><h1 class="ZuooKffPwP-c2 ZuooKffPwP-c12" id="h.xs1vsufmus3l"><span class="ZuooKffPwP-c6 ZuooKffPwP-c15">Writing a custom TinyInst module</span></h1>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">This section explains the custom TinyInst module that accompanies the loader (and is required for the correct functioning of the loader). This code doesn&rsquo;t contain anything specific for a particular kernel extension and thus can be reused as is. If you are not interested in how it works or writing custom TinyInst modules, then you can skip this section.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Firstly, since we will want to extract code coverage for the purposes of fuzzing, we will base our custom module on </span><span class="ZuooKffPwP-c9">LiteCov</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">, the &ldquo;default&rdquo; TinyInst module for code coverage:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><table class="ZuooKffPwP-c19"><tr class="ZuooKffPwP-c14"><td class="ZuooKffPwP-c21" colspan="1" rowspan="1">
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c3">class</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">AVDInst</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">:</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">public</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">LiteCov</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">&hellip;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4">};</span></p></td></tr></table>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Secondly, we need a way for our custom loader to communicate with the TinyInst module</span></p><ul style="padding: 0;" class="lst-kix_novl1in5rjiw-0 start"><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">It needs to tell TinyInst which functions in the kext should be replaced with which replacement functions.</span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">It needs to tell TinyInst where the kext was loaded so that TinyInst can instrument it.</span></li></ul>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>While TinyInst provides an </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/TinyInst/blob/master/hook.md&amp;sa=D&amp;source=editors&amp;ust=1732109826673105&amp;usg=AOvVaw06jbkjNAOsFhc9kx237_vN">API for function hooking</a></span><span>&nbsp;that we could use here, there is also a more direct (albeit, also more low-level) way. From our loader, we will simply call a function at some hardcoded non-mapped address. This will, once again, cause an exception that TinyInst (being a debugger) will catch, read the parameters from registers, do the required action and &ldquo;return&rdquo; (by replacing the instruction pointer with the value inside the link register). The loader uses the hardcoded address </span><span class="ZuooKffPwP-c9">0x747265706C616365</span><span>&nbsp;to register a replacement and </span><span class="ZuooKffPwP-c9">0x747265706C616366</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;to tell TinyInst about the address range to instrument:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><table class="ZuooKffPwP-c19"><tr class="ZuooKffPwP-c14"><td class="ZuooKffPwP-c21" colspan="1" rowspan="1">
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c17">#define</span><span class="ZuooKffPwP-c5">&nbsp;TINYINST_REGISTER_REPLACEMENT </span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c24">0x747265706C616365</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c17">#define</span><span class="ZuooKffPwP-c5">&nbsp;TINYINST_CUSTOM_INSTRUMENT </span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c24">0x747265706C616366</span></p></td></tr></table>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">We can catch those in the exception handler of our custom module</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><table class="ZuooKffPwP-c19"><tr class="ZuooKffPwP-c14"><td class="ZuooKffPwP-c21" colspan="1" rowspan="1">
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c3">bool</span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16">&nbsp;</span><span class="ZuooKffPwP-c8">AVDInst</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">OnException</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c8">Exception</span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16">&nbsp;</span><span class="ZuooKffPwP-c4">*</span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16">exception_record</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6">&nbsp; &hellip;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_address </span><span class="ZuooKffPwP-c4">==</span><span class="ZuooKffPwP-c5">&nbsp;TINYINST_REGISTER_REPLACEMENT</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">RegisterReplacementHook</span><span class="ZuooKffPwP-c4">();</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">true</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_address </span><span class="ZuooKffPwP-c4">==</span><span class="ZuooKffPwP-c5">&nbsp;TINYINST_CUSTOM_INSTRUMENT</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">InstrumentCustomRange</span><span class="ZuooKffPwP-c4">();</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">true</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4 ZuooKffPwP-c6">}</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4 ZuooKffPwP-c6">&nbsp; &hellip;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4 ZuooKffPwP-c6">}</span></p></td></tr></table>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">and then read the parameters and do the required action</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><table class="ZuooKffPwP-c19"><tr class="ZuooKffPwP-c14"><td class="ZuooKffPwP-c21" colspan="1" rowspan="1">
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c3">void</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">AVDInst</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">RegisterReplacementHook</span><span class="ZuooKffPwP-c4">()</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; uint64_t original_address </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">GetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">X0</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; uint64_t replacement_address </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">GetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">X1</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; redirects</span><span class="ZuooKffPwP-c4">[</span><span class="ZuooKffPwP-c5">original_address</span><span class="ZuooKffPwP-c4">]</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;replacement_address</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c8">SetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">ARCH_PC</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">GetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">LR</span><span class="ZuooKffPwP-c4">));</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c3">void</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">AVDInst</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">InstrumentCustomRange</span><span class="ZuooKffPwP-c4">()</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; uint64_t min_address </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">GetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">X0</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; uint64_t max_address </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">GetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">X1</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c8">InstrumentAddressRange</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c20">&quot;__custom_range__&quot;</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;min_address</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;max_address</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c8">SetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">ARCH_PC</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">GetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">LR</span><span class="ZuooKffPwP-c4">));</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4">}</span></p></td></tr></table>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Where </span><span class="ZuooKffPwP-c9">InstrumentAddressRange</span><span>&nbsp;is a recently added TinyInst function that will instrument all code between addresses given in its parameters. &ldquo;</span><span class="ZuooKffPwP-c9">__custom_range__</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&rdquo; is simply a name that we give to this region of memory so we can differentiate between multiple instrumented modules (if there are more than one).</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Next, TinInst needs to perform the actual function replacements. As explained above, this can be done in the exception handler of our module.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><table class="ZuooKffPwP-c19"><tr class="ZuooKffPwP-c14"><td class="ZuooKffPwP-c21" colspan="1" rowspan="1">
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">auto</span><span class="ZuooKffPwP-c5">&nbsp;iter </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c5">find</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_address</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">iter </span><span class="ZuooKffPwP-c4">!=</span><span class="ZuooKffPwP-c5">&nbsp;redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c3">end</span><span class="ZuooKffPwP-c4">())</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c17">// printf(&quot;Redirecting...\n&quot;);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">SetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">ARCH_PC</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;iter</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">second</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">true</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p></td></tr></table>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">This is mostly sufficient for running the kernel extension without instrumenting it (e.g. to collect coverage). However, if we also want to instrument the extension, then the process of instrumentation involves rewriting the extension code in another location and inserting e.g. additional instructions to record coverage. The consequence of this is that our breakpoint instructions (that we inserted for the purpose of redirects) will be rewritten at different addresses. We need to make TinyInst aware of this (as a side note, TinyInst Hook API does this under the hood, but it wasn&rsquo;t used in this module). We can do this in the InstrumentInstruction function which gets called for every instruction as it&rsquo;s being instrumented:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><table class="ZuooKffPwP-c19"><tr class="ZuooKffPwP-c14"><td class="ZuooKffPwP-c21" colspan="1" rowspan="1">
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c8">InstructionResult</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">AVDInst</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">InstrumentInstruction</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c8">ModuleInfo</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">*</span><span class="ZuooKffPwP-c3">module</span><span class="ZuooKffPwP-c4">,</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">Instruction</span><span class="ZuooKffPwP-c4">&amp;</span><span class="ZuooKffPwP-c5">&nbsp;inst</span><span class="ZuooKffPwP-c4">,</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size_t bb_address</span><span class="ZuooKffPwP-c4">,</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size_t instruction_address</span><span class="ZuooKffPwP-c4">)</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">auto</span><span class="ZuooKffPwP-c5">&nbsp;iter </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c5">find</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">instruction_address</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">iter </span><span class="ZuooKffPwP-c4">!=</span><span class="ZuooKffPwP-c5">&nbsp;redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c3">end</span><span class="ZuooKffPwP-c4">())</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; instrumented_redirects</span><span class="ZuooKffPwP-c4">[</span><span class="ZuooKffPwP-c5">assembler_</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c8">Breakpoint</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c3">module</span><span class="ZuooKffPwP-c4">)]</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;iter</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">second</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;INST_STOPBB</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">LiteCov</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">InstrumentInstruction</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c3">module</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;inst</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;bb_address</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;instruction_address</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4">}</span></p></td></tr></table>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>The </span><span class="ZuooKffPwP-c9">INST_STOPBB</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;return value tells TinyInst to stop processing the current basic blocks. Since on breakpoints/redirects, we redirect the execution to another function, no other instructions from the same basic block ever get executed and are thus unneeded.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">After this, we now know the addresses of breakpoints (and the corresponding replacements) in both instrumented and non-instrumented code. The final exception handler of our custom module looks like this:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><table class="ZuooKffPwP-c19"><tr class="ZuooKffPwP-c14"><td class="ZuooKffPwP-c21" colspan="1" rowspan="1">
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c3">bool</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">AVDInst</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">OnException</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c8">Exception</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">*</span><span class="ZuooKffPwP-c5">exception_record</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; size_t exception_address</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_record</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">type </span><span class="ZuooKffPwP-c4">==</span><span class="ZuooKffPwP-c5">&nbsp;BREAKPOINT</span><span class="ZuooKffPwP-c4">)</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; exception_address </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">size_t</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">exception_record</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">ip</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">else</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_record</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">type </span><span class="ZuooKffPwP-c4">==</span><span class="ZuooKffPwP-c5">&nbsp;ACCESS_VIOLATION</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; exception_address </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">size_t</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">exception_record</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">access_address</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">else</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">LiteCov</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">OnException</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_record</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_address </span><span class="ZuooKffPwP-c4">==</span><span class="ZuooKffPwP-c5">&nbsp;TINYINST_REGISTER_REPLACEMENT</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">RegisterReplacementHook</span><span class="ZuooKffPwP-c4">();</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">true</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_address </span><span class="ZuooKffPwP-c4">==</span><span class="ZuooKffPwP-c5">&nbsp;TINYINST_CUSTOM_INSTRUMENT</span><span class="ZuooKffPwP-c4">)</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">InstrumentCustomRange</span><span class="ZuooKffPwP-c4">();</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">true</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">auto</span><span class="ZuooKffPwP-c5">&nbsp;iter </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c5">find</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_address</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">iter </span><span class="ZuooKffPwP-c4">!=</span><span class="ZuooKffPwP-c5">&nbsp;redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c3">end</span><span class="ZuooKffPwP-c4">())</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c17">// printf(&quot;Redirecting...\n&quot;);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">SetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">ARCH_PC</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;iter</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">second</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">true</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; iter </span><span class="ZuooKffPwP-c4">=</span><span class="ZuooKffPwP-c5">&nbsp;instrumented_redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c5">find</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_address</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">if</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">iter </span><span class="ZuooKffPwP-c4">!=</span><span class="ZuooKffPwP-c5">&nbsp;instrumented_redirects</span><span class="ZuooKffPwP-c4">.</span><span class="ZuooKffPwP-c3">end</span><span class="ZuooKffPwP-c4">())</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c4">{</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c9 ZuooKffPwP-c16 ZuooKffPwP-c17">// printf(&quot;Redirecting...\n&quot;);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c8">SetRegister</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">ARCH_PC</span><span class="ZuooKffPwP-c4">,</span><span class="ZuooKffPwP-c5">&nbsp;iter</span><span class="ZuooKffPwP-c4">-&gt;</span><span class="ZuooKffPwP-c5">second</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; &nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c3">true</span><span class="ZuooKffPwP-c4">;</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c4">}</span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c13"><span class="ZuooKffPwP-c5 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c5">&nbsp; </span><span class="ZuooKffPwP-c3">return</span><span class="ZuooKffPwP-c5">&nbsp;</span><span class="ZuooKffPwP-c8">LiteCov</span><span class="ZuooKffPwP-c4">::</span><span class="ZuooKffPwP-c8">OnException</span><span class="ZuooKffPwP-c4">(</span><span class="ZuooKffPwP-c5">exception_record</span><span class="ZuooKffPwP-c4">);</span></p>
 <p class="ZuooKffPwP-c1"><span class="ZuooKffPwP-c4">}</span></p></td></tr></table>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>The entire code, with all the housekeeping functions can be found </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/blob/master/SimpleKextFuzzing/avdinst.cpp&amp;sa=D&amp;source=editors&amp;ust=1732109826694386&amp;usg=AOvVaw3nQkwr4RgPNyoXfRsmw4SP">here</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">.</span></p><h1 class="ZuooKffPwP-c12 ZuooKffPwP-c2" id="h.azr1bjcealy5"><span class="ZuooKffPwP-c15 ZuooKffPwP-c6">Fuzzing and findings</span></h1>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Once our custom module is ready, we still need to make sure TinyInst and Jackalope will use this module instead of the default LiteCov module. See the appropriate patches for </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/blob/master/SimpleKextFuzzing/tinyinst.patch&amp;sa=D&amp;source=editors&amp;ust=1732109826694818&amp;usg=AOvVaw1vnL-WM-dDQ2vTfsTJAyyH">Tiny</a></span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/blob/master/SimpleKextFuzzing/tinyinst.patch&amp;sa=D&amp;source=editors&amp;ust=1732109826695002&amp;usg=AOvVaw07wdAMSgKNenNNPEF0lsTb">Inst</a></span><span>&nbsp;and </span><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://github.com/googleprojectzero/p0tools/blob/master/SimpleKextFuzzing/jackalope.patch&amp;sa=D&amp;source=editors&amp;ust=1732109826695133&amp;usg=AOvVaw3xehwqsGUse3-9ZGnakcqt">Jackalope</a></span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Our harness should now run correctly under TinyInst, both without and with coverage instrumentation:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c6 ZuooKffPwP-c22 ZuooKffPwP-c9">./Jackalope/build/TinyInst/Release/litecov -- ./loader avd_rebased.dat -f &lt;sample&gt;</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>Where </span><span class="ZuooKffPwP-c9">avd_rebased.dat</span><span>&nbsp;contains the kernel extension code exported from IDA. We can also add the </span><span class="ZuooKffPwP-c9">-trace_basic_blocks</span><span>&nbsp;flag to trace basic blocks as they are being executed (primarily useful for debugging). </span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">We can also run a fuzzing session with Jackalope like this:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c6 ZuooKffPwP-c22 ZuooKffPwP-c9">./Jackalope/build/Release/fuzzer -in in -out out -t 1000 -delivery shmem -target_module loader -target_method __Z4fuzzPc -nargs 1 -iterations 5000 -persist -loop -cmp_coverage -mute_child -nthreads 6 -- ./loader avd_rebased.dat -m @@</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>This tells jackalope to run in persistent mode (with the function &ldquo;</span><span class="ZuooKffPwP-c9">fuzz</span><span>&rdquo; being looped), with sample delivery over shared memory (</span><span class="ZuooKffPwP-c9">-delivery shmem</span><span>&nbsp;fuzzer flag and </span><span class="ZuooKffPwP-c9">-m</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;being implemented in the harness code).</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Fuzzing is useful not only for finding bugs in the target, but in our case also for finding bugs in the harness, e.g. finding other kernel functions we need to replace in order for the target to work correctly.</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">After several iterations of fixups, the harness appeared to be working correctly. However, the fuzzer also caught some crashes that appeared to have been caused by genuine issues in the AV1 parsing code. I did a root cause analysis and reported the issues to Apple. The reports can be seen in the following entries in the Project Zero issue tracker:</span></p>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p><ul style="padding: 0;" class="lst-kix_bo8ddvgukbmp-0 start"><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://project-zero.g-issues.chromium.org/issues/42451721&amp;sa=D&amp;source=editors&amp;ust=1732109826696413&amp;usg=AOvVaw2NljgQdohbwV1c7nIOKCTa">AppleAVD: Large OBU size in AV1_Syntax::Parse_Header reading to out-of-bounds reads</a></span></li><li style="margin-left: 46pt;" class="c1 c2 c11 li-bullet-0"><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://project-zero.g-issues.chromium.org/issues/42451722&amp;sa=D&amp;source=editors&amp;ust=1732109826696608&amp;usg=AOvVaw2eL2V0P7hZXEYwkpVmNk3a">AppleAVD: Issue with AV1_Syntax::f leading to out-of-bounds reads</a></span></li><li style="margin-left: 46pt;" class="c1 c11 c2 li-bullet-0"><span class="ZuooKffPwP-c10"><a href="https://www.google.com/url?q=https://project-zero.g-issues.chromium.org/issues/42451723&amp;sa=D&amp;source=editors&amp;ust=1732109826696759&amp;usg=AOvVaw19QYmlPbmxhIX22wHare1T">AppleAVD: Integer underflow in AV1_Syntax::Parse_Header leading to out-of-bounds reads</a></span></li></ul>
 <p class="ZuooKffPwP-c0"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6"></span></p>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">Unfortunately, at the time of reporting these issues I still didn&rsquo;t have access to a machine with AV1 decoding capabilities. Thus, instead of full end-to-end PoCs, the issues were reported in the form of a full root cause analysis and a binary stream that causes a crash when used as a parameter to a particular decoding function. Eventually, we did get a Macbook with a M3 chip that supports AV1 hardware decoding and tried to reproduce the reported issues. Unsurprisingly, all three issues reproduced exactly the same on the real hardware as in the userspace harness.</span></p><h1 class="ZuooKffPwP-c12 ZuooKffPwP-c2" id="h.l6zg20vmakwt"><span class="ZuooKffPwP-c15 ZuooKffPwP-c6">Conclusion</span></h1>
 <p class="ZuooKffPwP-c1 ZuooKffPwP-c2"><span>The goal of this project was to create </span><span>userspace kernel extension fuzzing tooling</span><span class="ZuooKffPwP-c7 ZuooKffPwP-c6">&nbsp;that was as simple as possible, and at least one of the reasons for this simplicity was that it could be easily adapted to other pieces of kernel code. The process is versatile enough that it allowed us to fuzz AV1 parsing code that normally requires hardware we didn&rsquo;t even have at the time. While the three issues found during this research are not critical, they demonstrate the correctness of the approach and the potential for finding other issues.</span></p>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/08975904405228580347' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/08975904405228580347' rel='author' title='author profile'>
<span itemprop='name'>Google Project Zero</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html' itemprop='url'/>
<a class='timestamp-link' href='https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2024-11-21T09:53:00-08:00'>9:53&#8239;AM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1053444070'>
<a href='https://www.blogger.com/post-edit.g?blogID=4838136820032157985&postID=7116102695364781863&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=7116102695364781863&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=7116102695364781863&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=7116102695364781863&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=7116102695364781863&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=7116102695364781863&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/4838136820032157985?po=7116102695364781863&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2315299244-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/java                   '>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://googleprojectzero.blogspot.com/2024/10/from-naptime-to-big-sleep.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://googleprojectzero.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://googleprojectzero.blogspot.com/feeds/7116102695364781863/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search This Blog</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://googleprojectzero.blogspot.com/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://googleprojectzero.blogspot.com/p/about-project-zero.html'>About Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/working-at-project-zero.html'>Working at Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/0day.html'>0day "In the Wild"</a>
</li>
<li>
<a href='https://googleprojectzero.github.io/0days-in-the-wild/rca.html'>0day Exploit Root Cause Analyses</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html'>Vulnerability Disclosure FAQ</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Archives</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/'>
2024
</a>
<span class='post-count' dir='ltr'>(9)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='posts'>
<li><a href='https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html'>Simple macOS kernel extension fuzzing in userspace...</a></li>
<li><a href='https://googleprojectzero.blogspot.com/2024/10/from-naptime-to-big-sleep.html'>From Naptime to Big Sleep: Using Large Language Mo...</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/'>
2023
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/08/'>
August
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/'>
2022
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/11/'>
November
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/'>
2021
</a>
<span class='post-count' dir='ltr'>(24)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/01/'>
January
</a>
<span class='post-count' dir='ltr'>(10)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/'>
2020
</a>
<span class='post-count' dir='ltr'>(36)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/08/'>
August
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/07/'>
July
</a>
<span class='post-count' dir='ltr'>(8)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/06/'>
June
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/02/'>
February
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/01/'>
January
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(27)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/08/'>
August
</a>
<span class='post-count' dir='ltr'>(11)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/'>
2018
</a>
<span class='post-count' dir='ltr'>(22)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/12/'>
December
</a>
<span class='post-count' dir='ltr'>(7)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/10/'>
October
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/08/'>
August
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(19)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/03/'>
March
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(33)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/08/'>
August
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/07/'>
July
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/06/'>
June
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/02/'>
February
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/07/'>
July
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script type='text/javascript'>
//<![CDATA[
(function(){
  let archive_list = document.getElementById('ArchiveList');
  if (archive_list == null) return;
  let cur_year = archive_list.querySelector('.post-count-link').innerText.trim() - 0;
  let last_year = 2014;
  let elements = [];
  const MONTHS = ',Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'.split(',');

  let parent = document.getElementById('ArchiveList');
  while (parent.childNodes.length) parent.removeChild(parent.childNodes[0]);

  function fetch_next_year() {
    let url = 'https://googleprojectzero.blogspot.com/?action=getTitles&widgetId=BlogArchive1&widgetType=BlogArchive&responseType=js&path=https%3A%2F%2Fgoogleprojectzero.blogspot.com%2F'+cur_year;
    fetch(url).then(resp => {
      if (!resp.ok) {
        console.log('http error');
        return;
      }
      resp.text().then(text => {
        let scope = {
          _WidgetManager: {
            _HandleControllerResult: (name, method, results) => {
              elements.push(document.createElement('hr'));
              let year_header = document.createElement('div');
              year_header.appendChild(document.createTextNode(cur_year));
              year_header.style.fontSize = 'large';
              elements.push(year_header);

              let list = document.createElement('ul');
              elements.push(list);

              for (let obj of results.posts) {
                let link_parts = obj.url.split('/');
                let year = link_parts[3];
                let month = link_parts[4];

                let el = document.createElement(/*'div'*/'li');
                el.style.listStyleType = 'square';
                el.style.listStylePosition = 'inside';
                let link = document.createElement('a');
                el.appendChild(link);
                link.appendChild(document.createTextNode(obj.title));
                link.href = obj.url;
                let date_trailer = document.createElement('span');
                el.appendChild(date_trailer);
                //date_trailer.appendChild(document.createTextNode(' ('+year+'-'+month+')'));
                date_trailer.appendChild(document.createTextNode(' ('+MONTHS[parseInt(month, 10)]+')'));
                //date_trailer.style.textAlign = 'right';
                //elements.push(el);
                list.appendChild(el);
              }
            }
          }
        };
        with (scope) { eval(text); }
        if (cur_year == last_year) {
          finish();
        } else {
          cur_year--;
          fetch_next_year();
        }
      });
    });
  }
  fetch_next_year();
  function finish() {
    for (let obj of elements) {
      parent.appendChild(obj);
    }
    console.log(elements);
  }
})();
//]]>
</script>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-1'></div>
</td>
<td class='columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar no-items section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/984859869-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY7kKfsofHsJ1OjAVFMJDFZfWdWuNw:1732407975902';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d4838136820032157985','//googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html','4838136820032157985');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4838136820032157985', 'title': 'Project Zero', 'url': 'https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html', 'canonicalUrl': 'https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html', 'homepageUrl': 'https://googleprojectzero.blogspot.com/', 'searchUrl': 'https://googleprojectzero.blogspot.com/search', 'canonicalHomepageUrl': 'https://googleprojectzero.blogspot.com/', 'blogspotFaviconUrl': 'https://googleprojectzero.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-240546891-1', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Project Zero - RSS\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/4838136820032157985/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/7116102695364781863/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/d78375fb222d99b3', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '7116102695364781863', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/s72-c/image1.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/s435/image1.png', 'pageName': 'Simple macOS kernel extension fuzzing in userspace with IDA and TinyInst', 'pageTitle': 'Project Zero: Simple macOS kernel extension fuzzing in userspace with IDA and TinyInst'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Simple macOS kernel extension fuzzing in userspace with IDA and TinyInst', 'description': '    Posted by Ivan Fratric, Google Project Zero   Recently, one of the projects I was involved in had to do with video decoding on Apple pla...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDdHVy0QXxYeSOzvh7t0mKsZgntTGvhyeLPNjtk-wjAqE80-xx8M6r9I3soy_EdWgj9XmrRcyMPcw0JqLSroCcTbw0sc8HR1tHFxSjhURZdCV4ikn6z_ZGMwQLXkOoe1wsCw-3jK9qow5mxzXOUtSczh4uN2gd07_1BqjiKJ0vgLFXnYzXpPU1xeEkx5k/s435/image1.png', 'url': 'https://googleprojectzero.blogspot.com/2024/11/simple-macos-kernel-extension-fuzzing.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 7116102695364781863}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2646514562-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/about-project-zero.html', 'id': '4384467920505278144', 'title': 'About Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/working-at-project-zero.html', 'id': '2459334498880008057', 'title': 'Working at Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/0day.html', 'id': '3414239791814532209', 'title': '0day \x22In the Wild\x22'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.github.io/0days-in-the-wild/rca.html', 'title': '0day Exploit Root Cause Analyses'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html', 'id': '2935252455704572784', 'title': 'Vulnerability Disclosure FAQ'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>