<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit"/>
<meta name="force-rendering" content="webkit"/>
<meta name="referrer" content="always" />
<meta name="description" content="安全KER - 安全资讯平台" />
<link rel="icon" href="https://s3.ssl.qhres2.com/static/02b5158bbb6adeac.ico" type="image/x-icon" />
<link rel="shortcut icon" href="https://s3.ssl.qhres2.com/static/02b5158bbb6adeac.ico" type="image/x-icon" />
<meta name="keywords"
    content="安全媒体,安全资讯,安全知识, 安全热点,安全招聘,安全趋势,移动安全,网站安全,终端安全,无线安全,工控安全,物联网安全,WEB安全,系统安全,网络安全,区块链安全,安全活动,信息安全,安全预警,安全会议" />

  <title>Lazarus 针对安全研究人员的攻击事件分析-安全KER - 安全资讯平台</title>
  <meta name="description" content="安全KER - 安全资讯平台" />
  <meta name="keywords"
    content="安全媒体,安全资讯,安全知识, 安全热点,安全招聘,安全趋势,移动安全,网站安全,终端安全,无线安全,工控安全,物联网安全,WEB安全,系统安全,网络安全,区块链安全,安全活动,信息安全,安全预警,安全会议" />
  <script>(function(window){
        

function empty() {}

empty();
      })(this);</script>

<link rel="stylesheet" href="https://s1.ssl.qhimg.com/static/d4cec9cd8efbfd10.css">
<link rel="stylesheet" href="https://s1.ssl.qhimg.com/static/a51843d6b82241be,d94674bd62441768,56ce5cef8079a575,e98ec238ee2ffb39,4802c0c382205144,1b5a1fb730023ac8,837278d6b5419b90,c7765696eed0082a,f1af72694eaaa012,683a3fb8c1059410,49838656db94d1e8,ba6e842bd2d94f68,a929f1bafe3273eb,9af1a80d0fb89e1c,d862a00f51adc0b3,409c729e71612781,86af6fd9b93edda6,4259dd4f2283e279,7c59ccb9d3cd9415,c60211756006c43c,8f60519783ce29e3,0dcf6db729973e3e,5f39838e3d3adabf,3f8755b1df1963af,9cb495849e780c9d,f6c764a295c746ab,ebf4b8e2a4618051,1c9f8ac823a5b02a,8101669cb8389279,810b29c6ecc6ef26,7a9446af61fe322b.css">
<script>window._dynamic_deps_={}</script>
</head>

<body>
  <div id='app'><!--[--><div class="_10" style="height:60px;"><div class="g-w"><a class="logo" href="/"></a><div class="_11"><!--[--><div class="item"><div style="cursor:pointer;"><span>首页</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style=""><span>阅读</span><ul><!--[--><li class="sub-item"><a href=" https://www.anquanke.com/news">安全资讯</a></li><li class="sub-item"><a href="https://www.anquanke.com/knowledge">安全知识</a></li><li class="sub-item"><a href="https://www.anquanke.com/tool">安全工具</a></li><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>活动</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>社区</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>学院</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>安全导航</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>内容精选</span><ul><!--[--><li class="sub-item"><a href="/column/index.html">专栏</a></li><li class="sub-item"><a href="https://www.anquanke.com/subject-list">精选专题</a></li><li class="sub-item"><a href="https://www.anquanke.com/discovery">安全KER季刊</a></li><li class="sub-item"><a href="https://www.anquanke.com/week-list">360网络安全周报</a></li><!--]--></ul></div></div><!--]--></div><!----></div></div><div class="index"><div class="index-main"><div class="_45"><h1>Lazarus 针对安全研究人员的攻击事件分析</h1><div class="read"><p><span class="read-text">阅读量</span><b class="read-num">388418</b></p><!----><!----></div><p class="publish">发布时间 : 2021-01-30 10:00:37</p><div class="_44" style="display:none;"><b class="close">x</b><h5>译文声明</h5><p> 本文是翻译文章<!----><!----></p><!----><p>译文仅供参考，具体内容表达以及含义原文为准。</p></div><div class="content" id="js-article"><html>
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head>
<body>
<p><img class="alignnone size-full wp-image-230205 aligncenter" alt="" width="720" height="405" data-original="https://p4.ssl.qhimg.com/t01a30af7857f19987f.jpg"></p>
<p> </p>
<h2 name="h2-0" id="h2-0">概述</h2>
<p>近日，Google 威胁分析组（TAG）披露了一起针对二进制漏洞安全研究人员的攻击活动，我们在此基础上对攻击活动中所涉及的样本进行了复盘分析，具体发现如下：</p>
<ol>
<li data-list="bullet">攻击者以安全研究人员的身份，至少从2020年4月份开始潜伏在 Twitter、LinkedIn、Telegram、Discord、Keybase 等社交媒体，同时也会建立技术博客，发表一些漏洞分析的文章。攻击者所发表的文章有一定的质量，这在某种程度上增加了对目标安全研究人员的迷惑性。</li>
<li data-list="bullet">攻击者与目标安全研究人员通过社交媒体建立联系后，开始进行社会工程学攻击，其会邀请目标进行漏洞研究方面的合作，向目标发送相关Visual Studio 项目，而该项目一旦编译则会触发执行恶意模块，最终被攻击者控制，具有很强的隐蔽性。</li>
<li data-list="bullet">此外，据 Google 方面透漏，攻击者疑似在其博客中部署了 Chrome 浏览器 0day 漏洞，一旦目标使用 Chrome 浏览器访问其博客，将会触发漏洞而被黑客控制，目前这一说法还有待证实。</li>
<li data-list="bullet">在此次攻击活动中，我们发现多例样本与去年朝鲜 APT 组织 Lazarus 进行的名为 “DreamJob” 的攻击活动中的样本有多处重叠之处，故将此攻击事件归因为 Lazarus APT 组织。</li>
<li data-list="bullet">通过开源情报获悉，Lazarus 此次攻击目标涉及俄罗斯、美国、<strong>中国</strong>、泰国等10余个国家，通过 IP 定位发现国内某安全公司在2020年12月期间有多次回连 C2 的记录。</li>
<li data-list="bullet">根据此次攻击活动目标，很容易让人联想到 Lazarus 实际目的可能为窃取安全研究人员手中的高价值 0Day 漏洞，用以扩充该组织军火库。</li>
<li data-list="bullet">微步在线通过对相关样本、IP 和域名的溯源分析，提取多条相关 IOC，可用于威胁情报检测。微步在线威胁感知平台 TDP、威胁情报管理平台 TIP、威胁情报云 API、互联网安全接入 OneDNS 等均已支持对此次攻击事件和团伙的检测。</li>
</ol>
<p> </p>
<h2 name="h2-1" id="h2-1">事件详情</h2>
<p>攻击者在 Twitter 建立了多个安全研究相关账号，并在近一年保持活跃，通过此渠道发布博客链接，用以和目标安全研究人员建立初步联系。</p>
<p> </p>
<p class="ql-align-center"><img class="alignnone size-full wp-image-230172 aligncenter" alt="" width="554" height="453" data-original="https://p0.ssl.qhimg.com/t01719e0c163a8c95e0.png"></p>
<p class="ql-align-center" style="text-align: center;">图片来源：https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/</p>
<p>攻击者博客文章也确实为漏洞研究相关文章，这可以更好地与目标建立信任。</p>
<p class="ql-align-center"><img class="alignnone size-full wp-image-230173 aligncenter" alt="" width="554" height="311" data-original="https://p2.ssl.qhimg.com/t0187a57281c291e9d7.png"></p>
<p class="ql-align-center" style="text-align: center;">图片来源：https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/</p>
<p>与目标用户建立社交联系之后，攻击者将会邀请目标进行漏洞研究，并向其发送漏洞相关 Visual Studio 项目文件。</p>
<p class="ql-align-center"><img class="size-full wp-image-230174 aligncenter" alt="" width="281" height="606" data-original="https://p3.ssl.qhimg.com/t011cb15e3c21a6633a.png"></p>
<p class="ql-align-center" style="text-align: center;">图片来源：Twitter 用户 Richard Johnson</p>
<p>从一些受害者的社交软件聊天记录截图可以发现，攻击者目标非常明确。如果目标不是漏洞研究相关人员，并不能引起攻击者的兴趣。</p>
<p class="ql-align-center"><img class="alignnone size-full wp-image-230175 aligncenter" alt="" width="254" height="556" data-original="https://p0.ssl.qhimg.com/t01efb08e3731334af5.jpg"></p>
<p class="ql-align-center" style="text-align: center;">图片来源：Twitter 用户 heige</p>
<p> </p>
<h2 name="h2-2" id="h2-2">样本分析</h2>
<p>攻击者在 VS 项目中添加了预生成事件，一旦用户编译项目，将会调用 powershell 检查主机系统是否为 Win10 x64，满足条件后利用系统组件 rundll32 来执行恶意模块 Browse.VC.db 的导出函数 ENGINE_get_RAND，传入参数 6bt7cJNGEb3Bx9yK 2907。</p>
<p><img class="alignnone size-full wp-image-230176 aligncenter" alt="" width="554" height="79" data-original="https://p3.ssl.qhimg.com/t01cf2d0aec75daca56.png"></p>
<p><img class="alignnone size-full wp-image-230177 aligncenter" alt="" width="554" height="177" data-original="https://p4.ssl.qhimg.com/t014834e496d12bf8cf.png"></p>
<p>而 Browse.VB.db，实际为 x64 DLL 文件，其伪装成 VS 项目数据库文件。</p>
<p><img class="alignnone size-full wp-image-230178 aligncenter" alt="" width="248" height="316" data-original="https://p0.ssl.qhimg.com/t01c27f45ae4a066373.png"></p>
<p><img class="alignnone size-full wp-image-230179 aligncenter" alt="" width="554" height="329" data-original="https://p5.ssl.qhimg.com/t0129b181e7c2ec8851.png"></p>
<p>在模块导出函数 ENGINE_get_RAND 中，首先会判断传入参数的个数，如果不等于 2，将会退出木马流程。</p>
<p><img class="alignnone size-full wp-image-230180 aligncenter" alt="" width="285" height="169" data-original="https://p0.ssl.qhimg.com/t0117d632dd78c5135a.png"></p>
<p>样本中的字符串使用 RC4 算法解密，使用的密钥为 {6B 49 A3 8D D8 DD 21 2B 38 59 BB BF 06 C0 33 C2}。</p>
<p><img class="alignnone size-full wp-image-230181 aligncenter" alt="" width="425" height="425" data-original="https://p2.ssl.qhimg.com/t0180719c06f563abb2.png"></p>
<p>使用 RC4 解密出的部分配置信息字符串。</p>
<p><img class="alignnone size-full wp-image-230182 aligncenter" alt="" width="506" height="78" data-original="https://p1.ssl.qhimg.com/t01410c7ad6e97f6772.png"></p>
<p>样本将会以设置注册表启动项的方式来建立持久化机制。</p>
<p><strong>启动项名称</strong>：SSL Update</p>
<p><strong>启动路径</strong>：</p>
<p>C:\Windows\System32\rundll32.exe</p>
<p>C:\ProgramData\VirtualBox\update.bin,ASN2_TYPE_new 5I9YjCZ0xlV45Ui8 4222</p>
<p><img class="alignnone size-full wp-image-230183 aligncenter" alt="" width="485" height="201" data-original="https://p3.ssl.qhimg.com/t01586edce40ea91055.png"></p>
<p>之后解密出 PE 模块，将其释放到主机目录 C:\\ProgramData\\VirtualBox\\update.bin，并通过系统组件 rundll32.exe 调用执行，而 Update.bin 同样为 x64 DLL 模块，其名称伪装为 win32k.dll。</p>
<p><img class="alignnone size-full wp-image-230184 aligncenter" alt="" width="410" height="82" data-original="https://p5.ssl.qhimg.com/t0103ea9fcc9b35405c.png"></p>
<p>该模块执行后会检查传入参数是否为 5I9YjCZ0xlV45Ui8，并以此名创建互斥体，防止木马重复运行。</p>
<p><img class="alignnone size-full wp-image-230185 aligncenter" alt="" width="413" height="109" data-original="https://p3.ssl.qhimg.com/t017aec50dfba1008ed.png"></p>
<p>之后使用 RC4 解密出 PE 模块数据，并在内存中加载运行。</p>
<p><img class="alignnone size-full wp-image-230186 aligncenter" alt="" width="463" height="233" data-original="https://p0.ssl.qhimg.com/t01ec22ed0b33b535aa.png"></p>
<p>经过前面套娃式的流程，最终在内存中加载核心 PE 模块，在此模块中使用了不同的加密方案，使用 OpenSSL 中的 evp 库进行加解密，使用的密钥为：5618198335124815612315615648487。</p>
<p><img class="alignnone size-full wp-image-230187 aligncenter" alt="" width="451" height="89" data-original="https://p3.ssl.qhimg.com/t0139cfb388089abeba.png"></p>
<p>模块中内置了3组用于木马通信的 URL，其中前两个为重复的，也就是实际为2组：</p>
<p>https://codevexillium.org/image/download/download.asp</p>
<p>https://angeldonationblog.com/image/upload/upload.php</p>
<p><img class="alignnone size-full wp-image-230188 aligncenter" alt="" width="554" height="89" data-original="https://p0.ssl.qhimg.com/t01fe49192be338505f.png"></p>
<p>之后会随机生成字符串，和主机系统时间一并经过 Base64 编码以 POST 方法发送至上面的 C2 服务器。</p>
<p><img class="alignnone size-full wp-image-230189 aligncenter" alt="" width="311" height="221" data-original="https://p1.ssl.qhimg.com/t010dbc8fa3d921e3ec.png"></p>
<p>最后接收服务器返回数据，解密后在内存中加载执行恶意模块。</p>
<p><img class="alignnone size-full wp-image-230190 aligncenter" alt="" width="554" height="123" data-original="https://p5.ssl.qhimg.com/t017cfe7a14bb7bd16f.png"></p>
<p>此外，据 Google 方面透漏，攻击者疑似在其博客中部署了 Chrome 浏览器 0day 漏洞，一旦目标使用 Chrome 浏览器访问其博客，将会在用户主机注册表留下被加密的 payload，同时释放一个伪造为驱动文件的 DLL 文件并创建服务以建立持久化机制。</p>
<p>该 DLL 模块启动之后，同样使用 RC4 解密字符串，从注册表中读取 payload 数据。</p>
<p><strong>payload 长度</strong>：HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\KernelConfig\SubVersion</p>
<p><strong>加密的数据</strong>：HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\KernelConfig\Description</p>
<p><img class="alignnone size-full wp-image-230191 aligncenter" alt="" width="554" height="101" data-original="https://p5.ssl.qhimg.com/t014efa8263704e39f9.png"></p>
<p>之后将 payload 数据经过解密后在内存中加载执行，目前未能获取到 payload 数据。</p>
<p><img class="alignnone size-full wp-image-230192 aligncenter" alt="" width="498" height="162" data-original="https://p3.ssl.qhimg.com/t01754aeb7d4a27d294.png"></p>
<p> </p>
<h2 name="h2-3" id="h2-3">关联分析</h2>
<p> </p>
<p>在 Lazarus 以往的攻击活动中，经常将恶意 DLL 模块伪装成 DB 文件来使用，比如在去年的 “DreamJob” 攻击活动中将恶意模块伪装成 thumbnail.db。</p>
<p><img class="alignnone size-full wp-image-230193 aligncenter" alt="" width="396" height="165" data-original="https://p0.ssl.qhimg.com/t018f12c42dc2ca3836.png"></p>
<p>该组织还经常使用系统组件 rundll32 来调用恶意模块的导出函数，并传入参数执行。</p>
<p><img class="alignnone size-full wp-image-230194 aligncenter" alt="" width="554" height="276" data-original="https://p2.ssl.qhimg.com/t01744880e8cd5e8bb1.png"></p>
<p>在攻击样本中，我们可以看到保持了与之前攻击活动相同风格的 RC4 解密部分。</p>
<p><img class="alignnone size-full wp-image-230195 aligncenter" alt="" width="554" height="245" data-original="https://p0.ssl.qhimg.com/t0173d62d7a8062c79a.png"></p>
<p>同时，可发现攻击者使用了与之前完全相同的 RC4 密钥 { B6 B7 2D 8C 6B 5F 14 DF B1 38 A1 73 89 C1 D2 C4}。</p>
<p><img class="alignnone size-full wp-image-230196 aligncenter" alt="" width="474" height="242" data-original="https://p2.ssl.qhimg.com/t0185c90b26378c52dd.png"></p>
<p>类似的随机生成字符串部分，主要区别为之前将此部分作为单独函数，而此次攻击活动中将此部分直接内联编译。</p>
<p><img class="alignnone size-full wp-image-230197 aligncenter" alt="" width="476" height="459" data-original="https://p5.ssl.qhimg.com/t018795f430f053435a.png"></p>
<p>基本一致的内存加载 PE 模块部分。</p>
<p><img class="alignnone size-full wp-image-230198 aligncenter" alt="" width="554" height="232" data-original="https://p4.ssl.qhimg.com/t0166d2217f6b939c7d.png"></p>
<p>在分析中，我们未能获取到 Google 提到的漏洞利用中的 payload 数据，但经过与 Lazarus 之前所使用的 RAT 模块对比，发现启动参数完全一致，均为 “MICROSOFT”，故判断 Lazarus 在本次攻击活动中复用了之前所使用的 RAT 工具。</p>
<p><img class="alignnone size-full wp-image-230199 aligncenter" alt="" width="554" height="327" data-original="https://p2.ssl.qhimg.com/t01e12a05adb4eeb000.png"></p>
<p>在之后持续追踪分析的感染数据中，我们发现已经有俄罗斯、美国、<strong>中国</strong>、泰国等10余个国家/地区的用户被成功入侵。国内有多家机构或个人主机被入侵，根据 IP 定位信息显示，受害者包括国内多家安全公司。</p>
<p><img class="alignnone size-full wp-image-230200 aligncenter" alt="" width="554" height="121" data-original="https://p1.ssl.qhimg.com/t01f0f3934320e81e20.png"></p>
<p>攻击者在此次攻击活动中锁定二进制漏洞研究人员，很显然是为了窃取目标手中高价值 0day 漏洞资料，其在本次攻击活动中入侵了相当数量的用户，且已经使用了 0day 漏洞，推测攻击者已经成功窃取并掌握部分受害用户手中的高价值 0day 漏洞资料，可能会用于未来的攻击活动中，这尤其要引起企业及个人的重视。</p>
<p> </p>
<h2 name="h2-4" id="h2-4">结论</h2>
<p>Lazarus APT 组织是当前最活跃的 APT 组织之一，该组织在以往经常攻击金融、科研等机构。而在此次攻击活动中，Lazarus 首次针对安全研究人员进行定向攻击以窃取高价值 0day 漏洞资料，该组织长期觊觎此类高价值情报资料，这也表明该组织在不断扩充其军火库，以提升武器储备能力。</p>
<p>Lazarus 擅长使用社会工程学方案进行攻击，在去年就曾针对航空企业进行过以 “DreamJob” 为名义的攻击活动。在本次攻击活动中，Lazarus 组织在近一年的时间里展现了其极强的耐心以及行动保障能力，其将攻击目标瞄准安全研究人员也让威胁攻击与防御更加白热化，同时也会导致目标所属公司重要研究成果被窃取等严重危害，相关安全研究人员和机构尤其要提高警惕，微步在线情报局会对该组织攻击活动持续进行跟踪，及时发现安全威胁并快速响应处置。</p>
<p> </p>
<h2 name="h2-5" id="h2-5">附录 – IOC</h2>
<p><strong>C&amp;C</strong></p>
<p><img class="size-full wp-image-230201 alignnone" alt="" width="198" height="161" data-original="https://p2.ssl.qhimg.com/t01f792d34ddeb684e9.png"></p>
<p><strong>C&amp;C（Compromised）</strong></p>
<p><img class="alignnone size-full wp-image-230202" alt="" width="198" height="101" data-original="https://p0.ssl.qhimg.com/t0164be53a062a850c5.png"></p>
<p><strong>C2URLs</strong></p>
<p><img class="size-full wp-image-230203 alignnone" alt="" width="489" height="221" data-original="https://p2.ssl.qhimg.com/t016844ba97b32922d5.png"></p>
<p><strong>SHA256</strong></p>
<p>4c3499f3cc4a4fdc7e67417e055891c78540282dccc57e37a01167dfe351b244</p>
<p>68e6b9d71c727545095ea6376940027b61734af5c710b2985a628131e47c6af7</p>
<p>25d8ae4678c37251e7ffbaeddc252ae2530ef23f66e4c856d98ef60f399fa3dc</p>
<p>a75886b016d84c3eaacaf01a3c61e04953a7a3adf38acf77a4a2e3a8f544f855</p>
<p>a4fb20b15efd72f983f0fb3325c0352d8a266a69bb5f6ca2eba0556c3e00bd15</p>
<p><strong>攻击者博客</strong></p>
<p><img class="alignnone size-full wp-image-230204" alt="" width="227" height="19" data-original="https://p0.ssl.qhimg.com/t019efb0e11c2eb18eb.png"></p>
<p><strong>Twitter账号</strong></p>
<p>https://twitter.com/br0vvnn</p>
<p>https://twitter.com/BrownSec3Labs</p>
<p>https://twitter.com/dev0exp</p>
<p>https://twitter.com/djokovic808</p>
<p>https://twitter.com/henya290</p>
<p>https://twitter.com/james0x40</p>
<p>https://twitter.com/m5t0r</p>
<p>https://twitter.com/mvp4p3r</p>
<p>https://twitter.com/tjrim91</p>
<p>https://twitter.com/z0x55g</p>
<p><strong>LinkedIn账号</strong></p>
<p>https://www.linkedin.com/in/billy-brown-a6678b1b8/</p>
<p>https://www.linkedin.com/in/guo-zhang-b152721bb/</p>
<p>https://www.linkedin.com/in/hyungwoo-lee-6985501b9/</p>
<p>https://www.linkedin.com/in/linshuang-li-aa696391bb/</p>
<p>https://www.linkedin.com/in/rimmer-trajan-2806b21bb/</p>
<p><strong>Keybase</strong></p>
<p>https://keybase.io/zhangguo</p>
<p><strong>Telegram</strong></p>
<p>https://t.me/james50d</p>
<p><strong>注册表路径</strong></p>
<p>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\KernelConfig</p>
<p>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverConfig</p>
<p>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\SSLUpdate</p>
<p><strong>文件路径</strong></p>
<p>C:\Windows\System32\Nwsapagent.sys</p>
<p>C:\Windows\System32\helpsvc.sys</p>
<p>C:\ProgramData\USOShared\uso.bin</p>
<p>C:\ProgramData\VMware\vmnat-update.bin</p>
<p>C:\ProgramData\VirtualBox\update.bin</p>
<p> </p>
<h2 name="h2-6" id="h2-6">参考链接</h2>
<p>https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/</p>
<p> </p>
<h2 name="h2-7" id="h2-7">关于微步情报局</h2>
<p>微步情报局，即微步在线研究响应团队，负责微步在线安全分析与安全服务业务，主要研究内容包括威胁情报自动化研发、高级APT组织&amp;黑产研究与追踪、恶意代码与自动化分析技术、重大事件应急响应等。</p>
</body>
</html></div><div class="_43" style="display:none;"> 本文翻译自 <a href="" target="_blank">原文链接</a>。如若转载请注明出处。 </div><div class="_50" style="display:none;"> 商务合作，文章发布请联系 anquanke@360.cn </div><div class="_49" style=""><p> 本文由<b>微步在线研究响应团队</b>原创发布 </p><p> 转载，请参考<a href="https://www.anquanke.com/note/repost" target="_blank">转载声明</a>，注明出处： <a href="/post/id/230161" target="_blank">https://www.anquanke.com/post/id/230161</a></p><p>安全KER - 有思想的安全新媒体</p></div><div class="_53" style="display:none;"><p> 本文转载自: <a href=""></a></p><p> 如若转载,请注明出处： <a href="" target="_blank"></a></p><p>安全KER - 有思想的安全新媒体</p></div><div class="_54 share1"><div class="main-w"><div class="bg"></div><div class="main"><span>分享到：</span><img class="icon" data-cmd="weixin" alt="微信" src="https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png"></div></div><div class="qrcode" style="display:none;"></div></div><ul class="_56"><!--[--><li><a target="_blank" href="/tag/Lazarus">Lazarus</a></li><!--]--></ul><div class="_46"><div class="line line1"><div class="_17 item1"><b style="display:none;">+1</b><i class="iconfont icon-rate"></i><span class="rate-text">1赞</span></div><div class="_9 item1"><i class=""></i><span>收藏</span></div></div><div class="line line2"><div class="user"><img class="avatar" src="https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png"><span class="name">微步在线研究响应团队</span><span class="label-verify label"></span></div><div class="_54 share2"><div class="main-w"><div class="bg"></div><div class="main"><span>分享到：</span><img class="icon" data-cmd="weixin" alt="微信" src="https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png"></div></div><div class="qrcode" style="display:none;"></div></div></div></div></div><div class="_51"><!----><!----></div><div class="_2 index-comment"><h2 class="g-title">发表评论</h2><div class="login"><p class="login-text">您还未登录，请先登录。</p><p class="login-bar"><a href="/login/index.html">登录</a></p></div><!----><!----><!----></div></div><div class="index-side"><div class="index-side-top"><div class="_57"><img class="banner" src="https://p5.ssl.qhimg.com/t01573092fda7526799.png"><div class="w"><a class="avatar" href="/member.html?memberId=155341"><img src="https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png"></a><p class="info"><a href="/member.html?memberId=155341" class="name">微步在线研究响应团队</a><a href="/member.html?memberId=155341" class="user-label-verify user-label"></a></p><p class="hint">神秘，低调，手里全是情报。中国网络安全圈不可缺少的力量。</p><div class="bottom"><ul class="bottom-1"><li>文章</li><li><strong>34</strong></li></ul><ul class="bottom-2"><li>粉丝</li><li><strong>33</strong></li></ul><div class="spacer"></div><!----></div></div></div><div class="_55"><h3 class="title"> TA的文章</h3><ul><!--[--><li><h5><a href="/post/id/263872">Emotet木马&quot;卷土重来&quot;</a></h5><p>2021-12-28 17:30:46</p></li><li><h5><a href="/post/id/259453">相煎何急，印APT组织蔓灵花针对巴基斯坦政府机构展开定向攻击</a></h5><p>2021-11-23 12:00:45</p></li><li><h5><a href="/post/id/258873">双十一，明知是骗局还想薅骗子羊毛，我做到了！</a></h5><p>2021-11-12 12:00:09</p></li><li><h5><a href="/post/id/258167">涉俄APT组织“圣贤熊”针对军队、政府展开经济犯罪和间谍攻击</a></h5><p>2021-11-04 12:00:48</p></li><li><h5><a href="/post/id/255674">推陈出新，Donot组织窃密手法再升级</a></h5><p>2021-10-21 12:00:10</p></li><!--]--></ul></div><div class="_52"><h3 class="title"> 相关文章</h3><ul><!--[--><li><h5><a href="/post/id/286624">挪威当局查获Lazarus黑客584万美元加密货币</a></h5><p>2023-02-22 11:00:17</p></li><li><h5><a href="/post/id/285718">FBI：黑客组织Lazarus窃取1亿美元加密货币</a></h5><p>2023-01-28 15:10:47</p></li><li><h5><a href="/post/id/281169">微软：Lazarus黑客组织“武器化”开源软件</a></h5><p>2022-09-30 11:00:24</p></li><li><h5><a href="/post/id/280979">Lazarus组织以热门工作为饵，投放Windows/macOS 恶意软件</a></h5><p>2022-09-28 12:00:17</p></li><li><h5><a href="/post/id/279863">Lazarus APT组织盯上全球能源供应商</a></h5><p>2022-09-09 14:15:26</p></li><li><h5><a href="/post/id/278328">IT求职者小心！黑客组织Lazarus冒充Coinbase盯上你</a></h5><p>2022-08-19 11:00:35</p></li><li><h5><a href="/post/id/243392">Lazarus 近期针对军工等行业的定向攻击活动分析</a></h5><p>2021-06-08 18:00:37</p></li><!--]--></ul></div><div class="_42"><h3 class="title">热门推荐</h3><ul><!--[--><!--]--></ul></div></div><div class="_47"><div class="wrap" style=""><div class="title">文章目录</div><ul class="list"><!--[--><li class="item"><a target="_self" href="#h2-0" class="g-line1">概述</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-1" class="g-line1">事件详情</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-2" class="g-line1">样本分析</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-3" class="g-line1">关联分析</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-4" class="g-line1">结论</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-5" class="g-line1">附录 – IOC</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-6" class="g-line1">参考链接</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-7" class="g-line1">关于微步情报局</a><ul><!--[--><!--]--></ul></li><!--]--></ul></div></div></div></div><div class="_16"><div class="g-w main"><div class="col1"><p class="col1-logo"><img src="https://p0.qhimg.com/t11098f6bcd5614af4bf21ef9b5.png"></p><div class="col1-link"><b class="col1-weixin"></b><a href="https://weibo.com/360adlab" class="col1-sina"></a><a href="https://zhuanlan.zhihu.com/c_118578260" class="col1-zhi"></a></div></div><div class="col2"><div class="title">安全KER</div><ul class="col2-list"><li><a href="/about" rel="noopener noreferrer" target="_blank">关于我们</a></li><li><a href="/note/contact" target="_blank" rel="noopener noreferrer">联系我们</a></li><li><a href="/note/protocol" target="_blank" rel="noopener noreferrer">用户协议</a></li><li><a href="/note/privacy" target="_blank" rel="noopener noreferrer">隐私协议</a></li></ul></div><div class="col3"><div class="title">商务合作</div><ul class="col3-list"><li><a href="/note/business" target="_blank" rel="noopener noreferrer">合作内容</a></li><li><a href="/note/contact" target="_blank" rel="noopener noreferrer">联系方式</a></li><li><a href="/link" target="_blank" rel="noopener noreferrer">友情链接</a></li></ul></div><div class="col4"><div class="title">内容需知</div><ul><li><a href="https://www.anquanke.com/contribute/tips" target="_blank" rel="noopener noreferrer">投稿须知</a></li><li><a href="/note/repost" target="_blank" rel="noopener noreferrer">转载须知</a></li><li>官网QQ群：568681302</li></ul></div><div class="col5"><div class="title">合作单位</div><ul><li><a href="http://www.cert.org.cn/" target="_blank" rel="noopener noreferrer"><img alt="安全KER" src="https://p0.ssl.qhimg.com/t01592a959354157bc0.png" style="max-height:40px;"></a></li><li style="margin-top:-20px;"><a href="http://www.cnnvd.org.cn/" target="_blank" rel="noopener noreferrer"><img alt="安全KER" src="https://p0.ssl.qhimg.com/t014f76fcea94035e47.png" style="max-height:50px;margin-top:10px;"></a></li></ul></div></div><div class="right g-w"><span>Copyright © 北京奇虎科技有限公司 三六零数字安全科技集团有限公司 安全KER All Rights Reserved </span><a href="https://beian.miit.gov.cn/">京ICP备08010314号-66</a><span id="cnzz_stat_icon_1271278035"><a href="https://www.cnzz.com/stat/website.php?web_id=1271278035" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="https://icon.cnzz.com/img/pic.gif"></a></span></div><div class="layer" style="display:none;"><div class="layer-main"><div class="layer-title">微信二维码</div><b class="layer-close">X</b><img src="https://p0.ssl.qhimg.com/t0151209205b47f2270.jpg" alt="安全KER"></div></div></div><!--]--></div><script>window.__state__={"artical":{"post":{"id":230161,"title":"Lazarus 针对安全研究人员的攻击事件分析","category_name":"安全资讯","category_slug":"news","desc":"近日，Google 威胁分析组（TAG）披露了一起针对二进制漏洞安全研究人员的攻击活动，我们在此基础上对攻击活动中所涉及的样本进行了复盘分析，具体发现如下。","date":"2021-01-30 10:00:37","time_interval":"2021-01-30","status":"publish","comment":0,"cover":"https://p4.ssl.qhimg.com/t01a30af7857f19987f.jpg","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":388418,"like_count":1,"liked":0,"tags":["Lazarus"],"is_favorite":false,"favorite_count":2,"content":"<html>\n<head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"></head>\n<body>\n<p><img class=\"alignnone size-full wp-image-230205 aligncenter\" alt=\"\" width=\"720\" height=\"405\" data-original=\"https://p4.ssl.qhimg.com/t01a30af7857f19987f.jpg\"></p>\n<p> </p>\n<h2 name=\"h2-0\" id=\"h2-0\">概述</h2>\n<p>近日，Google 威胁分析组（TAG）披露了一起针对二进制漏洞安全研究人员的攻击活动，我们在此基础上对攻击活动中所涉及的样本进行了复盘分析，具体发现如下：</p>\n<ol>\n<li data-list=\"bullet\">攻击者以安全研究人员的身份，至少从2020年4月份开始潜伏在 Twitter、LinkedIn、Telegram、Discord、Keybase 等社交媒体，同时也会建立技术博客，发表一些漏洞分析的文章。攻击者所发表的文章有一定的质量，这在某种程度上增加了对目标安全研究人员的迷惑性。</li>\n<li data-list=\"bullet\">攻击者与目标安全研究人员通过社交媒体建立联系后，开始进行社会工程学攻击，其会邀请目标进行漏洞研究方面的合作，向目标发送相关Visual Studio 项目，而该项目一旦编译则会触发执行恶意模块，最终被攻击者控制，具有很强的隐蔽性。</li>\n<li data-list=\"bullet\">此外，据 Google 方面透漏，攻击者疑似在其博客中部署了 Chrome 浏览器 0day 漏洞，一旦目标使用 Chrome 浏览器访问其博客，将会触发漏洞而被黑客控制，目前这一说法还有待证实。</li>\n<li data-list=\"bullet\">在此次攻击活动中，我们发现多例样本与去年朝鲜 APT 组织 Lazarus 进行的名为 “DreamJob” 的攻击活动中的样本有多处重叠之处，故将此攻击事件归因为 Lazarus APT 组织。</li>\n<li data-list=\"bullet\">通过开源情报获悉，Lazarus 此次攻击目标涉及俄罗斯、美国、<strong>中国</strong>、泰国等10余个国家，通过 IP 定位发现国内某安全公司在2020年12月期间有多次回连 C2 的记录。</li>\n<li data-list=\"bullet\">根据此次攻击活动目标，很容易让人联想到 Lazarus 实际目的可能为窃取安全研究人员手中的高价值 0Day 漏洞，用以扩充该组织军火库。</li>\n<li data-list=\"bullet\">微步在线通过对相关样本、IP 和域名的溯源分析，提取多条相关 IOC，可用于威胁情报检测。微步在线威胁感知平台 TDP、威胁情报管理平台 TIP、威胁情报云 API、互联网安全接入 OneDNS 等均已支持对此次攻击事件和团伙的检测。</li>\n</ol>\n<p> </p>\n<h2 name=\"h2-1\" id=\"h2-1\">事件详情</h2>\n<p>攻击者在 Twitter 建立了多个安全研究相关账号，并在近一年保持活跃，通过此渠道发布博客链接，用以和目标安全研究人员建立初步联系。</p>\n<p> </p>\n<p class=\"ql-align-center\"><img class=\"alignnone size-full wp-image-230172 aligncenter\" alt=\"\" width=\"554\" height=\"453\" data-original=\"https://p0.ssl.qhimg.com/t01719e0c163a8c95e0.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图片来源：https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/</p>\n<p>攻击者博客文章也确实为漏洞研究相关文章，这可以更好地与目标建立信任。</p>\n<p class=\"ql-align-center\"><img class=\"alignnone size-full wp-image-230173 aligncenter\" alt=\"\" width=\"554\" height=\"311\" data-original=\"https://p2.ssl.qhimg.com/t0187a57281c291e9d7.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图片来源：https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/</p>\n<p>与目标用户建立社交联系之后，攻击者将会邀请目标进行漏洞研究，并向其发送漏洞相关 Visual Studio 项目文件。</p>\n<p class=\"ql-align-center\"><img class=\"size-full wp-image-230174 aligncenter\" alt=\"\" width=\"281\" height=\"606\" data-original=\"https://p3.ssl.qhimg.com/t011cb15e3c21a6633a.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图片来源：Twitter 用户 Richard Johnson</p>\n<p>从一些受害者的社交软件聊天记录截图可以发现，攻击者目标非常明确。如果目标不是漏洞研究相关人员，并不能引起攻击者的兴趣。</p>\n<p class=\"ql-align-center\"><img class=\"alignnone size-full wp-image-230175 aligncenter\" alt=\"\" width=\"254\" height=\"556\" data-original=\"https://p0.ssl.qhimg.com/t01efb08e3731334af5.jpg\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图片来源：Twitter 用户 heige</p>\n<p> </p>\n<h2 name=\"h2-2\" id=\"h2-2\">样本分析</h2>\n<p>攻击者在 VS 项目中添加了预生成事件，一旦用户编译项目，将会调用 powershell 检查主机系统是否为 Win10 x64，满足条件后利用系统组件 rundll32 来执行恶意模块 Browse.VC.db 的导出函数 ENGINE_get_RAND，传入参数 6bt7cJNGEb3Bx9yK 2907。</p>\n<p><img class=\"alignnone size-full wp-image-230176 aligncenter\" alt=\"\" width=\"554\" height=\"79\" data-original=\"https://p3.ssl.qhimg.com/t01cf2d0aec75daca56.png\"></p>\n<p><img class=\"alignnone size-full wp-image-230177 aligncenter\" alt=\"\" width=\"554\" height=\"177\" data-original=\"https://p4.ssl.qhimg.com/t014834e496d12bf8cf.png\"></p>\n<p>而 Browse.VB.db，实际为 x64 DLL 文件，其伪装成 VS 项目数据库文件。</p>\n<p><img class=\"alignnone size-full wp-image-230178 aligncenter\" alt=\"\" width=\"248\" height=\"316\" data-original=\"https://p0.ssl.qhimg.com/t01c27f45ae4a066373.png\"></p>\n<p><img class=\"alignnone size-full wp-image-230179 aligncenter\" alt=\"\" width=\"554\" height=\"329\" data-original=\"https://p5.ssl.qhimg.com/t0129b181e7c2ec8851.png\"></p>\n<p>在模块导出函数 ENGINE_get_RAND 中，首先会判断传入参数的个数，如果不等于 2，将会退出木马流程。</p>\n<p><img class=\"alignnone size-full wp-image-230180 aligncenter\" alt=\"\" width=\"285\" height=\"169\" data-original=\"https://p0.ssl.qhimg.com/t0117d632dd78c5135a.png\"></p>\n<p>样本中的字符串使用 RC4 算法解密，使用的密钥为 {6B 49 A3 8D D8 DD 21 2B 38 59 BB BF 06 C0 33 C2}。</p>\n<p><img class=\"alignnone size-full wp-image-230181 aligncenter\" alt=\"\" width=\"425\" height=\"425\" data-original=\"https://p2.ssl.qhimg.com/t0180719c06f563abb2.png\"></p>\n<p>使用 RC4 解密出的部分配置信息字符串。</p>\n<p><img class=\"alignnone size-full wp-image-230182 aligncenter\" alt=\"\" width=\"506\" height=\"78\" data-original=\"https://p1.ssl.qhimg.com/t01410c7ad6e97f6772.png\"></p>\n<p>样本将会以设置注册表启动项的方式来建立持久化机制。</p>\n<p><strong>启动项名称</strong>：SSL Update</p>\n<p><strong>启动路径</strong>：</p>\n<p>C:\\Windows\\System32\\rundll32.exe</p>\n<p>C:\\ProgramData\\VirtualBox\\update.bin,ASN2_TYPE_new 5I9YjCZ0xlV45Ui8 4222</p>\n<p><img class=\"alignnone size-full wp-image-230183 aligncenter\" alt=\"\" width=\"485\" height=\"201\" data-original=\"https://p3.ssl.qhimg.com/t01586edce40ea91055.png\"></p>\n<p>之后解密出 PE 模块，将其释放到主机目录 C:\\\\ProgramData\\\\VirtualBox\\\\update.bin，并通过系统组件 rundll32.exe 调用执行，而 Update.bin 同样为 x64 DLL 模块，其名称伪装为 win32k.dll。</p>\n<p><img class=\"alignnone size-full wp-image-230184 aligncenter\" alt=\"\" width=\"410\" height=\"82\" data-original=\"https://p5.ssl.qhimg.com/t0103ea9fcc9b35405c.png\"></p>\n<p>该模块执行后会检查传入参数是否为 5I9YjCZ0xlV45Ui8，并以此名创建互斥体，防止木马重复运行。</p>\n<p><img class=\"alignnone size-full wp-image-230185 aligncenter\" alt=\"\" width=\"413\" height=\"109\" data-original=\"https://p3.ssl.qhimg.com/t017aec50dfba1008ed.png\"></p>\n<p>之后使用 RC4 解密出 PE 模块数据，并在内存中加载运行。</p>\n<p><img class=\"alignnone size-full wp-image-230186 aligncenter\" alt=\"\" width=\"463\" height=\"233\" data-original=\"https://p0.ssl.qhimg.com/t01ec22ed0b33b535aa.png\"></p>\n<p>经过前面套娃式的流程，最终在内存中加载核心 PE 模块，在此模块中使用了不同的加密方案，使用 OpenSSL 中的 evp 库进行加解密，使用的密钥为：5618198335124815612315615648487。</p>\n<p><img class=\"alignnone size-full wp-image-230187 aligncenter\" alt=\"\" width=\"451\" height=\"89\" data-original=\"https://p3.ssl.qhimg.com/t0139cfb388089abeba.png\"></p>\n<p>模块中内置了3组用于木马通信的 URL，其中前两个为重复的，也就是实际为2组：</p>\n<p>https://codevexillium.org/image/download/download.asp</p>\n<p>https://angeldonationblog.com/image/upload/upload.php</p>\n<p><img class=\"alignnone size-full wp-image-230188 aligncenter\" alt=\"\" width=\"554\" height=\"89\" data-original=\"https://p0.ssl.qhimg.com/t01fe49192be338505f.png\"></p>\n<p>之后会随机生成字符串，和主机系统时间一并经过 Base64 编码以 POST 方法发送至上面的 C2 服务器。</p>\n<p><img class=\"alignnone size-full wp-image-230189 aligncenter\" alt=\"\" width=\"311\" height=\"221\" data-original=\"https://p1.ssl.qhimg.com/t010dbc8fa3d921e3ec.png\"></p>\n<p>最后接收服务器返回数据，解密后在内存中加载执行恶意模块。</p>\n<p><img class=\"alignnone size-full wp-image-230190 aligncenter\" alt=\"\" width=\"554\" height=\"123\" data-original=\"https://p5.ssl.qhimg.com/t017cfe7a14bb7bd16f.png\"></p>\n<p>此外，据 Google 方面透漏，攻击者疑似在其博客中部署了 Chrome 浏览器 0day 漏洞，一旦目标使用 Chrome 浏览器访问其博客，将会在用户主机注册表留下被加密的 payload，同时释放一个伪造为驱动文件的 DLL 文件并创建服务以建立持久化机制。</p>\n<p>该 DLL 模块启动之后，同样使用 RC4 解密字符串，从注册表中读取 payload 数据。</p>\n<p><strong>payload 长度</strong>：HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\KernelConfig\\SubVersion</p>\n<p><strong>加密的数据</strong>：HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\KernelConfig\\Description</p>\n<p><img class=\"alignnone size-full wp-image-230191 aligncenter\" alt=\"\" width=\"554\" height=\"101\" data-original=\"https://p5.ssl.qhimg.com/t014efa8263704e39f9.png\"></p>\n<p>之后将 payload 数据经过解密后在内存中加载执行，目前未能获取到 payload 数据。</p>\n<p><img class=\"alignnone size-full wp-image-230192 aligncenter\" alt=\"\" width=\"498\" height=\"162\" data-original=\"https://p3.ssl.qhimg.com/t01754aeb7d4a27d294.png\"></p>\n<p> </p>\n<h2 name=\"h2-3\" id=\"h2-3\">关联分析</h2>\n<p> </p>\n<p>在 Lazarus 以往的攻击活动中，经常将恶意 DLL 模块伪装成 DB 文件来使用，比如在去年的 “DreamJob” 攻击活动中将恶意模块伪装成 thumbnail.db。</p>\n<p><img class=\"alignnone size-full wp-image-230193 aligncenter\" alt=\"\" width=\"396\" height=\"165\" data-original=\"https://p0.ssl.qhimg.com/t018f12c42dc2ca3836.png\"></p>\n<p>该组织还经常使用系统组件 rundll32 来调用恶意模块的导出函数，并传入参数执行。</p>\n<p><img class=\"alignnone size-full wp-image-230194 aligncenter\" alt=\"\" width=\"554\" height=\"276\" data-original=\"https://p2.ssl.qhimg.com/t01744880e8cd5e8bb1.png\"></p>\n<p>在攻击样本中，我们可以看到保持了与之前攻击活动相同风格的 RC4 解密部分。</p>\n<p><img class=\"alignnone size-full wp-image-230195 aligncenter\" alt=\"\" width=\"554\" height=\"245\" data-original=\"https://p0.ssl.qhimg.com/t0173d62d7a8062c79a.png\"></p>\n<p>同时，可发现攻击者使用了与之前完全相同的 RC4 密钥 { B6 B7 2D 8C 6B 5F 14 DF B1 38 A1 73 89 C1 D2 C4}。</p>\n<p><img class=\"alignnone size-full wp-image-230196 aligncenter\" alt=\"\" width=\"474\" height=\"242\" data-original=\"https://p2.ssl.qhimg.com/t0185c90b26378c52dd.png\"></p>\n<p>类似的随机生成字符串部分，主要区别为之前将此部分作为单独函数，而此次攻击活动中将此部分直接内联编译。</p>\n<p><img class=\"alignnone size-full wp-image-230197 aligncenter\" alt=\"\" width=\"476\" height=\"459\" data-original=\"https://p5.ssl.qhimg.com/t018795f430f053435a.png\"></p>\n<p>基本一致的内存加载 PE 模块部分。</p>\n<p><img class=\"alignnone size-full wp-image-230198 aligncenter\" alt=\"\" width=\"554\" height=\"232\" data-original=\"https://p4.ssl.qhimg.com/t0166d2217f6b939c7d.png\"></p>\n<p>在分析中，我们未能获取到 Google 提到的漏洞利用中的 payload 数据，但经过与 Lazarus 之前所使用的 RAT 模块对比，发现启动参数完全一致，均为 “MICROSOFT”，故判断 Lazarus 在本次攻击活动中复用了之前所使用的 RAT 工具。</p>\n<p><img class=\"alignnone size-full wp-image-230199 aligncenter\" alt=\"\" width=\"554\" height=\"327\" data-original=\"https://p2.ssl.qhimg.com/t01e12a05adb4eeb000.png\"></p>\n<p>在之后持续追踪分析的感染数据中，我们发现已经有俄罗斯、美国、<strong>中国</strong>、泰国等10余个国家/地区的用户被成功入侵。国内有多家机构或个人主机被入侵，根据 IP 定位信息显示，受害者包括国内多家安全公司。</p>\n<p><img class=\"alignnone size-full wp-image-230200 aligncenter\" alt=\"\" width=\"554\" height=\"121\" data-original=\"https://p1.ssl.qhimg.com/t01f0f3934320e81e20.png\"></p>\n<p>攻击者在此次攻击活动中锁定二进制漏洞研究人员，很显然是为了窃取目标手中高价值 0day 漏洞资料，其在本次攻击活动中入侵了相当数量的用户，且已经使用了 0day 漏洞，推测攻击者已经成功窃取并掌握部分受害用户手中的高价值 0day 漏洞资料，可能会用于未来的攻击活动中，这尤其要引起企业及个人的重视。</p>\n<p> </p>\n<h2 name=\"h2-4\" id=\"h2-4\">结论</h2>\n<p>Lazarus APT 组织是当前最活跃的 APT 组织之一，该组织在以往经常攻击金融、科研等机构。而在此次攻击活动中，Lazarus 首次针对安全研究人员进行定向攻击以窃取高价值 0day 漏洞资料，该组织长期觊觎此类高价值情报资料，这也表明该组织在不断扩充其军火库，以提升武器储备能力。</p>\n<p>Lazarus 擅长使用社会工程学方案进行攻击，在去年就曾针对航空企业进行过以 “DreamJob” 为名义的攻击活动。在本次攻击活动中，Lazarus 组织在近一年的时间里展现了其极强的耐心以及行动保障能力，其将攻击目标瞄准安全研究人员也让威胁攻击与防御更加白热化，同时也会导致目标所属公司重要研究成果被窃取等严重危害，相关安全研究人员和机构尤其要提高警惕，微步在线情报局会对该组织攻击活动持续进行跟踪，及时发现安全威胁并快速响应处置。</p>\n<p> </p>\n<h2 name=\"h2-5\" id=\"h2-5\">附录 – IOC</h2>\n<p><strong>C&amp;C</strong></p>\n<p><img class=\"size-full wp-image-230201 alignnone\" alt=\"\" width=\"198\" height=\"161\" data-original=\"https://p2.ssl.qhimg.com/t01f792d34ddeb684e9.png\"></p>\n<p><strong>C&amp;C（Compromised）</strong></p>\n<p><img class=\"alignnone size-full wp-image-230202\" alt=\"\" width=\"198\" height=\"101\" data-original=\"https://p0.ssl.qhimg.com/t0164be53a062a850c5.png\"></p>\n<p><strong>C2URLs</strong></p>\n<p><img class=\"size-full wp-image-230203 alignnone\" alt=\"\" width=\"489\" height=\"221\" data-original=\"https://p2.ssl.qhimg.com/t016844ba97b32922d5.png\"></p>\n<p><strong>SHA256</strong></p>\n<p>4c3499f3cc4a4fdc7e67417e055891c78540282dccc57e37a01167dfe351b244</p>\n<p>68e6b9d71c727545095ea6376940027b61734af5c710b2985a628131e47c6af7</p>\n<p>25d8ae4678c37251e7ffbaeddc252ae2530ef23f66e4c856d98ef60f399fa3dc</p>\n<p>a75886b016d84c3eaacaf01a3c61e04953a7a3adf38acf77a4a2e3a8f544f855</p>\n<p>a4fb20b15efd72f983f0fb3325c0352d8a266a69bb5f6ca2eba0556c3e00bd15</p>\n<p><strong>攻击者博客</strong></p>\n<p><img class=\"alignnone size-full wp-image-230204\" alt=\"\" width=\"227\" height=\"19\" data-original=\"https://p0.ssl.qhimg.com/t019efb0e11c2eb18eb.png\"></p>\n<p><strong>Twitter账号</strong></p>\n<p>https://twitter.com/br0vvnn</p>\n<p>https://twitter.com/BrownSec3Labs</p>\n<p>https://twitter.com/dev0exp</p>\n<p>https://twitter.com/djokovic808</p>\n<p>https://twitter.com/henya290</p>\n<p>https://twitter.com/james0x40</p>\n<p>https://twitter.com/m5t0r</p>\n<p>https://twitter.com/mvp4p3r</p>\n<p>https://twitter.com/tjrim91</p>\n<p>https://twitter.com/z0x55g</p>\n<p><strong>LinkedIn账号</strong></p>\n<p>https://www.linkedin.com/in/billy-brown-a6678b1b8/</p>\n<p>https://www.linkedin.com/in/guo-zhang-b152721bb/</p>\n<p>https://www.linkedin.com/in/hyungwoo-lee-6985501b9/</p>\n<p>https://www.linkedin.com/in/linshuang-li-aa696391bb/</p>\n<p>https://www.linkedin.com/in/rimmer-trajan-2806b21bb/</p>\n<p><strong>Keybase</strong></p>\n<p>https://keybase.io/zhangguo</p>\n<p><strong>Telegram</strong></p>\n<p>https://t.me/james50d</p>\n<p><strong>注册表路径</strong></p>\n<p>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\KernelConfig</p>\n<p>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DriverConfig</p>\n<p>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\SSLUpdate</p>\n<p><strong>文件路径</strong></p>\n<p>C:\\Windows\\System32\\Nwsapagent.sys</p>\n<p>C:\\Windows\\System32\\helpsvc.sys</p>\n<p>C:\\ProgramData\\USOShared\\uso.bin</p>\n<p>C:\\ProgramData\\VMware\\vmnat-update.bin</p>\n<p>C:\\ProgramData\\VirtualBox\\update.bin</p>\n<p> </p>\n<h2 name=\"h2-6\" id=\"h2-6\">参考链接</h2>\n<p>https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/</p>\n<p> </p>\n<h2 name=\"h2-7\" id=\"h2-7\">关于微步情报局</h2>\n<p>微步情报局，即微步在线研究响应团队，负责微步在线安全分析与安全服务业务，主要研究内容包括威胁情报自动化研发、高级APT组织&amp;黑产研究与追踪、恶意代码与自动化分析技术、重大事件应急响应等。</p>\n</body>\n</html>","index":[{"title":"概述","id":"#h2-0","sub":[]},{"title":"事件详情","id":"#h2-1","sub":[]},{"title":"样本分析","id":"#h2-2","sub":[]},{"title":"关联分析","id":"#h2-3","sub":[]},{"title":"结论","id":"#h2-4","sub":[]},{"title":"附录 – IOC","id":"#h2-5","sub":[]},{"title":"参考链接","id":"#h2-6","sub":[]},{"title":"关于微步情报局","id":"#h2-7","sub":[]}],"success":true},"share":{"title":"Lazarus 针对安全研究人员的攻击事件分析","desc":"近日，Google 威胁分析组（TAG）披露了一起针对二进制漏洞安全研究人员的攻击活动，我们在此基础上对攻击活动中所涉及的样本进行了复盘分析，具体发现如下。","imgUrl":"https://p4.ssl.qhimg.com/sdm/160_160_100/t01a30af7857f19987f.jpg"},"author":{"nickname":"微步在线研究响应团队","user_url":"","id":155341,"avatar":"https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png","banner":"https://p5.ssl.qhimg.com/t01573092fda7526799.png","location":"","user_label":"verify","description":"神秘，低调，手里全是情报。中国网络安全圈不可缺少的力量。","register_date":"2020-11-13 14:44:37","self":false,"follow":false,"post_count":34,"follower_count":33,"follow_count":0,"comment_count":0},"relevant":[{"id":286624,"title":"挪威当局查获Lazarus黑客584万美元加密货币","date":"2023-02-22 11:00:17"},{"id":285718,"title":"FBI：黑客组织Lazarus窃取1亿美元加密货币","date":"2023-01-28 15:10:47"},{"id":281169,"title":"微软：Lazarus黑客组织“武器化”开源软件","date":"2022-09-30 11:00:24"},{"id":280979,"title":"Lazarus组织以热门工作为饵，投放Windows/macOS 恶意软件","date":"2022-09-28 12:00:17"},{"id":279863,"title":"Lazarus APT组织盯上全球能源供应商","date":"2022-09-09 14:15:26"},{"id":278328,"title":"IT求职者小心！黑客组织Lazarus冒充Coinbase盯上你","date":"2022-08-19 11:00:35"},{"id":243392,"title":"Lazarus 近期针对军工等行业的定向攻击活动分析","date":"2021-06-08 18:00:37"}],"authorPostList":[{"post_id":263872,"title":"Emotet木马\"卷土重来\"","cover":"https://p2.ssl.qhimg.com/sdm/229_160_100/t01091ed8e9cdd4d7b6.jpg","date":"2021-12-28 17:30:46"},{"post_id":259453,"title":"相煎何急，印APT组织蔓灵花针对巴基斯坦政府机构展开定向攻击","cover":"https://p1.ssl.qhimg.com/sdm/229_160_100/t01cec7932b452164ec.jpg","date":"2021-11-23 12:00:45"},{"post_id":258873,"title":"双十一，明知是骗局还想薅骗子羊毛，我做到了！","cover":"https://p1.ssl.qhimg.com/sdm/229_160_100/t01920b9ec8dc6d5856.jpg","date":"2021-11-12 12:00:09"},{"post_id":258167,"title":"涉俄APT组织“圣贤熊”针对军队、政府展开经济犯罪和间谍攻击","cover":"https://p5.ssl.qhimg.com/sdm/229_160_100/t0128e5ff6ca47bc6dc.jpg","date":"2021-11-04 12:00:48"},{"post_id":255674,"title":"推陈出新，Donot组织窃密手法再升级","cover":"https://p2.ssl.qhimg.com/sdm/229_160_100/t011da4e61721e1aef2.jpg","date":"2021-10-21 12:00:10"}],"cookie":[]}};
//published at: 3/24/2025, 2:04:46 AM</script>

<script src="https://s0.ssl.qhimg.com/static/a89b1e55fab19834,969b9d2ab6d58ff9.js"></script>
<script src="https://s0.ssl.qhimg.com/static/e855bc476c0070c4,d70645fabcfd28e5,b00f894d26352cfe,374cd4f654903275,1fbf0cc911f15a9c.js"></script>
<script src="https://s0.ssl.qhimg.com/static/43c736269a19e5f8,d7c4492c306d9e12.js"></script>
<script src="https://s1.ssl.qhimg.com/static/c3f64e723fc684b2,d29a864a4b5dd4b6,5c4b8b1bbe75533d,3cbbb5bd7b96ace3,f9f572860e7f1fa6,6ab68363fa2cf1cd,202ac292c7470749,1b09dc0e16bd1842,7ebff756a224229c,7e2ef3c63800d75a,88ed2ee38308fdef,12d46f82993a5686,a0f3df7d061398da,d13f12550890a37e,0a46dc26872c97c8,93cffabea9a518c8,dfb86725ae65031a,ec64945fd96853ad,e5735d42c0d2e056,915e3f96382bc34a,ad5f8a7d3f94a99b,2a6f530aa0ff4ab1,e0c05ab86f3f1d93,8c7ec1ccfc0836b8,0c4f9ca675acc69c,a4c086374473de3d,935fc52afa3b9d16,0df21b2fbcae7ee2,5ed46454edb70992,48968bfda2315809,fb90e4d59de7fa39,2ac5433e81c47d4c,7080ac52e5b55154,1b7923b08f6ff00b,740d61a0f003e846,7fde21428a656560,28897353362cd92d,89489b46bbccea23,40868d970272a376,7e4ef35e980d3675,1fbafd3380b80586.js"></script>
</body>

</html>