<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Intel Tools Overview</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        /* Background and font color settings */
        body {
            font-family: Consolas, monospace;
            background-color: #0d1b2a;
            color: #a7c957;
        }
        /* Card styling */
        .card {
            background-color: #1b263b;
            color: #a7c957;
            border: 1px solid #2f4f4f;
        }
        /* Form control styling */
        .form-control {
            background-color: #04151f;
            color: #a7c957;
            border: 1px solid #4f772d;
        }
        /* Button styling */
        .btn-custom {
            background-color: #4f772d;
            color: #0d1b2a;
        }
        .btn-custom:hover {
            background-color: #abdf32;
            color: #0d1b2a;
        }
        /* Alert styling */
        .alert-info {
            background-color: #1b263b;
            color: #a7c957;
            border: 1px solid #2f4f4f;
        }
        /* Link styling */
        a.text-primary {
            color: #a7c957;
            text-decoration: none;
            font-weight: bold;
        }
        a.text-primary:hover {
            color: #90a955;
            text-decoration: none;
        }
        /* Mention card styling */
        .mention-card {
            padding: 5px;
            margin-bottom: 8px;
            background-color: #1b263b;
            color: #a7c957;
            border: 1px solid #2f4f4f;
            text-align: left;
        }
        /* Mention body styling */
        .mention-body {
            padding: 5px;
            margin-bottom: 5px;
            text-align: left;
            font-size: 14px;
            overflow-wrap: break-word;
            white-space: pre-wrap;
            background-color: #04151f;
            color: #a7c957;
            border-left: 3px solid #4f772d;
            margin: 0;
        }
        /* Custom scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #003049;
        }
        ::-webkit-scrollbar-thumb {
            background: #555;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #444;
        }
        /* Card body padding */
        .card-body {
            padding: 5px !important;
        }

        /* GitHub logo styling */
        .github-logo {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            background-color: white;
            border-radius: 50%;
            padding: 4px;
        }
    </style>
</head>
<body>
    <a href="https://github.com/mthcht/ThreatIntel-Reports" target="_blank">
        <img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" alt="GitHub" class="github-logo">
    </a>    
    
    <div class="title-container text-center mb-4">
        <h1 class="title">Threat Intelligence Reports</h1>
        <div class="report-count" style="font-size: 0.9rem; color: #90a955;">Total Reports: 9882</div>
    </div>
    <div class="container mt-5">
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Search for a Keyword</h5>
                <input id="search-bar" type="text" class="form-control" placeholder="Search for a keyword...">
            </div>
        </div>
        <div class="row" id="keyword-list">
            <!-- Keywords will be dynamically inserted here -->
        </div>
        <div class="text-center mb-4">
            <button id="load-more-btn" class="btn btn-custom">Load More</button>
            <button id="show-keywords-btn" class="btn btn-custom" style="display: none;">Show Keywords</button>
        </div>
        <div id="mentions-container">
            <!-- Mentions will be dynamically inserted here -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            const keywordToFileMap = {
    "3proxy": [
        "3proxy.json"
    ],
    "aadinternals": [
        "AADInternals.json"
    ],
    "action1": [
        "action1.json"
    ],
    "adexplorer": [
        "adexplorer.json"
    ],
    "adfind": [
        "adfind.json"
    ],
    "adrecon": [
        "adrecon.json"
    ],
    "advanced port scanner": [
        "advanced port scanner.json"
    ],
    "advanced-ip-scanner": [
        "advanced-ip-scanner.json"
    ],
    "akira": [
        "Akira.json"
    ],
    "ammyy admin": [
        "ammyy admin.json"
    ],
    "anydesk": [
        "anydesk.json"
    ],
    "apt28": [
        "APT28.json"
    ],
    "apt29": [
        "APT29.json"
    ],
    "armitage": [
        "armitage.json"
    ],
    "babyshark": [
        "BabyShark.json"
    ],
    "backstab": [
        "Backstab.json"
    ],
    "badpotato": [
        "BadPotato.json"
    ],
    "badrentdrv2": [
        "BadRentdrv2.json"
    ],
    "bcdedit": [
        "bcdedit.json"
    ],
    "bitsadmin": [
        "bitsadmin.json"
    ],
    "blackcat": [
        "BlackCat.json"
    ],
    "blacksuit": [
        "BlackSuit.json"
    ],
    "bloodhound": [
        "bloodhound.json"
    ],
    "browsinghistoryview": [
        "BrowsingHistoryView.json"
    ],
    "bruteratel": [
        "bruteratel.json"
    ],
    "cactustorch": [
        "CACTUSTORCH.json"
    ],
    "cain&abel": [
        "Cain&Abel.json"
    ],
    "certutil": [
        "Certutil.json"
    ],
    "charlotte": [
        "charlotte.json"
    ],
    "chisel": [
        "chisel.json"
    ],
    "chrome remote desktop": [
        "Chrome Remote Desktop.json"
    ],
    "chromecookiesview": [
        "ChromeCookiesView.json"
    ],
    "chromepass": [
        "chromepass.json"
    ],
    "cimplant": [
        "cimplant.json"
    ],
    "cloudflared": [
        "cloudflared.json"
    ],
    "cobaltstrike": [
        "cobaltstrike.json"
    ],
    "cozy bear": [
        "Cozy Bear.json"
    ],
    "crackmapexec": [
        "crackmapexec.json"
    ],
    "creddump7": [
        "creddump7.json"
    ],
    "dameware": [
        "Dameware.json"
    ],
    "defender-control": [
        "defender-control.json"
    ],
    "dialupass": [
        "dialupass.json"
    ],
    "dns-hijacking": [
        "DNS-Hijacking.json"
    ],
    "dnscat": [
        "dnscat.json"
    ],
    "dnscmd": [
        "dnscmd.json"
    ],
    "dropbear": [
        "dropbear.json"
    ],
    "dropbox": [
        "dropbox.json"
    ],
    "dsinternals": [
        "DSInternals.json"
    ],
    "dsquery": [
        "dsquery.json"
    ],
    "dwagent": [
        "dwagent.json"
    ],
    "ebpf": [
        "ebpf.json"
    ],
    "edrsandblast": [
        "EDRSandBlast.json"
    ],
    "empire": [
        "empire.json"
    ],
    "esentutl": [
        "esentutl.json"
    ],
    "evil-winrm": [
        "evil-winrm.json"
    ],
    "evilginx": [
        "evilginx.json"
    ],
    "fgdump": [
        "fgdump.json"
    ],
    "filezilla": [
        "FileZilla.json"
    ],
    "fin6": [
        "FIN6.json"
    ],
    "fin7": [
        "FIN7.json"
    ],
    "fleetdeck": [
        "fleetdeck.json"
    ],
    "fleetdm": [
        "fleetdm.json"
    ],
    "gobuster": [
        "gobuster.json"
    ],
    "godzilla": [
        "Godzilla.json"
    ],
    "gosecretsdump": [
        "gosecretsdump.json"
    ],
    "gsecdump": [
        "gsecdump.json"
    ],
    "iepassview": [
        "IEPassView.json"
    ],
    "impacket": [
        "Impacket.json"
    ],
    "inveigh": [
        "Inveigh.json"
    ],
    "invoke-obfuscation": [
        "Invoke-Obfuscation.json"
    ],
    "invoke-psimage": [
        "Invoke-PSImage.json"
    ],
    "invoke-socksproxy": [
        "Invoke-SocksProxy.json"
    ],
    "invoke-thehash": [
        "Invoke-TheHash.json"
    ],
    "iobitunlocker": [
        "IObitUnlocker.json"
    ],
    "iodine": [
        "iodine.json"
    ],
    "itarian": [
        "Itarian.json"
    ],
    "joomscan": [
        "joomscan.json"
    ],
    "juicypotato": [
        "JuicyPotato.json"
    ],
    "keethief": [
        "Keethief.json"
    ],
    "kerberoast": [
        "kerberoast.json"
    ],
    "koadic": [
        "koadic.json"
    ],
    "lansweeper": [
        "Lansweeper.json"
    ],
    "lazagne": [
        "LaZagne.json"
    ],
    "ldapdomaindump": [
        "ldapdomaindump.json"
    ],
    "level.io": [
        "level.io.json"
    ],
    "ligolo": [
        "ligolo.json"
    ],
    "lime-rat": [
        "Lime-RAT.json"
    ],
    "lockbit": [
        "LockBit.json"
    ],
    "logmein": [
        "LogMeIn.json"
    ],
    "lslsass": [
        "lslsass.json"
    ],
    "mailpassview": [
        "MailPassView.json"
    ],
    "mailsniper": [
        "MailSniper.json"
    ],
    "masscan": [
        "masscan.json"
    ],
    "mega.co.nz": [
        "mega.co.nz.json"
    ],
    "megacmd": [
        "MEGAcmd.json"
    ],
    "megasync": [
        "MEGAsync.json"
    ],
    "megatools": [
        "megatools.json"
    ],
    "menupass": [
        "MenuPass.json"
    ],
    "metasploit": [
        "Metasploit.json"
    ],
    "microburst": [
        "MicroBurst.json"
    ],
    "mimikatz": [
        "Mimikatz.json"
    ],
    "mimipenguin": [
        "mimipenguin.json"
    ],
    "mozillacookiesview": [
        "MozillaCookiesView.json"
    ],
    "msfvenom": [
        "msfvenom.json"
    ],
    "mshta": [
        "mshta.json"
    ],
    "muddywater": [
        "MuddyWater.json"
    ],
    "nbtscan": [
        "nbtscan.json"
    ],
    "nbtstat": [
        "nbtstat.json"
    ],
    "netcat": [
        "netcat.json"
    ],
    "netexec": [
        "netexec.json"
    ],
    "netpass": [
        "netpass.json"
    ],
    "netscan": [
        "netscan.json"
    ],
    "netsess": [
        "NetSess.json"
    ],
    "netsh": [
        "netsh.json"
    ],
    "netstat": [
        "netstat.json"
    ],
    "nirsoft": [
        "nirsoft.json"
    ],
    "nishang": [
        "nishang.json"
    ],
    "nltest": [
        "nltest.json"
    ],
    "nsocks": [
        "nsocks.json"
    ],
    "ntdsutil": [
        "ntdsutil.json"
    ],
    "openssh": [
        "openssh.json"
    ],
    "passwordfox": [
        "passwordfox.json"
    ],
    "pastebin": [
        "pastebin.json"
    ],
    "pchunter": [
        "PCHunter.json"
    ],
    "peass-ng": [
        "PEASS-ng.json"
    ],
    "phishery": [
        "phishery.json"
    ],
    "pingcastle": [
        "pingcastle.json"
    ],
    "pivotnacci": [
        "pivotnacci.json"
    ],
    "portqry": [
        "PortQry.json"
    ],
    "poshc2": [
        "poshc2.json"
    ],
    "powerless": [
        "PowerLess.json"
    ],
    "powersploit": [
        "PowerSploit.json"
    ],
    "powerup": [
        "PowerUp.json"
    ],
    "powerview": [
        "PowerView.json"
    ],
    "procdump": [
        "ProcDump.json"
    ],
    "processhacker": [
        "processhacker.json"
    ],
    "produkey": [
        "produkey.json"
    ],
    "proxifier": [
        "Proxifier.json"
    ],
    "proxychains": [
        "proxychains.json"
    ],
    "psexec": [
        "psexec.json"
    ],
    "pslist": [
        "pslist.json"
    ],
    "psnmap": [
        "Psnmap.json"
    ],
    "pulseway": [
        "Pulseway.json"
    ],
    "pwdump": [
        "pwdump.json"
    ],
    "quarkspwdump": [
        "quarkspwdump.json"
    ],
    "radmin": [
        "Radmin.json"
    ],
    "rclone": [
        "rclone.json"
    ],
    "redguard": [
        "RedGuard.json"
    ],
    "regeorg": [
        "regeorg.json"
    ],
    "remcom": [
        "RemCom.json"
    ],
    "remotepc": [
        "RemotePC.json"
    ],
    "remoteutilities": [
        "RemoteUtilities.json"
    ],
    "responder": [
        "responder.json"
    ],
    "restic": [
        "restic.json"
    ],
    "roadtools": [
        "ROADtools.json"
    ],
    "rootkit": [
        "rootkit.json"
    ],
    "rottenpotatong": [
        "RottenPotatoNG.json"
    ],
    "routerpassview": [
        "RouterPassView.json"
    ],
    "routerscan": [
        "RouterScan.json"
    ],
    "rsocks": [
        "rsocks.json"
    ],
    "rsockstun": [
        "rsockstun.json"
    ],
    "rubeus": [
        "Rubeus.json"
    ],
    "rustdesk": [
        "RustDesk.json"
    ],
    "safetykatz": [
        "SafetyKatz.json"
    ],
    "schtasks": [
        "schtasks.json"
    ],
    "screenconnect": [
        "screenconnect.json"
    ],
    "sdelete": [
        "sdelete.json"
    ],
    "secretsdump": [
        "secretsdump.json"
    ],
    "sessiongopher": [
        "SessionGopher.json"
    ],
    "sharpchromium": [
        "SharpChromium.json"
    ],
    "sharpdpapi": [
        "SharpDPAPI.json"
    ],
    "sharpdump": [
        "SharpDump.json"
    ],
    "sharphound": [
        "SharpHound.json"
    ],
    "sharpoxidresolver": [
        "SharpOxidResolver.json"
    ],
    "sharpshares": [
        "SharpShares.json"
    ],
    "sharpview": [
        "SharpView.json"
    ],
    "shootback": [
        "shootback.json"
    ],
    "simplehelp": [
        "SimpleHelp.json"
    ],
    "sliver": [
        "Sliver.json"
    ],
    "smbmap": [
        "smbmap.json"
    ],
    "smbscan": [
        "smbscan.json"
    ],
    "smbtouch": [
        "Smbtouch.json"
    ],
    "smbtrap": [
        "SMBTrap.json"
    ],
    "sniffpass": [
        "SniffPass.json"
    ],
    "softethervpn": [
        "SoftEtherVPN.json"
    ],
    "softperfect": [
        "softperfect.json"
    ],
    "splashtop": [
        "SplashTop.json"
    ],
    "sqlmap": [
        "sqlmap.json"
    ],
    "sshdoor": [
        "sshdoor.json"
    ],
    "stunnel": [
        "stunnel.json"
    ],
    "subbrute": [
        "subbrute.json"
    ],
    "sublist3r": [
        "Sublist3r.json"
    ],
    "supremo": [
        "Supremo.json"
    ],
    "tacticalrmm": [
        "tacticalrmm.json"
    ],
    "tailscale": [
        "tailscale.json"
    ],
    "tasklist": [
        "tasklist.json"
    ],
    "tdskiller": [
        "TDSKiller.json"
    ],
    "teamviewer": [
        "teamviewer.json"
    ],
    "telegram": [
        "telegram.json"
    ],
    "termite": [
        "Termite.json"
    ],
    "thc-hydra": [
        "thc-hydra.json"
    ],
    "thundershell": [
        "ThunderShell.json"
    ],
    "tightvnc": [
        "tightvnc.json"
    ],
    "tinymet": [
        "TinyMet.json"
    ],
    "truesocks": [
        "TrueSocks.json"
    ],
    "ufile.io": [
        "ufile.io.json"
    ],
    "ultravnc": [
        "UltraVNC.json"
    ],
    "vncpassview": [
        "VNCPassView.json"
    ],
    "vssadmin": [
        "vssadmin.json"
    ],
    "w32times": [
        "w32times.json"
    ],
    "webbrowserpassview": [
        "webBrowserPassView.json"
    ],
    "weevely": [
        "Weevely.json"
    ],
    "wevtutil": [
        "wevtutil.json"
    ],
    "winpwn": [
        "WinPwn.json"
    ],
    "winscp": [
        "winscp.json"
    ],
    "wirelesskeyview": [
        "WirelessKeyView.json"
    ],
    "wmic": [
        "wmic.json"
    ],
    "wmiexec": [
        "wmiexec.json"
    ],
    "wstunnel": [
        "wstunnel.json"
    ],
    "xcopy": [
        "xcopy.json"
    ],
    "xmrig": [
        "xmrig.json"
    ],
    "xworm": [
        "XWorm.json"
    ]
};


        const keywordListContainer = $('#keyword-list');
        const searchInput = $('#search-bar');
        const loadMoreButton = $('#load-more-btn');
        const showKeywordsButton = $('#show-keywords-btn');
        const mentionsContainer = $('#mentions-container');

        let allKeywords = Object.keys(keywordToFileMap);
        const initialDisplayCount = 20;
        let currentDisplayCount = initialDisplayCount;

        // Function to render keyword buttons
        function renderKeywordButtons(keywords, count) {
            keywordListContainer.empty();
            const keywordsToDisplay = keywords.slice(0, count);
            keywordsToDisplay.forEach(keyword => {
                const keywordElement = $(
                    `<div class="col-md-3 mb-3">
                        <button class="btn btn-custom w-100 keyword-item">${keyword}</button>
                    </div>`
                );
                keywordElement.on('click', () => {
                    displayMentions(keyword);
                });
                keywordListContainer.append(keywordElement);
            });
            if (count >= keywords.length) {
                loadMoreButton.hide();
            } else {
                loadMoreButton.show();
            }
        }

        // Function to display mentions for the selected keyword
        function displayMentions(keyword) {
            mentionsContainer.empty();

            // Hide keyword list and show the "Show Keywords" button
            keywordListContainer.hide();
            loadMoreButton.hide();
            showKeywordsButton.show();

            const jsonFiles = keywordToFileMap[keyword];
            if (!jsonFiles || jsonFiles.length === 0) {
                console.error(`No JSON files found for keyword: ${keyword}`);
                return;
            }

            const mentions = [];

            const promises = jsonFiles.map(file => fetch(`search_results/${file}`)
                .then(response => response.json())
                .then(data => {
                    mentions.push(...data);
                })
                .catch(error => console.error(`Error loading ${file}:`, error))
            );

            Promise.all(promises).then(() => {
                const groupedByUrl = mentions.reduce((acc, mention) => {
                    const url = mention.original_link.replace('[Link to the article](', '').replace(')', '');
                    if (!acc[url]) {
                        acc[url] = {
                            mentions: [],
                            file: mention.file // Use the actual file path from mention object
                        };
                    }
                    acc[url].mentions.push(mention);
                    return acc;
                }, {});

                const totalLinks = Object.keys(groupedByUrl).length;
                mentionsContainer.append(
                    `<div class="alert alert-info text-center" role="alert">
                        Threat Intel Reports for <strong>${keyword}</strong>: <strong>${totalLinks}</strong>
                    </div>`
                );

                Object.keys(groupedByUrl).forEach(url => {
                    const mentionData = groupedByUrl[url];
                    const fileUrl = `https://github.com/mthcht/ThreatIntel-Reports/blob/main/Intel%20Reports/${mentionData.file.replace(/\\/g, '/')}`;
                    const mentionElement = $(
                        `<div class="mention-card text-start" style="padding: 0;">
                            <div class="card-body p-0 text-start" style="text-align: left;">
                                <a href="${url}" target="_blank" class="d-block mb-1" style="font-weight: bold; color: #a7c957; text-decoration: none;">${url}</a>
                                <div class="file-info" style="font-size: 0.8rem; color: #90a955;"><a href="${fileUrl}" target="_blank" style="color: #90a955; text-decoration: none;">Source File</a></div>
                            </div>
                        </div>`
                    );
                    mentionData.mentions.forEach(mention => {
                        mentionElement.append(
                            `<div class="mention-body"><strong><span style="color: #4f772d;">Line ${mention.line_number}</span></strong>: ${$('<div>').text(mention.context).html()}</div>`
                        );
                    });
                    mentionsContainer.append(mentionElement);
                });
            });
        }

        // Handle search functionality
        searchInput.on('input', () => {
            const query = searchInput.val().toLowerCase();

            if (query === "") {
                renderKeywordButtons(allKeywords, currentDisplayCount);
            } else {
                const filteredKeywords = allKeywords.filter(keyword => keyword.toLowerCase().includes(query));
                renderKeywordButtons(filteredKeywords, filteredKeywords.length);
            }
        });

        // Handle load more button click
        loadMoreButton.on('click', () => {
            currentDisplayCount += initialDisplayCount;
            renderKeywordButtons(allKeywords, currentDisplayCount);
        });

        // Handle show keywords button click
        showKeywordsButton.on('click', () => {
            mentionsContainer.empty();
            keywordListContainer.show();
            loadMoreButton.show();
            showKeywordsButton.hide();
            renderKeywordButtons(allKeywords, currentDisplayCount);
        });

        // Initial rendering of keyword buttons
        renderKeywordButtons(allKeywords, currentDisplayCount);
    });
</script>
