<!DOCTYPE html><!-- Last Published: Fri Mar 14 2025 11:18:46 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="www.binarly.io" data-wf-page="65dca03a35626ac9030cba85" data-wf-site="65d392ca924b59f0fcd873eb" lang="en" data-wf-locale="en" data-wf-collection="65dca03a35626ac9030cba69" data-wf-item-slug="a-deeper-uefi-dive-into-moonbounce"><head><meta charset="utf-8"/><title>A deeper UEFI dive into MoonBounce</title><meta content="Unlock the depths of UEFI with Kaspersky Lab&#x27;s new discovery, MoonBounce. Explore this intriguing UEFI firmware threat and the world of APT malware." name="description"/><meta content="A deeper UEFI dive into MoonBounce" property="og:title"/><meta content="Unlock the depths of UEFI with Kaspersky Lab&#x27;s new discovery, MoonBounce. Explore this intriguing UEFI firmware threat and the world of APT malware." property="og:description"/><meta content="" property="og:image"/><meta content="A deeper UEFI dive into MoonBounce" property="twitter:title"/><meta content="Unlock the depths of UEFI with Kaspersky Lab&#x27;s new discovery, MoonBounce. Explore this intriguing UEFI firmware threat and the world of APT malware." property="twitter:description"/><meta content="" property="twitter:image"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/css/binarly-io.c15d8369a.min.css" rel="stylesheet" type="text/css"/><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="2705f2bd1122591e3507ea2c-text/javascript"></script><script type="2705f2bd1122591e3507ea2c-text/javascript">WebFont.load({  google: {    families: ["Exo:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Exo 2:100,200,300,regular,500,600,700,800,900,100italic,200italic,300italic,italic,500italic,600italic,700italic,800italic,900italic"]  }});</script><script type="2705f2bd1122591e3507ea2c-text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660196452b0cde006a5aae30_favicon-binarly-2.png" rel="shortcut icon" type="image/x-icon"/><link href="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/66019f4939195a56b4e416c4_webclip.png" rel="apple-touch-icon"/><link href="https://www.binarly.io/blog/a-deeper-uefi-dive-into-moonbounce" rel="canonical"/><link href="rss.xml" rel="alternate" title="RSS Feed" type="application/rss+xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-L9WKTYN7HE" type="2705f2bd1122591e3507ea2c-text/javascript"></script><script type="2705f2bd1122591e3507ea2c-text/javascript">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZGVlNj', true);gtag('config', 'G-L9WKTYN7HE');</script><link rel="preconnect" href="https://assets-global.website-files.com" crossorigin>
<style>nav a:hover{border-bottom:solid #00f1ba 2px;}</style><style>
 p{
    margin-top: 0;
    margin-bottom: 20px;
}
.w-richtext figure {
    max-width: 100%; 
    position: relative;
    margin-bottom:40px;
}
/**code{background: black;
    padding: 1px;
    color: white;}*/
    
    .w-embed{overflow:auto;}
    caption {
    caption-side: bottom;
    font-size:16px;
}
   /* table caption{text-align:left;}*/
</style>
<style>
  /* Style for the modal */
  #modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    justify-content: center;
    align-items: center;
  }
/*
  #modal img {
    max-width: 90%;
    max-height: 90%;
    display: block;
    margin: 0 auto; 
  }*/
  #modal img {
   /* width: 80%!important;
    height: auto!important;*/
    max-height:100vh;
    display: block; /* Ensure the image is displayed as a block element */
    margin: 0 auto; /* Center the image horizontally */
    background-color:white;
  }

  #modal-caption {
    color: #fff; /* Set caption text color */
    margin-top: 10px; /* Add space between image and caption */
    text-align: center; /* Center the caption text */
  }

  /* Style for the close button */
  #close {
    position: absolute;
    top: 20px;
    right: 20px;
    color: #fff;
    cursor: pointer;
  }

  /* Change cursor to pointer when hovering over initial figure image */
  .w-richtext-align-fullwidth.w-richtext-figure-type-image img {
    cursor: pointer;
  }

  /* Change cursor to pointer for entire body when modal is open */
  body.modal-open {
    cursor: pointer;
  }
  .img-border{
    border: solid black 2px;
    border-radius: 5px;
}
figcaption{font-size:16px;}
</style><script data-cfasync="false" nonce="2861e911-aa98-43b7-8e75-8d98e8de3cec">try{(function(w,d){!function(j,k,l,m){if(j.zaraz)console.error("zaraz is loaded twice");else{j[l]=j[l]||{};j[l].executed=[];j.zaraz={deferred:[],listeners:[]};j.zaraz._v="5850";j.zaraz._n="2861e911-aa98-43b7-8e75-8d98e8de3cec";j.zaraz.q=[];j.zaraz._f=function(n){return async function(){var o=Array.prototype.slice.call(arguments);j.zaraz.q.push({m:n,a:o})}};for(const p of["track","set","debug"])j.zaraz[p]=j.zaraz._f(p);j.zaraz.init=()=>{var q=k.getElementsByTagName(m)[0],r=k.createElement(m),s=k.getElementsByTagName("title")[0];s&&(j[l].t=k.getElementsByTagName("title")[0].text);j[l].x=Math.random();j[l].w=j.screen.width;j[l].h=j.screen.height;j[l].j=j.innerHeight;j[l].e=j.innerWidth;j[l].l=j.location.href;j[l].r=k.referrer;j[l].k=j.screen.colorDepth;j[l].n=k.characterSet;j[l].o=(new Date).getTimezoneOffset();if(j.dataLayer)for(const t of Object.entries(Object.entries(dataLayer).reduce(((u,v)=>({...u[1],...v[1]})),{})))zaraz.set(t[0],t[1],{scope:"page"});j[l].q=[];for(;j.zaraz.q.length;){const w=j.zaraz.q.shift();j[l].q.push(w)}r.defer=!0;for(const x of[localStorage,sessionStorage])Object.keys(x||{}).filter((z=>z.startsWith("_zaraz_"))).forEach((y=>{try{j[l]["z_"+y.slice(7)]=JSON.parse(x.getItem(y))}catch{j[l]["z_"+y.slice(7)]=x.getItem(y)}}));r.referrerPolicy="origin";r.src="/cdn-cgi/zaraz/s.js?z="+btoa(encodeURIComponent(JSON.stringify(j[l])));q.parentNode.insertBefore(r,q)};["complete","interactive"].includes(k.readyState)?zaraz.init():j.addEventListener("DOMContentLoaded",zaraz.init)}}(w,d,"zarazData","script");window.zaraz._p=async bs=>new Promise((bt=>{if(bs){bs.e&&bs.e.forEach((bu=>{try{const bv=d.querySelector("script[nonce]"),bw=bv?.nonce||bv?.getAttribute("nonce"),bx=d.createElement("script");bw&&(bx.nonce=bw);bx.innerHTML=bu;bx.onload=()=>{d.head.removeChild(bx)};d.head.appendChild(bx)}catch(by){console.error(`Error executing script: ${bu}\n`,by)}}));Promise.allSettled((bs.f||[]).map((bz=>fetch(bz[0],bz[1]))))}bt()}));zaraz._p({"e":["(function(w,d){})(window,document)"]});})(window,document)}catch(e){throw fetch("/cdn-cgi/zaraz/t"),e;};</script></head><body class="body-12"><div data-w-id="84b2e890-e78a-c148-0a6d-49fb6642f68a" data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="brix---header-wrapper w-nav"><div class="brix---container-default-4 w-container"><div class="brix---header-content-wrapper"><a href="/" class="brix---header-logo-link w-nav-brand"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg" alt="Binarly logo with text &#x27;Binarly&#x27;
" class="brix---header-logo"/></a><div class="brix---header-middle-col"><nav role="navigation" class="brix---header-menu-wrapper w-nav-menu"><ul role="list" class="brix---header-nav-menu-list"><li class="brix---header-nav-list-item-middle home"><a href="/" class="link-block-20 home w-inline-block"><div class="text-block-70 home">Home<br/></div></a></li><li class="brix---header-nav-list-item-middle"><div data-hover="true" data-delay="0" class="brix---dropdown-wrapper w-dropdown"><div class="brix---dropdown-toggle w-dropdown-toggle"><div class="text-block-70 mobile-show">Platform</div><a href="#" class="link-block-57 platform w-inline-block"><div class="text-block-70">Platform</div></a></div><nav class="brix---dropdown-column-wrapper w-dropdown-list"><div class="brix---dropdown-card"><div class="brix---dropdown-pd"><div class="w-layout-grid brix---dropdown-links-grid"><a href="/features" class="brix---dropdown-link w-dropdown-link">Features</a><a href="/packages" class="brix---dropdown-link w-dropdown-link">Packages</a><a href="/customers" class="brix---dropdown-link w-dropdown-link">Customers</a></div></div></div></nav></div></li><li class="brix---header-nav-list-item-middle"><div data-hover="true" data-delay="0" data-w-id="84b2e890-e78a-c148-0a6d-49fb6642f6a6" class="brix---dropdown-wrapper w-dropdown"><div class="brix---dropdown-toggle w-dropdown-toggle"><div class="text-block-71 research mobile-show">REsearch</div><a href="#" class="link-block-58 w-inline-block"><div class="text-block-71 research">REsearch</div></a></div><nav class="brix---dropdown-column-wrapper w-dropdown-list"><div class="brix---dropdown-card"><div class="brix---dropdown-pd"><div class="w-layout-grid brix---dropdown-links-grid"><a href="/advisories" class="brix---dropdown-link w-dropdown-link">Advisories</a><a href="/articles" class="brix---dropdown-link w-dropdown-link">All REsearch</a><a href="/pkfail" class="brix---dropdown-link menu-indent w-dropdown-link">PKfail</a><a href="/lighttpd" class="brix---dropdown-link menu-indent w-dropdown-link">Lighttpd</a><a href="/blog/xz-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor" class="brix---dropdown-link menu-indent w-dropdown-link">XZ Backdoor</a><a href="/logofail" class="brix---dropdown-link menu-indent w-dropdown-link">LogoFAIL</a></div></div></div></nav></div></li><li class="brix---header-nav-list-item-middle"><div data-hover="true" data-delay="0" data-w-id="84b2e890-e78a-c148-0a6d-49fb6642f6b8" class="brix---dropdown-wrapper w-dropdown"><div class="brix---dropdown-toggle w-dropdown-toggle"><div class="text-block-72 learn mobile-show">Learn</div><a href="#" class="link-block-59 w-inline-block"><div class="text-block-72 learn">Learn</div></a></div><nav class="brix---dropdown-column-wrapper w-dropdown-list"><div class="brix---dropdown-card"><div class="brix---dropdown-pd"><div class="w-layout-grid brix---dropdown-links-grid"><a href="/learn" class="brix---dropdown-link w-dropdown-link">All Resources</a><a href="/blog" class="brix---dropdown-link w-dropdown-link">Product Blog</a><a href="/video" class="brix---dropdown-link w-dropdown-link">Videos</a><a href="/free-tools" class="brix---dropdown-link w-dropdown-link">Free Detection Tools</a><a href="/reports" class="brix---dropdown-link w-dropdown-link">Reports</a></div></div></div></nav></div></li><li class="brix---header-nav-list-item-middle"><div data-hover="true" data-delay="0" data-w-id="8b1abf50-6dbe-8776-86d3-1836c0b9868e" class="brix---dropdown-wrapper w-dropdown"><div class="brix---dropdown-toggle w-dropdown-toggle"><div class="text-block-72 company mobile-show">Company</div><a href="#" class="link-block-60 w-inline-block"><div class="text-block-72 company">Company</div></a></div><nav class="brix---dropdown-column-wrapper w-dropdown-list"><div class="brix---dropdown-card"><div class="brix---dropdown-pd"><div class="w-layout-grid brix---dropdown-links-grid"><a href="/about" class="brix---dropdown-link w-dropdown-link">About Binarly</a><a href="/news" class="brix---dropdown-link w-dropdown-link">News</a><a href="/press" class="brix---dropdown-link w-dropdown-link">Press</a></div></div></div></nav></div></li><li class="brix---header-nav-list-item-middle"></li><li class="brix---header-nav-list-item-show-in-mbl"><a href="https://risk.binarly.io/" target="_blank" class="button-11 scan-button w-button">Free scan</a></li><li class="brix---header-nav-list-item-show-in-mbl"><a href="/book-a-demo-old" class="button-11 book-demo w-button">Book a demo</a></li></ul></nav></div><div class="brix---header-right-col"><div class="brix---hamburger-menu-wrapper w-nav-button"><div class="brix---hamburger-menu-bar-top"></div><div class="brix---hamburger-menu-bar-bottom"></div></div><div class="div-block-97"><a href="https://risk.binarly.io/" target="_blank" class="button-11 scan-button w-button">Free scan</a><a href="/book-a-demo" class="button-11 book-demo w-button">Book a demo</a></div></div></div></div></div><section class="header-banner-pages"><div class="div-block-62"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research.webp" alt="Header banner" sizes="(max-width: 2656px) 100vw, 2656px" srcset="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research-p-500.webp 500w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research-p-800.webp 800w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research-p-1080.webp 1080w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research-p-1600.webp 1600w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research-p-2000.webp 2000w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research-p-2600.webp 2600w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research.webp 2656w" class="image-33"/><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e8e27621fab7d4c8a_Research%20(1).webp" alt="Header banner" sizes="100vw" srcset="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e8e27621fab7d4c8a_Research%20(1)-p-500.webp 500w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e8e27621fab7d4c8a_Research%20(1)-p-800.webp 800w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e8e27621fab7d4c8a_Research%20(1)-p-1080.webp 1080w, https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e8e27621fab7d4c8a_Research%20(1).webp 1247w" class="mobile-header-image"/></div></section><section class="blog"><div class="w-layout-blockcontainer w-container"><div class="blog-title-inner"><div class="w-embed"><!-- Modal HTML markup -->
<div id="modal">
  <span id="close">&times;</span>
  <div id="modal-content">
    <img id="modal-img" src="" alt="Modal Image">
    <div id="modal-caption"></div> <!-- Use a separate container for the caption -->
  </div>
</div></div><div class="text-block-32">January 21, 2022</div><h1 class="blog-header">A deeper UEFI dive into MoonBounce</h1><h2 class="heading-21">Binarly Team</h2></div></div></section><div class="w-layout-blockcontainer bin-blog-body w-container"><div class="bin-blog-inner"><div><div class="rich-text-block-3 w-richtext"><p>After uncovering <a href="https://securelist.com/finspy-unseen-findings/104322/">FinSpy</a> several months ago, an APT threat targeting UEFI bootloaders, in the morning of January 20th 2022, Kaspersky Lab has released a new <a href="https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468">report</a> on their latest discovery, a very interesting UEFI firmware threat dubbed MoonBounce.</p><p>Last year, the ESET researchers discovered <a href="https://www.welivesecurity.com/2021/10/05/uefi-threats-moving-esp-introducing-especter-bootkit/">ESPecter</a> another threat which also targets EFI bootloaders.</p><p>MoonBounce, FinSpy and ESPecter are examples of APT malware comprising components that target both UEFI and Legacy BIOS boot processes.</p><p>To kickstart our investigation, we leveraged VirusTotal Intelligence and discovered an archive exhibiting the detections mentioned in the Kaspersky Labâs MoonBounce report. Â Recently, a user uploaded the related samples, which surprised us greatly since we did not expect to find them that quickly by just querying using the detection name.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 1.1" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e33c_65dde5033cf1c7b99888d0e7_1a26cb13-e4b4-4d87-b138-ae4d37a981e8.png" loading="lazy"/></div></figure><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 1.2" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e321_65dde4eb94fe66a19eee4cea_e9cb0e7a-a0a9-47c6-b9d5-40e70836d99e.png" loading="lazy"/></div></figure><p>Letâs dive into the dark waters of the MoonBounce firmware implant. In this blog we want to discuss some of the facts which werenât covered by the original report and are interesting to share.</p><p>Kaspersky Labâs original report emphasizes that the aforementioned malware consists of a number of known malware components and frameworks: Microcin, Mimikat SSP, xTalker, etc.</p><p>Binarly Research Team has analyzed the samples found in VirusTotal and discovered that the UEFI component (the first stage in the malware boot process) is quite old too. It was compiled with borrowed code from an unknown old malware project, most likely previously discovered in the wild on some Dell systems back in 2018 (according to GitHub repository information) and reconstructed in detail in the GitHub repository called âBootLoaderâ.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 2" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e31b_65dde4f68c5207736eda66d7_81ebfc94-5ae0-4c08-96fc-1e425559dc58.png" loading="lazy"/></div></figure><p>Binarly investigation focused on the firmware research of the UEFI component to provide additional technical information to the already detailed original report on MoonBounce threat. </p><p>Our deep dive uncovered similarities between the MoonBounce UEFI component and the binaries available in the BootLoader GitHub repository. Diving into the BootLoader code, visually the hooking routine <em>Search_OslArchTransferToKernel()</em> piqued our interest, as it is almost identical with the textual disassembly of the MoonBounceâs <em>CORE_DXE</em> firmware dump component:</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 3" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e335_65dde4f52dc25100eb538fbc_8bfbbda8-b1d8-459d-b5ae-3e0ad1d54a76.png" loading="lazy"/></div></figure><p><em>Code from CORE_DXE of MoonBounce firmware dump</em></p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 4" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e341_65dde4f410b7cde33c37b9e5_92ba633a-6a54-45bf-89d8-bd8432e22501.png" loading="lazy"/></div></figure><p><em>Disassembled 32-bit code of BootLoader binary</em></p><p>During early runtime of the DXE phase, it is a known practice employed by malicious actors to modify or hook DXE Services to intercept a boot flow inside the firmware. From a forensics perspective, such modifications are very visible and can be detected using common integrity firmware monitoring approaches.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 5" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e344_65dde4ed1f0577c2622bc3c7_ceeee6c2-5c29-4e9b-b281-10dae70fd9d3.png" loading="lazy"/></div></figure><p><em>Disassembly code from CORE_DXE of MoonBounce firmware dump</em></p><p>This code from MoonBounce component is pretty similar with code flow from BootLoader.asm. These observations lead to the conclusion that MoonBounce&#x27;s authors are the same or use similar code techniques or frameworks to embed their modification into the firmware and Windows kernel.</p><p><em>Additional details can be found in the original Kaspersky report âTechnical details of MoonBounceâs implementationâ (p. 6, âCode that set up a hook in the ExAllocatePool function within ntoskrnl.exeâ).</em></p><p>Another technical detail we&#x27;d like to highlight here relates to the multiple infection delivery paths. The original report explains the usage of <em>CoreCreateEventInternal()</em> hook - as support for both UEFI boot and Legacy boot mode (assuming itâs targeting deprecated Compatibility Support Module (CSM)).</p><p><em>Compatibility Support Module (CSM) - this module emulates the legacy BIOS in UEFI systems and was developed by Intel to ease the transition to UEFI world. It&#x27;s pretty common on hardware released before 2020. For newer enterprise hardware is usually disabled by default.</em></p><p>The reason for using <em>CoreExitBootServices()</em> is to hook a call from Windows loader (Winload) and prepare the next steps for the MoonBounce boot interception process. What is the point of hooking <em>InternalAllocatePool()</em> at the beginning? The possible motivation for this could be to avoid storing the shellcode in a virtual address space along the Windows kernel, by placing it in a physical memory and then executing it directly from there. Such a technique can be used for fileless in memory code execution which would be orchestrated directly from the firmware. During incident response, this will cause complications from a forensic perspective.</p><p>Upon further analysis, we found that CORE_DXE contains the target firmware name as a string constant &quot;E7846IMS.M30&quot;.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 6" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e339_65dde4ffe31233752d6848c7_3904ab1d-7d4b-4733-8cc1-cc94e3ff8d9d.png" loading="lazy"/></div></figure><p>Therefore, we became curious to determine the exact targeted platform. The first forensic artifact is the PE header timestamp for the CORE_DXE module (Fri Jul 18 03:29:55 2014). </p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 7" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e32d_65dde4eef82085a4b81c681d_cbdfd8ad-fe0c-4dcf-8670-aabb43e6c899.png" loading="lazy"/></div></figure><p><em>PE Tree snapshot of the CORE_DXE module</em></p><p>On the same day, Taiwanese company MSI released a firmware update for their hardware platform which is very similar to the firmware that has been infected by MoonBounce.</p><p><em>Searching on Google for the string constant &quot;E7846IMS.M30&quot;, we found the following website:</em></p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 8" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e317_65dde4fc0c089fae89330931_5356dd1d-2a85-41cb-b09a-1ef34fe85817.png" loading="lazy"/></div></figure><p><em>hxxps://www.mmnt[.]net/db/0/13/lupd01[.]eu[.]msi[.]com/ALL_BIOS_Update_Genie_update_20140831</em></p><p>After obtaining the original firmware image, we were curious about the similarity between the original CORE_DXE component and the modified one in MoonBounce. According to our code analysis (binary diffing the MoonBounce UEFI component with the original firmware image from the vendor), there were no other modifications besides hooks for <em>InternalAllocatePool</em>, <em>CoreExitBootServices</em> and <em>CoreCreateEventInternal</em> services.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img alt="Figure 9" src="https://cdn.prod.website-files.com/65dc9e6c7079139a2996b5d7/65e5b569102e2387a325e348_65dde505f859c705b3171f58_0894df59-41d4-4a51-89df-2d75fd3ab2db.png" loading="lazy"/></div></figure><p><em>BinDiff analysis with the original CORE_DXE {5AE3F37E-4EAE-41AE-8240-35465B5E81EB} driver from E7846IMS.M30 firmware</em></p><p>Using the Binarly Cloud Platform, we found a DXE Core driver which is very similar to the MoonBounce UEFI firmware dump component. The similarity was confirmed by matching control flow graphs through further analysis with Google BinDiff tool. The code similarity search reveals exactly three modified/hooked routines that we discussed earlier.</p><p>There are other interesting questions we need to discuss, such as potential methods of delivering malware to the target system. How could such malware be written into SPI flash storage of the targeted system? It is worth noticing that <strong>the analyzed MoonBounce UEFI component was built for a target hardware related to a MSI system from 2014</strong>. This fact allows us to suggest two possible initial points of compromise: </p><ul role="list"><li><strong>Physical access-based implant delivery</strong> to the target system - no Intel Boot Guard technology present or enabled thus there are no physical or hardware restrictions to get access to SPI flash storage of the system. </li><li><strong>Software-based implant delivery</strong> to the target system - keeping in mind the historical ignorance of many vendors on firmware security threats, we infer that no SPI protections were enabled on the system, hence SPI write-operations could be issued easily with no exploits required (access only to physical memory is required for working with PCH SPI controller MMIO).</li></ul><p>Public information regarding firmware related implants is more present in the media lately, but it is just scratching the surface in terms of threat detection. Many security research papers have been published which provide examples of more advanced techniques for threat actors to persist in firmware. The supply chain complexity significantly increases the chances for the attackers to effectively reuse 1/N-day vulnerabilities (<a href="https://www.binarly.io/posts/The_Firmware_Supply_Chain_Security_is_broken_Can_we_fix_it">âThe Firmware Supply-Chain Security is broken: Can we fix it?â</a>.</p><p><strong>We need to increase the industry awareness to firmware related threats and build more effective threat hunting programs with cross-industry collaboration between the vendors to mutually benefit customers and provide better detection rates.</strong></p></div></div></div></div><div id="xz-backdoor"><section class="section-6"><div class="div-block-55"><div class="w-layout-blockcontainer container-21 w-container"><div class="cta-white-inner"><div id="w-node-_7f976207-540f-1ab4-953f-9ef9fe3e40d9-fe3e40d7" class="w-layout-layout quick-stack-15 wf-layout-layout"><div class="w-layout-cell"><div class="cta-header-text-limit"><h3 class="cta-header-3">What&#x27;s lurking in your firmware?</h3><div class="text-block-83"></div></div></div><div class="w-layout-cell cell-95"><a href="https://fwhunt.run/" class="link-block-4 w-inline-block"><div class="green-v3-button"><div id="w-node-_5f0bea21-4baf-6529-1a66-c89c1dd7cf24-1dd7cf23" class="w-layout-layout green-button-v3 wf-layout-layout"><div class="w-layout-cell"><div class="text-block-55">Free Binary Scan </div></div><div class="w-layout-cell cell-89"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65f86908fed31c26610fe934_Group%20381.svg" loading="lazy" alt="Arrow indicating link" class="image-56"/></div></div></div></a></div></div></div></div></div></section></div><footer class="brix---footer-wrapper-2"><div class="div-block-56"><div class="footer-container"><div class="brix---footer-top"><div class="footer-inner"><div id="w-node-dd034383-dad6-753f-36b9-6dbc49763a70-64e2890e" class="w-clearfix"><div class="brix---mg-bottom-24px-3"><a href="/" class="brix---footer-logo-wrapper-3 w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg" alt="Binarly logo with text &#x27;Binarly&#x27;
" class="brix---footer-logo-3"/></a></div><div id="w-node-dd034383-dad6-753f-36b9-6dbc49763a74-64e2890e" class="w-layout-layout quick-stack-14 wf-layout-layout"><div class="w-layout-cell"><a href="https://twitter.com/binarly_io?lang=en" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b9591b951116fb5f47de_Subtraction%205.svg" loading="lazy" alt="X logo"/></a></div><div class="w-layout-cell"><a href="https://www.linkedin.com/company/binarlyinc/" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b958f35f981e228095d6_Subtraction%204.svg" loading="lazy" alt="linkedin logo"/></a></div><div class="w-layout-cell"><a href="https://github.com/binarly-io" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b959b5a62bb6adb058a5_github-mark-white.svg" loading="lazy" alt="github logo"/></a></div><div class="w-layout-cell"><a href="https://www.youtube.com/channel/UCpJ_uhTb4_NNoq3-02QfOsA" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b95946e1fd610eef4f94_Subtraction%203.svg" loading="lazy" alt="youtube logo"/></a></div></div></div><div id="w-node-dd034383-dad6-753f-36b9-6dbc49763a81-64e2890e" class="footer-menu-expanded"><ul role="list" class="list-11 w-list-unstyled"><li><div><h6 class="footer-menu-title">Platform</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="/features" class="link-24">Features</a></li><li><a href="/packages" class="link-24">Packages</a></li><li><a href="/customers" class="link-24">Customers</a></li></ul></div></li><li><div><h6 class="footer-menu-title">REsearch</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="/advisories" class="link-24">Advisories</a></li><li class="list-item-14"><a href="/articles" class="link-24">All REsearch</a></li><li class="r-menu"><a href="/pkfail" class="link-24">PKfail</a></li><li class="r-menu"><a href="/lighttpd" class="link-24">Lighttpd</a></li><li class="r-menu"><a href="/blog/xz-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor" class="link-24">XZ Backdoor</a></li><li class="r-menu"><a href="/logofail" class="link-24">LogoFAIL</a></li></ul></div></li><li><div><h6 class="footer-menu-title">Learn</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="/learn" class="link-24">All Resources</a></li><li><a href="/blog" class="link-24">Product Blog</a></li><li><a href="/video" class="link-24">Videos</a></li><li><a href="/free-tools" class="link-24">Free Detection Tools</a></li><li><a href="/reports" class="link-24">Reports</a></li></ul></div></li><li><div><h6 class="footer-menu-title">Company</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="/about" class="link-24">About Binarly</a></li><li><a href="/news" class="link-24">News</a></li><li><a href="/press" class="link-24">Press</a></li></ul></div></li></ul></div></div></div><div class="brix---footer-bottom"><div class="div-block-109"><ul role="list" class="footer-bottom-links w-clearfix w-list-unstyled"><li class="list-item-15"><div class="link-25">Copyright Â© 2025</div></li><li class="list-item-16"><a href="/terms-of-use" class="link-25 left-line">Terms of use</a></li><li class="list-item-17"><a href="/cookie-policy" class="link-25 left-line">Cookie Policy</a></li><li class="list-item-18"><a href="/privacy-policy" class="link-25 left-line">Privacy Policy</a></li><li class="list-item-19"><a href="/ccpa-privacy-notice" class="link-25 left-line">CCPA Privacy Notice</a></li><li class="list-item-20"><a href="/organizational-security" class="link-25 left-line">Security Commitments</a></li></ul></div></div></div><div class="brix---container-default-5 w-container"><div class="brix---footer-top"><div class="w-layout-grid brix---grid-footer-v1"><div id="w-node-_168db288-d954-3178-7318-a3ee64e28912-64e2890e" class="w-clearfix"><div class="brix---mg-bottom-24px-3"><a href="/" class="brix---footer-logo-wrapper-3 w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg" alt="Binarly logo with text &#x27;Binarly&#x27;
" class="brix---footer-logo-3"/></a></div><div id="w-node-_168db288-d954-3178-7318-a3ee64e28916-64e2890e" class="w-layout-layout quick-stack-14 wf-layout-layout"><div class="w-layout-cell"><a href="https://twitter.com/binarly_io?lang=en" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b9591b951116fb5f47de_Subtraction%205.svg" loading="lazy" alt="X logo"/></a></div><div class="w-layout-cell"><a href="https://www.linkedin.com/company/binarlyinc/" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b958f35f981e228095d6_Subtraction%204.svg" loading="lazy" alt="linkedin logo"/></a></div><div class="w-layout-cell"><a href="https://github.com/binarly-io" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b959b5a62bb6adb058a5_github-mark-white.svg" loading="lazy" alt="github logo"/></a></div><div class="w-layout-cell"><a href="https://www.youtube.com/channel/UCpJ_uhTb4_NNoq3-02QfOsA" target="_blank" class="w-inline-block"><img src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b95946e1fd610eef4f94_Subtraction%203.svg" loading="lazy" alt="youtube logo"/></a></div></div></div><div class="footer-menu-expanded"><ul role="list" class="list-11 w-list-unstyled"><li><div><h6 class="footer-menu-title">Platform</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="#" class="link-24">Features</a></li><li><a href="#" class="link-24">Packages</a></li><li><a href="#" class="link-24">Customers</a></li></ul></div></li><li><div><h6 class="footer-menu-title">REsearch</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="#" class="link-24">Advisories</a></li><li class="list-item-14"><a href="#" class="link-24">All REsearch</a></li><li class="r-menu"><a href="#" class="link-24">PKfail</a></li><li class="r-menu"><a href="#" class="link-24">Lighttpd</a></li><li class="r-menu"><a href="#" class="link-24">XZ Backdoor</a></li><li class="r-menu"><a href="#" class="link-24">LogoFAIL</a></li></ul></div></li><li><div><h6 class="footer-menu-title">Learn</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="#" class="link-24">All Resources</a></li><li><a href="#" class="link-24">Product Blog</a></li><li><a href="#" class="link-24">Videos</a></li><li><a href="#" class="link-24">Free Detection Tools</a></li><li><a href="#" class="link-24">Reports</a></li></ul></div></li><li><div><h6 class="footer-menu-title">Company</h6><ul role="list" class="footer-menu-v2 w-list-unstyled"><li><a href="#" class="link-24">About Binarly</a></li><li><a href="#" class="link-24">News</a></li><li><a href="#" class="link-24">Press</a></li></ul></div></li></ul></div><div class="div-block-104"><ul role="list" class="brix---footer-list-wrapper-3"><li class="brix---footer-list-item-3"><a href="/features" class="brix---footer-link-3">Capabilities</a></li><li class="brix---footer-list-item-3"><a href="/packages" class="brix---footer-link-3">Packages</a></li><li class="brix---footer-list-item-3"><a href="/customers" class="brix---footer-link-3">Customers</a></li><li class="brix---footer-list-item-3"></li><li class="brix---footer-list-item-3"></li></ul></div><div id="w-node-_168db288-d954-3178-7318-a3ee64e2892e-64e2890e" class="div-block-63"><ul role="list" class="brix---footer-list-wrapper-3"><li class="brix---footer-list-item-3"><a href="/articles-old" class="brix---footer-link-3">REsearch</a></li><li class="brix---footer-list-item-3"><a href="/advisories" class="brix---footer-link-3">Advisories</a></li><li class="brix---footer-list-item-3"><a href="/free-tools" class="brix---footer-link-3">Free Tools</a></li><li class="brix---footer-list-item-3"></li></ul></div><div class="div-block-105"><ul role="list" class="brix---footer-list-wrapper-3"><li class="brix---footer-list-item-3"><a href="/about" class="brix---footer-link-3">About</a></li><li class="brix---footer-list-item-3"><a href="/news" class="brix---footer-link-3">News</a></li><li class="brix---footer-list-item-3"><a href="/press" class="brix---footer-link-3">Press</a></li><li class="brix---footer-list-item-3"></li></ul></div></div></div><div class="brix---footer-bottom"><p class="brix---paragraph-default-3">Copyright Â© 2024Â Â |Â Â <a href="/terms-of-use" class="link-11">Terms of use</a>Â Â |Â Â <a href="/cookie-policy" class="link-10">Cookie Policy</a>Â Â | <a href="/privacy-policy" class="link-9">Privacy Policy</a>Â Â |Â Â <a href="/ccpa-privacy-notice" class="link-8">CCPA Privacy Notice</a></p></div></div></div></footer><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=65d392ca924b59f0fcd873eb" type="2705f2bd1122591e3507ea2c-text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/js/binarly-io.schunk.b7cad701f94860c2.js" type="2705f2bd1122591e3507ea2c-text/javascript"></script><script src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/js/binarly-io.schunk.16005ed2fba96eca.js" type="2705f2bd1122591e3507ea2c-text/javascript"></script><script src="https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/js/binarly-io.993e7d63.0e062d5e35c92904.js" type="2705f2bd1122591e3507ea2c-text/javascript"></script><!-- Google tag (gtag.js) -->
<!--<script async src="https://www.googletagmanager.com/gtag/js?id=G-L9WKTYN7HE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L9WKTYN7HE',{ 'referrer' : document.referrer.split('?')[0], } );
</script>-->


<script type="2705f2bd1122591e3507ea2c-text/javascript">function initApollo(){var n=Math.random().toString(36).substring(7),o=document.createElement("script");
o.src="https://assets.apollo.io/micro/website-tracker/tracker.iife.js?nocache="+n,o.async=!0,o.defer=!0,
o.onload=function(){window.trackingFunctions.onLoad({appId:"65e24af123290e0439f9fe11"})},
document.head.appendChild(o)}initApollo();</script>

<!-- Start of HubSpot Embed Code -->
<script type="2705f2bd1122591e3507ea2c-text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/22222483.js"></script>
<!-- End of HubSpot Embed Code -->

<!--<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/embed/v2.js"></script>-->
<!--<script>
  hbspt.forms.create({
    region: "na1",
    portalId: "22222483",
    formId: "3f4016d5-88b0-444b-95ec-700da3409d3d"
  });
</script>-->

<!--<script>					
window.hsFormsOnReady = window.hsFormsOnReady || [];
window.hsFormsOnReady.push(()=>{
	hbspt.forms.create({
                region: "na1",
		portalId: "22222483",
                formId: "3f4016d5-88b0-444b-95ec-700da3409d3d",
                target: "#hub-form",
		})
});
</script>-->
<!-- Hotjar Tracking Code for https://www.binarly.io -->
<script type="2705f2bd1122591e3507ea2c-text/javascript">
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3919527,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<script id="jetboost-script" type="2705f2bd1122591e3507ea2c-text/javascript"> window.JETBOOST_SITE_ID = "clt4beygy01030r2h88wk8kwe"; (function(d) { var s = d.createElement("script"); s.src = "https://cdn.jetboost.io/jetboost.js"; s.async = 1; d.getElementsByTagName("head")[0].appendChild(s); })(document); </script>
<style>
  table{width:100%;
  border-collapse: collapse;
        
  } 
  .bin-blog-body  .w-embed{
   margin-top: 40px;
    margin-bottom: 40px;
  }
  /*table{
   margin-top: 40px;
    margin-bottom: 40px;
  }*/
  table, th, td {
  border: 1px solid;
}
  th, td {
  padding: 15px;
  text-align: left;
}
  tr:nth-child(even) {background-color: #f2f2f2;}
table{
    word-break: break-word;
}
  
figure.w-richtext-figure-type-image.w-richtext-align-center{
    margin-top: 40px!important;
    margin-bottom: 40px!important;           
}
.w-richtext h2{margin-bottom: 30px!important;} 
  .w-richtext h1 {color:black!important; margin-bottom:40px}
  .w-code-block{margin-top:40px; margin-bottom:40px;}
  
.brix---header-wrapper.w-nav{
	 -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
} 
  .brix---header-wrapper.menu-test.w-nav {
    -webkit-backdrop-filter: unset!important;
  backdrop-filter:unset!important;
  }
  
  th {
   
    background-color:#3F3B6C!important;
    color:white;
    
}
td{background-color:#F0F2FC;!important}
  
  table, th, td {
    border: 2px solid white;
}
  table th {
  clip-path: xywh(0 0 100% 100% round 0.5em);
}
  able tr {
  clip-path: xywh(0 0 100% 100% round 0.5em)!important;
}
.brix---header-nav-link:hover {
    border-bottom: 2px solid var(--bin-green);
    color: var(--white);
    border-radius: 0;
    padding-bottom: 3px
}  
  
  .blur-me{
   background: hsla(0, 0%, 85%, 0);
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    height: 8rem;
                    z-index: -1;
                    inset: 0;
                    backdrop-filter: blur(10px);
                    -webkit-backdrop-filter: blur(10px);
                    /* Safari specific */
                    /* Masking effect */
                    mask-image: linear-gradient(#000 50%, rgba(0, 0, 0, 0.8) 70%, transparent);
                    -webkit-mask-image: linear-gradient(#000 50%, rgba(0, 0, 0, 0.8) 70%, transparent);

  }  

</style><script type="2705f2bd1122591e3507ea2c-text/javascript">

myElement = $('#xz-backdoor');

const url = window.location.href;
const find = 'z-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor';
const found = url.match(find);


if(found !== null && found[0] === find){
  myElement.show();
} else {
  myElement.hide();
}
</script>
<script type="2705f2bd1122591e3507ea2c-text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var modal = document.getElementById("modal");
  var modalImg = document.getElementById("modal-img");
  var modalCaption = document.getElementById("modal-caption"); // Reference to the caption container
  var closeBtn = document.getElementById("close");

  // Function to open modal with clicked image and caption
  function openModal(imgSrc, captionText) {
    modalImg.src = imgSrc;
    modalCaption.textContent = captionText; // Set the caption text
    modal.style.display = "flex";
    document.body.classList.add('modal-open');
  }

  // Function to close modal
  function closeModal() {
    modal.style.display = "none";
    document.body.classList.remove('modal-open');
  }

  // Event listener to open modal when image is clicked
  document.querySelectorAll('.w-richtext-figure-type-image').forEach(function(figure) {
    var img = figure.querySelector('img');
    var caption = figure.querySelector('figcaption');
    img.addEventListener('click', function() {
      var imgSrc = img.getAttribute('src'); // Get the image source URL
      var captionText = caption ? caption.innerText : ''; // Get the caption text
      openModal(imgSrc, captionText);
    });
  });

  // Event listener to close modal when clicked outside of image or on the modal image
  modal.addEventListener('click', function(event) {
    if (event.target === modal || event.target === closeBtn || event.target === modalImg) {
      closeModal();
    }
  });

  // Optional: Close modal when pressing Esc key
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      closeModal();
    }
  });
});
</script><script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="2705f2bd1122591e3507ea2c-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"924a6640582ecf27","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"4ed51bc85b8047f4bfebfdaadd2d529f","b":1}' crossorigin="anonymous"></script>
</body></html>