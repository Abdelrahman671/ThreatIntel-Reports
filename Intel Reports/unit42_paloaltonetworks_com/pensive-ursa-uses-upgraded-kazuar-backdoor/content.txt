<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/pensive-ursa-uses-upgraded-kazuar-backdoor/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Over the Kazuar’s Nest: Cracking Down on a Freshly Hatched Backdoor Used by Pensive Ursa (Aka Turla)</title>
	<meta name="description" content="We examine a variant of the .NET backdoor Kazuar used by Pensive Ursa. This includes previously undocumented features from system profiling to injection modes." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Over the Kazuar’s Nest: Cracking Down on a Freshly Hatched Backdoor Used by Pensive Ursa (Aka Turla)" />
	<meta property="og:description" content="We examine a variant of the .NET backdoor Kazuar used by Pensive Ursa. This includes previously undocumented features from system profiling to injection modes." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2023-10-31T13:00:42+00:00" />
	<meta property="article:modified_time" content="2024-06-07T18:50:11+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/PA-Pensive-Ursa-Centre.jpg" />
	<meta property="og:image:width" content="1600" />
	<meta property="og:image:height" content="919" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Daniel Frank, Tom Fakterman" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Over the Kazuar’s Nest: Cracking Down on a Freshly Hatched Backdoor Used by Pensive Ursa (Aka Turla) Comments Feed" href="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:pensive-ursa-uses-upgraded-kazuar-backdoor";
webData.pageURL = "https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor";
webData.article_title = "Over the Kazuar’s Nest: Cracking Down on a Freshly Hatched Backdoor Used by Pensive Ursa (Aka Turla)";
webData.author = "Daniel Frank,Tom Fakterman";
webData.published_time = "2023-10-31T06:00:42-07:00";
webData.description = "We examine a variant of the .NET backdoor Kazuar used by Pensive Ursa. This includes previously undocumented features from system profiling to injection modes.";
webData.keywords = "Malware,Nation-State Cyberattacks,Threat Actor Groups,Threat Research,Advanced Persistent Threat,backdoor,Kazuar,Pensive Ursa,Turla,Uroburos";
webData.resourceAssetID = "b5a36591f5461f29048be4728fa6e536";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="14"/>
<meta property="og:readtime" content="20"/>
<meta property="og:views" content="9,114"/>
<meta property="og:date_created" content="October 31, 2023 at 6:00 AM"/>
<meta property="og:post_length" content="5607"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Nation-State Cyberattacks"/>
<meta property="og:category" content="Threat Actor Groups"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/nation-state-cyberattacks/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-actor-groups/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Daniel Frank"/>
<meta property="og:author" content="Tom Fakterman"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="Advanced Persistent Threat,backdoor,Kazuar,Pensive Ursa,Turla,Uroburos"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/PA-Pensive-Ursa-Centre.jpg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Over the Kazuar\u2019s Nest: Cracking Down on a Freshly Hatched Backdoor Used by Pensive Ursa (Aka Turla)","name":"Over the Kazuar\u2019s Nest: Cracking Down on a Freshly Hatched Backdoor Used by Pensive Ursa (Aka Turla)","description":"We examine a variant of the .NET backdoor Kazuar used by Pensive Ursa. This includes previously undocumented features from system profiling to injection modes.","url":"https:\/\/unit42.paloaltonetworks.com\/pensive-ursa-uses-upgraded-kazuar-backdoor\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/pensive-ursa-uses-upgraded-kazuar-backdoor\/","datePublished":"October 31, 2023","articleBody":"Executive Summary\r\nWhile tracking the evolution of Pensive Ursa (aka Turla, Uroburos), Unit 42 researchers came across a new, upgraded variant of Kazuar. Not only is Kazuar another name for the enormous and dangerous cassowary bird, Kazuar is an advanced and stealthy .NET backdoor that Pensive Ursa usually uses as a second stage payload.\r\n\r\nPensive Ursa is a Russian-based threat group operating since at least 2004, which is linked to the Russian Federal Security Service (FSB).\r\n\r\nThe Ukrainian CERT reported in July 2023 that this version of Kazuar was targeting the Ukrainian defense sector. The threat group behind this variant was going after sensitive assets such as those found in Signal messages, source control and cloud platforms data.\r\n\r\nSince Unit 42\u2019s discovery of Kazuar in 2017, we have seen it in the wild only a handful of times, targeting mostly organizations in the European government and military sectors. The Sunburst backdoor has been tied to Kazuar by code resemblance, which demonstrates its complexity level. Since late 2020, we had not seen new Kazuar samples in the wild \u2013 yet reports suggested Kazuar was under constant development.\r\n\r\nAs the code of the upgraded revision of Kazuar reveals, the authors put special emphasis on Kazuar\u2019s ability to operate in stealth, evade detection and thwart analysis efforts. They do so using a variety of advanced anti-analysis techniques and by protecting the malware code with effective encryption and obfuscation practices.\r\n\r\nThis article provides a deep technical analysis of Kazuar\u2019s capabilities. We are sharing this research to provide detection, prevention and hunting recommendations to help organizations strengthen their overall security posture. An additional list of artifacts will be provided in an appendix linked to our GitHub page.\r\n\r\nPalo Alto Networks customers receive protections from and mitigations for the threats mentioned in this article in the following ways:\r\n\r\n \tNext-Generation Firewall with the Advanced Threat Prevention security subscription can help block the malware C2 traffic\r\n \tOrganizations can engage the Unit 42 Incident Response team for specific assistance with this threat and others\r\n \tThe Cortex XDR and XSIAM platform detects and prevents the threats mentioned in this article\r\n \tThe Advanced WildFire machine-learning models and analysis techniques have been reviewed and updated in light of this new Kazuar variant.\r\n\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nBackdoors, Pensive Ursa\r\n\r\n\r\n\r\nKazuar Overview\r\nKazuar is known for being an advanced and stealthy .NET backdoor that Pensive Ursa usually uses as a second stage payload, delivered together with other tools that the threat group commonly uses.\r\n\r\nThe recent campaign that the Ukrainian CERT reported unveiled the multi-staged delivery mechanism of Kazuar, together with other tools such as the new Capibar first-stage backdoor. Our technical analysis of this recent variant \u2013 seen in the wild after years of hiatus \u2013 showed significant improvements to its code structure and functionality.\r\n\r\nThis post will detail previously undocumented features, including:\r\n\r\n \tComprehensive system profiling - Extensive data collection.\r\n \tCredential theft of cloud and other sensitive applications - Theft of cloud application accounts, source control and Signal messaging application.\r\n \tExtended set of commands - A total of 45 supported commands to execute, received from another Kazuar node or the command and control (C2) server.\r\n \tEnhanced task automation - A range of automated tasks that the attacker could turn on\/off.\r\n \tVariable encryption schemes - Implementation of different encryption algorithms and schemes.\r\n \tInjection modes - Multiple injection modes, allowing Kazuar to run from different processes and execute different features.\r\n\r\nSince at least 2018, variants of Kazuar changed their obfuscation methods and methodically modified its compilation timestamps. Some variants used the ConfuserEx obfuscator to encrypt strings, and others used a custom method. In the Kazuar variant analyzed in this blog, the authors went a step further, implementing multiple custom methods for string encryption.\r\n\r\nUnlike with previous variants, the authors only focused on targeting the Windows operating system.\r\n\r\nClarification note: While analyzing Kazuar\u2019s code, we used dnSpy to export the code into an integrated development environment (IDE) and decrypted the strings using a custom script. This allowed us to edit separate .cs files and edit some of the method names into meaningful ones. We have interpreted the method names that appear in the screenshots.\r\nLatest Kazuar Variant Detailed Technical Analysis\r\nMetadata\r\nReports from other research organizations have shown that the authors of Kazuar have manipulated their samples\u2019 timestamps since at least 2018. This new variant\u2019s compilation timestamp is Thursday, November 20, 2008 10:11:18 AM GMT. Unlike other publicly available variants, this is the first time the authors went back as far as 2008 when faking the timestamp.\r\n\r\nKazuar also contains hard-coded, hashed identifiers for the Agent version and BuildID as well as an Agent label. These can be used as variant identifiers, as shown in Figure 1.\r\n\r\n[caption id=\"attachment_130893\" align=\"aligncenter\" width=\"594\"] Figure 1. Kazuar\u2019s sample basic configuration information.[\/caption]\r\nInitialization\r\nExecuting Assembly Check\r\nWhen executing Kazuar, it uses the Assembly.Location property to receive its own file path and check its name. Kazuar will continue execution only if the returned value is an empty string, as shown in Figure 2. The Assembly.Location property returns an empty string when loading the file from a byte array.\r\n\r\nThis check appears to be a simple form of an anti-analysis mechanism, to ensure that the execution of the malware was done by the intended loader and not by other means or software.\r\n\r\nKazuar will execute if its filename matches a specific hard-coded hashed name (using the FNV algorithm). This behavior is probably meant for debugging purposes, letting the authors avoid using the loader each time they debug the malware.\r\n\r\n[caption id=\"attachment_130895\" align=\"aligncenter\" width=\"634\"] Figure 2. Checking the Kazuar variant\u2019s assembly name.[\/caption]\r\nOperational Root Directory Creation\r\nKazuar creates a new directory to store its configuration and log data. It uses %localappdata% as the main storage path and determines its root directory from a list of hard-coded paths (See Appendix).\r\n\r\nKazuar chooses which root directory, folder names, filenames and file extensions to use based on the machine globally unique identifier (GUID), as shown in Figure 3. Although these names might seem randomly generated at a first glance, the usage of the GUID means they will keep the same name for each execution of the malware on the same infected machine.\r\n\r\n[caption id=\"attachment_130897\" align=\"aligncenter\" width=\"460\"] Figure 3. The method in charge of returning an index for the paths array.[\/caption]\r\n\r\nLike in previous variants, Kazuar uses a structured directory scheme to save its log files and other data such as individual configuration files and keylogger data. Directory naming is pseudorandom and chosen based on hashing. Examples include the custom implementation of the FNV hashing algorithm seen in previous variants, and other manipulations on the GUID value. You can find a list of the directories in their plaintext names in the Appendix.\r\n\r\nIt is also worth mentioning that there is a currently unreferenced option to create a file called wordlist in the code. This file could give us a clue about a feature not yet implemented, perhaps using a wordlist for directories, filenames or password brute forcing.\r\nConfiguration Files\r\nThe malware creates a separate main configuration file that includes data including the following:\r\n\r\n \tC2 servers\r\n \tInjection mode\r\n \tOther operational configuration data\r\n\r\nFigure 4 shows a snippet from this file below. You can find the encryption methods for Kazuar\u2019s configuration files in the Appendix.\r\n\r\n[caption id=\"attachment_130899\" align=\"aligncenter\" width=\"900\"] Figure 4. Snippet of the configuration file.[\/caption]\r\nMutex Name Generation\r\nKazuar is using a mutex to check its injection into another process. Kazuar generates its mutex name by XORing the current process ID with the hard-coded value 0x4ac882d887106b7d and then XORing it with the machine's GUID, as depicted in Figure 5. This means that several Kazuars can operate in tandem on the same device, just not injected into the same process.\r\n\r\n[caption id=\"attachment_130901\" align=\"aligncenter\" width=\"490\"] Figure 5. Mutex name generation.[\/caption]\r\nArchitecture\r\nSetting Kazuar\u2019s Injection Modes\r\nThe new version of Kazuar uses what it describes in the configuration as \u201cinjection modes\u201d as shown in Table 1. The default mode is inject.\r\n\r\n\r\n\r\nConfiguration file mode name\r\nDescription\r\nInbound traffic\r\nOutbound traffic\r\nAdditional functionality threads\r\n\r\n\r\ninject\r\n\r\n\r\n \tDefault mode, injects into explorer.exe\r\n \tCreates a pipe communication channel and serves as a proxy for other Kazuar instances\r\n\r\n\r\nNamed pipe\r\nNamed pipe\r\n\r\n\r\n \tEvent Log Monitor\r\n \tKeylogging\r\n \tPeeps\r\n \tAutomated tasks\r\n \tAnti-Dumping\r\n\r\n\r\n\r\n\r\nzombify\r\n\r\n\r\n \tInjects into the user\u2019s default browser or svchost.exe\r\n \tCreates a named pipe communication channel and serves as a proxy for other Kazuar instances\r\n\r\n\r\nNamed pipe\r\nHTTP\r\n\r\n\r\n \tAnti-Dumping\r\n\r\n\r\n\r\n\r\ncombined\r\nIn case the default inject method fails, it executes via the same method as zombify\r\nN\/A\r\nN\/A\r\nN\/A\r\n\r\n\r\nremote\r\nCreates a named pipe communication channel and serves as a proxy for other Kazuar instances, no C2 communication\r\nNamed pipe\r\nNamed pipe\r\n\r\n\r\n \tEvent Log Monitor\r\n \tAutomated tasks\r\n\r\n\r\n\r\n\r\nsingle\r\n\r\n\r\n \tCreates a named pipe communication channel and serves as a proxy for other Kazuar instances\r\n \tThis mode enables C2 communication to receive commands via HTTP\r\n\r\n\r\nNamed pipe or HTTP\r\nNamed pipe or HTTP\r\n\r\n\r\n \tEvent Log Monitor\r\n \tKeylogging\r\n \tPeeps\r\n \tAutomated tasks\r\n\r\n\r\n\r\n\r\nNot in User Interactive Mode\r\nIn case Kazuar\u2019s execution is in a user interactive mode, which could occur when executing Kazuar as a service or on a machine with no GUI such as a server.\r\nNamed pipe\r\nNamed pipe\r\n\r\n\r\n \tAutomated tasks\r\n \tWMI consumer\r\n \tAnti-Dumping\r\n\r\n\r\n\r\n\r\n\r\nTable 1. Kazuar injection modes and descriptions.\r\nIn zombify mode, Kazuar is injected into the user\u2019s default browser and has a fallback mechanism to inject itself to svchost.exe in case the query for the default browser fails. Figure 6 shows that the term zombify addresses process injection in general by Kazuar\u2019s authors.\r\n\r\n[caption id=\"attachment_130903\" align=\"aligncenter\" width=\"900\"] Figure 6. A snippet of Kazuars\u2019 code injection in zombify mode.[\/caption]\r\nMultithreading Model\r\nKazuar operates in a multithreading model, while each of Kazuar\u2019s main functionalities operates as its own thread. In other words, one thread handles receiving commands or tasks from its C2, while a solver thread handles execution of these commands. This multithreading model enables Kazuar\u2019s authors to establish an asynchronous and modular flow control. Figure 7 shows the task solver flow.\r\n\r\n[caption id=\"attachment_130905\" align=\"aligncenter\" width=\"849\"] Figure 7. Kazuar\u2019s task-solving mechanism diagram.[\/caption]\r\nThe Task Solver Component - Kazuar\u2019s Puppeteer\r\nKazuar receives new tasks, solves them and writes the output into result files. A solver thread is handling new tasks received from the C2 servers or another Kazuar node. The task content is then encrypted and written to disk into a task file.\r\n\r\nEach task file implements a hybrid encryption scheme:\r\n\r\n \tUsing RNGCryptoServiceProvider to generate two byte-arrays containing random numbers, which are 16 and 32 bytes long respectively.\r\n\r\n \tUsing the first array as an AES (Rijndael) initialization vector (IV).\r\n \tUsing the second array as an AES key.\r\n\r\n\r\n \tGenerating an HMACMD5 hash based on the result\u2019s content from memory, prior to its encryption and writing to disk, using the array described in the first bullet above as the key.\r\n \tEncrypting the HMACMD5 hash, AES key and IV with the hard-coded RSA key, and writing the encrypted BLOB to the beginning of the file. By using the fast AES algorithm to encrypt larger objects such as the result\u2019s contents, and using the slower RSA encryption to conceal the AES key and IV, Kazuar improves its performance. This also disables the option of recovering infected files only from disk, since the symmetric key is encrypted using an asymmetric key.\r\n \tUsing the AES encryption to encrypt the result file\u2019s contents.\r\n\r\nAs shown in Figure 8, once a task is complete, the generated result file will be saved to disk.\r\n\r\n[caption id=\"attachment_130907\" align=\"aligncenter\" width=\"900\"] Figure 8. A snippet of Kazuar\u2019s method to encrypt and write a result file.[\/caption]\r\n\r\nIn addition to the aforementioned encrypted data, Kazuar writes the following fields to the beginning of the result file:\r\n\r\n \tFour zero bytes (we believe this serves as a sort of a delimiter)\r\n \tGenerated result identifier\r\n \tLength of the encrypted GUID, using the same XOR algorithm as in the initialization part (the encrypted message here is \u201cSystem info at [datetime] (-07)\u201d)\r\n \tThe encrypted GUID itself\r\n \tRSA encrypted HMACMD5 hash + IV + AES key\r\n \tThe AES encrypted task content\r\n\r\nFigure 9 shows the encrypted result file content from disk.\r\n\r\n[caption id=\"attachment_130909\" align=\"aligncenter\" width=\"900\"] Figure 9. An encrypted result file content from disk.[\/caption]\r\nStrings Encryption\r\nKazuar\u2019s code includes a high volume of strings that are related to functionality and debugging. When revealed in plain text, they shed light on the inner workings and functionality of Kazuar. To avoid the scenario of researchers creating strings-based indicative YARA and hunting rules, Kazuar\u2019s strings are encrypted. It decrypts each string at runtime.\r\n\r\nKazuar uses a variation of a Caesar Cipher for the string encryption\/decryption algorithm. In this algorithm, Kazuar implements a dictionary that simply swaps the key and value of each member. Recent Kazuar variants implemented only one dictionary, while the new variant implements multiple dictionaries, each containing 80 pairs of characters as shown in Figure 10.\r\n\r\n[caption id=\"attachment_130911\" align=\"aligncenter\" width=\"316\"] Figure 10. One of the classes containing the dictionary used for string decryption.[\/caption]\r\n\r\nFigure 11 shows a loop iterating over a given string, and checking if the ordinal value of a given character is in the dictionary keys of the relevant class. If it is, Kazuar swaps the key and value and appends it to the crafted string. Otherwise, it keeps the original character.\r\n\r\nIn addition to the string obfuscation, the authors have given unmeaningful names to the classes and methods in the code, to make analysis more difficult.\r\n\r\n[caption id=\"attachment_130913\" align=\"aligncenter\" width=\"658\"] Figure 11. The loop that creates the deobfuscated string.[\/caption]\r\n\r\nOne of the strings decoded by Kazuar returns the value \u201cInvalid pong responce\u201d as shown in Figure 12. It seems that one of the malware coders forgot to switch the Russian C for an English S.\r\n\r\n[caption id=\"attachment_130915\" align=\"aligncenter\" width=\"387\"] Figure 12. The typo in the \u201cresponse\u201d string.[\/caption]\r\nCore Functionality\r\nIn a fashion typical to Pensive Ursa, to avoid takedowns, Kazuar uses hijacked legitimate websites for its C2 infrastructure. In addition, as mentioned in the Injection Modes section, Kazuar also supports communication over named pipes. It uses both mechanisms to receive remote commands, or tasks (as described in the code).\r\nSupported C2 Commands\r\nKazuar supports 45 different tasks it can receive from its C2, as shown in Table 2. This is yet another development in Kazuar\u2019s code, as previous research hadn\u2019t documented some of these tasks. By comparison, Kazuar\u2019s first variant analyzed back in 2017 supported only 26 C2 commands.\r\n\r\nWe have grouped Kazuar\u2019s commands into the following categories:\r\n\r\n \tHost data collection\r\n \tExtended forensic data collection\r\n \tFile manipulation\r\n \tArbitrary command execution\r\n \tInteraction with Kazuar\u2019s configuration\r\n \tRegistry querying and manipulation\r\n \tScripts execution (VBS, PowerShell, JavaScript)\r\n \tCustom network requests\r\n \tCredentials and sensitive information stealing\r\n\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\nsindex\r\nSearches for properties of files with the following extensions: .txt, .ini, .config, .vbs, .js, .ps1, .doc, .docx, .xls, .xlsx, .ppt, .pptx under folders in the C:\\Users\\ path.\r\n\r\n\r\nscrshot\r\nTakes a screenshot of the window of a specified process\r\n\r\n\r\nmove\r\nMoves a file from a source path to a destination path\r\n\r\n\r\ninfo\r\nGets system information about one or multiple of the fields (described in Appendix)\r\n\r\n\r\nsteal\r\nSteals data from various browsers and applications (full list ID in Appendix)\r\n\r\n\r\nrun\r\nExecutes a specified executable with supplied arguments, save the output to a temporary file, and upload the file to the C2 server.\r\n\r\n\r\nschlist\r\nGets data about scheduled tasks using the Schedule.Service COM object\r\n\r\n\r\nconfig\r\nUpdates Kazuar\u2019s configuration file\r\n\r\n\r\nnetuse\r\nConnects or removes network resources from the machine using the WNetAddConnection2 and WNetCancelConnection2 WinAPIs\r\n\r\n\r\nlog\r\nAdds a custom log to the log file\r\n\r\n\r\ndelegate\r\nSends a command to another Kazuar implant on a remote system using a PIPE\r\n\r\n\r\neventlog\r\nGets Windows Event log entries\r\n\r\n\r\nget\r\nUploads files from a specified directory to Kazuar\u2019s C2 servers, choosing which files to upload based on their modified, accessed and created timestamps.\r\n\r\n\r\nautoruns\r\nChecks various possibilities for software to have persistence in the infected machine (checks described in Appendix)\r\n\r\n\r\nput\r\nWrites received data to a specified file on the system.\r\n\r\n\r\nregwrite\r\nSets a registry key\/value.\r\n\r\n\r\nautoslist\r\nLists the number of files that were created under the Autos functionality\u00a0\r\n\r\n\r\nvbs\r\nExecutes a VBScript\r\n\r\n\r\npsh\r\nExecutes a PowerShell Script\r\n\r\n\r\nsleep\r\nSets Kazuar to sleep for a specified amount of time\r\n\r\n\r\nregdelete\r\nDeletes a registry key\/value\r\n\r\n\r\ntimelimit\r\nSets a time limit for a task from the server\r\n\r\n\r\ndlllist\r\nGets all loaded modules of a specified process\r\n\r\n\r\nautosget\r\nSends files created by the Autos functionality to the C2\r\n\r\n\r\nwmiquery\r\nExecutes a WMI Query\r\n\r\n\r\ndotnet\r\nExecutes a .NET method received from the C2\r\n\r\n\r\ntasklist\r\nGets a list of running processes\u00a0\r\n\r\n\r\nfind\r\nFinds a specified directory and lists its files. It appears the actor can specify which files to list based on their modified, accessed and created timestamps as well.\r\n\r\n\r\npeep\r\nExecutes a command related to the peeps functionality, which we have described in the peeps section.\r\n\r\n\r\nforensic\r\nChecks the system for multiple forensic artifacts (see Appendix)\r\n\r\n\r\nkill\r\nKills a process by name or by process identifier (PID)\r\n\r\n\r\nregquery\r\nQueries a registry key\r\n\r\n\r\nchakra\r\nExecutes Javascript using ChakraCore\u00a0\r\n\r\n\r\nhttp\r\nCreates a crafted HTTP request\r\n\r\n\r\npipelist\r\nGets open pipe list for a specific machine\r\n\r\n\r\njsc\r\nExecutes JavaScript\r\n\r\n\r\nwmicall\r\nCalls a WMI method\r\n\r\n\r\nautosdel\r\nDeletes files created by the Autos functionality\u00a0\r\n\r\n\r\ndel\r\nDeletes a specified file OR folder. Allows the attacker to supply a flag to securely delete a file by overwriting the file with random data before deleting it.\r\n\r\n\r\nnbts\r\nCrafts a NetBIOS request\r\n\r\n\r\ncopy\r\nCopies a specified file to a specified location. The attacker is able to overwrite the destination file if it already exists.\r\n\r\n\r\nupgrade\r\nDownloads an upgrade to the malware\r\n\r\n\r\ncmd\r\nExecutes a command via cmd.exe\r\n\r\n\r\nunattend\r\nSteals files related to various windows configuration or cloud applications credentials (full list of files is included in Appendix)\r\n\r\n\r\nautosclear\r\nClears the Autos log list of files\u00a0\r\n\r\n\r\n\r\nTable 2. Kazuar\u2019s supported C2 commands.\r\n\r\nCloud, Source Control and Messaging Apps Credential Theft\r\nKazuar has the capability to attempt to steal credentials from many artifacts in the infected computer, by receiving the commands steal or unattend from the C2.\r\n\r\nThese artifacts include multiple well-known cloud applications.\r\n\r\nKazuar can attempt to steal sensitive files that contain credentials for these applications. Artifacts targeted by Kazuar include Git SCM (a source control system that is popular among developers), as shown in Figure 13, and Signal (an encrypted messaging service for private instant messaging). We have included the full description of the artifacts in the Appendix.\r\n\r\n[caption id=\"attachment_130917\" align=\"aligncenter\" width=\"617\"] Figure 13. Code snippet of Git SCM credentials Kazuar may attempt to steal.[\/caption]\r\nComprehensive System Profiling\r\nWhen Kazuar is initially spawning a unique solver thread, the first task it automatically executes is the extensive collection and profiling of the targeted system, named by Kazuar\u2019s authors as first_systeminfo_do. As part of this task, Kazuar will collect extensive information about the infected machine and will send it to the C2. This includes information on the operating system, hardware and network. The Appendix includes the entirety of what the attackers collected.\r\n\r\nKazuar saves this data into an info.txt file and saves the execution logs to a logs.txt file. As mentioned in the Task Solver section, we can see the result in memory. In this case, it\u2019s an archive, as depicted in Figure 14.\r\n\r\n[caption id=\"attachment_130919\" align=\"aligncenter\" width=\"900\"] Figure 14. The result of the first_systeminfo_do archive in memory.[\/caption]\r\n\r\nBesides the two aforementioned text files, as part of this task, the malware takes a screenshot of the user\u2019s screen. Figure 15 shows the zipping of all of these files into one archive before being encrypted and sent to the C2.\r\n\r\n[caption id=\"attachment_130921\" align=\"aligncenter\" width=\"663\"] Figure 15. The result of the first_systeminfo_do archive extracted memory, prior to encryption.[\/caption]\r\nCreating Automated Tasks (Autos)\r\nKazuar has the ability to set up automated tasks that will run at specified intervals to gather information from the infected machines. Figure 16 shows an example of this functionality as documented in Kazuar\u2019s configuration.\r\n\r\nThese automated tasks include the following:\r\n\r\n \tGathering system information (described in the section on Comprehensive System Profiling)\r\n \tTaking screenshots\r\n \tStealing credentials (listed in full in the Appendix)\r\n \tGetting forensics data (see Appendix)\r\n \tGetting auto-runs data (see Appendix)\r\n \tGetting files from specified folders.\r\n \tGetting a list of LNK files\r\n \tStealing emails using MAPI\r\n\r\n[caption id=\"attachment_130923\" align=\"aligncenter\" width=\"354\"] Figure 16. A snippet of Kazuar\u2019s configuration of the Autos function.[\/caption]\r\nMonitoring Active Windows (Peeps)\r\nKazuar has the ability to let attackers set up what they called \u201cpeep rules\u201d in the configuration. Although Kazuar does not come with these rules set out of the box, according to the malware\u2019s code, it appears that this functionality enables the attacker to monitor the windows of specified processes. This allows the attacker to track user activity of interest on the compromised machine.\r\nCommunication With the Command and Control\r\nHTTP\r\nPrior to establishing a communication channel with a C2 server, and in addition to the aforementioned anti-analysis checks, Kazuar checks the configuration data-sending time intervals. This check includes determining whether it should send data over the weekend or not.\r\n\r\nUpon first communication, Kazuar sends the collected data (described in the Comprehensive System Profiling section) in an XML format and expects to get an XML structured response back with a new task. Figure 17 shows the HTTP request.\r\n\r\nKazuar uses a hard-coded value 169739e7-2112-9514-6a61-d300c0fef02d casted to a string and Base64 encoded as the cookie.\r\n\r\n[caption id=\"attachment_130925\" align=\"aligncenter\" width=\"765\"] Figure 17. HTTP POST command with an XML in the body sent to the C2.[\/caption]\r\n\r\nKazuar generates key names for the XML and Base64 encrypts the content prior to sending it to the C2. The content of the XML contains:\r\n\r\n \tEncrypted content of the result file\r\n \tResult identifier\r\n \tPseudorandom 4-byte numbers, probably another type of identifier\r\n \tAn array with values pseudorandomly generated based on the machine\u2019s GUID\r\n \tThe hard-coded GUID connection string 169739e7-2112-9514-6a61-d300c0fef02d\r\n \tThe machine\u2019s unique GUID\r\n\r\nCommunication Using Named Pipes\r\nIn addition to direct HTTP communication with the C2, Kazuar has the ability to function as a proxy, to receive and send commands to other Kazuar agents in the infected network. It is doing this proxy communication via named pipes, generating their names based on the machine\u2019s GUID.\r\n\r\nKazuar uses these pipes to establish peer-to-peer communication between different Kazuar instances, configuring each as a server or a client. The named pipe communication supports the remote requests shown in Table 3.\r\n\r\n\r\n\r\nRemote Request\r\nKazuar\u2019s Response\r\nDescription\r\n\r\n\r\nPING\r\nPONG\r\nReturn a message with the current instance process information\r\n\r\n\r\nTASK\r\nRESULT\r\nStart a received task and return a result\r\n\r\n\r\nLOGS\r\nERROR\r\nRetrieve error logs\r\n\r\n\r\n\r\nTable 3. Kazuar requests and responses using named pipes.\r\n\r\nAnti-Analysis Checks\r\nKazuar uses multiple anti-analysis techniques based on a series of elaborate checks, to ensure it is not being analyzed. The authors programmed Kazuar to either continue if the coast is clear, or to remain idle and cease all C2 communication if it is being debugged or analyzed. We can group these checks into three main categories: honeypot, analysis tools and sandbox.\r\nAnti-Dumping\r\nBecause Kazuar is not designed to run as a standalone process but rather lives injected within another process, dumping its code is possible from memory of the injected process. To prevent that from happening, Kazuar uses a powerful feature of .NET, which is the System.Reflection Namespace. This gives Kazuar the ability to gather real-time metadata about its assembly, methods and more.\r\n\r\nKazuar checks if it has set the antidump_methods setting to true, then overrides the pointers to its custom methods, while ignoring generic .NET methods, essentially wiping them from memory (as Kazuar\u2019s logged message states). This ultimately prevents researchers from dumping an intact version of the malware.\r\nHoneypot Check\r\nOne of the first things Kazuar specifically searches for is the existence of Kaspersky honeypot artifacts on the machine. It uses a hard-coded list of specific process names and filenames to do this.\r\n\r\nIf Kazuar finds more than five of these files or processes, it will log that it found a Kaspersky honeypot. Figure 18 shows these filenames.\r\n\r\n[caption id=\"attachment_130927\" align=\"aligncenter\" width=\"900\"] Figure 18. Filenames that Kazuar checks to find Kaspersky honeypot.[\/caption]\r\nAnalysis Tools Check\r\nKazuar has a list of hard-coded names of different popular analysis tools such as the following:\r\n\r\n \tProcess Monitor\r\n \tX32dbg\r\n \tDnSpy\r\n \tWireshark\r\n\r\nIt goes over the list of running processes, and if one of these tools is running, Kazuar will log that it found analysis tools (see Appendix).\r\nSandbox Check\r\nKazuar has a list of hard-coded known sandbox libraries. It checks for the presence of certain DLLs that belong to different sandbox services. If the malware finds these files, it determines that it is being executed in a lab (see Appendix).\r\nEvent Log Monitor\r\nKazuar collects and parses events from the Windows event logs. Figure 19 shows Kazuar specifically looking for events from the following antivirus\/security vendors:\r\n\r\n \tKaspersky Endpoint Security\r\n \tSymantec Endpoint Protection Client\r\n \tMicrosoft Windows Defender\r\n \tDoctor Web\r\n\r\nSame as with checking for Kaspersky\u2019s honeypot, a plausible explanation would be that these security products are popular with their victims.\r\n\r\n[caption id=\"attachment_130929\" align=\"aligncenter\" width=\"560\"] Figure 19. Event logs that Kazuar collects from specific security products.[\/caption]\r\nStrengthening Kazuar\u2019s Connection to Pensive Ursa\r\nAs mentioned above, when composing its initial HTTP POST request to its C2, Kazuar uses the machines GUID or a hard-coded GUID 169739e7-2112-9514-6a61-d300c0fef02d as a cookie, which is then type casted to string and Base64 encoded.\r\n\r\nSearching the latter value in its string format (169739e7211295146a61d300c0fef02d) yields a report [PDF] by the Swiss CERT, which analyzes an attack carried out by Pensive Ursa against RUAG. RUAG Holding is a Swiss company from the aerospace and defense sector.\r\n\r\nIn addition, Kazuar\u2019s tasks and results architecture, including the hybrid AES + RSA encryption scheme and other clear similarities in functionality, are the very image of Carbon\u2019s modus operandi. It is mentioned both in the Swiss\u2019s CERT report and another report by ESET. Carbon is another second stage backdoor that was attributed multiple times to Pensive Ursa, whose code was a fork of Snake, as mentioned by CISA.\r\n\r\nThese findings, along with the reports by multiple CERTs, further support the previous Unit 42 assumptions proposing that Kazuar might be Carbon\u2019s successor. Most importantly, these findings strengthen the attribution of Kazuar to Pensive Ursa.\r\nConclusion\r\nWe examined the newest Kazuar malware variant that we detected in the wild. Notable features include the following:\r\n\r\n \tRobust code and string obfuscation techniques\r\n \tA multithreaded model for enhanced performance\r\n \tA range of encryption schemes implemented to safeguard Kazuar\u2019s code from analysis and to conceal its data whether in memory, during transmission or on disk\r\n\r\nAll the aforementioned features are designed to provide the Kazuar backdoor a high level of stealth. Other noteworthy characteristics of this malware are:\r\n\r\n \tIts anti-analysis functionalities\r\n \tExtensive system profiling capabilities\r\n \tThe specific targeting of cloud applications\r\n\r\nThis version of Kazuar also supports an array of over 40 distinct commands, half of which were previously undocumented.\r\n\r\nWe encourage security practitioners and defenders to study this report and use the information provided to enhance current detection, prevention and hunting practices to overall strengthen their security posture.\r\nCortex XDR Detection and Prevention\r\nFigure 20 shows Cortex XDR detected and prevented the execution of Kazuar. As detailed in the technical analysis section, by default Kazuar injects its code into explorer.exe. When configured to operate on detect mode, Cortex XDR detects the malicious activity originating from the injected explorer.exe, as depicted in Figure 20 below.\r\n\r\n[caption id=\"attachment_130931\" align=\"aligncenter\" width=\"437\"] Figure 20. Kazuar\u2019s detection, shown in Cortex XDR in detect mode.[\/caption]\r\n\r\nExecution of native code by Kazuar for process injection and WMI execution triggered several alerts, as well as other suspicious and uncharacteristic activity carried out by explorer.exe. We detailed the alerts, including the alert shown in Figure 20, in Figure 21 below.\r\n\r\n[caption id=\"attachment_130933\" align=\"aligncenter\" width=\"900\"] Figure 21. Kazuar\u2019s execution alerts, shown in Cortex XDR in detect mode.[\/caption]\r\n\r\nIn addition, Figure 22 documents and details the directory and files that the malware created to store its configuration and logs.\r\n\r\n[caption id=\"attachment_130935\" align=\"aligncenter\" width=\"836\"] Figure 22. Kazuar\u2019s execution alerts as seen in Cortex XDR on detect mode.[\/caption]\r\n\r\nFinally, Figure 23 shows that when in prevent mode, Cortex XDR prevents the Kazuar malware executable and triggers the alert pop-up accordingly.\r\n\r\n[caption id=\"attachment_130937\" align=\"aligncenter\" width=\"531\"] Figure 23. Kazuar\u2019s execution prevention alert as seen in Cortex XDR on prevent mode.[\/caption]\r\nProtections and Mitigations\r\nThe Cortex XDR platform detects and prevents the execution flow described in the screenshots included in the previous section.\r\n\r\nIn addition to the classic detection, the unique SmartScore engine translates security investigation methods and their associated data into a ML-driven hybrid risk scoring system. Figure 24 shows that the Kazuar variant and its related incident detailed in this blog scored 97 out of 100 by SmartScore.\r\n\r\n[caption id=\"attachment_130939\" align=\"aligncenter\" width=\"537\"] Figure 24. The score given to Kazuar in SmartScore.[\/caption]\r\n\r\nFor Palo Alto Networks customers, our products and services provide the following coverage associated with this group.\r\n\r\nCortex XDR and XSIAM detect user and credential-based threats by analyzing user activity from multiple data sources including the following:\r\n\r\n \tEndpoints\r\n \tNetwork firewalls\r\n \tActive Directory\r\n \tIdentity and access management solutions\r\n \tCloud workloads\r\n\r\nCortex XDR and XSIAM build behavioral profiles of user activity over time with machine learning. By comparing new activity to past activity, peer activity and the expected behavior of the entity, Cortex XDR and XSIAM detect anomalous activity indicative of credential-based attacks.\r\n\r\nIt also offers the following protections related to the attacks discussed in this post:\r\n\r\n \tPrevents the execution of known malicious malware and also prevents the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module\r\n \tProtects against credential gathering tools and techniques using the new Credential Gathering Protection available from Cortex XDR 3.4\r\n \tProtects against exploitation of different vulnerabilities including ProxyShell and ProxyLogon using the Anti-Exploitation modules as well as Behavioral Threat Protection\r\n \tCortex XDR Pro and XSIAM detect postexploit activity, including credential-based attacks, with behavioral analytics\r\n \tNext-Generation Firewall with the Advanced Threat Prevention security subscription can help block the malware C2 traffic via the following Threat Prevention signature: 86805.\r\n \tThe Advanced WildFire machine-learning models and analysis techniques have been reviewed and updated in light of this new Kazuar variant. Multiple products in the Palo Alto Networks portfolio leverage Advanced WildFire to provide coverage against Kazuar variants and other threats.\r\n\r\nIf you think you might have been impacted or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\r\n\r\n \tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\r\n \tEMEA: +31.20.299.3130\r\n \tAPAC: +65.6983.8730\r\n \tJapan: +81.50.1790.0200\r\n\r\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the Cyber Threat Alliance.\r\nIndicators of Compromise\r\nKazuar SHA256\r\n\r\n \t91dc8593ee573f3a07e9356e65e06aed58d8e74258313e3414a7de278b3b5233\r\n\r\nCommand and Control Servers\r\n\r\n \thxxps:\/\/www.pierreagencement[.]fr\/wp-content\/languages\/index.php\r\n \thxxps:\/\/sansaispa[.]com\/wp-includes\/images\/gallery\/\r\n \thxxps:\/\/octoberoctopus.co[.]za\/wp-includes\/sitemaps\/web\/\r\n\r\nRSA Keys\r\n\r\n \t&lt;RSAKeyValue&gt;&lt;Modulus&gt;7ondEZo8ZjYh+FP4h3PgJBU\/yTlO+g8ZbCF0wx8eocnqxLS4YWI9hG3SI2hlEBz6J4vvxPCrs\/jazekolaZLQnbyOCyH53I+We+x32d2lUlXrtZA\/0oJa39tW2t2NsUG\/xPqsY3rBCuhi28hl30XH8Arn2\/u9Jxl1G9dNxFDdVxk9ePjlHecdAtWCa9vmC4HY0Wlqyhd0+hJfvKCoKLsHuCyl4b\/c343VVVTFubYNSFJMQnpIKsYQDRKtRszQuS1Ls+obyOr+0cbAmnKb8twTsq862pA6MzxRr16\/4\/1nyrNKuDS+OvPfv3tgvssybtGwN8D8Qac7O1FM722Nft16iis9WaoFuXCwP\/LCkaetQMjEKN07H6ESHMnUc+JDvINIspAAKK8fRwtTcWKrG2bh\/Dwtneq\/9L1Pv2cKtpQAUlxVfQX5I\/mtATEHIMcPOvNWRUqmSssDHEJiZDFKS45SjoG4qXs536xwbZ4k6lmHUUOVzkmCc71HooxRdSYx1M7Vqvou1Mi39O6vJouL2aTO6ymbGdnerKavDsgBSa2HKRbP2Nym6Ud4WAhiaqnPCWGnJz7l+4Hs++OcG2p+Ct1oXRecLK6Zy\/n9moTZeijLdqJwUh90Bht8V8STz\/vNtrhz++Do6DsDssENkOHXeUeRCqCmDdS3sqkxQnGAG3tGvc=&lt;\/Modulus&gt;&lt;Exponent&gt;AQAB&lt;\/Exponent&gt;&lt;\/RSAKeyValue&gt;\r\n \t&lt;RSAKeyValue&gt;&lt;Modulus&gt;pyR0\/srVS0gOZbNdK3iK+GvekQVkBq8brOVCuN\/XcCz4WLJod9GhivDYrDtMXF6ZMGHKa2zAcQ+v2vltYW3X2BYCZ1sblEznfIk+oHs+lesblfHVyPPXDcTLLf5IUuGE\/dzeSpLhlWiFT\/4MyeMLzU8QexpRkBn0qJkk5xWU0D09DN0SaNzA8E4grU61aaul5iNRYMO+qLXmtIJhrjUrnHNu7ZnZ+AQtc19Dhne1hciH4aj00HRLXsofWGWsELEhZv92cnQ0Rf9n00EGB591zDR8gAt3T5sSTQvjMGWOBHusfGV4ytmchmQWZ8QY7Fp4EPgn8vM48OR2z13qo4YSediAt9Af+YKGoPu2PU3szx08UwBZRz4cyYZB3zcFB8NxCx7Gki2rS5bYx1Z1cG\/kU+Ri2gXYoCHgOz8umr+PDB+21V1pnmStxzWAdR7mK0e663LMxxAcZWjEArbt\/BcIiZAkFsyoq+NJbuKTR2RYAW+4DXbxFQeGKnFBgle3u9ktcYXWqgJ8\/rvs920rGf9k3br3I+2MtzrWglhRi\/WkAmTrEIL4i1id0M0askl0YBHlzU9+Bgv2y\/VsLH2UKQlp+owxGm1jequxwGpZfwxmWAMATe8L2qctVdXEOfT7Ue67AsVjkP\/VmhbhGDO8zt38trylUhWnpUeYdkigg9Nxs1k=&lt;\/Modulus&gt;&lt;Exponent&gt;AQAB&lt;\/Exponent&gt;&lt;\/RSAKeyValue&gt;\r\n\r\nAdditional References\r\n\r\n \tTargeted Turla attacks (UAC-0024, UAC-0003) using CAPIBAR and KAZUAR malware [English version] \u2013 CERT-UA (Ukraine)\r\n \tKazuar: Multiplatform Espionage Backdoor with API Access \u2013 Unit 42, Palo Alto Networks\r\n \tResearchers Find Links Between Sunburst and Russian Kazuar Malware \u2013 The Hacker News\r\n \tNation-state Turla resurfaces with a Sophisticated RAT \u2013 Cyberint (PDF)\r\n \tGuid Struct (System) \u2013 Microsoft Learn\r\n \tTechnical Report about the Malware used in the Cyberespionage against RUAG \u2013 Swiss GovCERT\r\n \tTurla renews its arsenal with Topinambour \u2013 Securelist, Kaspersky\r\n \tHunting Russian Intelligence \u201cSnake\u201d Malware \u2013 Cybersecurity Advisory, CISA\r\n \tIndicator Removal: Timestomp, Sub-technique T1070.006 - Enterprise \u2013 MITRE ATT&amp;CK\r\n \tSwallowing the Snake\u2019s Tail: Tracking Turla Infrastructure \u2013 Recorded Future\r\n \tCarbon Paper: Peering into Turla\u2019s second stage backdoor \u2013 WeLiveSecurity, ESET\r\n \tCarbon, Software S0335 \u2013 MITRE ATT&amp;CK\r\n \tThreat Group Assessment: Turla (aka Pensive Ursa) \u2013 Unit 42, Palo Alto Networks\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2023\/10\/PA-Pensive-Ursa-Centre-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Daniel Frank"},{"@type":"Person","name":"Tom Fakterman"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":130890,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"c3b9727a80","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"d123c4ca65"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/130890" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=130890' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-130890 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/PA-Pensive-Ursa-Centre.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" title="Threat Actor Groups" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:breadcrumb:Threat Actor Groups">Threat Actor Groups</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/nation-state-cyberattacks/" role="link" title="Nation-State Cyberattacks" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:breadcrumb:Nation-State Cyberattacks">Nation-State Cyberattacks</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/nation-state-cyberattacks/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Nation-State Cyberattacks"><span class="ab-title__pre">Nation-State Cyberattacks</span></a> 
              <h1>Over the Kazuar’s Nest: Cracking Down on a Freshly Hatched Backdoor Used by Pensive Ursa (Aka Turla)</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 20</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-threat-prevention/" style="--card-color: #ffcb06" role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Advanced Threat Prevention"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced Threat Prevention icon">Advanced Threat Prevention</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xsiam/" style="--card-color: #00cc66" role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Cortex XSIAM"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XSIAM icon">Cortex XSIAM</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/next-generation-firewall/" style="--card-color: #ffcb06" role="link" title="Next-Generation Firewall" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Next-Generation Firewall"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Next-Generation Firewall icon">Next-Generation Firewall</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/unit-42-incident-response/" style="--card-color: #c94727" role="link" title="Unit 42 Incident Response" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Unit 42 Incident Response"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Unit 42 Incident Response icon">Unit 42 Incident Response</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Daniel Frank" href="https://unit42.paloaltonetworks.com/author/daniel-frank/">Daniel Frank</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Tom Fakterman" href="https://unit42.paloaltonetworks.com/author/tom-fakterman/">Tom Fakterman</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>31 October, 2023 at 6:00 AM PDT</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Nation-State Cyberattacks" href="https://unit42.paloaltonetworks.com/category/nation-state-cyberattacks/">Nation-State Cyberattacks</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Threat Actor Groups" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/">Threat Actor Groups</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Advanced Persistent Threat" href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/">Advanced Persistent Threat</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:backdoor" href="https://unit42.paloaltonetworks.com/tag/backdoor/">Backdoor</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Kazuar" href="https://unit42.paloaltonetworks.com/tag/kazuar/">Kazuar</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Pensive Ursa" href="https://unit42.paloaltonetworks.com/tag/pensive-ursa/">Pensive Ursa</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Turla" href="https://unit42.paloaltonetworks.com/tag/turla/">Turla</a></li><li><a data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:Uroburos" href="https://unit42.paloaltonetworks.com/tag/uroburos/">Uroburos</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/?pdf=download&#038;lg=en&#038;_wpnonce=dcff69efdc" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/?pdf=print&#038;lg=en&#038;_wpnonce=dcff69efdc" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/" role="link" title="Copy link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Over%20the%20Kazuar&rsquo;s%20Nest:%20Cracking%20Down%20on%20a%20Freshly%20Hatched%20Backdoor%20Used%20by%20Pensive%20Ursa%20(Aka%20Turla)&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F&#038;title=Over%20the%20Kazuar’s%20Nest:%20Cracking%20Down%20on%20a%20Freshly%20Hatched%20Backdoor%20Used%20by%20Pensive%20Ursa%20(Aka%20Turla)" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F&#038;text=Over%20the%20Kazuar&rsquo;s%20Nest:%20Cracking%20Down%20on%20a%20Freshly%20Hatched%20Backdoor%20Used%20by%20Pensive%20Ursa%20(Aka%20Turla)" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Over%20the%20Kazuar’s%20Nest:%20Cracking%20Down%20on%20a%20Freshly%20Hatched%20Backdoor%20Used%20by%20Pensive%20Ursa%20(Aka%20Turla)%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fpensive-ursa-uses-upgraded-kazuar-backdoor%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/pensive-ursa-uses-upgraded-kazuar-backdoor/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2><a id="post-130890-_50qt2dixcmnj"></a>Executive Summary</h2>
<p>While tracking the evolution of Pensive Ursa (aka Turla, Uroburos), Unit 42 researchers came across a new, upgraded variant of Kazuar. Not only is Kazuar another name for the enormous and dangerous cassowary bird, Kazuar is an advanced and stealthy .NET backdoor that Pensive Ursa usually uses as a second stage payload.</p>
<p><a href="https://unit42.paloaltonetworks.com/turla-pensive-ursa-threat-assessment/" target="_blank" rel="noopener">Pensive Ursa</a> is a Russian-based threat group operating since at least 2004, which is linked to the <a href="https://www.justice.gov/usao-edny/pr/justice-department-announces-court-authorized-disruption-snake-malware-network" target="_blank" rel="noopener">Russian Federal Security Service (FSB)</a>.</p>
<p>The <a href="https://cert.gov.ua/article/5213167" target="_blank" rel="noopener">Ukrainian CERT</a> reported in July 2023 that this version of Kazuar was targeting the Ukrainian defense sector. The threat group behind this variant was going after sensitive assets such as those found in Signal messages, source control and cloud platforms data.</p>
<p>Since <a href="https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/" target="_blank" rel="noopener">Unit 42</a>’s discovery of Kazuar in 2017, we have seen it in the wild only a handful of times, targeting mostly organizations in the European government and military sectors. <a href="https://thehackernews.com/2021/01/researchers-find-links-between-sunburst.html" target="_blank" rel="noopener">The Sunburst backdoor</a> has been tied to Kazuar by code resemblance, which demonstrates its complexity level. Since late 2020, we had not seen new Kazuar samples in the wild – yet reports suggested Kazuar was under constant development.</p>
<p>As the code of the upgraded revision of Kazuar reveals, the authors put special emphasis on Kazuar’s ability to operate in stealth, evade detection and thwart analysis efforts. They do so using a variety of advanced anti-analysis techniques and by protecting the malware code with effective encryption and obfuscation practices.</p>
<p>This article provides a deep technical analysis of Kazuar’s capabilities. We are sharing this research to provide detection, prevention and hunting recommendations to help organizations strengthen their overall security posture. An additional list of artifacts will be provided in an <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">appendix</a> linked to <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information" target="_blank" rel="noopener">our GitHub</a> page.</p>
<p>Palo Alto Networks customers receive protections from and mitigations for the threats mentioned in this article in the following ways:</p>
<ul>
<li>Next-Generation Firewall with the Advanced Threat Prevention security subscription can help block the malware C2 traffic</li>
<li>Organizations can engage the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response</a> team for specific assistance with this threat and others</li>
<li>The Cortex XDR and XSIAM platform detects and prevents the threats mentioned in this article</li>
<li>The <a href="https://www.paloaltonetworks.com/resources/datasheets/advanced-wildfire" target="_blank" rel="noopener">Advanced WildFire</a> machine-learning models and analysis techniques have been reviewed and updated in light of this new Kazuar variant.</li>
</ul>
<table style="width: 100%;">
<thead>
<tr>
<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/tag/backdoor/" target="_blank" rel="noopener"><b>Backdoors</b></a>, <strong><a href="https://unit42.paloaltonetworks.com/tag/pensive-ursa/" target="_blank" rel="noopener">Pensive Ursa</a></strong></td>
</tr>
</thead>
</table>
<h2><a id="post-130890-_mysdery88orh"></a>Kazuar Overview</h2>
<p>Kazuar is known for being an advanced and stealthy .NET backdoor that Pensive Ursa usually uses as a second stage payload, delivered together with other tools that the threat group commonly uses.</p>
<p>The recent campaign that the <a href="https://cert.gov.ua/article/5213167" target="_blank" rel="noopener">Ukrainian CERT</a> reported unveiled the multi-staged delivery mechanism of Kazuar, together with other tools such as the new Capibar first-stage backdoor. Our technical analysis of this recent variant – seen in the wild after years of hiatus – showed significant improvements to its code structure and functionality.</p>
<p>This post will detail previously undocumented features, including:</p>
<ul>
<li><a href="#post-130890-_lz74dc7im8ye">Comprehensive system profiling</a> - Extensive data collection.</li>
<li><a href="#post-130890-_5higatyq4hy">Credential theft of cloud and other sensitive applications</a> - Theft of cloud application accounts, source control and Signal messaging application.</li>
<li><a href="#post-130890-_tf1renih7nn9">Extended set of commands</a> - A total of 45 supported commands to execute, received from another Kazuar node or the command and control (C2) server.</li>
<li><a href="#post-130890-_9pmase4f3klc">Enhanced task automation</a> - A range of automated tasks that the attacker could turn on/off.</li>
<li><a href="#post-130890-_iyihiznxpnx1">Variable encryption schemes</a> - Implementation of different encryption algorithms and schemes.</li>
<li><a href="#post-130890-_epngo2omwiwz">Injection modes</a> <strong>- </strong>Multiple injection modes, allowing Kazuar to run from different processes and execute different features.</li>
</ul>
<p>Since at least 2018, variants of Kazuar changed their obfuscation methods and methodically modified its compilation timestamps. Some variants used the ConfuserEx obfuscator to encrypt strings, and others used a custom method. In the Kazuar variant analyzed in this blog, the authors went a step further, implementing multiple custom methods for string encryption.</p>
<p>Unlike with previous variants, the authors only focused on targeting the Windows operating system.</p>
<p>Clarification note: While analyzing Kazuar’s code, we used <a href="https://github.com/dnSpy/dnSpy" target="_blank" rel="noopener">dnSpy</a> to export the code into an integrated development environment (IDE) and decrypted the strings using a custom script. This allowed us to edit separate <span style="font-family: 'courier new', courier, monospace;">.cs</span> files and edit some of the method names into meaningful ones. We have interpreted the method names that appear in the screenshots.</p>
<h2><a id="post-130890-_eopk6woftiue"></a>Latest Kazuar Variant Detailed Technical Analysis</h2>
<h3><a id="post-130890-_4q5bpbmsxy9d"></a>Metadata</h3>
<p><a href="https://securelist.com/sunburst-backdoor-kazuar/99981/" target="_blank" rel="noopener">Reports from other research organizations</a> have shown that the authors of Kazuar have <a href="https://attack.mitre.org/techniques/T1070/006/" target="_blank" rel="noopener">manipulated their samples’ timestamps</a> since at least 2018. This new variant’s compilation timestamp is <span style="font-family: 'courier new', courier, monospace;">Thursday, November 20, 2008 10:11:18 AM GMT</span>. Unlike other publicly available variants, this is the first time the authors went back as far as 2008 when faking the timestamp.</p>
<p>Kazuar also contains hard-coded, hashed identifiers for the <span style="font-family: 'courier new', courier, monospace;">Agent version</span> and <span style="font-family: 'courier new', courier, monospace;">BuildID</span> as well as an <span style="font-family: 'courier new', courier, monospace;">Agent label</span>. These can be used as variant identifiers, as shown in Figure 1.</p>
<figure id="attachment_130893" aria-describedby="caption-attachment-130893" style="width: 594px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130893" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-1.png" alt="Image 1 is the configuration information for a Kazuar sample. It includes the agent configuration information in two separate columns. There is the configuration column and the value column. Some of the information has been redacted." width="594" height="151" /><figcaption id="caption-attachment-130893" class="wp-caption-text">Figure 1. Kazuar’s sample basic configuration information.</figcaption></figure>
<h3><a id="post-130890-_cf8a70mjyo52"></a>Initialization</h3>
<h4><a id="post-130890-_xrjykplm02wk"></a>Executing Assembly Check</h4>
<p>When executing Kazuar, it uses the <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/dotnet/api/system.reflection.assembly.location?view=net-7.0" target="_blank" rel="noopener">Assembly.Location</a></span> property to receive its own file path and check its name. Kazuar will continue execution only if the returned value is an empty string, as shown in Figure 2. The <span style="font-family: 'courier new', courier, monospace;">Assembly.Location</span> property returns an empty string when loading the file from a byte array.</p>
<p>This check appears to be a simple form of an anti-analysis mechanism, to ensure that the execution of the malware was done by the intended loader and not by other means or software.</p>
<p>Kazuar will execute if its filename matches a specific hard-coded hashed name (using the <span style="font-family: 'courier new', courier, monospace;">FNV</span> algorithm). This behavior is probably meant for debugging purposes, letting the authors avoid using the loader each time they debug the malware.</p>
<figure id="attachment_130895" aria-describedby="caption-attachment-130895" style="width: 634px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130895" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-2.png" alt="Image 2 is a screenshot of several lines of code whereby the Kazuar variant’s assembly name is checked. " width="634" height="243" /><figcaption id="caption-attachment-130895" class="wp-caption-text">Figure 2. Checking the Kazuar variant’s assembly name.</figcaption></figure>
<h4><a id="post-130890-_kftpeznwvieo"></a>Operational Root Directory Creation</h4>
<p>Kazuar creates a new directory to store its configuration and log data. It uses <span style="font-family: 'courier new', courier, monospace;">%localappdata%</span> as the main storage path and determines its root directory from a list of hard-coded paths (See <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>).</p>
<p>Kazuar chooses which root directory, folder names, filenames and file extensions to use based on the machine globally unique identifier (<a href="https://learn.microsoft.com/en-us/dotnet/api/system.guid?view=net-7.0" target="_blank" rel="noopener">GUID</a>), as shown in Figure 3. Although these names might seem randomly generated at a first glance, the usage of the GUID means they will keep the same name for each execution of the malware on the same infected machine.</p>
<figure id="attachment_130897" aria-describedby="caption-attachment-130897" style="width: 460px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130897" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-3.png" alt="Image 3 is a screenshot of several lines of code. The use of GUID allows Kazuar to choose root directories and the like to use." width="460" height="169" /><figcaption id="caption-attachment-130897" class="wp-caption-text">Figure 3. The method in charge of returning an index for the paths array.</figcaption></figure>
<p>Like in previous variants, Kazuar uses a structured directory scheme to save its log files and other data such as individual configuration files and keylogger data. Directory naming is pseudorandom and chosen based on hashing. Examples include the custom implementation of the <span style="font-family: 'courier new', courier, monospace;">FNV</span> hashing algorithm seen in previous variants, and other manipulations on the GUID value. You can find a list of the directories in their plaintext names in the <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>.</p>
<p>It is also worth mentioning that there is a currently unreferenced option to create a file called <span style="font-family: 'courier new', courier, monospace;">wordlist</span> in the code. This file could give us a clue about a feature not yet implemented, perhaps using a wordlist for directories, filenames or password brute forcing.</p>
<h4><a id="post-130890-_uwyuzm7s57l0"></a>Configuration Files</h4>
<p>The malware creates a separate main configuration file that includes data including the following:</p>
<ul>
<li>C2 servers</li>
<li>Injection mode</li>
<li>Other operational configuration data</li>
</ul>
<p>Figure 4 shows a snippet from this file below. You can find the encryption methods for Kazuar’s configuration files in the <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>.</p>
<figure id="attachment_130899" aria-describedby="caption-attachment-130899" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130899" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-4.png" alt="Image 4 is the configuration file for the Kazuar sample. Some information has been redacted. The information includes the agent information, last contact, transport information, log information, etc." width="900" height="716" /><figcaption id="caption-attachment-130899" class="wp-caption-text">Figure 4. Snippet of the configuration file.</figcaption></figure>
<h4><a id="post-130890-_34gre5nfqdwh"></a>Mutex Name Generation</h4>
<p>Kazuar is using a mutex to check its injection into another process. Kazuar generates its mutex name by XORing the current process ID with the hard-coded value <span style="font-family: 'courier new', courier, monospace;">0x4ac882d887106b7d</span> and then XORing it with the machine's GUID, as depicted in Figure 5. This means that several Kazuars can operate in tandem on the same device, just not injected into the same process.</p>
<figure id="attachment_130901" aria-describedby="caption-attachment-130901" style="width: 490px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130901" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-5.png" alt="Image 5 is a screenshot of the mutex name generator." width="490" height="203" /><figcaption id="caption-attachment-130901" class="wp-caption-text">Figure 5. Mutex name generation.</figcaption></figure>
<h3><a id="post-130890-_tqcdb0a4vb14"></a>Architecture</h3>
<h4><a id="post-130890-_epngo2omwiwz"></a>Setting Kazuar’s Injection Modes</h4>
<p>The new version of Kazuar uses what it describes in the configuration as “injection modes” as shown in Table 1. The default mode is <span style="font-family: 'courier new', courier, monospace;">inject</span>.</p>
<table style="width: 101.08%;">
<tbody>
<tr>
<td style="text-align: center; width: 13.9712%;"><b>Configuration file mode name</b></td>
<td style="text-align: center; width: 43.049%;"><b>Description</b></td>
<td style="text-align: center; width: 12.6211%;"><b>Inbound traffic</b></td>
<td style="text-align: center; width: 12.1836%;"><b>Outbound traffic</b></td>
<td style="text-align: center; width: 18.009%;"><b>Additional functionality threads</b></td>
</tr>
<tr>
<td style="width: 13.9712%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">inject</span></td>
<td style="width: 43.049%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Default mode, injects into </span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">explorer.exe</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Creates a pipe communication channel and serves as a proxy for other Kazuar instances</span></li>
</ul>
</td>
<td style="width: 12.6211%;"><span style="font-weight: 400;">Named pipe</span></td>
<td style="width: 12.1836%;"><span style="font-weight: 400;">Named pipe</span></td>
<td style="width: 18.009%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Event Log Monitor</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Keylogging</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Peeps</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Automated tasks</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Anti-Dumping</span></li>
</ul>
</td>
</tr>
<tr>
<td style="width: 13.9712%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">zombify</span></td>
<td style="width: 43.049%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Injects into the user’s default browser or </span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">svchost.exe</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Creates a named pipe communication channel and serves as a proxy for other Kazuar instances</span></li>
</ul>
</td>
<td style="width: 12.6211%;"><span style="font-weight: 400;">Named pipe</span></td>
<td style="width: 12.1836%;"><span style="font-weight: 400;">HTTP</span></td>
<td style="width: 18.009%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Anti-Dumping</span></li>
</ul>
</td>
</tr>
<tr>
<td style="width: 13.9712%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">combined</span></td>
<td style="width: 43.049%;"><span style="font-weight: 400;">In case the default </span><span style="font-weight: 400;">inject</span><span style="font-weight: 400;"> method fails, it executes via the same method as </span><span style="font-weight: 400;">zombify</span></td>
<td style="width: 12.6211%;"><span style="font-weight: 400;">N/A</span></td>
<td style="width: 12.1836%;"><span style="font-weight: 400;">N/A</span></td>
<td style="width: 18.009%;"><span style="font-weight: 400;">N/A</span></td>
</tr>
<tr>
<td style="width: 13.9712%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">remote</span></td>
<td style="width: 43.049%;"><span style="font-weight: 400;">Creates a named pipe communication channel and serves as a proxy for other Kazuar instances, no C2 communication</span></td>
<td style="width: 12.6211%;"><span style="font-weight: 400;">Named pipe</span></td>
<td style="width: 12.1836%;"><span style="font-weight: 400;">Named pipe</span></td>
<td style="width: 18.009%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Event Log Monitor</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Automated tasks</span></li>
</ul>
</td>
</tr>
<tr>
<td style="width: 13.9712%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">single</span></td>
<td style="width: 43.049%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Creates a named pipe communication channel and serves as a proxy for other Kazuar instances</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">This mode enables C2 communication to receive commands via HTTP</span></li>
</ul>
</td>
<td style="width: 12.6211%;"><span style="font-weight: 400;">Named pipe or HTTP</span></td>
<td style="width: 12.1836%;"><span style="font-weight: 400;">Named pipe or HTTP</span></td>
<td style="width: 18.009%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Event Log Monitor</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Keylogging</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Peeps</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Automated tasks</span></li>
</ul>
</td>
</tr>
<tr>
<td style="width: 13.9712%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">Not in User Interactive Mode</span></td>
<td style="width: 43.049%;"><span style="font-weight: 400;">In case Kazuar’s execution is in a user interactive mode, which could occur when executing Kazuar as a service or on a machine with no GUI such as a server.</span></td>
<td style="width: 12.6211%;"><span style="font-weight: 400;">Named pipe</span></td>
<td style="width: 12.1836%;"><span style="font-weight: 400;">Named pipe</span></td>
<td style="width: 18.009%;">
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Automated tasks</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">WMI consumer</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Anti-Dumping</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 8pt; color: #999999;"><em>Table 1. Kazuar injection modes and descriptions.</em></span></p>
<p>In <span style="font-family: 'courier new', courier, monospace;">zombify</span> mode, Kazuar is injected into the user’s default browser and has a fallback mechanism to inject itself to <span style="font-family: 'courier new', courier, monospace;">svchost.exe</span> in case the query for the default browser fails. Figure 6 shows that the term <span style="font-family: 'courier new', courier, monospace;">zombify</span> addresses process injection in general by Kazuar’s authors.</p>
<figure id="attachment_130903" aria-describedby="caption-attachment-130903" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130903" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-6.png" alt="Image 6 is a screenshot of many lines of code. Using zombify mode, Kazuar performs code injection." width="900" height="437" /><figcaption id="caption-attachment-130903" class="wp-caption-text">Figure 6. A snippet of Kazuars’ code injection in <span style="font-family: 'courier new', courier, monospace;">zombify</span> mode.</figcaption></figure>
<h4><a id="post-130890-_pm311y419u2a"></a>Multithreading Model</h4>
<p>Kazuar operates in a multithreading model, while each of Kazuar’s main functionalities operates as its own thread. In other words, one thread handles receiving commands or <span style="font-family: 'courier new', courier, monospace;">tasks</span> from its C2, while a <span style="font-family: 'courier new', courier, monospace;">solver</span> thread handles execution of these commands. This multithreading model enables Kazuar’s authors to establish an asynchronous and modular flow control. Figure 7 shows the <span style="font-family: 'courier new', courier, monospace;">task solver</span> flow.</p>
<figure id="attachment_130905" aria-describedby="caption-attachment-130905" style="width: 849px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130905" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-7.png" alt="Image 7 is a diagram of Kazuar’s task-solving mechanism. Enclosed in the encrypted result file is the delimiter, result identifier, encrypted GUID length, RSA encrypted HMACMD5 hash and IV and AES key and the AES encrypted task BLOB. The results file is read and sent to C2. The send thread writes tasks in the task file and and the task file is read by a task resolver thread. " width="849" height="648" /><figcaption id="caption-attachment-130905" class="wp-caption-text">Figure 7. Kazuar’s task-solving mechanism diagram.</figcaption></figure>
<h4><a id="post-130890-_iyihiznxpnx1"></a>The Task Solver Component - Kazuar’s Puppeteer</h4>
<p>Kazuar receives new <span style="font-family: 'courier new', courier, monospace;">tasks</span>, solves them and writes the output into <span style="font-family: 'courier new', courier, monospace;">result</span> files. A <span style="font-family: 'courier new', courier, monospace;">solver</span> thread is handling new <span style="font-family: 'courier new', courier, monospace;">tasks</span> received from the C2 servers or another Kazuar node. The <span style="font-family: 'courier new', courier, monospace;">task</span> content is then encrypted and written to disk into a <span style="font-family: 'courier new', courier, monospace;">task</span> file.</p>
<p>Each <span style="font-family: 'courier new', courier, monospace;">task</span> file implements a hybrid encryption scheme:</p>
<ol>
<li>Using <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography.rngcryptoserviceprovider?view=net-7.0" target="_blank" rel="noopener">RNGCryptoServiceProvider</a></span> to generate two byte-arrays containing random numbers, which are 16 and 32 bytes long respectively.
<ul type="a.">
<li>Using the first array as an <a href="https://www.tutorialspoint.com/cryptography/advanced_encryption_standard.htm" target="_blank" rel="noopener">AES (Rijndael)</a> initialization vector (IV).</li>
<li>Using the second array as an AES key.</li>
</ul>
</li>
<li>Generating an <a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography.hmacmd5?view=net-7.0" target="_blank" rel="noopener">HMACMD5</a> hash based on the <span style="font-family: 'courier new', courier, monospace;">result</span>’s content from memory, prior to its encryption and writing to disk, using the array described in the first bullet above as the key.</li>
<li>Encrypting the HMACMD5 hash, AES key and IV with the hard-coded RSA key, and writing the encrypted BLOB to the beginning of the file. By using the fast AES algorithm to encrypt larger objects such as the <span style="font-family: 'courier new', courier, monospace;">result</span>’s contents, and using the slower RSA encryption to conceal the AES key and IV, Kazuar improves its performance. This also disables the option of recovering infected files only from disk, since the symmetric key is encrypted using an asymmetric key.</li>
<li>Using the AES encryption to encrypt the <span style="font-family: 'courier new', courier, monospace;">result</span> file’s contents.</li>
</ol>
<p>As shown in Figure 8, once a task is complete, the generated <span style="font-family: 'courier new', courier, monospace;">result</span> file will be saved to disk.</p>
<figure id="attachment_130907" aria-describedby="caption-attachment-130907" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130907" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-8.png" alt="Image 8 is a screenshot of many lines of mode. Kazuar uses this code to encrypt and then write a result file." width="900" height="371" /><figcaption id="caption-attachment-130907" class="wp-caption-text">Figure 8. A snippet of Kazuar’s method to encrypt and write a result file.</figcaption></figure>
<p>In addition to the aforementioned encrypted data, Kazuar writes the following fields to the beginning of the <span style="font-family: 'courier new', courier, monospace;">result</span> file:</p>
<ol>
<li>Four zero bytes (we believe this serves as a sort of a delimiter)</li>
<li>Generated result identifier</li>
<li>Length of the encrypted GUID, using the same XOR algorithm as in the initialization part (the encrypted message here is “System info at [datetime] (-07)”)</li>
<li>The encrypted GUID itself</li>
<li>RSA encrypted HMACMD5 hash + IV + AES key</li>
<li>The AES encrypted task content</li>
</ol>
<p>Figure 9 shows the encrypted result file content from disk.</p>
<figure id="attachment_130909" aria-describedby="caption-attachment-130909" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130909" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-9.png" alt="Image 9 is a screenshot of an encrypted result file. Highlighted in red are the Delimiter, generated result identifier, encrypted UUID length, the encrypted GUID content, the RSA encrypted HMACDM5 hash + IV _ AES key and the AES encrypted task content. " width="900" height="431" /><figcaption id="caption-attachment-130909" class="wp-caption-text">Figure 9. An encrypted <span style="font-family: 'courier new', courier, monospace;">result</span> file content from disk.</figcaption></figure>
<h4><a id="post-130890-_2k96nikstevu"></a>Strings Encryption</h4>
<p>Kazuar’s code includes a high volume of strings that are related to functionality and debugging. When revealed in plain text, they shed light on the inner workings and functionality of Kazuar. To avoid the scenario of researchers creating strings-based indicative YARA and hunting rules, Kazuar’s strings are encrypted. It decrypts each string at runtime.</p>
<p>Kazuar uses a variation of a <a href="https://en.wikipedia.org/wiki/Caesar_cipher" target="_blank" rel="noopener">Caesar Cipher</a> for the string encryption/decryption algorithm. In this algorithm, Kazuar implements a dictionary that simply swaps the key and value of each member. Recent Kazuar variants implemented only one dictionary, while the new variant implements multiple dictionaries, each containing 80 pairs of characters as shown in Figure 10.</p>
<figure id="attachment_130911" aria-describedby="caption-attachment-130911" style="width: 316px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130911" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-10.png" alt="Image 10 is a screenshot of many lines of code. It is contains the dictionary information used for the string decryption." width="316" height="148" /><figcaption id="caption-attachment-130911" class="wp-caption-text">Figure 10. One of the classes containing the dictionary used for string decryption.</figcaption></figure>
<p>Figure 11 shows a loop iterating over a given string, and checking if the ordinal value of a given character is in the dictionary keys of the relevant class. If it is, Kazuar swaps the key and value and appends it to the crafted string. Otherwise, it keeps the original character.</p>
<p>In addition to the string obfuscation, the authors have given unmeaningful names to the classes and methods in the code, to make analysis more difficult.</p>
<figure id="attachment_130913" aria-describedby="caption-attachment-130913" style="width: 658px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130913" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-11.png" alt="Image 11 is a screenshot of many lines of code. This loop creates a deobfuscated string." width="658" height="295" /><figcaption id="caption-attachment-130913" class="wp-caption-text">Figure 11. The loop that creates the deobfuscated string.</figcaption></figure>
<p>One of the strings decoded by Kazuar returns the value “<span style="font-family: 'courier new', courier, monospace;">Invalid pong responce</span>” as shown in Figure 12. It seems that one of the malware coders forgot to switch the Russian C for an English S.</p>
<figure id="attachment_130915" aria-describedby="caption-attachment-130915" style="width: 387px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130915" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-12.png" alt="Image 12 is a screenshot of a table. The two columns are Name and Value. In the name column are JJ, stringBuilder and i. The corresponding values are listed next to them." width="387" height="75" /><figcaption id="caption-attachment-130915" class="wp-caption-text">Figure 12. The typo in the “<span style="font-family: 'courier new', courier, monospace;">response</span>” string.</figcaption></figure>
<h3><a id="post-130890-_4cs5iv9ijnhp"></a>Core Functionality</h3>
<p><a href="https://www.recordedfuture.com/turla-apt-infrastructure" target="_blank" rel="noopener">In a fashion typical to Pensive Ursa</a>, to avoid takedowns, Kazuar uses hijacked legitimate websites for its C2 infrastructure. In addition, as mentioned in the <a href="#post-130890-_epngo2omwiwz">Injection Modes</a> section, Kazuar also supports communication over named pipes. It uses both mechanisms to receive remote commands, or tasks (as described in the code).</p>
<h4><a id="post-130890-_tf1renih7nn9"></a>Supported C2 Commands</h4>
<p>Kazuar supports 45 different tasks it can receive from its C2, as shown in Table 2. This is yet another development in Kazuar’s code, as previous research hadn’t documented some of these tasks. By comparison, Kazuar’s first variant analyzed back in 2017 supported only 26 C2 commands.</p>
<p>We have grouped Kazuar’s commands into the following categories:</p>
<ul>
<li>Host data collection</li>
<li>Extended forensic data collection</li>
<li>File manipulation</li>
<li>Arbitrary command execution</li>
<li>Interaction with Kazuar’s configuration</li>
<li>Registry querying and manipulation</li>
<li>Scripts execution (VBS, PowerShell, JavaScript)</li>
<li>Custom network requests</li>
<li>Credentials and sensitive information stealing</li>
</ul>
<table style="width: 100%; height: 1452px;">
<tbody>
<tr style="height: 24px;">
<td style="height: 24px; width: 14.784%;"><b>Command</b></td>
<td style="height: 24px; width: 84.5515%;"><b>Description</b></td>
</tr>
<tr style="height: 75px;">
<td style="height: 75px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">sindex</span></td>
<td style="height: 75px; width: 84.5515%;"><span style="font-weight: 400;">Searches for properties of files with the following extensions: <span style="font-family: 'courier new', courier, monospace;">.</span></span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">txt</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .ini</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .config</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .vbs</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .js</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .ps1</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .doc</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .docx</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .xls</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .xlsx</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .ppt</span><span style="font-weight: 400;">,</span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;"> .pptx</span><span style="font-weight: 400;"> under folders in the </span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">C:\Users\</span><span style="font-weight: 400;"> path.</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">scrshot</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Takes a screenshot of the window of a specified process</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">move</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Moves a file from a source path to a destination path</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">info</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Gets system information about one or multiple of the fields (described in </span><a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener"><span style="font-weight: 400;">Appendix</span></a>)</td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">steal</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Steals data from various browsers and applications (full list ID in </span><a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener"><span style="font-weight: 400;">Appendix</span></a>)</td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">run</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Executes a specified executable with supplied arguments, save the output to a temporary file, and upload the file to the C2 server.</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">schlist</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Gets data about scheduled tasks using the </span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">Schedule.Service</span><span style="font-weight: 400;"> COM object</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">config</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Updates Kazuar’s configuration file</span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">netuse</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Connects or removes network resources from the machine using the </span><a href="https://learn.microsoft.com/en-us/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection2a" target="_blank" rel="noopener"><span style="font-weight: 400;">WNetAddConnection2</span></a><span style="font-weight: 400;"> and </span><a href="https://learn.microsoft.com/en-us/windows/win32/api/winnetwk/nf-winnetwk-wnetcancelconnection2a" target="_blank" rel="noopener"><span style="font-weight: 400;">WNetCancelConnection2</span></a><span style="font-weight: 400;"> WinAPIs</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">log</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Adds a custom log to the log file</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">delegate</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Sends a command to another Kazuar implant on a remote system using a PIPE</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">eventlog</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Gets Windows Event log entries</span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">get</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Uploads files from a specified directory to Kazuar’s C2 servers, choosing which files to upload based on their modified, accessed and created timestamps.</span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">autoruns</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Checks various possibilities for software to have persistence in the infected machine (checks described in </span><a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener"><span style="font-weight: 400;">Appendix</span></a>)</td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">put</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Writes received data to a specified file on the system.</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">regwrite</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Sets a registry key/value.</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">autoslist</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Lists the number of files that were created under the </span><span style="font-weight: 400;">Autos</span><span style="font-weight: 400;"> functionality </span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">vbs</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Executes a VBScript</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">psh</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Executes a PowerShell Script</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">sleep</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Sets Kazuar to sleep for a specified amount of time</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">regdelete</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Deletes a registry key/value</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">timelimit</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Sets a time limit for a task from the server</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">dlllist</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Gets all loaded modules of a specified process</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">autosget</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Sends files created by the </span><span style="font-weight: 400;">Autos</span><span style="font-weight: 400;"> functionality to the C2</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">wmiquery</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Executes a WMI Query</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">dotnet</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Executes a .NET method received from the C2</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">tasklist</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Gets a list of running processes </span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">find</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Finds a specified directory and lists its files. It appears the actor can specify which files to list based on their modified, accessed and created timestamps as well.</span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">peep</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Executes a command related to the peeps functionality, which we have described in the </span><span style="font-weight: 400;">peeps section</span><span style="font-weight: 400;">.</span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">forensic</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Checks the system for multiple forensic artifacts (see </span><a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener"><span style="font-weight: 400;">Appendix</span></a>)</td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">kill</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Kills a process by name or by process identifier (PID)</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">regquery</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Queries a registry key</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">chakra</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Executes Javascript using </span><a href="https://github.com/chakra-core/ChakraCore" target="_blank" rel="noopener"><span style="font-weight: 400;">ChakraCore</span></a><span style="font-weight: 400;"> </span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">http</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Creates a crafted HTTP request</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">pipelist</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Gets open pipe list for a specific machine</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">jsc</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Executes JavaScript</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">wmicall</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Calls a WMI method</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">autosdel</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Deletes files created by the </span><span style="font-weight: 400;">Autos</span><span style="font-weight: 400;"> functionality </span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">del</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Deletes a specified file OR folder. Allows the attacker to supply a flag to securely delete a file by overwriting the file with random data before deleting it.</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">nbts</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Crafts a NetBIOS request</span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">copy</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Copies a specified file to a specified location. The attacker is able to overwrite the destination file if it already exists.</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">upgrade</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Downloads an upgrade to the malware</span></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">cmd</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Executes a command via </span><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">cmd.exe</span></td>
</tr>
<tr style="height: 48px;">
<td style="height: 48px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">unattend</span></td>
<td style="height: 48px; width: 84.5515%;"><span style="font-weight: 400;">Steals files related to various windows configuration or cloud applications credentials (full list of files is included in </span><a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener"><span style="font-weight: 400;">Appendix)</span></a></td>
</tr>
<tr style="height: 25px;">
<td style="height: 25px; width: 14.784%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">autosclear</span></td>
<td style="height: 25px; width: 84.5515%;"><span style="font-weight: 400;">Clears the </span><span style="font-weight: 400;">Autos</span><span style="font-weight: 400;"> log list of files </span></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 8pt; color: #999999;"><em>Table 2. Kazuar’s supported C2 commands.</em></span></p>
<h4><a id="post-130890-_5higatyq4hy"></a>Cloud, Source Control and Messaging Apps Credential Theft</h4>
<p>Kazuar has the capability to attempt to steal credentials from many artifacts in the infected computer, by receiving the commands <span style="font-family: 'courier new', courier, monospace;">steal</span> or <span style="font-family: 'courier new', courier, monospace;">unattend</span> from the C2.</p>
<p>These artifacts include multiple well-known cloud applications.</p>
<p>Kazuar can attempt to steal sensitive files that contain credentials for these applications. Artifacts targeted by Kazuar include Git SCM (a source control system that is popular among developers), as shown in Figure 13, and Signal (an encrypted messaging service for private instant messaging). We have included the full description of the artifacts in the <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>.</p>
<figure id="attachment_130917" aria-describedby="caption-attachment-130917" style="width: 617px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130917" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-13.png" alt="Image 13 is a screenshot of many lines of code. This is an example of Git SCM credentials Kazuar could steal." width="617" height="270" /><figcaption id="caption-attachment-130917" class="wp-caption-text">Figure 13. Code snippet of Git SCM credentials Kazuar may attempt to steal.</figcaption></figure>
<h4><a id="post-130890-_lz74dc7im8ye"></a>Comprehensive System Profiling</h4>
<p>When Kazuar is initially spawning a unique <span style="font-family: 'courier new', courier, monospace;">solver</span> thread, the first task it automatically executes is the extensive collection and profiling of the targeted system, named by Kazuar’s authors as <span style="font-family: 'courier new', courier, monospace;">first_systeminfo_do</span>. As part of this task, Kazuar will collect extensive information about the infected machine and will send it to the C2. This includes information on the operating system, hardware and network. The <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a> includes the entirety of what the attackers collected.</p>
<p>Kazuar saves this data into an <span style="font-family: 'courier new', courier, monospace;">info.txt</span> file and saves the execution logs to a <span style="font-family: 'courier new', courier, monospace;">logs.txt</span> file. As mentioned in the <a href="#post-130890-_iyihiznxpnx1">Task Solver</a> section, we can see the result in memory. In this case, it’s an archive, as depicted in Figure 14.</p>
<figure id="attachment_130919" aria-describedby="caption-attachment-130919" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130919" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-14.png" alt="Image 14 is a screenshot of the result of the first_systeminfo_do archive in memory. Highlighted in red is the zip header 0x50, 0x4B, 0x03, 0x04. " width="900" height="215" /><figcaption id="caption-attachment-130919" class="wp-caption-text">Figure 14. The result of the <span style="font-family: 'courier new', courier, monospace;">first_systeminfo_do</span> archive in memory.</figcaption></figure>
<p>Besides the two aforementioned text files, as part of this task, the malware takes a screenshot of the user’s screen. Figure 15 shows the zipping of all of these files into one archive before being encrypted and sent to the C2.</p>
<figure id="attachment_130921" aria-describedby="caption-attachment-130921" style="width: 663px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130921" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-15.png" alt="Image 15 is a 7zip folder. The path has been redacted. The contents of the folder are scrshot000.jpg, info.txt and logs.txt. The folder also includes the Size, Packed Size, Attributes, Encrypted and Comment information." width="663" height="220" /><figcaption id="caption-attachment-130921" class="wp-caption-text">Figure 15. The result of the <span style="font-family: 'courier new', courier, monospace;">first_systeminfo_do</span> archive extracted memory, prior to encryption.</figcaption></figure>
<h4><a id="post-130890-_9pmase4f3klc"></a>Creating Automated Tasks (Autos)</h4>
<p>Kazuar has the ability to set up automated tasks that will run at specified intervals to gather information from the infected machines. Figure 16 shows an example of this functionality as documented in Kazuar’s configuration.</p>
<p>These automated tasks include the following:</p>
<ul>
<li>Gathering system information (described in the section on Comprehensive System Profiling)</li>
<li>Taking screenshots</li>
<li>Stealing credentials (listed in full in the <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>)</li>
<li>Getting forensics data (see <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>)</li>
<li>Getting auto-runs data (see <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>)</li>
<li>Getting files from specified folders.</li>
<li>Getting a list of LNK files</li>
<li>Stealing emails using <a href="https://en.wikipedia.org/wiki/MAPI" target="_blank" rel="noopener">MAPI</a></li>
</ul>
<figure id="attachment_130923" aria-describedby="caption-attachment-130923" style="width: 354px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130923" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-16.png" alt="Image 16 is a screenshot of the configuration of the Autos function by Kazuar. it includes information such as the maximal storage count, result size, collect with system, do deleted files and similar commands." width="354" height="163" /><figcaption id="caption-attachment-130923" class="wp-caption-text">Figure 16. A snippet of Kazuar’s configuration of the <span style="font-family: 'courier new', courier, monospace;">Autos</span> function.</figcaption></figure>
<h4><a id="post-130890-_bcjlnelommut"></a>Monitoring Active Windows (Peeps)</h4>
<p>Kazuar has the ability to let attackers set up what they called “peep rules” in the configuration. Although Kazuar does not come with these rules set out of the box, according to the malware’s code, it appears that this functionality enables the attacker to monitor the windows of specified processes. This allows the attacker to track user activity of interest on the compromised machine.</p>
<h3><a id="post-130890-_v56xgfp87lmn"></a>Communication With the Command and Control</h3>
<h4><a id="post-130890-_kaxvjrbkun4m"></a>HTTP</h4>
<p>Prior to establishing a communication channel with a C2 server, and in addition to the aforementioned anti-analysis checks, Kazuar checks the configuration data-sending time intervals. This check includes determining whether it should send data over the weekend or not.</p>
<p>Upon first communication, Kazuar sends the collected data (described in the Comprehensive System Profiling section) in an XML format and expects to get an XML structured response back with a new task. Figure 17 shows the HTTP request.</p>
<p>Kazuar uses a hard-coded value <span style="font-family: 'courier new', courier, monospace;">169739e7-2112-9514-6a61-d300c0fef02d</span> casted to a string and Base64 encoded as the cookie.</p>
<figure id="attachment_130925" aria-describedby="caption-attachment-130925" style="width: 765px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130925" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-17.jpeg" alt="Image 17 is a screenshot of the HTTP POST command. Highlighted in red are the hardcoded cookie value in base64 and the generated XML tags." width="765" height="327" /><figcaption id="caption-attachment-130925" class="wp-caption-text">Figure 17. HTTP POST command with an XML in the body sent to the C2.</figcaption></figure>
<p>Kazuar generates key names for the XML and Base64 encrypts the content prior to sending it to the C2. The content of the XML contains:</p>
<ul>
<li>Encrypted content of the result file</li>
<li>Result identifier</li>
<li>Pseudorandom 4-byte numbers, probably another type of identifier</li>
<li>An array with values pseudorandomly generated based on the machine’s GUID</li>
<li>The hard-coded GUID connection string <span style="font-family: 'courier new', courier, monospace;">169739e7-2112-9514-6a61-d300c0fef02d</span></li>
<li>The machine’s unique GUID</li>
</ul>
<h4><a id="post-130890-_nqqzm06nonld"></a>Communication Using Named Pipes</h4>
<p>In addition to direct HTTP communication with the C2, Kazuar has the ability to function as a proxy, to receive and send commands to other Kazuar agents in the infected network. It is doing this proxy communication via <a href="https://learn.microsoft.com/en-us/windows/win32/ipc/named-pipes" target="_blank" rel="noopener">named pipes</a>, generating their names based on the machine’s GUID.</p>
<p>Kazuar uses these pipes to establish peer-to-peer communication between different Kazuar instances, configuring each as a server or a client. The named pipe communication supports the remote requests shown in Table 3.</p>
<table>
<tbody>
<tr>
<td style="text-align: center;"><b>Remote Request</b></td>
<td style="text-align: center;"><b>Kazuar’s Response</b></td>
<td style="text-align: center;"><b>Description</b></td>
</tr>
<tr>
<td><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">PING</span></td>
<td><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">PONG</span></td>
<td><span style="font-weight: 400;">Return a message with the current instance process information</span></td>
</tr>
<tr>
<td><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">TASK</span></td>
<td><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">RESULT</span></td>
<td><span style="font-weight: 400;">Start a received task and return a result</span></td>
</tr>
<tr>
<td><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">LOGS</span></td>
<td><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">ERROR</span></td>
<td><span style="font-weight: 400;">Retrieve error logs</span></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 8pt; color: #999999;"><em>Table 3. Kazuar requests and responses using named pipes.</em></span></p>
<h3><a id="post-130890-_n5fhzv26et0y"></a>Anti-Analysis Checks</h3>
<p>Kazuar uses multiple anti-analysis techniques based on a series of elaborate checks, to ensure it is not being analyzed. The authors programmed Kazuar to either continue if the coast is clear, or to remain idle and cease all C2 communication if it is being debugged or analyzed. We can group these checks into three main categories: honeypot, analysis tools and sandbox.</p>
<h4><a id="post-130890-_qys1xsp5z777"></a>Anti-Dumping</h4>
<p>Because Kazuar is not designed to run as a standalone process but rather lives injected within another process, dumping its code is possible from memory of the injected process. To prevent that from happening, Kazuar uses a powerful feature of .NET, which is the <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/dotnet/api/system.reflection?view=net-7.0" target="_blank" rel="noopener">System.Reflection Namespace</a></span>. This gives Kazuar the ability to gather real-time metadata about its assembly, methods and more.</p>
<p>Kazuar checks if it has set the <span style="font-family: 'courier new', courier, monospace;">antidump_methods</span> setting to true, then overrides the pointers to its custom methods, while ignoring generic .NET methods, essentially wiping them from memory (as Kazuar’s logged message states). This ultimately prevents researchers from dumping an intact version of the malware.</p>
<h4><a id="post-130890-_2r996mldhi3f"></a>Honeypot Check</h4>
<p>One of the first things Kazuar specifically searches for is the existence of Kaspersky honeypot artifacts on the machine. It uses a hard-coded list of specific process names and filenames to do this.</p>
<p>If Kazuar finds more than five of these files or processes, it will log that it found a Kaspersky honeypot. Figure 18 shows these filenames.</p>
<figure id="attachment_130927" aria-describedby="caption-attachment-130927" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130927" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-18.png" alt="Image 18 is a screenshot of many lines of code. Using these dictionary items, Kazuar checks the filenames to find the Kaspersky honeypot. " width="900" height="315" /><figcaption id="caption-attachment-130927" class="wp-caption-text">Figure 18. Filenames that Kazuar checks to find Kaspersky honeypot.</figcaption></figure>
<h4><a id="post-130890-_e3h45z8s83dd"></a>Analysis Tools Check</h4>
<p>Kazuar has a list of hard-coded names of different popular analysis tools such as the following:</p>
<ul>
<li>Process Monitor</li>
<li>X32dbg</li>
<li>DnSpy</li>
<li>Wireshark</li>
</ul>
<p>It goes over the list of running processes, and if one of these tools is running, Kazuar will log that it found analysis tools (see <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>).</p>
<h4><a id="post-130890-_5z6abuzxkpi"></a>Sandbox Check</h4>
<p>Kazuar has a list of hard-coded known sandbox libraries. It checks for the presence of certain DLLs that belong to different sandbox services. If the malware finds these files, it determines that it is being executed in a lab (see <a href="https://github.com/PaloAltoNetworks/Unti42-Threat-Intelligence-Article-Information/blob/main/Appendix-for-article-on-Pensive-Ursa-using-Kazuar.md" target="_blank" rel="noopener">Appendix</a>).</p>
<h4><a id="post-130890-_yjmpv7sn3ld"></a>Event Log Monitor</h4>
<p>Kazuar collects and parses events from the Windows event logs. Figure 19 shows Kazuar specifically looking for events from the following antivirus/security vendors:</p>
<ul>
<li>Kaspersky Endpoint Security</li>
<li>Symantec Endpoint Protection Client</li>
<li>Microsoft Windows Defender</li>
<li>Doctor Web</li>
</ul>
<p>Same as with checking for Kaspersky’s honeypot, a plausible explanation would be that these security products are popular with their victims.</p>
<figure id="attachment_130929" aria-describedby="caption-attachment-130929" style="width: 560px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130929" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-19.png" alt="Image 19 is a screenshot of many lines of code. Using these dictionary items, Kazuar collects event logs from specific security products suck as Kaspersky, Symantec, Defender and others." width="560" height="130" /><figcaption id="caption-attachment-130929" class="wp-caption-text">Figure 19. Event logs that Kazuar collects from specific security products.</figcaption></figure>
<h2><a id="post-130890-_eh7vjhg9duw5"></a>Strengthening Kazuar’s Connection to Pensive Ursa</h2>
<p><a href="#post-130890-_v56xgfp87lmn">As mentioned above</a>, when composing its initial HTTP POST request to its C2, Kazuar uses the machines GUID or a hard-coded GUID <span style="font-family: 'courier new', courier, monospace;">169739e7-2112-9514-6a61-d300c0fef02d</span> as a cookie, which is then type casted to string and Base64 encoded.</p>
<p>Searching the latter value in its string format (<span style="font-family: 'courier new', courier, monospace;">169739e7211295146a61d300c0fef02d</span>) yields a <a href="https://www.govcert.ch/downloads/whitepapers/Report_Ruag-Espionage-Case.pdf" target="_blank" rel="noopener">report [PDF] by the Swiss CERT</a>, which analyzes an attack carried out by Pensive Ursa against <a href="https://www.ruag.com/en" target="_blank" rel="noopener">RUAG</a>. RUAG Holding is a Swiss company from the aerospace and defense sector.</p>
<p>In addition, Kazuar’s <span style="font-family: 'courier new', courier, monospace;">tasks</span> and <span style="font-family: 'courier new', courier, monospace;">results</span> architecture, including the hybrid AES + RSA encryption scheme and other clear similarities in functionality, are the very image of Carbon’s modus operandi. It is mentioned both in the Swiss’s CERT report and another <a href="https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/" target="_blank" rel="noopener">report by ESET</a>. Carbon is another second stage backdoor that was attributed multiple times to Pensive Ursa, whose code was a fork of Snake, as mentioned by CISA.</p>
<p>These findings, along with the reports by multiple CERTs, further support the <a href="https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/" target="_blank" rel="noopener">previous Unit 42 assumptions</a> proposing that Kazuar might be Carbon’s successor. Most importantly, these findings strengthen the attribution of Kazuar to Pensive Ursa.</p>
<h2><a id="post-130890-_himobtxuwvt1"></a>Conclusion</h2>
<p>We examined the newest Kazuar malware variant that we detected in the wild. Notable features include the following:</p>
<ul>
<li>Robust code and string obfuscation techniques</li>
<li>A multithreaded model for enhanced performance</li>
<li>A range of encryption schemes implemented to safeguard Kazuar’s code from analysis and to conceal its data whether in memory, during transmission or on disk</li>
</ul>
<p>All the aforementioned features are designed to provide the Kazuar backdoor a high level of stealth. Other noteworthy characteristics of this malware are:</p>
<ul>
<li>Its anti-analysis functionalities</li>
<li>Extensive system profiling capabilities</li>
<li>The specific targeting of cloud applications</li>
</ul>
<p>This version of Kazuar also supports an array of over 40 distinct commands, half of which were previously undocumented.</p>
<p>We encourage security practitioners and defenders to study this report and use the information provided to enhance current detection, prevention and hunting practices to overall strengthen their security posture.</p>
<h2><a id="post-130890-_5s92x4i8372x"></a>Cortex XDR Detection and Prevention</h2>
<p>Figure 20 shows Cortex XDR detected and prevented the execution of Kazuar. As detailed in the <a href="#post-130890-_epngo2omwiwz">technical analysis</a> section, by default Kazuar injects its code into <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span>. When configured to operate on detect mode, Cortex XDR detects the malicious activity originating from the injected <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span>, as depicted in Figure 20 below.</p>
<figure id="attachment_130931" aria-describedby="caption-attachment-130931" style="width: 437px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130931" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-20.png" alt="Image 20 is a screenshot of Cortex XDR’s detection of malicious activity from explorer.exe. The severity is rated high and the description is “Suspicious execution of native code.”" width="437" height="175" /><figcaption id="caption-attachment-130931" class="wp-caption-text">Figure 20. Kazuar’s detection, shown in Cortex XDR in detect mode.</figcaption></figure>
<p>Execution of native code by Kazuar for process injection and WMI execution triggered several alerts, as well as other suspicious and uncharacteristic activity carried out by <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span>. We detailed the alerts, including the alert shown in Figure 20, in Figure 21 below.</p>
<figure id="attachment_130933" aria-describedby="caption-attachment-130933" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130933" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-21.png" alt="Image 21 is a screenshot of an alert table from Cortex XDR. Three alerts are listed in total. The descriptions of the alerts are also included. Some information is redacted." width="900" height="165" /><figcaption id="caption-attachment-130933" class="wp-caption-text">Figure 21. Kazuar’s execution alerts, shown in Cortex XDR in detect mode.</figcaption></figure>
<p>In addition, Figure 22 documents and details the <a href="#post-130890-_kftpeznwvieo">directory and files</a> that the malware created to store its configuration and logs.</p>
<figure id="attachment_130935" aria-describedby="caption-attachment-130935" style="width: 836px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130935" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-22.png" alt="Image 22 is a screenshot of an alert table from Cortex XDR. Six alerts are listed in total. Five are file writes and the sixth is Create Directory Event. The file path is also listed, and some information is redacted from each row." width="836" height="286" /><figcaption id="caption-attachment-130935" class="wp-caption-text">Figure 22. Kazuar’s execution alerts as seen in Cortex XDR on detect mode.</figcaption></figure>
<p>Finally, Figure 23 shows that when in prevent mode, Cortex XDR prevents the Kazuar malware executable and triggers the alert pop-up accordingly.</p>
<figure id="attachment_130937" aria-describedby="caption-attachment-130937" style="width: 531px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130937" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-23.png" alt="Image 23 is an alert window in Cortex XDR. Cortex XDR has blocked a malicious activity! Application name: Senatorial.exe. Application publisher: Unknown. Prevention description: Suspicious executable detected." width="531" height="286" /><figcaption id="caption-attachment-130937" class="wp-caption-text">Figure 23. Kazuar’s execution prevention alert as seen in Cortex XDR on prevent mode.</figcaption></figure>
<h2><a id="post-130890-_ka1fluf0dtdv"></a>Protections and Mitigations</h2>
<p>The Cortex XDR platform detects and prevents the execution flow described in the screenshots included in the previous section.</p>
<p>In addition to the classic detection, the unique <a href="https://www.paloaltonetworks.com/blog/security-operations/beating-alert-fatigue-with-cortex-xdr-smartscore-technology/" target="_blank" rel="noopener">SmartScore</a> engine translates security investigation methods and their associated data into a ML-driven hybrid risk scoring system. Figure 24 shows that the Kazuar variant and its related incident detailed in this blog scored 97 out of 100 by SmartScore.</p>
<figure id="attachment_130939" aria-describedby="caption-attachment-130939" style="width: 537px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-130939" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/10/word-image-130890-24.png" alt="Image 24 is a screenshot of the SmartScore for Kazuar. The score is 97. There is a list of reasons for the score, as well as a list of insights." width="537" height="463" /><figcaption id="caption-attachment-130939" class="wp-caption-text">Figure 24. The score given to Kazuar in SmartScore.</figcaption></figure>
<p>For Palo Alto Networks customers, our products and services provide the following coverage associated with this group.</p>
<p><a href="https://www.paloaltonetworks.com/cortex/cortex-xdr?_gl=1*13pmp8e*_ga*NzQyNjM2NzkuMTY2NjY3OTczNw..*_ga_KS2MELEEFC*MTY2OTczNjA2MS4zMS4wLjE2Njk3MzYwNjEuNjAuMC4w" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam" target="_blank" rel="noopener">XSIAM</a> detect user and credential-based threats by analyzing user activity from multiple data sources including the following:</p>
<ul>
<li>Endpoints</li>
<li>Network firewalls</li>
<li>Active Directory</li>
<li>Identity and access management solutions</li>
<li>Cloud workloads</li>
</ul>
<p>Cortex XDR and XSIAM build behavioral profiles of user activity over time with machine learning. By comparing new activity to past activity, peer activity and the expected behavior of the entity, Cortex XDR and XSIAM detect anomalous activity indicative of credential-based attacks.</p>
<p>It also offers the following protections related to the attacks discussed in this post:</p>
<ul>
<li>Prevents the execution of known malicious malware and also prevents the execution of unknown malware using <a href="https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention?_gl=1*13pmp8e*_ga*NzQyNjM2NzkuMTY2NjY3OTczNw..*_ga_KS2MELEEFC*MTY2OTczNjA2MS4zMS4wLjE2Njk3MzYwNjEuNjAuMC4w" target="_blank" rel="noopener">Behavioral Threat Protection and</a> machine learning based on the Local Analysis module</li>
<li>Protects against credential gathering tools and techniques using the new Credential Gathering Protection available from Cortex XDR 3.4</li>
<li>Protects against exploitation of different vulnerabilities including ProxyShell and ProxyLogon using the Anti-Exploitation modules as well as Behavioral Threat Protection</li>
<li>Cortex XDR Pro and XSIAM <a href="https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-analytics-alert-reference/analytics-alerts-by-required-data-source" target="_blank" rel="noopener">detect postexploit activity</a>, including credential-based attacks, with behavioral analytics</li>
<li><a href="https://docs.paloaltonetworks.com/ngfw" target="_blank" rel="noopener">Next-Generation Firewall</a> with the <a href="https://docs.paloaltonetworks.com/advanced-threat-prevention/administration" target="_blank" rel="noopener">Advanced Threat Prevention</a> security subscription can help block the malware C2 traffic via the following Threat Prevention signature: <a href="https://threatvault.paloaltonetworks.com/?query=86805" target="_blank" rel="noopener">86805</a>.</li>
<li>The <a href="https://www.paloaltonetworks.com/resources/datasheets/advanced-wildfire" target="_blank" rel="noopener">Advanced WildFire</a> machine-learning models and analysis techniques have been reviewed and updated in light of this new Kazuar variant. Multiple products in the Palo Alto Networks portfolio leverage Advanced WildFire to provide coverage against Kazuar variants and other threats.</li>
</ul>
<p>If you think you might have been impacted or have an urgent matter, get in touch with the <a href="https://start.paloaltonetworks.com/contact-unit42.html?_gl=1*13pmp8e*_ga*NzQyNjM2NzkuMTY2NjY3OTczNw..*_ga_KS2MELEEFC*MTY2OTczNjA2MS4zMS4wLjE2Njk3MzYwNjEuNjAuMC4w" target="_blank" rel="noopener">Unit 42 Incident Response team</a> or call:</p>
<ul>
<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>
<li>EMEA: +31.20.299.3130</li>
<li>APAC: +65.6983.8730</li>
<li>Japan: +81.50.1790.0200</li>
</ul>
<p>Palo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="https://www.cyberthreatalliance.org" target="_blank" rel="noopener">Cyber Threat Alliance</a>.</p>
<h2><a id="post-130890-_ydqdbjg0dngh"></a>Indicators of Compromise</h2>
<p><strong>Kazuar SHA256</strong></p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">91dc8593ee573f3a07e9356e65e06aed58d8e74258313e3414a7de278b3b5233</span></li>
</ul>
<p><strong>Command and Control Servers</strong></p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://www.pierreagencement[.]fr/wp-content/languages/index.php</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://sansaispa[.]com/wp-includes/images/gallery/</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://octoberoctopus.co[.]za/wp-includes/sitemaps/web/</span></li>
</ul>
<p><strong>RSA Keys</strong></p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">&lt;RSAKeyValue&gt;&lt;Modulus&gt;7ondEZo8ZjYh+FP4h3PgJBU/yTlO+g8ZbCF0wx8eocnqxLS4YWI9hG3SI2hlEBz6J4vvxPCrs/jazekolaZLQnbyOCyH53I+We+x32d2lUlXrtZA/0oJa39tW2t2NsUG/xPqsY3rBCuhi28hl30XH8Arn2/u9Jxl1G9dNxFDdVxk9ePjlHecdAtWCa9vmC4HY0Wlqyhd0+hJfvKCoKLsHuCyl4b/c343VVVTFubYNSFJMQnpIKsYQDRKtRszQuS1Ls+obyOr+0cbAmnKb8twTsq862pA6MzxRr16/4/1nyrNKuDS+OvPfv3tgvssybtGwN8D8Qac7O1FM722Nft16iis9WaoFuXCwP/LCkaetQMjEKN07H6ESHMnUc+JDvINIspAAKK8fRwtTcWKrG2bh/Dwtneq/9L1Pv2cKtpQAUlxVfQX5I/mtATEHIMcPOvNWRUqmSssDHEJiZDFKS45SjoG4qXs536xwbZ4k6lmHUUOVzkmCc71HooxRdSYx1M7Vqvou1Mi39O6vJouL2aTO6ymbGdnerKavDsgBSa2HKRbP2Nym6Ud4WAhiaqnPCWGnJz7l+4Hs++OcG2p+Ct1oXRecLK6Zy/n9moTZeijLdqJwUh90Bht8V8STz/vNtrhz++Do6DsDssENkOHXeUeRCqCmDdS3sqkxQnGAG3tGvc=&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">&lt;RSAKeyValue&gt;&lt;Modulus&gt;pyR0/srVS0gOZbNdK3iK+GvekQVkBq8brOVCuN/XcCz4WLJod9GhivDYrDtMXF6ZMGHKa2zAcQ+v2vltYW3X2BYCZ1sblEznfIk+oHs+lesblfHVyPPXDcTLLf5IUuGE/dzeSpLhlWiFT/4MyeMLzU8QexpRkBn0qJkk5xWU0D09DN0SaNzA8E4grU61aaul5iNRYMO+qLXmtIJhrjUrnHNu7ZnZ+AQtc19Dhne1hciH4aj00HRLXsofWGWsELEhZv92cnQ0Rf9n00EGB591zDR8gAt3T5sSTQvjMGWOBHusfGV4ytmchmQWZ8QY7Fp4EPgn8vM48OR2z13qo4YSediAt9Af+YKGoPu2PU3szx08UwBZRz4cyYZB3zcFB8NxCx7Gki2rS5bYx1Z1cG/kU+Ri2gXYoCHgOz8umr+PDB+21V1pnmStxzWAdR7mK0e663LMxxAcZWjEArbt/BcIiZAkFsyoq+NJbuKTR2RYAW+4DXbxFQeGKnFBgle3u9ktcYXWqgJ8/rvs920rGf9k3br3I+2MtzrWglhRi/WkAmTrEIL4i1id0M0askl0YBHlzU9+Bgv2y/VsLH2UKQlp+owxGm1jequxwGpZfwxmWAMATe8L2qctVdXEOfT7Ue67AsVjkP/VmhbhGDO8zt38trylUhWnpUeYdkigg9Nxs1k=&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;</span></li>
</ul>
<h2><a id="post-130890-_hufuyy6ptzkd"></a>Additional References</h2>
<ul>
<li><a href="https://cert.gov.ua/article/5213167" target="_blank" rel="noopener">Targeted Turla attacks (UAC-0024, UAC-0003) using CAPIBAR and KAZUAR malware</a> [English version] – CERT-UA (Ukraine)</li>
<li><a href="https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/" target="_blank" rel="noopener">Kazuar: Multiplatform Espionage Backdoor with API Access</a> – Unit 42, Palo Alto Networks</li>
<li><a href="https://thehackernews.com/2021/01/researchers-find-links-between-sunburst.html" target="_blank" rel="noopener">Researchers Find Links Between Sunburst and Russian Kazuar Malware</a> – The Hacker News</li>
<li><a href="https://e.cyberint.com/hubfs/CyberInt_Russian%20Backed%20Turla%20Resourfaces%20with%20a%20Sophisticated%20RAT_Report.pdf" target="_blank" rel="noopener">Nation-state Turla resurfaces with a Sophisticated RAT</a> – Cyberint (PDF)</li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/system.guid?view=net-7.0" target="_blank" rel="noopener">Guid Struct (System)</a> – Microsoft Learn</li>
<li><a href="https://www.govcert.ch/whitepapers/apt-case-ruag-technical-report-govcert-ch/" target="_blank" rel="noopener">Technical Report about the Malware used in the Cyberespionage against RUAG</a> – Swiss GovCERT</li>
<li><a href="https://securelist.com/turla-renews-its-arsenal-with-topinambour/91687/" target="_blank" rel="noopener">Turla renews its arsenal with Topinambour</a> – Securelist, Kaspersky</li>
<li><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-129a" target="_blank" rel="noopener">Hunting Russian Intelligence “Snake” Malware</a> – Cybersecurity Advisory, CISA</li>
<li><a href="https://attack.mitre.org/techniques/T1070/006/" target="_blank" rel="noopener">Indicator Removal: Timestomp, Sub-technique T1070.006 - Enterprise</a> – MITRE ATT&amp;CK</li>
<li><a href="https://www.recordedfuture.com/turla-apt-infrastructure" target="_blank" rel="noopener">Swallowing the Snake’s Tail: Tracking Turla Infrastructure</a> – Recorded Future</li>
<li><a href="https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/" target="_blank" rel="noopener">Carbon Paper: Peering into Turla’s second stage backdoor</a> – WeLiveSecurity, ESET</li>
<li><a href="https://attack.mitre.org/software/S0335/" target="_blank" rel="noopener">Carbon, Software S0335</a> – MITRE ATT&amp;CK</li>
<li><a href="https://unit42.paloaltonetworks.com/turla-pensive-ursa-threat-assessment/" target="_blank" rel="noopener">Threat Group Assessment: Turla (aka Pensive Ursa)</a> – Unit 42, Palo Alto Networks</li>
</ul>
<p>&nbsp;</p>
      
              </div>
              <!--<span class="post__date">Updated 7 June, 2024 at 11:50 AM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" role="link" title="Advanced Persistent Threat" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:tags:Advanced Persistent Threat">Advanced Persistent Threat</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/backdoor/" role="link" title="backdoor" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:tags:backdoor">Backdoor</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/kazuar/" role="link" title="Kazuar" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:tags:Kazuar">Kazuar</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/pensive-ursa/" role="link" title="Pensive Ursa" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:tags:Pensive Ursa">Pensive Ursa</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/turla/" role="link" title="Turla" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:tags:Turla">Turla</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/uroburos/" role="link" title="Uroburos" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:tags:Uroburos">Uroburos</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/malicious-operations-of-exposed-iam-keys-cryptojacking/" role="link" title="CloudKeys in the Air: Tracking Malicious Operations of Exposed IAM Keys" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:article-nav:CloudKeys in the Air: Tracking Malicious Operations of Exposed IAM Keys"> 
            <span>Next: CloudKeys in the Air: Tracking Malicious Operations of Exposed IAM Keys</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="pensive-ursa-uses-upgraded-kazuar-backdoor:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:sidebar:related-articles:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                      Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:sidebar:related-articles:Inside SnipBot: The Latest RomCom Malware Variant">
                      Inside SnipBot: The Latest RomCom Malware Variant                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:sidebar:related-articles:Threat Assessment: North Korean Threat Groups">
                      Threat Assessment: North Korean Threat Groups                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related  Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of a campaign like Contagious Interview. Digital graphic of a glowing globe with network connections and data streams, symbolizing global connectivity and technology advancements." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                    <h4 class="post-title">Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/social-engineering/" title="social engineering" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:social engineering">Social engineering</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Python">Python</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" title="Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider"  data-card-link="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-video-cta-tracking="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:card:video-modal:Read the article" data-video-title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
              <div class="card-media has-video" data-video="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg">
                              <figure>
                <img width="718" height="440" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg" class="attachment-medium size-medium" alt="A pictorial representation of machine learning detecting vulnerability scanning. A Black man using a tablet with a background of illuminated city buildings at night." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg 718w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-1143x700.jpg 1143w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-768x470.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg 1505w" sizes="(max-width: 718px) 100vw, 718px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
                    <h4 class="post-title">Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" title="Machine Learning" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Machine Learning">Machine Learning</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of keylogger malware like KLogEXE and FPSpy. Person working on a laptop with lines of code displayed on the screen, with a blurred effect indicating motion or activity, surrounded by a vivid blue and red lighting." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                    <h4 class="post-title">Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/keylogger/" title="Keylogger" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Keylogger">Keylogger</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" title="Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of SnipBot. Digital abstract background featuring binary code and technology symbols with a blue glow in the shape of a skull." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant">
                    <h4 class="post-title">Inside SnipBot: The Latest RomCom Malware Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/romcom/" title="RomCom" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:RomCom">RomCom</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" title="Inside SnipBot: The Latest RomCom Malware Variant" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of a red team tool like Splinter. A digital illustration showing a 3D brain model surrounded by rising data columns on a circuit board, representing advanced artificial intelligence technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool">
                    <h4 class="post-title">Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/red-teaming-tool/" title="red teaming tool" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:red teaming tool">Red teaming tool</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/pentest-tool/" title="pentest tool" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:pentest tool">Pentest tool</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" title="Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT groups from North Korea. The silhouette of two fish and the Pisces constellation inside an orange abstract planet, surrounded by two larger blue fish. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors">
                    <h4 class="post-title">Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Cryptocurrency">Cryptocurrency</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" title="Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Illustrative image featuring two fish and the Pisces constellation superimposed on a stylized, abstract background with flowing purple waves and a starry night sky." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Threat Assessment: North Korean Threat Groups">
                    <h4 class="post-title">Threat Assessment: North Korean Threat Groups</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-access-trojan/" title="Remote Access Trojan" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:Remote Access Trojan">Remote Access Trojan</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/finance/" title="Finance" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:Finance">Finance</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" title="Threat Assessment: North Korean Threat Groups" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of Stately Taurus&#039; updated TTPs. Illustration of a bull&#039;s head and the Taurus constellation inside a stylized orange moon, set against the profile of a much larger bull&#039;s head. Shooting stars are on the dark background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia">
                    <h4 class="post-title">Chinese APT Abuses VSCode to Target Government in Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" title="Chinese APT Abuses VSCode to Target Government in Asia" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of malware such as WikiLoader. Red and blue digital data flowing from microchips on a circuit board, representing high-tech computing." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant">
                    <h4 class="post-title">Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/malvertising/" title="malvertising" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:malvertising">Malvertising</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:DLL Sideloading">DLL Sideloading</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" title="Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT Fighting Ursa. The silhouette of a bear and the Ursa constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple claw marks, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale">
                    <h4 class="post-title">Fighting Ursa Luring Targets With Car for Sale</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/apt28/" title="APT28" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:APT28">APT28</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/fancy-bear/" title="Fancy Bear" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:Fancy Bear">Fancy Bear</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" title="Fighting Ursa Luring Targets With Car for Sale" role="link" data-page-track="true" data-page-track-value="pensive-ursa-uses-upgraded-kazuar-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/pensive-ursa-uses-upgraded-kazuar-backdoor/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/pensive-ursa-uses-upgraded-kazuar-backdoor/">JAPAN (日本語)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
