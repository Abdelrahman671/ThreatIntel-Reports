<!doctype html><html lang="en"><head><title data-rh="true">Dad! There’s A Rat In Here!. An analysis of the DADSTACHE sample… | by asuna amawaka | insomniacs | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-03-15T16:37:39.728Z"/><meta data-rh="true" name="title" content="Dad! There’s A Rat In Here!. An analysis of the DADSTACHE sample… | by asuna amawaka | insomniacs | Medium"/><meta data-rh="true" property="og:title" content="Dad! There’s A Rat In Here!"/><meta data-rh="true" property="al:android:url" content="medium://p/e3729b65bf7a"/><meta data-rh="true" property="al:ios:url" content="medium://p/e3729b65bf7a"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="As promised in my last post, I’ll be doing a walkthrough of the DADSTACHE sample fetched by the maldoc (MD5: 571efe3a29ed1f6c1f98576cb57db8a5) found off VirusTotal in late Feb 2020. After completing…"/><meta data-rh="true" property="og:description" content="An analysis of the DADSTACHE sample fetched by the maldoc (MD5 571efe3a29ed1f6c1f98576cb57db8a5). DADSTACHE is believed to be used by…"/><meta data-rh="true" property="og:url" content="https://medium.com/insomniacs/dad-theres-a-rat-in-here-e3729b65bf7a"/><meta data-rh="true" property="al:web:url" content="https://medium.com/insomniacs/dad-theres-a-rat-in-here-e3729b65bf7a"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:538/1*klsY3EzO2-_cNcWUeT1e4A.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@asuna.amawaka"/><meta data-rh="true" name="author" content="asuna amawaka"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Dad! There’s A Rat In Here!"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/e3729b65bf7a"/><meta data-rh="true" property="twitter:description" content="An analysis of the DADSTACHE sample fetched by the maldoc (MD5 571efe3a29ed1f6c1f98576cb57db8a5). DADSTACHE is believed to be used by…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:538/1*klsY3EzO2-_cNcWUeT1e4A.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="6 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@asuna.amawaka"/><link data-rh="true" rel="canonical" href="https://medium.com/insomniacs/dad-theres-a-rat-in-here-e3729b65bf7a"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/e3729b65bf7a"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*klsY3EzO2-_cNcWUeT1e4A.png"],"url":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fdad-theres-a-rat-in-here-e3729b65bf7a","dateCreated":"2020-03-15T16:37:39.728Z","datePublished":"2020-03-15T16:37:39.728Z","dateModified":"2021-12-13T20:34:34.453Z","headline":"Dad! There’s A Rat In Here! - insomniacs - Medium","name":"Dad! There’s A Rat In Here! - insomniacs - Medium","description":"As promised in my last post, I’ll be doing a walkthrough of the DADSTACHE sample fetched by the maldoc (MD5: 571efe3a29ed1f6c1f98576cb57db8a5) found off VirusTotal in late Feb 2020. After completing…","identifier":"e3729b65bf7a","author":{"@type":"Person","name":"asuna amawaka","url":"https:\u002F\u002Fmedium.com\u002F@asuna.amawaka"},"creator":["asuna amawaka"],"publisher":{"@type":"Organization","name":"insomniacs","url":"https:\u002F\u002Fmedium.com\u002Finsomniacs","logo":{"@type":"ImageObject","width":60,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:120\u002F1*IvMGfHVzEtZei5I-JouCvw.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fdad-theres-a-rat-in-here-e3729b65bf7a"}</script><style type="text/css" data-fela-rehydration="559" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="559" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{margin-left:auto}.nv{margin-right:auto}.nw{max-width:295px}.oc{clear:both}.od{height:auto}.oe{max-width:462px}.of{max-width:558px}.og{max-width:569px}.oh{max-width:572px}.oi{font-style:italic}.oj{max-width:410px}.ok{max-width:497px}.ol{max-width:552px}.om{max-width:468px}.on{max-width:363px}.oo{max-width:624px}.op{max-width:522px}.oq{max-width:324px}.or{max-width:623px}.os{list-style-type:disc}.ot{margin-left:30px}.ou{padding-left:0px}.pa{max-width:540px}.pb{max-width:637px}.pc{max-width:1221px}.pe{cursor:zoom-in}.pf{z-index:auto}.ph{max-width:538px}.pn{box-shadow:inset 0 0 0 1px #F2F2F2}.po{padding:0px}.pp{padding:16px 20px}.pq{flex:1 1 auto}.ps{max-height:40px}.pt{-webkit-line-clamp:2}.pu{margin-top:8px}.pv{margin-top:12px}.pw{width:160px}.px{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*8K8Ai9YgVFxHmIUP)}.py{background-origin:border-box}.pz{background-size:cover}.qa{height:167px}.qb{background-position:50% 50%}.qc{margin-bottom:26px}.qd{margin-top:6px}.qe{margin-right:8px}.qf{padding:8px 16px}.qg{border-radius:100px}.qh{transition:background 300ms ease}.qj{white-space:nowrap}.qk{border-top:none}.ql{margin-bottom:14px}.qm{height:52px}.qn{max-height:52px}.qo{box-sizing:content-box}.qp{position:static}.qr{max-width:155px}.qx{margin-right:20px}.rd{height:0px}.re{margin-bottom:40px}.rf{margin-bottom:48px}.rt{border-radius:2px}.rv{height:64px}.rw{width:64px}.rx{align-self:flex-end}.sd{padding-right:4px}.se{font-weight:500}.sr{margin-top:16px}.ss{color:rgba(255, 255, 255, 1)}.st{fill:rgba(255, 255, 255, 1)}.su{background:rgba(25, 25, 25, 1)}.sv{border-color:rgba(25, 25, 25, 1)}.sy:disabled{opacity:0.1}.sz:disabled:hover{background:rgba(25, 25, 25, 1)}.ta:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tb{margin-bottom:54px}.tw{gap:18px}.tx{fill:rgba(61, 61, 61, 1)}.uj{border-bottom:solid 1px #E5E5E5}.uk{margin-top:72px}.ul{padding:24px 0}.um{margin-bottom:0px}.un{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.qi:hover{background-color:#F2F2F2}.ru:hover{background-color:none}.sw:hover{background:#000000}.sx:hover{border-color:#242424}.ty:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.pg:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.ob{margin-top:56px}.oz{margin-top:1.14em}.pm{margin-top:32px}.qw{display:inline-block}.rc{margin-bottom:104px}.rg{flex-direction:row}.rj{margin-bottom:0}.rk{margin-right:20px}.ry{max-width:500px}.sp{line-height:24px}.sq{letter-spacing:0}.tg{margin-bottom:72px}.tt{font-size:24px}.tu{line-height:30px}.tv{letter-spacing:-0.016em}.ud{margin:40px 0 0}.ui{padding-top:72px}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.qv{display:inline-block}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.qu{display:inline-block}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.pr{padding:10px 12px 10px}.qt{display:inline-block}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.nx{margin-top:40px}.ov{margin-top:1.34em}.pi{margin-top:24px}.qs{display:inline-block}.qy{margin-bottom:96px}.rr{margin-bottom:20px}.rs{margin-right:0}.sc{max-width:100%}.sf{font-size:24px}.sg{line-height:30px}.sh{letter-spacing:-0.016em}.tc{margin-bottom:64px}.th{font-size:20px}.ti{line-height:24px}.tj{letter-spacing:0}.tz{margin:32px 0 0}.ue{padding-top:48px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.oa{margin-top:56px}.oy{margin-top:1.14em}.pl{margin-top:32px}.rb{margin-bottom:104px}.rh{flex-direction:row}.rl{margin-bottom:0}.rm{margin-right:20px}.rz{max-width:500px}.sn{line-height:24px}.so{letter-spacing:0}.tf{margin-bottom:72px}.tq{font-size:24px}.tr{line-height:30px}.ts{letter-spacing:-0.016em}.uc{margin:40px 0 0}.uh{padding-top:72px}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.nz{margin-top:56px}.ox{margin-top:1.14em}.pk{margin-top:32px}.ra{margin-bottom:104px}.ri{flex-direction:row}.rn{margin-bottom:0}.ro{margin-right:20px}.sa{max-width:500px}.sl{line-height:24px}.sm{letter-spacing:0}.te{margin-bottom:72px}.tn{font-size:24px}.to{line-height:30px}.tp{letter-spacing:-0.016em}.ub{margin:40px 0 0}.ug{padding-top:72px}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.ny{margin-top:40px}.ow{margin-top:1.34em}.pj{margin-top:24px}.qz{margin-bottom:96px}.rp{margin-bottom:20px}.rq{margin-right:0}.sb{max-width:100%}.si{font-size:24px}.sj{line-height:30px}.sk{letter-spacing:-0.016em}.td{margin-bottom:64px}.tk{font-size:20px}.tl{line-height:24px}.tm{letter-spacing:0}.ua{margin:32px 0 0}.uf{padding-top:48px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="print">.qq{display:none}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="559" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pd{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3729b65bf7a&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="7019" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Dad! There’s A Rat In Here!</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@asuna.amawaka?source=post_page---byline--e3729b65bf7a--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="asuna amawaka" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*La4u414Rn4EMK1D8bYBRag.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/insomniacs?source=post_page---byline--e3729b65bf7a--------------------------------" rel="noopener follow"><div class="l ii ij by id ik"><div class="l fj"><img alt="insomniacs" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@asuna.amawaka?source=post_page---byline--e3729b65bf7a--------------------------------">asuna amawaka</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddd44ddb6480&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=post_page-ddd44ddb6480--byline--e3729b65bf7a---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/insomniacs?source=post_page---byline--e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">insomniacs</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Mar 15, 2020</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2Fe3729b65bf7a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---header_actions--e3729b65bf7a---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3729b65bf7a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;source=---header_actions--e3729b65bf7a---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="3d84" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">As promised in my last post, I’ll be doing a walkthrough of the DADSTACHE sample fetched by the maldoc (MD5: 571efe3a29ed1f6c1f98576cb57db8a5) found off VirusTotal in late Feb 2020. After completing my analysis, I realized that a thorough “walkthrough” is not necessary as the beaconing code logic is simple enough. I think the toughest part was to make IDA Pro take in the final payload encrypted within the sample so that I can do static analysis. Hence, I decided to dedicate most of this post to my approach to unveiling the final payload ;) The second half would be a documentation of my findings.</p><p id="e4f4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">DADSTACHE sample analysed:<br/>009a9f7024c4dd5db8e3d793be3e99c0 dbgeng.dll</p><p id="2f77" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Let’s Tuck In!</strong></p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv nw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*31FLsjmayOtgGA-GB9K0ow.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*31FLsjmayOtgGA-GB9K0ow.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*31FLsjmayOtgGA-GB9K0ow.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*31FLsjmayOtgGA-GB9K0ow.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*31FLsjmayOtgGA-GB9K0ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*31FLsjmayOtgGA-GB9K0ow.png 1100w, https://miro.medium.com/v2/resize:fit:590/format:webp/1*31FLsjmayOtgGA-GB9K0ow.png 590w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 295px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*31FLsjmayOtgGA-GB9K0ow.png 640w, https://miro.medium.com/v2/resize:fit:720/1*31FLsjmayOtgGA-GB9K0ow.png 720w, https://miro.medium.com/v2/resize:fit:750/1*31FLsjmayOtgGA-GB9K0ow.png 750w, https://miro.medium.com/v2/resize:fit:786/1*31FLsjmayOtgGA-GB9K0ow.png 786w, https://miro.medium.com/v2/resize:fit:828/1*31FLsjmayOtgGA-GB9K0ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*31FLsjmayOtgGA-GB9K0ow.png 1100w, https://miro.medium.com/v2/resize:fit:590/1*31FLsjmayOtgGA-GB9K0ow.png 590w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 295px"/><img alt="" class="bh md od c" width="295" height="52" loading="eager" role="presentation"/></picture></div></figure><p id="3892" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">There are 2 exported functions, we can quickly see that DebugCreate is the interesting one, with tell-tale API calls.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Cr1BMCTAZev-Oi4U6cdXTA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Cr1BMCTAZev-Oi4U6cdXTA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Cr1BMCTAZev-Oi4U6cdXTA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Cr1BMCTAZev-Oi4U6cdXTA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Cr1BMCTAZev-Oi4U6cdXTA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Cr1BMCTAZev-Oi4U6cdXTA.png 1100w, https://miro.medium.com/v2/resize:fit:924/format:webp/1*Cr1BMCTAZev-Oi4U6cdXTA.png 924w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 462px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Cr1BMCTAZev-Oi4U6cdXTA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Cr1BMCTAZev-Oi4U6cdXTA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Cr1BMCTAZev-Oi4U6cdXTA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Cr1BMCTAZev-Oi4U6cdXTA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Cr1BMCTAZev-Oi4U6cdXTA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Cr1BMCTAZev-Oi4U6cdXTA.png 1100w, https://miro.medium.com/v2/resize:fit:924/1*Cr1BMCTAZev-Oi4U6cdXTA.png 924w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 462px"/><img alt="" class="bh md od c" width="462" height="747" loading="lazy" role="presentation"/></picture></div></figure><p id="ba2f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Looks like an AES encryption, using 0x40 bytes as a “seed” to derive the key. The easiest way to arrive at the decrypted content is to run the sample and read the decrypted content from memory.</p><p id="b2ac" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The content hardcoded in offset 100127B4 looks like this:</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv of"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qf64par6_7l8fq5qfpOSqw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qf64par6_7l8fq5qfpOSqw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qf64par6_7l8fq5qfpOSqw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qf64par6_7l8fq5qfpOSqw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qf64par6_7l8fq5qfpOSqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qf64par6_7l8fq5qfpOSqw.png 1100w, https://miro.medium.com/v2/resize:fit:1116/format:webp/1*qf64par6_7l8fq5qfpOSqw.png 1116w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 558px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qf64par6_7l8fq5qfpOSqw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qf64par6_7l8fq5qfpOSqw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qf64par6_7l8fq5qfpOSqw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qf64par6_7l8fq5qfpOSqw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qf64par6_7l8fq5qfpOSqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qf64par6_7l8fq5qfpOSqw.png 1100w, https://miro.medium.com/v2/resize:fit:1116/1*qf64par6_7l8fq5qfpOSqw.png 1116w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 558px"/><img alt="" class="bh md od c" width="558" height="356" loading="lazy" role="presentation"/></picture></div></figure><p id="7595" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">After decryption, the following content is seen:</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv og"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VXCgjTwucMGXtT4EtxEkDw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VXCgjTwucMGXtT4EtxEkDw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VXCgjTwucMGXtT4EtxEkDw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VXCgjTwucMGXtT4EtxEkDw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VXCgjTwucMGXtT4EtxEkDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VXCgjTwucMGXtT4EtxEkDw.png 1100w, https://miro.medium.com/v2/resize:fit:1138/format:webp/1*VXCgjTwucMGXtT4EtxEkDw.png 1138w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 569px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VXCgjTwucMGXtT4EtxEkDw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VXCgjTwucMGXtT4EtxEkDw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VXCgjTwucMGXtT4EtxEkDw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VXCgjTwucMGXtT4EtxEkDw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VXCgjTwucMGXtT4EtxEkDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VXCgjTwucMGXtT4EtxEkDw.png 1100w, https://miro.medium.com/v2/resize:fit:1138/1*VXCgjTwucMGXtT4EtxEkDw.png 1138w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 569px"/><img alt="" class="bh md od c" width="569" height="343" loading="lazy" role="presentation"/></picture></div></figure><p id="9869" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Continuing dynamic analysis showed that the decrypted payload is mapped into memory and then its OEP is called.</p><p id="bfeb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now, I would like to analyze the actual payload with IDA Pro, but the content dumped from memory doesn’t look like a proper PE file and hence the IAT can’t be recognized (though I can actually see the import table in there).</p><p id="0c5c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Dump &amp; Fix</strong></p><p id="6f88" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Dump the decrypted file after it has been mapped to memory in sub_10001920. A good place to do this would be after this function ends.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv oh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LqOmIjsZYCSl25_St99hlg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LqOmIjsZYCSl25_St99hlg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LqOmIjsZYCSl25_St99hlg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LqOmIjsZYCSl25_St99hlg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LqOmIjsZYCSl25_St99hlg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LqOmIjsZYCSl25_St99hlg.png 1100w, https://miro.medium.com/v2/resize:fit:1144/format:webp/1*LqOmIjsZYCSl25_St99hlg.png 1144w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 572px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*LqOmIjsZYCSl25_St99hlg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LqOmIjsZYCSl25_St99hlg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LqOmIjsZYCSl25_St99hlg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LqOmIjsZYCSl25_St99hlg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LqOmIjsZYCSl25_St99hlg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LqOmIjsZYCSl25_St99hlg.png 1100w, https://miro.medium.com/v2/resize:fit:1144/1*LqOmIjsZYCSl25_St99hlg.png 1144w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 572px"/><img alt="" class="bh md od c" width="572" height="415" loading="lazy" role="presentation"/></picture></div></figure><p id="2e32" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="oi">Repairing the decrypted file’s PE header</em></p><p id="8296" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The first 0x11C bytes of this extracted memory looked “wrong” — I would expect it to be following the structure of a PE header, but the “DOS Header” and part of the “NT Header” are missing. I can kind of recognize some of the fields in the “NT Header” from this chunk, which means that the content before these fields are intentionally “corrupted”.</p><p id="be19" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I confirmed that these 0x11C bytes are not some kind of meaningful shell code:</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv oj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ghVUYxAkk-kQnmKht4hLDA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ghVUYxAkk-kQnmKht4hLDA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ghVUYxAkk-kQnmKht4hLDA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ghVUYxAkk-kQnmKht4hLDA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ghVUYxAkk-kQnmKht4hLDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ghVUYxAkk-kQnmKht4hLDA.png 1100w, https://miro.medium.com/v2/resize:fit:820/format:webp/1*ghVUYxAkk-kQnmKht4hLDA.png 820w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 410px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ghVUYxAkk-kQnmKht4hLDA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ghVUYxAkk-kQnmKht4hLDA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ghVUYxAkk-kQnmKht4hLDA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ghVUYxAkk-kQnmKht4hLDA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ghVUYxAkk-kQnmKht4hLDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ghVUYxAkk-kQnmKht4hLDA.png 1100w, https://miro.medium.com/v2/resize:fit:820/1*ghVUYxAkk-kQnmKht4hLDA.png 820w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 410px"/><img alt="" class="bh md od c" width="410" height="274" loading="lazy" role="presentation"/></picture></div></figure><p id="fa64" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">From the dynamic analysis done up to this point, the OEP of the decrypted file in binary is 0x57E4 (called from the function sub_10001FF0). This helps to confirm that the PE header is only corrupted up till the “Machine” field in the “NT Header”.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv ok"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZhEPLQIE6u-qopj_bNd2pA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZhEPLQIE6u-qopj_bNd2pA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZhEPLQIE6u-qopj_bNd2pA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZhEPLQIE6u-qopj_bNd2pA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZhEPLQIE6u-qopj_bNd2pA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZhEPLQIE6u-qopj_bNd2pA.png 1100w, https://miro.medium.com/v2/resize:fit:994/format:webp/1*ZhEPLQIE6u-qopj_bNd2pA.png 994w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 497px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZhEPLQIE6u-qopj_bNd2pA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZhEPLQIE6u-qopj_bNd2pA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZhEPLQIE6u-qopj_bNd2pA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZhEPLQIE6u-qopj_bNd2pA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZhEPLQIE6u-qopj_bNd2pA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZhEPLQIE6u-qopj_bNd2pA.png 1100w, https://miro.medium.com/v2/resize:fit:994/1*ZhEPLQIE6u-qopj_bNd2pA.png 994w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 497px"/><img alt="" class="bh md od c" width="497" height="327" loading="lazy" role="presentation"/></picture></div></figure><p id="541c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">So, let’s fix it! I’m going to copy the PE header of the parent binary, which is only 0x10C in size before the “Machine” field, to overwrite the corrupted 0x11C of header. Since we don’t care about what is actually in this header, other than the offset e_lfanew that needs to be corrected, I’m just going to pad 0x10 worth of values so as not to mess up all the other offsets (like the import table address) in the file. Of course, you may also wish to just fill up 0x11C bytes of your choice, just need to be sure the “MZ” “PE” and e_lfanew are correct.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv ol"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7uaKRZhlEuXfPiXCxggd8w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7uaKRZhlEuXfPiXCxggd8w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7uaKRZhlEuXfPiXCxggd8w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7uaKRZhlEuXfPiXCxggd8w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7uaKRZhlEuXfPiXCxggd8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7uaKRZhlEuXfPiXCxggd8w.png 1100w, https://miro.medium.com/v2/resize:fit:1104/format:webp/1*7uaKRZhlEuXfPiXCxggd8w.png 1104w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 552px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7uaKRZhlEuXfPiXCxggd8w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7uaKRZhlEuXfPiXCxggd8w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7uaKRZhlEuXfPiXCxggd8w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7uaKRZhlEuXfPiXCxggd8w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7uaKRZhlEuXfPiXCxggd8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7uaKRZhlEuXfPiXCxggd8w.png 1100w, https://miro.medium.com/v2/resize:fit:1104/1*7uaKRZhlEuXfPiXCxggd8w.png 1104w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 552px"/><img alt="" class="bh md od c" width="552" height="399" loading="lazy" role="presentation"/></picture></div></figure><p id="4447" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now, using a tool like CFF Explorer would help to confirm if the edits have been successful. The last step is to fix the section raw addresses so that IDA Pro will be able to do its magic for us. A trick that I usually apply to binaries that I dumped from memory, is to copy the values from the “Virtual Address” column to the “Raw Address” column.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv om"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3qEh_FCBDLvMqRNwb4ok2A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3qEh_FCBDLvMqRNwb4ok2A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3qEh_FCBDLvMqRNwb4ok2A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3qEh_FCBDLvMqRNwb4ok2A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3qEh_FCBDLvMqRNwb4ok2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3qEh_FCBDLvMqRNwb4ok2A.png 1100w, https://miro.medium.com/v2/resize:fit:936/format:webp/1*3qEh_FCBDLvMqRNwb4ok2A.png 936w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 468px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3qEh_FCBDLvMqRNwb4ok2A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3qEh_FCBDLvMqRNwb4ok2A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3qEh_FCBDLvMqRNwb4ok2A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3qEh_FCBDLvMqRNwb4ok2A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3qEh_FCBDLvMqRNwb4ok2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3qEh_FCBDLvMqRNwb4ok2A.png 1100w, https://miro.medium.com/v2/resize:fit:936/1*3qEh_FCBDLvMqRNwb4ok2A.png 936w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 468px"/><img alt="" class="bh md od c" width="468" height="105" loading="lazy" role="presentation"/></picture></div></figure><p id="bf53" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">With this, the import/export table would be nicely pointed to.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv on"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*p9HQtWtkaS1R3SSz6o1MNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*p9HQtWtkaS1R3SSz6o1MNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*p9HQtWtkaS1R3SSz6o1MNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*p9HQtWtkaS1R3SSz6o1MNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*p9HQtWtkaS1R3SSz6o1MNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*p9HQtWtkaS1R3SSz6o1MNQ.png 1100w, https://miro.medium.com/v2/resize:fit:726/format:webp/1*p9HQtWtkaS1R3SSz6o1MNQ.png 726w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 363px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*p9HQtWtkaS1R3SSz6o1MNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*p9HQtWtkaS1R3SSz6o1MNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*p9HQtWtkaS1R3SSz6o1MNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*p9HQtWtkaS1R3SSz6o1MNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*p9HQtWtkaS1R3SSz6o1MNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*p9HQtWtkaS1R3SSz6o1MNQ.png 1100w, https://miro.medium.com/v2/resize:fit:726/1*p9HQtWtkaS1R3SSz6o1MNQ.png 726w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 363px"/><img alt="" class="bh md od c" width="363" height="122" loading="lazy" role="presentation"/></picture></div></figure><p id="7836" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Since the RICH header portion of the PE header is lost, we are not able to perform analysis on that. Fortunately, there’s still one value that is intact, and that is the compilation date: 23 Dec 2019 17:15:32. This file is compiled about 1 hour before its parent file (which has compilation timestamp 23 Dec 2019 18:17:44). This might suggest that the file is manually compiled into the parent file, and not through a generator.</p><p id="4d06" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Finally, DADSTACHE</strong></p><p id="f0db" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The first thing that the malware does is to update its configuration placeholder with the actual configuration (decrypted above).</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv oo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7Qylz6zlPWj4zSt5b6zfaQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7Qylz6zlPWj4zSt5b6zfaQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7Qylz6zlPWj4zSt5b6zfaQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7Qylz6zlPWj4zSt5b6zfaQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7Qylz6zlPWj4zSt5b6zfaQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7Qylz6zlPWj4zSt5b6zfaQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*7Qylz6zlPWj4zSt5b6zfaQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7Qylz6zlPWj4zSt5b6zfaQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7Qylz6zlPWj4zSt5b6zfaQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7Qylz6zlPWj4zSt5b6zfaQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7Qylz6zlPWj4zSt5b6zfaQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7Qylz6zlPWj4zSt5b6zfaQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7Qylz6zlPWj4zSt5b6zfaQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*7Qylz6zlPWj4zSt5b6zfaQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bh md od c" width="624" height="175" loading="lazy" role="presentation"/></picture></div></figure><p id="af87" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Then it proceeds to do the beaconing, which comprises of AES-encrypted contents within HTTP POST requests.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv op"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ToDdltYldYm6iQP7OkduWA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ToDdltYldYm6iQP7OkduWA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ToDdltYldYm6iQP7OkduWA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ToDdltYldYm6iQP7OkduWA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ToDdltYldYm6iQP7OkduWA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ToDdltYldYm6iQP7OkduWA.png 1100w, https://miro.medium.com/v2/resize:fit:1044/format:webp/1*ToDdltYldYm6iQP7OkduWA.png 1044w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 522px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ToDdltYldYm6iQP7OkduWA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ToDdltYldYm6iQP7OkduWA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ToDdltYldYm6iQP7OkduWA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ToDdltYldYm6iQP7OkduWA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ToDdltYldYm6iQP7OkduWA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ToDdltYldYm6iQP7OkduWA.png 1100w, https://miro.medium.com/v2/resize:fit:1044/1*ToDdltYldYm6iQP7OkduWA.png 1044w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 522px"/><img alt="" class="bh md od c" width="522" height="314" loading="lazy" role="presentation"/></picture></div></figure><p id="f431" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="oi">AES Encrypted Network Communication</em></p><p id="4fdd" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">One point to note is that the configuration within the malware decides whether the HTTP requests will be wrapped with SSL or not. It is an additional layer of “security” for the C2 communications. Regardless, we’ll look at what is sent to and expected from the C2.</p><p id="05d3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following structure is AES-encrypted then sent to the C2. The AES key is found within the configuration data.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TY78IXVk4eRUms8xlnNAtw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TY78IXVk4eRUms8xlnNAtw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TY78IXVk4eRUms8xlnNAtw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TY78IXVk4eRUms8xlnNAtw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TY78IXVk4eRUms8xlnNAtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TY78IXVk4eRUms8xlnNAtw.png 1100w, https://miro.medium.com/v2/resize:fit:648/format:webp/1*TY78IXVk4eRUms8xlnNAtw.png 648w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 324px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*TY78IXVk4eRUms8xlnNAtw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TY78IXVk4eRUms8xlnNAtw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TY78IXVk4eRUms8xlnNAtw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TY78IXVk4eRUms8xlnNAtw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TY78IXVk4eRUms8xlnNAtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TY78IXVk4eRUms8xlnNAtw.png 1100w, https://miro.medium.com/v2/resize:fit:648/1*TY78IXVk4eRUms8xlnNAtw.png 648w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 324px"/><img alt="" class="bh md od c" width="324" height="71" loading="lazy" role="presentation"/></picture></div></figure><p id="c405" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">A quick python script can help with confirming that the content sent to the C2 is indeed AES-encrypted with the key from the configuration data.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv or"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oFzYrwSECgswi7B_nKva6g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oFzYrwSECgswi7B_nKva6g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oFzYrwSECgswi7B_nKva6g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oFzYrwSECgswi7B_nKva6g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oFzYrwSECgswi7B_nKva6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oFzYrwSECgswi7B_nKva6g.png 1100w, https://miro.medium.com/v2/resize:fit:1246/format:webp/1*oFzYrwSECgswi7B_nKva6g.png 1246w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 623px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*oFzYrwSECgswi7B_nKva6g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oFzYrwSECgswi7B_nKva6g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oFzYrwSECgswi7B_nKva6g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oFzYrwSECgswi7B_nKva6g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oFzYrwSECgswi7B_nKva6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oFzYrwSECgswi7B_nKva6g.png 1100w, https://miro.medium.com/v2/resize:fit:1246/1*oFzYrwSECgswi7B_nKva6g.png 1246w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 623px"/><img alt="" class="bh md od c" width="623" height="333" loading="lazy" role="presentation"/></picture></div></figure><p id="c689" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Once there is a status 200 response from the C2 server for the above beacon, the malware will then proceed to do further information collection, and await commands from the C2.</p><p id="c90a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following information are being collected from the victim’s machine and then written into %temp%\\~liscen3.tmp:</p><ul class=""><li id="50ec" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt os ot ou bk">Recent files</li><li id="9581" class="mw mx gu my b mz ov nb nc nd ow nf ng nh ox nj nk nl oy nn no np oz nr ns nt os ot ou bk">Installed programs</li><li id="b1bc" class="mw mx gu my b mz ov nb nc nd ow nf ng nh ox nj nk nl oy nn no np oz nr ns nt os ot ou bk">Drives</li><li id="7627" class="mw mx gu my b mz ov nb nc nd ow nf ng nh ox nj nk nl oy nn no np oz nr ns nt os ot ou bk">Count of cursor staying in one position</li></ul><p id="288d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">One of the information collected is to count the number of times that the cursor stayed in one position on screen — I suspect this is for the attacker to know if the binary is being executed in a sandbox instead of a real victim.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv pa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IvbfPn0eihqpcWKwAibn8A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IvbfPn0eihqpcWKwAibn8A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IvbfPn0eihqpcWKwAibn8A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IvbfPn0eihqpcWKwAibn8A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IvbfPn0eihqpcWKwAibn8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IvbfPn0eihqpcWKwAibn8A.png 1100w, https://miro.medium.com/v2/resize:fit:1080/format:webp/1*IvbfPn0eihqpcWKwAibn8A.png 1080w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 540px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IvbfPn0eihqpcWKwAibn8A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IvbfPn0eihqpcWKwAibn8A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IvbfPn0eihqpcWKwAibn8A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IvbfPn0eihqpcWKwAibn8A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IvbfPn0eihqpcWKwAibn8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IvbfPn0eihqpcWKwAibn8A.png 1100w, https://miro.medium.com/v2/resize:fit:1080/1*IvbfPn0eihqpcWKwAibn8A.png 1080w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 540px"/><img alt="" class="bh md od c" width="540" height="228" loading="lazy" role="presentation"/></picture></div></figure><p id="cc8c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The content to send to the C2 would be read from %temp%\\~liscen3.tmp into a buffer and then the file is deleted.</p><p id="aa04" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Before sending the above in another AES-encrypted POST request, an additional 0x208 bytes of data (path of ~liscen3.tmp and “Client\&lt;ip&gt;_&lt;computername&gt;\Disinfo.txt”), followed by 8 bytes to indicate the start and end offsets of collected data within ~liscen3.tmp, are pre-pended to the buffer.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv pb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Xk0JafYLLmq_Kf3XKKZXng.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Xk0JafYLLmq_Kf3XKKZXng.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Xk0JafYLLmq_Kf3XKKZXng.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Xk0JafYLLmq_Kf3XKKZXng.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Xk0JafYLLmq_Kf3XKKZXng.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Xk0JafYLLmq_Kf3XKKZXng.png 1100w, https://miro.medium.com/v2/resize:fit:1274/format:webp/1*Xk0JafYLLmq_Kf3XKKZXng.png 1274w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 637px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Xk0JafYLLmq_Kf3XKKZXng.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Xk0JafYLLmq_Kf3XKKZXng.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Xk0JafYLLmq_Kf3XKKZXng.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Xk0JafYLLmq_Kf3XKKZXng.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Xk0JafYLLmq_Kf3XKKZXng.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Xk0JafYLLmq_Kf3XKKZXng.png 1100w, https://miro.medium.com/v2/resize:fit:1274/1*Xk0JafYLLmq_Kf3XKKZXng.png 1274w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 637px"/><img alt="" class="bh md od c" width="637" height="363" loading="lazy" role="presentation"/></picture></div></figure><p id="6be7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The Command ID received from the C2 server is not expected to be encrypted, but the parameters used within the command are AES-encrypted with the same key as configured within the malware.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div role="button" tabindex="0" class="pd pe fj pf bh pg"><div class="nu nv pc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iNa6aXWIXskbEp_u3onGjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iNa6aXWIXskbEp_u3onGjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iNa6aXWIXskbEp_u3onGjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iNa6aXWIXskbEp_u3onGjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iNa6aXWIXskbEp_u3onGjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iNa6aXWIXskbEp_u3onGjQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNa6aXWIXskbEp_u3onGjQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iNa6aXWIXskbEp_u3onGjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iNa6aXWIXskbEp_u3onGjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iNa6aXWIXskbEp_u3onGjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iNa6aXWIXskbEp_u3onGjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iNa6aXWIXskbEp_u3onGjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iNa6aXWIXskbEp_u3onGjQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*iNa6aXWIXskbEp_u3onGjQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md od c" width="700" height="213" loading="lazy" role="presentation"/></picture></div></div></figure><p id="0634" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">If there are no commands received from the C2 server for a period of time (up to 3 seconds), the malware sends a GET request for /list_direction to the C2, possibly as an attempt to get a new command.</p><figure class="nx ny nz oa ob oc nu nv paragraph-image"><div class="nu nv ph"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*klsY3EzO2-_cNcWUeT1e4A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*klsY3EzO2-_cNcWUeT1e4A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*klsY3EzO2-_cNcWUeT1e4A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*klsY3EzO2-_cNcWUeT1e4A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*klsY3EzO2-_cNcWUeT1e4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*klsY3EzO2-_cNcWUeT1e4A.png 1100w, https://miro.medium.com/v2/resize:fit:1076/format:webp/1*klsY3EzO2-_cNcWUeT1e4A.png 1076w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 538px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*klsY3EzO2-_cNcWUeT1e4A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*klsY3EzO2-_cNcWUeT1e4A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*klsY3EzO2-_cNcWUeT1e4A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*klsY3EzO2-_cNcWUeT1e4A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*klsY3EzO2-_cNcWUeT1e4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*klsY3EzO2-_cNcWUeT1e4A.png 1100w, https://miro.medium.com/v2/resize:fit:1076/1*klsY3EzO2-_cNcWUeT1e4A.png 1076w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 538px"/><img alt="" class="bh md od c" width="538" height="317" loading="lazy" role="presentation"/></picture></div></figure><p id="f8c3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">After-analysis thoughts</strong></p><p id="b7b9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">There we go, a straight-forward and light-weight RAT. The next thing I would like to do is to compare this latest DADSTACHE sample with the older ones, and other malware families known to be used by APT40. Who knows what interesting findings await?</p><p id="9f08" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">~~</p><div class="pi pj pk pl pm pn"><a href="https://twitter.com/AsunaAmawaka?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="po ab ix"><div class="pp ab co cb pq pr"><h2 class="bf gv io z jf ps jh ji pt jk jm gt bk">Asuna</h2><div class="pu l"><h3 class="bf b io z jf ps jh ji pt jk jm du">The latest Tweets from Asuna (@AsunaAmawaka). [Malware Analyst]. Binary World</h3></div><div class="pv l"><p class="bf b dv z jf ps jh ji pt jk jm du">twitter.com</p></div></div><div class="pw l"><div class="px l py pz qa pw qb md pn"></div></div></div></a></div><p id="35fb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Drop me a DM if you would like to share findings or samples ;)</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qc qd ab ja"><div class="pu ab"><a class="qe ay am ao" rel="noopener follow" href="/tag/apt40?source=post_page-----e3729b65bf7a--------------------------------"><div class="qf fj cx qg ge qh qi bf b bg z bk qj">Apt40</div></a></div><div class="pu ab"><a class="qe ay am ao" rel="noopener follow" href="/tag/reverse-engineering?source=post_page-----e3729b65bf7a--------------------------------"><div class="qf fj cx qg ge qh qi bf b bg z bk qj">Reverse Engineering</div></a></div><div class="pu ab"><a class="qe ay am ao" rel="noopener follow" href="/tag/malware-analysis?source=post_page-----e3729b65bf7a--------------------------------"><div class="qf fj cx qg ge qh qi bf b bg z bk qj">Malware Analysis</div></a></div><div class="pu ab"><a class="qe ay am ao" rel="noopener follow" href="/tag/dadstache?source=post_page-----e3729b65bf7a--------------------------------"><div class="qf fj cx qg ge qh qi bf b bg z bk qj">Dadstache</div></a></div></div></div></div><div class="l"></div><footer class="qk ql qm qn qo ab q qp ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp qq"><div class="ab q kv"><div class="qr l"><span class="l qs qt qu e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2Fe3729b65bf7a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---footer_actions--e3729b65bf7a---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f qv qw"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2Fe3729b65bf7a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---footer_actions--e3729b65bf7a---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qx l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3729b65bf7a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fdad-theres-a-rat-in-here-e3729b65bf7a&amp;source=---footer_actions--e3729b65bf7a---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qx l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="qy qz ra rb rc l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rd bh r re"></div><div class="rf l"><div class="ab rg rh ri iz iy"><div class="rj rk rl rm rn ro rp rq rr rs ab cp"><div class="h k"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--e3729b65bf7a--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="rt ib ic cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="48" height="48" loading="lazy"/><div class="rt l ic ib fs n fr ru"></div></div></a></div><div class="j i d"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--e3729b65bf7a--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="rt rw rv cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="64" height="64" loading="lazy"/><div class="rt l rv rw fs n fr ru"></div></div></a></div><div class="j i d rx ix"><div class="ab"></div></div></div><div class="ab co pq"><div class="ry rz sa sb sc l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/insomniacs?source=post_page---post_publication_info--e3729b65bf7a--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf se sf sg sh si sj sk nh sl sm nl sn so np sp sq bk"><span class="gn sd">Published in <!-- -->insomniacs</span></h2></a><div class="pu ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/followers?source=post_page---post_publication_info--e3729b65bf7a--------------------------------">60 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0?source=post_page---post_publication_info--e3729b65bf7a--------------------------------">Last published <span>Jun 23, 2022</span></a></div></div><div class="sr l"><p class="bf b bg z bk"><span class="gn">reverse engineering away those sleepless nights</span></p></div></div></div><div class="h k"><div class="ab"></div></div></div></div><div class="ab rg rh ri iz iy"><div class="rj rk rl rm rn ro rp rq rr rs ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--e3729b65bf7a--------------------------------"><div class="l fj"><img alt="asuna amawaka" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/2*La4u414Rn4EMK1D8bYBRag.png" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay ru"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--e3729b65bf7a--------------------------------"><div class="l fj"><img alt="asuna amawaka" class="l fd by rv rw cx" src="https://miro.medium.com/v2/resize:fill:128:128/2*La4u414Rn4EMK1D8bYBRag.png" width="64" height="64" loading="lazy"/><div class="fr by l rv rw fs n ay ru"></div></div></a></div><div class="j i d rx ix"><div class="ab"><span><button class="bf b bg z ss qf st su sv sw sx ev ew sy sz ta fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co pq"><div class="ry rz sa sb sc l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--e3729b65bf7a--------------------------------"><h2 class="pw-author-name bf se sf sg sh si sj sk nh sl sm nl sn so np sp sq bk"><span class="gn sd">Written by <!-- -->asuna amawaka</span></h2></a><div class="pu ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@asuna.amawaka/followers?source=post_page---post_author_info--e3729b65bf7a--------------------------------">28 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@asuna.amawaka/following?source=post_page---post_author_info--e3729b65bf7a--------------------------------">1 Following</a></div></div><div class="sr l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ss qf st su sv sw sx ev ew sy sz ta fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tb l"><div class="rd bh r tc td te tf tg"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf se th ti tj tk tl tm tn to tp tq tr ts tt tu tv bk">No responses yet</h2><div class="ab tw"><div><div class="bm" aria-hidden="false"><a class="tx ty" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--e3729b65bf7a--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="tz ua ub uc ud l"></div></div></div></div><div class="ue uf ug uh ui l bx"><div class="h k j"><div class="rd bh uj uk"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ul ab kv ja"><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----e3729b65bf7a--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e3729b65bf7a--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="um un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----e3729b65bf7a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="um l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----e3729b65bf7a--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-e3729b65bf7a","user-ddd44ddb6480","collection-8dea5b1882ca"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"0ca52b67-753e-411d-aa8c-aecef6ff8824","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-b8c1f38c4f371a597535d33794c05b94-d92b60355b490a55-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fdad-theres-a-rat-in-here-e3729b65bf7a","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"insomniacs\"})":{"__ref":"Collection:8dea5b1882ca"},"postResult({\"id\":\"e3729b65bf7a\"})":{"__ref":"Post:e3729b65bf7a"}},"Collection:8dea5b1882ca":{"__typename":"Collection","id":"8dea5b1882ca","customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"domain":null,"slug":"insomniacs","googleAnalyticsId":null,"name":"insomniacs","subscriberCount":60,"description":"reverse engineering away those sleepless nights","avatar":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"},"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:32da9d336ca0"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_3f118ac5b671"},"twitterUsername":null,"facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"},"favicon":{"__ref":"ImageMetadata:"}},"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg":{"__typename":"ImageMetadata","id":"1*IvMGfHVzEtZei5I-JouCvw.jpeg","originalWidth":1200,"originalHeight":1200},"User:ddd44ddb6480":{"__typename":"User","id":"ddd44ddb6480","customDomainState":null,"hasSubdomain":false,"username":"asuna.amawaka","linkedAccounts":{"__ref":"LinkedAccounts:ddd44ddb6480"},"isSuspended":false,"name":"asuna amawaka","imageId":"2*La4u414Rn4EMK1D8bYBRag.png","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":28,"followingCount":0,"collectionFollowingCount":1},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:ddd44ddb6480-viewerId:lo_3f118ac5b671"},"twitterScreenName":""},"Post:32da9d336ca0":{"__typename":"Post","id":"32da9d336ca0","firstPublishedAt":1656002664270,"creator":{"__ref":"User:ddd44ddb6480"},"collection":{"__ref":"Collection:8dea5b1882ca"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fanalysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0","sequence":null,"uniqueSlug":"analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0"},"LinkedAccounts:ddd44ddb6480":{"__typename":"LinkedAccounts","mastodon":null,"id":"ddd44ddb6480"},"Paragraph:ab5ed24c495e_0":{"__typename":"Paragraph","id":"ab5ed24c495e_0","name":"7019","type":"H3","href":null,"layout":null,"metadata":null,"text":"Dad! There’s A Rat In Here!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_1":{"__typename":"Paragraph","id":"ab5ed24c495e_1","name":"3d84","type":"P","href":null,"layout":null,"metadata":null,"text":"As promised in my last post, I’ll be doing a walkthrough of the DADSTACHE sample fetched by the maldoc (MD5: 571efe3a29ed1f6c1f98576cb57db8a5) found off VirusTotal in late Feb 2020. After completing my analysis, I realized that a thorough “walkthrough” is not necessary as the beaconing code logic is simple enough. I think the toughest part was to make IDA Pro take in the final payload encrypted within the sample so that I can do static analysis. Hence, I decided to dedicate most of this post to my approach to unveiling the final payload ;) The second half would be a documentation of my findings.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_2":{"__typename":"Paragraph","id":"ab5ed24c495e_2","name":"e4f4","type":"P","href":null,"layout":null,"metadata":null,"text":"DADSTACHE sample analysed:\n009a9f7024c4dd5db8e3d793be3e99c0 dbgeng.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_3":{"__typename":"Paragraph","id":"ab5ed24c495e_3","name":"2f77","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s Tuck In!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*31FLsjmayOtgGA-GB9K0ow.png":{"__typename":"ImageMetadata","id":"1*31FLsjmayOtgGA-GB9K0ow.png","originalHeight":52,"originalWidth":295,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_4":{"__typename":"Paragraph","id":"ab5ed24c495e_4","name":"ef4d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*31FLsjmayOtgGA-GB9K0ow.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_5":{"__typename":"Paragraph","id":"ab5ed24c495e_5","name":"3892","type":"P","href":null,"layout":null,"metadata":null,"text":"There are 2 exported functions, we can quickly see that DebugCreate is the interesting one, with tell-tale API calls.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Cr1BMCTAZev-Oi4U6cdXTA.png":{"__typename":"ImageMetadata","id":"1*Cr1BMCTAZev-Oi4U6cdXTA.png","originalHeight":747,"originalWidth":462,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_6":{"__typename":"Paragraph","id":"ab5ed24c495e_6","name":"ba44","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Cr1BMCTAZev-Oi4U6cdXTA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_7":{"__typename":"Paragraph","id":"ab5ed24c495e_7","name":"ba2f","type":"P","href":null,"layout":null,"metadata":null,"text":"Looks like an AES encryption, using 0x40 bytes as a “seed” to derive the key. The easiest way to arrive at the decrypted content is to run the sample and read the decrypted content from memory.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_8":{"__typename":"Paragraph","id":"ab5ed24c495e_8","name":"b2ac","type":"P","href":null,"layout":null,"metadata":null,"text":"The content hardcoded in offset 100127B4 looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qf64par6_7l8fq5qfpOSqw.png":{"__typename":"ImageMetadata","id":"1*qf64par6_7l8fq5qfpOSqw.png","originalHeight":356,"originalWidth":558,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_9":{"__typename":"Paragraph","id":"ab5ed24c495e_9","name":"7fba","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qf64par6_7l8fq5qfpOSqw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_10":{"__typename":"Paragraph","id":"ab5ed24c495e_10","name":"7595","type":"P","href":null,"layout":null,"metadata":null,"text":"After decryption, the following content is seen:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VXCgjTwucMGXtT4EtxEkDw.png":{"__typename":"ImageMetadata","id":"1*VXCgjTwucMGXtT4EtxEkDw.png","originalHeight":343,"originalWidth":569,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_11":{"__typename":"Paragraph","id":"ab5ed24c495e_11","name":"e0a6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VXCgjTwucMGXtT4EtxEkDw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_12":{"__typename":"Paragraph","id":"ab5ed24c495e_12","name":"9869","type":"P","href":null,"layout":null,"metadata":null,"text":"Continuing dynamic analysis showed that the decrypted payload is mapped into memory and then its OEP is called.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_13":{"__typename":"Paragraph","id":"ab5ed24c495e_13","name":"bfeb","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, I would like to analyze the actual payload with IDA Pro, but the content dumped from memory doesn’t look like a proper PE file and hence the IAT can’t be recognized (though I can actually see the import table in there).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_14":{"__typename":"Paragraph","id":"ab5ed24c495e_14","name":"0c5c","type":"P","href":null,"layout":null,"metadata":null,"text":"Dump & Fix","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_15":{"__typename":"Paragraph","id":"ab5ed24c495e_15","name":"6f88","type":"P","href":null,"layout":null,"metadata":null,"text":"Dump the decrypted file after it has been mapped to memory in sub_10001920. A good place to do this would be after this function ends.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*LqOmIjsZYCSl25_St99hlg.png":{"__typename":"ImageMetadata","id":"1*LqOmIjsZYCSl25_St99hlg.png","originalHeight":415,"originalWidth":572,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_16":{"__typename":"Paragraph","id":"ab5ed24c495e_16","name":"9f15","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*LqOmIjsZYCSl25_St99hlg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_17":{"__typename":"Paragraph","id":"ab5ed24c495e_17","name":"2e32","type":"P","href":null,"layout":null,"metadata":null,"text":"Repairing the decrypted file’s PE header","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_18":{"__typename":"Paragraph","id":"ab5ed24c495e_18","name":"8296","type":"P","href":null,"layout":null,"metadata":null,"text":"The first 0x11C bytes of this extracted memory looked “wrong” — I would expect it to be following the structure of a PE header, but the “DOS Header” and part of the “NT Header” are missing. I can kind of recognize some of the fields in the “NT Header” from this chunk, which means that the content before these fields are intentionally “corrupted”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_19":{"__typename":"Paragraph","id":"ab5ed24c495e_19","name":"be19","type":"P","href":null,"layout":null,"metadata":null,"text":"I confirmed that these 0x11C bytes are not some kind of meaningful shell code:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ghVUYxAkk-kQnmKht4hLDA.png":{"__typename":"ImageMetadata","id":"1*ghVUYxAkk-kQnmKht4hLDA.png","originalHeight":274,"originalWidth":410,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_20":{"__typename":"Paragraph","id":"ab5ed24c495e_20","name":"2ca0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ghVUYxAkk-kQnmKht4hLDA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_21":{"__typename":"Paragraph","id":"ab5ed24c495e_21","name":"fa64","type":"P","href":null,"layout":null,"metadata":null,"text":"From the dynamic analysis done up to this point, the OEP of the decrypted file in binary is 0x57E4 (called from the function sub_10001FF0). This helps to confirm that the PE header is only corrupted up till the “Machine” field in the “NT Header”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZhEPLQIE6u-qopj_bNd2pA.png":{"__typename":"ImageMetadata","id":"1*ZhEPLQIE6u-qopj_bNd2pA.png","originalHeight":327,"originalWidth":497,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_22":{"__typename":"Paragraph","id":"ab5ed24c495e_22","name":"0751","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZhEPLQIE6u-qopj_bNd2pA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_23":{"__typename":"Paragraph","id":"ab5ed24c495e_23","name":"541c","type":"P","href":null,"layout":null,"metadata":null,"text":"So, let’s fix it! I’m going to copy the PE header of the parent binary, which is only 0x10C in size before the “Machine” field, to overwrite the corrupted 0x11C of header. Since we don’t care about what is actually in this header, other than the offset e_lfanew that needs to be corrected, I’m just going to pad 0x10 worth of values so as not to mess up all the other offsets (like the import table address) in the file. Of course, you may also wish to just fill up 0x11C bytes of your choice, just need to be sure the “MZ” “PE” and e_lfanew are correct.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7uaKRZhlEuXfPiXCxggd8w.png":{"__typename":"ImageMetadata","id":"1*7uaKRZhlEuXfPiXCxggd8w.png","originalHeight":399,"originalWidth":552,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_24":{"__typename":"Paragraph","id":"ab5ed24c495e_24","name":"41ae","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7uaKRZhlEuXfPiXCxggd8w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_25":{"__typename":"Paragraph","id":"ab5ed24c495e_25","name":"4447","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, using a tool like CFF Explorer would help to confirm if the edits have been successful. The last step is to fix the section raw addresses so that IDA Pro will be able to do its magic for us. A trick that I usually apply to binaries that I dumped from memory, is to copy the values from the “Virtual Address” column to the “Raw Address” column.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3qEh_FCBDLvMqRNwb4ok2A.png":{"__typename":"ImageMetadata","id":"1*3qEh_FCBDLvMqRNwb4ok2A.png","originalHeight":105,"originalWidth":468,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_26":{"__typename":"Paragraph","id":"ab5ed24c495e_26","name":"f1ec","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3qEh_FCBDLvMqRNwb4ok2A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_27":{"__typename":"Paragraph","id":"ab5ed24c495e_27","name":"bf53","type":"P","href":null,"layout":null,"metadata":null,"text":"With this, the import\u002Fexport table would be nicely pointed to.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*p9HQtWtkaS1R3SSz6o1MNQ.png":{"__typename":"ImageMetadata","id":"1*p9HQtWtkaS1R3SSz6o1MNQ.png","originalHeight":122,"originalWidth":363,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_28":{"__typename":"Paragraph","id":"ab5ed24c495e_28","name":"8b57","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*p9HQtWtkaS1R3SSz6o1MNQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_29":{"__typename":"Paragraph","id":"ab5ed24c495e_29","name":"7836","type":"P","href":null,"layout":null,"metadata":null,"text":"Since the RICH header portion of the PE header is lost, we are not able to perform analysis on that. Fortunately, there’s still one value that is intact, and that is the compilation date: 23 Dec 2019 17:15:32. This file is compiled about 1 hour before its parent file (which has compilation timestamp 23 Dec 2019 18:17:44). This might suggest that the file is manually compiled into the parent file, and not through a generator.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_30":{"__typename":"Paragraph","id":"ab5ed24c495e_30","name":"4d06","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, DADSTACHE","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_31":{"__typename":"Paragraph","id":"ab5ed24c495e_31","name":"f0db","type":"P","href":null,"layout":null,"metadata":null,"text":"The first thing that the malware does is to update its configuration placeholder with the actual configuration (decrypted above).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7Qylz6zlPWj4zSt5b6zfaQ.png":{"__typename":"ImageMetadata","id":"1*7Qylz6zlPWj4zSt5b6zfaQ.png","originalHeight":175,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_32":{"__typename":"Paragraph","id":"ab5ed24c495e_32","name":"d97c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7Qylz6zlPWj4zSt5b6zfaQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_33":{"__typename":"Paragraph","id":"ab5ed24c495e_33","name":"af87","type":"P","href":null,"layout":null,"metadata":null,"text":"Then it proceeds to do the beaconing, which comprises of AES-encrypted contents within HTTP POST requests.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ToDdltYldYm6iQP7OkduWA.png":{"__typename":"ImageMetadata","id":"1*ToDdltYldYm6iQP7OkduWA.png","originalHeight":314,"originalWidth":522,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_34":{"__typename":"Paragraph","id":"ab5ed24c495e_34","name":"e792","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ToDdltYldYm6iQP7OkduWA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_35":{"__typename":"Paragraph","id":"ab5ed24c495e_35","name":"f431","type":"P","href":null,"layout":null,"metadata":null,"text":"AES Encrypted Network Communication","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_36":{"__typename":"Paragraph","id":"ab5ed24c495e_36","name":"4fdd","type":"P","href":null,"layout":null,"metadata":null,"text":"One point to note is that the configuration within the malware decides whether the HTTP requests will be wrapped with SSL or not. It is an additional layer of “security” for the C2 communications. Regardless, we’ll look at what is sent to and expected from the C2.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_37":{"__typename":"Paragraph","id":"ab5ed24c495e_37","name":"05d3","type":"P","href":null,"layout":null,"metadata":null,"text":"The following structure is AES-encrypted then sent to the C2. The AES key is found within the configuration data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TY78IXVk4eRUms8xlnNAtw.png":{"__typename":"ImageMetadata","id":"1*TY78IXVk4eRUms8xlnNAtw.png","originalHeight":71,"originalWidth":324,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_38":{"__typename":"Paragraph","id":"ab5ed24c495e_38","name":"a02a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TY78IXVk4eRUms8xlnNAtw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_39":{"__typename":"Paragraph","id":"ab5ed24c495e_39","name":"c405","type":"P","href":null,"layout":null,"metadata":null,"text":"A quick python script can help with confirming that the content sent to the C2 is indeed AES-encrypted with the key from the configuration data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*oFzYrwSECgswi7B_nKva6g.png":{"__typename":"ImageMetadata","id":"1*oFzYrwSECgswi7B_nKva6g.png","originalHeight":333,"originalWidth":623,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_40":{"__typename":"Paragraph","id":"ab5ed24c495e_40","name":"5f3e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*oFzYrwSECgswi7B_nKva6g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_41":{"__typename":"Paragraph","id":"ab5ed24c495e_41","name":"c689","type":"P","href":null,"layout":null,"metadata":null,"text":"Once there is a status 200 response from the C2 server for the above beacon, the malware will then proceed to do further information collection, and await commands from the C2.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_42":{"__typename":"Paragraph","id":"ab5ed24c495e_42","name":"c90a","type":"P","href":null,"layout":null,"metadata":null,"text":"The following information are being collected from the victim’s machine and then written into %temp%\\\\~liscen3.tmp:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_43":{"__typename":"Paragraph","id":"ab5ed24c495e_43","name":"50ec","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Recent files","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_44":{"__typename":"Paragraph","id":"ab5ed24c495e_44","name":"9581","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Installed programs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_45":{"__typename":"Paragraph","id":"ab5ed24c495e_45","name":"b1bc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Drives","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_46":{"__typename":"Paragraph","id":"ab5ed24c495e_46","name":"7627","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Count of cursor staying in one position","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_47":{"__typename":"Paragraph","id":"ab5ed24c495e_47","name":"288d","type":"P","href":null,"layout":null,"metadata":null,"text":"One of the information collected is to count the number of times that the cursor stayed in one position on screen — I suspect this is for the attacker to know if the binary is being executed in a sandbox instead of a real victim.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IvbfPn0eihqpcWKwAibn8A.png":{"__typename":"ImageMetadata","id":"1*IvbfPn0eihqpcWKwAibn8A.png","originalHeight":228,"originalWidth":540,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_48":{"__typename":"Paragraph","id":"ab5ed24c495e_48","name":"f802","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IvbfPn0eihqpcWKwAibn8A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_49":{"__typename":"Paragraph","id":"ab5ed24c495e_49","name":"cc8c","type":"P","href":null,"layout":null,"metadata":null,"text":"The content to send to the C2 would be read from %temp%\\\\~liscen3.tmp into a buffer and then the file is deleted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_50":{"__typename":"Paragraph","id":"ab5ed24c495e_50","name":"aa04","type":"P","href":null,"layout":null,"metadata":null,"text":"Before sending the above in another AES-encrypted POST request, an additional 0x208 bytes of data (path of ~liscen3.tmp and “Client\\\u003Cip\u003E_\u003Ccomputername\u003E\\Disinfo.txt”), followed by 8 bytes to indicate the start and end offsets of collected data within ~liscen3.tmp, are pre-pended to the buffer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Xk0JafYLLmq_Kf3XKKZXng.png":{"__typename":"ImageMetadata","id":"1*Xk0JafYLLmq_Kf3XKKZXng.png","originalHeight":363,"originalWidth":637,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_51":{"__typename":"Paragraph","id":"ab5ed24c495e_51","name":"6e8b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Xk0JafYLLmq_Kf3XKKZXng.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_52":{"__typename":"Paragraph","id":"ab5ed24c495e_52","name":"6be7","type":"P","href":null,"layout":null,"metadata":null,"text":"The Command ID received from the C2 server is not expected to be encrypted, but the parameters used within the command are AES-encrypted with the same key as configured within the malware.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iNa6aXWIXskbEp_u3onGjQ.png":{"__typename":"ImageMetadata","id":"1*iNa6aXWIXskbEp_u3onGjQ.png","originalHeight":371,"originalWidth":1221,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_53":{"__typename":"Paragraph","id":"ab5ed24c495e_53","name":"11a5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iNa6aXWIXskbEp_u3onGjQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_54":{"__typename":"Paragraph","id":"ab5ed24c495e_54","name":"0634","type":"P","href":null,"layout":null,"metadata":null,"text":"If there are no commands received from the C2 server for a period of time (up to 3 seconds), the malware sends a GET request for \u002Flist_direction to the C2, possibly as an attempt to get a new command.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*klsY3EzO2-_cNcWUeT1e4A.png":{"__typename":"ImageMetadata","id":"1*klsY3EzO2-_cNcWUeT1e4A.png","originalHeight":317,"originalWidth":538,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ab5ed24c495e_55":{"__typename":"Paragraph","id":"ab5ed24c495e_55","name":"1ccf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*klsY3EzO2-_cNcWUeT1e4A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_56":{"__typename":"Paragraph","id":"ab5ed24c495e_56","name":"f8c3","type":"P","href":null,"layout":null,"metadata":null,"text":"After-analysis thoughts","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_57":{"__typename":"Paragraph","id":"ab5ed24c495e_57","name":"b7b9","type":"P","href":null,"layout":null,"metadata":null,"text":"There we go, a straight-forward and light-weight RAT. The next thing I would like to do is to compare this latest DADSTACHE sample with the older ones, and other malware families known to be used by APT40. Who knows what interesting findings await?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_58":{"__typename":"Paragraph","id":"ab5ed24c495e_58","name":"9f08","type":"P","href":null,"layout":null,"metadata":null,"text":"~~","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ab5ed24c495e_59":{"__typename":"Paragraph","id":"ab5ed24c495e_59","name":"a8a8","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Asuna\nThe latest Tweets from Asuna (@AsunaAmawaka). [Malware Analyst]. Binary Worldtwitter.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":94,"href":"https:\u002F\u002Ftwitter.com\u002FAsunaAmawaka","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":6,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Ftwitter.com\u002FAsunaAmawaka","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*8K8Ai9YgVFxHmIUP"}},"Paragraph:ab5ed24c495e_60":{"__typename":"Paragraph","id":"ab5ed24c495e_60","name":"35fb","type":"P","href":null,"layout":null,"metadata":null,"text":"Drop me a DM if you would like to share findings or samples ;)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_3f118ac5b671":{"__typename":"CollectionViewerEdge","id":"collectionId:8dea5b1882ca-viewerId:lo_3f118ac5b671","isEditor":false,"isMuting":false},"UserViewerEdge:userId:ddd44ddb6480-viewerId:lo_3f118ac5b671":{"__typename":"UserViewerEdge","id":"userId:ddd44ddb6480-viewerId:lo_3f118ac5b671","isMuting":false},"PostViewerEdge:postId:e3729b65bf7a-viewerId:lo_3f118ac5b671":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:e3729b65bf7a-viewerId:lo_3f118ac5b671"},"Tag:apt40":{"__typename":"Tag","id":"apt40","displayTitle":"Apt40","normalizedTagSlug":"apt40"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:dadstache":{"__typename":"Tag","id":"dadstache","displayTitle":"Dadstache","normalizedTagSlug":"dadstache"},"Post:e3729b65bf7a":{"__typename":"Post","id":"e3729b65bf7a","collection":{"__ref":"Collection:8dea5b1882ca"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"4408","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:ab5ed24c495e_0"},{"__ref":"Paragraph:ab5ed24c495e_1"},{"__ref":"Paragraph:ab5ed24c495e_2"},{"__ref":"Paragraph:ab5ed24c495e_3"},{"__ref":"Paragraph:ab5ed24c495e_4"},{"__ref":"Paragraph:ab5ed24c495e_5"},{"__ref":"Paragraph:ab5ed24c495e_6"},{"__ref":"Paragraph:ab5ed24c495e_7"},{"__ref":"Paragraph:ab5ed24c495e_8"},{"__ref":"Paragraph:ab5ed24c495e_9"},{"__ref":"Paragraph:ab5ed24c495e_10"},{"__ref":"Paragraph:ab5ed24c495e_11"},{"__ref":"Paragraph:ab5ed24c495e_12"},{"__ref":"Paragraph:ab5ed24c495e_13"},{"__ref":"Paragraph:ab5ed24c495e_14"},{"__ref":"Paragraph:ab5ed24c495e_15"},{"__ref":"Paragraph:ab5ed24c495e_16"},{"__ref":"Paragraph:ab5ed24c495e_17"},{"__ref":"Paragraph:ab5ed24c495e_18"},{"__ref":"Paragraph:ab5ed24c495e_19"},{"__ref":"Paragraph:ab5ed24c495e_20"},{"__ref":"Paragraph:ab5ed24c495e_21"},{"__ref":"Paragraph:ab5ed24c495e_22"},{"__ref":"Paragraph:ab5ed24c495e_23"},{"__ref":"Paragraph:ab5ed24c495e_24"},{"__ref":"Paragraph:ab5ed24c495e_25"},{"__ref":"Paragraph:ab5ed24c495e_26"},{"__ref":"Paragraph:ab5ed24c495e_27"},{"__ref":"Paragraph:ab5ed24c495e_28"},{"__ref":"Paragraph:ab5ed24c495e_29"},{"__ref":"Paragraph:ab5ed24c495e_30"},{"__ref":"Paragraph:ab5ed24c495e_31"},{"__ref":"Paragraph:ab5ed24c495e_32"},{"__ref":"Paragraph:ab5ed24c495e_33"},{"__ref":"Paragraph:ab5ed24c495e_34"},{"__ref":"Paragraph:ab5ed24c495e_35"},{"__ref":"Paragraph:ab5ed24c495e_36"},{"__ref":"Paragraph:ab5ed24c495e_37"},{"__ref":"Paragraph:ab5ed24c495e_38"},{"__ref":"Paragraph:ab5ed24c495e_39"},{"__ref":"Paragraph:ab5ed24c495e_40"},{"__ref":"Paragraph:ab5ed24c495e_41"},{"__ref":"Paragraph:ab5ed24c495e_42"},{"__ref":"Paragraph:ab5ed24c495e_43"},{"__ref":"Paragraph:ab5ed24c495e_44"},{"__ref":"Paragraph:ab5ed24c495e_45"},{"__ref":"Paragraph:ab5ed24c495e_46"},{"__ref":"Paragraph:ab5ed24c495e_47"},{"__ref":"Paragraph:ab5ed24c495e_48"},{"__ref":"Paragraph:ab5ed24c495e_49"},{"__ref":"Paragraph:ab5ed24c495e_50"},{"__ref":"Paragraph:ab5ed24c495e_51"},{"__ref":"Paragraph:ab5ed24c495e_52"},{"__ref":"Paragraph:ab5ed24c495e_53"},{"__ref":"Paragraph:ab5ed24c495e_54"},{"__ref":"Paragraph:ab5ed24c495e_55"},{"__ref":"Paragraph:ab5ed24c495e_56"},{"__ref":"Paragraph:ab5ed24c495e_57"},{"__ref":"Paragraph:ab5ed24c495e_58"},{"__ref":"Paragraph:ab5ed24c495e_59"},{"__ref":"Paragraph:ab5ed24c495e_60"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:ddd44ddb6480"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fdad-theres-a-rat-in-here-e3729b65bf7a","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"ab5ed24c495e","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":0,"allowResponses":true,"isLimitedState":false,"title":"Dad! There’s A Rat In Here!","isSeries":false,"sequence":null,"uniqueSlug":"dad-theres-a-rat-in-here-e3729b65bf7a","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1584290259728,"readingTime":5.846226415094339,"previewContent":{"__typename":"PreviewContent","subtitle":"An analysis of the DADSTACHE sample fetched by the maldoc (MD5 571efe3a29ed1f6c1f98576cb57db8a5). DADSTACHE is believed to be used by…"},"previewImage":{"__ref":"ImageMetadata:1*klsY3EzO2-_cNcWUeT1e4A.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1584290259728,"updatedAt":1639427674453,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:e3729b65bf7a-viewerId:lo_3f118ac5b671"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:apt40"},{"__ref":"Tag:reverse-engineering"},{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:dadstache"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1112,"layerCake":0,"responsesLocked":false},"ImageMetadata:":{"__typename":"ImageMetadata","id":""}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3c70cc4b0664d2',t:'MTczNDQ5NjQ2OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3c70cc4b0664d2","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>