<!DOCTYPE html>
<html lang="en-US" class="no-js ">
<head><meta charset="UTF-8"><script>if(navigator.userAgent.match(/MSIE|Internet Explorer/i)||navigator.userAgent.match(/Trident\/7\..*?rv:11/i)){var href=document.location.href;if(!href.match(/[?&]nowprocket/)){if(href.indexOf("?")==-1){if(href.indexOf("#")==-1){document.location.href=href+"?nowprocket=1"}else{document.location.href=href.replace("#","?nowprocket=1#")}}else{if(href.indexOf("#")==-1){document.location.href=href+"&nowprocket=1"}else{document.location.href=href.replace("#","&nowprocket=1#")}}}}</script><script>(()=>{class RocketLazyLoadScripts{constructor(){this.v="1.2.6",this.triggerEvents=["keydown","mousedown","mousemove","touchmove","touchstart","touchend","wheel"],this.userEventHandler=this.t.bind(this),this.touchStartHandler=this.i.bind(this),this.touchMoveHandler=this.o.bind(this),this.touchEndHandler=this.h.bind(this),this.clickHandler=this.u.bind(this),this.interceptedClicks=[],this.interceptedClickListeners=[],this.l(this),window.addEventListener("pageshow",(t=>{this.persisted=t.persisted,this.everythingLoaded&&this.m()})),this.CSPIssue=sessionStorage.getItem("rocketCSPIssue"),document.addEventListener("securitypolicyviolation",(t=>{this.CSPIssue||"script-src-elem"!==t.violatedDirective||"data"!==t.blockedURI||(this.CSPIssue=!0,sessionStorage.setItem("rocketCSPIssue",!0))})),document.addEventListener("DOMContentLoaded",(()=>{this.k()})),this.delayedScripts={normal:[],async:[],defer:[]},this.trash=[],this.allJQueries=[]}p(t){document.hidden?t.t():(this.triggerEvents.forEach((e=>window.addEventListener(e,t.userEventHandler,{passive:!0}))),window.addEventListener("touchstart",t.touchStartHandler,{passive:!0}),window.addEventListener("mousedown",t.touchStartHandler),document.addEventListener("visibilitychange",t.userEventHandler))}_(){this.triggerEvents.forEach((t=>window.removeEventListener(t,this.userEventHandler,{passive:!0}))),document.removeEventListener("visibilitychange",this.userEventHandler)}i(t){"HTML"!==t.target.tagName&&(window.addEventListener("touchend",this.touchEndHandler),window.addEventListener("mouseup",this.touchEndHandler),window.addEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.addEventListener("mousemove",this.touchMoveHandler),t.target.addEventListener("click",this.clickHandler),this.L(t.target,!0),this.S(t.target,"onclick","rocket-onclick"),this.C())}o(t){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler),t.target.removeEventListener("click",this.clickHandler),this.L(t.target,!1),this.S(t.target,"rocket-onclick","onclick"),this.M()}h(){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler)}u(t){t.target.removeEventListener("click",this.clickHandler),this.L(t.target,!1),this.S(t.target,"rocket-onclick","onclick"),this.interceptedClicks.push(t),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.M()}O(){window.removeEventListener("touchstart",this.touchStartHandler,{passive:!0}),window.removeEventListener("mousedown",this.touchStartHandler),this.interceptedClicks.forEach((t=>{t.target.dispatchEvent(new MouseEvent("click",{view:t.view,bubbles:!0,cancelable:!0}))}))}l(t){EventTarget.prototype.addEventListenerWPRocketBase=EventTarget.prototype.addEventListener,EventTarget.prototype.addEventListener=function(e,i,o){"click"!==e||t.windowLoaded||i===t.clickHandler||t.interceptedClickListeners.push({target:this,func:i,options:o}),(this||window).addEventListenerWPRocketBase(e,i,o)}}L(t,e){this.interceptedClickListeners.forEach((i=>{i.target===t&&(e?t.removeEventListener("click",i.func,i.options):t.addEventListener("click",i.func,i.options))})),t.parentNode!==document.documentElement&&this.L(t.parentNode,e)}D(){return new Promise((t=>{this.P?this.M=t:t()}))}C(){this.P=!0}M(){this.P=!1}S(t,e,i){t.hasAttribute&&t.hasAttribute(e)&&(event.target.setAttribute(i,event.target.getAttribute(e)),event.target.removeAttribute(e))}t(){this._(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.R.bind(this)):this.R()}k(){let t=[];document.querySelectorAll("script[type=rocketlazyloadscript][data-rocket-src]").forEach((e=>{let i=e.getAttribute("data-rocket-src");if(i&&!i.startsWith("data:")){0===i.indexOf("//")&&(i=location.protocol+i);try{const o=new URL(i).origin;o!==location.origin&&t.push({src:o,crossOrigin:e.crossOrigin||"module"===e.getAttribute("data-rocket-type")})}catch(t){}}})),t=[...new Map(t.map((t=>[JSON.stringify(t),t]))).values()],this.T(t,"preconnect")}async R(){this.lastBreath=Date.now(),this.j(this),this.F(this),this.I(),this.W(),this.q(),await this.A(this.delayedScripts.normal),await this.A(this.delayedScripts.defer),await this.A(this.delayedScripts.async);try{await this.U(),await this.H(this),await this.J()}catch(t){console.error(t)}window.dispatchEvent(new Event("rocket-allScriptsLoaded")),this.everythingLoaded=!0,this.D().then((()=>{this.O()})),this.N()}W(){document.querySelectorAll("script[type=rocketlazyloadscript]").forEach((t=>{t.hasAttribute("data-rocket-src")?t.hasAttribute("async")&&!1!==t.async?this.delayedScripts.async.push(t):t.hasAttribute("defer")&&!1!==t.defer||"module"===t.getAttribute("data-rocket-type")?this.delayedScripts.defer.push(t):this.delayedScripts.normal.push(t):this.delayedScripts.normal.push(t)}))}async B(t){if(await this.G(),!0!==t.noModule||!("noModule"in HTMLScriptElement.prototype))return new Promise((e=>{let i;function o(){(i||t).setAttribute("data-rocket-status","executed"),e()}try{if(navigator.userAgent.indexOf("Firefox/")>0||""===navigator.vendor||this.CSPIssue)i=document.createElement("script"),[...t.attributes].forEach((t=>{let e=t.nodeName;"type"!==e&&("data-rocket-type"===e&&(e="type"),"data-rocket-src"===e&&(e="src"),i.setAttribute(e,t.nodeValue))})),t.text&&(i.text=t.text),i.hasAttribute("src")?(i.addEventListener("load",o),i.addEventListener("error",(function(){i.setAttribute("data-rocket-status","failed-network"),e()})),setTimeout((()=>{i.isConnected||e()}),1)):(i.text=t.text,o()),t.parentNode.replaceChild(i,t);else{const i=t.getAttribute("data-rocket-type"),s=t.getAttribute("data-rocket-src");i?(t.type=i,t.removeAttribute("data-rocket-type")):t.removeAttribute("type"),t.addEventListener("load",o),t.addEventListener("error",(i=>{this.CSPIssue&&i.target.src.startsWith("data:")?(console.log("WPRocket: data-uri blocked by CSP -> fallback"),t.removeAttribute("src"),this.B(t).then(e)):(t.setAttribute("data-rocket-status","failed-network"),e())})),s?(t.removeAttribute("data-rocket-src"),t.src=s):t.src="data:text/javascript;base64,"+window.btoa(unescape(encodeURIComponent(t.text)))}}catch(i){t.setAttribute("data-rocket-status","failed-transform"),e()}}));t.setAttribute("data-rocket-status","skipped")}async A(t){const e=t.shift();return e&&e.isConnected?(await this.B(e),this.A(t)):Promise.resolve()}q(){this.T([...this.delayedScripts.normal,...this.delayedScripts.defer,...this.delayedScripts.async],"preload")}T(t,e){var i=document.createDocumentFragment();t.forEach((t=>{const o=t.getAttribute&&t.getAttribute("data-rocket-src")||t.src;if(o&&!o.startsWith("data:")){const s=document.createElement("link");s.href=o,s.rel=e,"preconnect"!==e&&(s.as="script"),t.getAttribute&&"module"===t.getAttribute("data-rocket-type")&&(s.crossOrigin=!0),t.crossOrigin&&(s.crossOrigin=t.crossOrigin),t.integrity&&(s.integrity=t.integrity),i.appendChild(s),this.trash.push(s)}})),document.head.appendChild(i)}j(t){let e={};function i(i,o){return e[o].eventsToRewrite.indexOf(i)>=0&&!t.everythingLoaded?"rocket-"+i:i}function o(t,o){!function(t){e[t]||(e[t]={originalFunctions:{add:t.addEventListener,remove:t.removeEventListener},eventsToRewrite:[]},t.addEventListener=function(){arguments[0]=i(arguments[0],t),e[t].originalFunctions.add.apply(t,arguments)},t.removeEventListener=function(){arguments[0]=i(arguments[0],t),e[t].originalFunctions.remove.apply(t,arguments)})}(t),e[t].eventsToRewrite.push(o)}function s(e,i){let o=e[i];e[i]=null,Object.defineProperty(e,i,{get:()=>o||function(){},set(s){t.everythingLoaded?o=s:e["rocket"+i]=o=s}})}o(document,"DOMContentLoaded"),o(window,"DOMContentLoaded"),o(window,"load"),o(window,"pageshow"),o(document,"readystatechange"),s(document,"onreadystatechange"),s(window,"onload"),s(window,"onpageshow");try{Object.defineProperty(document,"readyState",{get:()=>t.rocketReadyState,set(e){t.rocketReadyState=e},configurable:!0}),document.readyState="loading"}catch(t){console.log("WPRocket DJE readyState conflict, bypassing")}}F(t){let e;function i(e){return t.everythingLoaded?e:e.split(" ").map((t=>"load"===t||0===t.indexOf("load.")?"rocket-jquery-load":t)).join(" ")}function o(o){function s(t){const e=o.fn[t];o.fn[t]=o.fn.init.prototype[t]=function(){return this[0]===window&&("string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=i(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach((t=>{const e=arguments[0][t];delete arguments[0][t],arguments[0][i(t)]=e}))),e.apply(this,arguments),this}}o&&o.fn&&!t.allJQueries.includes(o)&&(o.fn.ready=o.fn.init.prototype.ready=function(e){return t.domReadyFired?e.bind(document)(o):document.addEventListener("rocket-DOMContentLoaded",(()=>e.bind(document)(o))),o([])},s("on"),s("one"),t.allJQueries.push(o)),e=o}o(window.jQuery),Object.defineProperty(window,"jQuery",{get:()=>e,set(t){o(t)}})}async H(t){const e=document.querySelector("script[data-webpack]");e&&(await async function(){return new Promise((t=>{e.addEventListener("load",t),e.addEventListener("error",t)}))}(),await t.K(),await t.H(t))}async U(){this.domReadyFired=!0;try{document.readyState="interactive"}catch(t){}await this.G(),document.dispatchEvent(new Event("rocket-readystatechange")),await this.G(),document.rocketonreadystatechange&&document.rocketonreadystatechange(),await this.G(),document.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this.G(),window.dispatchEvent(new Event("rocket-DOMContentLoaded"))}async J(){try{document.readyState="complete"}catch(t){}await this.G(),document.dispatchEvent(new Event("rocket-readystatechange")),await this.G(),document.rocketonreadystatechange&&document.rocketonreadystatechange(),await this.G(),window.dispatchEvent(new Event("rocket-load")),await this.G(),window.rocketonload&&window.rocketonload(),await this.G(),this.allJQueries.forEach((t=>t(window).trigger("rocket-jquery-load"))),await this.G();const t=new Event("rocket-pageshow");t.persisted=this.persisted,window.dispatchEvent(t),await this.G(),window.rocketonpageshow&&window.rocketonpageshow({persisted:this.persisted}),this.windowLoaded=!0}m(){document.onreadystatechange&&document.onreadystatechange(),window.onload&&window.onload(),window.onpageshow&&window.onpageshow({persisted:this.persisted})}I(){const t=new Map;document.write=document.writeln=function(e){const i=document.currentScript;i||console.error("WPRocket unable to document.write this: "+e);const o=document.createRange(),s=i.parentElement;let n=t.get(i);void 0===n&&(n=i.nextSibling,t.set(i,n));const c=document.createDocumentFragment();o.setStart(c,0),c.appendChild(o.createContextualFragment(e)),s.insertBefore(c,n)}}async G(){Date.now()-this.lastBreath>45&&(await this.K(),this.lastBreath=Date.now())}async K(){return document.hidden?new Promise((t=>setTimeout(t))):new Promise((t=>requestAnimationFrame(t)))}N(){this.trash.forEach((t=>t.remove()))}static run(){const t=new RocketLazyLoadScripts;t.p(t)}}RocketLazyLoadScripts.run()})();</script>
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<script>
var gform;gform||(document.addEventListener("gform_main_scripts_loaded",function(){gform.scriptsLoaded=!0}),window.addEventListener("DOMContentLoaded",function(){gform.domLoaded=!0}),gform={domLoaded:!1,scriptsLoaded:!1,initializeOnLoaded:function(o){gform.domLoaded&&gform.scriptsLoaded?o():!gform.domLoaded&&gform.scriptsLoaded?window.addEventListener("DOMContentLoaded",o):document.addEventListener("gform_main_scripts_loaded",o)},hooks:{action:{},filter:{}},addAction:function(o,n,r,t){gform.addHook("action",o,n,r,t)},addFilter:function(o,n,r,t){gform.addHook("filter",o,n,r,t)},doAction:function(o){gform.doHook("action",o,arguments)},applyFilters:function(o){return gform.doHook("filter",o,arguments)},removeAction:function(o,n){gform.removeHook("action",o,n)},removeFilter:function(o,n,r){gform.removeHook("filter",o,n,r)},addHook:function(o,n,r,t,i){null==gform.hooks[o][n]&&(gform.hooks[o][n]=[]);var e=gform.hooks[o][n];null==i&&(i=n+"_"+e.length),gform.hooks[o][n].push({tag:i,callable:r,priority:t=null==t?10:t})},doHook:function(n,o,r){var t;if(r=Array.prototype.slice.call(r,1),null!=gform.hooks[n][o]&&((o=gform.hooks[n][o]).sort(function(o,n){return o.priority-n.priority}),o.forEach(function(o){"function"!=typeof(t=o.callable)&&(t=window[t]),"action"==n?t.apply(null,r):r[0]=t.apply(null,r)})),"filter"==n)return r[0]},removeHook:function(o,n,t,i){var r;null!=gform.hooks[o][n]&&(r=(r=gform.hooks[o][n]).filter(function(o,n,r){return!!(null!=i&&i!=o.tag||null!=t&&t!=o.priority)}),gform.hooks[o][n]=r)}});
</script>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
	<meta name="format-detection" content="telephone=no">
	<script type="rocketlazyloadscript">document.documentElement.className = document.documentElement.className.replace("no-js","js");</script>
	
	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/" />
<link rel="alternate" hreflang="x-default" href="https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/" />
<link rel="shortcut icon" type="image/x-icon" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.ico" />
<link rel="shortcut icon" type="image/png" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.png" />
<link rel="icon" type="image/x-icon" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.ico" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.4 (Yoast SEO v23.4) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Raspberry Robin and its new anti-emulation trick</title>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/basementgrotesqueblack-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/prestigeelitestd-bd-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/prestigeelitestd-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/proximanovabold-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/proximanovaregular-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/helveticaneue-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/icons/harfanglab.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/icons/harfanglab.ttf" crossorigin>
	<link rel="canonical" href="https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Raspberry Robin and its new anti-emulation trick" />
	<meta property="og:description" content="Reported for the first time by Red Canary in 2021, Raspberry Robin was the 9th most prevalent threat in 2023 according to their &#8220;2024 Threat Detection Report&#8221;. Starting as a worm, it evolved to become an initial access broker for other threat actors. The success of Raspberry Robin comes from its constantly evolving evasion capabitilies, [&hellip;]" />
	<meta property="og:url" content="https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/" />
	<meta property="og:site_name" content="HarfangLab | Your endpoints, our protection" />
	<meta property="article:modified_time" content="2024-10-11T09:35:33+00:00" />
	<meta property="og:image" content="https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg" />
	<meta property="og:image:width" content="640" />
	<meta property="og:image:height" content="453" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@harfanglab" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/","url":"https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/","name":"Raspberry Robin and its new anti-emulation trick","isPartOf":{"@id":"https://harfanglab.io/#website"},"primaryImageOfPage":{"@id":"https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/#primaryimage"},"image":{"@id":"https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/#primaryimage"},"thumbnailUrl":"https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg","datePublished":"2024-04-03T12:34:23+00:00","dateModified":"2024-10-11T09:35:33+00:00","breadcrumb":{"@id":"https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/#primaryimage","url":"https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg","contentUrl":"https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg","width":640,"height":453},{"@type":"BreadcrumbList","@id":"https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://harfanglab.io/"},{"@type":"ListItem","position":2,"name":"Inside","item":"https://harfanglab.io/insidethelab/"},{"@type":"ListItem","position":3,"name":"Raspberry Robin and its new anti-emulation trick"}]},{"@type":"WebSite","@id":"https://harfanglab.io/#website","url":"https://harfanglab.io/","name":"HarfangLab","description":"Empower your analysts, overcome the threats","publisher":{"@id":"https://harfanglab.io/#organization"},"alternateName":"HarfangLab","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://harfanglab.io/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://harfanglab.io/#organization","name":"HarfangLab","alternateName":"harfangLab","url":"https://harfanglab.io/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://harfanglab.io/#/schema/logo/image/","url":"https://harfanglab.io/medias/2023/09/logo-harfanglab-1.svg","contentUrl":"https://harfanglab.io/medias/2023/09/logo-harfanglab-1.svg","width":650,"height":187,"caption":"HarfangLab"},"image":{"@id":"https://harfanglab.io/#/schema/logo/image/"},"sameAs":["https://x.com/harfanglab","https://www.linkedin.com/company/harfanglab"]}]}</script>
	<!-- / Yoast SEO Premium plugin. -->


<link rel='dns-prefetch' href='//js.chilipiper.com' />

<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<link rel='stylesheet' id='harfanglab-styles-css' href='https://harfanglab.io/files/themes/harfangLab/assets/css/styles.min.css?ver=1.5.4' media='all' />
<style id='rocket-lazyload-inline-css'>
.rll-youtube-player{position:relative;padding-bottom:56.23%;height:0;overflow:hidden;max-width:100%;}.rll-youtube-player:focus-within{outline: 2px solid currentColor;outline-offset: 5px;}.rll-youtube-player iframe{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background:0 0}.rll-youtube-player img{bottom:0;display:block;left:0;margin:auto;max-width:100%;width:100%;position:absolute;right:0;top:0;border:none;height:auto;-webkit-transition:.4s all;-moz-transition:.4s all;transition:.4s all}.rll-youtube-player img:hover{-webkit-filter:brightness(75%)}.rll-youtube-player .play{height:100%;width:100%;left:0;top:0;position:absolute;background:url(/files/plugins/wp-rocket/assets/img/youtube.png) no-repeat center;background-color: transparent !important;cursor:pointer;border:none;}
</style>
<script id="wpml-cookie-js-extra">
var wpml_cookies = {"wp-wpml_current_language":{"value":"en","expires":1,"path":"\/"}};
var wpml_cookies = {"wp-wpml_current_language":{"value":"en","expires":1,"path":"\/"}};
</script>
<script type="rocketlazyloadscript" data-rocket-src="/files/plugins/sitepress-multilingual-cms/res/js/cookies/language-cookie.js?ver=4.6.13" id="wpml-cookie-js" defer data-wp-strategy="defer"></script>
<script type="rocketlazyloadscript" data-rocket-src="https://js.chilipiper.com/marketing.js?ver=1.5.4" id="chilipiper-js" data-rocket-defer defer></script>
<script src="https://harfanglab.io/files/themes/harfangLab/assets/js/init.min.js?ver=1.5.4" id="jquery-js"></script>
<meta name="generator" content="WPML ver:4.6.13 stt:1,4,3;" />
<link rel="icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-32x32.png" sizes="32x32" />
<link rel="icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-180x180.png" />
<meta name="msapplication-TileImage" content="https://harfanglab.io/medias/2024/09/cropped-square-company-270x270.png" />
<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>
	<script type="rocketlazyloadscript" data-rocket-type="text/javascript"><!-- Hotjar Tracking Code for https://www.harfanglab.io --> <script>     (function(h,o,t,j,a,r){         h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};         h._hjSettings={hjid:3792786,hjsv:6};         a=o.getElementsByTagName('head')[0];         r=o.createElement('script');r.async=1;         r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;         a.appendChild(r);     })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv='); </script></script></head>
<body class="inside-template-default single single-inside postid-67836 " >
			<div class="progress fixed-top js_scrollProgress">
		<div class="progress-bar" role="progressbar" aria-label="progressbar" style="0" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
	</div>
		<div id="main-wrapper">
		<header id="main-header" class="sticky">
			<nav id="main-top" class="navbar navbar-top">
				<div class="container">
					<a href="https://harfanglab.io/" class="navbar-brand">
						<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
					</a>
				</div>
			</nav>
			<nav id="main-navbar" class="navbar navbar-expand-lg not-sticky">
				<div class="border-decoration"></div>
				<div class="container">
					<a href="https://harfanglab.io/" class="navbar-brand">
						<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
					</a>
					<button type="button" data-bs-toggle="offcanvas" data-bs-target="#navOffcanvas" class="navbar-toggler collapsed">
    <div class="icons">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </div>
    <span class="visually-hidden-focusable label">
        <span>Menu</span>
        <span class="status">
            <span class="closed">Open</span>
            <span class="opened">Close</span>
        </span>
    </span>
</button>										<section id="navOffcanvas" class="navbar-collapse collapse js_navOffcanvas" tabindex="-1" data-bs-scroll="false" data-bs-backdrop="false">
						<div class="wrapper">
						<a href="https://harfanglab.io/" class="navbar-brand navbar-brand--mobile">
							<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab-mobile.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
						</a>
						<ul id="menu-main-menu-anglais" class="navbar-nav"><li id="menu-item-128780" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-128780"><a href="https://harfanglab.io/connectors/"><div class="menu-item-wrapper"><span class="menu-item-name">Solutions</span></div></a>
<ul class="sub-menu">
	<li id="menu-item-129366" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129366"><a href="https://harfanglab.io/edr/"><div class="menu-item-wrapper"><span class="menu-item-name">EDR</span></div></a></li>
	<li id="menu-item-129365" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129365"><a href="https://harfanglab.io/epp/"><div class="menu-item-wrapper"><span class="menu-item-name">EPP</span></div></a></li>
	<li id="menu-item-128781" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-128781"><a href="https://harfanglab.io/connectors/"><div class="menu-item-wrapper"><span class="menu-item-name">Connectors</span></div></a></li>
</ul>
</li>
<li id="menu-item-129367" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129367"><a href="https://harfanglab.io/plans/"><div class="menu-item-wrapper"><span class="menu-item-name">Plans</span></div></a></li>
<li id="menu-item-127507" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-127507"><a href="https://harfanglab.io/cybersecurity-case-studies/"><div class="menu-item-wrapper"><span class="menu-item-name">Case Studies</span></div></a></li>
<li id="menu-item-24691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24691"><a href="https://harfanglab.io/partners/"><div class="menu-item-wrapper"><span class="menu-item-name">Partners</span></div></a></li>
<li id="menu-item-24692" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-has-children menu-item-24692"><a href="https://harfanglab.io/blog/"><div class="menu-item-wrapper"><span class="menu-item-name">Resources</span></div></a>
<ul class="sub-menu">
	<li id="menu-item-24693" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24693"><a href="https://harfanglab.io/blog/"><div class="menu-item-wrapper"><span class="menu-item-name">HarfangLab – The Blog</span></div></a></li>
	<li id="menu-item-24694" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24694"><a href="https://harfanglab.io/insidethelab/"><div class="menu-item-wrapper"><span class="menu-item-name">Inside The Lab – The blog</span></div></a></li>
	<li id="menu-item-130132" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-130132"><a href="https://harfanglab.io/edr-mitre/"><div class="menu-item-wrapper"><span class="menu-item-name">EDR &#038; MITRE ATT&#038;CK</span></div></a></li>
	<li id="menu-item-130135" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-130135"><a href="https://harfanglab.io/cyber-attacks-types/"><div class="menu-item-wrapper"><span class="menu-item-name">Types of cyber attacks</span></div></a></li>
</ul>
</li>
</ul><ul id="menu-aside-menu-anglais" class="navbar-nav"><li id="menu-item-24696" class="btn-highlighted menu-item menu-item-type-post_type menu-item-object-page menu-item-24696"><a href="https://harfanglab.io/ask-demo/"><div class="menu-item-wrapper"><span class="menu-item-name">Request a demo</span></div><strong class="decoration-arrow-btn"><i  class="icon icon-arrow-btn"></i></strong></a></li>
</ul>						<nav class="socials">
    <p>Follow us on :</p>
    <ul>
            <li>
            <a href="https://x.com/harfanglab" class="social --twitter" target="_blank" rel="noreferrer" aria-label="twitter">
                <i class="social-icon-twitter icon-twitter">twitter</i>    
            </a>
        </li>
            <li>
            <a href="https://www.linkedin.com/company/harfanglab" class="social --linkedin" target="_blank" rel="noreferrer" aria-label="linkedin">
                <i class="social-icon-linkedin icon-linkedin">linkedin</i>    
            </a>
        </li>
        </ul>
</nav>
						</div>
					</section>
									</div>
			</nav>
		</header>
		<!-- <aside class="languages-selector languages-count-3">
    <div class="switch">
                    <a href="https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/" class="language active" title="English">
                <span>en</span>
            </a>
                    <a href="https://harfanglab.io/fr/" class="language " title="Français">
                <span>fr</span>
            </a>
                    <a href="https://harfanglab.io/de/" class="language " title="Deutsch">
                <span>de</span>
            </a>
          	</div>
</aside>
 -->

<aside class="languages-selector languages-count-3">
    <a href="https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/" class="language active" title="English"><span>en</span></a>    <div class="switch">
              </div>
</aside>

		<!-- /header#main-header -->
		<main id="main-content" role="main">
		<section id="main-hero" class="page-part page-part--hero --single --single--inside --has-illustration js_ScrollVisibility">
    <div class="inner">
        <div class="inner-pattern">
            <div class="container">
                <div class="wrapper">
                    <div class="card-decoration">
                        <span class="arrow-section">
                            <i class="arrow-big"></i>
                            <i class="arrow-big"></i>
                            <i class="arrow-big large"></i>
                        </span>
                        <span class="arrow-section arrow-section--reverse">
                            <i class="arrow-big large"></i>
                            <i class="arrow-big"></i>
                            <i class="arrow-big"></i>
                        </span>
                    </div>
                    <section class="hero-body  card--color-purple">
                        <a href="https://harfanglab.io/insidethelab/" class="archive--link archive-inside--link">
                <img width="202" height="99" src="https://harfanglab.io/medias/2023/12/logo_itb_purple.svg" alt="">
            </a>
            <!-- <span class="badge-group badge-group--lg"> -->
                                    <span class="badge-group badge-group--lg category--cyber-threat-intelligence-en">
                    CYBER THREAT INTELLIGENCE                </span>
                        <!-- </span> -->
                <h1 class="hero-title">Raspberry Robin and its new anti-emulation trick</h1>    
        <section class="hero-details">
        <div class="single-dates">
            <time class="single-date single-date--published" datetime="2024-04-03T14:34:23+02:00" itemprop="datePublished">
                Published on 3 April, 2024            </time>
            <span class="badge-group-item">
                 9 min            </span>
        </div>
    </section>
    </section>

<figure class="hero-featured">
    
			<picture class="no-lazy img-fluid full featured-picture">
											<source srcset="https://harfanglab.io/medias/2024/03/robin-6906521-640-480x340.jpg 1x ,https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg 2x " 
				width="480" height="340"
				media="(max-width: 767.98px)">
														<img srcset="https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg 1x, https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg 2x"
					alt="featured_raspberry_robin_emulator"
					width="640" height="453"
					src="https://harfanglab.io/medias/2024/03/robin-6906521-640.jpg"
					sizes="100vw">
					</picture>
	</figure>
                </div>
            </div>
        </div>
    </div>
</section>


<article class="page-part page-part--single  card--color-purple" style="--illustration-cat: url('https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg'); --color-inside: #7f1fff;">
    <div class="single-wrapper">
        <main class="single-body">
            <div class="container">
                <div class="wrapper">
                    <section class="single-content wysiwyg">
                        <section class="content">
                            <p>Reported for the first time by <a href="https://redcanary.com/threat-detection-report/threats/raspberry-robin/">Red Canary</a> in 2021, Raspberry Robin was the 9th most prevalent threat in 2023 according to their &#8220;2024 Threat Detection Report&#8221;. Starting as a worm, it evolved to become an initial access broker for other threat actors. The success of Raspberry Robin comes from its constantly evolving evasion capabitilies, making it difficult to analyze and detect.</p>
<p>Despite Raspberry Robin being regularly analyzed by various vendors such as <a href="https://research.checkpoint.com/2024/raspberry-robin-keeps-riding-the-wave-of-endless-1-days/">Check Point</a> and <a href="https://decoded.avast.io/janvojtesek/raspberry-robins-roshtyak-a-little-lesson-in-trickery/">Avast</a>, our team discovered a recent variant featuring interesting and as-of-yet unknown anti-emulation techniques.</p>
<h2>Windows Defender Emulator</h2>
<p>During the Black Hat edition of 2018, Alexei Bulazel presented his work on the &#8220;Windows Defender Emulator&#8221; in a talk titled <a href="https://i.blackhat.com/us-18/Thu-August-9/us-18-Bulazel-Windows-Offender-Reverse-Engineering-Windows-Defenders-Antivirus-Emulator.pdf">&#8220;Windows Offender: Reverse Engineering Windows Defender&#8217;s Antivirus Emulator&#8221;</a>.</p>
<p>This talk was an extensive analysis of the Windows Defender emulator internals. A slide seems to have caught the threat actors&#8217; and Red Teamers&#8217; attention:</p>



<figure id="attachment_67875" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67875">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/vdll-artefact.png.webp 2000w, https://harfanglab.io/medias/2024/04/vdll-artefact-1080x613.png.webp 1080w, https://harfanglab.io/medias/2024/04/vdll-artefact-480x272.png.webp 480w, https://harfanglab.io/medias/2024/04/vdll-artefact-960x545.png.webp 960w, https://harfanglab.io/medias/2024/04/vdll-artefact-720x409.png.webp 720w, https://harfanglab.io/medias/2024/04/vdll-artefact-1440x817.png.webp 1440w, https://harfanglab.io/medias/2024/04/vdll-artefact-360x204.png.webp 360w, https://harfanglab.io/medias/2024/04/vdll-artefact-240x136.png.webp 240w" sizes="(max-width: 2000px) 100vw, 2000px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/vdll-artefact.png" alt="Presentation by Alexei Bulazel of artefacts in the Windows Defender Emulator" width="2000" height="1135" srcset="https://harfanglab.io/medias/2024/04/vdll-artefact.png 2000w, https://harfanglab.io/medias/2024/04/vdll-artefact-1080x613.png 1080w, https://harfanglab.io/medias/2024/04/vdll-artefact-480x272.png 480w, https://harfanglab.io/medias/2024/04/vdll-artefact-960x545.png 960w, https://harfanglab.io/medias/2024/04/vdll-artefact-720x409.png 720w, https://harfanglab.io/medias/2024/04/vdll-artefact-1440x817.png 1440w, https://harfanglab.io/medias/2024/04/vdll-artefact-360x204.png 360w, https://harfanglab.io/medias/2024/04/vdll-artefact-240x136.png 240w" sizes="(max-width: 2000px) 100vw, 2000px"/>
</picture>
<figcaption class="wp-caption-text"> Presentation by Alexei Bulazel of artefacts in the Windows Defender Emulator</figcaption></figure>



<h2>In the wild exploitation history</h2>
<p>The first mention of a malware checking the then-published Defender emulator artifact is Arkei Stealer, reported in 2018 by <a href="https://www.sibervatan.org/raporlar/dosya/c7a2abcf-1152-4c6b-8a89-8116896febc5.pdf">Siber Vatan</a></p>



<figure id="attachment_67872" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67872">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/arkei-stealer.png.webp 958w, https://harfanglab.io/medias/2024/04/arkei-stealer-480x322.png.webp 480w, https://harfanglab.io/medias/2024/04/arkei-stealer-720x483.png.webp 720w, https://harfanglab.io/medias/2024/04/arkei-stealer-360x242.png.webp 360w, https://harfanglab.io/medias/2024/04/arkei-stealer-240x161.png.webp 240w" sizes="(max-width: 958px) 100vw, 958px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/arkei-stealer.png" alt="Analysis of Arkei stealer Windows Defender Emulator bypass showing the use of GetComputerNameA and GetUserNameA functions and comparing the output with  the emulator artefacts JohnDoe and HAL9TH" width="958" height="643" srcset="https://harfanglab.io/medias/2024/04/arkei-stealer.png 958w, https://harfanglab.io/medias/2024/04/arkei-stealer-480x322.png 480w, https://harfanglab.io/medias/2024/04/arkei-stealer-720x483.png 720w, https://harfanglab.io/medias/2024/04/arkei-stealer-360x242.png 360w, https://harfanglab.io/medias/2024/04/arkei-stealer-240x161.png 240w" sizes="(max-width: 958px) 100vw, 958px"/>
</picture>
<figcaption class="wp-caption-text"> Analysis of Arkei stealer Windows Defender Emulator bypass</figcaption></figure>



<p>The anti-emulation technique spotted in Arkei was a string comparaison between:</p>
<ul>
	<li>The computer name and &#8220;HAL9TH&#8221;</li>
	<li>The username and &#8220;JohnDoe&#8221;</li>
</ul>
<p>Indeed, in the &#8220;Windows Defender Emulator&#8221;, the Windows API function <code>GetComputerName</code> always returns <code>HAL9TH</code> and <code>GetUsername</code> the string <code>JohnDoe</code>.</p>
<p>Between 2018 and 2022, this technique seemed restricted to stealers and was observed in <a href="https://www.sibervatan.org/raporlar/dosya/eaa214dc-74d9-41ae-b50d-928049776662.pdf">Oski</a>, <a href="https://3xp0rt.com/posts/mars-stealer/">Mars</a>, <a href="https://www.vmray.com/cyber-security-blog/stealc-a-new-stealer-emerges-in-2023/">StealC</a>, <a href="https://asec.ahnlab.com/en/44554/">Vidar</a>, <a href="https://www.elastic.co/security-labs/elastic-security-labs-discovers-lobshot-malware">LOBSHOT</a> and <a href="https://www.trellix.com/blogs/research/demystifying-qbot-malware/">Qbot</a>. In the latter, Trellix researchers found in 2022 that Qbot was using a new way to detect the Windows Defender emulator.</p>



<figure id="attachment_67869" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67869">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/qbot.png.webp 910w, https://harfanglab.io/medias/2024/04/qbot-480x169.png.webp 480w, https://harfanglab.io/medias/2024/04/qbot-720x254.png.webp 720w, https://harfanglab.io/medias/2024/04/qbot-360x127.png.webp 360w, https://harfanglab.io/medias/2024/04/qbot-240x85.png.webp 240w" sizes="(max-width: 910px) 100vw, 910px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/qbot.png" alt="Trellix analysis of Qbot showing the use of a new anti-emulation technique" width="910" height="321" srcset="https://harfanglab.io/medias/2024/04/qbot.png 910w, https://harfanglab.io/medias/2024/04/qbot-480x169.png 480w, https://harfanglab.io/medias/2024/04/qbot-720x254.png 720w, https://harfanglab.io/medias/2024/04/qbot-360x127.png 360w, https://harfanglab.io/medias/2024/04/qbot-240x85.png 240w" sizes="(max-width: 910px) 100vw, 910px"/>
</picture>
<figcaption class="wp-caption-text"> Trellix analysis of Qbot showing the use of a new anti-emulation technique</figcaption></figure>



<p>Instead of checking the current computer and username, Qbot looked for the existence of an emulator-specific file, <code>C:\INTERNAL\__empty</code>. If at first glance this check seemed original, this artefact was also disclosed in Bulazel&#8217;s talk.</p>



<figure id="attachment_67866" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67866">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/vfs.png.webp 1992w, https://harfanglab.io/medias/2024/04/vfs-1080x606.png.webp 1080w, https://harfanglab.io/medias/2024/04/vfs-480x269.png.webp 480w, https://harfanglab.io/medias/2024/04/vfs-960x538.png.webp 960w, https://harfanglab.io/medias/2024/04/vfs-720x404.png.webp 720w, https://harfanglab.io/medias/2024/04/vfs-1440x807.png.webp 1440w, https://harfanglab.io/medias/2024/04/vfs-360x202.png.webp 360w, https://harfanglab.io/medias/2024/04/vfs-240x135.png.webp 240w" sizes="(max-width: 1992px) 100vw, 1992px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/vfs.png" alt="Slide showing &quot;C:\INTERNAL\__empty&quot; in the listed files available in the Window Defender Emulator" width="1992" height="1117" srcset="https://harfanglab.io/medias/2024/04/vfs.png 1992w, https://harfanglab.io/medias/2024/04/vfs-1080x606.png 1080w, https://harfanglab.io/medias/2024/04/vfs-480x269.png 480w, https://harfanglab.io/medias/2024/04/vfs-960x538.png 960w, https://harfanglab.io/medias/2024/04/vfs-720x404.png 720w, https://harfanglab.io/medias/2024/04/vfs-1440x807.png 1440w, https://harfanglab.io/medias/2024/04/vfs-360x202.png 360w, https://harfanglab.io/medias/2024/04/vfs-240x135.png 240w" sizes="(max-width: 1992px) 100vw, 1992px"/>
</picture>
<figcaption class="wp-caption-text"> Slide showing &#8220;C:\INTERNAL\__empty&#8221; in the listed files available in the Window Defender Emulator</figcaption></figure>



<h2>The Raspberry Robin innovation</h2>
<p>During an incident detected at one of our clients&#8217;, we came across a Raspberry Robin distributor acting as a crack/keygen website.</p>



<figure id="attachment_67854" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67854">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/distribution-platform.png.webp 1047w, https://harfanglab.io/medias/2024/04/distribution-platform-1033x720.png.webp 1033w, https://harfanglab.io/medias/2024/04/distribution-platform-480x335.png.webp 480w, https://harfanglab.io/medias/2024/04/distribution-platform-960x669.png.webp 960w, https://harfanglab.io/medias/2024/04/distribution-platform-720x502.png.webp 720w, https://harfanglab.io/medias/2024/04/distribution-platform-360x251.png.webp 360w, https://harfanglab.io/medias/2024/04/distribution-platform-240x167.png.webp 240w" sizes="(max-width: 1047px) 100vw, 1047px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/distribution-platform.png" alt="Screenshot of a Raspberry Robin distributor website" width="1047" height="730" srcset="https://harfanglab.io/medias/2024/04/distribution-platform.png 1047w, https://harfanglab.io/medias/2024/04/distribution-platform-1033x720.png 1033w, https://harfanglab.io/medias/2024/04/distribution-platform-480x335.png 480w, https://harfanglab.io/medias/2024/04/distribution-platform-960x669.png 960w, https://harfanglab.io/medias/2024/04/distribution-platform-720x502.png 720w, https://harfanglab.io/medias/2024/04/distribution-platform-360x251.png 360w, https://harfanglab.io/medias/2024/04/distribution-platform-240x167.png 240w" sizes="(max-width: 1047px) 100vw, 1047px"/>
</picture>
<figcaption class="wp-caption-text"> Screenshot of a Raspberry Robin distributor website</figcaption></figure>



<p>Instead of the advertised piracy software, the website provides zip files containing SFX (self-extracting) archives. The website offers the same file no matter what &#8220;crack/keygen&#8221; software the user chooses.</p>
<p>Once one of them is executed, 3 malware samples are dropped: two stealers (Pony and AZORULT) and Raspberry Robin. The latter is dropped as a <code>.cpl</code> file named <code>keygen-step-2.cpl</code>.</p>



<figure id="attachment_67851" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67851">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/crack-execution-flow.png.webp 780w, https://harfanglab.io/medias/2024/04/crack-execution-flow-480x425.png.webp 480w, https://harfanglab.io/medias/2024/04/crack-execution-flow-720x637.png.webp 720w, https://harfanglab.io/medias/2024/04/crack-execution-flow-360x318.png.webp 360w, https://harfanglab.io/medias/2024/04/crack-execution-flow-240x212.png.webp 240w" sizes="(max-width: 780px) 100vw, 780px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/crack-execution-flow.png" alt="Execution flow of fake cracks distributed on keygenguru[.]com" width="780" height="690" srcset="https://harfanglab.io/medias/2024/04/crack-execution-flow.png 780w, https://harfanglab.io/medias/2024/04/crack-execution-flow-480x425.png 480w, https://harfanglab.io/medias/2024/04/crack-execution-flow-720x637.png 720w, https://harfanglab.io/medias/2024/04/crack-execution-flow-360x318.png 360w, https://harfanglab.io/medias/2024/04/crack-execution-flow-240x212.png 240w" sizes="(max-width: 780px) 100vw, 780px"/>
</picture>
<figcaption class="wp-caption-text"> Execution flow of fake cracks distributed on &#8220;keygenguru[.]com&#8221;</figcaption></figure>



<p>When executed, the program runs multiple anti-emulation/sandbox checks. However, one of the checks caught our attention:</p>



<figure id="attachment_67863" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67863">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/imported-function-vdll.png.webp 479w, https://harfanglab.io/medias/2024/04/imported-function-vdll-360x84.png.webp 360w, https://harfanglab.io/medias/2024/04/imported-function-vdll-240x56.png.webp 240w" sizes="(max-width: 479px) 100vw, 479px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/imported-function-vdll.png" alt="Import of a non-existing function in kernel32" width="479" height="112" srcset="https://harfanglab.io/medias/2024/04/imported-function-vdll.png 479w, https://harfanglab.io/medias/2024/04/imported-function-vdll-360x84.png 360w, https://harfanglab.io/medias/2024/04/imported-function-vdll-240x56.png 240w" sizes="(max-width: 479px) 100vw, 479px"/>
</picture>
<figcaption class="wp-caption-text"> Import of a non-existing function in kernel32</figcaption></figure>



<p>The malware tries to dynamically import the function <code>MpVmp32Entry</code> from <code>Kernel32.dll</code> and if the import succeeds, then the malware exits. However, this function doesn&#8217;t normally exist in Kernel32.</p>
<p>Bulazel&#8217;s presentation introduced the concept of VDLL. VDLLs are modified Windows system DLLs available only in the emulator, and such DLLs may export functions that don&#8217;t otherwise exist (shown in yellow below):</p>



<figure id="attachment_67860" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67860">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator.png.webp 1170w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-1080x594.png.webp 1080w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-480x264.png.webp 480w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-960x528.png.webp 960w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-720x396.png.webp 720w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-360x198.png.webp 360w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-240x132.png.webp 240w" sizes="(max-width: 1170px) 100vw, 1170px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator.png" alt="Presentation by Alexei Bulazelof of VDLL functions" width="1170" height="643" srcset="https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator.png 1170w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-1080x594.png 1080w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-480x264.png 480w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-960x528.png 960w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-720x396.png 720w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-360x198.png 360w, https://harfanglab.io/medias/2024/04/vdll-functions-exported-emulator-240x132.png 240w" sizes="(max-width: 1170px) 100vw, 1170px"/>
</picture>
<figcaption class="wp-caption-text"> Presentation by Alexei Bulazelof of VDLL functions</figcaption></figure>



<p>The function <code>MpVmp32Entry</code> starts with <code>Mp</code>, which indicated that it could be one of the functions available only in the VDLL version of <code>Kernel32.dll</code>. We extracted the Kernel32 VDLL from the emulator in order to analyze its exports and found out that this function is indeed exported by the VDLL:</p>



<figure id="attachment_67857" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full size-full wp-image-67857">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/mpvmp32entry-exported.png.webp 1282w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-1080x196.png.webp 1080w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-480x87.png.webp 480w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-960x174.png.webp 960w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-720x131.png.webp 720w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-360x65.png.webp 360w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-240x44.png.webp 240w" sizes="(max-width: 1282px) 100vw, 1282px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/04/mpvmp32entry-exported.png" alt="MpVmp32Entry function available in the Kernel32 VDLL" width="1282" height="233" srcset="https://harfanglab.io/medias/2024/04/mpvmp32entry-exported.png 1282w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-1080x196.png 1080w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-480x87.png 480w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-960x174.png 960w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-720x131.png 720w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-360x65.png 360w, https://harfanglab.io/medias/2024/04/mpvmp32entry-exported-240x44.png 240w" sizes="(max-width: 1282px) 100vw, 1282px"/>
</picture>
<figcaption class="wp-caption-text"> &#8220;MpVmp32Entry&#8221; function available in the Kernel32 VDLL</figcaption></figure>



<p>Later on, we analyzed a new sample from the same website and discovered that the VDLL function check performed by the malware was different. This time the imported VDLL function used for anti-emulation was <code>MpReportEventEx</code>. However, unlike <code>MpVmp32Entry</code>, the function <code>MpReportEventEx</code> is listed in Bulazel&#8217;s presentation.</p>
<p>Raspberry Robin seems to be the first malware to use VDLL specific function import as an anti-emulation trick and could exploit more advanced anti-Defender emulator trick in the future.</p>
<p>In order, to evade IOC-based detection, the Raspberry Robin sample distributed by this website is changed (probably re-packed) every 30 minutes (at the minutes 15 and 45 of every hour). This likely means that a Raspberry Robin sample distributed on this website exists only for 30 minutes. This short lifespan leads to an absence of results when reseaching information based on the file hash making the hunt a little bit harder for the researcher.</p>
<h2>Potential Windows Defender emulator artifacts used for anti-emulation</h2>
<h3>Files and directories</h3>
<pre><code>aaa_TouchMeNot_
_TouchMeNot_
__empty
C:\myapp.exe
C:\Mirc
C:\Mirc\mirc.ini
C:\Mirc\script.ini</code></pre>
<h3>Strings</h3>
<pre><code>HAL9TH
JohnDoe
MpSockVendor
MPGoodStatus
MpDisableSehLimit</code></pre>
<h3>VDLL exports</h3>
<pre><code>NtControlChannel
ObjMgr_ValidateVFSHandle
ThrdMgr_GetCurrentThreadHandle
ThrdMgr_SaveTEB
ThrdMgr_SwitchThreads
VFS_CopyFile
VFS_DeleteFile
VFS_DeleteFileByHandle
VFS_FileExists
VFS_FindClose
VFS_FindFirstFile
VFS_FindNextFile
VFS_FlushViewOfFile
VFS_GetAttrib
VFS_GetHandle
VFS_GetLength
VFS_MapViewOfFile
VFS_MoveFile
VFS_Open
VFS_Read
VFS_SetAttrib
VFS_SetCurrentDir
VFS_SetLength
VFS_UnmapViewOfFile
VFS_Write
MpAddToScanQueue
MpCreateMemoryAliasing
MpCallPostEntryPointCode
MpCallPreEntryPointCode
MpDispatchException
MpExitThread
MpFinalize
MpGetCurrentThreadHandle
MpGetCurrentThreadId
MpGetLastSwitchResult
MpGetPseudoThreadHandle
MpGetSelectorBase
MpGetVStoreFileHandle
MpHandlerCodePost
MpIntHandler
MpIntHandlerParam
MpIntHandlerReturnAddress
MpNtdllDatatSection
MpReportEvent
MpReportEventEx
MpReportEventW
MpSehHandler
MpSetSelectorBase
MpStartProcess
MpSwitchToNextThread
MpSwitchToNextThread_WithCheck
MpSwitchToNextThread_NewObjManager
MpTimerEvent
MpTimerEventData
MpUfsMetadataOp
MpValidateVFSHandle
MpVmp32Entry
MpVmp32FastEnter</code></pre>
<h2>Indicators of compromise (IOCs)</h2>
<p>Associated IOCs are also <a href="https://github.com/HarfangLab/iocs/blob/main/raspberryrobin/">available on our GitHub repository</a>.</p>
<h3>Hashes (SHA-256)</h3>
<pre><code>242851abe09cc5075d2ffdb8e5eba2f7dcf22712625ec02744eecb52acd6b1bf|keygen-step-2.cpl (Raspberry Robin)
483adf61d7d932003659d5d6242eace29ea8416ec810749333793e0efa91610d|keygen-step-2.cpl (Raspberry Robin)
50158e22481acabc56d8e3d318d6d709fcb7a9e442e76157b518d19e13f8e520|keygen-step-2.cpl (Raspberry Robin)
93672d67e8100bb984f866888cb042727567d302b30b91356a2b2bc8cd3f7912|keygen-step-2.cpl (Raspberry Robin)
b5637231e25aa7da8fe925f5b97a2ccbfd082a5463b2a05d2b3221adb35e43d9|keygen-step-2.cpl (Raspberry Robin)
b81e857427411577552d1ecdd444efaeab23ec903192812d40ab3dd69df98ec5|keygen-step-2.cpl (Raspberry Robin)
c8d37df88009122c890cb95dc79d895d39339fe1efdcfa5e033d0aea171ffc3d|keygen-step-2.cpl (Raspberry Robin)
10b4b7e9469366bfe459c3cd674aeab0692cfd9272fe369ef56d2811623e4866|keygen-step-2.cpl (Raspberry Robin)</code></pre>
<h3>Hostnames</h3>
<pre><code>keygenguru[.]com|Raspberry Robin distribution platform</code></pre>
<h3>PE information</h3>
<pre><code>hrtbddd69.dll|DLL name in keygen-step-2.cpl export table
OsTlhtlohe|Exported function in keygen-step-2.cpl</code></pre>
<h2>Yara rules</h2>
<pre><code>rule anti_emulation_defender
{
    meta:
        description = "Research Windows Defender Emulator artefacts that can be used as anti-emulator by malware"
        references = "https://harfanglab.io/en/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/‎"
        hash = "242851abe09cc5075d2ffdb8e5eba2f7dcf22712625ec02744eecb52acd6b1bf"
        date = "2024-04-03"
        author = "Harfanglab"
        context = "file"

    strings:

        $s_00 = "aaa_TouchMeNot_" wide ascii nocase
        $s_01 = "_TouchMeNot_" wide ascii nocase
        $s_03 = "C:\\myapp.exe" wide ascii nocase
        $s_04 = "C:\\Mirc\\" wide ascii nocase
        $s_05 = "C:\\Mirc\\mirc.ini" wide ascii nocase
        $s_06 = "C:\\Mirc\\script.ini" wide ascii nocase
        $s_07 = "HAL9TH" wide ascii nocase fullword
        $s_09 = "MpSockVendor" wide ascii nocase fullword
        $s_10 = "MPGoodStatus" wide ascii nocase fullword
        $s_11 = "MpDisableSehLimit" wide ascii nocase fullword
        $s_12 = "NtControlChannel" wide ascii nocase fullword
        $s_13 = "ObjMgr_ValidateVFSHandle" wide ascii nocase fullword
        $s_14 = "ThrdMgr_GetCurrentThreadHandle" wide ascii nocase fullword
        $s_15 = "ThrdMgr_SaveTEB" wide ascii nocase fullword
        $s_16 = "ThrdMgr_SwitchThreads" wide ascii nocase fullword
        $s_17 = "VFS_DeleteFileByHandle" wide ascii nocase fullword
        $s_18 = "VFS_DeleteFile" wide ascii nocase fullword
        $s_19 = "VFS_DeleteFileByHandle" wide ascii nocase fullword
        $s_20 = "VFS_FileExists" wide ascii nocase fullword
        $s_21 = "VFS_FindClose" wide ascii nocase fullword
        $s_22 = "VFS_FindFirstFile" wide ascii nocase fullword
        $s_23 = "VFS_FindNextFile" wide ascii nocase fullword
        $s_24 = "VFS_FlushViewOfFile" wide ascii nocase fullword
        $s_25 = "VFS_GetAttrib" wide ascii nocase fullword
        $s_26 = "VFS_GetHandle" wide ascii nocase fullword
        $s_27 = "VFS_GetLength" wide ascii nocase fullword
        $s_28 = "VFS_MapViewOfFile" wide ascii nocase fullword
        $s_29 = "VFS_MoveFile" wide ascii nocase fullword
        $s_30 = "VFS_Open" wide ascii nocase fullword
        $s_31 = "VFS_Read" wide ascii nocase fullword
        $s_32 = "VFS_SetAttrib" wide ascii nocase fullword
        $s_33 = "VFS_SetCurrentDir" wide ascii nocase fullword
        $s_34 = "VFS_SetLength" wide ascii nocase fullword
        $s_35 = "VFS_UnmapViewOfFile" wide ascii nocase fullword
        $s_37 = "MpAddToScanQueue" wide ascii nocase fullword
        $s_38 = "MpCreateMemoryAliasing" wide ascii nocase fullword
        $s_39 = "MpCallPostEntryPointCode" wide ascii nocase fullword
        $s_40 = "MpCallPreEntryPointCode" wide ascii nocase fullword
        $s_41 = "MpDispatchException" wide ascii nocase fullword
        $s_42 = "MpExitThread" wide ascii nocase fullword
        $s_43 = "MpFinalize" wide ascii nocase fullword
        $s_44 = "MpGetCurrentThreadHandle" wide ascii nocase fullword
        $s_45 = "MpGetCurrentThreadId" wide ascii nocase fullword
        $s_46 = "MpGetLastSwitchResult" wide ascii nocase fullword
        $s_47 = "MpGetPseudoThreadHandle" wide ascii nocase fullword
        $s_48 = "MpGetSelectorBase" wide ascii nocase fullword
        $s_49 = "MpGetVStoreFileHandle" wide ascii nocase fullword
        $s_50 = "MpHandlerCodePost" wide ascii nocase fullword
        $s_51 = "MpIntHandler" wide ascii nocase fullword
        $s_52 = "MpIntHandlerParam" wide ascii nocase fullword
        $s_53 = "MpIntHandlerReturnAddress" wide ascii nocase fullword
        $s_54 = "MpNtdllDatatSection" wide ascii nocase fullword
        $s_55 = "MpReportEvent" wide ascii nocase fullword
        $s_56 = "MpReportEventEx" wide ascii nocase fullword
        $s_57 = "MpReportEventW" wide ascii nocase fullword
        $s_58 = "MpSehHandler" wide ascii nocase fullword
        $s_59 = "MpSetSelectorBase" wide ascii nocase fullword
        $s_60 = "MpStartProcess" wide ascii nocase fullword
        $s_61 = "MpSwitchToNextThread" wide ascii nocase fullword
        $s_62 = "MpSwitchToNextThread_WithCheck" wide ascii nocase fullword
        $s_63 = "MpSwitchToNextThread_NewObjManager" wide ascii nocase fullword
        $s_64 = "MpTimerEvent" wide ascii nocase fullword
        $s_65 = "MpTimerEventData" wide ascii nocase fullword
        $s_66 = "MpUfsMetadataOp" wide ascii nocase fullword
        $s_67 = "MpValidateVFSHandle" wide ascii nocase fullword
        $s_68 = "MpVmp32Entry" wide ascii nocase fullword
        $s_69 = "MpVmp32FastEnter" wide ascii nocase fullword

        $filter_00 = "mpengine.pdb" ascii nocase
        $filter_01 = "MsMpEngCP.pdb" ascii nocase
        $filter_02 = "MsMpEngSvc.pdb" ascii nocase
        $filter_03 = "MpGear.pdb" ascii nocase
        $filter_04 = "mrtstub.pdb" ascii nocase
        $filter_05 = "mrt.pdb" ascii nocase
        $filter_06 = "ntoskrnl.pdb" ascii nocase
        $filter_07 = "mscorlib.pdb" ascii nocase
        $filter_08 = "dbghelp.pdb" ascii nocase
        $filter_09 = "msvcrt.pdb" ascii nocase
        $filter_10 = "mrt.exe" wide ascii nocase
        $filter_11 = "PEBMPAT:Obfuscator_EW2" wide ascii
        $filter_12 = "Unimplemented type change to VT_" wide ascii
        $filter_13 = "Initialize engine first!" wide ascii
        $filter_14 = "VirTool:Win32/Obfuscator" wide ascii
        $filter_15 = "VDMConsoleOperation" wide ascii
        $filter_16 = "VDMOperationStarted" wide ascii
        $filter_17 = "sigutils\\vdlls\\" ascii
        $filter_18 = "Microsoft.Windows.MalwareRemovalTool" wide ascii
        $filter_19 = "AppVISVSubsystems32.pdb" ascii nocase
        $filter_20 = "Microsoft.AppV.ClientProgrammability.Eventing.pdb" ascii nocase
        $filter_21 = "AppVISVSubsystems64.pdb" ascii nocase
        $filter_22 = "AppVEntSubsystems.pdb" ascii nocase
        $filter_24 = "shell32.pdb" ascii nocase
        $filter_25 = "version.pdb" ascii nocase
        $filter_26 = "mscoree.pdb" ascii nocase
        $filter_27 = "ws2_32.pdb" ascii nocase
        $filter_28 = "advapi32.pdb" ascii nocase
        $filter_29 = "AppVEntSubsystems64.pdb" ascii nocase
        $filter_30 = "AppVEntSubsystems32.pdb" ascii nocase
        $filter_31 = "AppVISVSubsystems.pdb" ascii nocase
        $filter_32 = "mpengine.dll" ascii wide nocase
        $filter_33 = "VFSAPI_VFS_" ascii wide

    condition:
        uint16(0) == 0x5A4D
        and uint32(uint32(0x3C)) == 0x00004550
        and filesize &lt; 5MB
        and 1 of ($s_*)
        and not 1 of ($filter*)
}</code></pre>
                                                            <div class="single-dates">
                                    <time class="single-date single-date--published" datetime="2024-04-03T14:34:23+02:00" itemprop="datePublished">
                                        Published on 3 April, 2024                                    </time>
                                                                        <time class="single-date single-date--modified" datetime="2024-10-11T11:35:33+02:00" itemprop="datePublished">
                                        Last update on 11 October, 2024                                    </time>
                                                                    </div>
                            
                            </section>
                            <section class="single-related">
        <div class="container">
            <div class="wrapper swiper js_relatedSwiper">
                <header>
                    <strong class="title">More <span class="text-gradient">articles</span></strong>
                </header>
                <div class="swiper-wrapper">
                    <a href="https://harfanglab.io/insidethelab/isoon-leak-analysis/" 
    id="card-34169"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/02/isoon-heading-480x360.png.webp 1x, https://harfanglab.io/medias/2024/02/isoon-heading.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/02/isoon-heading-480x360.png 1x, https://harfanglab.io/medias/2024/02/isoon-heading.png 2x" alt="A comprehensive analysis of I-Soon&#039;s commercial offering" width="480" height="360" src="https://harfanglab.io/medias/2024/02/isoon-heading-480x360.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">A comprehensive analysis of I-Soon&#8217;s commercial offering</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Identifier: TRR240301. Key Findings I-Soon&#8217;s commercial offering reveals that their main issue is processing collected data, not breaching their targets in the first place. Their products leverage deep learning to help them sort and classify stolen documents. The company appears&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-03-01T11:31:36+01:00" itemprop="datePublished">
                    Published on 1 March, 2024                </time>
                <span class="post-reading-time"> 38 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/doppelganger-operations-europe-us/" 
    id="card-128034"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/07/0-doppelganger-twins-cyber-header-480x360.png.webp 1x, https://harfanglab.io/medias/2024/07/0-doppelganger-twins-cyber-header-960x640.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/07/0-doppelganger-twins-cyber-header-480x360.png 1x, https://harfanglab.io/medias/2024/07/0-doppelganger-twins-cyber-header-960x640.png 2x" alt="Doppelgänger HarfangLab Article Banner" width="480" height="360" src="https://harfanglab.io/medias/2024/07/0-doppelganger-twins-cyber-header-480x360.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">Mid-year Doppelgänger information operations in Europe and the US</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Identifier: TRR240701. Summary This report delves into Doppelgänger information operations conducted by Russian actors, focusing on their activities from early June to late-July 2024. Our investigation was motivated by the unexpected snap general election in France, prompting a closer look&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-07-25T11:55:26+02:00" itemprop="datePublished">
                    Published on 25 July, 2024                </time>
                <span class="post-reading-time"> 54 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/apt31-indictment-analysis/" 
    id="card-76731"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/04/apt31-indictment-heading-480x360.png.webp 1x, https://harfanglab.io/medias/2024/04/apt31-indictment-heading-960x720.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/04/apt31-indictment-heading-480x360.png 1x, https://harfanglab.io/medias/2024/04/apt31-indictment-heading-960x720.png 2x" alt="APR31 indictment heading" width="480" height="360" src="https://harfanglab.io/medias/2024/04/apt31-indictment-heading-480x360.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">Analysis of the APT31 indictment</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Identifier: TRR240401  On March 25, 2024, the U.S. Department of Justice (DoJ) released an indictment of seven hackers associated with APT31, a “hacking group in support of China’s Ministry of State Security” (MSS) which has been active for 14 years.&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-04-16T15:24:33+02:00" itemprop="datePublished">
                    Published on 16 April, 2024                </time>
                <span class="post-reading-time"> 14 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/unpacking-packxor/" 
    id="card-128863"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/09/image.png.webp 1x, https://harfanglab.io/medias/2024/09/image.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/09/image.png 1x, https://harfanglab.io/medias/2024/09/image.png 2x" alt="Header image for PackXor" width="1456" height="816" src="https://harfanglab.io/medias/2024/09/image.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">Unpacking the unpleasant FIN7 gift: PackXOR</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Summary In early July 2024, the Sentinel Labs researchers released an extensive article1 about &#8220;FIN7 reboot&#8221; tooling, notably introducing &#8220;AvNeutralizer&#8221;, an anti-EDR tool. This tool has been found in the wild as a packed payload. In this article, we offer&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-09-04T16:02:09+02:00" itemprop="datePublished">
                    Published on 4 September, 2024                </time>
                <span class="post-reading-time"> 14 min</span>            </div>
        </footer>
    </div>
</a>                </div>
                <div class="swiper-controls">
                    <div class="swiper-button-prev"><span class="icon icon-arrow-swiper"></span></div>
                    <div class="swiper-button-next"><span class="icon icon-arrow-swiper"></span></div>
                </div>
            </div>
        </div>
    </section>
    <!-- /section.--related -->

                        <footer class="single-footer">
                            <div class="container">
                                <div class="wrapper">
                                                                                                </div>
                            </div>
                        </footer>

                    </section>
                                        <aside class="single-sidebar">
                        <div class="single-aside single-aside--author"><div class="author">
            <figure>
            <img width="512" height="512" src="/files/plugins/avatar-privacy/public/images/mystery.svg" alt="Alice Climent-Pommeret" class="img-fluid full rounded-circle author-avatar">
        </figure>
        <div class="author-informations">
        <strong class="author-name">Alice Climent-Pommeret</strong>                <div class="author-description">Analyste Threat Intelligence</div>    </div>
</div>
</div><div class="single-aside single-aside--author"><div class="author">
        <div class="author-informations">
                            </div>
</div>
</div><div class="single-aside single-aside--shares">
    <p>Share this post :</p>
    <a class="sharer btn-share" id="gtm-share-twitter" target="_blank" href="https://x.com/intent/tweet?url=https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/&text=Raspberry Robin and its new anti-emulation trick&via=" rel="noopener">
        <i class="icon-twitter"></i>
        <span>X</span>
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite?mini=true&url=https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/&title=Raspberry Robin and its new anti-emulation trick" class="sharer btn-share" target="_blank" title="Share on Linkedin">
        <i class="icon-linkedin"></i>
        <span>LinkedIn</span>
    </a>
    <a href="https://reddit.com/submit?url=https://harfanglab.io/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/&title=Raspberry Robin and its new anti-emulation trick" target="_blank" class="sharer btn-share" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" title="Share on Reddit">
        <i class="icon-reddit"></i>
        <span>Reddit</span>
    </a>
</div>
<article id="newsletter" class="newsletter newsletter-itb">
    <div class="newsletter-wrapper">
        <header class="newsletter-header">
            <strong>Newsletter</strong>
            <h2>Our tech content  <span class="text-gradient">in your mailbox !</span></h2>
        </header>
        <section class="newsletter-body">
            <script type="text/javascript"></script>
                <div class='gf_browser_chrome gform_wrapper gravity-theme gform-theme--no-framework' data-form-theme='gravity-theme' data-form-index='0' id='gform_wrapper_10' ><div id='gf_10' class='gform_anchor' tabindex='-1'></div>
                        <div class='gform_heading'>
							<p class='gform_required_legend'>&quot;<span class="gfield_required gfield_required_asterisk">*</span>&quot; indicates required fields</p>
                        </div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_10' id='gform_10'  action='/insidethelab/raspberry-robin-and-its-new-anti-emulation-trick/#gf_10' data-formid='10' novalidate autocomplete="off">
                        <div class='gform-body gform_body'><div id='gform_fields row_10' class='gform_fields row top_label form_sublabel_above description_below validation_below'><div class="gfield gfield--type-email gfield_contains_required field_sublabel_above gfield--no-description field_description_below field_validation_below gfield_visibility_visible col-12 mb-3"><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml encoding="utf-8" ?><html><body><label class="form-label gfield_label gform-field-label" for="input_10_1">E-mail<span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class="ginput_container ginput_container_email">
                            <input autocomplete="off"  name="input_1" id="input_10_1" type="email" value="" class="form-control-lg form-control" aria-required="true" aria-invalid="false" required="required">
                        </div></body></html>
</div></div></div>
        <div class='gform_footer top_label'> <button type="submit" class="gform_button button btn" id="gform_submit_button_10" value="Sign me up!"><span>Sign me up!<i class="icon icon-arrow-btn"></i></span></button> <input type='hidden' name='gform_ajax' value='form_id=10&amp;title=&amp;description=&amp;tabindex=0&amp;theme=gravity-theme' />
            <input type='hidden' class='gform_hidden' name='is_submit_10' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='10' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_10' value='WyJbXSIsIjYyYTI3NDUxNTJiNGZmN2ZmZmUzZjc5NGIwZTcyNDYxIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_10' id='gform_target_page_number_10' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_10' id='gform_source_page_number_10' value='1' />
            <input type='hidden' name='gform_field_values' value='' />
            
        </div>
                        </form>
                        </div>
		                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_10' id='gform_ajax_frame_10' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
		                <script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() {gformInitSpinner( 10, 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', true );jQuery('#gform_ajax_frame_10').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_10');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_10').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_10').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_10').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_10').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_10').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_10').val();gformInitSpinner( 10, 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', true );jQuery(document).trigger('gform_page_loaded', [10, current_page]);window['gf_submitting_10'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}jQuery('#gform_wrapper_10').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_10').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [10]);window['gf_submitting_10'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_10').text());}else{jQuery('#gform_10').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger("gform_pre_post_render", [{ formId: "10", currentPage: "current_page", abort: function() { this.preventDefault(); } }]);                if (event && event.defaultPrevented) {                return;         }        const gformWrapperDiv = document.getElementById( "gform_wrapper_10" );        if ( gformWrapperDiv ) {            const visibilitySpan = document.createElement( "span" );            visibilitySpan.id = "gform_visibility_test_10";            gformWrapperDiv.insertAdjacentElement( "afterend", visibilitySpan );        }        const visibilityTestDiv = document.getElementById( "gform_visibility_test_10" );        let postRenderFired = false;                function triggerPostRender() {            if ( postRenderFired ) {                return;            }            postRenderFired = true;            jQuery( document ).trigger( 'gform_post_render', [10, current_page] );            gform.utils.trigger( { event: 'gform/postRender', native: false, data: { formId: 10, currentPage: current_page } } );            if ( visibilityTestDiv ) {                visibilityTestDiv.parentNode.removeChild( visibilityTestDiv );            }        }        function debounce( func, wait, immediate ) {            var timeout;            return function() {                var context = this, args = arguments;                var later = function() {                    timeout = null;                    if ( !immediate ) func.apply( context, args );                };                var callNow = immediate && !timeout;                clearTimeout( timeout );                timeout = setTimeout( later, wait );                if ( callNow ) func.apply( context, args );            };        }        const debouncedTriggerPostRender = debounce( function() {            triggerPostRender();        }, 200 );        if ( visibilityTestDiv && visibilityTestDiv.offsetParent === null ) {            const observer = new MutationObserver( ( mutations ) => {                mutations.forEach( ( mutation ) => {                    if ( mutation.type === 'attributes' && visibilityTestDiv.offsetParent !== null ) {                        debouncedTriggerPostRender();                        observer.disconnect();                    }                });            });            observer.observe( document.body, {                attributes: true,                childList: false,                subtree: true,                attributeFilter: [ 'style', 'class' ],            });        } else {            triggerPostRender();        }    } );} );
});</script>
        </section>
    </div>
        <figure class="newsletter-thumbnail">
        
										<img width="500" height="540" srcset="https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg 1x, https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg 2x"
					class="card-img img-fluid full"
					alt=""
				
					src="https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg"
					sizes="100vw">
						    </figure>
    </article>                    </aside>
                                    </div>
            </div>
        </main>

    </div>
</article>
<!-- /article.single -->



	</main>
	<!-- /main#main-content -->

	<footer id="main-footer">

		<div class="wrapper--widgets">
			<div class="container">
				<section class="footer-part footer-part--widgets" role="complementary" aria-label="Footer widget area">
									<section id="harfanglab_company-2" class="widget footer-widget widget_harfanglab_company"><div class="widget-wrapper">

        <section class="widget-body">
        <figure class="widget-company">
                            <img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="img-fluid company-logo" width="225" height="65">
                    </figure>
        <div class="description">5, rue Feydeau 75002 Paris <br>
</div>    </section>
    
</div>
</section><section id="nav_menu-2" class="widget footer-widget widget_nav_menu"><div class="menu-menu-footer-widget-anglais-container"><ul id="menu-menu-footer-widget-anglais" class="menu"><li id="menu-item-24701" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24701"><a href="https://harfanglab.io/about/"><div class="menu-item-wrapper"><span class="menu-item-name">About us</span></div></a></li>
<li id="menu-item-24702" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24702"><a href="https://harfanglab.io/press/"><div class="menu-item-wrapper"><span class="menu-item-name">Newsroom</span></div></a></li>
</ul></div></section>									<nav class="socials">
    <p>Follow us on :</p>
    <ul>
            <li>
            <a href="https://x.com/harfanglab" class="social --twitter" target="_blank" rel="noreferrer" aria-label="twitter">
                <i class="social-icon-twitter icon-twitter">twitter</i>    
            </a>
        </li>
            <li>
            <a href="https://www.linkedin.com/company/harfanglab" class="social --linkedin" target="_blank" rel="noreferrer" aria-label="linkedin">
                <i class="social-icon-linkedin icon-linkedin">linkedin</i>    
            </a>
        </li>
        </ul>
</nav>
				</section>
			</div>
		</div>
		<div class="wrapper--legals">
			<div class="container">
				<section class="footer-part footer-part--mentions">
					<span class="copyright">Copyright &copy; 2024, All Rights Reserved.</span>
					<ul id="mentions" class="navbar-links">
            <li id="nav-item-24697" class="nav-item">
                            <a href="https://harfanglab.io/legal-notices/" class="nav-link" >
                                        <span>Terms of use</span>
                </a>
                    </li>
            <li id="nav-item-24698" class="nav-item">
                            <a href="https://harfanglab.io/terms-of-use/" class="nav-link" >
                                        <span>General terms and conditions</span>
                </a>
                    </li>
            <li id="nav-item-24699" class="nav-item">
                            <a href="https://harfanglab.io/legal-notices/#cookies" class="nav-link" >
                                        <span>Cookie management</span>
                </a>
                    </li>
            <li id="nav-item-104384" class="nav-item">
                            <a href="https://harfanglab.io/security/" class="nav-link" >
                                        <span>Security</span>
                </a>
                    </li>
    </ul>
				</section>
			</div>
		</div>
	</footer>
	<!-- /footer#main-footer -->

</div>
<!-- /div#main-wrapper -->

    <script>window.addEventListener('DOMContentLoaded', function() {
        jQuery(document).bind('gform_post_render', function(e, formID) {
            if (!jQuery('.gform_validation_errors').length) {
                return;
            }
            const form = document.getElementById('gform_' + formID);
            form.classList.add('was-validated');
        });
    });</script>
<!-- Start of Async HubSpot Analytics Code -->
<script type="rocketlazyloadscript" data-rocket-type="text/javascript">
(function(d,s,i,r) {
if (d.getElementById(i)){return;}
var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/25847055.js';
e.parentNode.insertBefore(n, e);
})(document,"script","hs-analytics",300000);
</script>
<!-- End of Async HubSpot Analytics Code -->
<script type="rocketlazyloadscript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script id="rocket-preload-links-js-extra">
var RocketPreloadLinksConfig = {"excludeUris":"\/(?:.+\/)?feed(?:\/(?:.+\/?)?)?$|\/(?:.+\/)?embed\/|\/(index.php\/)?(.*)wp-json(\/.*|$)|\/refer\/|\/go\/|\/recommend\/|\/recommends\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php|html|htm","siteUrl":"https:\/\/harfanglab.io","onHoverDelay":"100","rateThrottle":"3"};
</script>
<script type="rocketlazyloadscript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>
<script id="harfanglab-pkg-js-extra">
var $_wp = {"ajaxurl":"https:\/\/harfanglab.io\/wp-admin\/admin-ajax.php?wpml_lang=en","current_lang":["en"]};
</script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/files/themes/harfangLab/assets/js/pkg.min.js?ver=1.5.4" id="harfanglab-pkg-js" data-rocket-defer defer></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/dom-ready.min.js?ver=f77871ff7694fffea381" id="wp-dom-ready-js" data-rocket-defer defer></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/hooks.min.js?ver=2810c76e705dd1a53b18" id="wp-hooks-js"></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/i18n.min.js?ver=5e580eb46a90c2b997e6" id="wp-i18n-js"></script>
<script type="rocketlazyloadscript" id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/a11y.min.js?ver=d90eebea464f6c09bfd5" id="wp-a11y-js" data-rocket-defer defer></script>
<script defer='defer' src="/files/plugins/gravityforms/js/jquery.json.min.js?ver=2.8.17" id="gform_json-js"></script>
<script id="gform_gravityforms-js-extra">
var gform_i18n = {"datepicker":{"days":{"monday":"Mo","tuesday":"Tu","wednesday":"We","thursday":"Th","friday":"Fr","saturday":"Sa","sunday":"Su"},"months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"firstDay":1,"iconText":"Select date"}};
var gf_legacy_multi = [];
var gform_gravityforms = {"strings":{"invalid_file_extension":"This type of file is not allowed. Must be one of the following:","delete_file":"Delete this file","in_progress":"in progress","file_exceeds_limit":"File exceeds size limit","illegal_extension":"This type of file is not allowed.","max_reached":"Maximum number of files reached","unknown_error":"There was a problem while saving the file on the server","currently_uploading":"Please wait for the uploading to complete","cancel":"Cancel","cancel_upload":"Cancel this upload","cancelled":"Cancelled"},"vars":{"images_url":"\/files\/plugins\/gravityforms\/images"}};
var gf_global = {"gf_currency_config":{"name":"Euro","symbol_left":"","symbol_right":"&#8364;","symbol_padding":" ","thousand_separator":".","decimal_separator":",","decimals":2,"code":"EUR"},"base_url":"\/files\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"\/files\/plugins\/gravityforms\/images\/spinner.svg","version_hash":"523413a6fbba0dd581b944eb64c54e66","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
</script>
<script defer='defer' src="/files/plugins/gravityforms/js/gravityforms.min.js?ver=2.8.17" id="gform_gravityforms-js"></script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/utils.min.js?ver=50c7bea9c2320e16728e44ae9fde5f26" id="gform_gravityforms_utils-js"></script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/vendor-theme.min.js?ver=54e7080aa7a02c83aa61fae430b9d869" id="gform_gravityforms_theme_vendors-js"></script>
<script id="gform_gravityforms_theme-js-extra">
var gform_theme_config = {"common":{"form":{"honeypot":{"version_hash":"523413a6fbba0dd581b944eb64c54e66"}}},"hmr_dev":"","public_path":"\/files\/plugins\/gravityforms\/assets\/js\/dist\/"};
</script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/scripts-theme.min.js?ver=bab19fd84843dabc070e73326d787910" id="gform_gravityforms_theme-js"></script>
<script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() { jQuery(document).on('gform_post_render', function(event, formId, currentPage){if(formId == 10) {jQuery( "#gform_10" ).on( 'submit', function( event ) {
	jQuery( '<input>' )
		.attr( 'type', 'hidden' )
		.attr( 'name', 'gf_zero_spam_key' )
		.attr( 'value', 'jBPTBQnMnCKnxqDa1jhRL1gqpst2CpBbB3f2t9XcxfRpAIgypEkrVbZzx0iLnZeb' )
		.attr( 'autocomplete', 'new-password' )
		.appendTo( jQuery( this ) );
} );} } );jQuery(document).on('gform_post_conditional_logic', function(event, formId, fields, isInit){} ) } );
});</script>
<script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() {jQuery(document).trigger("gform_pre_post_render", [{ formId: "10", currentPage: "1", abort: function() { this.preventDefault(); } }]);                if (event && event.defaultPrevented) {                return;         }        const gformWrapperDiv = document.getElementById( "gform_wrapper_10" );        if ( gformWrapperDiv ) {            const visibilitySpan = document.createElement( "span" );            visibilitySpan.id = "gform_visibility_test_10";            gformWrapperDiv.insertAdjacentElement( "afterend", visibilitySpan );        }        const visibilityTestDiv = document.getElementById( "gform_visibility_test_10" );        let postRenderFired = false;                function triggerPostRender() {            if ( postRenderFired ) {                return;            }            postRenderFired = true;            jQuery( document ).trigger( 'gform_post_render', [10, 1] );            gform.utils.trigger( { event: 'gform/postRender', native: false, data: { formId: 10, currentPage: 1 } } );            if ( visibilityTestDiv ) {                visibilityTestDiv.parentNode.removeChild( visibilityTestDiv );            }        }        function debounce( func, wait, immediate ) {            var timeout;            return function() {                var context = this, args = arguments;                var later = function() {                    timeout = null;                    if ( !immediate ) func.apply( context, args );                };                var callNow = immediate && !timeout;                clearTimeout( timeout );                timeout = setTimeout( later, wait );                if ( callNow ) func.apply( context, args );            };        }        const debouncedTriggerPostRender = debounce( function() {            triggerPostRender();        }, 200 );        if ( visibilityTestDiv && visibilityTestDiv.offsetParent === null ) {            const observer = new MutationObserver( ( mutations ) => {                mutations.forEach( ( mutation ) => {                    if ( mutation.type === 'attributes' && visibilityTestDiv.offsetParent !== null ) {                        debouncedTriggerPostRender();                        observer.disconnect();                    }                });            });            observer.observe( document.body, {                attributes: true,                childList: false,                subtree: true,                attributeFilter: [ 'style', 'class' ],            });        } else {            triggerPostRender();        }    } );
});</script>
<script>window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(var i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="/files/plugins/wp-rocket/assets/js/lazyload/17.8.3/lazyload.min.js"></script><script>function lazyLoadThumb(e,alt,l){var t='<img src="https://i.ytimg.com/vi/ID/hqdefault.jpg" alt="" width="480" height="360">',a='<button class="play" aria-label="play Youtube video"></button>';if(l){t=t.replace('data-lazy-','');t=t.replace('loading="lazy"','');t=t.replace(/<noscript>.*?<\/noscript>/g,'');}t=t.replace('alt=""','alt="'+alt+'"');return t.replace("ID",e)+a}function lazyLoadYoutubeIframe(){var e=document.createElement("iframe"),t="ID?autoplay=1";t+=0===this.parentNode.dataset.query.length?"":"&"+this.parentNode.dataset.query;e.setAttribute("src",t.replace("ID",this.parentNode.dataset.src)),e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","1"),e.setAttribute("allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"),this.parentNode.parentNode.replaceChild(e,this.parentNode)}document.addEventListener("DOMContentLoaded",function(){var exclusions=["*.svg","no-lazy"];var e,t,p,u,l,a=document.getElementsByClassName("rll-youtube-player");for(t=0;t<a.length;t++)(e=document.createElement("div")),(u='https://i.ytimg.com/vi/ID/hqdefault.jpg'),(u=u.replace('ID',a[t].dataset.id)),(l=exclusions.some(exclusion=>u.includes(exclusion))),e.setAttribute("data-id",a[t].dataset.id),e.setAttribute("data-query",a[t].dataset.query),e.setAttribute("data-src",a[t].dataset.src),(e.innerHTML=lazyLoadThumb(a[t].dataset.id,a[t].dataset.alt,l)),a[t].appendChild(e),(p=e.querySelector(".play")),(p.onclick=lazyLoadYoutubeIframe)});</script>
	<script type="rocketlazyloadscript" data-rocket-type="text/javascript">window.axeptioSettings = {
      clientId: "651abc3de8845f401f9b0009",
      cookiesVersion: 'harfanglab-en'
};

 
(function(d, s) {
  var t = d.getElementsByTagName(s)[0], e = d.createElement(s);
  e.async = true; e.src = "//static.axept.io/sdk.js";
  t.parentNode.insertBefore(e, t);
})(document, "script");



function launchGA(){
var el = document.createElement('script');
el.setAttribute('type', 'text/javascript');
el.setAttribute('async', true);
el.setAttribute('src', '//www.googletagmanager.com/gtag/js?id=G-WPZQYJHVT1');
document.body.append(el); window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WPZQYJHVT1', { 'anonymize_ip': true });
gtag('config', 'G-WPZQYJHVT1', {'link_attribution': true});
}


// La fonction qui relie Axeptio au lancement du cookie Google Analytics
void 0 === window._axcb && (window._axcb = []);
window._axcb.push(function(axeptio) {
     axeptio.on("cookies:complete", function(choices) {
    if(choices.google_analytics) {
       launchGA();
      }
     });
});</script>

</body>

</html>

<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->