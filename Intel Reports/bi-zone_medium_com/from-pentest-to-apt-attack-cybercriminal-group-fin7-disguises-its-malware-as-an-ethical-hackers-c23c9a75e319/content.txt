<!doctype html><html lang="en"><head><title data-rh="true">From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s toolkit | by BI.ZONE | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2021-05-13T08:37:45.935Z"/><meta data-rh="true" name="title" content="From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s toolkit | by BI.ZONE | Medium"/><meta data-rh="true" property="og:title" content="From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s…"/><meta data-rh="true" property="al:android:url" content="medium://p/c23c9a75e319"/><meta data-rh="true" property="al:ios:url" content="medium://p/c23c9a75e319"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="This is not the first time we have come across a cybercriminal group that pretends to be a legitimate organisation and disguises its malware as a security analysis tool. These groups hire employees…"/><meta data-rh="true" property="og:description" content="The article was prepared by BI.ZONE Cyber Threats Research Team"/><meta data-rh="true" property="og:url" content="https://bi-zone.medium.com/from-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319"/><meta data-rh="true" property="al:web:url" content="https://bi-zone.medium.com/from-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*taUQbk4kjpJNmaXX-GBdpw.png"/><meta data-rh="true" property="og:image:alt" content="Figure 1. Carbanak backdoor version 3.7.4 interface"/><meta data-rh="true" property="article:author" content="https://bi-zone.medium.com"/><meta data-rh="true" name="author" content="BI.ZONE"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s…"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/c23c9a75e319"/><meta data-rh="true" property="twitter:description" content="The article was prepared by BI.ZONE Cyber Threats Research Team"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*taUQbk4kjpJNmaXX-GBdpw.png"/><meta data-rh="true" name="twitter:image:alt" content="Figure 1. Carbanak backdoor version 3.7.4 interface"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@bizone_en"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="17 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://bi-zone.medium.com"/><link data-rh="true" rel="canonical" href="https://bi-zone.medium.com/from-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/c23c9a75e319"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*taUQbk4kjpJNmaXX-GBdpw.png"],"url":"https:\u002F\u002Fbi-zone.medium.com\u002Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319","dateCreated":"2021-05-13T08:37:45.935Z","datePublished":"2021-05-13T08:37:45.935Z","dateModified":"2022-01-06T20:05:37.166Z","headline":"From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s toolkit","name":"From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s toolkit","description":"This is not the first time we have come across a cybercriminal group that pretends to be a legitimate organisation and disguises its malware as a security analysis tool. These groups hire employees…","identifier":"c23c9a75e319","author":{"@type":"Person","name":"BI.ZONE","url":"https:\u002F\u002Fbi-zone.medium.com"},"creator":["BI.ZONE"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fbi-zone.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fbi-zone.medium.com\u002Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319"}</script><style type="text/css" data-fela-rehydration="552" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="552" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{line-height:1.58}.mh{letter-spacing:-0.004em}.mi{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nd{margin-bottom:-0.46em}.ne{line-height:1.12}.nf{letter-spacing:-0.022em}.ng{font-weight:600}.ob{margin-bottom:-0.28em}.oh{text-decoration:underline}.oi{margin-left:auto}.oj{margin-right:auto}.ok{max-width:1397px}.oq{clear:both}.os{cursor:zoom-in}.ot{z-index:auto}.ov{height:auto}.ow{margin-top:10px}.ox{max-width:728px}.pa{font-style:inherit}.pb{padding:2px 4px}.pc{font-size:75%}.pd> strong{font-family:inherit}.pe{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.pk{max-width:3122px}.pl{padding-top:5px}.pm{padding-bottom:5px}.pn{max-width:4270px}.po{list-style-type:disc}.pp{margin-left:30px}.pq{padding-left:0px}.pw{margin:auto}.px{overflow:hidden}.py{padding-bottom:100%}.pz{height:0}.qa{max-width:3092px}.qb{max-width:3105px}.qc{max-width:2020px}.qd{max-width:3097px}.qe{max-width:1223px}.qf{max-width:1028px}.qg{max-width:1089px}.qh{max-width:946px}.qi{max-width:930px}.qj{max-width:606px}.qk{max-width:1257px}.ql{max-width:805px}.qm{max-width:809px}.qn{max-width:656px}.qo{max-width:908px}.qp{list-style-type:decimal}.qq{max-width:855px}.qr{max-width:662px}.qs{max-width:954px}.qt{max-width:730px}.qu{font-style:italic}.qv{max-width:819px}.qw{max-width:803px}.qx{max-width:735px}.qy{max-width:769px}.qz{max-width:960px}.ra{max-width:788px}.rb{max-width:952px}.rc{max-width:876px}.rd{max-width:618px}.re{max-width:956px}.rf{max-width:703px}.rg{max-width:684px}.rh{max-width:881px}.ri{max-width:695px}.rj{max-width:975px}.rk{overflow-x:auto}.rl{padding:20px}.rm{border-radius:0}.rn{background:#F2F2F2}.ro{line-height:1.18}.rp{margin-top:-0.09em}.rq{margin-bottom:-0.09em}.rr{white-space:pre-wrap}.rs{min-width:fit-content}.rt{margin-bottom:26px}.ru{margin-top:6px}.rv{margin-top:8px}.rw{margin-right:8px}.rx{padding:8px 16px}.ry{border-radius:100px}.rz{transition:background 300ms ease}.sb{white-space:nowrap}.sc{border-top:none}.si{height:52px}.sj{max-height:52px}.sk{box-sizing:content-box}.sl{position:static}.sm{z-index:1}.so{max-width:155px}.su{margin-right:20px}.ta{align-items:flex-end}.tb{width:76px}.tc{height:76px}.td{border:2px solid #F9F9F9}.te{height:72px}.tf{width:72px}.tg{stroke:#F2F2F2}.th{height:36px}.ti{width:36px}.tj{color:#F2F2F2}.tk{fill:#F2F2F2}.tl{border-color:#F2F2F2}.tr{font-weight:500}.ts{font-size:24px}.tt{line-height:30px}.tu{letter-spacing:-0.016em}.tv{margin-top:16px}.tw{height:0px}.tx{border-bottom:solid 1px #E5E5E5}.ud{margin-top:72px}.ue{padding:24px 0}.uf{margin-bottom:0px}.ug{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.sa:hover{background-color:#F2F2F2}.tm:hover{background:#F2F2F2}.tn:hover{border-color:#F2F2F2}.to:hover{cursor:wait}.tp:hover{color:#F2F2F2}.tq:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.ou:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mz{font-size:20px}.na{margin-top:2.14em}.nb{line-height:32px}.nc{letter-spacing:-0.003em}.nx{font-size:24px}.ny{margin-top:1.95em}.nz{line-height:30px}.oa{letter-spacing:-0.016em}.og{margin-top:0.94em}.op{margin-top:56px}.pj{max-width:1192px}.pv{margin-top:1.14em}.sh{margin-bottom:88px}.st{display:inline-block}.sz{padding-top:72px}.uc{margin-top:40px}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.oy{margin-left:auto}.oz{text-align:center}.ss{display:inline-block}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.sr{display:inline-block}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.sq{display:inline-block}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{font-size:18px}.mk{margin-top:1.56em}.ml{line-height:28px}.mm{letter-spacing:-0.003em}.nh{font-size:20px}.ni{margin-top:1.2em}.nj{line-height:24px}.nk{letter-spacing:0}.oc{margin-top:0.67em}.ol{margin-top:40px}.pf{max-width:100%}.pr{margin-top:1.34em}.sd{margin-bottom:80px}.sp{display:inline-block}.sv{padding-top:48px}.ty{margin-top:32px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mv{font-size:20px}.mw{margin-top:2.14em}.mx{line-height:32px}.my{letter-spacing:-0.003em}.nt{font-size:24px}.nu{margin-top:1.95em}.nv{line-height:30px}.nw{letter-spacing:-0.016em}.of{margin-top:0.94em}.oo{margin-top:56px}.pi{max-width:1192px}.pu{margin-top:1.14em}.sg{margin-bottom:88px}.sy{padding-top:72px}.ub{margin-top:40px}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.mr{font-size:20px}.ms{margin-top:2.14em}.mt{line-height:32px}.mu{letter-spacing:-0.003em}.np{font-size:24px}.nq{margin-top:1.95em}.nr{line-height:30px}.ns{letter-spacing:-0.016em}.oe{margin-top:0.94em}.on{margin-top:56px}.ph{max-width:100%}.pt{margin-top:1.14em}.sf{margin-bottom:88px}.sx{padding-top:72px}.ua{margin-top:40px}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mn{font-size:18px}.mo{margin-top:1.56em}.mp{line-height:28px}.mq{letter-spacing:-0.003em}.nl{font-size:20px}.nm{margin-top:1.2em}.nn{line-height:24px}.no{letter-spacing:0}.od{margin-top:0.67em}.om{margin-top:40px}.pg{max-width:100%}.ps{margin-top:1.34em}.se{margin-bottom:80px}.sw{padding-top:48px}.tz{margin-top:32px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="print">.sn{display:none}</style><style type="text/css" data-fela-rehydration="552" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.or{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc23c9a75e319&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="77a6" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s toolkit</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a rel="noopener follow" href="/?source=post_page-----c23c9a75e319--------------------------------"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="BI.ZONE" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*cj9yFPo_JbHzvR2AQVUedg.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page-----c23c9a75e319--------------------------------">BI.ZONE</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3882bedad280&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=post_page-3882bedad280----c23c9a75e319---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">17 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">May 13, 2021</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fc23c9a75e319&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=-----c23c9a75e319---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc23c9a75e319&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;source=-----c23c9a75e319---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="344e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The article was prepared by <strong class="mi gv">BI.ZONE Cyber Threats Research Team</strong></p><p id="158e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This is not the first time we have come across a cybercriminal group that pretends to be a legitimate organisation and disguises its malware as a security analysis tool. These groups hire employees who are not even aware that they are working with real malware or that their employer is a real criminal group.</p><p id="4d55" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">One such group is the infamous FIN7 known for its APT attacks on various organisations around the globe. Recently they developed Lizar (formerly known as Tirion), a toolkit for reconnaissance and getting a foothold inside infected systems. Disguised as a legitimate cybersecurity company, the group distributes Lizar as a pentesting tool for Windows networks. This caught our attention and we did some research, the results of which we will share in this article.</p><h1 id="e4dd" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">A few words about FIN7</h1><p id="ed96" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The APT group FIN7 was presumably founded back in 2013, but we will focus on its activities starting from 2020: that’s when cybercriminals focused on ransomware attacks.</p><p id="b97c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">FIN7 compiled a list of victims by filtering companies by revenue using the <a class="af oh" href="https://www.zoominfo.com/" rel="noopener ugc nofollow" target="_blank">Zoominfo</a> service. In 2020–2021, we saw attacks on an IT company headquartered in Germany, a key financial institution in Panama, a gambling establishment, several educational institutions and pharmaceuticalcompanies in the US.</p><p id="27b5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">For quite some time, FIN7 members have been using the Carbanak backdoor toolkit for reconnaissance purposes and to gain a foothold on infected systems, you can read about it in the series on FireEye’s blog (posts: <a class="af oh" href="https://www.fireeye.com/blog/threat-research/2019/04/carbanak-week-part-one-a-rare-occurrence.html" rel="noopener ugc nofollow" target="_blank">1</a>, <a class="af oh" href="https://www.fireeye.com/blog/threat-research/2019/04/carbanak-week-part-two-continuing-source-code-analysis.html" rel="noopener ugc nofollow" target="_blank">2</a>, <a class="af oh" href="https://www.fireeye.com/blog/threat-research/2019/04/carbanak-week-part-three-behind-the-backdoor.html" rel="noopener ugc nofollow" target="_blank">3</a>, <a class="af oh" href="https://www.fireeye.com/blog/threat-research/2019/04/carbanak-week-part-four-desktop-video-player.html" rel="noopener ugc nofollow" target="_blank">4</a>). We repeatedly observed the attackers attempting to masquerade as Check Point Software Technology and Forcepoint.</p><p id="392a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">An example of this can be seen in the interface of Carbanak backdoor version 3.7.4, referencing Check Point Software Technology (Fig. 1).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj ok"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*taUQbk4kjpJNmaXX-GBdpw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*taUQbk4kjpJNmaXX-GBdpw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*taUQbk4kjpJNmaXX-GBdpw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*taUQbk4kjpJNmaXX-GBdpw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*taUQbk4kjpJNmaXX-GBdpw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*taUQbk4kjpJNmaXX-GBdpw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*taUQbk4kjpJNmaXX-GBdpw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*taUQbk4kjpJNmaXX-GBdpw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*taUQbk4kjpJNmaXX-GBdpw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*taUQbk4kjpJNmaXX-GBdpw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*taUQbk4kjpJNmaXX-GBdpw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*taUQbk4kjpJNmaXX-GBdpw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*taUQbk4kjpJNmaXX-GBdpw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*taUQbk4kjpJNmaXX-GBdpw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="Figure 1. Carbanak backdoor version 3.7.4 interface" class="bh ln ov c" width="700" height="369" loading="lazy"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 1. Carbanak backdoor version 3.7.4 interface</em></figcaption></figure><p id="c608" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">A new malware package, Lizar, was recently released by the criminals. <br/>A <a class="af oh" href="https://threatintel.blog/OPBlueRaven-Part1/" rel="noopener ugc nofollow" target="_blank">report on Lizar version 1.6.4</a> was previously published online, so we decided to investigate the functionality of the newer version, 2.0.4 (compile date and time: <code class="cx pb pc pd pe b">Fri Jan 29 03:27:43 2021</code>), which we discovered in February 2021.</p><h1 id="206f" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Lizar toolkit architecture</h1><p id="96f5" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The Lizar toolkit is structurally similar to Carbanak. The components we found are listed in Table 1.</p></div></div><div class="oq"><div class="ab cb"><div class="li pf lj pg lk ph cf pi cg pj ci bh"><figure class="ol om on oo op oq pl pm paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NFCboxL1-gdaCGEhUR4DZw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NFCboxL1-gdaCGEhUR4DZw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NFCboxL1-gdaCGEhUR4DZw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NFCboxL1-gdaCGEhUR4DZw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NFCboxL1-gdaCGEhUR4DZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NFCboxL1-gdaCGEhUR4DZw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*NFCboxL1-gdaCGEhUR4DZw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*NFCboxL1-gdaCGEhUR4DZw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NFCboxL1-gdaCGEhUR4DZw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NFCboxL1-gdaCGEhUR4DZw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NFCboxL1-gdaCGEhUR4DZw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NFCboxL1-gdaCGEhUR4DZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NFCboxL1-gdaCGEhUR4DZw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*NFCboxL1-gdaCGEhUR4DZw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln ov c" width="1000" height="322" loading="eager" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du">Table 1. Essence and purpose of Lizar components</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="29b8" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Lizar loader and Lizar plugins run on an infected system and can logically be combined into the Lizar bot component.</p><p id="c189" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Figure 2 shows how Lizar’s tools function and interact.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj pn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cvZqofoKHOl0OGdEneknQQ.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cvZqofoKHOl0OGdEneknQQ.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cvZqofoKHOl0OGdEneknQQ.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cvZqofoKHOl0OGdEneknQQ.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cvZqofoKHOl0OGdEneknQQ.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cvZqofoKHOl0OGdEneknQQ.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvZqofoKHOl0OGdEneknQQ.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cvZqofoKHOl0OGdEneknQQ.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*cvZqofoKHOl0OGdEneknQQ.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*cvZqofoKHOl0OGdEneknQQ.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*cvZqofoKHOl0OGdEneknQQ.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*cvZqofoKHOl0OGdEneknQQ.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*cvZqofoKHOl0OGdEneknQQ.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*cvZqofoKHOl0OGdEneknQQ.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="317" loading="eager" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 2. Schematic of the Lizar toolkit operation</em></figcaption></figure><h1 id="e55a" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Lizar client</h1><p id="c2ae" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">Lizar client consistes of the following components:</p><ul class=""><li id="937c" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">client.ini.xml</code> — XML configuration file;</li><li id="6dd6" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">client.exe</code> — client&#x27;s main executable;</li><li id="86cc" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">libwebp_x64.dll</code> — 64-bit version of <code class="cx pb pc pd pe b"><a class="af oh" href="https://chromium.googlesource.com/webm/libwebp" rel="noopener ugc nofollow" target="_blank">libwebp</a></code> library;</li><li id="d20b" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">libwebp_x86.dll</code> — 32-bit version of <code class="cx pb pc pd pe b"><a class="af oh" href="https://chromium.googlesource.com/webm/libwebp" rel="noopener ugc nofollow" target="_blank">libwebp</a></code> library;</li><li id="60e2" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">keys</code> — a directory with the keys for encrypting traffic between the client and the server;</li><li id="c8e3" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">plugins/extra</code> — plugin directory (in practice only some plugins are present in this directory, the rest are located on the server);</li><li id="0b7e" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">rat</code> — directory with the public key from Carbanak (this component has been added in the latest version of Lizar).</li></ul><p id="42d3" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Below is the content and description of the configuration file (Table 2).</p><figure class="ol om on oo op oq"><div class="pw px l fj"><div class="py pz l"></div></div></figure></div></div><div class="oq"><div class="ab cb"><div class="li pf lj pg lk ph cf pi cg pj ci bh"><figure class="ol om on oo op oq pl pm paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RCwczJPvuW_84cmxJg1J_g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RCwczJPvuW_84cmxJg1J_g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RCwczJPvuW_84cmxJg1J_g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RCwczJPvuW_84cmxJg1J_g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RCwczJPvuW_84cmxJg1J_g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RCwczJPvuW_84cmxJg1J_g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*RCwczJPvuW_84cmxJg1J_g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RCwczJPvuW_84cmxJg1J_g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RCwczJPvuW_84cmxJg1J_g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RCwczJPvuW_84cmxJg1J_g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RCwczJPvuW_84cmxJg1J_g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RCwczJPvuW_84cmxJg1J_g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RCwczJPvuW_84cmxJg1J_g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*RCwczJPvuW_84cmxJg1J_g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln ov c" width="1000" height="597" loading="eager" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du">Table 2. Configuration file structure: elements and their descriptions</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="6731" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Table 3 shows the characteristics of the discovered <code class="cx pb pc pd pe b">client.exe</code> file.</p></div></div><div class="oq"><div class="ab cb"><div class="li pf lj pg lk ph cf pi cg pj ci bh"><figure class="ol om on oo op oq pl pm paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*B8BfNwq7RlbsS1RuWKQxRg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*B8BfNwq7RlbsS1RuWKQxRg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*B8BfNwq7RlbsS1RuWKQxRg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*B8BfNwq7RlbsS1RuWKQxRg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*B8BfNwq7RlbsS1RuWKQxRg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*B8BfNwq7RlbsS1RuWKQxRg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*B8BfNwq7RlbsS1RuWKQxRg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*B8BfNwq7RlbsS1RuWKQxRg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*B8BfNwq7RlbsS1RuWKQxRg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*B8BfNwq7RlbsS1RuWKQxRg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*B8BfNwq7RlbsS1RuWKQxRg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*B8BfNwq7RlbsS1RuWKQxRg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*B8BfNwq7RlbsS1RuWKQxRg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*B8BfNwq7RlbsS1RuWKQxRg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln ov c" width="1000" height="256" loading="eager" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du">Table 3. Characteristics of <code class="cx pb pc pd pe b">client.exe</code></figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="7e62" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Figure 3 is a screenshot of the interface of the latest client version we discovered.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AsFOygRsaGht_bCH8GesLw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AsFOygRsaGht_bCH8GesLw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AsFOygRsaGht_bCH8GesLw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AsFOygRsaGht_bCH8GesLw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AsFOygRsaGht_bCH8GesLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AsFOygRsaGht_bCH8GesLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AsFOygRsaGht_bCH8GesLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*AsFOygRsaGht_bCH8GesLw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AsFOygRsaGht_bCH8GesLw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AsFOygRsaGht_bCH8GesLw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AsFOygRsaGht_bCH8GesLw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AsFOygRsaGht_bCH8GesLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AsFOygRsaGht_bCH8GesLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*AsFOygRsaGht_bCH8GesLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="379" loading="eager" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 3. Lizar client version 2.0.4 interface</em></figcaption></figure></div></div><div class="oq"><div class="ab cb"><div class="li pf lj pg lk ph cf pi cg pj ci bh"><figure class="ol om on oo op oq pl pm paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZBDDQzeG6uva0mys3UYwiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZBDDQzeG6uva0mys3UYwiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZBDDQzeG6uva0mys3UYwiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZBDDQzeG6uva0mys3UYwiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZBDDQzeG6uva0mys3UYwiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZBDDQzeG6uva0mys3UYwiQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*ZBDDQzeG6uva0mys3UYwiQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZBDDQzeG6uva0mys3UYwiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZBDDQzeG6uva0mys3UYwiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZBDDQzeG6uva0mys3UYwiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZBDDQzeG6uva0mys3UYwiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZBDDQzeG6uva0mys3UYwiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZBDDQzeG6uva0mys3UYwiQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*ZBDDQzeG6uva0mys3UYwiQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln ov c" width="1000" height="760" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="bd1f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The client supports several bot commands. The way they look in the GUI can be seen in Fig. 4.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Q2UgCZWDElUeiFdfqmZvMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Q2UgCZWDElUeiFdfqmZvMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Q2UgCZWDElUeiFdfqmZvMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Q2UgCZWDElUeiFdfqmZvMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Q2UgCZWDElUeiFdfqmZvMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Q2UgCZWDElUeiFdfqmZvMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q2UgCZWDElUeiFdfqmZvMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Q2UgCZWDElUeiFdfqmZvMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Q2UgCZWDElUeiFdfqmZvMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Q2UgCZWDElUeiFdfqmZvMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Q2UgCZWDElUeiFdfqmZvMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Q2UgCZWDElUeiFdfqmZvMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Q2UgCZWDElUeiFdfqmZvMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Q2UgCZWDElUeiFdfqmZvMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="363" loading="eager" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 4. List of commands supported by the Lizar client</em></figcaption></figure><p id="0bff" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This is what each of the commands does:</p><ul class=""><li id="156c" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Info</code> — retrieve information about the system. The plugin for this command is located on the server. When a result is received from the plugin, the information is logged in the <code class="cx pb pc pd pe b">Info</code> column.</li><li id="061a" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Kill</code> — stop plugin.</li><li id="7996" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Period</code> — change response frequency (Fig. 5).</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*N-KMkhs2oNW_kOBR71g8Hg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*N-KMkhs2oNW_kOBR71g8Hg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*N-KMkhs2oNW_kOBR71g8Hg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*N-KMkhs2oNW_kOBR71g8Hg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*N-KMkhs2oNW_kOBR71g8Hg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*N-KMkhs2oNW_kOBR71g8Hg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N-KMkhs2oNW_kOBR71g8Hg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*N-KMkhs2oNW_kOBR71g8Hg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*N-KMkhs2oNW_kOBR71g8Hg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*N-KMkhs2oNW_kOBR71g8Hg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*N-KMkhs2oNW_kOBR71g8Hg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*N-KMkhs2oNW_kOBR71g8Hg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*N-KMkhs2oNW_kOBR71g8Hg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*N-KMkhs2oNW_kOBR71g8Hg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="363" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 5. </em><code class="cx pb pc pd pe b"><em class="pa">Period</em></code><em class="pa"> command in the Lizar client GUI</em></figcaption></figure><ul class=""><li id="af8b" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Screenshot</code> — take a screenshot (Fig. 6). The plugin for this command is located on the server. Once a screenshot is taken, it will be displayed in a separate window.</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RiR5yFniEwfRyMKu55a_WQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RiR5yFniEwfRyMKu55a_WQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RiR5yFniEwfRyMKu55a_WQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RiR5yFniEwfRyMKu55a_WQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RiR5yFniEwfRyMKu55a_WQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RiR5yFniEwfRyMKu55a_WQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RiR5yFniEwfRyMKu55a_WQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RiR5yFniEwfRyMKu55a_WQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RiR5yFniEwfRyMKu55a_WQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RiR5yFniEwfRyMKu55a_WQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RiR5yFniEwfRyMKu55a_WQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RiR5yFniEwfRyMKu55a_WQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RiR5yFniEwfRyMKu55a_WQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RiR5yFniEwfRyMKu55a_WQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="225" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 6. </em><code class="cx pb pc pd pe b"><em class="pa">Screenshot</em></code><em class="pa"> command in the Lizar client GUI</em></figcaption></figure><ul class=""><li id="7446" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">List Processes</code> — get a list of processes (Fig. 7). The plugin for this command is located on the server. If the plugin is successful, the list of processes will appear in a separate window.</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lW3mlE4OAYO9bUXFCv34Jw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lW3mlE4OAYO9bUXFCv34Jw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lW3mlE4OAYO9bUXFCv34Jw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lW3mlE4OAYO9bUXFCv34Jw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lW3mlE4OAYO9bUXFCv34Jw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lW3mlE4OAYO9bUXFCv34Jw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lW3mlE4OAYO9bUXFCv34Jw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lW3mlE4OAYO9bUXFCv34Jw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lW3mlE4OAYO9bUXFCv34Jw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lW3mlE4OAYO9bUXFCv34Jw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lW3mlE4OAYO9bUXFCv34Jw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lW3mlE4OAYO9bUXFCv34Jw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lW3mlE4OAYO9bUXFCv34Jw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lW3mlE4OAYO9bUXFCv34Jw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="213" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 7. </em><code class="cx pb pc pd pe b"><em class="pa">List Processes</em></code><em class="pa"> command in the Lizar client GUI</em></figcaption></figure><ul class=""><li id="1d60" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Command Line</code> — get CMD on the infected system. The plugin for this command is located on the server. If the plugin executes the command successfully, the result will appear in a separate window.</li><li id="26a7" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Executer</code> — launch an additional module (Fig. 8).</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7oncl8Kjofv82Lm8N_XGzw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7oncl8Kjofv82Lm8N_XGzw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7oncl8Kjofv82Lm8N_XGzw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7oncl8Kjofv82Lm8N_XGzw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7oncl8Kjofv82Lm8N_XGzw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7oncl8Kjofv82Lm8N_XGzw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7oncl8Kjofv82Lm8N_XGzw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7oncl8Kjofv82Lm8N_XGzw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7oncl8Kjofv82Lm8N_XGzw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7oncl8Kjofv82Lm8N_XGzw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7oncl8Kjofv82Lm8N_XGzw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7oncl8Kjofv82Lm8N_XGzw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7oncl8Kjofv82Lm8N_XGzw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*7oncl8Kjofv82Lm8N_XGzw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="363" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 8. </em><code class="cx pb pc pd pe b"><em class="pa">Executer</em></code><em class="pa"> command in the Lizar client GUI</em></figcaption></figure><ul class=""><li id="8540" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Jump to</code> — migrate the loader to another process. The plugin for this command is located on the server. The command parameters are passed through the <code class="cx pb pc pd pe b">client.ini.xml</code> file.</li><li id="a7f3" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">New session</code> — create another loader session (run a copy of the loader on the infected system).</li><li id="74d6" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Mimikatz</code> — run Mimikatz.</li><li id="6ee7" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Grabber</code> — run one of the plugins that collect passwords in browsers and OS. The <code class="cx pb pc pd pe b">Grabber</code> tab has two buttons: <code class="cx pb pc pd pe b">Passwords + Screens</code> and <code class="cx pb pc pd pe b">RDP</code> (Fig. 9). Activating either of them sends a command to start the corresponding plugin.</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7A-inmrioHJG4r1lvy41gw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7A-inmrioHJG4r1lvy41gw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7A-inmrioHJG4r1lvy41gw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7A-inmrioHJG4r1lvy41gw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7A-inmrioHJG4r1lvy41gw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7A-inmrioHJG4r1lvy41gw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7A-inmrioHJG4r1lvy41gw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7A-inmrioHJG4r1lvy41gw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7A-inmrioHJG4r1lvy41gw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7A-inmrioHJG4r1lvy41gw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7A-inmrioHJG4r1lvy41gw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7A-inmrioHJG4r1lvy41gw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7A-inmrioHJG4r1lvy41gw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*7A-inmrioHJG4r1lvy41gw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="363" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 9. </em><code class="cx pb pc pd pe b"><em class="pa">Grabber</em></code><em class="pa"> command in the Lizar client GUI</em></figcaption></figure><ul class=""><li id="b26c" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Network analysis</code> — run one of the plugins to retrieve Active Directory and network information (Fig. 10).</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YnvCnQHns_Xiap9VOJd7CQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YnvCnQHns_Xiap9VOJd7CQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YnvCnQHns_Xiap9VOJd7CQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YnvCnQHns_Xiap9VOJd7CQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YnvCnQHns_Xiap9VOJd7CQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YnvCnQHns_Xiap9VOJd7CQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YnvCnQHns_Xiap9VOJd7CQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YnvCnQHns_Xiap9VOJd7CQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YnvCnQHns_Xiap9VOJd7CQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YnvCnQHns_Xiap9VOJd7CQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YnvCnQHns_Xiap9VOJd7CQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YnvCnQHns_Xiap9VOJd7CQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YnvCnQHns_Xiap9VOJd7CQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YnvCnQHns_Xiap9VOJd7CQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="363" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 10. </em><code class="cx pb pc pd pe b"><em class="pa">Network analysis</em></code><em class="pa"> command in the Lizar client GUI</em></figcaption></figure><ul class=""><li id="2197" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">Rat</code> — run Carbanak (<code class="cx pb pc pd pe b">RAT</code>). The IP address and port of the server and admin panel are set via the <code class="cx pb pc pd pe b">client.ini.xml</code> configuration file (Fig. 11).</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FauGq88KB23TxOD8BIrIrg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FauGq88KB23TxOD8BIrIrg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FauGq88KB23TxOD8BIrIrg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FauGq88KB23TxOD8BIrIrg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FauGq88KB23TxOD8BIrIrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FauGq88KB23TxOD8BIrIrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FauGq88KB23TxOD8BIrIrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FauGq88KB23TxOD8BIrIrg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FauGq88KB23TxOD8BIrIrg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FauGq88KB23TxOD8BIrIrg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FauGq88KB23TxOD8BIrIrg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FauGq88KB23TxOD8BIrIrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FauGq88KB23TxOD8BIrIrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FauGq88KB23TxOD8BIrIrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="363" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 11. </em><code class="cx pb pc pd pe b"><em class="pa">Rat</em></code><em class="pa"> command in the Lizar client GUI</em></figcaption></figure><p id="d331" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">We skipped the <code class="cx pb pc pd pe b">Company computers </code>command in the general list – it does not have a handler yet, so we cannot determine exactly what it does.</p><h1 id="89ee" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Lizar server</h1><p id="bc94" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The Lizar server application, similar to the Lizar client, is written using the .NET Framework. However, unlike the client, the server runs on a remote Linux host.</p><p id="6a36" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Date and time of the last detected server version compilation: <code class="cx pb pc pd pe b">Fri Feb 19 16:16:25 2021</code>.</p><p id="991b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The application is run using the Wine utility with the pre-installed Wine Mono (<code class="cx pb pc pd pe b">wine-mono-5.0.0-x86.msi</code>).</p><p id="1e51" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The server application directory includes the following components:</p><ul class=""><li id="bb0a" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">client/keys</code> — directory with encryption keys for proper communication with the client;</li><li id="9414" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">loader/keys</code> — directory with encryption keys for proper communication with the loader;</li><li id="29fa" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">logs</code> — directory with server logs (<code class="cx pb pc pd pe b">client-traffic</code>, <code class="cx pb pc pd pe b">error</code>, <code class="cx pb pc pd pe b">info</code>);</li><li id="8c92" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">plugins</code> — plugin directory;</li><li id="7220" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">ThirdScripts — directory with the <code class="cx pb pc pd pe b">ps2x.py</code> script and the <code class="cx pb pc pd pe b">ps2p.py</code> helper module. The <code class="cx pb pc pd pe b">ps2x.py</code> script is designed to execute files on the remote host and is implemented using the <a class="af oh" href="https://github.com/SecureAuthCorp/impacket" rel="noopener ugc nofollow" target="_blank">Impacket</a> project. Command templates for this script are displayed in the client application when the appropriate option is selected.</li></ul><p id="786c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Full list of arguments supported by the script.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lU4l998WgEbksQ-ahNKuvw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lU4l998WgEbksQ-ahNKuvw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lU4l998WgEbksQ-ahNKuvw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lU4l998WgEbksQ-ahNKuvw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lU4l998WgEbksQ-ahNKuvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lU4l998WgEbksQ-ahNKuvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lU4l998WgEbksQ-ahNKuvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lU4l998WgEbksQ-ahNKuvw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lU4l998WgEbksQ-ahNKuvw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lU4l998WgEbksQ-ahNKuvw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lU4l998WgEbksQ-ahNKuvw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lU4l998WgEbksQ-ahNKuvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lU4l998WgEbksQ-ahNKuvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lU4l998WgEbksQ-ahNKuvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="231" loading="lazy" role="presentation"/></picture></div></div></figure><ul class=""><li id="3939" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">x64</code> — directory containing the <code class="cx pb pc pd pe b">SQLite.interop.dll</code> auxiliary library file (64-bit version).</li><li id="17f8" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">x86</code> — directory containing the <code class="cx pb pc pd pe b">SQLite.interop.dll</code> auxiliary library file (32-bit version).</li><li id="ff23" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">AV.lst</code> — a CSV file containing the name of the process which is associated with the antivirus product, the name and description of the antivirus product.</li></ul><p id="3c68" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Several lines from the <code class="cx pb pc pd pe b">AV.lst </code>file:</p><figure class="ol om on oo op oq"><div class="pw px l fj"><div class="py pz l"></div></div></figure><ul class=""><li id="8d96" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">data.db</code> — a database file containing information on all loaders (this information is loaded into the client application).</li><li id="45cc" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">server.exe</code> — server application.</li><li id="9723" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">server.ini.xml</code> — server application configuration file.</li></ul><p id="947d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Example contents of the configuration file:</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AUz8pSnXjk7YXbCAEGK6_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AUz8pSnXjk7YXbCAEGK6_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AUz8pSnXjk7YXbCAEGK6_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AUz8pSnXjk7YXbCAEGK6_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AUz8pSnXjk7YXbCAEGK6_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AUz8pSnXjk7YXbCAEGK6_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AUz8pSnXjk7YXbCAEGK6_Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*AUz8pSnXjk7YXbCAEGK6_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AUz8pSnXjk7YXbCAEGK6_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AUz8pSnXjk7YXbCAEGK6_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AUz8pSnXjk7YXbCAEGK6_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AUz8pSnXjk7YXbCAEGK6_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AUz8pSnXjk7YXbCAEGK6_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*AUz8pSnXjk7YXbCAEGK6_Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="160" loading="lazy" role="presentation"/></picture></div></div></figure><ul class=""><li id="7e76" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">System.Data.SQLite.dll</code> — auxiliary library file.</li></ul><h1 id="5276" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Communication between client and server</h1><p id="3ce1" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">Before being sent to the server, the data is encrypted on a session key with a length ranging from 5 to 15 bytes and then on the key specified in the configuration (31 bytes). The encryption function is shown below.</p><figure class="ol om on oo op oq"><div class="pw px l fj"><div class="py pz l"></div></div></figure><p id="09a2" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If the key specified in the configuration (31 bytes) does not match the key on the server, no data is sent from the server.</p><p id="4413" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">To verify the key on the side of the server, the client sends a checksum of the key, calculated according to the following algorithm:</p><figure class="ol om on oo op oq"><div class="pw px l fj"><div class="py pz l"></div></div></figure><p id="5544" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Data received from the server is decrypted on a session key with a length ranging from 5 to 15 bytes, then on the same pair of session key and configuration key. Function for decryption:</p><figure class="ol om on oo op oq"><div class="pw px l fj"><div class="py pz l"></div></div></figure><p id="c799" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The client and the server exchange data in binary format. The decrypted data is a list of bots (Fig. 12).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div class="oi oj qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YBgfkBMqtJzXYrhTQMnvWw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YBgfkBMqtJzXYrhTQMnvWw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YBgfkBMqtJzXYrhTQMnvWw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YBgfkBMqtJzXYrhTQMnvWw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YBgfkBMqtJzXYrhTQMnvWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YBgfkBMqtJzXYrhTQMnvWw.png 1100w, https://miro.medium.com/v2/resize:fit:1212/format:webp/1*YBgfkBMqtJzXYrhTQMnvWw.png 1212w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 606px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YBgfkBMqtJzXYrhTQMnvWw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YBgfkBMqtJzXYrhTQMnvWw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YBgfkBMqtJzXYrhTQMnvWw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YBgfkBMqtJzXYrhTQMnvWw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YBgfkBMqtJzXYrhTQMnvWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YBgfkBMqtJzXYrhTQMnvWw.png 1100w, https://miro.medium.com/v2/resize:fit:1212/1*YBgfkBMqtJzXYrhTQMnvWw.png 1212w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 606px"/><img alt="" class="bh ln ov c" width="606" height="676" loading="lazy" role="presentation"/></picture></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 12. Example of decrypted data transmitted from server to client</em></figcaption></figure><h1 id="8dd0" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Lizar loader</h1><p id="aa18" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The Lizar loader is designed to execute commands by running plugins, and to run additional modules. It runs on the infected computer.</p><p id="4e36" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As we have already mentioned, Lizar loader and Lizar plugins run on the infected system and can logically be combined into the Lizar bot component. The bot’s modular architecture makes the tool scalable and allows for independent development of all components.</p><p id="694b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">We’ve detected three kinds of bots: DLLs, EXEs and PowerShell scripts, which execute a DLL in the address space of the PowerShell process.</p><p id="1e0b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The pseudocode of the main loader function, along with the reconstructed function structure, is shown in Fig. 13.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rW1qfvioSmsX-xyxhrRvig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rW1qfvioSmsX-xyxhrRvig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rW1qfvioSmsX-xyxhrRvig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rW1qfvioSmsX-xyxhrRvig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rW1qfvioSmsX-xyxhrRvig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rW1qfvioSmsX-xyxhrRvig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rW1qfvioSmsX-xyxhrRvig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*rW1qfvioSmsX-xyxhrRvig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rW1qfvioSmsX-xyxhrRvig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rW1qfvioSmsX-xyxhrRvig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rW1qfvioSmsX-xyxhrRvig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rW1qfvioSmsX-xyxhrRvig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rW1qfvioSmsX-xyxhrRvig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*rW1qfvioSmsX-xyxhrRvig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="488" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 13. Loader’s main function pseudocode</em></figcaption></figure><p id="9568" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The following are some of the actions the <code class="cx pb pc pd pe b">x_Init</code> function performs:</p><p id="9169" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">1. Generate a random key <code class="cx pb pc pd pe b">g_ConfigKey31</code> using the function <code class="cx pb pc pd pe b">SystemFunction036</code>. This key is used to encrypt and decrypt the configuration data.</p><p id="d932" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">2. Obtain system information and calculate the checksum from the information received (Fig. 14).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*W25NEHDiSvwsg5Tf9qA0Uw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*W25NEHDiSvwsg5Tf9qA0Uw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*W25NEHDiSvwsg5Tf9qA0Uw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*W25NEHDiSvwsg5Tf9qA0Uw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*W25NEHDiSvwsg5Tf9qA0Uw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*W25NEHDiSvwsg5Tf9qA0Uw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W25NEHDiSvwsg5Tf9qA0Uw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*W25NEHDiSvwsg5Tf9qA0Uw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*W25NEHDiSvwsg5Tf9qA0Uw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*W25NEHDiSvwsg5Tf9qA0Uw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*W25NEHDiSvwsg5Tf9qA0Uw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*W25NEHDiSvwsg5Tf9qA0Uw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*W25NEHDiSvwsg5Tf9qA0Uw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*W25NEHDiSvwsg5Tf9qA0Uw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="817" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 14. Pseudocode for retrieving system information and calculating its checksum</em></figcaption></figure><p id="16be" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">3. Retrieve the current process ID (the checksum and <code class="cx pb pc pd pe b">PID</code> of the loader process are displayed in the <code class="cx pb pc pd pe b">Id</code> column in the client application).</p><p id="65be" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">4. Calculate the checksum from the previously received checksum and the current process ID (labelled <code class="cx pb pc pd pe b">g_BotId</code> in Figure 13).</p><p id="27de" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">5. Decrypt configuration data: list of IP addresses, list of ports for each server. Configuration data is decrypted on 31-byte <code class="cx pb pc pd pe b">g_LoaderKey</code> with <code class="cx pb pc pd pe b">XOR</code> algorithm. After decryption, the data is re-encrypted on <code class="cx pb pc pd pe b">g_ConfigKey31</code> with an <code class="cx pb pc pd pe b">XOR</code> algorithm. The <code class="cx pb pc pd pe b">g_LoaderKey</code> is also used when encrypting data sent to the server and when decrypting data received from the server.</p><p id="a17e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">6. Initialise global variables and critical sections for some variables. This is needed to access data from different threads.</p><p id="ffeb" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">7. Initialise executable memory for plugin execution.</p><p id="4dce" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">8. Launch five threads which process the queue of messages from the server. This mechanism is implemented using the <code class="cx pb pc pd pe b">PostQueuedCompletionStatus</code> and <code class="cx pb pc pd pe b">GetQueuedCompletionStatus</code> functions. Data received from the server is decrypted and sent to the handler (Fig.15).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xkTvGJuHyGMnh8yV1tlHUw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xkTvGJuHyGMnh8yV1tlHUw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xkTvGJuHyGMnh8yV1tlHUw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xkTvGJuHyGMnh8yV1tlHUw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xkTvGJuHyGMnh8yV1tlHUw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xkTvGJuHyGMnh8yV1tlHUw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkTvGJuHyGMnh8yV1tlHUw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*xkTvGJuHyGMnh8yV1tlHUw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xkTvGJuHyGMnh8yV1tlHUw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xkTvGJuHyGMnh8yV1tlHUw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xkTvGJuHyGMnh8yV1tlHUw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xkTvGJuHyGMnh8yV1tlHUw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xkTvGJuHyGMnh8yV1tlHUw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*xkTvGJuHyGMnh8yV1tlHUw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="407" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 15. Pseudocode algorithm for decrypting data received from the server and sending it for processing</em></figcaption></figure><p id="4a87" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The handler accepts data using the <code class="cx pb pc pd pe b">GetQueuedCompletionStatus</code> function.</p><p id="c670" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The <code class="cx pb pc pd pe b">vServerData→ServerData</code> variable contains the plugin body after decryption (look again at Fig. 15). The algorithm&#x27;s pseudocode for decrypting data received from the server is shown in Fig. 16.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div class="oi oj qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*H5kvvwUVJhiezzk2vJR5xQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*H5kvvwUVJhiezzk2vJR5xQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*H5kvvwUVJhiezzk2vJR5xQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*H5kvvwUVJhiezzk2vJR5xQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*H5kvvwUVJhiezzk2vJR5xQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*H5kvvwUVJhiezzk2vJR5xQ.png 1100w, https://miro.medium.com/v2/resize:fit:1312/format:webp/1*H5kvvwUVJhiezzk2vJR5xQ.png 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*H5kvvwUVJhiezzk2vJR5xQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*H5kvvwUVJhiezzk2vJR5xQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*H5kvvwUVJhiezzk2vJR5xQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*H5kvvwUVJhiezzk2vJR5xQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*H5kvvwUVJhiezzk2vJR5xQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*H5kvvwUVJhiezzk2vJR5xQ.png 1100w, https://miro.medium.com/v2/resize:fit:1312/1*H5kvvwUVJhiezzk2vJR5xQ.png 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px"/><img alt="" class="bh ln ov c" width="656" height="490" loading="lazy" role="presentation"/></picture></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 16. Pseudocode of the algorithm for decrypting data received from the server</em></figcaption></figure><p id="b7fa" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Before being sent to the server, the data structure has to pass through shaping as shown in Fig. 17.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9JOHXKWZqMXHGzm74eTGOA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9JOHXKWZqMXHGzm74eTGOA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9JOHXKWZqMXHGzm74eTGOA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9JOHXKWZqMXHGzm74eTGOA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9JOHXKWZqMXHGzm74eTGOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9JOHXKWZqMXHGzm74eTGOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9JOHXKWZqMXHGzm74eTGOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9JOHXKWZqMXHGzm74eTGOA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9JOHXKWZqMXHGzm74eTGOA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9JOHXKWZqMXHGzm74eTGOA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9JOHXKWZqMXHGzm74eTGOA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9JOHXKWZqMXHGzm74eTGOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9JOHXKWZqMXHGzm74eTGOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9JOHXKWZqMXHGzm74eTGOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="475" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 17. Pseudocode of the function that generates the structure sent to the server</em></figcaption></figure><h1 id="98b7" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">plugins from <code class="cx pb pc pd pe b">plugins</code> directory</h1><p id="aa71" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugins in the <code class="cx pb pc pd pe b">plugins</code> directory are sent from the server to the loader and are executed by the loader when a certain action is performed in the Lizar client application.</p><p id="8445" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The six stages of the plugins’ lifecycle:</p><ol class=""><li id="03d0" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qp pp pq bk">The user selects a command in the Lizar client application interface.</li><li id="5f68" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk">The Lizar server receives the information about the selected command.</li><li id="9f1f" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk">Depending on the command and loader bitness, the server finds a suitable plugin from the <code class="cx pb pc pd pe b">plugins</code> directory, then sends the loader a request containing the command and the body of the plugin (e.g., <code class="cx pb pc pd pe b">Screenshot{bitness}.dll</code>).</li><li id="041c" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk">The loader executes the plugin and stores the result of the plugin’s execution in a specially allocated area of memory on the heap.</li><li id="82c8" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk">The server retrieves the results of plugin execution and sends them on to the client.</li><li id="0405" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk">The client application displays the plugin results.</li></ol><p id="220c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">A full list of plugins (32-bit and 64-bit DLLs) in the <code class="cx pb pc pd pe b">plugins</code> directory.</p><ul class=""><li id="2a69" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">CommandLine32.dll</li><li id="abd8" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">CommandLine64.dll</li><li id="4e05" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Executer32.dll</li><li id="96ef" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Executer64.dll</li><li id="4ab3" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Grabber32.dll</li><li id="89e7" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Grabber64.dll</li><li id="339a" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Info32.dll</li><li id="51d4" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Info64.dll</li><li id="c440" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Jumper32.dll</li><li id="c210" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Jumper64.dll</li><li id="03fd" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">ListProcess32.dll</li><li id="0cdc" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">ListProcess64.dll</li><li id="5a7b" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">mimikatz32.dll</li><li id="b923" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">mimikatz64.dll</li><li id="11e0" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">NetSession32.dll</li><li id="fe02" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">NetSession64.dll</li><li id="5bf7" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">rat32.dll</li><li id="b198" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">rat64.dll</li><li id="36d4" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Screenshot32.dll</li><li id="a9fd" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">Screenshot64.dll</li></ul><h1 id="c841" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">CommandLine32.dll/CommandLine64.dll</h1><p id="f70a" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is designed to give attackers access to the command line interface on an infected system.</p><p id="d045" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Sending commands to the <code class="cx pb pc pd pe b">cmd.exe</code> process and receiving the result of the commands is implemented via pipes (Fig. 18).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CIVupXgwqHX15sDUFgAo2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CIVupXgwqHX15sDUFgAo2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CIVupXgwqHX15sDUFgAo2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CIVupXgwqHX15sDUFgAo2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CIVupXgwqHX15sDUFgAo2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CIVupXgwqHX15sDUFgAo2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CIVupXgwqHX15sDUFgAo2Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*CIVupXgwqHX15sDUFgAo2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CIVupXgwqHX15sDUFgAo2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CIVupXgwqHX15sDUFgAo2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CIVupXgwqHX15sDUFgAo2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CIVupXgwqHX15sDUFgAo2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CIVupXgwqHX15sDUFgAo2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CIVupXgwqHX15sDUFgAo2Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="693" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 18. </em><code class="cx pb pc pd pe b"><em class="pa">CommandLine32.dll</em></code><em class="pa">/</em><code class="cx pb pc pd pe b"><em class="pa">CommandLine64.dll</em></code><em class="pa"> main function pseudocode</em></figcaption></figure><h1 id="a77b" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Executer32.dll/Executer64.dll</h1><p id="3b01" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk"><code class="cx pb pc pd pe b">Executer32.dll</code>/<code class="cx pb pc pd pe b">Executer64.dll</code> launches additional components specified in the Lizar client application interface.</p><p id="5c35" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The plugin can run the following components:</p><ul class=""><li id="fefa" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">EXE file from the <code class="cx pb pc pd pe b">%TEMP%</code> directory;</li><li id="aa77" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">PowerShell script from the <code class="cx pb pc pd pe b">%TEMP%</code> directory, which is run using the following command: <code class="cx pb pc pd pe b">{path to powershell.exe} -ex bypass -noprof -nolog -nonint -f {path to the PowerShell script}</code>;</li><li id="d6c6" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">DLL in memory;</li><li id="6daa" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">shellcode.</li></ul><p id="5b24" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The plugin code that runs shellcode is shown in Fig. 19.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yOI1gsqAu5_UFtf6ggQJJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yOI1gsqAu5_UFtf6ggQJJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yOI1gsqAu5_UFtf6ggQJJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yOI1gsqAu5_UFtf6ggQJJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yOI1gsqAu5_UFtf6ggQJJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yOI1gsqAu5_UFtf6ggQJJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1324/format:webp/1*yOI1gsqAu5_UFtf6ggQJJQ.png 1324w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 662px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*yOI1gsqAu5_UFtf6ggQJJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yOI1gsqAu5_UFtf6ggQJJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yOI1gsqAu5_UFtf6ggQJJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yOI1gsqAu5_UFtf6ggQJJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yOI1gsqAu5_UFtf6ggQJJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yOI1gsqAu5_UFtf6ggQJJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1324/1*yOI1gsqAu5_UFtf6ggQJJQ.png 1324w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 662px"/><img alt="" class="bh ln ov c" width="662" height="255" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 19. </em><code class="cx pb pc pd pe b"><em class="pa">Executer32.dll</em></code><em class="pa">/</em><code class="cx pb pc pd pe b"><em class="pa">Executer64.dll</em></code><em class="pa"> code running shellcode</em></figcaption></figure><p id="08b8" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Note that the plugin file <code class="cx pb pc pd pe b">Executer64.dll</code> contains the path to the PDB: <code class="cx pb pc pd pe b">M:\paal\Lizar\bin\Release\Plugins\Executer64.pdb</code>.</p><h1 id="68b4" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Grabber32.dll/Grabber64.dll</h1><p id="bb1b" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">Contrary to its name, this plugin has no grabber functionality and is a typical PE loader.</p><p id="34cb" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Although attackers call it a grabber, the loaded PE file actually performs the functions of other types of tools, such as a stealer.</p><p id="880c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Both versions of the plugin are used as client-side grabber loaders: <code class="cx pb pc pd pe b">PswRdInfo64</code> and <code class="cx pb pc pd pe b">PswInfoGrabber64</code>.</p><h1 id="d014" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Info32.dll/Info64.dll</h1><p id="d0cb" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is designed to retrieve information about the infected system.</p><p id="8eb0" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The plugin is executed by using the <code class="cx pb pc pd pe b">Info</code> command in the Lizar client application. A data structure containing the OS version, user name and computer name is sent to the server.</p><p id="422c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">On the server side, the received structure is converted to a special string (Fig. 20).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Fck0G-AvxJ4XT05Kz2YIag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Fck0G-AvxJ4XT05Kz2YIag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Fck0G-AvxJ4XT05Kz2YIag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Fck0G-AvxJ4XT05Kz2YIag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Fck0G-AvxJ4XT05Kz2YIag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Fck0G-AvxJ4XT05Kz2YIag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fck0G-AvxJ4XT05Kz2YIag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Fck0G-AvxJ4XT05Kz2YIag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Fck0G-AvxJ4XT05Kz2YIag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Fck0G-AvxJ4XT05Kz2YIag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Fck0G-AvxJ4XT05Kz2YIag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Fck0G-AvxJ4XT05Kz2YIag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Fck0G-AvxJ4XT05Kz2YIag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Fck0G-AvxJ4XT05Kz2YIag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="159" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 20. Pseudocode snippet responsible for conversion of the received structure into a special string on the server</em></figcaption></figure><h1 id="02db" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Jumper32.dll/Jumper64.dll</h1><p id="4ae8" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is designed to migrate the loader to the address space of another process. Injection parameters are set in the Lizar client configuration file. It should be noted that this plugin can be used not only to inject the loader, but also to execute other PE files in the address space of the specified process.</p><p id="77e1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Figure 21 shows the main function of the plugin.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bpstNGfQaobaq4lXcTavrw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bpstNGfQaobaq4lXcTavrw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bpstNGfQaobaq4lXcTavrw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bpstNGfQaobaq4lXcTavrw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bpstNGfQaobaq4lXcTavrw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bpstNGfQaobaq4lXcTavrw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bpstNGfQaobaq4lXcTavrw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*bpstNGfQaobaq4lXcTavrw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bpstNGfQaobaq4lXcTavrw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bpstNGfQaobaq4lXcTavrw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bpstNGfQaobaq4lXcTavrw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bpstNGfQaobaq4lXcTavrw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bpstNGfQaobaq4lXcTavrw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bpstNGfQaobaq4lXcTavrw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="673" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 21. </em><code class="cx pb pc pd pe b"><em class="pa">Jumper32.dll</em></code><em class="pa">/</em><code class="cx pb pc pd pe b"><em class="pa">Jumper64.dll</em></code><em class="pa"> main function pseudocode</em></figcaption></figure><p id="4d47" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">From the pseudocode above we see that the loader can migrate to the address space of the specified process in three ways:</p><ul class=""><li id="9ce5" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">by performing an injection into the process with a certain PID;</li><li id="1dcb" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">by creating a process with a certain name and performing an injection into it;</li><li id="8b87" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">by creating a process with the same name as the current one and performing an injection into it.</li></ul><p id="6cc5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Let’s take a closer look at each method.</p><p id="af19" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><em class="qu">Algorithm for injection by process ID</em></p><ol class=""><li id="9b0a" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qp pp pq bk"><code class="cx pb pc pd pe b">OpenProcess</code> — The plugin retrieves the process handle for the specified process identifier (<code class="cx pb pc pd pe b">PID</code>).</li><li id="8276" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk"><code class="cx pb pc pd pe b">VirtualAllocEx</code> + <code class="cx pb pc pd pe b">WriteProcessMemory</code> — the plugin allocates memory in the virtual address space of the specified process and writes in it the contents to be executed afterwards.</li><li id="5536" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk"><code class="cx pb pc pd pe b">CreateRemoteThread</code> — the plugin creates a thread in the virtual address space of the specified process, with the lpStartAddress serving as the main function of the loader.</li></ol><p id="4b57" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If <code class="cx pb pc pd pe b">CreateRemoteThread</code> fails, plugin uses the <code class="cx pb pc pd pe b">RtlCreateUserThread</code> function (Fig. 22).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*x-a2tMDEgG-8BDNN1pum7g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*x-a2tMDEgG-8BDNN1pum7g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*x-a2tMDEgG-8BDNN1pum7g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*x-a2tMDEgG-8BDNN1pum7g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*x-a2tMDEgG-8BDNN1pum7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*x-a2tMDEgG-8BDNN1pum7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x-a2tMDEgG-8BDNN1pum7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*x-a2tMDEgG-8BDNN1pum7g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*x-a2tMDEgG-8BDNN1pum7g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*x-a2tMDEgG-8BDNN1pum7g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*x-a2tMDEgG-8BDNN1pum7g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*x-a2tMDEgG-8BDNN1pum7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*x-a2tMDEgG-8BDNN1pum7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*x-a2tMDEgG-8BDNN1pum7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="311" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 22. Pseudocode for a function to create a thread in the virtual address space of the specified process</em></figcaption></figure><p id="0a94" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><em class="qu">Injection algorithm by executable file name</em></p><p id="da0f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">1. The plugin finds the path to the system executable file to be injected. The location of this file depends on the bitness of the loader. 64-bit file is located in <code class="cx pb pc pd pe b">%SYSTEMROOT%\System32</code> directory, 32-bit — in <code class="cx pb pc pd pe b">%SYSTEMROOT%\SysWOW64</code> directory.</p><p id="133f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">2. The plugin creates a process for the received system executable, and receives the identifier of the created process.</p><p id="f5ed" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Depending on the plugin parameters, there are two ways to implement this step:</p><ul class=""><li id="114f" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">If the appropriate flag is set in the structure passed to the plugin, the plugin creates a process in the security context of the <code class="cx pb pc pd pe b">explorer.exe</code> process (Fig. 23).</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bDJVLjA45Sa6drXltFlYvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bDJVLjA45Sa6drXltFlYvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bDJVLjA45Sa6drXltFlYvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bDJVLjA45Sa6drXltFlYvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bDJVLjA45Sa6drXltFlYvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bDJVLjA45Sa6drXltFlYvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bDJVLjA45Sa6drXltFlYvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*bDJVLjA45Sa6drXltFlYvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bDJVLjA45Sa6drXltFlYvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bDJVLjA45Sa6drXltFlYvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bDJVLjA45Sa6drXltFlYvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bDJVLjA45Sa6drXltFlYvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bDJVLjA45Sa6drXltFlYvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bDJVLjA45Sa6drXltFlYvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="804" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 23. Running an executable in the security context of </em><code class="cx pb pc pd pe b"><em class="pa">explorer.exe</em></code></figcaption></figure><ul class=""><li id="3197" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">If the flag is not set, the executable file is started by calling the <code class="cx pb pc pd pe b">CreateProcessA</code> function (Fig. 24).</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YqcNmeKbabTBqxf0icIxVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YqcNmeKbabTBqxf0icIxVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YqcNmeKbabTBqxf0icIxVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YqcNmeKbabTBqxf0icIxVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YqcNmeKbabTBqxf0icIxVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YqcNmeKbabTBqxf0icIxVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqcNmeKbabTBqxf0icIxVQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YqcNmeKbabTBqxf0icIxVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YqcNmeKbabTBqxf0icIxVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YqcNmeKbabTBqxf0icIxVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YqcNmeKbabTBqxf0icIxVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YqcNmeKbabTBqxf0icIxVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YqcNmeKbabTBqxf0icIxVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YqcNmeKbabTBqxf0icIxVQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="190" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 24. Calling </em><code class="cx pb pc pd pe b"><em class="pa">CreateProcessA</em></code><em class="pa"> process</em></figcaption></figure><p id="e538" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">3. The plugin allocates memory in the virtual address space of the created process and writes in it the contents, which are to be executed later (<code class="cx pb pc pd pe b">VirtualAllocEx + WriteProcessMemory</code>).</p><p id="03a2" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">4. The plugin runs functions in the virtual address space of the created process in one of the following ways, depending on the bitness of the process:</p><ul class=""><li id="7b65" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">in case of the 64-bit process, a function is started with another function, shown in Fig. 25;</li></ul><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-VAS8KOmK6eZai-ageo1uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-VAS8KOmK6eZai-ageo1uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-VAS8KOmK6eZai-ageo1uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-VAS8KOmK6eZai-ageo1uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-VAS8KOmK6eZai-ageo1uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-VAS8KOmK6eZai-ageo1uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-VAS8KOmK6eZai-ageo1uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-VAS8KOmK6eZai-ageo1uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-VAS8KOmK6eZai-ageo1uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-VAS8KOmK6eZai-ageo1uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-VAS8KOmK6eZai-ageo1uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-VAS8KOmK6eZai-ageo1uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-VAS8KOmK6eZai-ageo1uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-VAS8KOmK6eZai-ageo1uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="434" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 25. Pseudocode of the algorithm for injecting into a 64-bit process</em></figcaption></figure><ul class=""><li id="fb5f" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">in case of the 32-bit process, a function is started using the <code class="cx pb pc pd pe b">CreateRemoteThread</code> and <code class="cx pb pc pd pe b">RtlCreateUserThread</code> functions, which create a thread in the virtual address space of the specified process.</li></ul><p id="e44c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><em class="qu">Algorithm for injection into the same-name process</em></p><ol class=""><li id="1b38" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qp pp pq bk">The plugin retrieves the path to the executable file for the process in the address space of which it is running.</li><li id="00ef" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd qp pp pq bk">The plugin launches this executable file and injects it into the created process.</li></ol><p id="5384" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The pseudocode for this method is shown in Fig. 26.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*n4NAcE5VDoVy1d8ZA0poTg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*n4NAcE5VDoVy1d8ZA0poTg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*n4NAcE5VDoVy1d8ZA0poTg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*n4NAcE5VDoVy1d8ZA0poTg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*n4NAcE5VDoVy1d8ZA0poTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*n4NAcE5VDoVy1d8ZA0poTg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n4NAcE5VDoVy1d8ZA0poTg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*n4NAcE5VDoVy1d8ZA0poTg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*n4NAcE5VDoVy1d8ZA0poTg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*n4NAcE5VDoVy1d8ZA0poTg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*n4NAcE5VDoVy1d8ZA0poTg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*n4NAcE5VDoVy1d8ZA0poTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*n4NAcE5VDoVy1d8ZA0poTg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*n4NAcE5VDoVy1d8ZA0poTg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="476" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 26. Pseudocode for injecting </em><code class="cx pb pc pd pe b"><em class="pa">Jumper32.dll</em></code><em class="pa">/</em><code class="cx pb pc pd pe b"><em class="pa">Jumper64.dll</em></code><em class="pa"> into the same process</em></figcaption></figure><h1 id="c093" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">ListProcesses32.dll/ListProcesses64.dll</h1><p id="5e7f" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">This plugin is designed to provide information on running processes (Fig. 27 and 28).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qelm_2R91gCC9eKHdANqyg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qelm_2R91gCC9eKHdANqyg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qelm_2R91gCC9eKHdANqyg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qelm_2R91gCC9eKHdANqyg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qelm_2R91gCC9eKHdANqyg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qelm_2R91gCC9eKHdANqyg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qelm_2R91gCC9eKHdANqyg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qelm_2R91gCC9eKHdANqyg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qelm_2R91gCC9eKHdANqyg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qelm_2R91gCC9eKHdANqyg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qelm_2R91gCC9eKHdANqyg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qelm_2R91gCC9eKHdANqyg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qelm_2R91gCC9eKHdANqyg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qelm_2R91gCC9eKHdANqyg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="590" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 27. Retrieving information about each active process</em></figcaption></figure><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj ra"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*twt9fQiqsEA9rpQ0yquucg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*twt9fQiqsEA9rpQ0yquucg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*twt9fQiqsEA9rpQ0yquucg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*twt9fQiqsEA9rpQ0yquucg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*twt9fQiqsEA9rpQ0yquucg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*twt9fQiqsEA9rpQ0yquucg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*twt9fQiqsEA9rpQ0yquucg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*twt9fQiqsEA9rpQ0yquucg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*twt9fQiqsEA9rpQ0yquucg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*twt9fQiqsEA9rpQ0yquucg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*twt9fQiqsEA9rpQ0yquucg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*twt9fQiqsEA9rpQ0yquucg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*twt9fQiqsEA9rpQ0yquucg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*twt9fQiqsEA9rpQ0yquucg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="366" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 28. Inserting the retrieved information to be sent to the server at a later time</em></figcaption></figure><p id="82bb" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The following can be retrieved for each process:</p><ul class=""><li id="431c" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">process identifier;</li><li id="0ed3" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">path to the executable file;</li><li id="155d" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">information about the user running the process.</li></ul><h1 id="1720" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">mimikatz32.dll/mimikatz64.dll</h1><p id="74e7" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The Mimikatz plugin is a wrapper for client-side Powerkatz modules:</p><ul class=""><li id="7bf6" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">powerkatz_full32.dll</code></li><li id="0c4d" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">powerkatz_full64.dll</code></li><li id="4488" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">powerkatz_short32.dll</code></li><li id="c2ff" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">powerkatz_short64.dll</code></li></ul><h1 id="56ad" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">NetSession32.dll/NetSession64.dll</h1><p id="3de9" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is designed to retrieve information about all active network sessions on the infected server. For each session, the host address from which the connection is made can be retrieved, along with the name of the user initiating the connection.</p><p id="dbed" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The pseudocode of the function in which the information is received is shown in Fig. 29 and 30.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*N0QQ19OVEqdBXPL6Se3czQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*N0QQ19OVEqdBXPL6Se3czQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*N0QQ19OVEqdBXPL6Se3czQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*N0QQ19OVEqdBXPL6Se3czQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*N0QQ19OVEqdBXPL6Se3czQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*N0QQ19OVEqdBXPL6Se3czQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0QQ19OVEqdBXPL6Se3czQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*N0QQ19OVEqdBXPL6Se3czQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*N0QQ19OVEqdBXPL6Se3czQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*N0QQ19OVEqdBXPL6Se3czQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*N0QQ19OVEqdBXPL6Se3czQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*N0QQ19OVEqdBXPL6Se3czQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*N0QQ19OVEqdBXPL6Se3czQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*N0QQ19OVEqdBXPL6Se3czQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="465" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 29. Retrieving network session information using WinAPI functions</em></figcaption></figure><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj rc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MSevbIFkfN0zufddjTXZFg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MSevbIFkfN0zufddjTXZFg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MSevbIFkfN0zufddjTXZFg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MSevbIFkfN0zufddjTXZFg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MSevbIFkfN0zufddjTXZFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MSevbIFkfN0zufddjTXZFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MSevbIFkfN0zufddjTXZFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MSevbIFkfN0zufddjTXZFg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MSevbIFkfN0zufddjTXZFg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MSevbIFkfN0zufddjTXZFg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MSevbIFkfN0zufddjTXZFg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MSevbIFkfN0zufddjTXZFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MSevbIFkfN0zufddjTXZFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MSevbIFkfN0zufddjTXZFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="621" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 30. Inserting the information retrieved by the plugin to be sent to the server</em></figcaption></figure><h1 id="0497" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">rat32.dll/rat64.dll</h1><p id="48d9" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is a simplified version of the Carbanak toolkit bot. As we reported at the beginning of this article, this toolkit is heavily used by the FIN7 faction.</p><h1 id="d324" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Screenshot32.dll/Screenshot64.dll</h1><p id="1bab" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin can take a JPEG screenshot on the infected system. The part of the function used to save the resulting image to the stream is shown below (Fig. 31).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div class="oi oj rd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BfZNVClYD4bLIHJHM_kLOg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BfZNVClYD4bLIHJHM_kLOg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BfZNVClYD4bLIHJHM_kLOg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BfZNVClYD4bLIHJHM_kLOg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BfZNVClYD4bLIHJHM_kLOg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BfZNVClYD4bLIHJHM_kLOg.png 1100w, https://miro.medium.com/v2/resize:fit:1236/format:webp/1*BfZNVClYD4bLIHJHM_kLOg.png 1236w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 618px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BfZNVClYD4bLIHJHM_kLOg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BfZNVClYD4bLIHJHM_kLOg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BfZNVClYD4bLIHJHM_kLOg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BfZNVClYD4bLIHJHM_kLOg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BfZNVClYD4bLIHJHM_kLOg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BfZNVClYD4bLIHJHM_kLOg.png 1100w, https://miro.medium.com/v2/resize:fit:1236/1*BfZNVClYD4bLIHJHM_kLOg.png 1236w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 618px"/><img alt="" class="bh ln ov c" width="618" height="560" loading="lazy" role="presentation"/></picture></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 31. The part of the function used to save a screenshot taken by the plugin to the stream</em></figcaption></figure><p id="ffc5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The received stream is then sent to the loader to be sent to the server.</p><h1 id="b4d6" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">plugins from the <code class="cx pb pc pd pe b">plugins/extra</code> directory</h1><p id="386f" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">plugins from the <code class="cx pb pc pd pe b">plugins/extra</code> directory are transferred from the client to the server, then from the server to the loader (on the infected system).</p><p id="e96f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">List of files in the <code class="cx pb pc pd pe b">plugins/extra</code> directory:</p><ul class=""><li id="9ce0" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">ADRecon.ps1</li><li id="2e13" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">GetHash32.dll</li><li id="c8f7" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">GetHash64.dll</li><li id="79ee" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">GetPass32.dll</li><li id="7f35" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">GetPass64.dll</li><li id="0808" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">powerkatz_full32.dll</li><li id="6147" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">powerkatz_full64.dll</li><li id="23e9" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">powerkatz_short32.dll</li><li id="be48" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">powerkatz_short64.dll</li><li id="6bfb" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">PswInfoGrabber32.dll</li><li id="3465" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">PswInfoGrabber64.dll</li><li id="602a" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">PswRdInfo64.dll</li></ul><h1 id="444a" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">ADRecon</h1><p id="b1c5" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The <code class="cx pb pc pd pe b">ADRecon.ps1</code> file is a tool for generating reports that contain information from Active Directory. Read more about <a class="af oh" href="https://github.com/sense-of-security/ADRecon" rel="noopener ugc nofollow" target="_blank">ADRecon project on GitHub</a>. Note that this plugin is not developed by FIN7, however, it is actively used by the group in its attacks.</p><h1 id="d810" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">GetHash32/GetHash64</h1><p id="a7db" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is designed to retrieve user NTLM/LM hashes. The plugin is based on the code of the <code class="cx pb pc pd pe b"><a class="af oh" href="https://github.com/gentilkiwi/mimikatz/blob/master/mimikatz/modules/kuhl_m_lsadump.c" rel="noopener ugc nofollow" target="_blank">lsadump</a></code> component from Mimikatz.</p><p id="d711" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Fig. 32 shows a screenshot with pseudocode of exported <code class="cx pb pc pd pe b">Entry</code> function (function names are chosen according to Mimikatz function names).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj re"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8t396KNdkHPH7ALqbKt6Xw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8t396KNdkHPH7ALqbKt6Xw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8t396KNdkHPH7ALqbKt6Xw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8t396KNdkHPH7ALqbKt6Xw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8t396KNdkHPH7ALqbKt6Xw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8t396KNdkHPH7ALqbKt6Xw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8t396KNdkHPH7ALqbKt6Xw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8t396KNdkHPH7ALqbKt6Xw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8t396KNdkHPH7ALqbKt6Xw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8t396KNdkHPH7ALqbKt6Xw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8t396KNdkHPH7ALqbKt6Xw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8t396KNdkHPH7ALqbKt6Xw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8t396KNdkHPH7ALqbKt6Xw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8t396KNdkHPH7ALqbKt6Xw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="504" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 32. Pseudocode of the exported </em><code class="cx pb pc pd pe b"><em class="pa">Entry</em></code><em class="pa"> function for the GetHash plugin</em></figcaption></figure><p id="4c1d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The return value of the <code class="cx pb pc pd pe b">Execute</code> function (value of the <code class="cx pb pc pd pe b">g_outputBuffer</code> variable) contains a pointer to the buffer with data resulting from the plugin&#x27;s operation.</p><p id="0440" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If the plugin fails to start with <code class="cx pb pc pd pe b">SYSTEM</code> permissions, it will fill the buffer with the data shown in Fig. 33.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj ch"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XmyS2gbxR5F3ARbad762MA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XmyS2gbxR5F3ARbad762MA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XmyS2gbxR5F3ARbad762MA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XmyS2gbxR5F3ARbad762MA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XmyS2gbxR5F3ARbad762MA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XmyS2gbxR5F3ARbad762MA.png 1100w, https://miro.medium.com/v2/resize:fit:1360/format:webp/1*XmyS2gbxR5F3ARbad762MA.png 1360w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 680px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XmyS2gbxR5F3ARbad762MA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XmyS2gbxR5F3ARbad762MA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XmyS2gbxR5F3ARbad762MA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XmyS2gbxR5F3ARbad762MA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XmyS2gbxR5F3ARbad762MA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XmyS2gbxR5F3ARbad762MA.png 1100w, https://miro.medium.com/v2/resize:fit:1360/1*XmyS2gbxR5F3ARbad762MA.png 1360w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 680px"/><img alt="" class="bh ln ov c" width="680" height="110" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 33. Buffer contents when running the plugin without </em><code class="cx pb pc pd pe b"><em class="pa">SYSTEM</em></code><em class="pa"> permissions</em></figcaption></figure><p id="79fa" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The contents of the buffer in this case are similar to the output of mimikatz when running the module <code class="cx pb pc pd pe b">lsadump::sam</code> without <code class="cx pb pc pd pe b">SYSTEM</code> permissions (Fig. 34).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj rf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kKX1AlZxmX2BKf0CckxSxA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kKX1AlZxmX2BKf0CckxSxA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kKX1AlZxmX2BKf0CckxSxA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kKX1AlZxmX2BKf0CckxSxA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kKX1AlZxmX2BKf0CckxSxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kKX1AlZxmX2BKf0CckxSxA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKX1AlZxmX2BKf0CckxSxA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*kKX1AlZxmX2BKf0CckxSxA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kKX1AlZxmX2BKf0CckxSxA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kKX1AlZxmX2BKf0CckxSxA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kKX1AlZxmX2BKf0CckxSxA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kKX1AlZxmX2BKf0CckxSxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kKX1AlZxmX2BKf0CckxSxA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kKX1AlZxmX2BKf0CckxSxA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="178" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 34. Mimikatz output when running </em><code class="cx pb pc pd pe b"><em class="pa">lsadump::sam</em></code><em class="pa"> without </em><code class="cx pb pc pd pe b"><em class="pa">SYSTEM</em></code><em class="pa"> permissions</em></figcaption></figure><p id="fcf5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If the plugin is run with <code class="cx pb pc pd pe b">SYSTEM</code> permissions, it will put all the information the attacker is looking for into the buffer (Fig. 35).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div class="oi oj rg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1368/format:webp/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 1368w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 684px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1368/1*0HHo0Hr4vgy2KUWTEwh6_Q.png 1368w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 684px"/><img alt="" class="bh ln ov c" width="684" height="392" loading="lazy" role="presentation"/></picture></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 35. Buffer contents when running the plugin with </em><code class="cx pb pc pd pe b"><em class="pa">SYSTEM</em></code><em class="pa"> permissions</em></figcaption></figure><p id="ded3" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The same data can be retrieved by running <code class="cx pb pc pd pe b">lsadump::sam</code> from mimikatz with <code class="cx pb pc pd pe b">SYSTEM </code>permissions (Fig. 36).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj qz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*92Zvzj8bXGp4QKLhmKuyTw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*92Zvzj8bXGp4QKLhmKuyTw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*92Zvzj8bXGp4QKLhmKuyTw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*92Zvzj8bXGp4QKLhmKuyTw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*92Zvzj8bXGp4QKLhmKuyTw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*92Zvzj8bXGp4QKLhmKuyTw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92Zvzj8bXGp4QKLhmKuyTw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*92Zvzj8bXGp4QKLhmKuyTw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*92Zvzj8bXGp4QKLhmKuyTw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*92Zvzj8bXGp4QKLhmKuyTw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*92Zvzj8bXGp4QKLhmKuyTw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*92Zvzj8bXGp4QKLhmKuyTw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*92Zvzj8bXGp4QKLhmKuyTw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*92Zvzj8bXGp4QKLhmKuyTw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="391" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 36. Result of </em><code class="cx pb pc pd pe b"><em class="pa">lsadump::sam</em></code><em class="pa"> command from mimikatz with </em><code class="cx pb pc pd pe b"><em class="pa">SYSTEM </em></code><em class="pa">permissions</em></figcaption></figure><h1 id="65b7" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">GetPass32/GetPass64</h1><p id="3922" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is designed to retrieve user passwords. It is based on the code of the <code class="cx pb pc pd pe b"><a class="af oh" href="https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa" rel="noopener ugc nofollow" target="_blank">sekurlsa</a></code> component from Mimikatz. The pseudocode of the exported <code class="cx pb pc pd pe b">Entry</code> function is shown in Fig. 37.</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj rh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kP8KKCN68VTJWDAFHWfGrQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kP8KKCN68VTJWDAFHWfGrQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kP8KKCN68VTJWDAFHWfGrQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kP8KKCN68VTJWDAFHWfGrQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kP8KKCN68VTJWDAFHWfGrQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kP8KKCN68VTJWDAFHWfGrQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kP8KKCN68VTJWDAFHWfGrQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*kP8KKCN68VTJWDAFHWfGrQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kP8KKCN68VTJWDAFHWfGrQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kP8KKCN68VTJWDAFHWfGrQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kP8KKCN68VTJWDAFHWfGrQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kP8KKCN68VTJWDAFHWfGrQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kP8KKCN68VTJWDAFHWfGrQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kP8KKCN68VTJWDAFHWfGrQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="362" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 37. Exportable </em><code class="cx pb pc pd pe b"><em class="pa">Entry</em></code><em class="pa"> function pseudocode</em></figcaption></figure><p id="c51c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Based on the plugin’s results, we will see in the value of the <code class="cx pb pc pd pe b">g_outputBuffer</code> variable a pointer to the data buffer that can be retrieved by executing the <code class="cx pb pc pd pe b">sekurlsa::logonpasswords</code> command in Mimikatz (Fig. 38).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div class="oi oj ri"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xQH6eqG7yN8aBn77-IipTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xQH6eqG7yN8aBn77-IipTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xQH6eqG7yN8aBn77-IipTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xQH6eqG7yN8aBn77-IipTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xQH6eqG7yN8aBn77-IipTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xQH6eqG7yN8aBn77-IipTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1390/format:webp/1*xQH6eqG7yN8aBn77-IipTQ.png 1390w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 695px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*xQH6eqG7yN8aBn77-IipTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xQH6eqG7yN8aBn77-IipTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xQH6eqG7yN8aBn77-IipTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xQH6eqG7yN8aBn77-IipTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xQH6eqG7yN8aBn77-IipTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xQH6eqG7yN8aBn77-IipTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1390/1*xQH6eqG7yN8aBn77-IipTQ.png 1390w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 695px"/><img alt="" class="bh ln ov c" width="695" height="527" loading="lazy" role="presentation"/></picture></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 38. Result of the </em><code class="cx pb pc pd pe b"><em class="pa">sekurlsa::logonpasswords</em></code><em class="pa"> command</em></figcaption></figure><h1 id="ff3b" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">powerkatz_full32/powerkatz_full64</h1><p id="7af2" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin is a Mimikatz version compiled in the <a class="af oh" href="https://github.com/gentilkiwi/mimikatz/blob/master/mimikatz.sln#L95" rel="noopener ugc nofollow" target="_blank">Second_Release_PowerShell</a> configuration. This version can be loaded into the address space of a PowerShell process via reflective DLL loading as implemented in the <code class="cx pb pc pd pe b">Exfiltration</code> module of <a class="af oh" href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-Mimikatz.ps1" rel="noopener ugc nofollow" target="_blank">PowerSploit</a>.</p><p id="e9ec" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Pseudocode of the exported <code class="cx pb pc pd pe b">powershell_reflective_mimikatz</code> function (variable and function names in the decompiled output are changed to match the names of the corresponding variables and functions from Mimikatz):</p><figure class="ol om on oo op oq"><div class="pw px l fj"><div class="py pz l"></div></div></figure><p id="588d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The <code class="cx pb pc pd pe b">input</code> parameter is used to pass a list of commands, separated by a space. The global variable <code class="cx pb pc pd pe b">outputBuffer</code> is used to pass the result of the commands. The decompiled view of the <code class="cx pb pc pd pe b">wmain</code> function is shown below:</p><figure class="ol om on oo op oq"><div class="pw px l fj"><div class="py pz l"></div></div></figure><h1 id="970d" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">powerkatz_short32/powerkatz_short64</h1><p id="02e6" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The <code class="cx pb pc pd pe b">powerkatz_short</code> plugin is a modified version of the standard <code class="cx pb pc pd pe b">powerkatz</code> library described in the previous paragraph.</p><p id="2502" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">A list of <code class="cx pb pc pd pe b">powerkatz</code> functions that are absent from <code class="cx pb pc pd pe b">powerkatz_short</code>:</p><ul class=""><li id="33d3" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_acr_clean</code>;</li><li id="b3c0" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_busylight_clean</code>;</li><li id="1b19" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_c_rpc_clean</code>;</li><li id="b91d" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_c_rpc_init</code>;</li><li id="578d" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_c_service_clean</code>;</li><li id="6439" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_crypto_clean</code>;</li><li id="6049" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_crypto_init</code>;</li><li id="7a55" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_kerberos_clean</code>;</li><li id="5cf1" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_kerberos_init</code>;</li><li id="9a96" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_vault_clean</code>;</li><li id="2258" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kuhl_m_vault_init</code>;</li><li id="3b21" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kull_m_busylight_devices_get</code>;</li><li id="3005" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk"><code class="cx pb pc pd pe b">kull_m_busylight_keepAliveThread</code>.</li></ul><h1 id="1bd6" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">PswInfoGrabber32.dll/PswInfoGrabber64.dll</h1><p id="04ba" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">The plugin can retrieve the following data:</p><ul class=""><li id="fabf" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd po pp pq bk">browser history from Firefox, Google Chrome, Microsoft Edge and Internet Explorer;</li><li id="aff8" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">usernames and passwords stored in the listed browsers;</li><li id="b630" class="mg mh gu mi b mj pr ml mm mn ps mp mq mr pt mt mu mv pu mx my mz pv nb nc nd po pp pq bk">email accounts from Microsoft Outlook and Mozilla Thunderbird.</li></ul><p id="008e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The <code class="cx pb pc pd pe b">nss3.dll</code> library is used to retrieve sensitive data from the Firefox browser and is loaded from the directory with the installed browser (Fig. 39).</p><figure class="ol om on oo op oq oi oj paragraph-image"><div role="button" tabindex="0" class="or os fj ot bh ou"><div class="oi oj rj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WPdG6iifPFCad9Ap8Dgk5w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WPdG6iifPFCad9Ap8Dgk5w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WPdG6iifPFCad9Ap8Dgk5w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WPdG6iifPFCad9Ap8Dgk5w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WPdG6iifPFCad9Ap8Dgk5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WPdG6iifPFCad9Ap8Dgk5w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WPdG6iifPFCad9Ap8Dgk5w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*WPdG6iifPFCad9Ap8Dgk5w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WPdG6iifPFCad9Ap8Dgk5w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WPdG6iifPFCad9Ap8Dgk5w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WPdG6iifPFCad9Ap8Dgk5w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WPdG6iifPFCad9Ap8Dgk5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WPdG6iifPFCad9Ap8Dgk5w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WPdG6iifPFCad9Ap8Dgk5w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln ov c" width="700" height="377" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ow ff ox oi oj oy oz bf b bg z du"><em class="pa">Figure 39. Dynamic retrieval of function addresses from </em><code class="cx pb pc pd pe b"><em class="pa">nss3.dll</em></code><em class="pa"> library</em></figcaption></figure><p id="425f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Using the functions shown in Fig. 38, the credentials are retrieved from the <code class="cx pb pc pd pe b">logins.json</code> file and the browser history is retrieved from the <code class="cx pb pc pd pe b">places.sqlite</code> database.</p><p id="45fc" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">In relation to Google Chrome, the plugin retrieves browser history from <code class="cx pb pc pd pe b">%LOCALAPPDATA%\Google\Chrome\User Data\Default\History</code> and passwords from <code class="cx pb pc pd pe b">%LOCALAPPDATA%\Google\Chrome\User Data\Default\Login Data</code> (data encrypted using DPAPI).</p><p id="c734" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><code class="cx pb pc pd pe b">History</code>, <code class="cx pb pc pd pe b">places.sqlite</code>, <code class="cx pb pc pd pe b">Login Data</code> are all <code class="cx pb pc pd pe b">sqlite3</code> database files. To work with <code class="cx pb pc pd pe b">sqlite3</code> databases the plugin uses functions from the <code class="cx pb pc pd pe b">sqlite</code> library, statically linked with the resulting DLL, i.e. the plugin itself.</p><p id="e276" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">For Internet Explorer and Microsoft Edge browsers, the plugin retrieves user credentials using functions from the <code class="cx pb pc pd pe b">vaultcli.dll</code> library that implements the functions of the <code class="cx pb pc pd pe b">vaultcmd.exe</code> utility.</p><h1 id="d2ee" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">PswRdInfo64.dll</h1><p id="f542" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk"><code class="cx pb pc pd pe b">PswRdInfo64.dll</code> is designed primarily to collect domain credentials and retrieve credentials for accessing other hosts via RDP. The plugin is activated from the client application using the <code class="cx pb pc pd pe b">Grabber → RDP</code> tab.</p><p id="e2d1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The workflow of the plugin depends on the following conditions.</p><p id="3fc1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When started from SYSTEM, the plugin lists all active console sessions (<code class="cx pb pc pd pe b">WTSGetActiveConsoleSessionId</code>) and gets user names for these sessions:</p><pre class="ol om on oo op rk pe rl rm ay rn bk"><span id="9595" class="ro nf gu pe b ij rp rq l rr rs">(WTSQuerySessionInformationW)(0i64, SessionId, WTSUserName, &amp;vpSessionInformationUserName, &amp;pBytesReturned))</span></pre><p id="edf3" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The plugin then retrieves the private keys from the <code class="cx pb pc pd pe b">C:\Users\{SessionInformationUserName}AppData\Local\Microsoft\Credentials</code> directory for each user and injects itself into the <code class="cx pb pc pd pe b">lsass.exe</code> process to extract domain credentials.</p><p id="dddf" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When started by another user (other than <code class="cx pb pc pd pe b">SYSTEM</code>), the plugin attempts to collect credentials for RDP access to other hosts. Credentials are collected using <code class="cx pb pc pd pe b">CredEnumerateW</code> function, with the <code class="cx pb pc pd pe b">TERMSRV</code> string as the target.</p><h1 id="2663" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">Conclusion</h1><p id="162f" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">As the analysis shows, Lizar is a diverse and complex toolkit. It is currently still under active development and testing, yet it is already being widely used to control infected computers, mostly throughout the United States.</p><p id="ef4d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">However, it seems that FIN7 are not looking to stop there, and we will soon be hearing about more Lizar-enabled attacks from around the world.</p><h1 id="f22e" class="ne nf gu bf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob bk">IoC</h1><p id="d4a4" class="pw-post-body-paragraph mg mh gu mi b mj oc ml mm mn od mp mq mr oe mt mu mv of mx my mz og nb nc nd gn bk">IP:</p><pre class="ol om on oo op rk pe rl rm ay rn bk"><span id="db58" class="ro nf gu pe b ij rp rq l rr rs">108.61.148.97<br/>136.244.81.250<br/>185.33.84.43<br/>195.123.214.181<br/>31.192.108.133<br/>45.133.203.121</span></pre><p id="0d6e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">SHA256:</p><pre class="ol om on oo op rk pe rl rm ay rn bk"><span id="4883" class="ro nf gu pe b ij rp rq l rr rs">166b0c5e49c44f87886ecaad46e60b496b6b7512d1c57db41d9cf752fada95c8<br/>188d76c31fa7f500799762237508203bdd1927ec4d5232cc189d46bc76b7a30d<br/>1e5514e8f95dcf6dd7289acef6f6b88c460105660cb0c5b86ec7b854f70ee857<br/>21850bb5d8df021e850e740c1899353f40af72f119f2cd71ad234e91c2ccb772<br/>3b63eb184bea5b6515697ae3f13a57365f04e6a3309c79b18773291e62a64fcb<br/>4d933b6b60a097ad5ce5876a66c569e6f46707b934ebd3c442432711af195124<br/>515b94290111b7be80e001bfa2335d2f494937c8619cfdaafb2077d9d6af06fe<br/>61cfe83259640df9f19df2be4b67bb1c6e5816ac52b8a5a02ee8b79bde4b2b70<br/>fbd2d816147112bd408e26b1300775bbaa482342f9b33924d93fd71a5c312cce<br/>a3b3f56a61c6dc8ba2aa25bdd9bd7dc2c5a4602c2670431c5cbc59a76e2b4c54<br/>e908f99c6753a56440127e54ce990adbc5128d10edc11622d548ddd67e6662ac<br/>7d48362091d710935726ab4d32bf594b363683e8335f1ee70ae2ae81f4ee36ca<br/>e894dedb4658e006c8a85f02fa5bbab7ecd234331b92be41ab708fa22a246e25<br/>b8691a33aa99af0f0c1a86321b70437efcf358ace1cf3f91e4cb8793228d1a62<br/>bd1e5ea9556cb6cba9a509eab8442bf37ca40006c0894c5a98ce77f6d84b03c7<br/>98fbccd9c2e925d2f7b8bcfa247790a681497dfb9f7f8745c0327c43db10952f<br/>552c00bb5fd5f10b105ca247b0a78082bd6a63e2bab590040788e52634f96d11<br/>21db55edc9df9e096fc994972498cbd9da128f8f3959a462d04091634a569a96</span></pre></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rt ru ab iv"><div class="rv ab"><a class="rw ay am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><div class="rx fj cx ry ge rz sa bf b bg z bk sb">Cybersecurity</div></a></div><div class="rv ab"><a class="rw ay am ao" href="https://medium.com/tag/reverse-engineering?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><div class="rx fj cx ry ge rz sa bf b bg z bk sb">Reverse Engineering</div></a></div><div class="rv ab"><a class="rw ay am ao" href="https://medium.com/tag/fin7?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><div class="rx fj cx ry ge rz sa bf b bg z bk sb">Fin7</div></a></div><div class="rv ab"><a class="rw ay am ao" href="https://medium.com/tag/carbanak?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><div class="rx fj cx ry ge rz sa bf b bg z bk sb">Carbanak</div></a></div><div class="rv ab"><a class="rw ay am ao" href="https://medium.com/tag/malware-analysis?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><div class="rx fj cx ry ge rz sa bf b bg z bk sb">Malware Analysis</div></a></div></div></div></div><div class="l"></div><footer class="sc sd se sf sg sh si sj sk ab q sl sm c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sn"><div class="ab q ke"><div class="so l"><span class="l sp sq sr e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fc23c9a75e319&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=-----c23c9a75e319---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f ss st"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fc23c9a75e319&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=-----c23c9a75e319---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="su l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc23c9a75e319&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="su l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sv sw sx sy sz l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab ta cp"><div class="ab ia"><a rel="noopener follow" href="/?source=post_page-----c23c9a75e319--------------------------------"><div class="l tb tc by td ie"><div class="l fj"><img alt="BI.ZONE" class="l fd by te tf cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*cj9yFPo_JbHzvR2AQVUedg.png" width="72" height="72" loading="lazy"/><div class="if by l te tf fs n ig ft"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z ep rx eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F16f9550e3622&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;newsletterV3=3882bedad280&amp;newsletterV3Id=16f9550e3622&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=-----c23c9a75e319---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tj am tk rn tl tm tn to tp tq ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tg th ti"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page-----c23c9a75e319--------------------------------"><h2 class="pw-author-name bf tr ts tt tu bk"><span class="gn ix">Written by <!-- -->BI.ZONE</span></h2></a></div><div class="rv ab"><div class="l is"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page-----c23c9a75e319--------------------------------">174 Followers</a></span></div></div><div class="tv l"><p class="bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar oh go" href="http://BI.ZONE" rel="noopener  ugc nofollow">BI.ZONE</a>: an expert in digital risks management. We help organizations around the world to develop their businesses safely in the digital age</p></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ep rx eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F16f9550e3622&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319&amp;newsletterV3=3882bedad280&amp;newsletterV3Id=16f9550e3622&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=-----c23c9a75e319---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tj am tk rn tl tm tn to tp tq ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tg th ti"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tw bh tx ty tz ua ub uc"></div></div></div><div class="h k j"><div class="tw bh tx ud"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ue ab ke iv"><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uf ug l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----c23c9a75e319--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241017-182126-a0128a89d2"</script><script>window.__GRAPHQL_URI__ = "https://bi-zone.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-c23c9a75e319","user-3882bedad280"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"3882bedad280","explicit":true},"viewerIsBot":false},"debug":{"requestId":"28f9dc2a-5052-490f-bddc-93e95ce343e5","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-9fef7c9bd0d53ce96ae177d665858273-a046cfe8995c9550-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fbi-zone.medium.com\u002Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319","host":"bi-zone.medium.com","hostname":"bi-zone.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241017-182126-a0128a89d2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241017-182126-a0128a89d2","commit":"a0128a89d2d76bfa55b25492370b0bae4050224f"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"postResult({\"id\":\"c23c9a75e319\"})":{"__ref":"Post:c23c9a75e319"},"collectionByDomainOrSlug({\"domainOrSlug\":\"bi-zone.medium.com\"})":null},"LinkedAccounts:3882bedad280":{"__typename":"LinkedAccounts","mastodon":null,"id":"3882bedad280"},"UserViewerEdge:userId:3882bedad280-viewerId:lo_95eadd6cc6c1":{"__typename":"UserViewerEdge","id":"userId:3882bedad280-viewerId:lo_95eadd6cc6c1","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:16f9550e3622":{"__typename":"NewsletterV3","id":"16f9550e3622","type":"NEWSLETTER_TYPE_AUTHOR","slug":"3882bedad280","name":"3882bedad280","collection":null,"user":{"__ref":"User:3882bedad280"}},"User:3882bedad280":{"__typename":"User","id":"3882bedad280","name":"BI.ZONE","username":"bi-zone","newsletterV3":{"__ref":"NewsletterV3:16f9550e3622"},"linkedAccounts":{"__ref":"LinkedAccounts:3882bedad280"},"isSuspended":false,"imageId":"1*cj9yFPo_JbHzvR2AQVUedg.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":174},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"bi-zone.medium.com"}},"hasSubdomain":true,"bio":"BI.ZONE: an expert in digital risks management. We help organizations around the world to develop their businesses safely in the digital age","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:3882bedad280-viewerId:lo_95eadd6cc6c1"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":null,"allowNotes":true,"twitterScreenName":"bizone_en"},"Paragraph:109369475f5e_0":{"__typename":"Paragraph","id":"109369475f5e_0","name":"77a6","type":"H3","href":null,"layout":null,"metadata":null,"text":"From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s toolkit","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_1":{"__typename":"Paragraph","id":"109369475f5e_1","name":"344e","type":"P","href":null,"layout":null,"metadata":null,"text":"The article was prepared by BI.ZONE Cyber Threats Research Team","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":28,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_2":{"__typename":"Paragraph","id":"109369475f5e_2","name":"158e","type":"P","href":null,"layout":null,"metadata":null,"text":"This is not the first time we have come across a cybercriminal group that pretends to be a legitimate organisation and disguises its malware as a security analysis tool. These groups hire employees who are not even aware that they are working with real malware or that their employer is a real criminal group.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_3":{"__typename":"Paragraph","id":"109369475f5e_3","name":"4d55","type":"P","href":null,"layout":null,"metadata":null,"text":"One such group is the infamous FIN7 known for its APT attacks on various organisations around the globe. Recently they developed Lizar (formerly known as Tirion), a toolkit for reconnaissance and getting a foothold inside infected systems. Disguised as a legitimate cybersecurity company, the group distributes Lizar as a pentesting tool for Windows networks. This caught our attention and we did some research, the results of which we will share in this article.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_4":{"__typename":"Paragraph","id":"109369475f5e_4","name":"e4dd","type":"H3","href":null,"layout":null,"metadata":null,"text":"A few words about FIN7","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_5":{"__typename":"Paragraph","id":"109369475f5e_5","name":"ed96","type":"P","href":null,"layout":null,"metadata":null,"text":"The APT group FIN7 was presumably founded back in 2013, but we will focus on its activities starting from 2020: that’s when cybercriminals focused on ransomware attacks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_6":{"__typename":"Paragraph","id":"109369475f5e_6","name":"b97c","type":"P","href":null,"layout":null,"metadata":null,"text":"FIN7 compiled a list of victims by filtering companies by revenue using the Zoominfo service. In 2020–2021, we saw attacks on an IT company headquartered in Germany, a key financial institution in Panama, a gambling establishment, several educational institutions and pharmaceuticalcompanies in the US.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":76,"end":84,"href":"https:\u002F\u002Fwww.zoominfo.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_7":{"__typename":"Paragraph","id":"109369475f5e_7","name":"27b5","type":"P","href":null,"layout":null,"metadata":null,"text":"For quite some time, FIN7 members have been using the Carbanak backdoor toolkit for reconnaissance purposes and to gain a foothold on infected systems, you can read about it in the series on FireEye’s blog (posts: 1, 2, 3, 4). We repeatedly observed the attackers attempting to masquerade as Check Point Software Technology and Forcepoint.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":214,"end":215,"href":"https:\u002F\u002Fwww.fireeye.com\u002Fblog\u002Fthreat-research\u002F2019\u002F04\u002Fcarbanak-week-part-one-a-rare-occurrence.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":217,"end":218,"href":"https:\u002F\u002Fwww.fireeye.com\u002Fblog\u002Fthreat-research\u002F2019\u002F04\u002Fcarbanak-week-part-two-continuing-source-code-analysis.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":220,"end":221,"href":"https:\u002F\u002Fwww.fireeye.com\u002Fblog\u002Fthreat-research\u002F2019\u002F04\u002Fcarbanak-week-part-three-behind-the-backdoor.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":223,"end":224,"href":"https:\u002F\u002Fwww.fireeye.com\u002Fblog\u002Fthreat-research\u002F2019\u002F04\u002Fcarbanak-week-part-four-desktop-video-player.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_8":{"__typename":"Paragraph","id":"109369475f5e_8","name":"392a","type":"P","href":null,"layout":null,"metadata":null,"text":"An example of this can be seen in the interface of Carbanak backdoor version 3.7.4, referencing Check Point Software Technology (Fig. 1).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*taUQbk4kjpJNmaXX-GBdpw.png":{"__typename":"ImageMetadata","id":"1*taUQbk4kjpJNmaXX-GBdpw.png","originalHeight":735,"originalWidth":1397,"focusPercentX":null,"focusPercentY":null,"alt":"Figure 1. Carbanak backdoor version 3.7.4 interface"},"Paragraph:109369475f5e_9":{"__typename":"Paragraph","id":"109369475f5e_9","name":"9730","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*taUQbk4kjpJNmaXX-GBdpw.png"},"text":"Figure 1. Carbanak backdoor version 3.7.4 interface","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_10":{"__typename":"Paragraph","id":"109369475f5e_10","name":"c608","type":"P","href":null,"layout":null,"metadata":null,"text":"A new malware package, Lizar, was recently released by the criminals. \nA report on Lizar version 1.6.4 was previously published online, so we decided to investigate the functionality of the newer version, 2.0.4 (compile date and time: Fri Jan 29 03:27:43 2021), which we discovered in February 2021.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":235,"end":259,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":73,"end":102,"href":"https:\u002F\u002Fthreatintel.blog\u002FOPBlueRaven-Part1\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_11":{"__typename":"Paragraph","id":"109369475f5e_11","name":"206f","type":"H3","href":null,"layout":null,"metadata":null,"text":"Lizar toolkit architecture","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_12":{"__typename":"Paragraph","id":"109369475f5e_12","name":"96f5","type":"P","href":null,"layout":null,"metadata":null,"text":"The Lizar toolkit is structurally similar to Carbanak. The components we found are listed in Table 1.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NFCboxL1-gdaCGEhUR4DZw.png":{"__typename":"ImageMetadata","id":"1*NFCboxL1-gdaCGEhUR4DZw.png","originalHeight":1004,"originalWidth":3122,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_13":{"__typename":"Paragraph","id":"109369475f5e_13","name":"37cb","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NFCboxL1-gdaCGEhUR4DZw.png"},"text":"Table 1. Essence and purpose of Lizar components","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_14":{"__typename":"Paragraph","id":"109369475f5e_14","name":"29b8","type":"P","href":null,"layout":null,"metadata":null,"text":"Lizar loader and Lizar plugins run on an infected system and can logically be combined into the Lizar bot component.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_15":{"__typename":"Paragraph","id":"109369475f5e_15","name":"c189","type":"P","href":null,"layout":null,"metadata":null,"text":"Figure 2 shows how Lizar’s tools function and interact.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cvZqofoKHOl0OGdEneknQQ.jpeg":{"__typename":"ImageMetadata","id":"1*cvZqofoKHOl0OGdEneknQQ.jpeg","originalHeight":1931,"originalWidth":4270,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_16":{"__typename":"Paragraph","id":"109369475f5e_16","name":"bb17","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cvZqofoKHOl0OGdEneknQQ.jpeg"},"text":"Figure 2. Schematic of the Lizar toolkit operation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_17":{"__typename":"Paragraph","id":"109369475f5e_17","name":"e55a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Lizar client","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_18":{"__typename":"Paragraph","id":"109369475f5e_18","name":"c2ae","type":"P","href":null,"layout":null,"metadata":null,"text":"Lizar client consistes of the following components:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_19":{"__typename":"Paragraph","id":"109369475f5e_19","name":"937c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"client.ini.xml — XML configuration file;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_20":{"__typename":"Paragraph","id":"109369475f5e_20","name":"6dd6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"client.exe — client's main executable;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_21":{"__typename":"Paragraph","id":"109369475f5e_21","name":"86cc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"libwebp_x64.dll — 64-bit version of libwebp library;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":36,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":36,"end":43,"href":"https:\u002F\u002Fchromium.googlesource.com\u002Fwebm\u002Flibwebp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_22":{"__typename":"Paragraph","id":"109369475f5e_22","name":"d20b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"libwebp_x86.dll — 32-bit version of libwebp library;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":36,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":36,"end":43,"href":"https:\u002F\u002Fchromium.googlesource.com\u002Fwebm\u002Flibwebp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_23":{"__typename":"Paragraph","id":"109369475f5e_23","name":"60e2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"keys — a directory with the keys for encrypting traffic between the client and the server;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_24":{"__typename":"Paragraph","id":"109369475f5e_24","name":"c8e3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"plugins\u002Fextra — plugin directory (in practice only some plugins are present in this directory, the rest are located on the server);","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_25":{"__typename":"Paragraph","id":"109369475f5e_25","name":"0b7e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"rat — directory with the public key from Carbanak (this component has been added in the latest version of Lizar).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_26":{"__typename":"Paragraph","id":"109369475f5e_26","name":"42d3","type":"P","href":null,"layout":null,"metadata":null,"text":"Below is the content and description of the configuration file (Table 2).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:ff86e5139407dddb86a2b7e9a109f506":{"__typename":"MediaResource","id":"ff86e5139407dddb86a2b7e9a109f506","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"client.ini.xml"},"Paragraph:109369475f5e_27":{"__typename":"Paragraph","id":"109369475f5e_27","name":"7eb7","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:ff86e5139407dddb86a2b7e9a109f506"}},"mixtapeMetadata":null},"ImageMetadata:1*RCwczJPvuW_84cmxJg1J_g.png":{"__typename":"ImageMetadata","id":"1*RCwczJPvuW_84cmxJg1J_g.png","originalHeight":1844,"originalWidth":3092,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_28":{"__typename":"Paragraph","id":"109369475f5e_28","name":"0fbe","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RCwczJPvuW_84cmxJg1J_g.png"},"text":"Table 2. Configuration file structure: elements and their descriptions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_29":{"__typename":"Paragraph","id":"109369475f5e_29","name":"6731","type":"P","href":null,"layout":null,"metadata":null,"text":"Table 3 shows the characteristics of the discovered client.exe file.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":52,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*B8BfNwq7RlbsS1RuWKQxRg.png":{"__typename":"ImageMetadata","id":"1*B8BfNwq7RlbsS1RuWKQxRg.png","originalHeight":793,"originalWidth":3105,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_30":{"__typename":"Paragraph","id":"109369475f5e_30","name":"72f2","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*B8BfNwq7RlbsS1RuWKQxRg.png"},"text":"Table 3. Characteristics of client.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":28,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_31":{"__typename":"Paragraph","id":"109369475f5e_31","name":"7e62","type":"P","href":null,"layout":null,"metadata":null,"text":"Figure 3 is a screenshot of the interface of the latest client version we discovered.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*AsFOygRsaGht_bCH8GesLw.png":{"__typename":"ImageMetadata","id":"1*AsFOygRsaGht_bCH8GesLw.png","originalHeight":1091,"originalWidth":2020,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_32":{"__typename":"Paragraph","id":"109369475f5e_32","name":"7ce0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*AsFOygRsaGht_bCH8GesLw.png"},"text":"Figure 3. Lizar client version 2.0.4 interface","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZBDDQzeG6uva0mys3UYwiQ.png":{"__typename":"ImageMetadata","id":"1*ZBDDQzeG6uva0mys3UYwiQ.png","originalHeight":2353,"originalWidth":3097,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_33":{"__typename":"Paragraph","id":"109369475f5e_33","name":"92ac","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZBDDQzeG6uva0mys3UYwiQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_34":{"__typename":"Paragraph","id":"109369475f5e_34","name":"bd1f","type":"P","href":null,"layout":null,"metadata":null,"text":"The client supports several bot commands. The way they look in the GUI can be seen in Fig. 4.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Q2UgCZWDElUeiFdfqmZvMg.png":{"__typename":"ImageMetadata","id":"1*Q2UgCZWDElUeiFdfqmZvMg.png","originalHeight":633,"originalWidth":1223,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_35":{"__typename":"Paragraph","id":"109369475f5e_35","name":"ec4b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Q2UgCZWDElUeiFdfqmZvMg.png"},"text":"Figure 4. List of commands supported by the Lizar client","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_36":{"__typename":"Paragraph","id":"109369475f5e_36","name":"0bff","type":"P","href":null,"layout":null,"metadata":null,"text":"This is what each of the commands does:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_37":{"__typename":"Paragraph","id":"109369475f5e_37","name":"156c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Info — retrieve information about the system. The plugin for this command is located on the server. When a result is received from the plugin, the information is logged in the Info column.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":176,"end":180,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_38":{"__typename":"Paragraph","id":"109369475f5e_38","name":"061a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Kill — stop plugin.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_39":{"__typename":"Paragraph","id":"109369475f5e_39","name":"7996","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Period — change response frequency (Fig. 5).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*N-KMkhs2oNW_kOBR71g8Hg.png":{"__typename":"ImageMetadata","id":"1*N-KMkhs2oNW_kOBR71g8Hg.png","originalHeight":633,"originalWidth":1223,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_40":{"__typename":"Paragraph","id":"109369475f5e_40","name":"2b7a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*N-KMkhs2oNW_kOBR71g8Hg.png"},"text":"Figure 5. Period command in the Lizar client GUI","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_41":{"__typename":"Paragraph","id":"109369475f5e_41","name":"af8b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Screenshot — take a screenshot (Fig. 6). The plugin for this command is located on the server. Once a screenshot is taken, it will be displayed in a separate window.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RiR5yFniEwfRyMKu55a_WQ.png":{"__typename":"ImageMetadata","id":"1*RiR5yFniEwfRyMKu55a_WQ.png","originalHeight":330,"originalWidth":1028,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_42":{"__typename":"Paragraph","id":"109369475f5e_42","name":"6ec1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RiR5yFniEwfRyMKu55a_WQ.png"},"text":"Figure 6. Screenshot command in the Lizar client GUI","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_43":{"__typename":"Paragraph","id":"109369475f5e_43","name":"7446","type":"ULI","href":null,"layout":null,"metadata":null,"text":"List Processes — get a list of processes (Fig. 7). The plugin for this command is located on the server. If the plugin is successful, the list of processes will appear in a separate window.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lW3mlE4OAYO9bUXFCv34Jw.png":{"__typename":"ImageMetadata","id":"1*lW3mlE4OAYO9bUXFCv34Jw.png","originalHeight":330,"originalWidth":1089,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_44":{"__typename":"Paragraph","id":"109369475f5e_44","name":"d17d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lW3mlE4OAYO9bUXFCv34Jw.png"},"text":"Figure 7. List Processes command in the Lizar client GUI","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_45":{"__typename":"Paragraph","id":"109369475f5e_45","name":"1d60","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Command Line — get CMD on the infected system. The plugin for this command is located on the server. If the plugin executes the command successfully, the result will appear in a separate window.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_46":{"__typename":"Paragraph","id":"109369475f5e_46","name":"26a7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Executer — launch an additional module (Fig. 8).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7oncl8Kjofv82Lm8N_XGzw.png":{"__typename":"ImageMetadata","id":"1*7oncl8Kjofv82Lm8N_XGzw.png","originalHeight":633,"originalWidth":1223,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_47":{"__typename":"Paragraph","id":"109369475f5e_47","name":"29f3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7oncl8Kjofv82Lm8N_XGzw.png"},"text":"Figure 8. Executer command in the Lizar client GUI","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_48":{"__typename":"Paragraph","id":"109369475f5e_48","name":"8540","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Jump to — migrate the loader to another process. The plugin for this command is located on the server. The command parameters are passed through the client.ini.xml file.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":149,"end":163,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_49":{"__typename":"Paragraph","id":"109369475f5e_49","name":"a7f3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"New session — create another loader session (run a copy of the loader on the infected system).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_50":{"__typename":"Paragraph","id":"109369475f5e_50","name":"74d6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Mimikatz — run Mimikatz.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_51":{"__typename":"Paragraph","id":"109369475f5e_51","name":"6ee7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Grabber — run one of the plugins that collect passwords in browsers and OS. The Grabber tab has two buttons: Passwords + Screens and RDP (Fig. 9). Activating either of them sends a command to start the corresponding plugin.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":80,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":109,"end":128,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":133,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7A-inmrioHJG4r1lvy41gw.png":{"__typename":"ImageMetadata","id":"1*7A-inmrioHJG4r1lvy41gw.png","originalHeight":633,"originalWidth":1223,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_52":{"__typename":"Paragraph","id":"109369475f5e_52","name":"4fb9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7A-inmrioHJG4r1lvy41gw.png"},"text":"Figure 9. Grabber command in the Lizar client GUI","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_53":{"__typename":"Paragraph","id":"109369475f5e_53","name":"b26c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Network analysis — run one of the plugins to retrieve Active Directory and network information (Fig. 10).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YnvCnQHns_Xiap9VOJd7CQ.png":{"__typename":"ImageMetadata","id":"1*YnvCnQHns_Xiap9VOJd7CQ.png","originalHeight":633,"originalWidth":1223,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_54":{"__typename":"Paragraph","id":"109369475f5e_54","name":"aa87","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YnvCnQHns_Xiap9VOJd7CQ.png"},"text":"Figure 10. Network analysis command in the Lizar client GUI","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":11,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_55":{"__typename":"Paragraph","id":"109369475f5e_55","name":"2197","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Rat — run Carbanak (RAT). The IP address and port of the server and admin panel are set via the client.ini.xml configuration file (Fig. 11).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":20,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":96,"end":110,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FauGq88KB23TxOD8BIrIrg.png":{"__typename":"ImageMetadata","id":"1*FauGq88KB23TxOD8BIrIrg.png","originalHeight":633,"originalWidth":1223,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_56":{"__typename":"Paragraph","id":"109369475f5e_56","name":"b082","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FauGq88KB23TxOD8BIrIrg.png"},"text":"Figure 11. Rat command in the Lizar client GUI","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":11,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_57":{"__typename":"Paragraph","id":"109369475f5e_57","name":"d331","type":"P","href":null,"layout":null,"metadata":null,"text":"We skipped the Company computers command in the general list – it does not have a handler yet, so we cannot determine exactly what it does.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":15,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_58":{"__typename":"Paragraph","id":"109369475f5e_58","name":"89ee","type":"H3","href":null,"layout":null,"metadata":null,"text":"Lizar server","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_59":{"__typename":"Paragraph","id":"109369475f5e_59","name":"bc94","type":"P","href":null,"layout":null,"metadata":null,"text":"The Lizar server application, similar to the Lizar client, is written using the .NET Framework. However, unlike the client, the server runs on a remote Linux host.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_60":{"__typename":"Paragraph","id":"109369475f5e_60","name":"6a36","type":"P","href":null,"layout":null,"metadata":null,"text":"Date and time of the last detected server version compilation: Fri Feb 19 16:16:25 2021.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":63,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_61":{"__typename":"Paragraph","id":"109369475f5e_61","name":"991b","type":"P","href":null,"layout":null,"metadata":null,"text":"The application is run using the Wine utility with the pre-installed Wine Mono (wine-mono-5.0.0-x86.msi).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":80,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_62":{"__typename":"Paragraph","id":"109369475f5e_62","name":"1e51","type":"P","href":null,"layout":null,"metadata":null,"text":"The server application directory includes the following components:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_63":{"__typename":"Paragraph","id":"109369475f5e_63","name":"bb0a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"client\u002Fkeys — directory with encryption keys for proper communication with the client;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_64":{"__typename":"Paragraph","id":"109369475f5e_64","name":"9414","type":"ULI","href":null,"layout":null,"metadata":null,"text":"loader\u002Fkeys — directory with encryption keys for proper communication with the loader;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_65":{"__typename":"Paragraph","id":"109369475f5e_65","name":"29fa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"logs — directory with server logs (client-traffic, error, info);","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":35,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":51,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":58,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_66":{"__typename":"Paragraph","id":"109369475f5e_66","name":"8c92","type":"ULI","href":null,"layout":null,"metadata":null,"text":"plugins — plugin directory;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_67":{"__typename":"Paragraph","id":"109369475f5e_67","name":"7220","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ThirdScripts — directory with the ps2x.py script and the ps2p.py helper module. The ps2x.py script is designed to execute files on the remote host and is implemented using the Impacket project. Command templates for this script are displayed in the client application when the appropriate option is selected.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":34,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":57,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":84,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":176,"end":184,"href":"https:\u002F\u002Fgithub.com\u002FSecureAuthCorp\u002Fimpacket","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_68":{"__typename":"Paragraph","id":"109369475f5e_68","name":"786c","type":"P","href":null,"layout":null,"metadata":null,"text":"Full list of arguments supported by the script.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lU4l998WgEbksQ-ahNKuvw.png":{"__typename":"ImageMetadata","id":"1*lU4l998WgEbksQ-ahNKuvw.png","originalHeight":311,"originalWidth":946,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_69":{"__typename":"Paragraph","id":"109369475f5e_69","name":"9c2d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lU4l998WgEbksQ-ahNKuvw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_70":{"__typename":"Paragraph","id":"109369475f5e_70","name":"3939","type":"ULI","href":null,"layout":null,"metadata":null,"text":"x64 — directory containing the SQLite.interop.dll auxiliary library file (64-bit version).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":31,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_71":{"__typename":"Paragraph","id":"109369475f5e_71","name":"17f8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"x86 — directory containing the SQLite.interop.dll auxiliary library file (32-bit version).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":31,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_72":{"__typename":"Paragraph","id":"109369475f5e_72","name":"ff23","type":"ULI","href":null,"layout":null,"metadata":null,"text":"AV.lst — a CSV file containing the name of the process which is associated with the antivirus product, the name and description of the antivirus product.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_73":{"__typename":"Paragraph","id":"109369475f5e_73","name":"3c68","type":"P","href":null,"layout":null,"metadata":null,"text":"Several lines from the AV.lst file:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":23,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:134e29518541bff8d03c303d8c3e2d80":{"__typename":"MediaResource","id":"134e29518541bff8d03c303d8c3e2d80","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"AV.lst"},"Paragraph:109369475f5e_74":{"__typename":"Paragraph","id":"109369475f5e_74","name":"fc38","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:134e29518541bff8d03c303d8c3e2d80"}},"mixtapeMetadata":null},"Paragraph:109369475f5e_75":{"__typename":"Paragraph","id":"109369475f5e_75","name":"8d96","type":"ULI","href":null,"layout":null,"metadata":null,"text":"data.db — a database file containing information on all loaders (this information is loaded into the client application).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_76":{"__typename":"Paragraph","id":"109369475f5e_76","name":"45cc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"server.exe — server application.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_77":{"__typename":"Paragraph","id":"109369475f5e_77","name":"9723","type":"ULI","href":null,"layout":null,"metadata":null,"text":"server.ini.xml — server application configuration file.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_78":{"__typename":"Paragraph","id":"109369475f5e_78","name":"947d","type":"P","href":null,"layout":null,"metadata":null,"text":"Example contents of the configuration file:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*AUz8pSnXjk7YXbCAEGK6_Q.png":{"__typename":"ImageMetadata","id":"1*AUz8pSnXjk7YXbCAEGK6_Q.png","originalHeight":212,"originalWidth":930,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_79":{"__typename":"Paragraph","id":"109369475f5e_79","name":"7b00","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*AUz8pSnXjk7YXbCAEGK6_Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_80":{"__typename":"Paragraph","id":"109369475f5e_80","name":"7e76","type":"ULI","href":null,"layout":null,"metadata":null,"text":"System.Data.SQLite.dll — auxiliary library file.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_81":{"__typename":"Paragraph","id":"109369475f5e_81","name":"5276","type":"H3","href":null,"layout":null,"metadata":null,"text":"Communication between client and server","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_82":{"__typename":"Paragraph","id":"109369475f5e_82","name":"3ce1","type":"P","href":null,"layout":null,"metadata":null,"text":"Before being sent to the server, the data is encrypted on a session key with a length ranging from 5 to 15 bytes and then on the key specified in the configuration (31 bytes). The encryption function is shown below.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:7f29fa13b36043f9a970e43814229b54":{"__typename":"MediaResource","id":"7f29fa13b36043f9a970e43814229b54","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"EncodeData.cs"},"Paragraph:109369475f5e_83":{"__typename":"Paragraph","id":"109369475f5e_83","name":"bd82","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:7f29fa13b36043f9a970e43814229b54"}},"mixtapeMetadata":null},"Paragraph:109369475f5e_84":{"__typename":"Paragraph","id":"109369475f5e_84","name":"09a2","type":"P","href":null,"layout":null,"metadata":null,"text":"If the key specified in the configuration (31 bytes) does not match the key on the server, no data is sent from the server.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_85":{"__typename":"Paragraph","id":"109369475f5e_85","name":"4413","type":"P","href":null,"layout":null,"metadata":null,"text":"To verify the key on the side of the server, the client sends a checksum of the key, calculated according to the following algorithm:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:85eb1fbe22c7917502b844ba02e7ff13":{"__typename":"MediaResource","id":"85eb1fbe22c7917502b844ba02e7ff13","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"CalcHash.cs"},"Paragraph:109369475f5e_86":{"__typename":"Paragraph","id":"109369475f5e_86","name":"3669","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:85eb1fbe22c7917502b844ba02e7ff13"}},"mixtapeMetadata":null},"Paragraph:109369475f5e_87":{"__typename":"Paragraph","id":"109369475f5e_87","name":"5544","type":"P","href":null,"layout":null,"metadata":null,"text":"Data received from the server is decrypted on a session key with a length ranging from 5 to 15 bytes, then on the same pair of session key and configuration key. Function for decryption:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:6886cf9c6d941683e79fab93e8235f68":{"__typename":"MediaResource","id":"6886cf9c6d941683e79fab93e8235f68","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"DecodeData.cs"},"Paragraph:109369475f5e_88":{"__typename":"Paragraph","id":"109369475f5e_88","name":"8571","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:6886cf9c6d941683e79fab93e8235f68"}},"mixtapeMetadata":null},"Paragraph:109369475f5e_89":{"__typename":"Paragraph","id":"109369475f5e_89","name":"c799","type":"P","href":null,"layout":null,"metadata":null,"text":"The client and the server exchange data in binary format. The decrypted data is a list of bots (Fig. 12).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YBgfkBMqtJzXYrhTQMnvWw.png":{"__typename":"ImageMetadata","id":"1*YBgfkBMqtJzXYrhTQMnvWw.png","originalHeight":676,"originalWidth":606,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_90":{"__typename":"Paragraph","id":"109369475f5e_90","name":"0960","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YBgfkBMqtJzXYrhTQMnvWw.png"},"text":"Figure 12. Example of decrypted data transmitted from server to client","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_91":{"__typename":"Paragraph","id":"109369475f5e_91","name":"8dd0","type":"H3","href":null,"layout":null,"metadata":null,"text":"Lizar loader","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_92":{"__typename":"Paragraph","id":"109369475f5e_92","name":"aa18","type":"P","href":null,"layout":null,"metadata":null,"text":"The Lizar loader is designed to execute commands by running plugins, and to run additional modules. It runs on the infected computer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_93":{"__typename":"Paragraph","id":"109369475f5e_93","name":"4e36","type":"P","href":null,"layout":null,"metadata":null,"text":"As we have already mentioned, Lizar loader and Lizar plugins run on the infected system and can logically be combined into the Lizar bot component. The bot’s modular architecture makes the tool scalable and allows for independent development of all components.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_94":{"__typename":"Paragraph","id":"109369475f5e_94","name":"694b","type":"P","href":null,"layout":null,"metadata":null,"text":"We’ve detected three kinds of bots: DLLs, EXEs and PowerShell scripts, which execute a DLL in the address space of the PowerShell process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_95":{"__typename":"Paragraph","id":"109369475f5e_95","name":"1e0b","type":"P","href":null,"layout":null,"metadata":null,"text":"The pseudocode of the main loader function, along with the reconstructed function structure, is shown in Fig. 13.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rW1qfvioSmsX-xyxhrRvig.png":{"__typename":"ImageMetadata","id":"1*rW1qfvioSmsX-xyxhrRvig.png","originalHeight":875,"originalWidth":1257,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_96":{"__typename":"Paragraph","id":"109369475f5e_96","name":"cd57","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*rW1qfvioSmsX-xyxhrRvig.png"},"text":"Figure 13. Loader’s main function pseudocode","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_97":{"__typename":"Paragraph","id":"109369475f5e_97","name":"9568","type":"P","href":null,"layout":null,"metadata":null,"text":"The following are some of the actions the x_Init function performs:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":42,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_98":{"__typename":"Paragraph","id":"109369475f5e_98","name":"9169","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Generate a random key g_ConfigKey31 using the function SystemFunction036. This key is used to encrypt and decrypt the configuration data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":25,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":58,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_99":{"__typename":"Paragraph","id":"109369475f5e_99","name":"d932","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Obtain system information and calculate the checksum from the information received (Fig. 14).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*W25NEHDiSvwsg5Tf9qA0Uw.png":{"__typename":"ImageMetadata","id":"1*W25NEHDiSvwsg5Tf9qA0Uw.png","originalHeight":939,"originalWidth":805,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_100":{"__typename":"Paragraph","id":"109369475f5e_100","name":"69f9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*W25NEHDiSvwsg5Tf9qA0Uw.png"},"text":"Figure 14. Pseudocode for retrieving system information and calculating its checksum","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_101":{"__typename":"Paragraph","id":"109369475f5e_101","name":"16be","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Retrieve the current process ID (the checksum and PID of the loader process are displayed in the Id column in the client application).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":53,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":100,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_102":{"__typename":"Paragraph","id":"109369475f5e_102","name":"65be","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Calculate the checksum from the previously received checksum and the current process ID (labelled g_BotId in Figure 13).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":101,"end":108,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_103":{"__typename":"Paragraph","id":"109369475f5e_103","name":"27de","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Decrypt configuration data: list of IP addresses, list of ports for each server. Configuration data is decrypted on 31-byte g_LoaderKey with XOR algorithm. After decryption, the data is re-encrypted on g_ConfigKey31 with an XOR algorithm. The g_LoaderKey is also used when encrypting data sent to the server and when decrypting data received from the server.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":127,"end":138,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":144,"end":147,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":205,"end":218,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":227,"end":230,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":246,"end":257,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_104":{"__typename":"Paragraph","id":"109369475f5e_104","name":"a17e","type":"P","href":null,"layout":null,"metadata":null,"text":"6. Initialise global variables and critical sections for some variables. This is needed to access data from different threads.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_105":{"__typename":"Paragraph","id":"109369475f5e_105","name":"ffeb","type":"P","href":null,"layout":null,"metadata":null,"text":"7. Initialise executable memory for plugin execution.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_106":{"__typename":"Paragraph","id":"109369475f5e_106","name":"4dce","type":"P","href":null,"layout":null,"metadata":null,"text":"8. Launch five threads which process the queue of messages from the server. This mechanism is implemented using the PostQueuedCompletionStatus and GetQueuedCompletionStatus functions. Data received from the server is decrypted and sent to the handler (Fig.15).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":116,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":147,"end":172,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xkTvGJuHyGMnh8yV1tlHUw.png":{"__typename":"ImageMetadata","id":"1*xkTvGJuHyGMnh8yV1tlHUw.png","originalHeight":470,"originalWidth":809,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_107":{"__typename":"Paragraph","id":"109369475f5e_107","name":"9386","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xkTvGJuHyGMnh8yV1tlHUw.png"},"text":"Figure 15. Pseudocode algorithm for decrypting data received from the server and sending it for processing","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_108":{"__typename":"Paragraph","id":"109369475f5e_108","name":"4a87","type":"P","href":null,"layout":null,"metadata":null,"text":"The handler accepts data using the GetQueuedCompletionStatus function.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":35,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_109":{"__typename":"Paragraph","id":"109369475f5e_109","name":"c670","type":"P","href":null,"layout":null,"metadata":null,"text":"The vServerData→ServerData variable contains the plugin body after decryption (look again at Fig. 15). The algorithm's pseudocode for decrypting data received from the server is shown in Fig. 16.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*H5kvvwUVJhiezzk2vJR5xQ.png":{"__typename":"ImageMetadata","id":"1*H5kvvwUVJhiezzk2vJR5xQ.png","originalHeight":490,"originalWidth":656,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_110":{"__typename":"Paragraph","id":"109369475f5e_110","name":"a934","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*H5kvvwUVJhiezzk2vJR5xQ.png"},"text":"Figure 16. Pseudocode of the algorithm for decrypting data received from the server","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_111":{"__typename":"Paragraph","id":"109369475f5e_111","name":"b7fa","type":"P","href":null,"layout":null,"metadata":null,"text":"Before being sent to the server, the data structure has to pass through shaping as shown in Fig. 17.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9JOHXKWZqMXHGzm74eTGOA.png":{"__typename":"ImageMetadata","id":"1*9JOHXKWZqMXHGzm74eTGOA.png","originalHeight":615,"originalWidth":908,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_112":{"__typename":"Paragraph","id":"109369475f5e_112","name":"1184","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9JOHXKWZqMXHGzm74eTGOA.png"},"text":"Figure 17. Pseudocode of the function that generates the structure sent to the server","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_113":{"__typename":"Paragraph","id":"109369475f5e_113","name":"98b7","type":"H3","href":null,"layout":null,"metadata":null,"text":"plugins from plugins directory","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":13,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_114":{"__typename":"Paragraph","id":"109369475f5e_114","name":"aa71","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugins in the plugins directory are sent from the server to the loader and are executed by the loader when a certain action is performed in the Lizar client application.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":19,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_115":{"__typename":"Paragraph","id":"109369475f5e_115","name":"8445","type":"P","href":null,"layout":null,"metadata":null,"text":"The six stages of the plugins’ lifecycle:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_116":{"__typename":"Paragraph","id":"109369475f5e_116","name":"03d0","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The user selects a command in the Lizar client application interface.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_117":{"__typename":"Paragraph","id":"109369475f5e_117","name":"5f68","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The Lizar server receives the information about the selected command.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_118":{"__typename":"Paragraph","id":"109369475f5e_118","name":"9f1f","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Depending on the command and loader bitness, the server finds a suitable plugin from the plugins directory, then sends the loader a request containing the command and the body of the plugin (e.g., Screenshot{bitness}.dll).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":89,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":197,"end":220,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_119":{"__typename":"Paragraph","id":"109369475f5e_119","name":"041c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The loader executes the plugin and stores the result of the plugin’s execution in a specially allocated area of memory on the heap.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_120":{"__typename":"Paragraph","id":"109369475f5e_120","name":"82c8","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The server retrieves the results of plugin execution and sends them on to the client.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_121":{"__typename":"Paragraph","id":"109369475f5e_121","name":"0405","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The client application displays the plugin results.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_122":{"__typename":"Paragraph","id":"109369475f5e_122","name":"220c","type":"P","href":null,"layout":null,"metadata":null,"text":"A full list of plugins (32-bit and 64-bit DLLs) in the plugins directory.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":55,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_123":{"__typename":"Paragraph","id":"109369475f5e_123","name":"2a69","type":"ULI","href":null,"layout":null,"metadata":null,"text":"CommandLine32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_124":{"__typename":"Paragraph","id":"109369475f5e_124","name":"abd8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"CommandLine64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_125":{"__typename":"Paragraph","id":"109369475f5e_125","name":"4e05","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Executer32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_126":{"__typename":"Paragraph","id":"109369475f5e_126","name":"96ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Executer64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_127":{"__typename":"Paragraph","id":"109369475f5e_127","name":"4ab3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Grabber32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_128":{"__typename":"Paragraph","id":"109369475f5e_128","name":"89e7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Grabber64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_129":{"__typename":"Paragraph","id":"109369475f5e_129","name":"339a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Info32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_130":{"__typename":"Paragraph","id":"109369475f5e_130","name":"51d4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Info64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_131":{"__typename":"Paragraph","id":"109369475f5e_131","name":"c440","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Jumper32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_132":{"__typename":"Paragraph","id":"109369475f5e_132","name":"c210","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Jumper64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_133":{"__typename":"Paragraph","id":"109369475f5e_133","name":"03fd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ListProcess32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_134":{"__typename":"Paragraph","id":"109369475f5e_134","name":"0cdc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ListProcess64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_135":{"__typename":"Paragraph","id":"109369475f5e_135","name":"5a7b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"mimikatz32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_136":{"__typename":"Paragraph","id":"109369475f5e_136","name":"b923","type":"ULI","href":null,"layout":null,"metadata":null,"text":"mimikatz64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_137":{"__typename":"Paragraph","id":"109369475f5e_137","name":"11e0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"NetSession32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_138":{"__typename":"Paragraph","id":"109369475f5e_138","name":"fe02","type":"ULI","href":null,"layout":null,"metadata":null,"text":"NetSession64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_139":{"__typename":"Paragraph","id":"109369475f5e_139","name":"5bf7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"rat32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_140":{"__typename":"Paragraph","id":"109369475f5e_140","name":"b198","type":"ULI","href":null,"layout":null,"metadata":null,"text":"rat64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_141":{"__typename":"Paragraph","id":"109369475f5e_141","name":"36d4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Screenshot32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_142":{"__typename":"Paragraph","id":"109369475f5e_142","name":"a9fd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Screenshot64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_143":{"__typename":"Paragraph","id":"109369475f5e_143","name":"c841","type":"H3","href":null,"layout":null,"metadata":null,"text":"CommandLine32.dll\u002FCommandLine64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_144":{"__typename":"Paragraph","id":"109369475f5e_144","name":"f70a","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is designed to give attackers access to the command line interface on an infected system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_145":{"__typename":"Paragraph","id":"109369475f5e_145","name":"d045","type":"P","href":null,"layout":null,"metadata":null,"text":"Sending commands to the cmd.exe process and receiving the result of the commands is implemented via pipes (Fig. 18).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":24,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CIVupXgwqHX15sDUFgAo2Q.png":{"__typename":"ImageMetadata","id":"1*CIVupXgwqHX15sDUFgAo2Q.png","originalHeight":846,"originalWidth":855,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_146":{"__typename":"Paragraph","id":"109369475f5e_146","name":"b2b2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CIVupXgwqHX15sDUFgAo2Q.png"},"text":"Figure 18. CommandLine32.dll\u002FCommandLine64.dll main function pseudocode","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":11,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":29,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_147":{"__typename":"Paragraph","id":"109369475f5e_147","name":"a77b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Executer32.dll\u002FExecuter64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_148":{"__typename":"Paragraph","id":"109369475f5e_148","name":"3b01","type":"P","href":null,"layout":null,"metadata":null,"text":"Executer32.dll\u002FExecuter64.dll launches additional components specified in the Lizar client application interface.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":15,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_149":{"__typename":"Paragraph","id":"109369475f5e_149","name":"5c35","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin can run the following components:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_150":{"__typename":"Paragraph","id":"109369475f5e_150","name":"fefa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"EXE file from the %TEMP% directory;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":18,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_151":{"__typename":"Paragraph","id":"109369475f5e_151","name":"aa77","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PowerShell script from the %TEMP% directory, which is run using the following command: {path to powershell.exe} -ex bypass -noprof -nolog -nonint -f {path to the PowerShell script};","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":27,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":87,"end":180,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_152":{"__typename":"Paragraph","id":"109369475f5e_152","name":"d6c6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"DLL in memory;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_153":{"__typename":"Paragraph","id":"109369475f5e_153","name":"6daa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"shellcode.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_154":{"__typename":"Paragraph","id":"109369475f5e_154","name":"5b24","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin code that runs shellcode is shown in Fig. 19.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yOI1gsqAu5_UFtf6ggQJJQ.png":{"__typename":"ImageMetadata","id":"1*yOI1gsqAu5_UFtf6ggQJJQ.png","originalHeight":254,"originalWidth":662,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_155":{"__typename":"Paragraph","id":"109369475f5e_155","name":"9b35","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*yOI1gsqAu5_UFtf6ggQJJQ.png"},"text":"Figure 19. Executer32.dll\u002FExecuter64.dll code running shellcode","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":11,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":26,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_156":{"__typename":"Paragraph","id":"109369475f5e_156","name":"08b8","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that the plugin file Executer64.dll contains the path to the PDB: M:\\paal\\Lizar\\bin\\Release\\Plugins\\Executer64.pdb.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":26,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":71,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_157":{"__typename":"Paragraph","id":"109369475f5e_157","name":"68b4","type":"H3","href":null,"layout":null,"metadata":null,"text":"Grabber32.dll\u002FGrabber64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_158":{"__typename":"Paragraph","id":"109369475f5e_158","name":"bb1b","type":"P","href":null,"layout":null,"metadata":null,"text":"Contrary to its name, this plugin has no grabber functionality and is a typical PE loader.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_159":{"__typename":"Paragraph","id":"109369475f5e_159","name":"34cb","type":"P","href":null,"layout":null,"metadata":null,"text":"Although attackers call it a grabber, the loaded PE file actually performs the functions of other types of tools, such as a stealer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_160":{"__typename":"Paragraph","id":"109369475f5e_160","name":"880c","type":"P","href":null,"layout":null,"metadata":null,"text":"Both versions of the plugin are used as client-side grabber loaders: PswRdInfo64 and PswInfoGrabber64.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":69,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":85,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_161":{"__typename":"Paragraph","id":"109369475f5e_161","name":"d014","type":"H3","href":null,"layout":null,"metadata":null,"text":"Info32.dll\u002FInfo64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_162":{"__typename":"Paragraph","id":"109369475f5e_162","name":"d0cb","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is designed to retrieve information about the infected system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_163":{"__typename":"Paragraph","id":"109369475f5e_163","name":"8eb0","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is executed by using the Info command in the Lizar client application. A data structure containing the OS version, user name and computer name is sent to the server.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":36,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_164":{"__typename":"Paragraph","id":"109369475f5e_164","name":"422c","type":"P","href":null,"layout":null,"metadata":null,"text":"On the server side, the received structure is converted to a special string (Fig. 20).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Fck0G-AvxJ4XT05Kz2YIag.png":{"__typename":"ImageMetadata","id":"1*Fck0G-AvxJ4XT05Kz2YIag.png","originalHeight":216,"originalWidth":954,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_165":{"__typename":"Paragraph","id":"109369475f5e_165","name":"6448","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Fck0G-AvxJ4XT05Kz2YIag.png"},"text":"Figure 20. Pseudocode snippet responsible for conversion of the received structure into a special string on the server","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_166":{"__typename":"Paragraph","id":"109369475f5e_166","name":"02db","type":"H3","href":null,"layout":null,"metadata":null,"text":"Jumper32.dll\u002FJumper64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_167":{"__typename":"Paragraph","id":"109369475f5e_167","name":"4ae8","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is designed to migrate the loader to the address space of another process. Injection parameters are set in the Lizar client configuration file. It should be noted that this plugin can be used not only to inject the loader, but also to execute other PE files in the address space of the specified process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_168":{"__typename":"Paragraph","id":"109369475f5e_168","name":"77e1","type":"P","href":null,"layout":null,"metadata":null,"text":"Figure 21 shows the main function of the plugin.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*bpstNGfQaobaq4lXcTavrw.png":{"__typename":"ImageMetadata","id":"1*bpstNGfQaobaq4lXcTavrw.png","originalHeight":701,"originalWidth":730,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_169":{"__typename":"Paragraph","id":"109369475f5e_169","name":"0806","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*bpstNGfQaobaq4lXcTavrw.png"},"text":"Figure 21. Jumper32.dll\u002FJumper64.dll main function pseudocode","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":11,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":24,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_170":{"__typename":"Paragraph","id":"109369475f5e_170","name":"4d47","type":"P","href":null,"layout":null,"metadata":null,"text":"From the pseudocode above we see that the loader can migrate to the address space of the specified process in three ways:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_171":{"__typename":"Paragraph","id":"109369475f5e_171","name":"9ce5","type":"ULI","href":null,"layout":null,"metadata":null,"text":"by performing an injection into the process with a certain PID;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_172":{"__typename":"Paragraph","id":"109369475f5e_172","name":"1dcb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"by creating a process with a certain name and performing an injection into it;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_173":{"__typename":"Paragraph","id":"109369475f5e_173","name":"8b87","type":"ULI","href":null,"layout":null,"metadata":null,"text":"by creating a process with the same name as the current one and performing an injection into it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_174":{"__typename":"Paragraph","id":"109369475f5e_174","name":"6cc5","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s take a closer look at each method.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_175":{"__typename":"Paragraph","id":"109369475f5e_175","name":"af19","type":"P","href":null,"layout":null,"metadata":null,"text":"Algorithm for injection by process ID","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_176":{"__typename":"Paragraph","id":"109369475f5e_176","name":"9b0a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"OpenProcess — The plugin retrieves the process handle for the specified process identifier (PID).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":92,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_177":{"__typename":"Paragraph","id":"109369475f5e_177","name":"8276","type":"OLI","href":null,"layout":null,"metadata":null,"text":"VirtualAllocEx + WriteProcessMemory — the plugin allocates memory in the virtual address space of the specified process and writes in it the contents to be executed afterwards.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":17,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_178":{"__typename":"Paragraph","id":"109369475f5e_178","name":"5536","type":"OLI","href":null,"layout":null,"metadata":null,"text":"CreateRemoteThread — the plugin creates a thread in the virtual address space of the specified process, with the lpStartAddress serving as the main function of the loader.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_179":{"__typename":"Paragraph","id":"109369475f5e_179","name":"4b57","type":"P","href":null,"layout":null,"metadata":null,"text":"If CreateRemoteThread fails, plugin uses the RtlCreateUserThread function (Fig. 22).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":3,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":45,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*x-a2tMDEgG-8BDNN1pum7g.png":{"__typename":"ImageMetadata","id":"1*x-a2tMDEgG-8BDNN1pum7g.png","originalHeight":419,"originalWidth":946,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_180":{"__typename":"Paragraph","id":"109369475f5e_180","name":"5ba2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*x-a2tMDEgG-8BDNN1pum7g.png"},"text":"Figure 22. Pseudocode for a function to create a thread in the virtual address space of the specified process","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_181":{"__typename":"Paragraph","id":"109369475f5e_181","name":"0a94","type":"P","href":null,"layout":null,"metadata":null,"text":"Injection algorithm by executable file name","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_182":{"__typename":"Paragraph","id":"109369475f5e_182","name":"da0f","type":"P","href":null,"layout":null,"metadata":null,"text":"1. The plugin finds the path to the system executable file to be injected. The location of this file depends on the bitness of the loader. 64-bit file is located in %SYSTEMROOT%\\System32 directory, 32-bit — in %SYSTEMROOT%\\SysWOW64 directory.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":165,"end":186,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":210,"end":231,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_183":{"__typename":"Paragraph","id":"109369475f5e_183","name":"133f","type":"P","href":null,"layout":null,"metadata":null,"text":"2. The plugin creates a process for the received system executable, and receives the identifier of the created process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_184":{"__typename":"Paragraph","id":"109369475f5e_184","name":"f5ed","type":"P","href":null,"layout":null,"metadata":null,"text":"Depending on the plugin parameters, there are two ways to implement this step:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_185":{"__typename":"Paragraph","id":"109369475f5e_185","name":"114f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"If the appropriate flag is set in the structure passed to the plugin, the plugin creates a process in the security context of the explorer.exe process (Fig. 23).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":130,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*bDJVLjA45Sa6drXltFlYvQ.png":{"__typename":"ImageMetadata","id":"1*bDJVLjA45Sa6drXltFlYvQ.png","originalHeight":940,"originalWidth":819,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_186":{"__typename":"Paragraph","id":"109369475f5e_186","name":"53f1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*bDJVLjA45Sa6drXltFlYvQ.png"},"text":"Figure 23. Running an executable in the security context of explorer.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":60,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_187":{"__typename":"Paragraph","id":"109369475f5e_187","name":"3197","type":"ULI","href":null,"layout":null,"metadata":null,"text":"If the flag is not set, the executable file is started by calling the CreateProcessA function (Fig. 24).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":70,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YqcNmeKbabTBqxf0icIxVQ.png":{"__typename":"ImageMetadata","id":"1*YqcNmeKbabTBqxf0icIxVQ.png","originalHeight":217,"originalWidth":803,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_188":{"__typename":"Paragraph","id":"109369475f5e_188","name":"afed","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YqcNmeKbabTBqxf0icIxVQ.png"},"text":"Figure 24. Calling CreateProcessA process","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":19,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_189":{"__typename":"Paragraph","id":"109369475f5e_189","name":"e538","type":"P","href":null,"layout":null,"metadata":null,"text":"3. The plugin allocates memory in the virtual address space of the created process and writes in it the contents, which are to be executed later (VirtualAllocEx + WriteProcessMemory).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":146,"end":181,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_190":{"__typename":"Paragraph","id":"109369475f5e_190","name":"03a2","type":"P","href":null,"layout":null,"metadata":null,"text":"4. The plugin runs functions in the virtual address space of the created process in one of the following ways, depending on the bitness of the process:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_191":{"__typename":"Paragraph","id":"109369475f5e_191","name":"7b65","type":"ULI","href":null,"layout":null,"metadata":null,"text":"in case of the 64-bit process, a function is started with another function, shown in Fig. 25;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-VAS8KOmK6eZai-ageo1uQ.png":{"__typename":"ImageMetadata","id":"1*-VAS8KOmK6eZai-ageo1uQ.png","originalHeight":455,"originalWidth":735,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_192":{"__typename":"Paragraph","id":"109369475f5e_192","name":"eabc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-VAS8KOmK6eZai-ageo1uQ.png"},"text":"Figure 25. Pseudocode of the algorithm for injecting into a 64-bit process","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_193":{"__typename":"Paragraph","id":"109369475f5e_193","name":"fb5f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"in case of the 32-bit process, a function is started using the CreateRemoteThread and RtlCreateUserThread functions, which create a thread in the virtual address space of the specified process.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":63,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":86,"end":105,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_194":{"__typename":"Paragraph","id":"109369475f5e_194","name":"e44c","type":"P","href":null,"layout":null,"metadata":null,"text":"Algorithm for injection into the same-name process","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_195":{"__typename":"Paragraph","id":"109369475f5e_195","name":"1b38","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The plugin retrieves the path to the executable file for the process in the address space of which it is running.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_196":{"__typename":"Paragraph","id":"109369475f5e_196","name":"00ef","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The plugin launches this executable file and injects it into the created process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_197":{"__typename":"Paragraph","id":"109369475f5e_197","name":"5384","type":"P","href":null,"layout":null,"metadata":null,"text":"The pseudocode for this method is shown in Fig. 26.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*n4NAcE5VDoVy1d8ZA0poTg.png":{"__typename":"ImageMetadata","id":"1*n4NAcE5VDoVy1d8ZA0poTg.png","originalHeight":522,"originalWidth":769,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_198":{"__typename":"Paragraph","id":"109369475f5e_198","name":"051a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*n4NAcE5VDoVy1d8ZA0poTg.png"},"text":"Figure 26. Pseudocode for injecting Jumper32.dll\u002FJumper64.dll into the same process","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":36,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":49,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_199":{"__typename":"Paragraph","id":"109369475f5e_199","name":"c093","type":"H3","href":null,"layout":null,"metadata":null,"text":"ListProcesses32.dll\u002FListProcesses64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_200":{"__typename":"Paragraph","id":"109369475f5e_200","name":"5e7f","type":"P","href":null,"layout":null,"metadata":null,"text":"This plugin is designed to provide information on running processes (Fig. 27 and 28).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qelm_2R91gCC9eKHdANqyg.png":{"__typename":"ImageMetadata","id":"1*qelm_2R91gCC9eKHdANqyg.png","originalHeight":809,"originalWidth":960,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_201":{"__typename":"Paragraph","id":"109369475f5e_201","name":"a9c8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qelm_2R91gCC9eKHdANqyg.png"},"text":"Figure 27. Retrieving information about each active process","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*twt9fQiqsEA9rpQ0yquucg.png":{"__typename":"ImageMetadata","id":"1*twt9fQiqsEA9rpQ0yquucg.png","originalHeight":412,"originalWidth":788,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_202":{"__typename":"Paragraph","id":"109369475f5e_202","name":"7beb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*twt9fQiqsEA9rpQ0yquucg.png"},"text":"Figure 28. Inserting the retrieved information to be sent to the server at a later time","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_203":{"__typename":"Paragraph","id":"109369475f5e_203","name":"82bb","type":"P","href":null,"layout":null,"metadata":null,"text":"The following can be retrieved for each process:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_204":{"__typename":"Paragraph","id":"109369475f5e_204","name":"431c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"process identifier;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_205":{"__typename":"Paragraph","id":"109369475f5e_205","name":"0ed3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"path to the executable file;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_206":{"__typename":"Paragraph","id":"109369475f5e_206","name":"155d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"information about the user running the process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_207":{"__typename":"Paragraph","id":"109369475f5e_207","name":"1720","type":"H3","href":null,"layout":null,"metadata":null,"text":"mimikatz32.dll\u002Fmimikatz64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_208":{"__typename":"Paragraph","id":"109369475f5e_208","name":"74e7","type":"P","href":null,"layout":null,"metadata":null,"text":"The Mimikatz plugin is a wrapper for client-side Powerkatz modules:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_209":{"__typename":"Paragraph","id":"109369475f5e_209","name":"7bf6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_full32.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_210":{"__typename":"Paragraph","id":"109369475f5e_210","name":"0c4d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_full64.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_211":{"__typename":"Paragraph","id":"109369475f5e_211","name":"4488","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_short32.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_212":{"__typename":"Paragraph","id":"109369475f5e_212","name":"c2ff","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_short64.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_213":{"__typename":"Paragraph","id":"109369475f5e_213","name":"56ad","type":"H3","href":null,"layout":null,"metadata":null,"text":"NetSession32.dll\u002FNetSession64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_214":{"__typename":"Paragraph","id":"109369475f5e_214","name":"3de9","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is designed to retrieve information about all active network sessions on the infected server. For each session, the host address from which the connection is made can be retrieved, along with the name of the user initiating the connection.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_215":{"__typename":"Paragraph","id":"109369475f5e_215","name":"dbed","type":"P","href":null,"layout":null,"metadata":null,"text":"The pseudocode of the function in which the information is received is shown in Fig. 29 and 30.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*N0QQ19OVEqdBXPL6Se3czQ.png":{"__typename":"ImageMetadata","id":"1*N0QQ19OVEqdBXPL6Se3czQ.png","originalHeight":632,"originalWidth":952,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_216":{"__typename":"Paragraph","id":"109369475f5e_216","name":"745f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*N0QQ19OVEqdBXPL6Se3czQ.png"},"text":"Figure 29. Retrieving network session information using WinAPI functions","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MSevbIFkfN0zufddjTXZFg.png":{"__typename":"ImageMetadata","id":"1*MSevbIFkfN0zufddjTXZFg.png","originalHeight":776,"originalWidth":876,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_217":{"__typename":"Paragraph","id":"109369475f5e_217","name":"70f7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MSevbIFkfN0zufddjTXZFg.png"},"text":"Figure 30. Inserting the information retrieved by the plugin to be sent to the server","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_218":{"__typename":"Paragraph","id":"109369475f5e_218","name":"0497","type":"H3","href":null,"layout":null,"metadata":null,"text":"rat32.dll\u002Frat64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_219":{"__typename":"Paragraph","id":"109369475f5e_219","name":"48d9","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is a simplified version of the Carbanak toolkit bot. As we reported at the beginning of this article, this toolkit is heavily used by the FIN7 faction.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_220":{"__typename":"Paragraph","id":"109369475f5e_220","name":"d324","type":"H3","href":null,"layout":null,"metadata":null,"text":"Screenshot32.dll\u002FScreenshot64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_221":{"__typename":"Paragraph","id":"109369475f5e_221","name":"1bab","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin can take a JPEG screenshot on the infected system. The part of the function used to save the resulting image to the stream is shown below (Fig. 31).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BfZNVClYD4bLIHJHM_kLOg.png":{"__typename":"ImageMetadata","id":"1*BfZNVClYD4bLIHJHM_kLOg.png","originalHeight":560,"originalWidth":618,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_222":{"__typename":"Paragraph","id":"109369475f5e_222","name":"1ae6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BfZNVClYD4bLIHJHM_kLOg.png"},"text":"Figure 31. The part of the function used to save a screenshot taken by the plugin to the stream","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_223":{"__typename":"Paragraph","id":"109369475f5e_223","name":"ffc5","type":"P","href":null,"layout":null,"metadata":null,"text":"The received stream is then sent to the loader to be sent to the server.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_224":{"__typename":"Paragraph","id":"109369475f5e_224","name":"b4d6","type":"H3","href":null,"layout":null,"metadata":null,"text":"plugins from the plugins\u002Fextra directory","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":17,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_225":{"__typename":"Paragraph","id":"109369475f5e_225","name":"386f","type":"P","href":null,"layout":null,"metadata":null,"text":"plugins from the plugins\u002Fextra directory are transferred from the client to the server, then from the server to the loader (on the infected system).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":17,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_226":{"__typename":"Paragraph","id":"109369475f5e_226","name":"e96f","type":"P","href":null,"layout":null,"metadata":null,"text":"List of files in the plugins\u002Fextra directory:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":21,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_227":{"__typename":"Paragraph","id":"109369475f5e_227","name":"9ce0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ADRecon.ps1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_228":{"__typename":"Paragraph","id":"109369475f5e_228","name":"2e13","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetHash32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_229":{"__typename":"Paragraph","id":"109369475f5e_229","name":"c8f7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetHash64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_230":{"__typename":"Paragraph","id":"109369475f5e_230","name":"79ee","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetPass32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_231":{"__typename":"Paragraph","id":"109369475f5e_231","name":"7f35","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetPass64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_232":{"__typename":"Paragraph","id":"109369475f5e_232","name":"0808","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_full32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_233":{"__typename":"Paragraph","id":"109369475f5e_233","name":"6147","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_full64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_234":{"__typename":"Paragraph","id":"109369475f5e_234","name":"23e9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_short32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_235":{"__typename":"Paragraph","id":"109369475f5e_235","name":"be48","type":"ULI","href":null,"layout":null,"metadata":null,"text":"powerkatz_short64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_236":{"__typename":"Paragraph","id":"109369475f5e_236","name":"6bfb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PswInfoGrabber32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_237":{"__typename":"Paragraph","id":"109369475f5e_237","name":"3465","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PswInfoGrabber64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_238":{"__typename":"Paragraph","id":"109369475f5e_238","name":"602a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PswRdInfo64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_239":{"__typename":"Paragraph","id":"109369475f5e_239","name":"444a","type":"H3","href":null,"layout":null,"metadata":null,"text":"ADRecon","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_240":{"__typename":"Paragraph","id":"109369475f5e_240","name":"b1c5","type":"P","href":null,"layout":null,"metadata":null,"text":"The ADRecon.ps1 file is a tool for generating reports that contain information from Active Directory. Read more about ADRecon project on GitHub. Note that this plugin is not developed by FIN7, however, it is actively used by the group in its attacks.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":118,"end":143,"href":"https:\u002F\u002Fgithub.com\u002Fsense-of-security\u002FADRecon","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_241":{"__typename":"Paragraph","id":"109369475f5e_241","name":"d810","type":"H3","href":null,"layout":null,"metadata":null,"text":"GetHash32\u002FGetHash64","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_242":{"__typename":"Paragraph","id":"109369475f5e_242","name":"a7db","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is designed to retrieve user NTLM\u002FLM hashes. The plugin is based on the code of the lsadump component from Mimikatz.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":95,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":95,"end":102,"href":"https:\u002F\u002Fgithub.com\u002Fgentilkiwi\u002Fmimikatz\u002Fblob\u002Fmaster\u002Fmimikatz\u002Fmodules\u002Fkuhl_m_lsadump.c","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_243":{"__typename":"Paragraph","id":"109369475f5e_243","name":"d711","type":"P","href":null,"layout":null,"metadata":null,"text":"Fig. 32 shows a screenshot with pseudocode of exported Entry function (function names are chosen according to Mimikatz function names).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":55,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8t396KNdkHPH7ALqbKt6Xw.png":{"__typename":"ImageMetadata","id":"1*8t396KNdkHPH7ALqbKt6Xw.png","originalHeight":687,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_244":{"__typename":"Paragraph","id":"109369475f5e_244","name":"d31b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8t396KNdkHPH7ALqbKt6Xw.png"},"text":"Figure 32. Pseudocode of the exported Entry function for the GetHash plugin","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":38,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_245":{"__typename":"Paragraph","id":"109369475f5e_245","name":"4c1d","type":"P","href":null,"layout":null,"metadata":null,"text":"The return value of the Execute function (value of the g_outputBuffer variable) contains a pointer to the buffer with data resulting from the plugin's operation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":24,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":55,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_246":{"__typename":"Paragraph","id":"109369475f5e_246","name":"0440","type":"P","href":null,"layout":null,"metadata":null,"text":"If the plugin fails to start with SYSTEM permissions, it will fill the buffer with the data shown in Fig. 33.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":34,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XmyS2gbxR5F3ARbad762MA.png":{"__typename":"ImageMetadata","id":"1*XmyS2gbxR5F3ARbad762MA.png","originalHeight":109,"originalWidth":680,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_247":{"__typename":"Paragraph","id":"109369475f5e_247","name":"7eac","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XmyS2gbxR5F3ARbad762MA.png"},"text":"Figure 33. Buffer contents when running the plugin without SYSTEM permissions","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":59,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_248":{"__typename":"Paragraph","id":"109369475f5e_248","name":"79fa","type":"P","href":null,"layout":null,"metadata":null,"text":"The contents of the buffer in this case are similar to the output of mimikatz when running the module lsadump::sam without SYSTEM permissions (Fig. 34).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":102,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":123,"end":129,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kKX1AlZxmX2BKf0CckxSxA.png":{"__typename":"ImageMetadata","id":"1*kKX1AlZxmX2BKf0CckxSxA.png","originalHeight":178,"originalWidth":703,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_249":{"__typename":"Paragraph","id":"109369475f5e_249","name":"ad69","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kKX1AlZxmX2BKf0CckxSxA.png"},"text":"Figure 34. Mimikatz output when running lsadump::sam without SYSTEM permissions","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":40,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":61,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_250":{"__typename":"Paragraph","id":"109369475f5e_250","name":"fcf5","type":"P","href":null,"layout":null,"metadata":null,"text":"If the plugin is run with SYSTEM permissions, it will put all the information the attacker is looking for into the buffer (Fig. 35).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":26,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0HHo0Hr4vgy2KUWTEwh6_Q.png":{"__typename":"ImageMetadata","id":"1*0HHo0Hr4vgy2KUWTEwh6_Q.png","originalHeight":392,"originalWidth":684,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_251":{"__typename":"Paragraph","id":"109369475f5e_251","name":"8c22","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0HHo0Hr4vgy2KUWTEwh6_Q.png"},"text":"Figure 35. Buffer contents when running the plugin with SYSTEM permissions","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":56,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_252":{"__typename":"Paragraph","id":"109369475f5e_252","name":"ded3","type":"P","href":null,"layout":null,"metadata":null,"text":"The same data can be retrieved by running lsadump::sam from mimikatz with SYSTEM permissions (Fig. 36).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":42,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":74,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*92Zvzj8bXGp4QKLhmKuyTw.png":{"__typename":"ImageMetadata","id":"1*92Zvzj8bXGp4QKLhmKuyTw.png","originalHeight":535,"originalWidth":960,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_253":{"__typename":"Paragraph","id":"109369475f5e_253","name":"7d55","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*92Zvzj8bXGp4QKLhmKuyTw.png"},"text":"Figure 36. Result of lsadump::sam command from mimikatz with SYSTEM permissions","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":21,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":61,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_254":{"__typename":"Paragraph","id":"109369475f5e_254","name":"65b7","type":"H3","href":null,"layout":null,"metadata":null,"text":"GetPass32\u002FGetPass64","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_255":{"__typename":"Paragraph","id":"109369475f5e_255","name":"3922","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is designed to retrieve user passwords. It is based on the code of the sekurlsa component from Mimikatz. The pseudocode of the exported Entry function is shown in Fig. 37.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":82,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":147,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":82,"end":90,"href":"https:\u002F\u002Fgithub.com\u002Fgentilkiwi\u002Fmimikatz\u002Fwiki\u002Fmodule-~-sekurlsa","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kP8KKCN68VTJWDAFHWfGrQ.png":{"__typename":"ImageMetadata","id":"1*kP8KKCN68VTJWDAFHWfGrQ.png","originalHeight":455,"originalWidth":881,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_256":{"__typename":"Paragraph","id":"109369475f5e_256","name":"17d8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kP8KKCN68VTJWDAFHWfGrQ.png"},"text":"Figure 37. Exportable Entry function pseudocode","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":22,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_257":{"__typename":"Paragraph","id":"109369475f5e_257","name":"c51c","type":"P","href":null,"layout":null,"metadata":null,"text":"Based on the plugin’s results, we will see in the value of the g_outputBuffer variable a pointer to the data buffer that can be retrieved by executing the sekurlsa::logonpasswords command in Mimikatz (Fig. 38).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":63,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":155,"end":179,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xQH6eqG7yN8aBn77-IipTQ.png":{"__typename":"ImageMetadata","id":"1*xQH6eqG7yN8aBn77-IipTQ.png","originalHeight":527,"originalWidth":695,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_258":{"__typename":"Paragraph","id":"109369475f5e_258","name":"bc22","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xQH6eqG7yN8aBn77-IipTQ.png"},"text":"Figure 38. Result of the sekurlsa::logonpasswords command","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":25,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_259":{"__typename":"Paragraph","id":"109369475f5e_259","name":"ff3b","type":"H3","href":null,"layout":null,"metadata":null,"text":"powerkatz_full32\u002Fpowerkatz_full64","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_260":{"__typename":"Paragraph","id":"109369475f5e_260","name":"7af2","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin is a Mimikatz version compiled in the Second_Release_PowerShell configuration. This version can be loaded into the address space of a PowerShell process via reflective DLL loading as implemented in the Exfiltration module of PowerSploit.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":213,"end":225,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":49,"end":74,"href":"https:\u002F\u002Fgithub.com\u002Fgentilkiwi\u002Fmimikatz\u002Fblob\u002Fmaster\u002Fmimikatz.sln#L95","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":236,"end":247,"href":"https:\u002F\u002Fgithub.com\u002FPowerShellMafia\u002FPowerSploit\u002Fblob\u002Fmaster\u002FExfiltration\u002FInvoke-Mimikatz.ps1","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_261":{"__typename":"Paragraph","id":"109369475f5e_261","name":"e9ec","type":"P","href":null,"layout":null,"metadata":null,"text":"Pseudocode of the exported powershell_reflective_mimikatz function (variable and function names in the decompiled output are changed to match the names of the corresponding variables and functions from Mimikatz):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":27,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:e35f1ce593006ae2ef09468783c9d2ca":{"__typename":"MediaResource","id":"e35f1ce593006ae2ef09468783c9d2ca","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"powershell_reflective_mimikatz.cpp"},"Paragraph:109369475f5e_262":{"__typename":"Paragraph","id":"109369475f5e_262","name":"f11a","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:e35f1ce593006ae2ef09468783c9d2ca"}},"mixtapeMetadata":null},"Paragraph:109369475f5e_263":{"__typename":"Paragraph","id":"109369475f5e_263","name":"588d","type":"P","href":null,"layout":null,"metadata":null,"text":"The input parameter is used to pass a list of commands, separated by a space. The global variable outputBuffer is used to pass the result of the commands. The decompiled view of the wmain function is shown below:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":98,"end":110,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":182,"end":187,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:76241a753a78a1d1119d423552f3e2cb":{"__typename":"MediaResource","id":"76241a753a78a1d1119d423552f3e2cb","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"wmain.cpp"},"Paragraph:109369475f5e_264":{"__typename":"Paragraph","id":"109369475f5e_264","name":"6deb","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:76241a753a78a1d1119d423552f3e2cb"}},"mixtapeMetadata":null},"Paragraph:109369475f5e_265":{"__typename":"Paragraph","id":"109369475f5e_265","name":"970d","type":"H3","href":null,"layout":null,"metadata":null,"text":"powerkatz_short32\u002Fpowerkatz_short64","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_266":{"__typename":"Paragraph","id":"109369475f5e_266","name":"02e6","type":"P","href":null,"layout":null,"metadata":null,"text":"The powerkatz_short plugin is a modified version of the standard powerkatz library described in the previous paragraph.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":65,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_267":{"__typename":"Paragraph","id":"109369475f5e_267","name":"2502","type":"P","href":null,"layout":null,"metadata":null,"text":"A list of powerkatz functions that are absent from powerkatz_short:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":51,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_268":{"__typename":"Paragraph","id":"109369475f5e_268","name":"33d3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_acr_clean;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_269":{"__typename":"Paragraph","id":"109369475f5e_269","name":"b3c0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_busylight_clean;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_270":{"__typename":"Paragraph","id":"109369475f5e_270","name":"1b19","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_c_rpc_clean;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_271":{"__typename":"Paragraph","id":"109369475f5e_271","name":"b91d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_c_rpc_init;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_272":{"__typename":"Paragraph","id":"109369475f5e_272","name":"578d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_c_service_clean;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_273":{"__typename":"Paragraph","id":"109369475f5e_273","name":"6439","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_crypto_clean;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_274":{"__typename":"Paragraph","id":"109369475f5e_274","name":"6049","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_crypto_init;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_275":{"__typename":"Paragraph","id":"109369475f5e_275","name":"7a55","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_kerberos_clean;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_276":{"__typename":"Paragraph","id":"109369475f5e_276","name":"5cf1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_kerberos_init;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_277":{"__typename":"Paragraph","id":"109369475f5e_277","name":"9a96","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_vault_clean;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_278":{"__typename":"Paragraph","id":"109369475f5e_278","name":"2258","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kuhl_m_vault_init;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_279":{"__typename":"Paragraph","id":"109369475f5e_279","name":"3b21","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kull_m_busylight_devices_get;","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_280":{"__typename":"Paragraph","id":"109369475f5e_280","name":"3005","type":"ULI","href":null,"layout":null,"metadata":null,"text":"kull_m_busylight_keepAliveThread.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_281":{"__typename":"Paragraph","id":"109369475f5e_281","name":"1bd6","type":"H3","href":null,"layout":null,"metadata":null,"text":"PswInfoGrabber32.dll\u002FPswInfoGrabber64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_282":{"__typename":"Paragraph","id":"109369475f5e_282","name":"04ba","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin can retrieve the following data:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_283":{"__typename":"Paragraph","id":"109369475f5e_283","name":"fabf","type":"ULI","href":null,"layout":null,"metadata":null,"text":"browser history from Firefox, Google Chrome, Microsoft Edge and Internet Explorer;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_284":{"__typename":"Paragraph","id":"109369475f5e_284","name":"aff8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"usernames and passwords stored in the listed browsers;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_285":{"__typename":"Paragraph","id":"109369475f5e_285","name":"b630","type":"ULI","href":null,"layout":null,"metadata":null,"text":"email accounts from Microsoft Outlook and Mozilla Thunderbird.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_286":{"__typename":"Paragraph","id":"109369475f5e_286","name":"008e","type":"P","href":null,"layout":null,"metadata":null,"text":"The nss3.dll library is used to retrieve sensitive data from the Firefox browser and is loaded from the directory with the installed browser (Fig. 39).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*WPdG6iifPFCad9Ap8Dgk5w.png":{"__typename":"ImageMetadata","id":"1*WPdG6iifPFCad9Ap8Dgk5w.png","originalHeight":524,"originalWidth":975,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:109369475f5e_287":{"__typename":"Paragraph","id":"109369475f5e_287","name":"5717","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*WPdG6iifPFCad9Ap8Dgk5w.png"},"text":"Figure 39. Dynamic retrieval of function addresses from nss3.dll library","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":56,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_288":{"__typename":"Paragraph","id":"109369475f5e_288","name":"425f","type":"P","href":null,"layout":null,"metadata":null,"text":"Using the functions shown in Fig. 38, the credentials are retrieved from the logins.json file and the browser history is retrieved from the places.sqlite database.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":77,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":140,"end":153,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_289":{"__typename":"Paragraph","id":"109369475f5e_289","name":"45fc","type":"P","href":null,"layout":null,"metadata":null,"text":"In relation to Google Chrome, the plugin retrieves browser history from %LOCALAPPDATA%\\Google\\Chrome\\User Data\\Default\\History and passwords from %LOCALAPPDATA%\\Google\\Chrome\\User Data\\Default\\Login Data (data encrypted using DPAPI).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":72,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":146,"end":203,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_290":{"__typename":"Paragraph","id":"109369475f5e_290","name":"c734","type":"P","href":null,"layout":null,"metadata":null,"text":"History, places.sqlite, Login Data are all sqlite3 database files. To work with sqlite3 databases the plugin uses functions from the sqlite library, statically linked with the resulting DLL, i.e. the plugin itself.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":9,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":24,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":43,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":80,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":133,"end":139,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_291":{"__typename":"Paragraph","id":"109369475f5e_291","name":"e276","type":"P","href":null,"layout":null,"metadata":null,"text":"For Internet Explorer and Microsoft Edge browsers, the plugin retrieves user credentials using functions from the vaultcli.dll library that implements the functions of the vaultcmd.exe utility.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":114,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":172,"end":184,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_292":{"__typename":"Paragraph","id":"109369475f5e_292","name":"d2ee","type":"H3","href":null,"layout":null,"metadata":null,"text":"PswRdInfo64.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_293":{"__typename":"Paragraph","id":"109369475f5e_293","name":"f542","type":"P","href":null,"layout":null,"metadata":null,"text":"PswRdInfo64.dll is designed primarily to collect domain credentials and retrieve credentials for accessing other hosts via RDP. The plugin is activated from the client application using the Grabber → RDP tab.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":190,"end":203,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_294":{"__typename":"Paragraph","id":"109369475f5e_294","name":"e2d1","type":"P","href":null,"layout":null,"metadata":null,"text":"The workflow of the plugin depends on the following conditions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_295":{"__typename":"Paragraph","id":"109369475f5e_295","name":"3fc1","type":"P","href":null,"layout":null,"metadata":null,"text":"When started from SYSTEM, the plugin lists all active console sessions (WTSGetActiveConsoleSessionId) and gets user names for these sessions:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":72,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_296":{"__typename":"Paragraph","id":"109369475f5e_296","name":"9595","type":"PRE","href":null,"layout":null,"metadata":null,"text":"(WTSQuerySessionInformationW)(0i64, SessionId, WTSUserName, &vpSessionInformationUserName, &pBytesReturned))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_297":{"__typename":"Paragraph","id":"109369475f5e_297","name":"edf3","type":"P","href":null,"layout":null,"metadata":null,"text":"The plugin then retrieves the private keys from the C:\\Users\\{SessionInformationUserName}AppData\\Local\\Microsoft\\Credentials directory for each user and injects itself into the lsass.exe process to extract domain credentials.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":52,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":177,"end":186,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_298":{"__typename":"Paragraph","id":"109369475f5e_298","name":"dddf","type":"P","href":null,"layout":null,"metadata":null,"text":"When started by another user (other than SYSTEM), the plugin attempts to collect credentials for RDP access to other hosts. Credentials are collected using CredEnumerateW function, with the TERMSRV string as the target.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":41,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":156,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":190,"end":197,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_299":{"__typename":"Paragraph","id":"109369475f5e_299","name":"2663","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_300":{"__typename":"Paragraph","id":"109369475f5e_300","name":"162f","type":"P","href":null,"layout":null,"metadata":null,"text":"As the analysis shows, Lizar is a diverse and complex toolkit. It is currently still under active development and testing, yet it is already being widely used to control infected computers, mostly throughout the United States.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_301":{"__typename":"Paragraph","id":"109369475f5e_301","name":"ef4d","type":"P","href":null,"layout":null,"metadata":null,"text":"However, it seems that FIN7 are not looking to stop there, and we will soon be hearing about more Lizar-enabled attacks from around the world.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_302":{"__typename":"Paragraph","id":"109369475f5e_302","name":"f22e","type":"H3","href":null,"layout":null,"metadata":null,"text":"IoC","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_303":{"__typename":"Paragraph","id":"109369475f5e_303","name":"d4a4","type":"P","href":null,"layout":null,"metadata":null,"text":"IP:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_304":{"__typename":"Paragraph","id":"109369475f5e_304","name":"db58","type":"PRE","href":null,"layout":null,"metadata":null,"text":"108.61.148.97\n136.244.81.250\n185.33.84.43\n195.123.214.181\n31.192.108.133\n45.133.203.121","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_305":{"__typename":"Paragraph","id":"109369475f5e_305","name":"0d6e","type":"P","href":null,"layout":null,"metadata":null,"text":"SHA256:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:109369475f5e_306":{"__typename":"Paragraph","id":"109369475f5e_306","name":"4883","type":"PRE","href":null,"layout":null,"metadata":null,"text":"166b0c5e49c44f87886ecaad46e60b496b6b7512d1c57db41d9cf752fada95c8\n188d76c31fa7f500799762237508203bdd1927ec4d5232cc189d46bc76b7a30d\n1e5514e8f95dcf6dd7289acef6f6b88c460105660cb0c5b86ec7b854f70ee857\n21850bb5d8df021e850e740c1899353f40af72f119f2cd71ad234e91c2ccb772\n3b63eb184bea5b6515697ae3f13a57365f04e6a3309c79b18773291e62a64fcb\n4d933b6b60a097ad5ce5876a66c569e6f46707b934ebd3c442432711af195124\n515b94290111b7be80e001bfa2335d2f494937c8619cfdaafb2077d9d6af06fe\n61cfe83259640df9f19df2be4b67bb1c6e5816ac52b8a5a02ee8b79bde4b2b70\nfbd2d816147112bd408e26b1300775bbaa482342f9b33924d93fd71a5c312cce\na3b3f56a61c6dc8ba2aa25bdd9bd7dc2c5a4602c2670431c5cbc59a76e2b4c54\ne908f99c6753a56440127e54ce990adbc5128d10edc11622d548ddd67e6662ac\n7d48362091d710935726ab4d32bf594b363683e8335f1ee70ae2ae81f4ee36ca\ne894dedb4658e006c8a85f02fa5bbab7ecd234331b92be41ab708fa22a246e25\nb8691a33aa99af0f0c1a86321b70437efcf358ace1cf3f91e4cb8793228d1a62\nbd1e5ea9556cb6cba9a509eab8442bf37ca40006c0894c5a98ce77f6d84b03c7\n98fbccd9c2e925d2f7b8bcfa247790a681497dfb9f7f8745c0327c43db10952f\n552c00bb5fd5f10b105ca247b0a78082bd6a63e2bab590040788e52634f96d11\n21db55edc9df9e096fc994972498cbd9da128f8f3959a462d04091634a569a96","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":1169,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"PostViewerEdge:postId:c23c9a75e319-viewerId:lo_95eadd6cc6c1":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:c23c9a75e319-viewerId:lo_95eadd6cc6c1"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Tag:fin7":{"__typename":"Tag","id":"fin7","displayTitle":"Fin7","normalizedTagSlug":"fin7"},"Tag:carbanak":{"__typename":"Tag","id":"carbanak","displayTitle":"Carbanak","normalizedTagSlug":"carbanak"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Post:c23c9a75e319":{"__typename":"Post","id":"c23c9a75e319","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"ae64","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:109369475f5e_0"},{"__ref":"Paragraph:109369475f5e_1"},{"__ref":"Paragraph:109369475f5e_2"},{"__ref":"Paragraph:109369475f5e_3"},{"__ref":"Paragraph:109369475f5e_4"},{"__ref":"Paragraph:109369475f5e_5"},{"__ref":"Paragraph:109369475f5e_6"},{"__ref":"Paragraph:109369475f5e_7"},{"__ref":"Paragraph:109369475f5e_8"},{"__ref":"Paragraph:109369475f5e_9"},{"__ref":"Paragraph:109369475f5e_10"},{"__ref":"Paragraph:109369475f5e_11"},{"__ref":"Paragraph:109369475f5e_12"},{"__ref":"Paragraph:109369475f5e_13"},{"__ref":"Paragraph:109369475f5e_14"},{"__ref":"Paragraph:109369475f5e_15"},{"__ref":"Paragraph:109369475f5e_16"},{"__ref":"Paragraph:109369475f5e_17"},{"__ref":"Paragraph:109369475f5e_18"},{"__ref":"Paragraph:109369475f5e_19"},{"__ref":"Paragraph:109369475f5e_20"},{"__ref":"Paragraph:109369475f5e_21"},{"__ref":"Paragraph:109369475f5e_22"},{"__ref":"Paragraph:109369475f5e_23"},{"__ref":"Paragraph:109369475f5e_24"},{"__ref":"Paragraph:109369475f5e_25"},{"__ref":"Paragraph:109369475f5e_26"},{"__ref":"Paragraph:109369475f5e_27"},{"__ref":"Paragraph:109369475f5e_28"},{"__ref":"Paragraph:109369475f5e_29"},{"__ref":"Paragraph:109369475f5e_30"},{"__ref":"Paragraph:109369475f5e_31"},{"__ref":"Paragraph:109369475f5e_32"},{"__ref":"Paragraph:109369475f5e_33"},{"__ref":"Paragraph:109369475f5e_34"},{"__ref":"Paragraph:109369475f5e_35"},{"__ref":"Paragraph:109369475f5e_36"},{"__ref":"Paragraph:109369475f5e_37"},{"__ref":"Paragraph:109369475f5e_38"},{"__ref":"Paragraph:109369475f5e_39"},{"__ref":"Paragraph:109369475f5e_40"},{"__ref":"Paragraph:109369475f5e_41"},{"__ref":"Paragraph:109369475f5e_42"},{"__ref":"Paragraph:109369475f5e_43"},{"__ref":"Paragraph:109369475f5e_44"},{"__ref":"Paragraph:109369475f5e_45"},{"__ref":"Paragraph:109369475f5e_46"},{"__ref":"Paragraph:109369475f5e_47"},{"__ref":"Paragraph:109369475f5e_48"},{"__ref":"Paragraph:109369475f5e_49"},{"__ref":"Paragraph:109369475f5e_50"},{"__ref":"Paragraph:109369475f5e_51"},{"__ref":"Paragraph:109369475f5e_52"},{"__ref":"Paragraph:109369475f5e_53"},{"__ref":"Paragraph:109369475f5e_54"},{"__ref":"Paragraph:109369475f5e_55"},{"__ref":"Paragraph:109369475f5e_56"},{"__ref":"Paragraph:109369475f5e_57"},{"__ref":"Paragraph:109369475f5e_58"},{"__ref":"Paragraph:109369475f5e_59"},{"__ref":"Paragraph:109369475f5e_60"},{"__ref":"Paragraph:109369475f5e_61"},{"__ref":"Paragraph:109369475f5e_62"},{"__ref":"Paragraph:109369475f5e_63"},{"__ref":"Paragraph:109369475f5e_64"},{"__ref":"Paragraph:109369475f5e_65"},{"__ref":"Paragraph:109369475f5e_66"},{"__ref":"Paragraph:109369475f5e_67"},{"__ref":"Paragraph:109369475f5e_68"},{"__ref":"Paragraph:109369475f5e_69"},{"__ref":"Paragraph:109369475f5e_70"},{"__ref":"Paragraph:109369475f5e_71"},{"__ref":"Paragraph:109369475f5e_72"},{"__ref":"Paragraph:109369475f5e_73"},{"__ref":"Paragraph:109369475f5e_74"},{"__ref":"Paragraph:109369475f5e_75"},{"__ref":"Paragraph:109369475f5e_76"},{"__ref":"Paragraph:109369475f5e_77"},{"__ref":"Paragraph:109369475f5e_78"},{"__ref":"Paragraph:109369475f5e_79"},{"__ref":"Paragraph:109369475f5e_80"},{"__ref":"Paragraph:109369475f5e_81"},{"__ref":"Paragraph:109369475f5e_82"},{"__ref":"Paragraph:109369475f5e_83"},{"__ref":"Paragraph:109369475f5e_84"},{"__ref":"Paragraph:109369475f5e_85"},{"__ref":"Paragraph:109369475f5e_86"},{"__ref":"Paragraph:109369475f5e_87"},{"__ref":"Paragraph:109369475f5e_88"},{"__ref":"Paragraph:109369475f5e_89"},{"__ref":"Paragraph:109369475f5e_90"},{"__ref":"Paragraph:109369475f5e_91"},{"__ref":"Paragraph:109369475f5e_92"},{"__ref":"Paragraph:109369475f5e_93"},{"__ref":"Paragraph:109369475f5e_94"},{"__ref":"Paragraph:109369475f5e_95"},{"__ref":"Paragraph:109369475f5e_96"},{"__ref":"Paragraph:109369475f5e_97"},{"__ref":"Paragraph:109369475f5e_98"},{"__ref":"Paragraph:109369475f5e_99"},{"__ref":"Paragraph:109369475f5e_100"},{"__ref":"Paragraph:109369475f5e_101"},{"__ref":"Paragraph:109369475f5e_102"},{"__ref":"Paragraph:109369475f5e_103"},{"__ref":"Paragraph:109369475f5e_104"},{"__ref":"Paragraph:109369475f5e_105"},{"__ref":"Paragraph:109369475f5e_106"},{"__ref":"Paragraph:109369475f5e_107"},{"__ref":"Paragraph:109369475f5e_108"},{"__ref":"Paragraph:109369475f5e_109"},{"__ref":"Paragraph:109369475f5e_110"},{"__ref":"Paragraph:109369475f5e_111"},{"__ref":"Paragraph:109369475f5e_112"},{"__ref":"Paragraph:109369475f5e_113"},{"__ref":"Paragraph:109369475f5e_114"},{"__ref":"Paragraph:109369475f5e_115"},{"__ref":"Paragraph:109369475f5e_116"},{"__ref":"Paragraph:109369475f5e_117"},{"__ref":"Paragraph:109369475f5e_118"},{"__ref":"Paragraph:109369475f5e_119"},{"__ref":"Paragraph:109369475f5e_120"},{"__ref":"Paragraph:109369475f5e_121"},{"__ref":"Paragraph:109369475f5e_122"},{"__ref":"Paragraph:109369475f5e_123"},{"__ref":"Paragraph:109369475f5e_124"},{"__ref":"Paragraph:109369475f5e_125"},{"__ref":"Paragraph:109369475f5e_126"},{"__ref":"Paragraph:109369475f5e_127"},{"__ref":"Paragraph:109369475f5e_128"},{"__ref":"Paragraph:109369475f5e_129"},{"__ref":"Paragraph:109369475f5e_130"},{"__ref":"Paragraph:109369475f5e_131"},{"__ref":"Paragraph:109369475f5e_132"},{"__ref":"Paragraph:109369475f5e_133"},{"__ref":"Paragraph:109369475f5e_134"},{"__ref":"Paragraph:109369475f5e_135"},{"__ref":"Paragraph:109369475f5e_136"},{"__ref":"Paragraph:109369475f5e_137"},{"__ref":"Paragraph:109369475f5e_138"},{"__ref":"Paragraph:109369475f5e_139"},{"__ref":"Paragraph:109369475f5e_140"},{"__ref":"Paragraph:109369475f5e_141"},{"__ref":"Paragraph:109369475f5e_142"},{"__ref":"Paragraph:109369475f5e_143"},{"__ref":"Paragraph:109369475f5e_144"},{"__ref":"Paragraph:109369475f5e_145"},{"__ref":"Paragraph:109369475f5e_146"},{"__ref":"Paragraph:109369475f5e_147"},{"__ref":"Paragraph:109369475f5e_148"},{"__ref":"Paragraph:109369475f5e_149"},{"__ref":"Paragraph:109369475f5e_150"},{"__ref":"Paragraph:109369475f5e_151"},{"__ref":"Paragraph:109369475f5e_152"},{"__ref":"Paragraph:109369475f5e_153"},{"__ref":"Paragraph:109369475f5e_154"},{"__ref":"Paragraph:109369475f5e_155"},{"__ref":"Paragraph:109369475f5e_156"},{"__ref":"Paragraph:109369475f5e_157"},{"__ref":"Paragraph:109369475f5e_158"},{"__ref":"Paragraph:109369475f5e_159"},{"__ref":"Paragraph:109369475f5e_160"},{"__ref":"Paragraph:109369475f5e_161"},{"__ref":"Paragraph:109369475f5e_162"},{"__ref":"Paragraph:109369475f5e_163"},{"__ref":"Paragraph:109369475f5e_164"},{"__ref":"Paragraph:109369475f5e_165"},{"__ref":"Paragraph:109369475f5e_166"},{"__ref":"Paragraph:109369475f5e_167"},{"__ref":"Paragraph:109369475f5e_168"},{"__ref":"Paragraph:109369475f5e_169"},{"__ref":"Paragraph:109369475f5e_170"},{"__ref":"Paragraph:109369475f5e_171"},{"__ref":"Paragraph:109369475f5e_172"},{"__ref":"Paragraph:109369475f5e_173"},{"__ref":"Paragraph:109369475f5e_174"},{"__ref":"Paragraph:109369475f5e_175"},{"__ref":"Paragraph:109369475f5e_176"},{"__ref":"Paragraph:109369475f5e_177"},{"__ref":"Paragraph:109369475f5e_178"},{"__ref":"Paragraph:109369475f5e_179"},{"__ref":"Paragraph:109369475f5e_180"},{"__ref":"Paragraph:109369475f5e_181"},{"__ref":"Paragraph:109369475f5e_182"},{"__ref":"Paragraph:109369475f5e_183"},{"__ref":"Paragraph:109369475f5e_184"},{"__ref":"Paragraph:109369475f5e_185"},{"__ref":"Paragraph:109369475f5e_186"},{"__ref":"Paragraph:109369475f5e_187"},{"__ref":"Paragraph:109369475f5e_188"},{"__ref":"Paragraph:109369475f5e_189"},{"__ref":"Paragraph:109369475f5e_190"},{"__ref":"Paragraph:109369475f5e_191"},{"__ref":"Paragraph:109369475f5e_192"},{"__ref":"Paragraph:109369475f5e_193"},{"__ref":"Paragraph:109369475f5e_194"},{"__ref":"Paragraph:109369475f5e_195"},{"__ref":"Paragraph:109369475f5e_196"},{"__ref":"Paragraph:109369475f5e_197"},{"__ref":"Paragraph:109369475f5e_198"},{"__ref":"Paragraph:109369475f5e_199"},{"__ref":"Paragraph:109369475f5e_200"},{"__ref":"Paragraph:109369475f5e_201"},{"__ref":"Paragraph:109369475f5e_202"},{"__ref":"Paragraph:109369475f5e_203"},{"__ref":"Paragraph:109369475f5e_204"},{"__ref":"Paragraph:109369475f5e_205"},{"__ref":"Paragraph:109369475f5e_206"},{"__ref":"Paragraph:109369475f5e_207"},{"__ref":"Paragraph:109369475f5e_208"},{"__ref":"Paragraph:109369475f5e_209"},{"__ref":"Paragraph:109369475f5e_210"},{"__ref":"Paragraph:109369475f5e_211"},{"__ref":"Paragraph:109369475f5e_212"},{"__ref":"Paragraph:109369475f5e_213"},{"__ref":"Paragraph:109369475f5e_214"},{"__ref":"Paragraph:109369475f5e_215"},{"__ref":"Paragraph:109369475f5e_216"},{"__ref":"Paragraph:109369475f5e_217"},{"__ref":"Paragraph:109369475f5e_218"},{"__ref":"Paragraph:109369475f5e_219"},{"__ref":"Paragraph:109369475f5e_220"},{"__ref":"Paragraph:109369475f5e_221"},{"__ref":"Paragraph:109369475f5e_222"},{"__ref":"Paragraph:109369475f5e_223"},{"__ref":"Paragraph:109369475f5e_224"},{"__ref":"Paragraph:109369475f5e_225"},{"__ref":"Paragraph:109369475f5e_226"},{"__ref":"Paragraph:109369475f5e_227"},{"__ref":"Paragraph:109369475f5e_228"},{"__ref":"Paragraph:109369475f5e_229"},{"__ref":"Paragraph:109369475f5e_230"},{"__ref":"Paragraph:109369475f5e_231"},{"__ref":"Paragraph:109369475f5e_232"},{"__ref":"Paragraph:109369475f5e_233"},{"__ref":"Paragraph:109369475f5e_234"},{"__ref":"Paragraph:109369475f5e_235"},{"__ref":"Paragraph:109369475f5e_236"},{"__ref":"Paragraph:109369475f5e_237"},{"__ref":"Paragraph:109369475f5e_238"},{"__ref":"Paragraph:109369475f5e_239"},{"__ref":"Paragraph:109369475f5e_240"},{"__ref":"Paragraph:109369475f5e_241"},{"__ref":"Paragraph:109369475f5e_242"},{"__ref":"Paragraph:109369475f5e_243"},{"__ref":"Paragraph:109369475f5e_244"},{"__ref":"Paragraph:109369475f5e_245"},{"__ref":"Paragraph:109369475f5e_246"},{"__ref":"Paragraph:109369475f5e_247"},{"__ref":"Paragraph:109369475f5e_248"},{"__ref":"Paragraph:109369475f5e_249"},{"__ref":"Paragraph:109369475f5e_250"},{"__ref":"Paragraph:109369475f5e_251"},{"__ref":"Paragraph:109369475f5e_252"},{"__ref":"Paragraph:109369475f5e_253"},{"__ref":"Paragraph:109369475f5e_254"},{"__ref":"Paragraph:109369475f5e_255"},{"__ref":"Paragraph:109369475f5e_256"},{"__ref":"Paragraph:109369475f5e_257"},{"__ref":"Paragraph:109369475f5e_258"},{"__ref":"Paragraph:109369475f5e_259"},{"__ref":"Paragraph:109369475f5e_260"},{"__ref":"Paragraph:109369475f5e_261"},{"__ref":"Paragraph:109369475f5e_262"},{"__ref":"Paragraph:109369475f5e_263"},{"__ref":"Paragraph:109369475f5e_264"},{"__ref":"Paragraph:109369475f5e_265"},{"__ref":"Paragraph:109369475f5e_266"},{"__ref":"Paragraph:109369475f5e_267"},{"__ref":"Paragraph:109369475f5e_268"},{"__ref":"Paragraph:109369475f5e_269"},{"__ref":"Paragraph:109369475f5e_270"},{"__ref":"Paragraph:109369475f5e_271"},{"__ref":"Paragraph:109369475f5e_272"},{"__ref":"Paragraph:109369475f5e_273"},{"__ref":"Paragraph:109369475f5e_274"},{"__ref":"Paragraph:109369475f5e_275"},{"__ref":"Paragraph:109369475f5e_276"},{"__ref":"Paragraph:109369475f5e_277"},{"__ref":"Paragraph:109369475f5e_278"},{"__ref":"Paragraph:109369475f5e_279"},{"__ref":"Paragraph:109369475f5e_280"},{"__ref":"Paragraph:109369475f5e_281"},{"__ref":"Paragraph:109369475f5e_282"},{"__ref":"Paragraph:109369475f5e_283"},{"__ref":"Paragraph:109369475f5e_284"},{"__ref":"Paragraph:109369475f5e_285"},{"__ref":"Paragraph:109369475f5e_286"},{"__ref":"Paragraph:109369475f5e_287"},{"__ref":"Paragraph:109369475f5e_288"},{"__ref":"Paragraph:109369475f5e_289"},{"__ref":"Paragraph:109369475f5e_290"},{"__ref":"Paragraph:109369475f5e_291"},{"__ref":"Paragraph:109369475f5e_292"},{"__ref":"Paragraph:109369475f5e_293"},{"__ref":"Paragraph:109369475f5e_294"},{"__ref":"Paragraph:109369475f5e_295"},{"__ref":"Paragraph:109369475f5e_296"},{"__ref":"Paragraph:109369475f5e_297"},{"__ref":"Paragraph:109369475f5e_298"},{"__ref":"Paragraph:109369475f5e_299"},{"__ref":"Paragraph:109369475f5e_300"},{"__ref":"Paragraph:109369475f5e_301"},{"__ref":"Paragraph:109369475f5e_302"},{"__ref":"Paragraph:109369475f5e_303"},{"__ref":"Paragraph:109369475f5e_304"},{"__ref":"Paragraph:109369475f5e_305"},{"__ref":"Paragraph:109369475f5e_306"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3882bedad280"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fbi-zone.medium.com\u002Ffrom-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319","primaryTopic":null,"topics":[],"isPublished":true,"latestPublishedVersion":"109369475f5e","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":31,"allowResponses":true,"isLimitedState":false,"title":"From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s…","isSeries":false,"sequence":null,"uniqueSlug":"from-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1620895065935,"readingTime":16.50188679245283,"previewContent":{"__typename":"PreviewContent","subtitle":"The article was prepared by BI.ZONE Cyber Threats Research Team"},"previewImage":{"__ref":"ImageMetadata:1*taUQbk4kjpJNmaXX-GBdpw.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1620895065935,"updatedAt":1641499537166,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:c23c9a75e319-viewerId:lo_95eadd6cc6c1"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:reverse-engineering"},{"__ref":"Tag:fin7"},{"__ref":"Tag:carbanak"},{"__ref":"Tag:malware-analysis"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":3578,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7e50e797.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.018e7ca9.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ae4dd3e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.598cb8b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.d10c9ba0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.55c925ce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.4d7a2738.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.563d0db5.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8d75d2ce4bb7e013',t:'MTcyOTcyOTQ2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>