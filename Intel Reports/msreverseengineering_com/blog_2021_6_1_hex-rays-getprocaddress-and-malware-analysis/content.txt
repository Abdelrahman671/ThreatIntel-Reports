<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US" >

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  
  <meta name="viewport" content="initial-scale=1">
  
  <!-- This is Squarespace. --><!-- rolf-rolles-bq5a -->
<base href="">
<meta charset="utf-8" />
<title>Hex-Rays, GetProcAddress, and Malware Analysis &mdash; Möbius Strip Reverse Engineering</title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model" /><link rel="icon" type="image/x-icon" href="https://assets.squarespace.com/universal/default-favicon.ico"/>
<link rel="canonical" href="https://www.msreverseengineering.com/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis"/>
<meta property="og:site_name" content="Möbius Strip Reverse Engineering"/>
<meta property="og:title" content="Hex-Rays, GetProcAddress, and Malware Analysis &mdash; Möbius Strip Reverse Engineering"/>
<meta property="og:latitude" content="40.7207559"/>
<meta property="og:longitude" content="-74.0007613"/>
<meta property="og:locality" content=""/>
<meta property="og:url" content="https://www.msreverseengineering.com/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Background"/>
<meta property="og:image" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/60b6c73e12d078031a5551bf/1622591319687/HR71.png?format=1500w"/>
<meta property="og:image:width" content="966"/>
<meta property="og:image:height" content="476"/>
<meta itemprop="name" content="Hex-Rays, GetProcAddress, and Malware Analysis — Möbius Strip Reverse Engineering"/>
<meta itemprop="url" content="https://www.msreverseengineering.com/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis"/>
<meta itemprop="description" content="Background"/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/60b6c73e12d078031a5551bf/1622591319687/HR71.png?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/60b6c73e12d078031a5551bf/1622591319687/HR71.png?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/60b6c73e12d078031a5551bf/1622591319687/HR71.png?format=1500w"/>
<meta itemprop="author" content="Rolf Rolles"/>
<meta itemprop="datePublished" content="2021-06-01T17:10:45-0700"/>
<meta itemprop="dateModified" content="2021-06-02T12:23:51-0700"/>
<meta itemprop="headline" content="Hex-Rays, GetProcAddress, and Malware Analysis"/>
<meta itemprop="publisher" content="Möbius Strip Reverse Engineering"/>
<meta name="twitter:title" content="Hex-Rays, GetProcAddress, and Malware Analysis — Möbius Strip Reverse Engineering"/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/60b6c73e12d078031a5551bf/1622591319687/HR71.png?format=1500w"/>
<meta name="twitter:url" content="https://www.msreverseengineering.com/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="Background"/>
<meta name="description" content="" />
<link rel="preconnect" href="https://images.squarespace-cdn.com">
<link rel="preconnect" href="https://use.typekit.net" crossorigin>
<link rel="preconnect" href="https://p.typekit.net" crossorigin>
<script type="text/javascript" src="//use.typekit.net/ik/5WVm_KtEW5xuGFOxRM_pHbt0ouhorTX8IpdCwOAZF-bfezCgfFHN4UJLFRbh52jhWD9DjQjXjhwkZQsKwewhwhZRF2BywDwkwgToiaiaOcuDScmhZW4DZAm0Zh80ZAmk-Ao1OcFzdPUlSa48icmkShm8dciTdcm8Sc80ZkoRdhXCScNCZKukdhUCZWwlj1IujPoDSWmyScmDSeBRZPoRdhXCHKokdhUcOW4zdeU8SkuKSQmyO1FUiABkZWF3jAF8OcFzdPJwSY4zpe8ljPu0daZyH6qJtKGbMg62JMJ7fbKzMsMMeMb6MKG4fHXgIMMjgKMfH6qJK3IbMg6YJMJ7fbRRHyMMeMX6MKG4fHtgIMMjIfMfH6qJRMIbMg6sJMJ.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Varela+Round:ital,wght@0,400"><script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="//assets.squarespace.com/@sqs/polyfiller/1.6/legacy.js"></script>
<script type="text/javascript" crossorigin="anonymous" src="//assets.squarespace.com/@sqs/polyfiller/1.6/modern.js"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-8a6929b857b57fd1-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-8a6929b857b57fd1-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-4c50d377dd2c3266-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-4c50d377dd2c3266-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-25a6a9f67fbc7995-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-25a6a9f67fbc7995-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-eaf81719645c39ea-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-eaf81719645c39ea-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/commerce-4daa8f0e30dcba1b-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-commerce');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/commerce-4daa8f0e30dcba1b-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].css = ["//assets.squarespace.com/universal/styles-compressed/commerce-9623d3d351c90321-min.en-US.css"]; })(SQUARESPACE_ROLLUPS, 'squarespace-commerce');</script>
<link rel="stylesheet" type="text/css" href="//assets.squarespace.com/universal/styles-compressed/commerce-9623d3d351c90321-min.en-US.css"><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/user-account-core-b4279c0f80a65dc6-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/user-account-core-b4279c0f80a65dc6-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].css = ["//assets.squarespace.com/universal/styles-compressed/user-account-core-32dec2abb821f895-min.en-US.css"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<link rel="stylesheet" type="text/css" href="//assets.squarespace.com/universal/styles-compressed/user-account-core-32dec2abb821f895-min.en-US.css"><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-641ed7033c6b0b5a-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/performance-641ed7033c6b0b5a-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["marketing_landing_page","contacts_and_campaigns_redesign","campaigns_new_image_layout_picker","campaigns_discount_section_in_blasts","marketing_automations","campaigns_discount_section_in_automations","campaigns_thumbnail_layout","campaigns_import_discounts","order_status_page_checkout_landing_enabled","i18n_beta_website_locales"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-da53f22272c0f60d-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-5d864aadea1060d1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-e72461374205e066-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-47a224f34e715983-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-54badd2a3c7a1ca8-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-96b256171ee039c1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-ea68dbda5f388989-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-01eecf660cca1c8d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-7b8bd6df03e1d0fd-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-01f4ea53f1ef2e01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-8bc9d49de38206f2-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-f9093f2d526b94df-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-29b32239953401ea-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-d6b0fafb2db5f0f2-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-b050d5cb37e54287-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-0afd3c6ac30bbab1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-26761529c74e14c4-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-de0dea92b161a99b-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-104246dd5ee81f93-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-999ae888ced44ad2-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-b742b752f5880972-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-eb97a22a748d7326-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-0ba5bac716923b8e-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-63d71ad5d1438e3c-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-d1bdb2ab433d5058-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-6676ab1a86064e26-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-90a67fc09b9b32c6-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-a1ac365b6124a586-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-28c3804d6764d558-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-701bf8bbc05ec6aa-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-b76ae7bcbecc9533-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-95032e5fa98e47a5-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-44a9624f2158f353-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-a7865865735d59fc-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-07ea5a4e004e6710-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-1b83c634e75bffd0-min.en-US.js"}},"pageType":50,"website":{"id":"53a64cc2e4b0c63fc41a3320","identifier":"rolf-rolles-bq5a","websiteType":4,"contentModifiedOn":1724352448217,"cloneable":false,"hasBeenCloneable":false,"siteStatus":{},"language":"en-US","timeZone":"America/Los_Angeles","machineTimeZoneOffset":-25200000,"timeZoneOffset":-25200000,"timeZoneAbbr":"PDT","siteTitle":"M\u00F6bius Strip Reverse Engineering","fullSiteTitle":"Hex-Rays, GetProcAddress, and Malware Analysis \u2014 M\u00F6bius Strip Reverse Engineering","siteTagLine":"Reverse Engineering Training and Consulting Services","siteDescription":"","location":{"mapZoom":12.0,"mapLat":40.7207559,"mapLng":-74.0007613},"shareButtonOptions":{"7":true,"6":true,"4":true,"2":true,"3":true,"8":true,"1":true},"authenticUrl":"https://www.msreverseengineering.com","internalUrl":"https://rolf-rolles-bq5a.squarespace.com","baseUrl":"https://www.msreverseengineering.com","primaryDomain":"www.msreverseengineering.com","sslSetting":3,"isHstsEnabled":true,"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"1ab975037ccdff31fa158700002d4efcc43a3cb077534d7f9217074e3e2f3d24","showOwnerLogin":false},"websiteSettings":{"id":"53a64cc2e4b0c63fc41a3321","websiteId":"53a64cc2e4b0c63fc41a3320","type":"Business","subjects":[{"systemSubject":"tech"}],"country":"US","state":"CA","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":true,"contactPhoneNumber":"","storeSettings":{"returnPolicy":"","termsOfService":"","privacyPolicy":"","expressCheckout":true,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["USD","AUD","CAD","CHF","DKK","EUR","GBP","NOK","SEK"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":1,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"isLive":true,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"ampEnabled":false,"userAccountsSettings":{"loginAllowed":true,"signupAllowed":true}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Blog","id":"53a64ceee4b0d3d42b2c7856","fullUrl":"/blog","publicCommentCount":0,"type":1,"permissionType":1},"item":{"title":"Hex-Rays, GetProcAddress, and Malware Analysis","id":"60b6c6d106f5f75dd447683a","fullUrl":"/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis","publicCommentCount":0,"commentState":1,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"outerPadding":"100px","pagePadding":"80px","product-gallery-auto-crop":"true","product-image-auto-crop":"true","topPadding":"80px","tweak-v1-related-products-title-spacing":"50px"},"templateId":"50521cf884aeb45fa5cfdb80","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/5052176b84aeb45fa5cfcc83/961/scripts/","impersonatedSession":false,"demoCollections":[{"collectionId":"5052176b84aeb45fa5cfcc94","deleted":false}],"tzData":{"zones":[[-480,"US","P%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/Los_Angeles","name":"Pacific Time"}},"env":"PRODUCTION"};</script><script>Squarespace.load(window);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.msreverseengineering.com/blog?format=rss" />
<script type="application/ld+json">{"url":"https://www.msreverseengineering.com","name":"M\u00F6bius Strip Reverse Engineering","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"address":"","@context":"http://schema.org","@type":"LocalBusiness"}</script><script type="application/ld+json">{"name":"Hex-Rays, GetProcAddress, and Malware Analysis \u2014 M\u00F6bius Strip Reverse Engineering","url":"https://www.msreverseengineering.com/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis","datePublished":"2021-06-01T17:10:45-0700","dateModified":"2021-06-02T12:23:51-0700","headline":"Hex-Rays, GetProcAddress, and Malware Analysis","author":"Rolf Rolles","publisher":{"name":"M\u00F6bius Strip Reverse Engineering","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/60b6c73e12d078031a5551bf/1622591319687/HR71.png?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="https://static1.squarespace.com/static/sitecss/53a64cc2e4b0c63fc41a3320/53/50521cf884aeb45fa5cfdb80/53a64cc2e4b0c63fc41a3324/961/site.css"/><script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53862034-1"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-53862034-1');</script><!-- End of Squarespace Headers -->
  <script src="https://static1.squarespace.com/static/ta/5052176b84aeb45fa5cfcc83/961/scripts/site-bundle.js" type="text/javascript"></script>
</head>

<body class="show-products-category-navigation   page-borders-thick canvas-style-normal  header-subtitle-address banner-alignment-center blog-layout-center project-layout-left-sidebar thumbnails-on-open-page-show-all social-icon-style-round    hide-page-title       event-thumbnails event-thumbnail-size-32-standard event-date-label event-date-label-time event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts  event-item-back-link    product-list-titles-under product-list-alignment-center product-item-size-32-standard product-image-auto-crop product-gallery-size-11-square product-gallery-auto-crop show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-dark  opentable-style-light small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-outline button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd collection-53a64ceee4b0d3d42b2c7856 view-item collection-type-blog collection-layout-default mobile-style-available site-title" id="item-60b6c6d106f5f75dd447683a">

  <div id="canvas">

    <div id="mobileNav" class="">
      <div class="wrapper">
        <nav class="main-nav mobileNav"><ul>
  
    

        <li class="page-collection">

          

            
              <a href="/training-classes">Training Classes</a>
            

            


          

        </li>

    

        <li class="page-collection">

          

            
              <a href="/research">Research</a>
            

            


          

        </li>

    

        <li class="blog-collection active-link">

          

            
              <a href="/blog">Blog</a>
            

            


          

        </li>

    

        <li class="page-collection">

          

            
              <a href="/contact">Contact</a>
            

            


          

        </li>

    
    
      <li class="user-account-link">
        <a href="#">
          <span class="sign-in">Sign In</span>
          <span class="my-account">My Account</span>
        </a>
      </li>
    
  
</ul>
</nav>

      </div>
    </div>
    <div id="mobileMenuLink"><a>Menu</a></div>

    <header id="header" class="clear">

    

      <div id="upper-logo">
        <h1 class="logo" data-content-field="site-title">
          <a href="/">Möbius Strip Reverse Engineering</a>
        </h1>
      </div>
      <script type="module">
      if (parseInt(Y.one('body').getComputedStyle('width'),10) <= 640) {
        Y.use('squarespace-ui-base', function(Y) {
          Y.one("#upper-logo .logo").plug(Y.Squarespace.TextShrink, {
            parentEl: Y.one('#upper-logo')
          });
        });
      }
      </script>

      
      <div class="site-info" data-content-field="business-information">
        <div class="site-address">Street Address</div>
        <div class="site-city-state">City, State, Zip</div>
        <div class="site-phone">Phone Number</div>
      </div>
      

      <div class="site-tag-line">
        <span>Reverse Engineering Training and Consulting Services</span>
      </div>

      <div class="custom-info">
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Header Subtitle: Custom Content" data-type="block-field" data-updated-on="1381761023501" id="customInfoBlock"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-81eee4bbda3d9efd0834"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="text-align-center">Your Custom Text Here</p>
</div>






















</div></div></div></div></div>
      </div>

      <div id="lower-logo">
        <h1 class="logo" data-content-field="site-title"><a href="/">Möbius Strip Reverse Engineering</a></h1>
      </div>
      <script type="module">
        Y.use('squarespace-ui-base', function(Y) {
          Y.one("#lower-logo .logo").plug(Y.Squarespace.TextShrink, {
            parentEl: Y.one('#lower-logo')
          });
        });
      </script>

    
      <div id="topNav">
  <nav class="main-nav" data-content-field="navigation">
    <ul>
    
      

          <li class="page-collection">

            

              
                <a href="/training-classes">Training Classes</a>
              

              


            

          </li>

      

          <li class="page-collection">

            

              
                <a href="/research">Research</a>
              

              


            

          </li>

      

          <li class="blog-collection active-link">

            

              
                <a href="/blog">Blog</a>
              

              


            

          </li>

      

          <li class="page-collection">

            

              
                <a href="/contact">Contact</a>
              

              


            

          </li>

      
      
        <li class="user-account-link">
          <a href="#">
            <span class="sign-in">Sign In</span>
            <span class="my-account">My Account</span>
          </a>
        </li>
      
    
  </ul>
  <div class="page-divider"></div>
  </nav>
</div>


    </header>

    <div class="page-divider top-divider"></div>

    <!-- // page image or divider -->
    
      
        
      
    

    <section id="page" class="clear" role="main" data-content-field="main-content" data-collection-id="53a64ceee4b0d3d42b2c7856" data-collection-id="53a64ceee4b0d3d42b2c7856" data-edit-main-image="Banner" >

      <!-- // CATEGORY NAV -->
      

      <div class="article-wrapper">



  <article class="hentry author-rolf-rolles post-type-text" id="article-60b6c6d106f5f75dd447683a" data-item-id="60b6c6d106f5f75dd447683a">

    <!--POST HEADER-->

    <header>
  		<h1 class="entry-title" itemprop="headline" data-content-field="title">
        
          <a href="/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis">Hex-Rays, GetProcAddress, and Malware Analysis</a>
        
      </h1>
      <div class="meta">
        <span class="date"><time class="published dt-published" datetime="2021-06-01" itemprop="datePublished" pubdate>June  1, 2021</time></span>
        <span class="author"><a href="/blog?author=5111cf9ee4b0a36262da10df" rel="author">Rolf Rolles</a></span>
      </div>
    </header>

    <!--SPECIAL CONTENT-->

    

    <!--POST BODY-->

    <div class="body entry-content"><div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1622592645811" id="item-60b6c6d106f5f75dd447683a"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_27532"><div class="sqs-block-content"><p>This entry is about how to make the best use of IDA and Hex-Rays with regards to a common scenario in malware analysis, namely, dynamic lookup of APIs via <code>GetProcAddress</code> (and/or import resolution via hash). I have been tempted to write this blog entry several times; in fact, I uploaded the original code for this entry exactly one year ago today. The problem that the script solves is simple: given the name of an API function, retrieve the proper type signature from IDA's type libraries. This makes it easier for the analyst to apply the proper types to the decompilation, which massively aid in readability and presentability. No more manually looking up and copying/pasting API type definitions, or ignoring the problem due to its tedious solution; just get the information directly from the IDA SDK. <a href="https://github.com/RolfRolles/Miscellaneous/blob/master/PrintTypeSignature.py">Here is a link to the script.</a> EDIT LATER: I decided to write a small GUI for the functionality. <a href="https://github.com/RolfRolles/Miscellaneous/blob/master/APIRetypeGUI.py">You can find the Hex-Rays GUI plugin here.</a></p>

</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-489c7b02a7ed0e4b3e1d"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="text-align:center;white-space:pre-wrap;">Background</h1>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_14954"><div class="sqs-block-content"><p>Hex-Rays v7.4 introduced special handling for <code>GetProcAddress</code>. We can see the difference -- several of them, actually -- in the following two screenshots. The first comes from Hex-Rays 7.1:</p>

</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622591171831_16088"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:966px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:49.27536392211914%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png" data-image-dimensions="966x476" data-image-focal-point="0.5,0.5" alt="HR71.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png" width="966" height="476" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591294913-ECKXWT79SLSJJ3Y4P68W/HR71.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_17362"><div class="sqs-block-content"><p>The second comes from Hex-Rays 7.6:</p>

</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622591171831_18355"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1303px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:29.85418128967285%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png" data-image-dimensions="1303x389" data-image-focal-point="0.5,0.5" alt="HR76.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png" width="1303" height="389" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591347166-XGTP0AWV9QHDOWFUNB69/HR76.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_19604"><div class="sqs-block-content"><p>Several new features are evident in the screenshots -- more aggressive variable mapping eliminating the first two lines, and automatic variable renaming changing the names of variables -- but the one this entry focuses on has to do with the type assigned to the return value of <code>GetProcAddress</code>. Hex-Rays v7.4+ draw upon IDA's type libraries to automatically resolve the name of the procedure to its proper function pointer type signature, and set the return type of <code>GetProcAddress</code> to that type. </p>
<p>This change is evident in the screenshots above: for 7.1, the variable is named <code>v7</code>, its type is the generic <code>FARPROC</code>, and the final line shows a nasty cast on the function call. For 7.6, the variable is named <code>IsWow64Process</code>, its type is <code>BOOL (__stdcall *)(HANDLE, PBOOL)</code> (the proper type signature for the <code>IsWow64Process</code> API), and the final line shows no cast. Beyond the casts, we can also see that applying the type signature also changes the types of other local variables: <code>v5</code> in the first has the generic type <code>int</code>, whereas <code>v5</code> has the proper type <code>BOOL</code> in the second.</p>
<p>These screenshots clearly demonstrate that IDA is capable of resolving an API name to its proper type signature, the desirable effects of applying the proper type signature on readability, and the secondary effects of setting the types of other variables involved in calling those APIs.</p>

</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622591171831_21655"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="text-align:center;white-space:pre-wrap;">Relevance to Malware Analysis</h1>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_22242"><div class="sqs-block-content"><p>Hex-Rays' built-in functionality won't work directly when malware looks up API names by hash, or uses encrypted strings for the API names: the decompiler must see a fixed string being passed to <code>GetProcAddress</code> to do its magic. Although the malware analysis community seems very comfortable in dealing with imports via hash and encrypted strings, they seem less comfortable with applying proper type signatures to the resultant variables and structure members. <a href="https://cyber.wtf/2019/03/22/using-ida-python-to-analyze-trickbot/">Only one publication</a> I'm aware of bothers to tackle this, and it relies upon manual effort to retrieve the type definitions and create <code>typedef</code>s for them. This is unfortunate, as applying said types dramatically cleans up the decompilation output, but this is understandable, as the manual effort involved is rather cumbersome.</p>
<p>As a result, most publications that encounter this problem feature screenshots like this one. Note all of the casts on the function pointer invocations, and the so-called "partial types" <code>_QWORD</code>, etc.:</p>

</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622591171831_23294"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:958px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description=""
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:39.24843215942383%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png" data-image-dimensions="958x376" data-image-focal-point="0.5,0.5" alt="AnalysisWithCasts.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png" width="958" height="376" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622591586565-RRF2GE1J5AXZ9BGA3GUR/AnalysisWithCasts.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_24513"><div class="sqs-block-content"><p>(I chose not to link the analysis from which the above screenshot was lifted, because my goal here is positive assistance to the malware analysis community, and not to draw negative attention to anyone's work in particular. This pattern is extremely frequent throughout presentations of malware analysis; it is immaterial who authored the screenshot above, and I had other examples to choose from.)</p>

</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622591171831_26754"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="text-align:center;white-space:pre-wrap;">The Solution</h1>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_29599"><div class="sqs-block-content"><p>I did not know how to resolve an API name to its type signature, so I simply reverse engineered how Hex-Rays implements the functionality mentioned at the top of this entry. The result is a function <code>PrintTypeSignature(apiName)</code> you can use in your scripts and day-to-day work that does what its name implies: retrieves and prints the type signature for an API specified by name.</p>
<p>The script includes a demo function <code>Demo()</code> that resolves a number of API type signatures and prints them to the console. It begins by declaring a list of strings:</p>

</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622591171831_30667"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:191px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:83.7696304321289%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png" data-image-dimensions="191x160" data-image-focal-point="0.5,0.5" alt="PyDemo.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png" width="191" height="160" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592018876-M54KYI7EVS4Z5YDGX5FY/PyDemo.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622591171831_31889"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">The output of the script is the type signatures, ready to be copied and pasted into the variable type window and/or a structure declaration.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622591171831_32426"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1662px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description=""
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:6.317689418792725%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png" data-image-dimensions="1662x105" data-image-focal-point="0.5,0.5" alt="ScriptOutput.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png" width="1662" height="105" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592053867-QVSG8K7LETOQZETV0YD0/ScriptOutput.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622661245371_12855"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="text-align:center;white-space:pre-wrap;">GUI</h1>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622661245371_13716"><div class="sqs-block-content"><p>I decided to add a small GUI to the functionality. After you run <a href="https://github.com/RolfRolles/Miscellaneous/blob/master/APIRetypeGUI.py">this plugin</a>, you will have a new entry on your Hex-Rays right-click menu that appears when your cursor is over a pointer-sized local variable, as follows:</p>

</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622661245371_14676"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:787px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:49.80940246582031%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png" data-image-dimensions="787x392" data-image-focal-point="0.5,0.5" alt="GUIMenu.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png" width="787" height="392" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661497790-TXHEY9941H697MPZ12MN/GUIMenu.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622661245371_15728"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Once you click on that, it will ask you to enter an API name:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622661245371_16319"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:411px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:25.790754318237305%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png" data-image-dimensions="411x106" data-image-focal-point="0.5,0.5" alt="GUIAsk.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png" width="411" height="106" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661534792-7AL68IPVOL4TQ85S0331/GUIAsk.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622661245371_17367"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">If there are no errors, the script will change the type of the variable to the function prototype for the API.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622661245371_18046"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:704px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:3.9772727489471436%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png" data-image-dimensions="704x28" data-image-focal-point="0.5,0.5" alt="GUIResult.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png" width="704" height="28" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622661585166-KFDPP3XKUPSI587CEAUS/GUIResult.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622591171831_33630"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="text-align:center;white-space:pre-wrap;">A Final Note</h1>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1622591171831_34210"><div class="sqs-block-content"><p>Architecturally, there is a discrepancy between how the Hex-Rays microcode machinery handles type information for direct calls versus indirect ones. To summarize, you may still see casts in the output after applying the proper type signature to a variable or structure member. If this happens, right-click on the indirect call and press <code>Force call type</code> to force the proper type information to be applied at the call site. However, only do this once you have set the proper type information for the function pointer variable or structure member.</p>

</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622591171831_35249"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1235px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description=""
                data-lightbox-theme="dark"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:28.421052932739258%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png" data-image-dimensions="1235x351" data-image-focal-point="0.5,0.5" alt="ForceCallType.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png" width="1235" height="351" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1622592099614-6EBKFS88I6XNX1HTXXN2/ForceCallType.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622591171831_36459"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Mostly I published this because I want to see more types applied, and fewer casts, in the malware analysis publications that I read. Please, use my script!</p><h1 style="text-align:center;white-space:pre-wrap;">Addendum</h1>
</div>






















</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622661245371_20405"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">After publishing this article, I was made aware of <a href="https://usualsuspect.re/article/ida-tricks-handling-dynamic-imports">prior work</a> that is strongly related. That work focuses on the same problem, albeit in the disassembly listing rather than in Hex-Rays (and hence does not discuss some of the considerations from my entry above). Its ultimate solution is very similar to mine; it includes two out of three API calls from the one I came up with in this entry.</p>
</div>






















</div></div></div></div></div></div>
    


    <!--POST FOOTER-->

    <footer class="clear">
      <div class="meta">

        

        <div class="first meta-row">
          
          
        </div>

        <div class="second meta-row">
          <span class="squarespace-social-buttons inline-style" data-system-data-id="" data-asset-url="https://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/53a64ceee4b0d3d42b2c7856/60b6c6d106f5f75dd447683a/1622661831712/" data-record-type="1" data-full-url="/blog/2021/6/1/hex-rays-getprocaddress-and-malware-analysis" data-title="Hex-Rays, GetProcAddress, and Malware Analysis"></span>
          
  <span class="sqs-simple-like" data-item-id="60b6c6d106f5f75dd447683a" data-like-count="20">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>

        </div>

      </div>
    </footer>


  </article>



<!--PAGINATION-->


  <nav class="pagination clear">
      <a class="prev-item" href="/blog/2021/9/21/automation-in-reverse-engineering-c-template-code">&larr; Automation in Reverse Engineering C++ STL/Template Code</a><a class="next-item" href="/blog/2021/3/3/what-is-a-while2-loop-in-hex-rays">What is a while(2) loop in Hex-Rays? &rarr;</a>
  </nav>



  <!-- COMMENTS -->

  <section id="comments-60b6c6d106f5f75dd447683a" class="comments-wrapper">
    
  <div class="squarespace-comments" id="comments-60b6c6d106f5f75dd447683a" data-item-id="60b6c6d106f5f75dd447683a" data-public-comment-count="0" data-comment-state="1"></div>

  </section>


</div><!-- /article-wrapper -->

<aside id="sidebar"><div class="sqs-layout sqs-grid-1 columns-1 empty" data-layout-label="Sidebar Content" data-type="block-field" id="sidebarBlocks"><div class="row sqs-row"><div class="col sqs-col-1 span-1"></div></div></div></aside>

    </section>

    <div class="sqs-layout sqs-grid-12 columns-12 empty" data-layout-label="Blog Footer Content" data-type="block-field" id="item-60b6c6d106f5f75dd447683a"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>

    <!-- <div class="page-divider bottom-divider"></div> -->

    <div class="info-footer-wrapper clear">
      <div class="info-footer">
      <div class="sqs-layout sqs-grid-12 columns-12 empty" data-layout-label="Info Footer Content" data-type="block-field" data-updated-on="1403654631747" id="infoFooterBlock"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>
      
        
      
      </div>
    </div>

    <footer id="footer" class="clear">
      <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Footer Content" data-type="block-field" data-updated-on="1357835131710" id="footerBlock"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-126febe67777dbcbc0b4"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="text-align-center">Powered by <a href="http://www.squarespace.com" data-link-type="external">Squarespace</a></p>
</div>






















</div></div></div></div></div>
    </footer>

  </div>

  <div></div>

  <script data-sqs-type="imageloader-bootstrapper">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script><script>Squarespace.afterBodyLoad(Y);</script>




</body>

</html>
