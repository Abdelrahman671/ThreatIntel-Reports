<!doctype html><html lang="en"><head>
    <meta charset="utf-8">
    <title>Cado Security Labs Encounter Novel Malware, Redis P2Pinfect</title>
    <link rel="shortcut icon" href="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Cado-Security-Favicon-%E2%80%93-2.png">
    <meta name="description" content="Cado Security Labs recently encountered a novel malware, named “P2Pinfect” targeting publicly-accessible deployments of the Redis data store.">
    
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.13.0/css/all.css" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Cado Security Labs recently encountered a novel malware, named “P2Pinfect” targeting publicly-accessible deployments of the Redis data store.">
    <meta property="og:title" content="Cado Security Labs Encounter Novel Malware, Redis P2Pinfect">
    <meta name="twitter:description" content="Cado Security Labs recently encountered a novel malware, named “P2Pinfect” targeting publicly-accessible deployments of the Redis data store.">
    <meta name="twitter:title" content="Cado Security Labs Encounter Novel Malware, Redis P2Pinfect">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.min.css" integrity="sha256-zzHVEO0xOoVm0I6bT9v5SgpRs1cYNyvEvHXW/1yCgqU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.css" integrity="sha256-jsQbSO1yj62eu6dP6f2fJESRgkHNNEpxrK8NnO6/oyc=" crossorigin="anonymous">

<link rel="stylesheet" href="//14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/template_assets/156178194464/1728675369609/cado-unified4-srw/css/styles.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156175596464/1728675368615/module_156175596464_u4m-header.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156174727339/1728675369449/module_156174727339_u4m-blog-post-cards.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156174727456/1728675369364/module_156174727456_u4m-subscribe.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156174794365/1728675367442/module_156174794365_u4m-footer.min.css">
    <script type="application/ld+json">
{
  "mainEntityOfPage" : {
    "@type" : "WebPage",
    "@id" : "https://www.cadosecurity.com/blog/redis-p2pinfect"
  },
  "author" : {
    "name" : "Nate Bill",
    "url" : "https://www.cadosecurity.com/blog/author/nate-bill",
    "@type" : "Person"
  },
  "headline" : "Cado Security Labs Encounter Novel Malware, Redis P2Pinfect",
  "datePublished" : "2023-07-31T13:00:00.000Z",
  "dateModified" : "2024-05-01T14:12:39.051Z",
  "publisher" : {
    "name" : "Cado Security Ltd",
    "logo" : {
      "url" : "https://f.hubspotusercontent00.net/hubfs/14518100/Cado-Logo-Color%20(2)%20(1)-1.png",
      "@type" : "ImageObject"
    },
    "@type" : "Organization"
  },
  "@context" : "https://schema.org",
  "@type" : "BlogPosting",
  "image" : [ "https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image3-35.png" ]
}
</script>


    
<!--  Added by GoogleAnalytics4 integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;


if (!window._hsGoogleConsentRunOnce) {
  window._hsGoogleConsentRunOnce = true;

  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'wait_for_update': waitForUpdateMillis
  });

  if (useGoogleConsentModeV2) {
    _hsp.push(['useGoogleConsentModeV2'])
  } else {
    _hsp.push(['addPrivacyConsentListener', function(consent){
      var hasAnalyticsConsent = consent && (consent.allowed || (consent.categories && consent.categories.analytics));
      var hasAdsConsent = consent && (consent.allowed || (consent.categories && consent.categories.advertisement));

      gtag('consent', 'update', {
        'ad_storage': hasAdsConsent ? 'granted' : 'denied',
        'analytics_storage': hasAnalyticsConsent ? 'granted' : 'denied',
        'ad_user_data': hasAdsConsent ? 'granted' : 'denied',
        'ad_personalization': hasAdsConsent ? 'granted' : 'denied'
      });
    }]);
  }
}

gtag('js', new Date());
gtag('set', 'developer_id.dZTQ1Zm', true);
gtag('config', 'G-S0BZ30LS47');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S0BZ30LS47"></script>

<!-- /Added by GoogleAnalytics4 integration -->

<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-P9BDTK9');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<!-- Google Tag Manager
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P9BDTK9');</script>
-->
<!-- Hotjar Tracking Code for Cado Security -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:5172881,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<link rel="amphtml" href="https://www.cadosecurity.com/blog/redis-p2pinfect?hs_amp=true">

<meta property="og:image" content="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image3-35.png">

<meta name="twitter:image" content="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image3-35.png">


<meta property="og:url" content="https://www.cadosecurity.com/blog/redis-p2pinfect">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.cadosecurity.com/blog/redis-p2pinfect">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cadosecurity.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cadosecurity.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">






    
    <meta property="og:image" content="https://www.yourdomain.com/hubfs/yourimage.jpg">
<meta name="generator" content="HubSpot"></head>
<body class="  hs-content-id-156195001978 hs-blog-post hs-blog-id-156179862661  ">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P9BDTK9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    
    

    


    
        <div id="hs_cos_wrapper_u4m-header" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><header class="u4m-header dark">
  
  <a class="skip-to-content-link" href="#main-content">Skip to content</a>
  
  <div class="inner">
    
    <div class="logo">
      <a href="https://www.cadosecurity.com/">
        
        <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/footer-logo.svg" width="144" height="29" alt="footer-logo">
        
      </a>
    </div>

    
    <div class="menu">
      
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/product/platform">
          Product
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container ">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-one">
              
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/product/platform">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Platform.svg" alt="Icon-Platform" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Platform</h5>
                      

                      
                        <p class="description">Explore the core capabilities of the Cado Platform.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/product/environments">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Environments.svg" alt="Icon-Environments" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Environments</h5>
                      

                      
                        <p class="description">Discover the broad support that the Cado platform offers.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/product/integrations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Integrations.svg" alt="Icon-Integrations" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Integrations</h5>
                      

                      
                        <p class="description">Learn how the Cado platform integrates into your broader ecosystem.</p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/solutions">
          Solutions
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container fullwidth">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-two">
              <h6 class="column-heading">Use Cases</h6>
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/cross-cloud-investigations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Cross-Cloud%20Investigations.svg" alt="Icon-Cross-Cloud Investigations" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cross Cloud Investigations</h5>
                      

                      
                        <p class="description">Respond to incidents identified in AWS, Azure, and GCP in a single pane of glass.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/container-and-k8s-investigations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Container-Investigations.svg" alt="Icon-Container-Investigations" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Container &amp; K8s Investigations</h5>
                      

                      
                        <p class="description">Perform container investigations in EKS, AKS, GKE, and Kubernetes.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/endpoint-triage">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Endpoint-Triage.svg" alt="Icon-Endpoint-Triage" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Endpoint Triage</h5>
                      

                      
                        <p class="description">Automate endpoint triage for immediate insights and quick escalation.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/saas-investigations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-BEC-Compromise.svg" alt="Icon-BEC-Compromise" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">SaaS Investigations</h5>
                      

                      
                        <p class="description">Analyze critical SaaS logs to investigate Business Email Compromise.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/cloud-detection-and-response">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Incident-Containment.svg" alt="Icon-Incident-Containment" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cloud Detection &amp; Response (CDR)</h5>
                      

                      
                        <p class="description">Marry threat detection with forensic context to expedite response. </p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/evidence-preservation">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Evidence-Preservation.svg" alt="Icon-Evidence-Preservation" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Evidence Preservation</h5>
                      

                      
                        <p class="description">Capture data immediately and preserve it before it disappears.</p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
            <div class="dropdown-column width-one">
              <h6 class="column-heading">Cado For</h6>
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/dfir">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">DFIR</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/security-operations-center">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">SOC</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/mssp">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">MSSPs</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/partners">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Partners</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/government">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Government</h5>
                      

                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/resources">
          Resources
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container fullwidth">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-two">
              
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/resources">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Report.svg" alt="Icon-Report" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">All Resources</h5>
                      

                      
                        <p class="description">Explore Cado Security's entire content library.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/blog">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Blog.svg" alt="Icon-Blog" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Blog</h5>
                      

                      
                        <p class="description">Timely commentary from the Cado Security team.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="/resources#playbook">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Playbook.svg" alt="Icon-Playbook" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Playbooks</h5>
                      

                      
                        <p class="description">Best practices for investigating and responding to threats. </p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="/resources#cheat-sheet">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Cheat-Sheet.svg" alt="Icon-Cheat-Sheet" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cheat Sheets</h5>
                      

                      
                        <p class="description">Quick tips for investigating and responding to incidents.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/news-and-events">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-News.svg" alt="Icon-News" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">News</h5>
                      

                      
                        <p class="description">The latest Cado company announcements, press, and more.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/cado-community-edition">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Community.svg" alt="Icon-Community" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Community</h5>
                      

                      
                        <p class="description">Access to our free edition of the Cado platform.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://docs.cadosecurity.com/cado-response/intro" target="_blank" rel="noopener">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-documentation.svg" alt="Icon-documentation" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Documentation</h5>
                      

                      
                        <p class="description">Technical documentation on how to best leverage the Cado platform.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/wiki">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/Other%20Icons/White%20Paper%2080x80.svg" alt="White Paper 80x80" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Wiki</h5>
                      

                      
                        <p class="description">Everything you need to know about cloud security and cloud forensics. </p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/about">
          Company
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container ">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-one">
              
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/about">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-About.svg" alt="Icon-About" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">About</h5>
                      

                      
                        <p class="description">Learn more about the Cado Security mission, vision, and team.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/careers">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Careers.svg" alt="Icon-Careers" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Careers</h5>
                      

                      
                        <p class="description">Check out current career opportunities at Cado Security.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/cado-security-labs">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Incidident-Response%20Preparedness-II.svg" alt="Icon-Incidident-Response Preparedness-II" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cado Security Labs</h5>
                      

                      
                        <p class="description">The research and development division at Cado Security</p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      


    </div>
    
    
    
    <div class="search-toggle" tabindex="0">
      <svg class="search-toggle-button" width="18px" height="18px" viewbox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="CADO-Additional-Modules-R3" transform="translate(-1299, -58)" fill="#0E4271" fill-rule="nonzero">
                  <g id="search_FILL0_wght400_GRAD0_opsz24-(6)-Copy" transform="translate(1299, 58)">
                      <path d="M16.6,18 L10.3,11.7 C9.8,12.1 9.225,12.4166667 8.575,12.65 C7.925,12.8833333 7.23333333,13 6.5,13 C4.68333333,13 3.14583333,12.3708333 1.8875,11.1125 C0.629166667,9.85416667 0,8.31666667 0,6.5 C0,4.68333333 0.629166667,3.14583333 1.8875,1.8875 C3.14583333,0.629166667 4.68333333,0 6.5,0 C8.31666667,0 9.85416667,0.629166667 11.1125,1.8875 C12.3708333,3.14583333 13,4.68333333 13,6.5 C13,7.23333333 12.8833333,7.925 12.65,8.575 C12.4166667,9.225 12.1,9.8 11.7,10.3 L18,16.6 L16.6,18 Z M6.5,11 C7.75,11 8.8125,10.5625 9.6875,9.6875 C10.5625,8.8125 11,7.75 11,6.5 C11,5.25 10.5625,4.1875 9.6875,3.3125 C8.8125,2.4375 7.75,2 6.5,2 C5.25,2 4.1875,2.4375 3.3125,3.3125 C2.4375,4.1875 2,5.25 2,6.5 C2,7.75 2.4375,8.8125 3.3125,9.6875 C4.1875,10.5625 5.25,11 6.5,11 Z" id="Shape"></path>
                  </g>
              </g>
          </g>
      </svg>
    </div>
    
   
    <div class="cta">
      <span id="hs_cos_wrapper_u4m-header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_cta" style="" data-hs-cos-general-type="widget" data-hs-cos-type="cta"><!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-a51b72aa-daa5-4df8-a061-1902834ccdb0"><span class="hs-cta-node hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0" id="hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0"><img class="hs-cta-img" id="hs-cta-img-a51b72aa-daa5-4df8-a061-1902834ccdb0" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0.png" alt="Get a Demo"></a></span><script charset="utf-8" src="/hs/cta/cta/current.js"></script><script type="text/javascript"> hbspt.cta._relativeUrls=true;hbspt.cta.load(14518100, 'a51b72aa-daa5-4df8-a061-1902834ccdb0', {"useNewLoader":"true","region":"na1"}); </script></span><!-- end HubSpot Call-to-Action Code --></span>
    </div>
   
    
    
    <button class="hamburger-toggle x2"><span class="lines"></span></button>
    
    <div class="offscreen-menu">
      <div class="content">
        
        <div class="mobile-search">
        <div class="hs-search-field"> 
  <div class="hs-search-field__bar"> 
    <form action="/hs-search-results">
      <input type="text" class="hs-search-field__input search-input" name="term" autocomplete="off" aria-label="Search" placeholder="Search">
      
      
      <input type="hidden" name="type" value="SITE_PAGE">
      <input type="hidden" name="type" value="LANDING_PAGE">
      <input type="hidden" name="type" value="BLOG_POST">
      <input type="hidden" name="type" value="LISTING_PAGE">
      <input type="hidden" name="type" value="KNOWLEDGE_ARTICLE">     
      
      
          
      
      
      
      
      <button aria-label="Search" class="search-button">
        
        <svg width="18px" height="18px" viewbox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="CADO-Additional-Modules-R3" transform="translate(-1299, -58)" fill="#0E4271" fill-rule="nonzero">
                  <g id="search_FILL0_wght400_GRAD0_opsz24-(6)-Copy" transform="translate(1299, 58)">
                      <path d="M16.6,18 L10.3,11.7 C9.8,12.1 9.225,12.4166667 8.575,12.65 C7.925,12.8833333 7.23333333,13 6.5,13 C4.68333333,13 3.14583333,12.3708333 1.8875,11.1125 C0.629166667,9.85416667 0,8.31666667 0,6.5 C0,4.68333333 0.629166667,3.14583333 1.8875,1.8875 C3.14583333,0.629166667 4.68333333,0 6.5,0 C8.31666667,0 9.85416667,0.629166667 11.1125,1.8875 C12.3708333,3.14583333 13,4.68333333 13,6.5 C13,7.23333333 12.8833333,7.925 12.65,8.575 C12.4166667,9.225 12.1,9.8 11.7,10.3 L18,16.6 L16.6,18 Z M6.5,11 C7.75,11 8.8125,10.5625 9.6875,9.6875 C10.5625,8.8125 11,7.75 11,6.5 C11,5.25 10.5625,4.1875 9.6875,3.3125 C8.8125,2.4375 7.75,2 6.5,2 C5.25,2 4.1875,2.4375 3.3125,3.3125 C2.4375,4.1875 2,5.25 2,6.5 C2,7.75 2.4375,8.8125 3.3125,9.6875 C4.1875,10.5625 5.25,11 6.5,11 Z" id="Shape"></path>
                  </g>
              </g>
          </g>
        </svg>
      </button>      

      <span class="search-overlay-close search-toggle-button" aria-label="Close">
        <i class="fas fa-times" aria-hidden="true"></i>
      </span>

    </form>
  </div>
  <ul class="hs-search-field__suggestions"></ul>
</div>
        </div>  
        
        <div class="mobile-menu">
        <span id="hs_cos_wrapper_u4m-header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="menu"><div id="hs_menu_wrapper_u4m-header_" class="hs-menu-wrapper active-branch no-flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="default" data-menu-id="156290876470" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Product</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/platform" role="menuitem">Platform</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/environments" role="menuitem">Environments</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/integrations" role="menuitem">Integrations</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Solutions</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions" role="menuitem">All Solutions</a></li>
    <li class="hs-menu-item hs-menu-depth-2 hs-item-has-children" role="none"><a href="javascript:;" role="menuitem">Use Cases</a>
     <ul role="menu" class="hs-menu-children-wrapper">
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/cross-cloud-investigations" role="menuitem">Cross Cloud Investigations</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/container-and-k8s-investigations" role="menuitem">Container &amp; K8s Investigations</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/endpoint-triage" role="menuitem">Endpoint Triage</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/saas-investigations" role="menuitem">SaaS Investigations</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/cloud-detection-and-response" role="menuitem">Cloud Detection &amp; Response (CDR)</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/evidence-preservation" role="menuitem">Evidence Preservation</a></li>
     </ul></li>
    <li class="hs-menu-item hs-menu-depth-2 hs-item-has-children" role="none"><a href="javascript:;" role="menuitem">Cado For</a>
     <ul role="menu" class="hs-menu-children-wrapper">
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/dfir" role="menuitem">DFIR</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/security-operations-center" role="menuitem">SOC</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/mssp" role="menuitem">MSSPs</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/partners" role="menuitem">Partners</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/government" role="menuitem">Government</a></li>
     </ul></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Resources</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/resources" role="menuitem">All Resources</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/blog" role="menuitem">Blog</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/news-and-events" role="menuitem">News</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-community-edition" role="menuitem">Community</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://docs.cadosecurity.com/cado-response/intro" role="menuitem" target="_blank" rel="noopener">Documentation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/wiki" role="menuitem">Wiki</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Company </a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/about" role="menuitem">About</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/careers" role="menuitem">Careers</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-security-labs" role="menuitem">Cado Security Labs</a></li>
   </ul></li>
 </ul>
</div></span>
        </div>
        
        
        <div class="mobile-cta">
          <span id="hs_cos_wrapper_u4m-header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_cta" style="" data-hs-cos-general-type="widget" data-hs-cos-type="cta"><!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-a51b72aa-daa5-4df8-a061-1902834ccdb0"><span class="hs-cta-node hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0" id="hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0"><img class="hs-cta-img" id="hs-cta-img-a51b72aa-daa5-4df8-a061-1902834ccdb0" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0.png" alt="Get a Demo"></a></span><script charset="utf-8" src="/hs/cta/cta/current.js"></script><script type="text/javascript"> hbspt.cta._relativeUrls=true;hbspt.cta.load(14518100, 'a51b72aa-daa5-4df8-a061-1902834ccdb0', {"useNewLoader":"true","region":"na1"}); </script></span><!-- end HubSpot Call-to-Action Code --></span>  
        </div>
        
        
      </div>
    </div>
  </div>
  
  <div class="search-overlay">
  <div class="hs-search-field"> 
  <div class="hs-search-field__bar"> 
    <form action="/hs-search-results">
      <input type="text" class="hs-search-field__input search-input" name="term" autocomplete="off" aria-label="Search" placeholder="Search">
      
      
      <input type="hidden" name="type" value="SITE_PAGE">
      <input type="hidden" name="type" value="LANDING_PAGE">
      <input type="hidden" name="type" value="BLOG_POST">
      <input type="hidden" name="type" value="LISTING_PAGE">
      <input type="hidden" name="type" value="KNOWLEDGE_ARTICLE">     
      
      
          
      
      
      
      
      <button aria-label="Search" class="search-button">
        
        <svg width="18px" height="18px" viewbox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="CADO-Additional-Modules-R3" transform="translate(-1299, -58)" fill="#0E4271" fill-rule="nonzero">
                  <g id="search_FILL0_wght400_GRAD0_opsz24-(6)-Copy" transform="translate(1299, 58)">
                      <path d="M16.6,18 L10.3,11.7 C9.8,12.1 9.225,12.4166667 8.575,12.65 C7.925,12.8833333 7.23333333,13 6.5,13 C4.68333333,13 3.14583333,12.3708333 1.8875,11.1125 C0.629166667,9.85416667 0,8.31666667 0,6.5 C0,4.68333333 0.629166667,3.14583333 1.8875,1.8875 C3.14583333,0.629166667 4.68333333,0 6.5,0 C8.31666667,0 9.85416667,0.629166667 11.1125,1.8875 C12.3708333,3.14583333 13,4.68333333 13,6.5 C13,7.23333333 12.8833333,7.925 12.65,8.575 C12.4166667,9.225 12.1,9.8 11.7,10.3 L18,16.6 L16.6,18 Z M6.5,11 C7.75,11 8.8125,10.5625 9.6875,9.6875 C10.5625,8.8125 11,7.75 11,6.5 C11,5.25 10.5625,4.1875 9.6875,3.3125 C8.8125,2.4375 7.75,2 6.5,2 C5.25,2 4.1875,2.4375 3.3125,3.3125 C2.4375,4.1875 2,5.25 2,6.5 C2,7.75 2.4375,8.8125 3.3125,9.6875 C4.1875,10.5625 5.25,11 6.5,11 Z" id="Shape"></path>
                  </g>
              </g>
          </g>
        </svg>
      </button>      

      <span class="search-overlay-close search-toggle-button" aria-label="Close">
        <i class="fas fa-times" aria-hidden="true"></i>
      </span>

    </form>
  </div>
  <ul class="hs-search-field__suggestions"></ul>
</div>
  </div> 
  
</header></div>
    

    

<main id="main-content" class="body-container-wrapper">

  

  <section class="u4m-blog-post">
    <!-- Blog Post Hero -->
    <div class="hero">
      <img class="left-curve-design" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Shapes/blog-curve-hero.svg" alt="curve design on left">
      <img data-aos="fade-right" data-aos-duration="800" class="right-image" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Images/Clouds/cloud-blog.svg" alt="cloud image">

      <div class="content">
        <span class="date"></span>
        <h1 class="title"><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Cado Security Labs Encounter Novel Malware, Redis P2Pinfect</span></h1>
        <div class="author-wrap">
          <div class="author-link">Written by: <a href="https://www.cadosecurity.com/blog/author/nate-bill">Nate Bill</a></div>        
        </div>
      </div>
    </div>
    <!-- End Blog Post Hero -->
  
    <!-- Blog Post Body -->
    <div class="body" id="body">
      <div class="share" id="share">
          <a href="https://twitter.com/intent/tweet?original_referer=https://www.cadosecurity.com/blog/redis-p2pinfect&amp;url=https://www.cadosecurity.com/blog/redis-p2pinfect&amp;source=tweetbutton" target="_blank" aria-label="Twitter">
            <svg width="23.4185473px" height="24px" viewbox="0 0 23.4185473 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
              <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                  <g id="CADO-Homepage-R3" transform="translate(-200, -6761)" fill="#0E5DA3" fill-rule="nonzero">
                      <g id="logo" transform="translate(200, 6761)">
                          <path d="M13.9372166,10.1623621 L22.6552978,0 L20.5893916,0 L13.0194828,8.8238362 L6.97341888,0 L0,0 L9.14283504,13.3432031 L0,24 L2.06602327,24 L10.060042,14.681729 L16.4451284,24 L23.4185473,24 L13.9367092,10.1623621 L13.9372166,10.1623621 Z M11.1075145,13.4607598 L10.1811549,12.1320776 L2.81044034,1.55961545 L5.98373156,1.55961545 L11.931984,10.0919298 L12.8583437,11.4206121 L20.5903674,22.5113139 L17.4170762,22.5113139 L11.1075145,13.4612686 L11.1075145,13.4607598 Z" id="Shape"></path>
                      </g>
                  </g>
              </g>
            </svg>
          </a>
          <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cadosecurity.com/blog/redis-p2pinfect" target="_blank" aria-label="LinkedIn"><span class="fab fa-linkedin" aria-hidden="true"></span></a>
          <a href="http://www.facebook.com/share.php?u=https://www.cadosecurity.com/blog/redis-p2pinfect" target="_blank" aria-label="Facebook"><span class="fab fa-facebook" aria-hidden="true"></span></a>
          <a href="mailto:?subject=Check%20out%20https://www.cadosecurity.com/blog/redis-p2pinfect" aria-label="email"><span class="fa fa-envelope" aria-hidden="true"></span></a>
      </div>
      <div class="content"><span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p> 
 <!-- wp:paragraph --></p> 
<!--more--><p>By Nate Bill and Matt Muir</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Cado Security Labs researchers recently encountered a novel malware campaign targeting publicly-accessible deployments of the Redis data store. The malware, named “P2Pinfect” by the developer themselves, is written in Rust and acts as a botnet agent. The sample analysed by Cado researchers includes an embedded Portable Executable (PE) along with an additional ELF executable, suggesting cross-platform compatibility between Windows and Linux.&nbsp;&nbsp;</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>In the time between encountering P2Pinfect and publishing this blog, Unit42 researchers also published an in-depth <a href="https://unit42.paloaltonetworks.com/peer-to-peer-worm-p2pinfect/">analysis</a> of the Windows variant of the malware. According to their findings, the variant they encountered was delivered via exploitation of <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-0543">CVE-2022-0543</a>, a LUA sandbox escape vulnerability present in certain versions of Redis. Cado researchers witnessed a different initial access vector, which will be detailed further in this blog.&nbsp;</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Summary of P2Pinfect capabilities:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li>Attempts multiple Redis exploits for initial access</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Utilises Rust for payload development, making analysis tricky</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Uses multiple evasion techniques to hinder dynamic analysis</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Conducts internet scanning for Redis and SSH servers</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Self-replication in a worm-like manner</li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Initial Access</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Cado researchers first encountered P2Pinfect whilst triaging honeypot telemetry. The malware compromises exposed instances of the Redis data store by exploiting the replication feature. Replication allows instances of Redis to be run in a distributed manner, in what’s referred to as a <a href="https://redis.io/docs/management/replication/">leader/follower</a> topology. This allows follower nodes to act as exact replicas of the leader, providing high availability and failover for the data store.&nbsp;</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>A common attack pattern against Redis in cloud environments is to exploit this feature using a malicious instance to enable replication. This is achieved via connecting to an exposed Redis instance and issuing the <code>SLAVEOF</code> command. Once replication is complete, the attacker can load a malicious module (a Linux shared object file) which extends the functionality of Redis itself. This initial access vector was first demonstrated in <a href="https://medium.com/@knownsec404team/rce-exploits-of-redis-based-on-master-slave-replication-ef7a664ce1d0">2018</a> and has been used in a number of high-profile cloud malware campaigns since - including <a href="https://www.alibabacloud.com/blog/new-outbreak-of-h2miner-worms-exploiting-redis-rce-detected_595743">H2miner</a> and, more recently, <a href="https://blog.aquasec.com/headcrab-attacks-servers-worldwide-with-novel-state-of-art-redis-malware">Headcrab</a>.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":7736,"sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image3-35.png" alt="" class="wp-image-7736"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph {"align":"center"} --></p> 
<p class="has-text-align-center"><em>Redis commands used by P2Pinfect for initial access (event ordering is non-linear)</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>P2Pinfect uses a number of known Redis exploitation methods for initial access, but it was the replication method described above that ultimately succeeded in compromising Cado’s honeypot infrastructure. As can be seen in the screenshot, a malicious <code>SLAVEOF</code> command was issued. This initiated replication of Cado’s Redis deployment against a malicious leader.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Shortly after replication, the <code>MODULE LOAD</code> command is used to load the malicious shared object file exp.so. This shared object extends the functionality of Redis, providing reverse shell access for the attacker and adding a new command <code>system.exec</code>,which allows arbitrary shell commands to be run on the host.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":7738,"sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image4-30.png" alt="" class="wp-image-7738"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph {"align":"center"} --></p> 
<p class="has-text-align-center"><em>Snippet of exp.so decompilation demonstrating attacker commands</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p><code>system.exec</code> is then used to issue a command to the C2 server via a /dev/tcp reverse shell which ultimately retrieves and executes the primary Linux payload.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>P2Pinfect also attempts to compromise the Redis host via the Cron unauthenticated RCE mechanism we’ve <a href="https://www.cadosecurity.com/tales-from-the-honeypot-watchdog-evolves-with-a-new-multi-stage-cryptojacking-attack/">previously described</a>.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":7740,"sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image7-14.png" alt="" class="wp-image-7740"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph {"align":"center"} --></p> 
<p class="has-text-align-center"><em>Example Redis commands for registering a malicious cronjob</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This method of abusing the <code>config set dir </code>command can also be used to an attacker-controlled SSH key, ensuring backdoor access to the host if successful. P2Pinfect also attempts this exploit, providing redundancy in the event that other Redis exploitation attempts fail.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Primary Payload</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The primary payload retrieved is an ELF written in a combination of C and Rust using Rust’s foreign function interface (FFI) library. The payload features a typical <code>libc_start_main</code> entrypoint and a C main function, which registers a number of <code>sigaction</code> syscalls for the process amongst other setup operations. It then forks into a typical Rust <code>lang_start</code> function, which executes the Rust component of the payload. This component also uses FFI to interoperate with C functions. The binary is packed using UPX in addition to this.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>After being executed, the binary updates the SSH configuration of the host. It updates the <code>sshd_config</code> file to a near default state using a bundled configuration file. This removes any configuration that may impede the author’s ability to SSH into the server, and also enables password authentication. The SSH service is then restarted, and the following key is dropped into the authorized_keys file for the current user:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:loos-hcb/code-block {"langType":"bash","langName":"Bash"} --></p> 
<div class="hcb_wrap"> 
 <pre class="prism undefined-numbers lang-bash" data-lang="Bash">&lt;code&gt;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC/2CmHl/eiVchVmng4TEPAxOnO+6R0Rb/W+zlwCR+/g3mHqsiadebQx4rd5Ru/2HnSIut2kxm9Pz4ycxMIP4tNqyeHGpXhngTHnCduUwDofkVwzuy1GtDWXwlZbW3a4FDkPB4QwyHzB62+8G2L8CaG/3v26acRef9UWO2JepanMAkJo0oOrFg/chMbTcrhXwhbesTnb12yhaXBS8KgF1bWkMEqPvAGAFBj1G19dBcThK/qw1Wg2wIEl23kDdc5P4tRVvisYj9s5pqIG/+i9AjAlpS8AEqymmYjA3xUyWc/2D1BytbHIZCn5rGlrTNM1GcB/cCTByqdOEbckBi17cOXBDKmG/NRSj7in71Rh81R54xhIn5FTGGBxtrxXhHVkfyRl23IRCnZevrM41Lra3WaFYNMVgmfjf78L98mAByoSI2ztwYpSksVnrtjLC7o73fLff2Ttyie7tRIkbGcm7wlUP81U6Qk+4AwuxfxRQhol9glY7JqdRmmqjYjfviy10wgLRBhtjdIDWSF18CsL0qW60/3YvYt+AtW0JXMMXq8KKUOWEAqbJTddKTsd0H5nvxbz+pBgeB850DcNwUm+Ko1x6zKbM4KqM8xpQDfFf139ZLsq6aW34jZJ1/2HxNtVs39tt/N1BvoZcsV8yH/du09LWf113BFNmkMYz1YUrT+1w== root@localhost.localdomain&lt;/code&gt;</pre> 
</div> 
<p> 
 <!-- /wp:loos-hcb/code-block --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>It then runs the following command using bash:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:loos-hcb/code-block {"langType":"bash","langName":"Bash"} --></p> 
<div class="hcb_wrap"> 
 <pre class="prism undefined-numbers lang-bash" data-lang="Bash">&lt;code&gt;mv /usr/bin/wget /usr/bin/wgbtx;mv /usr/bin/curl /usr/bin/clbtx;iptables -F;iptables -P INPUT ACCEPT;iptables -P OUTPUT ACCEPT;if ! which iptables;then apt-get install -y iptables iptables-services || yum install -y iptables iptables-services || dnf install -y iptables iptables-services || zypper install -y iptables iptables-services || pacman -S --noconfirm iptables iptables-services;fi; if ! which awk;then apt-get install -y gawk || yum install -y gawk || dnf install -y gawk || zypper install -y gawk || pacman -S --noconfirm gawk;fi; if ! which netstat;then apt-get install -y net-tools || yum install -y net-tools || dnf install -y net-tools || zypper install -y net-tools || pacman -S --noconfirm net-tools;fi; redis_ips=$(netstat -tnp | grep &amp;#39;:6379&amp;#39; | grep &amp;#39;ESTABLISHED&amp;#39; | awk &amp;#39;{print $5}&amp;#39; | awk -F &amp;#39;:&amp;#39; &amp;#39;{print $1}&amp;#39; | sort -u);for ip in $redis_ips;do iptables -A INPUT -p tcp --dport 6379 -s &amp;quot;$ip&amp;quot; -j ACCEPT; done; iptables -A INPUT -p tcp --dport 6379 -j DROP; iptables -A INPUT -p tcp --dport &amp;lt;port binary listens on&amp;gt; -j ACCEPT&lt;/code&gt;</pre> 
</div> 
<p> 
 <!-- /wp:loos-hcb/code-block --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This does a number of things:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li>Renames the <code>wget</code> and curl binaries to <code>wgbtx</code> and <code>clbtx</code> respectively. This is likely an attempt to hinder any incident responders from using them to pull down forensics tools, as well as preventing EDR solutions from detecting the usage of the command. This is a common TTP for cloud threat actors.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Checks for the<code> iptables</code> command, and installs it if it is not found. It has several commands specific to individual package managers, so it can be installed regardless of the Linux distribution in use.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Checks for the <code>awk</code> command, and installs it if it is not found. Like the previous command, it will try to use several package managers.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Checks for the <code>netstat</code> command, and installs it if it is not found. Like the previous commands, it will try to use several package managers.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Uses <code>netstat</code> and <code>awk</code> to collect a list of all IPs that are currently connected to the Redis server running on the target host.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Adds an <code>iptable</code>s rule to allow traffic from each of these IPs to the redis server.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Adds an <code>iptables</code> rule to deny all other traffic to the redis server.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Adds an<code> iptables</code> rule to allow all traffic to a randomly chosen port that the primary payload listens on for botnet communications.</li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>As the Redis server is known to be vulnerable, the malware’s use of <code>iptables</code> indicates that this is an attempt to prevent any other threat actors from compromising the Redis server, while still allowing the legitimate operators of the Redis server (who would be connected at the time) to still access the server, as to not tip them off.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>To establish persistence through reboots, the binary writes <code>/path/to/binary &lt;base64 encoded node list&gt;</code> to <code>.bash_logout.</code> This results in the binary respawning after any bash session is exited, whether that be via a TTY or via SSH. Normally, this would be done using <code>.bashrc </code>to run the command on login. However, using <code>.bash_logout</code> instead ensures that any analyst performing an inspection of the system does not have a chance to spot the process, as it is spawned after they log out.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Dropped Payloads</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>A binary called <code>bash</code> is dropped to<code> /tmp</code>, and run using<code> execv()</code> with an argument of <code>-bash</code>. Doing this results in the binary looking nearly identical to a real instance of bash when viewed in <code>ps aux</code>. After being run, the file self-deletes. The <code>bash </code>binary scans through <code>/proc</code>, and opens the <code>stat</code> for each process in there, as well as monitoring the <code>/proc</code> directory for changes. The<code> bash </code>binary will restart the main payload if it is killed, as seen below.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":7741,"sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image1-48.png" alt="" class="wp-image-7741"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph {"align":"center"} --></p> 
<p class="has-text-align-center"><em>Auditd log showing the dropped bash binary respawning the killed payload</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p><code>bash</code> is also capable of performing upgrades on the main binary. It reads in the main binary and validates it matches the latest signature file pulled from the botnet network. If it does not match (e.g. due to tampering or a newer version being available), the old instance is killed, a new version is downloaded to the same directory with a random name, and then executed.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The main binary will also monitor other processes for the file operations. Based on some unclear criteria (likely the amount of files opened and IOPS) it will try to kill processes that exceed a threshold. It is speculated that this is to try and detect incident response or analysis tools enumerating the disk or the creation of a memory dump.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":7742,"sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image2-39.png" alt="" class="wp-image-7742"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph {"align":"center"} --></p> 
<p class="has-text-align-center"><em>Kernel trace logs showing the sample sending SIGKILLs to other processes</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>In addition to bash, a copy of a binary called miner is dropped in the current directory with a random name, executed, and then deleted. Despite the name, the binary does not appear to actually be a crypto miner. The only observed behaviour was it repeatedly making the sleep syscall (so, doing nothing). However, as the botnet operator can update the binary at any time, this payload may simply be dormant, awaiting activation once the botnet has grown to a specific size.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">The Botnet</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The P2Pinfect malware makes use of a peer-to-peer botnet. Each infected server is treated as a node, which then connects to other infected servers. This allows the entire botnet to gossip with each other without using a centralised C2 server. It is assumed that commands are issued by propagating signed messages across the network.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>After launch, the binary starts listening on 0.0.0.0 with a port randomly selected, typically between 60100 and 60150. This port is used for communication with other peers, it serves a number of payloads on a simple HTTP server, and uses HTTPS for actual botnet coordination. The HTTPS server uses a hardcoded certificate, which is identical across all botnet members. It’s likely this certificate is also used as a client certificate to authenticate with the server (mutual TLS).</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:loos-hcb/code-block {"langType":"bash","langName":"Bash"} --></p> 
<div class="hcb_wrap"> 
 <pre class="prism undefined-numbers lang-bash" data-lang="Bash"><code>Certificate:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Data:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Version: 3 (0x2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial Number:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a8:ef:2b:a4:7e:63:82:e4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signature Algorithm: sha256WithRSAEncryption<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Issuer: C = US, O = Anonymous, CN = localhost<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validity<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not Before: Jun 29 09:34:17 2023 GMT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not After : Jun&nbsp; 5 09:34:17 2123 GMT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subject: C = US, O = Anonymous, CN = localhost<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subject Public Key Info:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public Key Algorithm: rsaEncryption<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RSA Public-Key: (2048 bit)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modulus:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:d5:7c:72:5f:60:6a:72:e1:eb:c9:77:65:d1:85:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;83:dd:e0:6c:d5:69:00:da:3e:17:af:44:8c:c8:3b:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ad:24:7a:f3:c2:6e:a9:ac:a1:60:0a:0c:5c:b3:b8:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6a:a7:eb:e6:4c:80:19:80:53:91:f8:d3:db:87:0e:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;97:85:f4:01:42:a1:3b:42:e6:4a:7c:d2:d3:23:a5:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;97:32:af:ed:a6:51:38:de:12:a8:ae:bd:9b:0e:85:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d8:66:d1:14:d9:af:f4:24:12:72:65:3f:31:7e:b9:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1:06:0a:8b:60:a5:dc:95:c7:d2:ce:4c:99:ab:ab:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c4:cf:3f:75:a9:11:72:55:4b:1e:d1:18:a1:2a:ab:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85:16:5c:0d:67:b5:47:63:d4:bc:fb:d3:0c:37:61:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2e:04:0b:1c:49:9a:ea:3e:47:b6:aa:60:fd:3a:2c:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;70:fb:d5:4f:34:bc:11:81:f1:cf:db:5f:6e:8e:9f:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6a:e1:eb:eb:33:07:b4:c5:56:d1:03:df:35:82:1e:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;42:43:1e:41:f7:6a:8e:fb:14:c4:83:09:c4:f1:8f:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2e:a3:ad:20:a3:5f:f7:31:95:d3:45:e3:7d:ed:03:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9b:c9:17:a2:80:b1:6b:82:fa:0b:bd:c1:c0:63:81:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4a:0c:4d:92:10:7b:d4:b1:2f:32:68:a7:1a:1a:22:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;02:0f<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exponent: 65537 (0x10001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3 extensions:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3 Subject Alternative Name:&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNS:localhost<br>
&nbsp;&nbsp;&nbsp;&nbsp;Signature Algorithm: sha256WithRSAEncryption<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;44:69:f8:4f:8c:a6:6c:d6:a5:ca:6c:15:f7:d9:de:87:ed:79:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15:a4:b6:1f:3d:ae:f1:4b:5a:33:70:d8:28:bb:97:24:29:8b:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89:6c:e9:54:93:7d:dc:53:10:49:cd:31:78:eb:95:5c:ee:33:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;84:41:6b:cc:2c:e1:69:9c:08:c5:c0:56:a9:18:4f:98:06:0a:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b8:d6:00:3e:24:fa:87:7c:95:a4:e1:40:35:6c:68:a3:a6:e4:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;59:31:59:8b:72:aa:97:96:ea:d8:74:79:d8:b3:05:79:3e:11:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ed:ea:2d:33:e8:b4:da:21:24:38:ff:19:06:62:37:d8:5d:ec:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4e:28:be:da:17:3c:b0:ba:51:31:41:12:2d:84:30:69:c6:67:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9f:ba:8b:d1:4c:0a:d2:57:d2:55:4d:63:22:9d:87:c7:36:e9:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d3:28:82:59:8a:cb:c6:5e:06:c2:d2:e3:0f:28:df:29:71:ea:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;79:39:ae:ff:36:e2:3d:93:51:4a:80:8d:38:c9:ba:a2:f8:ed:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6f:a2:ee:de:4e:a5:ff:61:49:58:62:e7:d6:53:05:09:ac:a0:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7c:61:a9:72:9e:9f:a5:c5:82:21:7a:20:62:2e:27:6d:85:11:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ce:7e:ae:10:0e:18:e6:3e:3c:d9:ef:18:be:8e:17:e7:c9:b1:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a7:ce:f3:36</code></pre> 
</div> 
<p> 
 <!-- /wp:loos-hcb/code-block --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Given the date of the certificate’s issuance, it is likely that this campaign began on or after June 29th.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The binary is launched with a list of comma separated IP and port pairs that is encrypted and then base64 encoded as its first argument. It will reach out to one of these servers to grab a copy of all of the following binaries:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li>Linux - Primary ELF payload for linux systems</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Windows Primary PE payload for windows systems</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Miner - ELF binary for linux systems</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>Winminer - PE binary for windows systems</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>&lt;name&gt;_sign files for all the above, which contain a cryptographic signature of the binary</li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>These binaries are then served using the HTTP server (so other new peers can grab a copy).</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The binary then registers itself with the other botnet peers given to it. It does this by sending an HTTP request to them on <code>/ip</code>, which returns the IP of the local host the malware is running on. The malware already attempts to fetch its IP from ipv4.icanhazip.com, however as this is a common TTP for malware, it is possible that this request may get blocked or spoofed, so it likely uses its other peers to check. This may also be used to validate that the peer is online. After this, it then establishes a TLS connection with each peer. It will then learn about more peers, connect to them, and keep up to date with network gossip.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":7743,"width":664,"height":507,"sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image5-23.png?width=664&amp;height=507&amp;name=image5-23.png" alt="" class="wp-image-7743" width="664" height="507" srcset="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image5-23.png?width=332&amp;height=254&amp;name=image5-23.png 332w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image5-23.png?width=664&amp;height=507&amp;name=image5-23.png 664w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image5-23.png?width=996&amp;height=761&amp;name=image5-23.png 996w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image5-23.png?width=1328&amp;height=1014&amp;name=image5-23.png 1328w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image5-23.png?width=1660&amp;height=1268&amp;name=image5-23.png 1660w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image5-23.png?width=1992&amp;height=1521&amp;name=image5-23.png 1992w" sizes="(max-width: 664px) 100vw, 664px"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph {"align":"center"} --></p> 
<p class="has-text-align-center"><em>HTTP requests to icanhazip and /ip</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Worming</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>At this point, the binary will try to infect more hosts. The binary will read the bash_history, ssh config, and known hosts files to gather a list of users, IPs, and SSH keys. It then uses this information to attempt to infect new instances. The binary will also select a random /16 network prefix to scan for exposed SSH and Redis servers, and uses a list of passwords to attempt to brute force any servers it encounters.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>In the case of Redis servers, it will attempt to exploit the LUA sandbox escape vulnerability or use the <code>SLAVEOF</code> and <code>MODULE LOAD</code> commands to load a malicious module, as previously discussed.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":7744,"width":405,"height":722,"sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image6-24.png?width=405&amp;height=722&amp;name=image6-24.png" alt="" class="wp-image-7744" width="405" height="722" srcset="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image6-24.png?width=203&amp;height=361&amp;name=image6-24.png 203w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image6-24.png?width=405&amp;height=722&amp;name=image6-24.png 405w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image6-24.png?width=608&amp;height=1083&amp;name=image6-24.png 608w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image6-24.png?width=810&amp;height=1444&amp;name=image6-24.png 810w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image6-24.png?width=1013&amp;height=1805&amp;name=image6-24.png 1013w, https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hubfs/Imported_Blog_Media/image6-24.png?width=1215&amp;height=2166&amp;name=image6-24.png 1215w" sizes="(max-width: 405px) 100vw, 405px"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph {"align":"center"} --></p> 
<p class="has-text-align-center"><em>List of passwords used by the malware</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Once access is gained to a host, it infects it in the same way the initial compromised server was, by dropping a copy of itself (fetched from the built in HTTP server) and executing it with a nodelist as an argument.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Conclusion</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>P2Pinfect is well-designed and utilises sophisticated techniques for replication and C2. The choice of using Rust also allows for easier portability of code across platforms (with the Windows and Linux binaries sharing a lot of the same code), while also making static analysis of the code significantly harder. This is due to the complexity of Rust itself, the inclusion of C code due to the Foreign Function Interface feature, and the lack of tooling available for analysis.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The sample encountered by Cado researchers had similar functionality as the Windows variant analysed by Unit42. Despite this, the initial access method differed and Cado researchers did not find any evidence to suggest the malware specifically targeted cloud environments. From the information gleaned during analysis, P2Pinfect would likely run on most Linux hosts regardless of whether they were cloud-hosted or on-premise.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Cado Security Labs concur with Unit42 findings on the subject of the miner payload. Cado researchers did not observe any behaviours attributable to cryptocurrency mining from this malware sample. It’s possible that this functionality will be enabled at a later date, and the malware is certainly capable of updating itself to include such functionality. This allows the operator to rapidly deploy any payload of their choosing&nbsp; We will continue to monitor this malware and post updates as they occur.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Cado Security customers can identify hosts compromised with P2Pinfect using the Cado platform.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Indicators of Compromise</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:table --></p> 
<figure class="wp-block-table"> 
 <table> 
  <tbody> 
   <tr> 
    <td><strong>Filename</strong></td> 
    <td><strong>SHA256</strong></td> 
   </tr> 
   <tr> 
    <td>linux</td> 
    <td>87a3fc1088449dbd3554fe029a1878a525e64ab4ccf71b23edb03619ba94403a</td> 
   </tr> 
   <tr> 
    <td>miner</td> 
    <td>b1fab9d92a29ca7e8c0b0c4c45f759adf69b7387da9aebb1d1e90ea9ab7de76c</td> 
   </tr> 
   <tr> 
    <td>bash</td> 
    <td>ce047893ac5bd2100db3448bd62c324e471ffcddd48433788bfe885e5f071a89</td> 
   </tr> 
  </tbody> 
 </table> 
</figure> 
<p> 
 <!-- /wp:table --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Yara Rule</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:loos-hcb/code-block --></p> 
<div class="hcb_wrap"> 
 <pre class="prism undefined-numbers lang-plain"><code>rule P2Pinfect {<br>
	meta:<br>
        description = "Detects P2Pinfect worm on Linux"<br>
        author = "nbill@cadosecurity.com"<br>
        license = "Apache License 2.0"<br>
        date = "2023-07-28"<br>
        hash1 = "87a3fc1088449dbd3554fe029a1878a525e64ab4ccf71b23edb03619ba94403a"<br>
        hash2 = "ce047893ac5bd2100db3448bd62c324e471ffcddd48433788bfe885e5f071a89"<br>
        hash3 = "b1fab9d92a29ca7e8c0b0c4c45f759adf69b7387da9aebb1d1e90ea9ab7de76c"<br>
    strings:<br>
        $magic = { 7f 45 4c 46 }
<p> $a1 = "p2pinfect"<br> $a2 = "p2pmod"</p>
</code><p><code> $b1 = { 48 8D 35 C2 13 22 00 6A 19 5A 4C 89 FF E8 A3 EF 17 00 48 8D 35 C9 13 22 00 6A 1E 5A 4C 89 FF E8 91 EF 17 00 48 8D 35 D5 13 22 00 6A 0E 5A 4C 89 FF E8 7F EF 17 00 48 8D 35 D1 13 22 00 6A 0F 5A 4C 89 FF E8 6D EF 17 00 48 8D 35 81 A5 21 00 4C 89 FF 4C 89 F2 E8 5B EF 17 00 }<br> $b2 = { 48 83 E4 80 48 81 EC 80 0F 00 00 48 C7 04 24 00 00 00 00 48 81 EC 00 05 00 00 49 89 D0 49 89 F5 48 89 BC 24 88 00 00 00 0F B6 86 20 08 00 00 48 8D 0D A3 4D 18 00 48 63 04 81 48 01 C8 6A 01 5E 6A 02 41 5F 4C 89 6C 24 48 48 89 94 24 90 00 00 00 FF E0 }<br> $b3 = { 4C 89 F7 49 89 D8 E8 10 BB 00 00 49 83 66 68 00 49 C7 46 70 0A 00 00 00 66 41 C7 46 78 01 00 6A 10 59 48 8D 84 24 50 04 00 00 48 89 C7 4C 89 F6 F3 48 A5 48 89 C7 E8 FA 76 01 00 }<br> $b4 = { 48 8B 3D 0F 3F 06 00 48 8B 35 10 3F 06 00 E8 20 8E 04 00 49 8B 46 10 48 89 05 08 3F 06 00 41 0F 10 06 0F 11 05 ED 3E 06 00 48 8D 35 A4 D0 FF FF 6A 0F 5F FF 15 25 3D 06 00 48 83 F8 FF 75 06 }<br> $b5 = { 49 29 F7 4C 89 F7 4C 89 FA FF 15 DB 92 21 00 48 8B 84 24 40 02 00 00 4C 01 E0 48 8B 8C 24 98 02 00 00 48 89 01 48 8B 84 24 80 00 00 00 48 89 28 48 8B BC 24 68 01 00 00 48 8D 77 10 48 8B 84 24 48 02 00 00 48 F7 D0 48 8B 94 24 50 02 00 00 48 01 C2 48 C1 E2 04 FF 15 FE 92 21 00 4C 8B A4 24 10 01 00 00 49 83 FC 01 4C 8B 3C 24 48 8B B4 24 38 01 00 00 0F 86 C0 02 00 00 }<br> condition:<br> $magic at 0 and (all of ($a*) or any of ($b*))<br> }</code></p></pre> 
</div> 
<p> 
 <!-- /wp:loos-hcb/code-block --></p></span></div>
      
        <div class="topics">
          <span class="label">Tag(s): </span> 
           
            <a class="link" href="https://www.cadosecurity.com/blog/tag/research-threat-intel">Research &amp; Threat Intel</a>
              
          
        </div>
      
    </div>
    
    <!-- End Blog Post Body -->
  
    <!-- Blog Post Author -->
    
    <!-- End Blog Post Author -->  
  

  
  </section>

  <div id="hs_cos_wrapper_u4m-blog-post-cards" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
  
  
  


<section id="u4m-blog-post-cards" class="u4m-blog-post-cards u4m-blog-post-cards   
" style=" 
">


  
  




  

  

  

  

  

  



  

    
    <div class="top-wrapper">
      
        <h2 class="heading">More from the blog</h2>
      
      
      
        <a class="link" href="https://www.cadosecurity.com/blog">View All Posts</a>
      
    </div>
    
  
    <div class="wrapper">
      
        
        
  
            

  



  


 
  
 
<a class="blog-post-card" href="https://www.cadosecurity.com/blog/cado-security-labs-researchers-witness-a-600x-increase-in-p2pinfect-traffic">

  <div class="inner">
    <div class="featured-icon">
      <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/Custom/Blog%20and%20Resources/Announcements.svg" alt="Research &amp; Threat Intel icon" loading="lazy" width="40">
    </div> 

    <div class="content">

      
      <div class="topic-wrapper">
        <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/blog-icon.svg" alt="blog icon" width="10" height="10" loading="lazy">
        
        
            
              
                 <span class="topic">Research &amp; Threat Intel</span>
              
              
            
        
      </div>
      

      <h5 class="title">Cado Security Labs Researchers Witness a 600X Increase in P2Pinfect Traffic</h5>

      <span class="date">September 20, 2023</span>
    
      <p class="teaser">Key Takeaways Cado Security Labs researchers have witnessed a 600x increase in P2Pinfect traffic since August 28th A 12.3%...</p>

      <div class="read-more"><span>Continue Reading</span></div>
    </div>
  </div>

</a>
        

  
            

  



  


 
  
 
<a class="blog-post-card" href="https://www.cadosecurity.com/blog/from-dormant-to-dangerous-p2pinfect-evolves-to-deploy-new-ransomware-and-cryptominer">

  <div class="inner">
    <div class="featured-icon">
      <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/Custom/Blog%20and%20Resources/Announcements.svg" alt="Research &amp; Threat Intel icon" loading="lazy" width="40">
    </div> 

    <div class="content">

      
      <div class="topic-wrapper">
        <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/blog-icon.svg" alt="blog icon" width="10" height="10" loading="lazy">
        
        
            
              
                 <span class="topic">Research &amp; Threat Intel</span>
              
              
            
        
      </div>
      

      <h5 class="title">From Dormant to Dangerous: P2Pinfect Evolves to Deploy New Ransomware and Cryptominer</h5>

      <span class="date">June 25, 2024</span>
    
      <p class="teaser">Introduction P2Pinfect is a rust-based malware covered extensively by Cado Security in the past. It is a fairly...</p>

      <div class="read-more"><span>Continue Reading</span></div>
    </div>
  </div>

</a>
        

  
            

  



  


 
  
 
<a class="blog-post-card" href="https://www.cadosecurity.com/blog/p2pinfect-new-variant-targets-mips-devices">

  <div class="inner">
    <div class="featured-icon">
      <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/Custom/Blog%20and%20Resources/Announcements.svg" alt="Research &amp; Threat Intel icon" loading="lazy" width="40">
    </div> 

    <div class="content">

      
      <div class="topic-wrapper">
        <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/blog-icon.svg" alt="blog icon" width="10" height="10" loading="lazy">
        
        
            
              
                 <span class="topic">Research &amp; Threat Intel</span>
              
              
            
        
      </div>
      

      <h5 class="title">P2Pinfect - New Variant Targets MIPS Devices</h5>

      <span class="date">December 4, 2023</span>
    
      <p class="teaser">Summary A new P2Pinfect variant compiled for the Microprocessor without Interlocked Pipelined Stages (MIPS) architecture has...</p>

      <div class="read-more"><span>Continue Reading</span></div>
    </div>
  </div>

</a>
        


      
  
      
      
    
      
           
      
      
         
      
    </div>  
  </section></div>
  <div id="hs_cos_wrapper_u4m-subscribe" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">




<section id="u4m-subscribe" class="u4m-subscribe u4m-subscribe   
" style=" 
">



  




  

  

  

  

  

  




<div class="wrapper">
  <div class="inner">
    <img data-aos="fade-right" data-aos-duration="800" class="top-image" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Images/cloud-top.svg" alt="cloud image" loading="lazy">
    <img data-aos="fade-left" data-aos-duration="800" class="left-image" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Images/Clouds/subscribe-cloud.svg" alt="cloud image" loading="lazy">
    <div class="intro">
      <h3 class="heading">Subscribe to Our Blog</h3>
      <p class="subheading">To stay up to date on the latest from Cado Security, subscribe to our blog today.</p>
    </div>

    <div class="form-area" data-blog-id="156179862661">
      
        <span id="hs_cos_wrapper_u4m-subscribe_blog_subscribe" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="blog_subscribe">
<div id="hs_form_target_u4m-subscribe_blog_subscribe_898"></div>



</span>
      
      
    </div>  
  </div>
</div>
</section></div>
</main>


    
        <div id="hs_cos_wrapper_u4m-footer" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><footer class="u4m-footer">

  <div class="inner">

      <div class="menu">
          <div id="hs_menu_wrapper_u4m-footer_" class="hs-menu-wrapper active-branch no-flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="default" data-menu-id="156295033863" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Product</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/platform" role="menuitem">Platform</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/environments" role="menuitem">Environments</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/integrations" role="menuitem">Integrations</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.cadosecurity.com/solutions" aria-haspopup="true" aria-expanded="false" role="menuitem">Solutions by Use Case</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/cross-cloud-investigations" role="menuitem">Cross Cloud Investigations</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/container-and-k8s-investigations" role="menuitem">Container &amp; K8s Investigations</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/endpoint-triage" role="menuitem">Endpoint Triage</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/saas-investigations" role="menuitem">SaaS Investigations</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/cloud-detection-and-response" role="menuitem">Cloud Detection &amp; Response (CDR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/evidence-preservation" role="menuitem">Evidence Preservation</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.cadosecurity.com/solutions" aria-haspopup="true" aria-expanded="false" role="menuitem">Solutions by Industry</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/dfir" role="menuitem">DFIR</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/security-operations-center" role="menuitem">SOC</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/mssp" role="menuitem">MSSPs</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/partners" role="menuitem">Partners</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/government" role="menuitem">Government</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.cadosecurity.com/resources" aria-haspopup="true" aria-expanded="false" role="menuitem">Resources</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/resources" role="menuitem">All Resources</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/blog" role="menuitem">Blog</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="/resources#playbook" role="menuitem">Playbooks</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="/resources#cheat-sheet" role="menuitem">Cheat Sheets</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/news-and-events" role="menuitem">News</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-community-edition" role="menuitem">Community</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://docs.cadosecurity.com/cado-response/intro" role="menuitem" target="_blank" rel="noopener">Documentation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/wiki" role="menuitem">Wiki</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Company</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/about" role="menuitem">About</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/careers" role="menuitem">Careers</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-security-labs" role="menuitem">Cado Security Labs</a></li>
   </ul></li>
 </ul>
</div>
      </div>
   
      <div class="lower-menu">
        <div class="lower-links">
          <div class="social">
            <ul>
              
              
              <li>
                <a href="https://twitter.com/CadoSecurity" target="_blank" aria-label="Twitter" rel="noopener">
                  <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/x-icon.svg" alt="Twitter X icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://www.linkedin.com/company/cado-security/" target="_blank" aria-label="LinkedIn" rel="noopener">
                 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/LinkedIn_Logo.svg" alt="LinkedIn icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://aws.amazon.com/marketplace/seller-profile?id=38874fd2-b585-412f-992a-cf111bbca38a" target="_blank" aria-label="Amazon" rel="noopener">
                  <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/Amazon_icon.svg" alt="Amazon icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://github.com/cado-security" target="_blank" aria-label="GitHub" rel="noopener">
                  <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/github-mark.svg" alt="GitHub icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://azuremarketplace.microsoft.com/en-us/marketplace/apps/cadosecurityltd1626856705534.cado-response?tab=Overview" target="_blank" aria-label="Azure" rel="noopener">
                 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/azure-logo-white-circle-1-600x600.svg" alt="Azure icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://console.cloud.google.com/marketplace/product/cado-public/cado-response?pli=1" target="_blank" aria-label="Google Cloud" rel="noopener">
                   <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/google-cloud-icon-2048x1646-7admxejz.svg" alt="Google Cloud icon" loading="lazy">
                </a>
              </li>
              

            </ul>
          </div>
          
          <div class="links">
              <div class="copyright">Copyright© 2024, Cado Security, All Rights Reserved <a href="/privacy-policy/">Privacy Policy</a></div>
            </div>
        </div>

         <div class="logo">
          <a href="https://www.cadosecurity.com/">
            <img loading="lazy" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/footer-logo.svg" width="144" height="29" alt="footer-logo">
          </a>
        </div>
      </div>
    </div>
  </footer></div>

    
    
    
    <script src="/hs/hsstatic/jquery-libs/static-1.1/jquery/jquery-1.7.1.js"></script>
<script>hsjQuery = window['jQuery'];</script>
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" integrity="sha256-4mJNT2bMXxcc1GCJaxBmMPdmah5ji0Ldnd79DKd1hoM=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-AjM0J5XIbiB590BrznLEgZGLnOQWrt62s3BEq65Q/I0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.js" integrity="sha256-NSwb7O0HrDJcC+2SASgGuCP8+tdpIhqnzLTZkGRJRCk=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js" integrity="sha256-qf3MqHLzDh4qqAnc9QVmqjEWBA4CfzP1YwRFbfNfpnE=" crossorigin="anonymous"></script>
<script>
// Stick sharing
document.addEventListener('DOMContentLoaded', function() {

    var Sticky = new hcSticky('#share', {
      stickTo: '.u4m-blog-post .body',
      top: 150
    });
  
});
</script>

<script src="//cdn2.hubspot.net/hub/14518100/hub_generated/template_assets/156174727468/1712250848645/cado-unified4-srw/js/main.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/scripts/jquery-3.5.1.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/hubspot.search.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/jquery.nb.offscreenMenuToggle.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/aos3.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified-assets/lazyload.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/js.cookie.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/hc-sticky.js"></script>
<script src="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156175596464/1728675367793/module_156175596464_u4m-header.min.js"></script>

    <!--[if lte IE 8]>
    <script charset="utf-8" src="https://js.hsforms.net/forms/v2-legacy.js"></script>
    <![endif]-->

<script data-hs-allowed="true" src="/_hcms/forms/v2.js"></script>

  <script data-hs-allowed="true">
      hbspt.forms.create({
          portalId: '14518100',
          formId: 'd29e7ad7-b066-4fe0-b1ea-e5dcd4c55e5a',
          formInstanceId: '898',
          pageId: '156195001978',
          region: 'na1',
          
          pageName: 'Cado Security Labs Encounter Novel Malware, Redis P2Pinfect',
          
          contentType: 'blog-post',
          
          formsBaseUrl: '/_hcms/forms/',
          
          
          inlineMessage: "<p>Thanks for subscribing!</p>",
          
          css: '',
          target: '#hs_form_target_u4m-subscribe_blog_subscribe_898',
          
          formData: {
            cssClass: 'hs-form stacked'
          }
      });
  </script>


<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cadosecurity.com\/blog\/redis-p2pinfect"]);
_hsq.push(["setPageId", "156195001978"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 156195001978,
    "legacyPageId": "156195001978",
    "contentFolderId": null,
    "contentGroupId": 156179862661,
    "abTestId": null,
    "languageVariantId": 156195001978,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/14518100.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "b13b4038-4267-4bd4-b074-6c179ce1b974",
    ticks: 1729739624983,
    page_id: 156195001978,
    
    content_group_id: 156179862661,
    portal_id: 14518100,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    analytics_page_id: "156195001978",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>

<!--
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P9BDTK9"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
 -->

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 



</body></html>