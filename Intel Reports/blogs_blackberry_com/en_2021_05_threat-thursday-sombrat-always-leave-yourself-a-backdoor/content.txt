<!DOCTYPE HTML>
<html lang="en">
    <head>
	<meta charset="UTF-8"/>

	
	









    <!-- OneTrust Cookies Consent Notice Start -->






    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="6373c986-7725-4c54-9731-2a91bdd43107"></script>


<script type="text/javascript">
    function OptanonWrapper() { }
</script>

<!-- OneTrust Cookies Consent Notice End -->


















	<title>Threat Thursday: SombRAT — Always Leave Yourself a Backdoor</title>

	<script type="application/ld+json">
	{"@context":"https://schema.org","@type":"NewsArticle","mainEntityOfPage":{"@type":"WebPage","@id":"https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor"},"headline":"Threat Thursday: SombRAT — Always Leave Yourself a Backdoor","image":["/content/dam/blogs-blackberry-com/images/blogs/2021/05/051321-sombrat-350x350-ibb.jpg","/content/dam/blogs-blackberry-com/images/blogs/2021/05/051321-sombrat-875x530-ibb.jpg"],"datePublished":"2021-05-13T01:01:00.000-07:00","author":{"@type":"Person","name":"The BlackBerry Research and Intelligence Team"},"publisher":{"@type":"Organization","name":"BlackBerry","logo":{"@type":"ImageObject","url":"https://blogs.blackberry.com/content/dam/blackberry-com/Images/logos/BlackBerry_Logo_Black_150.png"}}}
</script>


	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="description" content="The BlackBerry Research and Intelligence Team have been monitoring the threat group CostaRicto for the last two years. The latest campaigns are financially motivated ransomware attacks, and feature improvements to the backdoor, better obfuscation, and the ability to exfiltrate data prior to deploying ransomware."/>
	<meta name="keywords" content="Cybersecurity"/>
	

	<meta name="author" content="blogs.blackberry.com"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>

	<link rel="icon" href="/etc.clientlibs/bbcom/clientlibs/clientlib-etc-legacy/resources/bbcom-aem-project/images/favicon.ico"/>
	<link rel="canonical" href="https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor"/>

	<meta property="og:url" content="https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor"/>
	<meta property="og:title" content="Threat Thursday: SombRAT — Always Leave Yourself a Backdoor"/>
	<meta property="og:description" content="The BlackBerry Research and Intelligence Team have been monitoring the threat group CostaRicto for the last two years. The latest campaigns are financially motivated ransomware attacks, and feature improvements to the backdoor, better obfuscation, and the ability to exfiltrate data prior to deploying ransomware."/>
	<meta property="og:type" content="article"/>
	<meta property="og:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2021/05/051321-sombrat-875x530-ibb.jpg"/>

	<meta name="twitter:card" content="summary_large_image"/>
	<meta name="twitter:site" content="@BlackBerry"/>
	<meta name="twitter:title" content="Threat Thursday: SombRAT — Always Leave Yourself a Backdoor"/>
	<meta name="twitter:description" content="The BlackBerry Research and Intelligence Team have been monitoring the threat group CostaRicto for the last two years. The latest campaigns are financially motivated ransomware attacks, and feature improvements to the backdoor, better obfuscation, and the ability to exfiltrate data prior to deploying ransomware."/>
	<meta name="twitter:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2021/05/051321-sombrat-875x530-ibb.jpg"/>

	

	
	
    
<link rel="stylesheet" href="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.54dd5587820b16101b4a5bc26ae87194.css" type="text/css">



	
    










	
		
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TXGFP23');
</script>



<script async src="https://www.googletagmanager.com/gtag/js?id=AW-944900006"></script>

<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date()); gtag('config', 'AW-944900006');
</script>


		
	

	




<script src="https://kit.fontawesome.com/3c243f8233.js" crossorigin="anonymous"></script>


	
    
    

    
    
    
    


	
</head>
    <body class="page basicpage" data-enable-history="true">
        



	
		
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXGFP23" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


		
	

	


        
        
            



            

  
<!--
<sly data-sly-use.templatedContainer="com.day.cq.wcm.foundation.TemplatedContainer"
   data-sly-repeat.child=""
   data-sly-resource=""/>
-->

<header>
    




    
    
    
<!-- BEGIN DO NOT INDEX -->

    

<!-- skip to content: START -->
<a href='#' class='skipNav' tabindex="0">Skip Navigation</a>
<!-- skip to content: END-->
<!-- BEGIN DO NOT INDEX -->

  <nav class="blogs-navigationv2 bb-blogs-navbar navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="https://blogs.blackberry.com">
        <svg width="175px" height="30px" viewBox="0 0 175 30" version="1.1">
          <title>BlackBerry Logo</title>
          <g id="Creative" stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
              <g id="21-product-page-Protect-02.15.22" transform="translate(-91.000000, -10.000000)" fill="#FFFFFF" fillRule="nonzero">
                  <g id="BB_White" transform="translate(91.000000, 10.000000)">
                      <path d="M9.18042011,2.14285967 C9.18042011,1.19318021 8.5959918,-1.17624431e-15 6.16086942,-1.17624431e-15 C5.16247216,-1.17624431e-15 2.4107723,-1.17624431e-15 2.4107723,-1.17624431e-15 L1.33931598,4.94318021 C1.33931598,4.94318021 3.36046941,4.94318021 5.25986363,4.94318021 C8.32813214,4.91883014 9.18042011,3.48214033 9.18042011,2.14285967 Z" id="Shape"></path>
                      <path d="M19.2861873,2.14285967 C19.2861873,1.19318021 18.701759,-1.17624431e-15 16.2666366,-1.17624431e-15 C15.2682393,-1.17624431e-15 12.5165395,-1.17624431e-15 12.5165395,-1.17624431e-15 L11.4450831,4.94318021 C11.4450831,4.94318021 13.4662366,4.94318021 15.3412807,4.94318021 C18.4338993,4.91883014 19.2861873,3.48214033 19.2861873,2.14285967 Z" id="Shape_1_"></path>
                      <path d="M7.84110413,9.54545936 C7.84110413,8.59578874 7.25667582,7.4025997 4.82155344,7.4025997 C3.82315617,7.4025997 1.07145632,7.4025997 1.07145632,7.4025997 L5.68518084e-15,12.3457799 C5.68518084e-15,12.3457799 2.02115343,12.3457799 3.89619757,12.3457799 C6.96445725,12.3457799 7.84110413,10.88474 7.84110413,9.54545936 Z" id="Shape_2_"></path>
                      <path d="M17.9468713,9.54545936 C17.9468713,8.59578874 17.362443,7.4025997 14.9273206,7.4025997 C13.9289233,7.4025997 11.1772235,7.4025997 11.1772235,7.4025997 L10.1057671,12.3457799 C10.1057671,12.3457799 12.1269206,12.3457799 14.0263148,12.3457799 C17.0702244,12.3457799 17.9468713,10.88474 17.9468713,9.54545936 Z" id="Shape_3_"></path>
                      <path d="M28.5153164,6.55032938 C28.5153164,5.60064992 27.930888,4.40746971 25.4957657,4.40746971 C24.4973684,4.40746971 21.7456774,4.40746971 21.7456774,4.40746971 L20.6742211,9.35064992 C20.6742211,9.35064992 22.6953745,9.35064992 24.5704186,9.35064992 C27.6386695,9.32629985 28.5153164,7.88961005 28.5153164,6.55032938 Z" id="Shape_4_"></path>
                      <path d="M27.0542412,14.2694801 C27.0542412,13.3198006 26.4698129,12.1266204 24.0346816,12.1266204 C23.0362844,12.1266204 20.2845934,12.1266204 20.2845934,12.1266204 L19.213137,17.0698006 C19.213137,17.0698006 21.2342905,17.0698006 23.1093346,17.0698006 C26.1775943,17.0698006 27.0542412,15.6087696 27.0542412,14.2694801 Z" id="Shape_5_"></path>
                      <path d="M16.4857961,17.2889601 C16.4857961,16.3392807 15.9013678,15.1461005 13.4662366,15.1461005 C12.4678393,15.1461005 9.71614827,15.1461005 9.71614827,15.1461005 L8.64469195,20.0892807 C8.64469195,20.0892807 10.6658454,20.0892807 12.5408895,20.0892807 C15.6091492,20.0649306 16.4857961,18.6282496 16.4857961,17.2889601 Z" id="Shape_6_"></path>
                      <path d="M83.7683052,18.75 C83.5978459,19.11526 82.7455491,20.7711005 80.6026453,20.7711005 C78.1188139,20.7711005 77.1447667,18.701291 77.1447667,17.191551 C77.1447667,14.6590813 78.8493515,12.3944712 81.3575329,12.3944712 C84.0605238,12.3944712 84.6936523,14.4155717 84.7667113,14.7808317 L88.7359591,14.7808317 C88.9794775,13.2954417 87.786262,8.74187154 81.5036422,8.74187154 C76.9012483,8.74187154 73.2242102,12.4188213 73.2242102,17.3133014 C73.2242102,21.331161 75.7323917,24.4236913 80.3834769,24.4236913 C86.1790775,24.4236913 87.7375619,19.8701212 87.9323713,18.7499912 L83.7683052,18.7499912 L83.7683052,18.75 Z" id="Shape_7_"></path>
                      <path d="M53.2805356,19.8457799 C53.2805356,19.6022703 53.3535858,19.1639601 53.5483953,18.2629897 C53.7432047,17.3376603 56.5435959,4.40746971 56.5435959,4.40746971 L52.8178577,4.40746971 L49.7252479,18.6769498 C49.6034887,19.2857193 49.5304385,19.87013 49.5304385,20.3814904 C49.5304385,23.4983708 51.9412108,24.4237002 53.889314,24.4237002 C54.5711514,24.4237002 55.22863,24.3019498 55.3747393,24.2775909 C55.4477895,23.961031 56.0322266,21.2824609 56.0565767,21.1607105 C55.9835265,21.1607105 55.5695487,21.2094107 55.0825295,21.2094107 C53.6945045,21.2094107 53.2805356,20.625 53.2805356,19.8457799 Z" id="Shape_8_"></path>
                      <polygon id="Shape_9_" points="106.220152 8.76623044 101.033339 8.76623044 94.3367415 14.7808405 96.6014133 4.38311963 92.8269661 4.38311963 88.5654909 24.1071403 92.3155881 24.1071403 93.3626943 19.3100606 95.6760575 17.4837696 98.8660763 24.1071403 103.054492 24.1071403 98.5251576 15.2435096"></polygon>
                      <path d="M32.7767827,18.0194801 C33.0933514,16.6071403 35.7232832,4.38311963 35.7232832,4.38311963 C35.7232832,4.38311963 40.2769681,4.38311963 42.8338497,4.38311963 C47.9963131,4.38311963 49.2625788,7.25649924 49.2625788,8.98538995 C49.2625788,12.8327903 45.6342409,13.8555199 45.1959219,13.9772703 C45.6098908,14.1233708 47.971963,15.0487002 47.971963,18.0681802 C47.971963,21.3555199 44.9524035,24.107459 40.2526181,24.107459 C40.2526181,24.107459 38.5723834,24.107459 38.1097143,24.107459 C34.1404576,24.1314904 32.0218951,21.4042201 32.7767827,18.0194801 Z M43.905306,17.7759705 C43.905306,16.8506411 43.2965277,15.681811 40.666587,15.681811 L37.2330585,15.681811 L36.2103112,20.4545406 L40.1065088,20.4545406 C42.5903401,20.4545406 43.905306,19.3100606 43.905306,17.7759705 Z M45.1715718,9.8133102 C45.1715718,8.86363075 44.4410342,8.0357105 42.6633904,8.0357105 L38.8645931,8.0357105 L38.0122963,12.0292201 L41.9815529,12.0292201 C44.0757654,12.0292201 45.1715718,10.9821403 45.1715718,9.8133102 Z" id="Shape_10_"></path>
                      <path d="M104.515568,18.0194801 C104.832136,16.6071403 107.462068,4.38311963 107.462068,4.38311963 C107.462068,4.38311963 112.015753,4.38311963 114.572626,4.38311963 C119.735089,4.38311963 121.001364,7.25649924 121.001364,8.98538995 C121.001364,12.8327903 117.373026,13.8555199 116.934707,13.9772703 C117.348667,14.1233708 119.710748,15.0487002 119.710748,18.0681802 C119.710748,21.3555199 116.666847,24.107459 111.991394,24.107459 C111.991394,24.107459 110.311159,24.107459 109.84849,24.107459 C105.879234,24.1314904 103.76068,21.4042201 104.515568,18.0194801 Z M115.644091,17.7759705 C115.644091,16.8506411 115.035304,15.681811 112.405372,15.681811 L108.947493,15.681811 L107.924737,20.4545406 L111.820935,20.4545406 C114.329125,20.4545406 115.644091,19.3100606 115.644091,17.7759705 Z M116.910348,9.8133102 C116.910348,8.86363075 116.17981,8.0357105 114.377825,8.0357105 L110.603378,8.0357105 L109.751081,12.0292201 L113.720347,12.0292201 C115.81455,12.0292201 116.910348,10.9821403 116.910348,9.8133102 Z" id="Shape_11_"></path>
                      <path d="M146.789339,8.76623044 C142.820083,8.76623044 140.092742,11.1282408 139.191745,15.5357105 C138.802126,17.4350606 137.365401,24.1071403 137.365401,24.1071403 L141.091139,24.1071403 C141.091139,24.1071403 142.454814,17.7516204 142.893133,15.75487 C143.45322,13.1493501 144.841236,12.2483796 146.69193,12.2483796 C147.300717,12.2483796 147.665986,12.3214298 147.860795,12.3457799 C147.958196,11.8100694 148.493915,9.44805023 148.615674,8.88798965 C148.226055,8.86363957 147.592918,8.76623044 146.789339,8.76623044 Z" id="Shape_12_"></path>
                      <path d="M159.451988,30 L171.968527,8.76623044 L167.950571,8.76623044 L162.20367,18.75 L160.864354,8.74188037 C160.864354,8.74188037 158.818851,8.74188037 156.554179,8.74188037 C151.610875,8.74188037 149.054002,11.0064904 148.153005,15.316551 C147.690327,17.4594107 146.253602,24.1071315 146.253602,24.1071315 L149.97934,24.1071315 C149.97934,24.1071315 151.343015,17.8003117 151.903085,15.2678508 C152.438822,12.8084314 154.265166,12.0535613 156.23761,12.4675303 L157.016848,8.83928067 C157.601285,12.2727209 159.378911,23.2792113 159.378911,23.2792113 L155.482714,30 L159.451988,30 L159.451988,30 Z" id="Shape_13_"></path>
                      <path d="M64.0437813,17.5811699 C64.871728,17.4594195 67.2581502,17.0941595 67.599069,17.0454594 C67.5260099,17.313319 67.4529597,17.7029291 67.3799095,18.0194889 C66.9415816,19.8701388 65.0665375,21.063319 62.972325,21.063319 C61.633009,21.063319 60.8537712,20.3571492 60.8537712,19.5048788 C60.8294212,18.7987002 61.4869085,17.9464298 64.0437813,17.5811699 Z M62.6314151,13.5876603 C62.7288242,13.4415598 63.6785213,11.9561699 66.0649435,11.9561699 C67.5503688,11.9561699 68.3052565,12.4918804 68.3052565,13.1493501 C68.3052565,14.0746706 66.8198312,14.3181802 64.2142406,14.6834402 C59.7579648,15.3165598 56.9332236,16.7045406 56.9332236,19.9188301 C56.9332236,22.2077903 58.8326178,24.4237002 62.193096,24.4237002 C64.9934872,24.4237002 66.4545624,22.7435096 66.5763216,22.5974003 C66.6006717,23.0113604 66.6493719,23.62013 66.6737308,24.1071403 C66.9902906,24.1071403 69.5715222,24.1071403 70.5212282,24.1071403 C70.399469,23.4496706 70.1072504,22.1590901 70.5699283,20.1136307 C70.8134379,19.0422009 71.4952754,15.9496706 71.8361941,14.24513 C72.4936815,11.0064904 70.7160376,8.74188037 66.1867116,8.74188037 C60.3424108,8.74188037 58.6621673,12.9301906 58.3943076,13.5876603 L62.6314151,13.5876603 Z" id="Shape_14_"></path>
                      <path d="M131.862019,19.5292201 C131.715918,19.8214298 130.814921,21.0876603 128.793759,21.0876603 C125.871617,21.0876603 125.214139,18.6038995 125.28718,17.9464298 C126.845665,17.9464298 135.831275,17.9464298 136.659213,17.9464298 C136.732272,17.6785702 136.975791,16.6558493 136.975791,15.6087696 C136.975791,12.00487 134.540668,8.71753912 129.621714,8.71753912 C125.11673,8.71753912 121.512742,12.4918892 121.512742,16.9967592 C121.512742,21.3311787 124.118324,24.423709 128.745059,24.423709 C134.443259,24.423709 135.977393,19.9675391 136.123494,19.5292289 C135.100738,19.5292201 131.862019,19.5292201 131.862019,19.5292201 Z M129.670406,12.1266204 C132.178587,12.1266204 133.128284,13.6607105 133.030884,14.8782408 C131.594159,14.8782408 127.308342,14.8782408 125.84725,14.8782408 C126.042068,14.0990295 127.235283,12.1266204 129.670406,12.1266204 Z" id="Shape_15_"></path>
                      <path d="M171.979978,19.5027334 C173.12535,19.5027334 174.087452,20.4108465 174.087452,21.6216668 C174.087452,22.8557689 173.10243,23.7406002 171.979978,23.7406002 C170.834615,23.7406002 169.849603,22.8324871 169.849603,21.6216668 C169.849603,20.4108465 170.834615,19.5027334 171.979978,19.5027334 Z M171.979978,19.8520043 C171.017877,19.8520043 170.26193,20.620409 170.26193,21.6216668 C170.26193,22.6462064 171.017877,23.4146111 171.979978,23.4146111 C172.942098,23.4146111 173.675125,22.6694882 173.675125,21.6216668 C173.675125,20.620409 172.919178,19.8520043 171.979978,19.8520043 Z M171.52183,22.8557689 L171.155316,22.8557689 L171.155316,20.4108465 L172.071613,20.4108465 C172.644299,20.4108465 172.919178,20.620409 172.919178,21.109397 C172.919178,21.5518126 172.644299,21.7380934 172.277768,21.7846569 L172.964991,22.8557689 L172.552655,22.8557689 L171.911246,21.7846569 L171.49891,21.7846569 L171.49891,22.8557689 L171.52183,22.8557689 Z M171.521821,21.4819585 L171.957076,21.4819585 C172.415225,21.4819585 172.552664,21.3422501 172.552664,21.0861152 C172.552664,20.8532621 172.438127,20.7135538 172.025792,20.7135538 L171.521821,20.7135538 L171.521821,21.4819585 L171.521821,21.4819585 Z" id="Shape_16_"></path>
                  </g>
              </g>
          </g>
      </svg>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/cybersecurity">Cybersecurity</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/automotive">Automotive & IOT</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/critical-event-management">Critical Communications</a>
          </li>
        </ul>


        <ul class="navbar-nav ml-auto">
          <li class="nav-item">

            <a class="nav-link open-search-btn" role="button">
              <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                </path>
              </svg>
            </a>
            <div id="searchOverlay" class="search-overlay">
              <span class="close-search-btn" title="Close Search">×</span>
              <div class="overlay-content">
                <form id="search-form">
                  <input id="search-form--input" description="Search" data-search-url="https://blogs.blackberry.com/en/search" type="text" placeholder="Search" name="search"/>
                  <button type="submit">
                    <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                      <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                      </path>
                    </svg>
                  </button>
                </form>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>



<!-- END DO NOT INDEX -->




<!-- END DO NOT INDEX -->

    
    
    <div class="hero">

      <div class="jumbotron mastheadDefault">
        <div class="hero-container narrower" style="background-image: url( \2f content\2f dam\2f blackberry-com\2fImages\2fsupport\2f bgs\2f bnr-blue-gradient-crop.jpg)">
          
          <div class="mask  "></div>

          <div class="container headings  l-align">
            <div class="col-lg-12">
          		




    
    
    <div class="blog-name-title">

  <div class="cmp-title ">
  
  
   <!-- <span class="highlighted-text-title blogs">INSIDE</span>
   <span class="normal-text-title">BlackBerry Blog</span> -->
   <span class="normal-text-title">BlackBerry Blog</span>
  
  
  
</div>
</div>



          	</div>
          </div>
      </div>
    </div>
</div>



</header><main>
    




    
    
    <div class="section">
  <section class="section     ">
    
    <div class="container">
        




    
    
    
<ol class="breadcrumb">
    <li class="breadcrumb-item ">
        <a href="/en.html">BlackBerry Blog</a>
    </li>

    <li class="breadcrumb-item active">
        Threat Thursday: SombRAT — Always Leave Yourself a Backdoor
    </li>
</ol>

    


      
    </div>
  </section>
    

</div>


    
    
    <div class="blogsection">
    <section class="section     ">
      
      <div class="container sectionPadding py-0">
           
      <div class="col-md-9 col-lg-9 col-sm-12">
          




    
    
    <div class="cmp cmp-title blog-title row">
  

<div class="col-md-12 col-lg-12 col-sm-12">
<h1>Threat Thursday: SombRAT — Always Leave Yourself a Backdoor</h1>
</div>



    
</div>


    
    
    <div class="categorydateauthor"><!--Pulling author bio from author page-->
<div class="categorydateauthor">
<span><a title="RESEARCH &amp; INTELLIGENCE" href="/en/category/research-and-intelligence">RESEARCH &amp; INTELLIGENCE</a> / </span><span class='publish-date'></span>05.13.21 / </span>

    <span class="author"><a href="/en/author/the-blackberry-research-and-intelligence-team">The BlackBerry Research and Intelligence Team</a></span>

</div></div>


    
    
    <div class="socialsharing">

<div class="socialSharing row">
	<ul class="socialSharing-icons">
		<li>
			<a href="https://x.com/intent/tweet?url=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor&text=&via=BlackBerry" title="Share on X" target="_blank" class="x-share">
				<span class="sr-only sr-only-focusable">Share on X</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--tw" aria-hidden="true">
					<svg viewBox="0 0 1200 1227"><path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"></path></svg>
				</span>
			</a>
		</li>
		<li>
			<a href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor" title="Share on Facebook" target="_blank" class="facebook-share">
				<span class="sr-only sr-only-focusable">Share on Facebook</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--fb" aria-hidden="true">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
				</span>
			</a>
		</li>
		<li>
			<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor&title=&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
				<span class="sr-only sr-only-focusable">Share on LinkedIn</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--li" aria-hidden="true">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
				</span>
			</a>
		</li>
		<li>
			<a href="mailto:?subject=&body=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor" title="Email" class="email-share">
				<span class="sr-only sr-only-focusable">Email</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--email" aria-hidden="true">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
				</span>
			</a>
		</li>
	</ul>
</div>
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image.coreimg{.width}.jpeg/1620876019097/051321-sombrat-875x530-ibb.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/051321-sombrat-875x530-ibb.jpg" data-asset-id="88c2a9ac-423a-4429-b57a-235245d3fdb1" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/051321-sombrat-875x530-ibb.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <h3><b>Introduction</b></h3>
<p>The <a href="https://blogs.blackberry.com/en/author/the-blackberry-research-and-intelligence-team" target="_blank">BlackBerry Threat Research and Intelligence Team</a> have been actively monitoring and tracking the threat group dubbed <a href="https://www.darkreading.com/attacks-breaches/new-costaricto-hack-for-hire-group-targets-global-businesses/d/d-id/1339434" target="_blank">CostaRicto</a>, authors of the SombRAT backdoor, since Autumn 2019. We first detected the rumblings of new activity during late December 2020 and into early January 2021 with the emergence of new SombRAT backdoors in the public domain.</p>
<p>The latest campaigns employing <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.sombrat" target="_blank">SombRAT</a>, recently unveiled by <a href="https://www.fireeye.com/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html" target="_blank">FireEye</a> to be a series of financially motivated ransomware attacks, sees the backdoor receive several code updates and undergo a good deal of obfuscation aimed at frustrating researchers. In addition, their bespoke virtual machine (VM) based loader, CostaBricks, is conspicuously missing, while a vast range of post-exploitation PowerShell scripts were also uncovered. These scripts were used to perform reconnaissance, privilege escalation, password brute-forcing and Kerberos password hash scraping using a technique called AS-REP roasting.</p>
<h3><b>Key Findings</b></h3>
<ul>
<li>The attacks occurred over Christmas 2020 and continued into spring 2021, with command-and-control (C2) domains registered and malware compiled and packaged during November 2020.<br>
</li>
<li>The attackers again deployed CobaltStrike beacon, one of which was configured using indicators from a known APT10 campaign. This false flag was likely aimed at confusing analysts and researchers into performing a false attribution. This could waste researcher’s time with tuning security solutions and threat hunting. CostaRicto was also seen using an APT28 false flag in a previous campaign.</li>
<li>The bespoke SombRAT backdoors contain several updates, many of which remove features that made analysis and classification easy. Unfortunately, some of the updates appear to be a result of <a href="https://blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced" target="_blank">our last paper</a>, for example:<ul>
<li>Compilation timestamps have been overwritten with zeros</li>
<li>Program database (PDB) paths are not included</li>
<li>The internal versioning system has changed</li>
<li>Run-time-type-information (RTTI) has been removed from the binaries to prevent easy C++ class analysis</li>
<li>The code is now statically linked with a TLS library called mbedtls, which is employed to avoid using Windows® cryptographic APIs for RSA key handling (and evade EDR software)</li>
<li>Modifications to C2 commands</li>
<li>A new ASCII art message, containing the message &quot;<i>Nadie es perfecto excepto yo</i>&quot; (No one is perfect except me).</li>
</ul>
</li>
<li>During the reconnaissance phase of one campaign, attackers performed Kerberos password hash scraping using a technique called AS-REP roasting. They then exfiltrated the hashes via an online file sharing service.</li>
</ul>
<h3><b>Delivery</b></h3>
<p>Initial access to one of the recent victim’s networks occurred during December 2020 via a remote desktop solution accessed using stolen credentials. The credentials were likely obtained via the dark web approximately a month earlier. The threat actor swiftly deployed a CobaltStrike beacon shellcode stager (containing an APT10 false flag) and performed domain password brute-forcing and port scanning. They then ran several well-known penetration testing tools on the server, checking for vulnerabilities, performing domain reconnaissance, and obtaining Kerberos password hashes using AS-REP roasting. The hashes were exfiltrated from the victim’s environment via the anonymous file sharing platform <i>anonfiles</i>. This gave the attackers a chance to crack the hashes using tools such as HashCat. Finally, the threat actors deployed SombRAT (their bespoke backdoor used for persistence) to a primary domain controller and deployed further CobaltStrike beacon shellcode stagers.</p>
<p>The threat actors later returned using a privileged service account to deploy further remote access mechanisms within the environment. These included TeamViewer, AnyDesk, and a new SombRAT backdoor with an updated C2 domain.</p>
<p>Ultimately, the threat actor’s campaign was rather noisy and triggered multiple alerts. The victim responded quickly by shutting down further activity and performing remedial action, effectively thwarting the remainder of the attack.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1841115895.coreimg{.width}.jpeg/1620876019108/sombrat-fig-01.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-01.jpg" data-asset-id="7f1fd874-15b1-4462-9585-86ff4488fdb8" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-01.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 1: High-level attack timeline.</i></p>
<h3><b>Tooling</b></h3>
<p><b>CobaltStrike</b></p>
<p>CobaltStrike is a perennial threat, often observed during the early lateral movement phase of most campaigns. CostaRicto appears to be using several CobaltStrike beacon stager shellcodes, the first of which appears to be a trial version, as it still contains the EICAR antivirus test file in the configuration:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1576616714.coreimg{.width}.jpeg/1620876019120/sombrat-fig-02.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-02.jpg" data-asset-id="4e058d22-899f-4165-81d5-ea216f83078c" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-02.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 2: CobaltStrike stager with EICAR code.</i></p>
<p>The other beacon stager deployed by CostaRicto is perhaps more interesting. The bulk of its configuration is based on the <a href="https://github.com/xx0hcd/Malleable-C2-Profiles/blob/master/APT/chches_APT10.profile" target="_blank">chches_APT10</a> malleable C2 profile, which provides the same configuration as a previously-known <a href="https://unit42.paloaltonetworks.com/unit42-menupass-returns-new-malware-new-attacks-japanese-academics-organizations/" target="_blank">APT10 beacon</a>, providing a false flag in terms of attribution:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1084827583.coreimg{.width}.jpeg/1620876019131/sombrat-fig-03.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-03.jpg" data-asset-id="9c748a6a-29fb-4d20-98aa-fdc007a2c31a" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-03.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 3: CobaltStrike stager with APT10 URI and headers, but CostaRicto IP.</i></p>
<p>For both shellcodes the attackers have wrapped the payloads in a simple PowerShell loader that is subsequently obfuscated.</p>
<h3><b>Third Party Tools</b></h3>
<p>The threat actors were observed using a variety of third-party utilities, including reconnaissance tools, credential dumpers, and remote desktop software:</p>
<ul>
<li><a href="https://github.com/S3cur3Th1sSh1t/WinPwn" target="_blank">WinPwn</a> – a comprehensive PowerShell reconnaissance script that can be used to:<ul>
<li>Obtain password hashes and browser credentials</li>
<li>Perform enumeration of the network</li>
<li>Scan for vulnerabilities and perform exploitation</li>
</ul>
</li>
<li>Several additional third-party scripts are downloaded by WinPwn during execution, including Invoke-Rubeus, SharpHound3, DomainPasswordSpray, and zerologon, which were all utilised in this attack.</li>
<li><a href="https://github.com/GhostPack/Rubeus" target="_blank">Rubeus</a> – a C# toolset used for performing various Kerberos password attacks. In this incident, Rubeus was used to perform <a href="https://attack.mitre.org/techniques/T1558/004/" target="_blank">AS-REP roasting</a>, an attack that can reveal the credentials of accounts that have Kerberos pre-authentication disabled.</li>
<li><a href="https://github.com/BloodHoundAD/SharpHound3" target="_blank">SharpHound3</a> – a C# toolset primarily used to perform reconnaissance of Active Directory.</li>
<li><a href="https://github.com/dafthack/DomainPasswordSpray" target="_blank">DomainPasswordSpray</a> – a PowerShell script used to perform a password spray attack against domain users.</li>
<li>Zerologon is the name given to the cryptographic vulnerability in Netlogon that can be exploited to perform an authentication bypass. The <a href="https://github.com/nccgroup/nccfsas/tree/main/Tools/SharpZeroLogon" target="_blank">Zerologon</a> implementation contained in WinPwn is written in PowerShell. It is apparently ported from the C# implementation developed by the NCC Group's Full Spectrum Attack Simulation team.</li>
<li><a href="https://github.com/hlldz/Invoke-Phant0m" target="_blank">Invoke-Phant0m</a> – a PowerShell script that terminates event logging processes to thwart forensic analysis.</li>
<li><a href="https://www.softperfect.com/" target="_blank">SoftPerfect</a> – a commercial comprehensive network scanning tool.</li>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank">PsExec</a> – a notorious command line utility.</li>
<li><a href="https://www.teamviewer.com/en/" target="_blank">TeamViewer</a> – a legitimate remote control and remote access software, which is free of charge for non-commercial use.</li>
<li><a href="https://anydesk.com/en" target="_blank">AnyDesk</a> – a legitimate remote desktop application.</li>
</ul>
<h3><b>SombRAT</b></h3>
<p>An updated version of CostaRicto's bespoke backdoor, known as SombRAT, is used as a foothold in the early stages of the attack. The main purpose of this backdoor is data exfiltration and deployment of additional modules. Both 32-bit and 64-bit versions share the same C2 domain and were possibly compiled from the same code base.</p>
<p><b>Deployment</b></p>
<p>The backdoor is delivered as a RAR self-extracting archive called first32.exe or first64.exe, depending on the target architecture. The archive contains an encrypted PowerSploit injector (c.base64), encrypted backdoor binary (b.base64), and an XOR key used for decryption (a.base64). The internal timestamps in the RAR archive also help to give an idea of when the malware was initially packaged for deployment:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1490895562.coreimg{.width}.jpeg/1620876019143/sombrat-fig-04.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-04.jpg" data-asset-id="d3ebc3bd-13eb-49f5-8cd8-e0a24c219548" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-04.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 4: Content of the SXF archive.</i></p>
<p>In order to decrypt and execute the injector, the attackers drop and run a series of obfuscated batch and PowerShell scripts. The injector is very similar to the one used in previous campaigns and will load the decrypted backdoor directly into memory:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_847997420.coreimg{.width}.jpeg/1620876019154/sombrat-fig-05.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-05.jpg" data-asset-id="b6d8a0fb-a2f9-44e8-957e-29b453dcb931" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-05.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 5: Obfuscated 1st stage script (BAT).</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1493610330.coreimg{.width}.jpeg/1620876019166/sombrat-fig-06.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-06.jpg" data-asset-id="0b29b77b-14c4-4c76-ba44-418ad22e8466" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-06.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 6: Obfuscated 2nd stage script (PS1).<br>
<br>
</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_736206705.coreimg{.width}.jpeg/1620876019178/sombrat-fig-07.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-07.jpg" data-asset-id="fa25174b-cc35-491e-8a32-6e38f0de1f17" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-07.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 7: SombRAT deployment process.</i></p>
<h3><b>What’s New?</b></h3>
<p><i><b>Bye Bye, CostaBricks</b></i></p>
<p>All SombRAT samples observed, regardless of architecture, were deployed using a PowerSploit-based injector. This is a clear divergence from previous campaigns in which the x86 backdoors were protected by a bespoke virtual machine-based loader dubbed CostaBricks. We dissected CostaBricks in our <a href="https://blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced" target="_blank">previous report</a>. While it's a neat little piece of code, it has probably proven less stealthy, and therefore less effective, than the simpler PowerSploit solution.</p>
<p>The disadvantage of CostaBricks is that a VM-based mechanism can trigger alerts from antivirus (AV) solutions. This kind of behaviour is suspicious and often related to malware. Moreover, its distinct code makes it easy to configure hunting rules. Since the backdoor is stored inside the loader binary, having the loader means being able to obtain the decrypted backdoor. The PowerSploit approach, which segregates the components, poses less risk of the backdoor being leaked to platforms such as VirusTotal and dissected by researchers.</p>
<p><i><b>Covering Tracks</b></i></p>
<p>The attackers clearly like to keep an eye on research publications about their campaigns - and they learn their lessons. The new SombRAT versions that appeared after our first CostaRicto report contain numerous changes aimed at making analysis and attribution more difficult:</p>
<ul>
<li>The compilation timestamp field in the PE headers of all new SombRAT binaries has been nulled out.</li>
<li>Debugging information (including PDB paths) has been stripped from the binaries.</li>
<li>Run-time-type-information (RTTI) has been removed. The RTTI present in previous samples contained original class names. This greatly assisted our researchers in mapping the numerous C++ classes that SombRAT code is based on.</li>
<li>The versioning system has changed from sequential numbers to MD5-like hashes. Combined with the lack of PE timestamps, it becomes more difficult to map chronology of the backdoor versions:</li>
</ul>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_100340372.coreimg{.width}.jpeg/1620876019189/sombrat-fig-08.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-08.jpg" data-asset-id="fe7b23ad-32eb-45f9-83a7-17a64c71891a" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-08.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 8: Version number comparison: old versioning system (above) and new versioning system (below).</i></p>
<ul>
<li>All cryptographic functions are now performed by the statically linked mbedtls library. This makes the task of analysis slightly more tedious and serves to thwart EDR software that relies upon hooking the Windows cryptographic APIs. The embedded RSA key for C2 communications is stored in PEM format (as opposed to Windows BLOB in previous samples), and additionally obfuscated with a single byte XOR:</li>
</ul>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_2045110290.coreimg{.width}.jpeg/1620876019201/sombrat-fig-09.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-09.jpg" data-asset-id="56325a19-a674-4f1c-aa8f-33cda35d85c1" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-09.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 9: Decryption of RSA key (redacted for clarity).</i></p>
<ul>
<li>Sensitive strings remain obfuscated with a 1-byte XOR. In addition to the variable XOR key stored at the beginning of the string, there is another hardcoded one-byte key. This key is the same for all strings and shared across all the samples from this campaign.</li>
<li>Two new routines were added upon the malware execution. If the backdoor detects it is being invoked via cmd.exe, it will immediately terminate. It will also overwrite the command line entry in its Process Environment Block (PEB) with the file name of the parent process in order to conceal the original command line it was executed with.</li>
</ul>
<p><i><b>The Skull of Sombra</b></i></p>
<p>Based on PDB paths found in some older samples, we established that the backdoor has been dubbed “Sombra” by its creators. We assumed that the name refers to a female hacker character from the Overwatch game by Blizzard Entertainment. It turns out that our assumption was correct. Although the PDBs are no longer present in the newest samples, the malware authors decided to add a carefully crafted footprint to their backdoor – one that confirms beyond any doubt the provenance of the name they gave to the project.</p>
<p>After executing the malicious routine via a service dispatcher, and right before exiting, the malware will print a long base64-encoded string to the standard output. The encoded data contains an ASCII art representation of a skull. The skull is identical to the one that was part of a <a href="https://wiki.gamedetectives.net/index.php?title=Sombra_ARG" target="_blank">puzzle published by Blizzard</a> before the release of the Sombra character. To solve the original puzzle, gamers had to use a slightly different skull, posted by the developers on the Blizzard forum. Will the attackers use this opportunity to send us a hidden message, too? We will certainly keep an eye on it.</p>
<p>The threat actor also added a plain-text message as a personal touch to the copy-pasted ASCII art: a sentence that reads &quot;<b><i>Nadie es perfecto excepto yo</i></b><i>.</i>&quot; (Spanish for &quot;<i>No one is perfect except me</i>&quot;). This sentence doesn’t seem to be related to the Overwatch game, apart from using the same language as the Sombra puzzles:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1887461116.coreimg{.width}.jpeg/1620876019212/sombrat-fig-10.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-10.jpg" data-asset-id="e9f24992-bc76-48c3-b61e-7ed9d4b8d857" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-10.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 10: Code printing base64-encoded ASCII art to standard output.</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_743326384.coreimg{.width}.jpeg/1620876019224/sombrat-fig-11.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-11.jpg" data-asset-id="678e25e2-9aba-489f-a8b7-bde778bebdf7" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-11.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 11: Decoded ASCII art.</i></p>
<p><i><b>Backdoor Commands</b></i></p>
<p>The set of backdoor commands remains more or less the same as described in our <a href="https://blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced" target="_blank">previous report</a>. A few commands have been removed and some functionality improvements/code tweaks were made to the existing commands. Below is the list of more significant changes, sorted by internal modules to which the commands belong.</p>
<p><b>Core</b></p>
<p>The Core module is responsible for commands related to initiating C2 communication, loading additional modules, retrieving system information and bot maintenance. These commands include:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_237012807.coreimg{.width}.jpeg/1620876019236/sombrat-fig-12.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-12.jpg" data-asset-id="a1f25bf5-90c6-471e-94f3-5b3ae1672660" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-12.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 12: List of Core module commands (changes from previous versions highlighted).</i></p>
<p>The commands <b>updatemyself</b> and <b>restart</b> were removed from this version of SombRAT.</p>
<p>The malware authors added a possibility of loading two external plugins from storage: <b>injector</b> and <b>keylog</b>. The names of these plugins are hardcoded in the binary.</p>
<p>The <b>uninstall</b> command, previously unimplemented, will now close and delete the storage file, and remove all installation files, overwriting them with random bytes before deletion.</p>
<p>In the <b>getinfo</b> command, the bot versioning system changed from sequential to MD5-like; there are also slight changes to the system information sent to the C2:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1818633918.coreimg{.width}.jpeg/1620876019247/sombrat-fig-13.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-13.jpg" data-asset-id="659d67ad-3c70-4dc4-911d-183481435117" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-13.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 13: System information sent to the C2.</i></p>
<p><b>Storage</b></p>
<p>The Storage module provides functionality for dropping additional files to the victim’s machine, as well as uploading content from the victim to the C2 server. A single storage file implementing a custom encrypted filesystem is used for keeping all additional data, either downloaded from the C2 or cached for upload:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1066881979.coreimg{.width}.jpeg/1620876019259/sombrat-fig-14.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-14.jpg" data-asset-id="c5c44ae4-5855-4648-9cf4-18b29f241ebf" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-14.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 14: List of Storage module commands.</i></p>
<p>The new version of SombRAT sees two commands removed: <b>await&amp;create</b>, <b>await&amp;putcontent</b>.</p>
<p>The <b>enum</b> command now also returns the storage statistics that are read from the storage file header (<b>statstotal</b>, <b>statsused</b>, <b>statsfree</b>, <b>statsondisk</b>, <b>statssessions</b>).</p>
<p>The default filename for the storage file and the corresponding mutex name are now generated by encrypting a hardcoded string <b>Initiating The Hack</b> with AES-128-CBC (using the hardcoded key: <b>Xn2r5u8x/A?D(G+K),</b> and converting the encrypted data into a hex string:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_479043717.coreimg{.width}.jpeg/1620876019270/sombrat-fig-15.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-15.jpg" data-asset-id="f03ab02e-e864-44f1-8d7f-1b445a7a8998" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-15.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 15: Storage file name generation.</i></p>
<p>Upon initialization of the storage module, an empty 2MB storage file is created. Initially, it contains mostly zeroes except for the file table and the first 12 bytes of the storage header:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_914894914.coreimg{.width}.jpeg/1620876019282/sombrat-fig-16.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-16.jpg" data-asset-id="a8781496-d527-4ac6-824f-ffca55b2cee6" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-16.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 16: Default empty storage file.</i></p>
<p>The values used to initialize storage files are hardcoded in the backdoor binary and include:</p>
<ul>
<li>Two flags of unclear purpose (0x01 and 0x02)</li>
<li>Offset to the file table (0x1000)</li>
<li>The initial size of the storage file in DWORDs (0x800000)</li>
</ul>
<p>While any potential storage content that follows the file table is supposed to be encrypted, the table itself remains unencrypted and is initialized with 0xFF bytes. A file table entry is expected to start with a value of 0xFFFFFFFE (for empty files) or 0xFFFFFFFD (for non-empty files) and is followed by the file metadata. The metadata includes information such as:</p>
<ul>
<li>File size</li>
<li>Length of the encrypted file ID (up to 1024 bytes)</li>
<li>File ID encrypted with AES-256-CBC</li>
<li>Offset to the file content in the storage data</li>
</ul>
<p>The AES encryption key is hardcoded in the binary and is used for both file ID and data: <b>p3s6v9y$B&amp;E)H@MbQeThWmZq4t7w!z%C.</b></p>
<p>So far, we’ve only encountered “empty” storage files on the filesystems where SombRAT had been active.</p>
<h3><b>Network</b></h3>
<p>The set of commands serviced by the Network module is related to managing the C2 communication protocol:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1141980255.coreimg{.width}.jpeg/1620876019293/sombrat-fig-17.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-17.jpg" data-asset-id="724a0579-f172-4a7c-bd47-b585b3949dce" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-17.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 17: List of Network module commands.</i></p>
<p>There are no major functionality changes in the network-related commands; however, the internal structures to the network protocol were somewhat altered.</p>
<p>As in the previous versions, the backdoor communicates with the C2 through a DNS tunnel by default. The communication protocol can be switched to a TCP-based one on request. All sensitive data that is sent or received is Zlib-compressed and encrypted with AES-256 using a randomly generated key. An embedded RSA-2048 public key is then used to secure the AES key exchange.</p>
<p>The DGA algorithm used for initiating communication is the same as previously used. Now, instead of using an “images” prefix, the backdoor simply prepends the letter “b” to the generated subdomain name. This subdomain is then used in a DnsQuery call in order to retrieve the associated IP address. This C2 IP will be later used to authenticate messages and derive the XOR key for additional message obfuscation.</p>
<p>The C2 communication is initialized with a simple 'PING' message sent from the victim as a DNS_TYPE_A request. The message header contains randomly generated byte, followed by bytes 4 and 3 of the previously obtained C2 IP address. The sequence byte is set to 1. The message body (string 'PING') and following 2-bytes of the checksum, is XORed with a key derived from the first 2 bytes of the C2 IP address. The whole message, including the header, is then additionally XORed with its first byte (omitting the bytes that are equal to that byte):</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1477578282.coreimg{.width}.jpeg/1620876019305/sombrat-fig-18.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-18.jpg" data-asset-id="35a7bc8c-6270-40ff-a32a-416643f544fe" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-18.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 18: Basic C2 message format in DNS tunneling (DNS_TYPE_A request).</i></p>
<p>Finally, the obfuscated data is converted to a hex string, prepended to the C2 domain, and transmitted via a DNS query:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1307138115.coreimg{.width}.jpeg/1620876019317/sombrat-fig-19.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-19.jpg" data-asset-id="59788c10-1ac0-410e-9efd-608aa64baf8e" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-19.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 19: Example of an initial DNS ‘PING’ message.</i></p>
<p>The attacker’s DNS server should respond with an IP address where the first 2 bytes are equal to the checksum of the request’s subdomain. This will establish a backdoor session.</p>
<p>Once a connection is successfully established the backdoor sends a DNS_TYPE_TXT request, which is a request for commands.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_2040511390.coreimg{.width}.jpeg/1620876019328/sombrat-fig-20.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-20.jpg" data-asset-id="7b507dea-f46f-484d-8674-6c81ad089fcd" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-20.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 20: Basic C2 message format in DNS tunneling (DNS_TYPE_TXT request).</i></p>
<p>There are 3 types of DNS_TYPE_TXT responses that can be issued by the C2:</p>
<ul>
<li>Starting with 0x40 byte ('@') - no commands at the moment, keep connection alive.</li>
<li>Starting with 0x23 byte ('#') - end session.</li>
<li>Response containing a command, which starts with the XOR byte, followed by a 2-byte checksum of corresponding request, the message body, and a 2-byte checksum of the response.</li>
</ul>
<p>The initial command from the C2 is expected to contain “PING” as a message. The backdoor will respond by sending out system information and an embedded RSA public key.</p>
<p><b>Taskman</b></p>
<p>Taskman commands are used for manipulating processes:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_776265713.coreimg{.width}.jpeg/1620876019340/sombrat-fig-21.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-21.jpg" data-asset-id="88ce3fcb-a5dc-4719-9466-4509a244c562" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-21.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 21: List of Taskman module commands.</i></p>
<p>Information sent to the C2 in response to each of these commands now contains two additional fields:</p>
<ul>
<li><b>iswow</b>, which specifies if the process is 32- or 64-bit</li>
<li><b>threadscount</b>, which specifies the number of threads associated with the process.</li>
</ul>
<p><b>Debug</b></p>
<p>Currently this module contains only one command, <b>debuglog</b>, which is used to enable/disable logging. There were no changes in its functionality since the previous SombRAT version.</p>
<p><b>Config</b></p>
<p>This module was used to handle commands related to the config file. The config class and functionality has since been removed, together with all corresponding backdoor commands.</p>
<h3><b>Network Infrastructure</b></h3>
<p><b>feticost[dot]com</b></p>
<p>The feticost domain was registered a month prior to the attack and used exclusively for C2 communications with the SombRAT backdoor:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_265122914.coreimg{.width}.jpeg/1620876019351/sombrat-fig-22.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-22.jpg" data-asset-id="132da295-d315-4424-abfe-1aae9b3393b4" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-22.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 22. Heatmap of feticost IP resolutions.</i></p>
<p>The domain was registered via Njalla, a “privacy-aware” domain registration service, operating from Saint Kitts and Nevis. It is run by Peter Sunde, co-founder of The Pirate Bay:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1018965648.coreimg{.width}.jpeg/1620876019363/sombrat-fig-23.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-23.jpg" data-asset-id="532dff14-2c57-4ba9-843c-d7b07033f5cf" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-23.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 23: Domain registrant details (redacted for privacy).</i></p>
<p>Several open ports were exposed on this server:</p>
<ul>
<li>OpenSSH used for remote management</li>
<li>DNS used to provide SombRAT domain generation and DNS tunneling capabilities</li>
<li>ports 80, 8000, and 443 also used for SombRAT C2.</li>
</ul>
<p>SombRAT will generate many subdomains as part of its domain generation algorithm (DGA) during C2 initialisation, yet very few were found to be active for feticost. However, the primary DGA subdomain, b71260938323880754443f274390[dot]feticost[dot]com, remains active with its C2 IP addresses changing fairly frequently.</p>
<p><b>celomito[dot]com</b></p>
<p>The celomito domain was also registered via Njalla, but only a few days prior to use:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor/_jcr_content/main/par/sectionblog/par/image_1527922135.coreimg{.width}.jpeg/1620876019374/sombrat-fig-24.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-24.jpg" data-asset-id="91a41a19-5195-42cd-bc6e-581d57f501ff" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/05/sombrat-fig-24.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 24: Heatmap of celomito IP resolutions.</i></p>
<p>This domain was again used for SombRAT C2 communications, with several subdomains being actively employed as part of the DGA:</p>
<ul>
<li>b27543ffd5a3949c5d483e2b4705.celomito.com</li>
<li>5dc5a95caaaad5ce6ef4.celomito.com</li>
<li>bd1540dda.celomito.com</li>
</ul>
<p><b>64.227.24.12 &amp; 157.230.184.142</b></p>
<p>These hosts were deployed by the threat actors to host CobaltStrike Team Server. We first observed these hosts being operationalised on 2020-12-01, as part of our in-house CS beacon tracking services.</p>
<h3><b>Conclusions</b><br>
</h3>
<p>Costaricto’s activity, ranging from espionage to ransomware, may be representative of an evolving threat actor broadening their services. Yet making definitive claims about this group is challenging, even with the evidence presented here. For example, is this most recent campaign the work of hackers-for-hire, or simply the result of a backdoor for sale? The tactics, techniques, and procedures (TTPs) used in recent SombRAT attacks differ from previous ones. This might mean a new threat actor has simply acquired the backdoor.</p>
<p>Then again, the original threat actors may be using SombRAT in new ways, adjusting their tactics to better fit the new environment. This explanation may be more likely. If SombRAT were widely available for purchase or trade it would probably appear more often in the public domain. Either way, SombRAT is being actively maintained, receiving code improvements, better obfuscation, and new feature updates. One particularly concerning development is SombRAT’s ability to exfiltrate data prior to deploying ransomware.</p>
<p>While precise attribution is difficult, our research indicates the latest SombRAT attacks were likely operated from the Latin American region.</p>
<h3><b>BlackBerry Assistance</b></h3>
<p><i>If you're battling an attack like this or a similar threat, help is at hand, regardless of your existing BlackBerry relationship.</i></p>
<p><a href="https://www.blackberry.com/us/en/services/incident-response" target="_blank"><i>The BlackBerry Incident Response Team</i></a><i> is made up of world-class consultants dedicated to handling response and containment services for a wide range of incidents, including ransomware and Advanced Persistent Threat (APT) cases.</i></p>
<p><i>We have a global consulting team standing by to assist you by providing around-the-clock support, where required, as well as local assistance. Please contact us here: </i><a href="https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment" target="_blank"><i>https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment.<br>
 <br>
</i></a></p>
<h3><b>Appendix</b></h3>
<h3>Indicators of Compromise (IoCs)</h3>
<table cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="329" valign="top"><p><b>Indicator</b></p>
</td>
<td width="60" valign="top"><p><b>Type</b></p>
</td>
<td width="234" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td width="329" valign="top"><p>d81c13b094c59196ac45c5f0ec95446dea219fa2f2a1c35a25f883d2a18ab19d</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>SombRAT x86</p>
</td>
</tr><tr><td width="329" valign="top"><p>99baffcd7a6b939b72c99af7c1e88523a50053ab966a079d9bf268aff884426e</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>SombRAT x64</p>
</td>
</tr><tr><td width="329" valign="top"><p>61e286c62e556ac79b01c17357176e58efb67d86c5d17407e128094c3151f7f9</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>SombRAT x64</p>
</td>
</tr><tr><td width="329" valign="top"><p>da97c5162cb3929f873936a4fb6311e0ce373f0fce3b94470da26906529317b2</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>first32.exe - RAR SFX Dropper for a/b/c.base64</p>
</td>
</tr><tr><td width="329" valign="top"><p>01a214f011e6b92eb9844e19a49835c11a7e56116d8b21b2ee370589f6f08b82</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>first64.exe - RAR SFX Dropper for a/b/c.base64 and WwanSvc.bat</p>
</td>
</tr><tr><td width="329" valign="top"><p>84e5191cff128754215a712d8be2621bf99170d4225a60b8f4e0a9f866f9338e</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>Install.bat - Installation, service creation and clean-up</p>
</td>
</tr><tr><td width="329" valign="top"><p>72e8a12fdd375984e20935c13fd2160ee4c532122ba75eaa07d6ab95d8a79cb6</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>base64.exe</p>
</td>
</tr><tr><td width="329" valign="top"><p>ba0e52cc29751b983bdd34d5e59e9b6a7af8d6ddde3b5d545eb95bc3c47a4b27</p>
</td>
<td width="60" valign="top"><p>SHA256</p>
</td>
<td width="234" valign="top"><p>WwanSvc.bat</p>
</td>
</tr><tr><td colspan="3" width="623" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="329" valign="top"><p>-exec( ){1,}bypass( ){1,}-file( ){1,}C\:\\windows\\tasks\\(.){1,}.ps1</p>
</td>
<td width="60" valign="top"><p>Command-line</p>
</td>
<td width="234" valign="top"><p>PowerShell used to launch script from C:\Windows\Tasks folder</p>
</td>
</tr><tr><td width="329" valign="top"><p>cmd\.exe\|echo\|\&gt;\|\\\\\.\\pipe\\</p>
</td>
<td width="60" valign="top"><p>Command-line</p>
</td>
<td width="234" valign="top"><p>Echo stdout from cmd.exe to a named pipe</p>
</td>
</tr><tr><td colspan="3" width="623" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="329" valign="top"><p>WwanService</p>
</td>
<td width="60" valign="top"><p>Service name</p>
</td>
<td width="234" valign="top"><p>Installation scheduled task name</p>
</td>
</tr><tr><td colspan="3" width="623" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="329" valign="top"><p>autorun.ps1.txt</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>Decode and execute ntuser.c</p>
</td>
</tr><tr><td width="329" valign="top"><p>C:\programdata\Microsoft\WwanSvc.bat</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>Installation scheduled task batch script</p>
</td>
</tr><tr><td width="329" valign="top"><p>first32.exe</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>RAR SFX dropper for SombRAT</p>
</td>
</tr><tr><td width="329" valign="top"><p>first64.exe</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>RAR SFX dropper for SombRAT</p>
</td>
</tr><tr><td width="329" valign="top"><p>(a.base64|ntuser.a|WwanSvc.a)</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>XOR key used to decode the PS loader script and payload</p>
</td>
</tr><tr><td width="329" valign="top"><p>(b.base64|ntuser.b|WwanSvc.b)</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>XOR encoded payload</p>
</td>
</tr><tr><td width="329" valign="top"><p>(c.base64|ntuser.c|WwanSvc.c)</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>XOR encoded PS reflective PE loader script</p>
</td>
</tr><tr><td width="329" valign="top"><p>my(15|16|420).ps1</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>PowerShell loader for CobaltStrike beacon shellcode</p>
</td>
</tr><tr><td width="329" valign="top"><p>C:\Windows\Temp\9ACF219F1F0DEE49</p>
</td>
<td width="60" valign="top"><p>Filename</p>
</td>
<td width="234" valign="top"><p>SombRAT structured storage file</p>
</td>
</tr><tr><td colspan="3" width="623" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="329" valign="top"><p>feticost[.]com</p>
</td>
<td width="60" valign="top"><p>Domain</p>
</td>
<td width="234" valign="top"><p>SombRAT C2</p>
</td>
</tr><tr><td width="329" valign="top"><p>celomito[.]com</p>
</td>
<td width="60" valign="top"><p>Domain</p>
</td>
<td width="234" valign="top"><p>SombRAT C2</p>
</td>
</tr><tr><td width="329" valign="top"><p>bd1540dda.celomito[.]com</p>
</td>
<td width="60" valign="top"><p>Domain</p>
</td>
<td width="234" valign="top"><p>SombRAT C2 (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>5dc5a95caaaad5ce6ef4.celomito[.]com</p>
</td>
<td width="60" valign="top"><p>Domain</p>
</td>
<td width="234" valign="top"><p>SombRAT C2 (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>b27543ffd5a3949c5d483e2b4705.celomito[.]com</p>
</td>
<td width="60" valign="top"><p>Domain</p>
</td>
<td width="234" valign="top"><p>SombRAT C2 (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>^b[a-zA-Z0-9]{3,64}\.(celomito|feticost)\[.]com</p>
</td>
<td width="60" valign="top"><p>Domain</p>
</td>
<td width="234" valign="top"><p>SombRAT C2 DGA/DNS tunneling</p>
</td>
</tr><tr><td colspan="3" width="623" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="329" valign="top"><p>51.89.50.152</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com</p>
</td>
</tr><tr><td width="329" valign="top"><p>57.219.0.1</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>celomito[.]com</p>
</td>
</tr><tr><td width="329" valign="top"><p>19.134.94.227</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>88.105.224.32</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>180.222.29.199</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>119.39.152.157</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>109.124.209.212</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>119.170.44.215</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>226.31.10.29</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>156.77.252.190</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>135.78.65.199</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>30.24.7.206</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>229.222.231.39</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>22.58.50.80</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>218.10.128.138</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>245.179.63.52</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>98.160.54.99</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>200.72.40.81</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>229.228.106.12</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>feticost[.]com (DGA) C2 beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>71.61.21.41</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>b27543ffd5a3949c5d483e2b4705.celomito[.]com</p>
</td>
</tr><tr><td width="329" valign="top"><p>79.93.190.81</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>b27543ffd5a3949c5d483e2b4705.celomito[.]com</p>
</td>
</tr><tr><td width="329" valign="top"><p>64.227.24.12</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>CobaltStrike beacon</p>
</td>
</tr><tr><td width="329" valign="top"><p>157.230.184.142</p>
</td>
<td width="60" valign="top"><p>IP</p>
</td>
<td width="234" valign="top"><p>CobaltStrike beacon</p>
</td>
</tr></tbody></table>
<p>&nbsp;</p>
<p>&nbsp;</p>

    
    
</div>


    
    
    <div class="authorblog"><!--Pulling author bio from author page-->

    
    
        
  



<div class="author-info" data-author-name="The BlackBerry Research and Intelligence Team" data-author-path="https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor">
  <div class="author-avatar">
    
    <img src="/content/dam/blogs-blackberry-com/images/authors/blackberry-logo-square.jpg" class="author-avatar" alt="The BlackBerry Research and Intelligence Team"/>				
    
  </div><!-- .author-avatar -->
  <div class="author-description">
      
    
    <h2>About The BlackBerry Research and Intelligence Team</h2>
    <p>The <a href="https://blogs.blackberry.com/en/author/the-blackberry-research-and-intelligence-team" target="_blank">BlackBerry Research and Intelligence team</a> is a highly experienced threat research group specializing in a wide range of cybersecurity disciplines, conducting continuous threat hunting to provide comprehensive insights into emerging threats. We analyze and address various attack vectors, leveraging our deep expertise in the cyberthreat landscape to develop proactive strategies that safeguard against adversaries.</p>
<p>Whether it's identifying new vulnerabilities or staying ahead of sophisticated attack tactics, we are dedicated to securing your digital assets with cutting-edge research and innovative solutions.</p>

  </div><!-- .author-description	-->
</div>
<hr class="author-hr"/>
    
</div>


    
    
    <div class="socialsharing">

<div class="socialSharing row">
	<ul class="socialSharing-icons">
		<li>
			<a href="https://x.com/intent/tweet?url=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor&text=&via=BlackBerry" title="Share on X" target="_blank" class="x-share">
				<span class="sr-only sr-only-focusable">Share on X</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--tw" aria-hidden="true">
					<svg viewBox="0 0 1200 1227"><path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"></path></svg>
				</span>
			</a>
		</li>
		<li>
			<a href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor" title="Share on Facebook" target="_blank" class="facebook-share">
				<span class="sr-only sr-only-focusable">Share on Facebook</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--fb" aria-hidden="true">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
				</span>
			</a>
		</li>
		<li>
			<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor&title=&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
				<span class="sr-only sr-only-focusable">Share on LinkedIn</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--li" aria-hidden="true">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
				</span>
			</a>
		</li>
		<li>
			<a href="mailto:?subject=&body=https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor" title="Email" class="email-share">
				<span class="sr-only sr-only-focusable">Email</span>
				<span class="svgIcon-socialSharing svgIcon-socialSharing--email" aria-hidden="true">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
				</span>
			</a>
		</li>
	</ul>
</div>
</div>


    
    
    <div class="backbutton">
<a href="javascript:history.back()" class="cta cta-primary btn-back-button">Back</a></div>



      </div>
      
          
      </div>
    </section>
      
  
  
</div>



</main><footer data-no-snippet>
	<div class="container pt-2">
		<nav id="footerNav">
			<div>
				<div class="row my-4">
					<div class="socialLinks col-lg-4 col-md-4 col-sm-12 pb-3">
						<a href="https://www.facebook.com/BlackBerry/" class="socialLink" target="_blank" rel="noopener" style="padding-left: 0 !important;">
							<span class="sr-only" aria-label="BlackBerry Facebook Account">Facebook</span>
							<span class="svgIcon-social" aria-hidden="true">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 56.7v398.5c0 13.7-11.1 24.7-24.7 24.7H309.1V306.5h58.2l8.7-67.6h-67v-43.2c0-19.6 5.4-32.9 33.5-32.9h35.8v-60.5c-6.2-.8-27.4-2.7-52.2-2.7-51.6 0-87 31.5-87 89.4v49.9h-58.4v67.6h58.4V480H24.7C11.1 480 0 468.9 0 455.3V56.7C0 43.1 11.1 32 24.7 32h398.5c13.7 0 24.8 11.1 24.8 24.7z"/></svg>
							</span>
						</a>
						<a href="https://x.com/blackberry" target="_blank" class="socialLink" rel="noopener">
							<span class="sr-only" aria-label="BlackBerry X Account">X</span>
							<span class="svgIcon-social">
								<svg width="28" height="28" viewBox="0 0 1200 1227"><path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="#000"></path></svg>
							</span>
						</a>
						<a href="https://www.youtube.com/user/BlackBerry" target="_blank" class="socialLink" rel="noopener">
							<span class="sr-only" aria-label="BlackBerry YouTube Account">YouTube</span>
							<span class="svgIcon-social">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
							</span>
						</a>
						<a href="https://www.instagram.com/blackberry/" target="_blank" class="socialLink" rel="noopener">
							<span class="sr-only" aria-label="BlackBerry Instagram Account">Instagram</span>
							<span class="svgIcon-social">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
							</span>
						</a>
					</div>
					
				</div>
				<hr/>
				<div class="row mt-5">
					<div class="col-xs-12 col-md-4">
						
							<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse21" aria-expanded="false" aria-controls="collapse21">
								<h3>
									Corporate
									<span class="open">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
									</span>
									<span class="closed">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
									</span>
								</h3>
							</a>
							
								<div id="collapse21" class="collapse in">
									<ul>
										<li>
											
											<a href="https://www.blackberry.com/us/en/company" rel="noopener" target="_blank">Company</a>
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/company/newsroom" target="_blank">Newsroom</a>
											
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/company/investors" target="_blank">Investors</a>
											
										</li>
									
										<li>
											
											<a href="https://www.blackberry.com/us/en/company/careers" rel="noopener" target="_blank">Careers</a>
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/company/leadership" target="_blank">Leadership</a>
											
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/company/corporate-responsibility-at-blackberry" target="_blank">Corporate Responsibility</a>
											
										</li>
									
										<li>
											
											<a href="https://www.blackberry.com/us/en/company/certifications" rel="noopener" target="_blank">Certifications</a>
										</li>
									
										<li>
											
											<a href="https://www.blackberry.com/us/en/success-stories" rel="noopener" target="_blank">Customer Success</a>
										</li>
									</ul>
								</div>
							
						
					</div>
					<div class="col-xs-12 col-md-4">
						
							<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse31" aria-expanded="false" aria-controls="collapse31">
								<h3>
									Developers
									<span class="open">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
									</span>
									<span class="closed">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
									</span>
								</h3>
							</a>
							
								<div class="collapse in" id="collapse31">
									<ul>
										<li>
											
											<a href="https://developers.blackberry.com/" rel="noopener" target="_blank">Enterprise Platform &amp; Apps</a>
										</li>
									
										<li>
											
											<a href="https://www.qnx.com/account/login.html?returnaddress=%2Fdownload%2Fgroup.html%3Fprogramid%3D29178" rel="noopener" target="_blank">BlackBerry QNX Developer Network</a>
										</li>
									</ul>
								</div>
							
						
							<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse32" aria-expanded="false" aria-controls="collapse32">
								<h3>
									Blogs
									<span class="open">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
									</span>
									<span class="closed">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
									</span>
								</h3>
							</a>
							
								<div class="collapse in" id="collapse32">
									<ul>
										<li>
											
											<a href="https://blogs.blackberry.com/" rel="noopener">BlackBerry ThreatVector Blog</a>
										</li>
									
										<li>
											
											<a href="https://devblog.blackberry.com/" rel="noopener" target="_blank">Developers Blog</a>
										</li>
									
										<li>
											
											<a href="https://helpblog.blackberry.com/" rel="noopener" target="_blank">Help Blog</a>
										</li>
									</ul>
								</div>
							
						
					</div>
					<div class="col-xs-12 col-md-4">
						
							<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse41" aria-expanded="false" aria-controls="collapse41">
								<h3>
									Legal
									<span class="open">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
									</span>
									<span class="closed">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
									</span>
								</h3>
							</a>
							
								<div id="collapse41" class="collapse in">
									<ul>
										<li>
											<a href="https://www.blackberry.com/us/en/legal" target="_blank">Overview</a>
											
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/legal/accessibility" target="_blank">Accessibility</a>
											
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/legal/blackberry-virtual-patent-marking" target="_blank">Patents</a>
											
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/legal/trademarks" target="_blank">Trademarks</a>
											
										</li>
									
										<li>
											<a href="https://www.blackberry.com/us/en/legal/privacy-policy" target="_blank">Privacy Policy</a>
											
										</li>
									</ul>
								</div>
							
						
					</div>
				</div>
			</div>
			<div class="container">
				<div class="row tm10" style="padding-top: 50px;">
					<div class="col-xs-12 col-md-6 copyright">
						<p>© 2024 BlackBerry Limited. All rights reserved.</p>
					</div>
				</div>
			</div>
		</nav>
	</div>
</footer>

            
    
    
    
    
<script src="/etc.clientlibs/shared/clientlibs/jquery.min.96704cdeb2f89f0504fd10b631047e4f.js"></script>
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-dependencies.min.d41d8cd98f00b204e9800998ecf8427e.js"></script>





    
    
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.70a468767a2e0665e8f087baab63f77b.js"></script>




    

    

    
    
    

            

        
    </body>
</html>
