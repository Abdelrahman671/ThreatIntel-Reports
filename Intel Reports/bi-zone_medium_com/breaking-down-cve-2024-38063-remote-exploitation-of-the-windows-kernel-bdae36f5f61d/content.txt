<!doctype html><html lang="en"><head><title data-rh="true">Breaking down CVE-2024–38063: remote exploitation of the Windows kernel | by BI.ZONE | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-09-03T09:33:07.321Z"/><meta data-rh="true" name="title" content="Breaking down CVE-2024–38063: remote exploitation of the Windows kernel | by BI.ZONE | Medium"/><meta data-rh="true" property="og:title" content="Breaking down CVE-2024–38063: remote exploitation of the Windows kernel"/><meta data-rh="true" property="al:android:url" content="medium://p/bdae36f5f61d"/><meta data-rh="true" property="al:ios:url" content="medium://p/bdae36f5f61d"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="We have examined the Windows TCP/IP network stack flaw that could grant adversaries remote access with maximum privileges. Exploiting CVE-2024–38063 does not imply any action on the part of the user…"/><meta data-rh="true" property="og:description" content="We have examined the Windows TCP/IP network stack flaw that could grant adversaries remote access with maximum privileges. Exploiting…"/><meta data-rh="true" property="og:url" content="https://bi-zone.medium.com/breaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d"/><meta data-rh="true" property="al:web:url" content="https://bi-zone.medium.com/breaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*H0hIz2jYIpwkP0td9qSr3g.jpeg"/><meta data-rh="true" property="article:author" content="https://bi-zone.medium.com"/><meta data-rh="true" name="author" content="BI.ZONE"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Breaking down CVE-2024–38063: remote exploitation of the Windows kernel"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/bdae36f5f61d"/><meta data-rh="true" property="twitter:description" content="We have examined the Windows TCP/IP network stack flaw that could grant adversaries remote access with maximum privileges. Exploiting…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*H0hIz2jYIpwkP0td9qSr3g.jpeg"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@bizone_en"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="8 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://bi-zone.medium.com"/><link data-rh="true" rel="canonical" href="https://bi-zone.medium.com/breaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/bdae36f5f61d"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*H0hIz2jYIpwkP0td9qSr3g.jpeg"],"url":"https:\u002F\u002Fbi-zone.medium.com\u002Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d","dateCreated":"2024-09-03T09:33:07.321Z","datePublished":"2024-09-03T09:33:07.321Z","dateModified":"2024-09-05T16:58:55.308Z","headline":"Breaking down CVE-2024–38063: remote exploitation of the Windows kernel","name":"Breaking down CVE-2024–38063: remote exploitation of the Windows kernel","description":"We have examined the Windows TCP\u002FIP network stack flaw that could grant adversaries remote access with maximum privileges. Exploiting CVE-2024–38063 does not imply any action on the part of the user…","identifier":"bdae36f5f61d","author":{"@type":"Person","name":"BI.ZONE","url":"https:\u002F\u002Fbi-zone.medium.com"},"creator":["BI.ZONE"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fbi-zone.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fbi-zone.medium.com\u002Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d"}</script><style type="text/css" data-fela-rehydration="536" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="536" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{margin-left:4px}.lb{margin-top:0px}.lc{opacity:1}.ld{padding:4px 0}.lg{width:16px}.li{display:inline-flex}.lo{max-width:100%}.lp{padding:8px 2px}.lq svg{color:#6B6B6B}.mh{margin-left:auto}.mi{margin-right:auto}.mj{max-width:3840px}.mp{clear:both}.mr{cursor:zoom-in}.ms{z-index:auto}.mu{height:auto}.mv{line-height:1.58}.mw{letter-spacing:-0.004em}.mx{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ns{margin-bottom:-0.46em}.nt{margin-top:32px}.nu{margin-bottom:14px}.nv{padding-top:24px}.nw{padding-bottom:10px}.nx{background-color:#000000}.ny{height:3px}.nz{width:3px}.oa{margin-right:20px}.ob{padding:2px 4px}.oc{font-size:75%}.od> strong{font-family:inherit}.oe{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.of{max-width:1565px}.ol{line-height:1.12}.om{letter-spacing:-0.022em}.on{font-weight:600}.pi{margin-bottom:-0.28em}.po{list-style-type:decimal}.pp{margin-left:30px}.pq{padding-left:0px}.pw{text-decoration:underline}.px{max-width:1117px}.py{max-width:1226px}.pz{max-width:1558px}.qa{max-width:1412px}.qb{max-width:521px}.qc{list-style-type:disc}.qd{max-width:896px}.qe{max-width:1003px}.qf{max-width:985px}.qg{max-width:790px}.qh{margin-top:10px}.qi{max-width:728px}.ql{max-width:946px}.qm{max-width:1179px}.qn{max-width:1168px}.qo{max-width:787px}.qp{max-width:1180px}.qv{box-shadow:inset 0 0 0 1px #F2F2F2}.qw{padding:0px}.qx{padding:16px 20px}.qy{flex:1 1 auto}.ra{overflow:hidden}.rb{max-height:40px}.rc{text-overflow:ellipsis}.rd{display:-webkit-box}.re{-webkit-line-clamp:2}.rf{-webkit-box-orient:vertical}.rh{margin-top:8px}.ri{margin-top:12px}.rj{margin-bottom:26px}.rk{margin-top:6px}.rl{margin-right:8px}.rm{padding:8px 16px}.rn{border-radius:100px}.ro{transition:background 300ms ease}.rq{white-space:nowrap}.rr{border-top:none}.rx{height:52px}.ry{max-height:52px}.rz{box-sizing:content-box}.sa{position:static}.sb{z-index:1}.sd{max-width:155px}.so{align-items:flex-end}.sp{width:76px}.sq{height:76px}.sr{border:2px solid #F9F9F9}.ss{height:72px}.st{width:72px}.su{stroke:#F2F2F2}.sv{height:36px}.sw{width:36px}.sx{color:#F2F2F2}.sy{fill:#F2F2F2}.sz{background:#F2F2F2}.ta{border-color:#F2F2F2}.tg{font-weight:500}.th{font-size:24px}.ti{line-height:30px}.tj{letter-spacing:-0.016em}.tk{margin-top:16px}.tl{height:0px}.tm{border-bottom:solid 1px #E5E5E5}.tn{margin-top:72px}.to{padding:24px 0}.tp{margin-bottom:0px}.tq{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.le:hover{fill:#000000}.lf:hover p{color:#000000}.lh:hover{color:#000000}.lr:hover svg{color:#000000}.rp:hover{background-color:#F2F2F2}.tb:hover{background:#F2F2F2}.tc:hover{border-color:#F2F2F2}.td:hover{cursor:wait}.te:hover{color:#F2F2F2}.tf:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.ls:focus svg{color:#000000}.mt:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.ln{margin:0}.mo{margin-top:40px}.no{font-size:20px}.np{margin-top:2.14em}.nq{line-height:32px}.nr{letter-spacing:-0.003em}.ok{margin-top:56px}.pe{font-size:24px}.pf{margin-top:1.95em}.pg{line-height:30px}.ph{letter-spacing:-0.016em}.pn{margin-top:0.94em}.pv{margin-top:1.14em}.qu{margin-top:32px}.rw{margin-bottom:88px}.si{display:inline-block}.sn{padding-top:72px}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.qj{margin-left:auto}.qk{text-align:center}.sh{display:inline-block}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.sg{display:inline-block}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.qz{padding:10px 12px 10px}.sf{display:inline-block}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.lj{margin:0}.lt{border:1px solid #F2F2F2}.lu{border-radius:99em}.lv{padding:0px 16px 0px 12px}.lw{height:38px}.lx{align-items:center}.lz svg{margin-right:8px}.mk{margin-top:32px}.my{font-size:18px}.mz{margin-top:1.56em}.na{line-height:28px}.nb{letter-spacing:-0.003em}.og{margin-top:40px}.oo{font-size:20px}.op{margin-top:1.2em}.oq{line-height:24px}.or{letter-spacing:0}.pj{margin-top:0.67em}.pr{margin-top:1.34em}.qq{margin-top:24px}.rs{margin-bottom:80px}.se{display:inline-block}.sj{padding-top:48px}.ly:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.lm{margin:0}.mn{margin-top:40px}.nk{font-size:20px}.nl{margin-top:2.14em}.nm{line-height:32px}.nn{letter-spacing:-0.003em}.oj{margin-top:56px}.pa{font-size:24px}.pb{margin-top:1.95em}.pc{line-height:30px}.pd{letter-spacing:-0.016em}.pm{margin-top:0.94em}.pu{margin-top:1.14em}.qt{margin-top:32px}.rv{margin-bottom:88px}.sm{padding-top:72px}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.ll{margin:0}.mm{margin-top:40px}.ng{font-size:20px}.nh{margin-top:2.14em}.ni{line-height:32px}.nj{letter-spacing:-0.003em}.oi{margin-top:56px}.ow{font-size:24px}.ox{margin-top:1.95em}.oy{line-height:30px}.oz{letter-spacing:-0.016em}.pl{margin-top:0.94em}.pt{margin-top:1.14em}.qs{margin-top:32px}.ru{margin-bottom:88px}.sl{padding-top:72px}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lk{margin:0}.ma{border:1px solid #F2F2F2}.mb{border-radius:99em}.mc{padding:0px 16px 0px 12px}.md{height:38px}.me{align-items:center}.mg svg{margin-right:8px}.ml{margin-top:32px}.nc{font-size:18px}.nd{margin-top:1.56em}.ne{line-height:28px}.nf{letter-spacing:-0.003em}.oh{margin-top:40px}.os{font-size:20px}.ot{margin-top:1.2em}.ou{line-height:24px}.ov{letter-spacing:0}.pk{margin-top:0.67em}.ps{margin-top:1.34em}.qr{margin-top:24px}.rt{margin-bottom:80px}.sk{padding-top:48px}.mf:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="print">.sc{display:none}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.mq{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="536" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.rg{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbdae36f5f61d&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="9a9b" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Breaking down CVE-2024–38063: remote exploitation of the Windows kernel</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--bdae36f5f61d--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="BI.ZONE" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*cj9yFPo_JbHzvR2AQVUedg.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--bdae36f5f61d--------------------------------">BI.ZONE</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3882bedad280&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=post_page-3882bedad280--byline--bdae36f5f61d---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Sep 3, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fbdae36f5f61d&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=---header_actions--bdae36f5f61d---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk lc ld ab q fk le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv z du"><span class="pw-responses-count la lb">1</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbdae36f5f61d&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;source=---header_actions--bdae36f5f61d---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd li cn"><div class="l ae"><div class="ab cb"><div class="lj lk ll lm ln lo ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls lt lu lv lw s lx ly lz ma mb mc md u me mf mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls lt lu lv lw s lx ly lz ma mb mc md u me mf mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mk ml mm mn mo mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi mj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*H0hIz2jYIpwkP0td9qSr3g.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="394" loading="eager" role="presentation"/></picture></div></div></figure><p id="8e7a" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">We have examined the Windows TCP/IP network stack flaw that could grant adversaries remote access with maximum privileges. Exploiting CVE-2024–38063 does not imply any action on the part of the user. In the article, we explain how we were able to contain the vulnerability by comparing two versions of the driver and developed an attack chain</p></div></div></div><div class="ab cb nt nu nv nw" role="separator"><span class="nx by bm ny nz oa"></span><span class="nx by bm ny nz oa"></span><span class="nx by bm ny nz"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="994b" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">On the second Tuesday of each month, Microsoft releases Patch Tuesday, a Windows update that addresses critical vulnerabilities. On August 13, the vendor fixed a critical vulnerability in the network stack that allows privileged remote access over TCP/IP if IPv6 is enabled.</p><p id="dfab" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">The vulnerability identifier is CVE-2024–38063. In essence, it is a zero-click Windows TCP/IP RCE. According to Microsoft Security Bulletin, the flaw is due to an integer underflow weakness in one of the functions of the <code class="cx ob oc od oe b">tcpip.sys</code> driver responsible for handling IPv6 packets. Due to the high severity of this flaw, our vulnerability research team started playing Patch Tuesday — Exploit Wednesday (and it took them two weeks to win).</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi of"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IkacLRuEc0zcfZEMPoCsGw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IkacLRuEc0zcfZEMPoCsGw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IkacLRuEc0zcfZEMPoCsGw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IkacLRuEc0zcfZEMPoCsGw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IkacLRuEc0zcfZEMPoCsGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IkacLRuEc0zcfZEMPoCsGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IkacLRuEc0zcfZEMPoCsGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IkacLRuEc0zcfZEMPoCsGw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IkacLRuEc0zcfZEMPoCsGw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IkacLRuEc0zcfZEMPoCsGw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IkacLRuEc0zcfZEMPoCsGw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IkacLRuEc0zcfZEMPoCsGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IkacLRuEc0zcfZEMPoCsGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*IkacLRuEc0zcfZEMPoCsGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="445" loading="eager" role="presentation"/></picture></div></div></figure><h1 id="9d91" class="ol om gu bf on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi bk">Initial analysis</h1><p id="1c94" class="pw-post-body-paragraph mv mw gu mx b my pj na nb nc pk ne nf ng pl ni nj nk pm nm nn no pn nq nr ns gn bk">To understand what caused the vulnerability, we examined the driver files before and after the patch. Essentially, there are two ways to do this:</p><ol class=""><li id="1bae" class="mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns po pp pq bk">Save the old file, then update Windows, and get the new file. This is the most reliable method, but it is desirable that the old file is not too old. Otherwise, instead of a nice and convenient comparison in BinDiff, you are likely to get a huge number of changes, most of which are not related to security.</li><li id="d3be" class="mv mw gu mx b my pr na nb nc ps ne nf ng pt ni nj nk pu nm nn no pv nq nr ns po pp pq bk">Use <a class="af pw" href="https://winbindex.m417z.com/" rel="noopener ugc nofollow" target="_blank">Winbindex</a>, an excellent website for doing all kinds of Windows-related research. Updated files appear there with a slight delay, but it is not that critical.</li></ol><p id="8657" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">To be clear, we decided to use the second method: we went to the Winbindex website and downloaded the two latest versions of the Windows 10 22H2 driver.</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi px"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4TQcQ215ZUJzD3p6P0YUlA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4TQcQ215ZUJzD3p6P0YUlA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4TQcQ215ZUJzD3p6P0YUlA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4TQcQ215ZUJzD3p6P0YUlA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4TQcQ215ZUJzD3p6P0YUlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4TQcQ215ZUJzD3p6P0YUlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4TQcQ215ZUJzD3p6P0YUlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*4TQcQ215ZUJzD3p6P0YUlA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4TQcQ215ZUJzD3p6P0YUlA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4TQcQ215ZUJzD3p6P0YUlA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4TQcQ215ZUJzD3p6P0YUlA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4TQcQ215ZUJzD3p6P0YUlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4TQcQ215ZUJzD3p6P0YUlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4TQcQ215ZUJzD3p6P0YUlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="632" loading="lazy" role="presentation"/></picture></div></div></figure><p id="91c1" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Here, 10.0.19041.4780 is the only file version where the vulnerability has been addressed. You can see the publication date for any of these files by clicking <strong class="mx gv">Show </strong>in the <strong class="mx gv">Extra </strong>column, or just by mousing over the update number.</p><p id="1f54" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Once the files are uploaded, you can perform the comparison using the open-source utility <a class="af pw" href="https://github.com/google/bindiff?roistat_visit=1103564" rel="noopener ugc nofollow" target="_blank">BinDiff</a>; for example as a plug-in for IDA Pro. When comparing the two files, we came across a rather unusual situation in the Patch Tuesday analysis: the only function affected by the change was <code class="cx ob oc od oe b">Ipv6pProcessOptions</code>, which is used for handling such IPv6 packet options as Jumbo Payload or Hop-By-Hop.</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi py"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gFCzk1S65d9L9DPJ4vFydQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gFCzk1S65d9L9DPJ4vFydQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gFCzk1S65d9L9DPJ4vFydQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gFCzk1S65d9L9DPJ4vFydQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gFCzk1S65d9L9DPJ4vFydQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gFCzk1S65d9L9DPJ4vFydQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFCzk1S65d9L9DPJ4vFydQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*gFCzk1S65d9L9DPJ4vFydQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gFCzk1S65d9L9DPJ4vFydQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gFCzk1S65d9L9DPJ4vFydQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gFCzk1S65d9L9DPJ4vFydQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gFCzk1S65d9L9DPJ4vFydQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gFCzk1S65d9L9DPJ4vFydQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*gFCzk1S65d9L9DPJ4vFydQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="240" loading="lazy" role="presentation"/></picture></div></div></figure><p id="ac23" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">If you look inside the function in the decompiled code, you will find the only modified section at the end.</p><p id="f91c" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">In the July 23 version:</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi pz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*q7q0oiSH5dQZjoWzHN5-hA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*q7q0oiSH5dQZjoWzHN5-hA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*q7q0oiSH5dQZjoWzHN5-hA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*q7q0oiSH5dQZjoWzHN5-hA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*q7q0oiSH5dQZjoWzHN5-hA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*q7q0oiSH5dQZjoWzHN5-hA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7q0oiSH5dQZjoWzHN5-hA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*q7q0oiSH5dQZjoWzHN5-hA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*q7q0oiSH5dQZjoWzHN5-hA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*q7q0oiSH5dQZjoWzHN5-hA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*q7q0oiSH5dQZjoWzHN5-hA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*q7q0oiSH5dQZjoWzHN5-hA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*q7q0oiSH5dQZjoWzHN5-hA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*q7q0oiSH5dQZjoWzHN5-hA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="189" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5e0b" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">In the August 13 version:</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*PEFhRLNGuShT_3cugu7A3w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*PEFhRLNGuShT_3cugu7A3w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*PEFhRLNGuShT_3cugu7A3w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*PEFhRLNGuShT_3cugu7A3w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*PEFhRLNGuShT_3cugu7A3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*PEFhRLNGuShT_3cugu7A3w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEFhRLNGuShT_3cugu7A3w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*PEFhRLNGuShT_3cugu7A3w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*PEFhRLNGuShT_3cugu7A3w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*PEFhRLNGuShT_3cugu7A3w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*PEFhRLNGuShT_3cugu7A3w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*PEFhRLNGuShT_3cugu7A3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*PEFhRLNGuShT_3cugu7A3w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*PEFhRLNGuShT_3cugu7A3w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="220" loading="lazy" role="presentation"/></picture></div></div></figure><p id="cdb6" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">The <code class="cx ob oc od oe b">IppSendError</code> function is now used instead of <code class="cx ob oc od oe b">IppSendErrorList</code> when errors occur in the processing of IPv6 options. The difference between them is that <code class="cx ob oc od oe b">IppSendErrorList</code> sends errors to every packet in the chain, while <code class="cx ob oc od oe b">IppSendError</code> sends them to only one packet. You can see this if you look at the decompiled code of the <code class="cx ob oc od oe b">IppSendErrorList</code> function:</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div class="mh mi qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nQYkgrmnvSEOcSYo_dhXpQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nQYkgrmnvSEOcSYo_dhXpQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nQYkgrmnvSEOcSYo_dhXpQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nQYkgrmnvSEOcSYo_dhXpQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nQYkgrmnvSEOcSYo_dhXpQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nQYkgrmnvSEOcSYo_dhXpQ.png 1100w, https://miro.medium.com/v2/resize:fit:1042/format:webp/1*nQYkgrmnvSEOcSYo_dhXpQ.png 1042w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 521px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nQYkgrmnvSEOcSYo_dhXpQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nQYkgrmnvSEOcSYo_dhXpQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nQYkgrmnvSEOcSYo_dhXpQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nQYkgrmnvSEOcSYo_dhXpQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nQYkgrmnvSEOcSYo_dhXpQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nQYkgrmnvSEOcSYo_dhXpQ.png 1100w, https://miro.medium.com/v2/resize:fit:1042/1*nQYkgrmnvSEOcSYo_dhXpQ.png 1042w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 521px"/><img alt="" class="bh lo mu c" width="521" height="287" loading="lazy" role="presentation"/></picture></div></figure><p id="8ccb" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Further analysis of the code around the modified section reveals the logic: <code class="cx ob oc od oe b">Ipv6pProcessOptions</code> is designed to process only one packet (or fragment) while <code class="cx ob oc od oe b">IppSendErrorList</code> goes through all packets in the chain. This is an obvious logical mistake that may lead to something bad. However, we did not know what kind of bad exactly, so we continued our research. But first we decided to develop a checker to see if we understood the logic correctly.</p><p id="ac9b" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Indeed, there were six responses to three packets with errors in IPv6 options:</p><ul class=""><li id="fab9" class="mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns qc pp pq bk">three errors per Packet1 (Packet1 → Packet2 → Packet3)</li><li id="2348" class="mv mw gu mx b my pr na nb nc ps ne nf ng pt ni nj nk pu nm nn no pv nq nr ns qc pp pq bk">two errors per Packet2 (Packet2 → Packet3)</li><li id="6db3" class="mv mw gu mx b my pr na nb nc ps ne nf ng pt ni nj nk pu nm nn no pv nq nr ns qc pp pq bk">one error per Packet3 (Packet3)</li></ul><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yuEKn4geC3g605fCOORXrg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yuEKn4geC3g605fCOORXrg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yuEKn4geC3g605fCOORXrg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yuEKn4geC3g605fCOORXrg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yuEKn4geC3g605fCOORXrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yuEKn4geC3g605fCOORXrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yuEKn4geC3g605fCOORXrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*yuEKn4geC3g605fCOORXrg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yuEKn4geC3g605fCOORXrg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yuEKn4geC3g605fCOORXrg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yuEKn4geC3g605fCOORXrg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yuEKn4geC3g605fCOORXrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yuEKn4geC3g605fCOORXrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*yuEKn4geC3g605fCOORXrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="175" loading="lazy" role="presentation"/></picture></div></div></figure><p id="e596" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">It should be noted that packets with errors will reach the sender only if Windows Firewall is disabled on the system. However, having the firewall enabled does not affect whether the packets sent reach the vulnerable system, as they are processed at the OS kernel level even before being processed by the firewall.</p><h1 id="b147" class="ol om gu bf on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi bk">Zero to Hero</h1><p id="d24a" class="pw-post-body-paragraph mv mw gu mx b my pj na nb nc pk ne nf ng pl ni nj nk pm nm nn no pn nq nr ns gn bk">When viewing the decompiled code of the <code class="cx ob oc od oe b">IppSendError</code> function, you may notice the following fragment:</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wUd9MnfO02ZyA_wXqLkjZg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wUd9MnfO02ZyA_wXqLkjZg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wUd9MnfO02ZyA_wXqLkjZg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wUd9MnfO02ZyA_wXqLkjZg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wUd9MnfO02ZyA_wXqLkjZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wUd9MnfO02ZyA_wXqLkjZg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUd9MnfO02ZyA_wXqLkjZg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wUd9MnfO02ZyA_wXqLkjZg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wUd9MnfO02ZyA_wXqLkjZg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wUd9MnfO02ZyA_wXqLkjZg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wUd9MnfO02ZyA_wXqLkjZg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wUd9MnfO02ZyA_wXqLkjZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wUd9MnfO02ZyA_wXqLkjZg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wUd9MnfO02ZyA_wXqLkjZg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="63" loading="lazy" role="presentation"/></picture></div></div></figure><p id="25c1" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">This behavior is correct as calling this function terminates the processing of the current packet and sends an error message. However, due to the fact that in the vulnerable driver version this code snippet is executed for each packet from the chain, including unprocessed ones, there is a probability that the <code class="cx ob oc od oe b">IPv6_HeaderSize</code> field will be used for processing subsequent packets. In fact, this field is equal to the IPv6 header size, including all nested option headers.</p><p id="cf2d" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">We realized that this should not be like that and that the size field should not be equal to zero in a working packet. We could not figure out where exactly to apply this primitive for quite some time, hence we turned to previous studies of vulnerabilities in the Windows TCP/IP network stack (<a class="af pw" href="https://doar-e.github.io/blog/2021/04/15/reverse-engineering-tcpipsys-mechanics-of-a-packet-of-the-death-cve-2021-24086/" rel="noopener ugc nofollow" target="_blank">1</a>, <a class="af pw" href="https://blog.quarkslab.com/analysis-of-a-windows-ipv6-fragmentation-vulnerability-cve-2021-24086.html" rel="noopener ugc nofollow" target="_blank">2</a>).</p><p id="aa51" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">We came across an <a class="af pw" href="https://securityintelligence.com/x-force/dissecting-exploiting-tcp-ip-rce-vulnerability-evilesp" rel="noopener ugc nofollow" target="_blank">article</a> exploring a similar vulnerability stemming from IPv6 fragmentation, CVE-2022–34718. The vulnerability was in the <code class="cx ob oc od oe b">Ipv6pReassembleDatagram</code> function that uses the undocumented <code class="cx ob oc od oe b">Packet_t</code> and <code class="cx ob oc od oe b">Reassembly_t</code> objects.</p><p id="811f" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Although this function does not use the field whose value we changed, it affects the fields of the <code class="cx ob oc od oe b">Reassembly_t</code> object in the parent <code class="cx ob oc od oe b">Ipv6pReceiveFragment</code>:</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*OzbOq1vdzN2doUvJzHjeoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*OzbOq1vdzN2doUvJzHjeoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*OzbOq1vdzN2doUvJzHjeoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*OzbOq1vdzN2doUvJzHjeoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*OzbOq1vdzN2doUvJzHjeoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OzbOq1vdzN2doUvJzHjeoQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzbOq1vdzN2doUvJzHjeoQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*OzbOq1vdzN2doUvJzHjeoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*OzbOq1vdzN2doUvJzHjeoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*OzbOq1vdzN2doUvJzHjeoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*OzbOq1vdzN2doUvJzHjeoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*OzbOq1vdzN2doUvJzHjeoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*OzbOq1vdzN2doUvJzHjeoQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*OzbOq1vdzN2doUvJzHjeoQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="139" loading="lazy" role="presentation"/></picture></div></div></figure><p id="2583" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Here we can see that <code class="cx ob oc od oe b">0x30</code> is subtracted from the value of the IPv6_HeaderSize field that was incorrectly changed earlier, because the function assumes that the size cannot be less than 48 bytes at this stage. This code snippet is a great opportunity to apply the previously acquired primitive, but we still need to get here. To do so, we need to pass two checks, the first of which can be seen in the image above: it checks whether the fragment is the first in the chain. Although this condition reduces the exploitation possibilities, it does not reduce them enough: one packet may well suffice.</p><p id="ce98" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">The second condition is to check that the fragment offset is not zero, but because of the processing in <code class="cx ob oc od oe b">IppSendError</code> (within which <code class="cx ob oc od oe b">NetioRetreatNetBufferList</code> is called to return the caret to the beginning of the packet), this condition actually checks that <code class="cx ob oc od oe b">FlowLabel</code> in the IPv6 header structure is not zero.</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*byEOopyo3qKUmZQA8iw2pg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*byEOopyo3qKUmZQA8iw2pg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*byEOopyo3qKUmZQA8iw2pg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*byEOopyo3qKUmZQA8iw2pg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*byEOopyo3qKUmZQA8iw2pg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*byEOopyo3qKUmZQA8iw2pg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byEOopyo3qKUmZQA8iw2pg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*byEOopyo3qKUmZQA8iw2pg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*byEOopyo3qKUmZQA8iw2pg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*byEOopyo3qKUmZQA8iw2pg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*byEOopyo3qKUmZQA8iw2pg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*byEOopyo3qKUmZQA8iw2pg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*byEOopyo3qKUmZQA8iw2pg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*byEOopyo3qKUmZQA8iw2pg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="249" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qh ff qi mh mi qj qk bf b bg z du">How Windows sees the <code class="cx ob oc od oe b">tcpip.sys </code>code</figcaption></figure><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*l18WvNN8iGGPOCzhF03-ow.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*l18WvNN8iGGPOCzhF03-ow.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*l18WvNN8iGGPOCzhF03-ow.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*l18WvNN8iGGPOCzhF03-ow.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*l18WvNN8iGGPOCzhF03-ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l18WvNN8iGGPOCzhF03-ow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l18WvNN8iGGPOCzhF03-ow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*l18WvNN8iGGPOCzhF03-ow.png 640w, https://miro.medium.com/v2/resize:fit:720/1*l18WvNN8iGGPOCzhF03-ow.png 720w, https://miro.medium.com/v2/resize:fit:750/1*l18WvNN8iGGPOCzhF03-ow.png 750w, https://miro.medium.com/v2/resize:fit:786/1*l18WvNN8iGGPOCzhF03-ow.png 786w, https://miro.medium.com/v2/resize:fit:828/1*l18WvNN8iGGPOCzhF03-ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*l18WvNN8iGGPOCzhF03-ow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*l18WvNN8iGGPOCzhF03-ow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="212" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qh ff qi mh mi qj qk bf b bg z du">What occurs in reality</figcaption></figure><p id="a9cf" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">This structure field is used in the above mentioned <code class="cx ob oc od oe b">Ipv6pReassembleDatagram </code>function when copying data from the buffer.</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ppRrTK8I2R9HsjfretguUA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ppRrTK8I2R9HsjfretguUA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ppRrTK8I2R9HsjfretguUA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ppRrTK8I2R9HsjfretguUA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ppRrTK8I2R9HsjfretguUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ppRrTK8I2R9HsjfretguUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppRrTK8I2R9HsjfretguUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ppRrTK8I2R9HsjfretguUA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ppRrTK8I2R9HsjfretguUA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ppRrTK8I2R9HsjfretguUA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ppRrTK8I2R9HsjfretguUA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ppRrTK8I2R9HsjfretguUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ppRrTK8I2R9HsjfretguUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ppRrTK8I2R9HsjfretguUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="54" loading="lazy" role="presentation"/></picture></div></div></figure><p id="89b1" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">At this point, we were already confident that we had fully understood the vulnerability, but the kernel did not get to the point of executing the necessary code because of the next check at the beginning of the function:</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jw5B4SLqoU5s9EMAdYTZ_A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jw5B4SLqoU5s9EMAdYTZ_A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jw5B4SLqoU5s9EMAdYTZ_A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jw5B4SLqoU5s9EMAdYTZ_A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jw5B4SLqoU5s9EMAdYTZ_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jw5B4SLqoU5s9EMAdYTZ_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jw5B4SLqoU5s9EMAdYTZ_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jw5B4SLqoU5s9EMAdYTZ_A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jw5B4SLqoU5s9EMAdYTZ_A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jw5B4SLqoU5s9EMAdYTZ_A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jw5B4SLqoU5s9EMAdYTZ_A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jw5B4SLqoU5s9EMAdYTZ_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jw5B4SLqoU5s9EMAdYTZ_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jw5B4SLqoU5s9EMAdYTZ_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="186" loading="lazy" role="presentation"/></picture></div></div></figure><p id="cc38" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Here, the <code class="cx ob oc od oe b">TotalLength</code> variable is equal to the sum of the size of the newly initialized <code class="cx ob oc od oe b">Reassembly_t</code> with our size in underflow (it always equals <code class="cx ob oc od oe b">0xffd8</code> after exploitation):</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DrvUsjrBSqub1yGPkcvuNg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DrvUsjrBSqub1yGPkcvuNg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DrvUsjrBSqub1yGPkcvuNg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DrvUsjrBSqub1yGPkcvuNg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DrvUsjrBSqub1yGPkcvuNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DrvUsjrBSqub1yGPkcvuNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DrvUsjrBSqub1yGPkcvuNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*DrvUsjrBSqub1yGPkcvuNg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DrvUsjrBSqub1yGPkcvuNg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DrvUsjrBSqub1yGPkcvuNg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DrvUsjrBSqub1yGPkcvuNg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DrvUsjrBSqub1yGPkcvuNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DrvUsjrBSqub1yGPkcvuNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DrvUsjrBSqub1yGPkcvuNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="55" loading="lazy" role="presentation"/></picture></div></div></figure><p id="ec4f" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">You might think that there is an overflow of <code class="cx ob oc od oe b">UnfragmentableLength</code> here, but the addition is performed within the <code class="cx ob oc od oe b">UInt32</code> type, so the overflow will not occur and <code class="cx ob oc od oe b">TotalLength</code> will be greater than <code class="cx ob oc od oe b">0xfff</code>.</p><h1 id="b74b" class="ol om gu bf on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi bk">Finish and impact</h1><p id="dd8c" class="pw-post-body-paragraph mv mw gu mx b my pj na nb nc pk ne nf ng pl ni nj nk pm nm nn no pn nq nr ns gn bk">While researching other functions that use the <code class="cx ob oc od oe b">Reassembly </code>structure, we found a handler that is called when the timeout for the next fragment expires, <code class="cx ob oc od oe b">Ipv6pReassemblyTimeout</code>. This function also copies data from our buffer using negative (large positive) size.</p><figure class="og oh oi oj ok mp mh mi paragraph-image"><div role="button" tabindex="0" class="mq mr fj ms bh mt"><div class="mh mi qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Ok7ImW-XBYFXAkX8U9Xmcw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo mu c" width="700" height="69" loading="lazy" role="presentation"/></picture></div></div></figure><p id="b00b" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">To get to this code snippet, we need to set <code class="cx ob oc od oe b">FlowLimit</code> equal to one (due to <code class="cx ob oc od oe b">IppSendError,</code> the driver interprets this field as <code class="cx ob oc od oe b">FragOffset</code>) and wait for one minute. After that, the pool buffer in the Windows kernel overflows with values almost completely controlled by us, because it is quite easy to spray the necessary chunks nearby. It would seem that everything is fine, right?</p><p id="1884" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">There is always a big problem in the remote exploitation of such vulnerabilities: we do not know the kernel addresses after KASLR. If we were executing on the attacked host itself (which is quite possible and allows privileges to be elevated to SYSTEM), we could exploit the full variety of KASLR leaks in Windows (<a class="af pw" href="https://exploits.forsale/24h2-nt-exploit" rel="noopener ugc nofollow" target="_blank">1</a>, <a class="af pw" href="https://github.com/waleedassar/RestrictedKernelLeaks" rel="noopener ugc nofollow" target="_blank">2</a>). However, this is not our case, although the above method of using the primitive provides excellent opportunities for local privilege escalation and remote BSOD. Strict limitations on the size of the allocated memory section do not allow us to learn the kernel address without letting the kernel crash.</p><p id="500e" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">There are two caveats here:</p><ol class=""><li id="6188" class="mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns po pp pq bk">Any additional kernel vulnerability that could compromise KASLR addresses — in a chain with the presented vulnerability — leads to RCE.</li><li id="b590" class="mv mw gu mx b my pr na nb nc ps ne nf ng pt ni nj nk pu nm nn no pv nq nr ns po pp pq bk">The Windows networking stack is one of the most complex parts of the OS. The exploitation primitive presented in this article can affect sections of code in subsequent packet processing, so it is likely that there are other (highly sophisticated) attack methods that will lead to KASLR leakage and kernel compromise.</li></ol><p id="16c4" class="pw-post-body-paragraph mv mw gu mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns gn bk">Despite the complexity associated with the exploitation of this zero‑click TCP/IP RCE flaw, we recommend you to disable IPv6 at the hosts where it is not used. As part of safety recommendations, <a class="af pw" href="https://bi.zone/eng/catalog/products/edr/" rel="noopener ugc nofollow" target="_blank">BI.ZONE EDR</a> detects enabled IPv6 components in the host’s network interfaces and notifies the monitoring team of the identified misconfiguration. This rule is available both in the on‑prem BI.ZONE EDR version and in <a class="af pw" href="https://bi.zone/eng/catalog/services/threat-detection-and-response/" rel="noopener ugc nofollow" target="_blank">BI.ZONE TDR</a>.</p><h1 id="36b1" class="ol om gu bf on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi bk">PoC video</h1><div class="qq qr qs qt qu qv"><a href="https://vk.com/video_ext.php?oid=-187584378&amp;id=456239240&amp;hash=fc1bf11222b41706&amp;source=post_page-----bdae36f5f61d--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qw ab is"><div class="qx ab co cb qy qz"><h2 class="bf gv ij z ra rb rc rd re rf rg gt bk">VK | Video Ext</h2><div class="rh l"><h3 class="bf b ij z ra rb rc rd re rf rg du">Edit description</h3></div><div class="ri l"><p class="bf b dv z ra rb rc rd re rf rg du">vk.com</p></div></div></div></a></div></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rj rk ab iv"><div class="rh ab"><a class="rl ay am ao" href="https://medium.com/tag/cve?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><div class="rm fj cx rn ge ro rp bf b bg z bk rq">Cve</div></a></div><div class="rh ab"><a class="rl ay am ao" href="https://medium.com/tag/windows?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><div class="rm fj cx rn ge ro rp bf b bg z bk rq">Windows</div></a></div><div class="rh ab"><a class="rl ay am ao" href="https://medium.com/tag/information-security?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><div class="rm fj cx rn ge ro rp bf b bg z bk rq">Information Security</div></a></div><div class="rh ab"><a class="rl ay am ao" href="https://medium.com/tag/critical-vulnerabilities?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><div class="rm fj cx rn ge ro rp bf b bg z bk rq">Critical Vulnerabilities</div></a></div></div></div></div><div class="l"></div><footer class="rr rs rt ru rv rw rx ry rz ab q sa sb c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sc"><div class="ab q ke"><div class="sd l"><span class="l se sf sg e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fbdae36f5f61d&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=---footer_actions--bdae36f5f61d---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f sh si"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fbdae36f5f61d&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=---footer_actions--bdae36f5f61d---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk lc ld ab q fk le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z du"><span class="pw-responses-count la lb">1</span></p></button></div></div></div></div><div class="ab q"><div class="oa l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbdae36f5f61d&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;source=---footer_actions--bdae36f5f61d---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="oa l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sj sk sl sm sn l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab so cp"><div class="ab ia"><a rel="noopener follow" href="/?source=post_page---post_author_info--bdae36f5f61d--------------------------------"><div class="l sp sq by sr ie"><div class="l fj"><img alt="BI.ZONE" class="l fd by ss st cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*cj9yFPo_JbHzvR2AQVUedg.png" width="72" height="72" loading="lazy"/><div class="if by l ss st fs n ig ft"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z ep rm eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F16f9550e3622&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;newsletterV3=3882bedad280&amp;newsletterV3Id=16f9550e3622&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=---post_author_info--bdae36f5f61d---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z sx am sy sz ta tb tc td te tf ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="su sv sw"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--bdae36f5f61d--------------------------------"><h2 class="pw-author-name bf tg th ti tj bk"><span class="gn ix">Written by <!-- -->BI.ZONE</span></h2></a></div><div class="rh ab"><div class="l is"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--bdae36f5f61d--------------------------------">178 Followers</a></span></div></div><div class="tk l"><p class="bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar pw go" href="http://BI.ZONE" rel="noopener  ugc nofollow">BI.ZONE</a>: an expert in digital risks management. We help organizations around the world to develop their businesses safely in the digital age</p></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ep rm eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F16f9550e3622&amp;operation=register&amp;redirect=https%3A%2F%2Fbi-zone.medium.com%2Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d&amp;newsletterV3=3882bedad280&amp;newsletterV3Id=16f9550e3622&amp;user=BI.ZONE&amp;userId=3882bedad280&amp;source=---post_author_info--bdae36f5f61d---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z sx am sy sz ta tb tc td te tf ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="su sv sw"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tl bh tm mk ml mm mn mo"></div></div></div><div class="h k j"><div class="tl bh tm tn"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="to ab ke iv"><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="tp tq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----bdae36f5f61d--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241107-150356-f8ecf0823c"</script><script>window.__GRAPHQL_URI__ = "https://bi-zone.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-bdae36f5f61d","user-3882bedad280"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"3882bedad280","explicit":true},"viewerIsBot":false},"debug":{"requestId":"2ec4a682-432f-4940-b0c7-3556562c0f65","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-324ebbdcfbdd711f6b016a84b78418b0-7d04a06c85c0bee6-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fbi-zone.medium.com\u002Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d","host":"bi-zone.medium.com","hostname":"bi-zone.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241107-150356-f8ecf0823c","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241107-150356-f8ecf0823c","commit":"f8ecf0823c18cf4f3b1419603ed2848f12ccf398"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"bi-zone.medium.com\"})":null,"postResult({\"id\":\"bdae36f5f61d\"})":{"__ref":"Post:bdae36f5f61d"}},"LinkedAccounts:3882bedad280":{"__typename":"LinkedAccounts","mastodon":null,"id":"3882bedad280"},"UserViewerEdge:userId:3882bedad280-viewerId:lo_d99b47f7efe9":{"__typename":"UserViewerEdge","id":"userId:3882bedad280-viewerId:lo_d99b47f7efe9","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:16f9550e3622":{"__typename":"NewsletterV3","id":"16f9550e3622","type":"NEWSLETTER_TYPE_AUTHOR","slug":"3882bedad280","name":"3882bedad280","collection":null,"user":{"__ref":"User:3882bedad280"}},"User:3882bedad280":{"__typename":"User","id":"3882bedad280","name":"BI.ZONE","username":"bi-zone","newsletterV3":{"__ref":"NewsletterV3:16f9550e3622"},"linkedAccounts":{"__ref":"LinkedAccounts:3882bedad280"},"isSuspended":false,"imageId":"1*cj9yFPo_JbHzvR2AQVUedg.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":178,"followingCount":1,"collectionFollowingCount":0},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"bi-zone.medium.com"}},"hasSubdomain":true,"bio":"BI.ZONE: an expert in digital risks management. We help organizations around the world to develop their businesses safely in the digital age","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:3882bedad280-viewerId:lo_d99b47f7efe9"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"membership":null,"allowNotes":true,"twitterScreenName":"bizone_en"},"Paragraph:a4bb5fdf6844_0":{"__typename":"Paragraph","id":"a4bb5fdf6844_0","name":"9a9b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Breaking down CVE-2024–38063: remote exploitation of the Windows kernel","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*H0hIz2jYIpwkP0td9qSr3g.jpeg":{"__typename":"ImageMetadata","id":"1*H0hIz2jYIpwkP0td9qSr3g.jpeg","originalHeight":2160,"originalWidth":3840,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_1":{"__typename":"Paragraph","id":"a4bb5fdf6844_1","name":"feed","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*H0hIz2jYIpwkP0td9qSr3g.jpeg"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_2":{"__typename":"Paragraph","id":"a4bb5fdf6844_2","name":"8e7a","type":"P","href":null,"layout":null,"metadata":null,"text":"We have examined the Windows TCP\u002FIP network stack flaw that could grant adversaries remote access with maximum privileges. Exploiting CVE-2024–38063 does not imply any action on the part of the user. In the article, we explain how we were able to contain the vulnerability by comparing two versions of the driver and developed an attack chain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_3":{"__typename":"Paragraph","id":"a4bb5fdf6844_3","name":"994b","type":"P","href":null,"layout":null,"metadata":null,"text":"On the second Tuesday of each month, Microsoft releases Patch Tuesday, a Windows update that addresses critical vulnerabilities. On August 13, the vendor fixed a critical vulnerability in the network stack that allows privileged remote access over TCP\u002FIP if IPv6 is enabled.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_4":{"__typename":"Paragraph","id":"a4bb5fdf6844_4","name":"dfab","type":"P","href":null,"layout":null,"metadata":null,"text":"The vulnerability identifier is CVE-2024–38063. In essence, it is a zero-click Windows TCP\u002FIP RCE. According to Microsoft Security Bulletin, the flaw is due to an integer underflow weakness in one of the functions of the tcpip.sys driver responsible for handling IPv6 packets. Due to the high severity of this flaw, our vulnerability research team started playing Patch Tuesday — Exploit Wednesday (and it took them two weeks to win).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":221,"end":230,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IkacLRuEc0zcfZEMPoCsGw.png":{"__typename":"ImageMetadata","id":"1*IkacLRuEc0zcfZEMPoCsGw.png","originalHeight":994,"originalWidth":1565,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_5":{"__typename":"Paragraph","id":"a4bb5fdf6844_5","name":"fc9f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IkacLRuEc0zcfZEMPoCsGw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_6":{"__typename":"Paragraph","id":"a4bb5fdf6844_6","name":"9d91","type":"H3","href":null,"layout":null,"metadata":null,"text":"Initial analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_7":{"__typename":"Paragraph","id":"a4bb5fdf6844_7","name":"1c94","type":"P","href":null,"layout":null,"metadata":null,"text":"To understand what caused the vulnerability, we examined the driver files before and after the patch. Essentially, there are two ways to do this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_8":{"__typename":"Paragraph","id":"a4bb5fdf6844_8","name":"1bae","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Save the old file, then update Windows, and get the new file. This is the most reliable method, but it is desirable that the old file is not too old. Otherwise, instead of a nice and convenient comparison in BinDiff, you are likely to get a huge number of changes, most of which are not related to security.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_9":{"__typename":"Paragraph","id":"a4bb5fdf6844_9","name":"d3be","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Use Winbindex, an excellent website for doing all kinds of Windows-related research. Updated files appear there with a slight delay, but it is not that critical.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":4,"end":13,"href":"https:\u002F\u002Fwinbindex.m417z.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_10":{"__typename":"Paragraph","id":"a4bb5fdf6844_10","name":"8657","type":"P","href":null,"layout":null,"metadata":null,"text":"To be clear, we decided to use the second method: we went to the Winbindex website and downloaded the two latest versions of the Windows 10 22H2 driver.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4TQcQ215ZUJzD3p6P0YUlA.png":{"__typename":"ImageMetadata","id":"1*4TQcQ215ZUJzD3p6P0YUlA.png","originalHeight":1007,"originalWidth":1117,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_11":{"__typename":"Paragraph","id":"a4bb5fdf6844_11","name":"cb82","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*4TQcQ215ZUJzD3p6P0YUlA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_12":{"__typename":"Paragraph","id":"a4bb5fdf6844_12","name":"91c1","type":"P","href":null,"layout":null,"metadata":null,"text":"Here, 10.0.19041.4780 is the only file version where the vulnerability has been addressed. You can see the publication date for any of these files by clicking Show in the Extra column, or just by mousing over the update number.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":159,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":171,"end":177,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_13":{"__typename":"Paragraph","id":"a4bb5fdf6844_13","name":"1f54","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the files are uploaded, you can perform the comparison using the open-source utility BinDiff; for example as a plug-in for IDA Pro. When comparing the two files, we came across a rather unusual situation in the Patch Tuesday analysis: the only function affected by the change was Ipv6pProcessOptions, which is used for handling such IPv6 packet options as Jumbo Payload or Hop-By-Hop.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":285,"end":304,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":90,"end":97,"href":"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Fbindiff?roistat_visit=1103564","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*gFCzk1S65d9L9DPJ4vFydQ.png":{"__typename":"ImageMetadata","id":"1*gFCzk1S65d9L9DPJ4vFydQ.png","originalHeight":419,"originalWidth":1226,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_14":{"__typename":"Paragraph","id":"a4bb5fdf6844_14","name":"a60e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*gFCzk1S65d9L9DPJ4vFydQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_15":{"__typename":"Paragraph","id":"a4bb5fdf6844_15","name":"ac23","type":"P","href":null,"layout":null,"metadata":null,"text":"If you look inside the function in the decompiled code, you will find the only modified section at the end.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_16":{"__typename":"Paragraph","id":"a4bb5fdf6844_16","name":"f91c","type":"P","href":null,"layout":null,"metadata":null,"text":"In the July 23 version:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*q7q0oiSH5dQZjoWzHN5-hA.png":{"__typename":"ImageMetadata","id":"1*q7q0oiSH5dQZjoWzHN5-hA.png","originalHeight":419,"originalWidth":1558,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_17":{"__typename":"Paragraph","id":"a4bb5fdf6844_17","name":"c6bc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*q7q0oiSH5dQZjoWzHN5-hA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_18":{"__typename":"Paragraph","id":"a4bb5fdf6844_18","name":"5e0b","type":"P","href":null,"layout":null,"metadata":null,"text":"In the August 13 version:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*PEFhRLNGuShT_3cugu7A3w.png":{"__typename":"ImageMetadata","id":"1*PEFhRLNGuShT_3cugu7A3w.png","originalHeight":442,"originalWidth":1412,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_19":{"__typename":"Paragraph","id":"a4bb5fdf6844_19","name":"5927","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*PEFhRLNGuShT_3cugu7A3w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_20":{"__typename":"Paragraph","id":"a4bb5fdf6844_20","name":"cdb6","type":"P","href":null,"layout":null,"metadata":null,"text":"The IppSendError function is now used instead of IppSendErrorList when errors occur in the processing of IPv6 options. The difference between them is that IppSendErrorList sends errors to every packet in the chain, while IppSendError sends them to only one packet. You can see this if you look at the decompiled code of the IppSendErrorList function:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":49,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":155,"end":171,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":221,"end":233,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":324,"end":340,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nQYkgrmnvSEOcSYo_dhXpQ.png":{"__typename":"ImageMetadata","id":"1*nQYkgrmnvSEOcSYo_dhXpQ.png","originalHeight":287,"originalWidth":521,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_21":{"__typename":"Paragraph","id":"a4bb5fdf6844_21","name":"a95e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nQYkgrmnvSEOcSYo_dhXpQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_22":{"__typename":"Paragraph","id":"a4bb5fdf6844_22","name":"8ccb","type":"P","href":null,"layout":null,"metadata":null,"text":"Further analysis of the code around the modified section reveals the logic: Ipv6pProcessOptions is designed to process only one packet (or fragment) while IppSendErrorList goes through all packets in the chain. This is an obvious logical mistake that may lead to something bad. However, we did not know what kind of bad exactly, so we continued our research. But first we decided to develop a checker to see if we understood the logic correctly.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":76,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":155,"end":171,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_23":{"__typename":"Paragraph","id":"a4bb5fdf6844_23","name":"ac9b","type":"P","href":null,"layout":null,"metadata":null,"text":"Indeed, there were six responses to three packets with errors in IPv6 options:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_24":{"__typename":"Paragraph","id":"a4bb5fdf6844_24","name":"fab9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"three errors per Packet1 (Packet1 → Packet2 → Packet3)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_25":{"__typename":"Paragraph","id":"a4bb5fdf6844_25","name":"2348","type":"ULI","href":null,"layout":null,"metadata":null,"text":"two errors per Packet2 (Packet2 → Packet3)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_26":{"__typename":"Paragraph","id":"a4bb5fdf6844_26","name":"6db3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"one error per Packet3 (Packet3)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yuEKn4geC3g605fCOORXrg.png":{"__typename":"ImageMetadata","id":"1*yuEKn4geC3g605fCOORXrg.png","originalHeight":223,"originalWidth":896,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_27":{"__typename":"Paragraph","id":"a4bb5fdf6844_27","name":"cfca","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*yuEKn4geC3g605fCOORXrg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_28":{"__typename":"Paragraph","id":"a4bb5fdf6844_28","name":"e596","type":"P","href":null,"layout":null,"metadata":null,"text":"It should be noted that packets with errors will reach the sender only if Windows Firewall is disabled on the system. However, having the firewall enabled does not affect whether the packets sent reach the vulnerable system, as they are processed at the OS kernel level even before being processed by the firewall.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_29":{"__typename":"Paragraph","id":"a4bb5fdf6844_29","name":"b147","type":"H3","href":null,"layout":null,"metadata":null,"text":"Zero to Hero","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_30":{"__typename":"Paragraph","id":"a4bb5fdf6844_30","name":"d24a","type":"P","href":null,"layout":null,"metadata":null,"text":"When viewing the decompiled code of the IppSendError function, you may notice the following fragment:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":40,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wUd9MnfO02ZyA_wXqLkjZg.png":{"__typename":"ImageMetadata","id":"1*wUd9MnfO02ZyA_wXqLkjZg.png","originalHeight":89,"originalWidth":1003,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_31":{"__typename":"Paragraph","id":"a4bb5fdf6844_31","name":"7ab4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wUd9MnfO02ZyA_wXqLkjZg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_32":{"__typename":"Paragraph","id":"a4bb5fdf6844_32","name":"25c1","type":"P","href":null,"layout":null,"metadata":null,"text":"This behavior is correct as calling this function terminates the processing of the current packet and sends an error message. However, due to the fact that in the vulnerable driver version this code snippet is executed for each packet from the chain, including unprocessed ones, there is a probability that the IPv6_HeaderSize field will be used for processing subsequent packets. In fact, this field is equal to the IPv6 header size, including all nested option headers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":311,"end":326,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_33":{"__typename":"Paragraph","id":"a4bb5fdf6844_33","name":"cf2d","type":"P","href":null,"layout":null,"metadata":null,"text":"We realized that this should not be like that and that the size field should not be equal to zero in a working packet. We could not figure out where exactly to apply this primitive for quite some time, hence we turned to previous studies of vulnerabilities in the Windows TCP\u002FIP network stack (1, 2).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":294,"end":295,"href":"https:\u002F\u002Fdoar-e.github.io\u002Fblog\u002F2021\u002F04\u002F15\u002Freverse-engineering-tcpipsys-mechanics-of-a-packet-of-the-death-cve-2021-24086\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":297,"end":298,"href":"https:\u002F\u002Fblog.quarkslab.com\u002Fanalysis-of-a-windows-ipv6-fragmentation-vulnerability-cve-2021-24086.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_34":{"__typename":"Paragraph","id":"a4bb5fdf6844_34","name":"aa51","type":"P","href":null,"layout":null,"metadata":null,"text":"We came across an article exploring a similar vulnerability stemming from IPv6 fragmentation, CVE-2022–34718. The vulnerability was in the Ipv6pReassembleDatagram function that uses the undocumented Packet_t and Reassembly_t objects.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":139,"end":162,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":199,"end":207,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":212,"end":224,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":18,"end":25,"href":"https:\u002F\u002Fsecurityintelligence.com\u002Fx-force\u002Fdissecting-exploiting-tcp-ip-rce-vulnerability-evilesp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_35":{"__typename":"Paragraph","id":"a4bb5fdf6844_35","name":"811f","type":"P","href":null,"layout":null,"metadata":null,"text":"Although this function does not use the field whose value we changed, it affects the fields of the Reassembly_t object in the parent Ipv6pReceiveFragment:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":99,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":133,"end":153,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*OzbOq1vdzN2doUvJzHjeoQ.png":{"__typename":"ImageMetadata","id":"1*OzbOq1vdzN2doUvJzHjeoQ.png","originalHeight":195,"originalWidth":985,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_36":{"__typename":"Paragraph","id":"a4bb5fdf6844_36","name":"e13b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*OzbOq1vdzN2doUvJzHjeoQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_37":{"__typename":"Paragraph","id":"a4bb5fdf6844_37","name":"2583","type":"P","href":null,"layout":null,"metadata":null,"text":"Here we can see that 0x30 is subtracted from the value of the IPv6_HeaderSize field that was incorrectly changed earlier, because the function assumes that the size cannot be less than 48 bytes at this stage. This code snippet is a great opportunity to apply the previously acquired primitive, but we still need to get here. To do so, we need to pass two checks, the first of which can be seen in the image above: it checks whether the fragment is the first in the chain. Although this condition reduces the exploitation possibilities, it does not reduce them enough: one packet may well suffice.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":21,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_38":{"__typename":"Paragraph","id":"a4bb5fdf6844_38","name":"ce98","type":"P","href":null,"layout":null,"metadata":null,"text":"The second condition is to check that the fragment offset is not zero, but because of the processing in IppSendError (within which NetioRetreatNetBufferList is called to return the caret to the beginning of the packet), this condition actually checks that FlowLabel in the IPv6 header structure is not zero.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":104,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":131,"end":156,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":256,"end":265,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*byEOopyo3qKUmZQA8iw2pg.png":{"__typename":"ImageMetadata","id":"1*byEOopyo3qKUmZQA8iw2pg.png","originalHeight":281,"originalWidth":790,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_39":{"__typename":"Paragraph","id":"a4bb5fdf6844_39","name":"03d7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*byEOopyo3qKUmZQA8iw2pg.png"},"text":"How Windows sees the tcpip.sys code","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":21,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*l18WvNN8iGGPOCzhF03-ow.png":{"__typename":"ImageMetadata","id":"1*l18WvNN8iGGPOCzhF03-ow.png","originalHeight":286,"originalWidth":946,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_40":{"__typename":"Paragraph","id":"a4bb5fdf6844_40","name":"76e6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*l18WvNN8iGGPOCzhF03-ow.png"},"text":"What occurs in reality","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_41":{"__typename":"Paragraph","id":"a4bb5fdf6844_41","name":"a9cf","type":"P","href":null,"layout":null,"metadata":null,"text":"This structure field is used in the above mentioned Ipv6pReassembleDatagram function when copying data from the buffer.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":52,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ppRrTK8I2R9HsjfretguUA.png":{"__typename":"ImageMetadata","id":"1*ppRrTK8I2R9HsjfretguUA.png","originalHeight":90,"originalWidth":1179,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_42":{"__typename":"Paragraph","id":"a4bb5fdf6844_42","name":"e93b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ppRrTK8I2R9HsjfretguUA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_43":{"__typename":"Paragraph","id":"a4bb5fdf6844_43","name":"89b1","type":"P","href":null,"layout":null,"metadata":null,"text":"At this point, we were already confident that we had fully understood the vulnerability, but the kernel did not get to the point of executing the necessary code because of the next check at the beginning of the function:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jw5B4SLqoU5s9EMAdYTZ_A.png":{"__typename":"ImageMetadata","id":"1*jw5B4SLqoU5s9EMAdYTZ_A.png","originalHeight":310,"originalWidth":1168,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_44":{"__typename":"Paragraph","id":"a4bb5fdf6844_44","name":"3386","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jw5B4SLqoU5s9EMAdYTZ_A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_45":{"__typename":"Paragraph","id":"a4bb5fdf6844_45","name":"cc38","type":"P","href":null,"layout":null,"metadata":null,"text":"Here, the TotalLength variable is equal to the sum of the size of the newly initialized Reassembly_t with our size in underflow (it always equals 0xffd8 after exploitation):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":88,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":146,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*DrvUsjrBSqub1yGPkcvuNg.png":{"__typename":"ImageMetadata","id":"1*DrvUsjrBSqub1yGPkcvuNg.png","originalHeight":61,"originalWidth":787,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_46":{"__typename":"Paragraph","id":"a4bb5fdf6844_46","name":"2117","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*DrvUsjrBSqub1yGPkcvuNg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_47":{"__typename":"Paragraph","id":"a4bb5fdf6844_47","name":"ec4f","type":"P","href":null,"layout":null,"metadata":null,"text":"You might think that there is an overflow of UnfragmentableLength here, but the addition is performed within the UInt32 type, so the overflow will not occur and TotalLength will be greater than 0xfff.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":45,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":113,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":161,"end":172,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":194,"end":199,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_48":{"__typename":"Paragraph","id":"a4bb5fdf6844_48","name":"b74b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Finish and impact","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_49":{"__typename":"Paragraph","id":"a4bb5fdf6844_49","name":"dd8c","type":"P","href":null,"layout":null,"metadata":null,"text":"While researching other functions that use the Reassembly structure, we found a handler that is called when the timeout for the next fragment expires, Ipv6pReassemblyTimeout. This function also copies data from our buffer using negative (large positive) size.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":47,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":151,"end":173,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Ok7ImW-XBYFXAkX8U9Xmcw.png":{"__typename":"ImageMetadata","id":"1*Ok7ImW-XBYFXAkX8U9Xmcw.png","originalHeight":115,"originalWidth":1180,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:a4bb5fdf6844_50":{"__typename":"Paragraph","id":"a4bb5fdf6844_50","name":"d4e5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Ok7ImW-XBYFXAkX8U9Xmcw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_51":{"__typename":"Paragraph","id":"a4bb5fdf6844_51","name":"b00b","type":"P","href":null,"layout":null,"metadata":null,"text":"To get to this code snippet, we need to set FlowLimit equal to one (due to IppSendError, the driver interprets this field as FragOffset) and wait for one minute. After that, the pool buffer in the Windows kernel overflows with values almost completely controlled by us, because it is quite easy to spray the necessary chunks nearby. It would seem that everything is fine, right?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":44,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":75,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":125,"end":135,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_52":{"__typename":"Paragraph","id":"a4bb5fdf6844_52","name":"1884","type":"P","href":null,"layout":null,"metadata":null,"text":"There is always a big problem in the remote exploitation of such vulnerabilities: we do not know the kernel addresses after KASLR. If we were executing on the attacked host itself (which is quite possible and allows privileges to be elevated to SYSTEM), we could exploit the full variety of KASLR leaks in Windows (1, 2). However, this is not our case, although the above method of using the primitive provides excellent opportunities for local privilege escalation and remote BSOD. Strict limitations on the size of the allocated memory section do not allow us to learn the kernel address without letting the kernel crash.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":315,"end":316,"href":"https:\u002F\u002Fexploits.forsale\u002F24h2-nt-exploit","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":318,"end":319,"href":"https:\u002F\u002Fgithub.com\u002Fwaleedassar\u002FRestrictedKernelLeaks","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_53":{"__typename":"Paragraph","id":"a4bb5fdf6844_53","name":"500e","type":"P","href":null,"layout":null,"metadata":null,"text":"There are two caveats here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_54":{"__typename":"Paragraph","id":"a4bb5fdf6844_54","name":"6188","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Any additional kernel vulnerability that could compromise KASLR addresses — in a chain with the presented vulnerability — leads to RCE.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_55":{"__typename":"Paragraph","id":"a4bb5fdf6844_55","name":"b590","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The Windows networking stack is one of the most complex parts of the OS. The exploitation primitive presented in this article can affect sections of code in subsequent packet processing, so it is likely that there are other (highly sophisticated) attack methods that will lead to KASLR leakage and kernel compromise.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_56":{"__typename":"Paragraph","id":"a4bb5fdf6844_56","name":"16c4","type":"P","href":null,"layout":null,"metadata":null,"text":"Despite the complexity associated with the exploitation of this zero‑click TCP\u002FIP RCE flaw, we recommend you to disable IPv6 at the hosts where it is not used. As part of safety recommendations, BI.ZONE EDR detects enabled IPv6 components in the host’s network interfaces and notifies the monitoring team of the identified misconfiguration. This rule is available both in the on‑prem BI.ZONE EDR version and in BI.ZONE TDR.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":195,"end":206,"href":"https:\u002F\u002Fbi.zone\u002Feng\u002Fcatalog\u002Fproducts\u002Fedr\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":411,"end":422,"href":"https:\u002F\u002Fbi.zone\u002Feng\u002Fcatalog\u002Fservices\u002Fthreat-detection-and-response\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_57":{"__typename":"Paragraph","id":"a4bb5fdf6844_57","name":"36b1","type":"H3","href":null,"layout":null,"metadata":null,"text":"PoC video","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:a4bb5fdf6844_58":{"__typename":"Paragraph","id":"a4bb5fdf6844_58","name":"4e5b","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"VK | Video Ext\nEdit descriptionvk.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":37,"href":"https:\u002F\u002Fvk.com\u002Fvideo_ext.php?oid=-187584378&id=456239240&hash=fc1bf11222b41706","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":15,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fvk.com\u002Fvideo_ext.php?oid=-187584378&id=456239240&hash=fc1bf11222b41706","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":""}},"PostViewerEdge:postId:bdae36f5f61d-viewerId:lo_d99b47f7efe9":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:bdae36f5f61d-viewerId:lo_d99b47f7efe9"},"Tag:cve":{"__typename":"Tag","id":"cve","displayTitle":"Cve","normalizedTagSlug":"cve"},"Tag:windows":{"__typename":"Tag","id":"windows","displayTitle":"Windows","normalizedTagSlug":"windows"},"Tag:information-security":{"__typename":"Tag","id":"information-security","displayTitle":"Information Security","normalizedTagSlug":"information-security"},"Tag:critical-vulnerabilities":{"__typename":"Tag","id":"critical-vulnerabilities","displayTitle":"Critical Vulnerabilities","normalizedTagSlug":"critical-vulnerabilities"},"Post:bdae36f5f61d":{"__typename":"Post","id":"bdae36f5f61d","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"5377","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"bde5","startIndex":3,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:a4bb5fdf6844_0"},{"__ref":"Paragraph:a4bb5fdf6844_1"},{"__ref":"Paragraph:a4bb5fdf6844_2"},{"__ref":"Paragraph:a4bb5fdf6844_3"},{"__ref":"Paragraph:a4bb5fdf6844_4"},{"__ref":"Paragraph:a4bb5fdf6844_5"},{"__ref":"Paragraph:a4bb5fdf6844_6"},{"__ref":"Paragraph:a4bb5fdf6844_7"},{"__ref":"Paragraph:a4bb5fdf6844_8"},{"__ref":"Paragraph:a4bb5fdf6844_9"},{"__ref":"Paragraph:a4bb5fdf6844_10"},{"__ref":"Paragraph:a4bb5fdf6844_11"},{"__ref":"Paragraph:a4bb5fdf6844_12"},{"__ref":"Paragraph:a4bb5fdf6844_13"},{"__ref":"Paragraph:a4bb5fdf6844_14"},{"__ref":"Paragraph:a4bb5fdf6844_15"},{"__ref":"Paragraph:a4bb5fdf6844_16"},{"__ref":"Paragraph:a4bb5fdf6844_17"},{"__ref":"Paragraph:a4bb5fdf6844_18"},{"__ref":"Paragraph:a4bb5fdf6844_19"},{"__ref":"Paragraph:a4bb5fdf6844_20"},{"__ref":"Paragraph:a4bb5fdf6844_21"},{"__ref":"Paragraph:a4bb5fdf6844_22"},{"__ref":"Paragraph:a4bb5fdf6844_23"},{"__ref":"Paragraph:a4bb5fdf6844_24"},{"__ref":"Paragraph:a4bb5fdf6844_25"},{"__ref":"Paragraph:a4bb5fdf6844_26"},{"__ref":"Paragraph:a4bb5fdf6844_27"},{"__ref":"Paragraph:a4bb5fdf6844_28"},{"__ref":"Paragraph:a4bb5fdf6844_29"},{"__ref":"Paragraph:a4bb5fdf6844_30"},{"__ref":"Paragraph:a4bb5fdf6844_31"},{"__ref":"Paragraph:a4bb5fdf6844_32"},{"__ref":"Paragraph:a4bb5fdf6844_33"},{"__ref":"Paragraph:a4bb5fdf6844_34"},{"__ref":"Paragraph:a4bb5fdf6844_35"},{"__ref":"Paragraph:a4bb5fdf6844_36"},{"__ref":"Paragraph:a4bb5fdf6844_37"},{"__ref":"Paragraph:a4bb5fdf6844_38"},{"__ref":"Paragraph:a4bb5fdf6844_39"},{"__ref":"Paragraph:a4bb5fdf6844_40"},{"__ref":"Paragraph:a4bb5fdf6844_41"},{"__ref":"Paragraph:a4bb5fdf6844_42"},{"__ref":"Paragraph:a4bb5fdf6844_43"},{"__ref":"Paragraph:a4bb5fdf6844_44"},{"__ref":"Paragraph:a4bb5fdf6844_45"},{"__ref":"Paragraph:a4bb5fdf6844_46"},{"__ref":"Paragraph:a4bb5fdf6844_47"},{"__ref":"Paragraph:a4bb5fdf6844_48"},{"__ref":"Paragraph:a4bb5fdf6844_49"},{"__ref":"Paragraph:a4bb5fdf6844_50"},{"__ref":"Paragraph:a4bb5fdf6844_51"},{"__ref":"Paragraph:a4bb5fdf6844_52"},{"__ref":"Paragraph:a4bb5fdf6844_53"},{"__ref":"Paragraph:a4bb5fdf6844_54"},{"__ref":"Paragraph:a4bb5fdf6844_55"},{"__ref":"Paragraph:a4bb5fdf6844_56"},{"__ref":"Paragraph:a4bb5fdf6844_57"},{"__ref":"Paragraph:a4bb5fdf6844_58"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3882bedad280"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fbi-zone.medium.com\u002Fbreaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"a4bb5fdf6844","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":1},"clapCount":25,"allowResponses":true,"isLimitedState":false,"title":"Breaking down CVE-2024–38063: remote exploitation of the Windows kernel","isSeries":false,"sequence":null,"uniqueSlug":"breaking-down-cve-2024-38063-remote-exploitation-of-the-windows-kernel-bdae36f5f61d","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1725355987321,"readingTime":7.2405660377358485,"previewContent":{"__typename":"PreviewContent","subtitle":"We have examined the Windows TCP\u002FIP network stack flaw that could grant adversaries remote access with maximum privileges. Exploiting…"},"previewImage":{"__ref":"ImageMetadata:1*H0hIz2jYIpwkP0td9qSr3g.jpeg"},"isShortform":false,"seoTitle":"","firstPublishedAt":1725355987321,"updatedAt":1725555535308,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:bdae36f5f61d-viewerId:lo_d99b47f7efe9"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cve"},{"__ref":"Tag:windows"},{"__ref":"Tag:information-security"},{"__ref":"Tag:critical-vulnerabilities"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1508,"layerCake":1,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3c1e362d.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.f987734e.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.90da86c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.5b3eb23a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ec375b59.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.a8a73f48.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.afb7e926.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.4f29140a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7346.72622eb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.e27cfbf2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.632f048c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.9a326611.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8dee77fc79dee01b',t:'MTczMDk5NDUxOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8dee77fc79dee01b","version":"2024.10.4","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>