<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Malware Analysis &#8211; PlugX | Count Upon Security</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="pingback" href="https://countuponsecurity.com/xmlrpc.php" />
	<meta name='robots' content='max-image-preview:large' />
<meta name="google-site-verification" content="-I4ZlLx2JIUqogjWZCw4CEPyPGlqBofuH4Cxa-wOsiE" />

<!-- Async WordPress.com Remote Login -->
<script id="wpcom_remote_login_js">
var wpcom_remote_login_extra_auth = '';
function wpcom_remote_login_remove_dom_node_id( element_id ) {
	var dom_node = document.getElementById( element_id );
	if ( dom_node ) { dom_node.parentNode.removeChild( dom_node ); }
}
function wpcom_remote_login_remove_dom_node_classes( class_name ) {
	var dom_nodes = document.querySelectorAll( '.' + class_name );
	for ( var i = 0; i < dom_nodes.length; i++ ) {
		dom_nodes[ i ].parentNode.removeChild( dom_nodes[ i ] );
	}
}
function wpcom_remote_login_final_cleanup() {
	wpcom_remote_login_remove_dom_node_classes( "wpcom_remote_login_msg" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_validate" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_js" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_iframe" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_styles" );
}

// Watch for messages back from the remote login
window.addEventListener( "message", function( e ) {
	if ( e.origin === "https://r-login.wordpress.com" ) {
		var data = {};
		try {
			data = JSON.parse( e.data );
		} catch( e ) {
			wpcom_remote_login_final_cleanup();
			return;
		}

		if ( data.msg === 'LOGIN' ) {
			// Clean up the login check iframe
			wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );

			var id_regex = new RegExp( /^[0-9]+$/ );
			var token_regex = new RegExp( /^.*|.*|.*$/ );
			if (
				token_regex.test( data.token )
				&& id_regex.test( data.wpcomid )
			) {
				// We have everything we need to ask for a login
				var script = document.createElement( "script" );
				script.setAttribute( "id", "wpcom_remote_login_validate" );
				script.src = '/remote-login.php?wpcom_remote_login=validate'
					+ '&wpcomid=' + data.wpcomid
					+ '&token=' + encodeURIComponent( data.token )
					+ '&host=' + window.location.protocol
					+ '//' + window.location.hostname
					+ '&postid=3953'
					+ '&is_singular=1';
				document.body.appendChild( script );
			}

			return;
		}

		// Safari ITP, not logged in, so redirect
		if ( data.msg === 'LOGIN-REDIRECT' ) {
			window.location = 'https://wordpress.com/log-in?redirect_to=' + window.location.href;
			return;
		}

		// Safari ITP, storage access failed, remove the request
		if ( data.msg === 'LOGIN-REMOVE' ) {
			var css_zap = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } @media screen and ( max-width: 782px ) { html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } }';
			var style_zap = document.createElement( 'style' );
			style_zap.type = 'text/css';
			style_zap.appendChild( document.createTextNode( css_zap ) );
			document.body.appendChild( style_zap );

			var e = document.getElementById( 'wpcom_request_access_iframe' );
			e.parentNode.removeChild( e );

			document.cookie = 'wordpress_com_login_access=denied; path=/; max-age=31536000';

			return;
		}

		// Safari ITP
		if ( data.msg === 'REQUEST_ACCESS' ) {
			console.log( 'request access: safari' );

			// Check ITP iframe enable/disable knob
			if ( wpcom_remote_login_extra_auth !== 'safari_itp_iframe' ) {
				return;
			}

			// If we are in a "private window" there is no ITP.
			var private_window = false;
			try {
				var opendb = window.openDatabase( null, null, null, null );
			} catch( e ) {
				private_window = true;
			}

			if ( private_window ) {
				console.log( 'private window' );
				return;
			}

			var iframe = document.createElement( 'iframe' );
			iframe.id = 'wpcom_request_access_iframe';
			iframe.setAttribute( 'scrolling', 'no' );
			iframe.setAttribute( 'sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-top-navigation-by-user-activation' );
			iframe.src = 'https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=request_access&origin=' + encodeURIComponent( data.origin ) + '&wpcomid=' + encodeURIComponent( data.wpcomid );

			var css = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 46px !important; } * html body { margin-top: 46px !important; } @media screen and ( max-width: 660px ) { html { margin-top: 71px !important; } * html body { margin-top: 71px !important; } #wpcom_request_access_iframe { display: block; height: 71px !important; } } #wpcom_request_access_iframe { border: 0px; height: 46px; position: fixed; top: 0; left: 0; width: 100%; min-width: 100%; z-index: 99999; background: #23282d; } ';

			var style = document.createElement( 'style' );
			style.type = 'text/css';
			style.id = 'wpcom_request_access_styles';
			style.appendChild( document.createTextNode( css ) );
			document.body.appendChild( style );

			document.body.appendChild( iframe );
		}

		if ( data.msg === 'DONE' ) {
			wpcom_remote_login_final_cleanup();
		}
	}
}, false );

// Inject the remote login iframe after the page has had a chance to load
// more critical resources
window.addEventListener( "DOMContentLoaded", function( e ) {
	var iframe = document.createElement( "iframe" );
	iframe.style.display = "none";
	iframe.setAttribute( "scrolling", "no" );
	iframe.setAttribute( "id", "wpcom_remote_login_key" );
	iframe.src = "https://r-login.wordpress.com/remote-login.php"
		+ "?wpcom_remote_login=key"
		+ "&origin=aHR0cHM6Ly9jb3VudHVwb25zZWN1cml0eS5jb20%3D"
		+ "&wpcomid=42387852"
		+ "&time=1734505498";
	document.body.appendChild( iframe );
}, false );
</script>
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//wordpress.com' />
<link rel='dns-prefetch' href='//fonts-api.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Count Upon Security &raquo; Feed" href="https://countuponsecurity.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Count Upon Security &raquo; Comments Feed" href="https://countuponsecurity.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Count Upon Security &raquo; Malware Analysis &#8211;&nbsp;PlugX Comments Feed" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s2.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1719498190i&ver=6.8-alpha-59438"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s1.wp.com/_static/??-eJxtzFsKgCAQheENZaMg+BStRXQI80oz0vbDCILo5cAHhx/OJlwtjIUhd9FS30Ih2JGbdfEx5FrH+J6Q4MBkGb1olfij2RFN8J9MIeIbvjXua16UUUZLLY3eL2BkNNM=&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJydzEEOAiEMheELCXUGE3VhPAswpOmIQNqi4faObty5cPny8v3wbCbWoqkotNyRigD2bYbEuD2c4DGd7cnuIXTKC4Rc481kCux5gOjIyUaRHfwMfZTAmrT5N/ejdjXItPybYK9UUL78er9MR+fcfHCzW185xE/S&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s2.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-10-1' href='https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1729082728i&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='verbum-gutenberg-css-css' href='https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1721244820' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/comment-likes/css/comment-likes.css,/i/noticons/noticons.css,/wp-content/themes/pub/chunk/style.css?m=1467386201j&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='oswald-css' href='https://fonts-api.wp.com/css?family=Oswald&#038;subset=latin%2Clatin-ext&#038;ver=6.8-alpha-59438' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-14-1' href='https://s0.wp.com/_static/??-eJx9y0EKwkAMheELGUNhRF2IZ2lDnI5mkqHJULy9dVc37t4P78O1AZkGa2DMXNmx9Qlp7vrCooQeb2FYG1k9kvsBd6B2aNJzUceFJ7G8zYzba5f/UGYDMRqjmP4EPGQsy5fe621Ip2tKl/OQnh94REAa&cssminify=yes' type='text/css' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='print-css-15-1' href='https://s1.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035i&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-18-1' href='https://s2.wp.com/_static/??-eJyNjcEKwjAQRH/IuA1aehI/ReImJKmb3eAmFP9eW3oRL16GeTC8gaUaFG6BG5RuKvWYWWEOrTp87AxFZA3fKShocs/gnfevrWaOR1Q9wP+mW2YEFcyODEkU/YIfW0uhfH7TGSLJ3dE6uJaLneww2mkYT/MbUOlJHA==&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"42387852","postID":"3953","siteURL":"https:\/\/countuponsecurity.com","xhrURL":"https:\/\/countuponsecurity.com\/wp-admin\/admin-ajax.php","nonce":"c432faa6c1","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p2RR12-11L","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/s1.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/_static/??/wp-content/mu-plugins/jetpack-plugin/moon/_inc/build/related-posts/related-posts.min.js,/wp-content/js/rlt-proxy.js?m=1733762913j'></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://countuponsecurity.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/" />
<link rel='shortlink' href='https://wp.me/p2RR12-11L' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fcountuponsecurity.com%2F2018%2F02%2F04%2Fmalware-analysis-plugx%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fcountuponsecurity.com%2F2018%2F02%2F04%2Fmalware-analysis-plugx%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Malware Analysis &#8211; PlugX" />
<meta property="og:url" content="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/" />
<meta property="og:description" content="[The PlugX malware family has always intrigued me. I was curious to look at one variant. Going over the Internet and the research articles and blogs about it I came across the research made by Fabi…" />
<meta property="article:published_time" content="2018-02-04T17:39:44+00:00" />
<meta property="article:modified_time" content="2018-02-05T15:39:09+00:00" />
<meta property="og:site_name" content="Count Upon Security" />
<meta property="og:image" content="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=300" />
<meta property="og:image:width" content="300" />
<meta property="og:image:height" content="251" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<meta name="twitter:creator" content="@countuponsec" />
<meta name="twitter:site" content="@countuponsec" />
<meta name="twitter:text:title" content="Malware Analysis &#8211;&nbsp;PlugX" />
<meta name="twitter:image" content="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=32" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=32" sizes="16x16" />
<link rel="apple-touch-icon" href="https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=114" />
<link rel='openid.server' href='https://countuponsecurity.com/?openidserver=1' />
<link rel='openid.delegate' href='https://countuponsecurity.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://countuponsecurity.com/osd.xml" title="Count Upon Security" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="application-name" content="Count Upon Security" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Increase security awareness. Promote, reinforce and learn security skills." /><meta name="description" content="[The PlugX malware family has always intrigued me. I was curious to look at one variant. Going over the Internet and the research articles and blogs about it I came across the research made by Fabien Perigaud. From here I got an old PlugX builder. Then I set a lab that allowed me to get&hellip;" />
</head>
<body class="post-template-default single single-post postid-3953 single-format-standard customizer-styles-applied multiple-authors jetpack-reblog-enabled">

<div id="container">

	<div id="header">
		<h1 id="site-title"><a href="https://countuponsecurity.com/" title="Count Upon Security" rel="home">Count Upon Security</a></h1>
		<h2 id="site-description">Increase security awareness. Promote, reinforce and learn security skills.</h2>
	</div>

	<div id="menu">
				<div id="header-image">
			<a href="https://countuponsecurity.com/">
				<img src="https://countuponsecurity.com/wp-content/uploads/2012/11/camera.jpg" width="800" height="140" alt="" />
			</a>
		</div>
				<div class="menu"><ul>
<li ><a href="https://countuponsecurity.com/">Home</a></li><li class="page_item page-item-2"><a href="https://countuponsecurity.com/about/">About</a></li>
<li class="page_item page-item-2393"><a href="https://countuponsecurity.com/papers/">Papers</a></li>
</ul></div>
	</div>

	<div id="contents">
					
				
<div class="post-3953 post type-post status-publish format-standard hentry category-malware-analysis category-threat-intelligence tag-apt tag-dll-hijacking tag-plugx tag-plugx-analysis tag-process-hollowing tag-sogu" id="post-3953">
	<div class="entry-meta">
				<div class="date"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/">Feb 04 2018</a></div>
						<div class="comments"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comments">6 Comments</a></div>
						<span class="byline">
			<a href="https://countuponsecurity.com/author/countuponsecurity/">
				By Luis Rocha			</a>
		</span><!-- .byline -->
				<span class="cat-links"><a href="https://countuponsecurity.com/category/malware-analysis/" rel="category tag">Malware Analysis</a>, <a href="https://countuponsecurity.com/category/threat-intelligence/" rel="category tag">Threat Intelligence</a></span>
							</div>
	<div class="main">
						<h2 class="entry-title">
					Malware Analysis &#8211;&nbsp;PlugX				</h2>
		
		<div class="entry-content">
						<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png"><img data-attachment-id="3985" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-2/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png" data-orig-size="745,623" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=580" class="alignright wp-image-3985 size-medium" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=300&#038;h=251" alt="" width="300" height="251" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=600 600w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx.png?w=150 150w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><em>[The PlugX malware family has always intrigued me. I was curious to look at one variant. Going over the Internet and the research articles and blogs about it I came across the <a href="http://blog.airbuscybersecurity.com/post/2016/06/Getting-a-PlugX-builder">research</a> made by Fabien Perigaud. From here I got an old PlugX builder. Then I set a lab that allowed me to get insight about how an attacker would operate a PlugX campaign. In this post, l will cover a brief overview about the PlugX builder, analyze and debug the malware installation and do a quick look at the C2 traffic. ~LR]</em></p>
<p>PlugX is commonly used by <a href="https://www.fireeye.com/blog/threat-research/2017/04/apt10_menupass_grou.html">different</a> <a href="https://researchcenter.paloaltonetworks.com/2017/06/unit42-paranoid-plugx/">threat</a> <a href="http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html">groups</a> <a href="https://www.lastline.com/labsblog/an-analysis-of-plugx-malware/">on</a> <a href="https://researchcenter.paloaltonetworks.com/2015/05/plugx-uses-legitimate-samsung-application-for-dll-side-loading/">targeted</a> <a href="https://www.fireeye.com/blog/threat-research/2013/05/targeted-attack-trend-alert-plugx-the-old-dog-with-a-new-trick.html">attacks</a>. PlugX is also refered as KORPLUG, SOGU, DestroyRAT and is a modular backdoor that is designed to rely on the execution of signed and legitimated executables to load malicious code. PlugX, normally has three main components, a DLL, an encrypted binary file and a legitimate and signed executable that is used to load the malware using a technique known as <a href="https://countuponsecurity.com/2016/05/24/digital-forensics-dll-search-order/">DLL search order hijacking</a>. But let&#8217;s start with a quick overview about the builder.</p>
<p>The patched builder, MD5 6aad032a084de893b0e8184c17f0376a, is an English version, from Q3 2013,  of the featured-rich and modular command &amp; control interface for PlugX that allows an operator to:</p>
<ul>
<li>Build payloads, set campaigns and define the preferred method for the compromised hosts to check-in and communicate with the controller.</li>
<li>Proxy connections and build a tiered C2 communication model.</li>
<li>Define persistence mechanisms and its attributes.</li>
<li>Set the process(s) to be injected with the payload.</li>
<li>Define a schedule for the C2 call backs.</li>
<li>Enable keylogging and screen capture.</li>
<li>Manage compromises systems per campaign.</li>
</ul>
<p>Then for each compromised system, the operator has extensive capabilities to interact with the systems over the controller that includes the following modules:</p>
<ul>
<li>Disk module allows the operator to write, read, upload, download and execute files.</li>
<li>Networking browser module allows the operator to browse network connections and connect to another system via SMB.</li>
<li>Process module to enumerate, kill and list loaded modules per process.</li>
<li>Services module allows the operator to enumerate, start, stop and changing booting properties</li>
<li>Registry module allows the operator to browse the registry and create, delete or modify keys.</li>
<li>Netstat module allows the operator to enumerate TCP and UDP network connections and the associated processes</li>
<li>Capture module allows the operator to perform screen captures</li>
<li>Control plugin allows the operator to view or remote control the compromised system in a similar way like VNC.</li>
<li>Shell module allows the operator to get a command line shell on the compromised system.</li>
<li>PortMap module allows the operator to establish port forwarding rules.</li>
<li>SQL module allows the operator to connect to SQL servers and execute SQL statements.</li>
<li>Option module allows the operator to shut down, reboot, lock, log-off or send message boxes.</li>
<li>Keylogger module captures keystrokes per process including window titles.</li>
</ul>
<p>The picture below shows the Plug-X C2 interface.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png"><img data-attachment-id="3972" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plgux-manager/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png" data-orig-size="1828,594" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plgux-manager" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=580" class="aligncenter size-large wp-image-3972" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=580&#038;h=188" alt="" width="580" height="188" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=1157 1157w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-manager.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>So, with this we used the builder functionality to define the different settings specifying C2 comms password, campaign, mutex, IP addresses, installation properties, injected binaries, schedule for call-back, etc. Then we build our payload. The PlugX binary produced by this version of the builder (LZ 2013-8-18) is a self-extracting RAR archive that contains three files. This is sometimes referred in the literature as the PlugX trinity payload. Executing the self-extracting RAR archive will drop the three files to the directory chosen during the process. In this case “%AUTO%/RasTls”. The files are: A legitimate signed executable from Kaspersky AV solution named “avp.exe”, MD5 e26d04cecd6c7c71cfbb3f335875bc31, which is susceptible to <a href="https://countuponsecurity.com/2016/05/24/digital-forensics-dll-search-order/">DLL search order hijacking</a> . The file “avp.exe” when executed will load the second file: “ushata.dll”, MD5 728fe666b673c781f5a018490a7a412a, which in this case is a DLL crafted by the PlugX builder which on is turn will load the third file. The third file: “ushata.DLL.818”, MD5 “21078990300b4cdb6149dbd95dff146f” contains obfuscated and packed shellcode.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png"><img data-attachment-id="3960" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-avpsignature/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png" data-orig-size="1641,679" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-avpsignature" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=580" class="aligncenter wp-image-3960 size-large" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=580&#038;h=240" alt="" width="580" height="240" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-avpsignature.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>So, let&#8217;s look at the mechanics of what happens when the self-extracting archive is executed. The three files are extracted to a temporary directory and &#8220;avp.exe&#8221; is executed. The “avp.exe” when executed will load “ushata.dll” from the running directory due to the DLL search order hijacking using Kernel32.LoadLibrary API.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png"><img data-attachment-id="3961" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-loadlibrary/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png" data-orig-size="586,82" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-loadlibrary" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png?w=580" loading="lazy" class="size-large wp-image-3961 aligncenter" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png?w=580&#038;h=81" alt="" width="580" height="81" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-loadlibrary.png 586w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>Then “ushata.dll” DLL entry point is executed. The DLL entry point contains code that verifies if the system date is equal or higher than 20130808. If yes it will get a handle to “ushata.DLL.818”, reads its contents into memory and changes the memory address segment permissions to RWX using Kernel32.VirtualProtect API. Finally, returns to the first instruction of the loaded file (shellcode). The file “ushata.DLL.818” contains obfuscated shellcode. The picture below shows the beginning of the obfuscated shellcode.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png"><img data-attachment-id="3962" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-obfuscatedshellcode/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png" data-orig-size="1192,732" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-obfuscatedshellcode" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3962" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=580&#038;h=356" alt="" width="580" height="356" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-obfuscatedshellcode.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>The shellcode unpacks itself using a custom algorithm. This shellcode contains position independent code. Figure below shows the unpacked shellcode.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png"><img data-attachment-id="3963" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-shellcode/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png" data-orig-size="1192,740" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-shellcode" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3963" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=580&#038;h=360" alt="" width="580" height="360" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-shellcode.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>The shellcode starts by locating the kernel32.dll address by accessing the <a href="https://web.archive.org/web/20170413084049/https://vxheaven.org/lib/vra06.html">Thread</a> Information Block (TIB) that contains a pointer to the <a href="http://blog.harmonysecurity.com/2009_06_01_archive.html">Process</a> <a href="http://garage4hackers.com/archive/index.php/t-1902.html">Environment</a> <a href="http://sandsprite.com/CodeStuff/Understanding_the_Peb_Loader_Data_List.html">Block</a> (PEB) structure. Figure below shows a snippet of the shellcode that contains the different sequence of assembly instructions for the code to find the Kernel32.dll.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png"><img data-attachment-id="3976" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-pebshellcode/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png" data-orig-size="1208,506" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-pebshellcode" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3976" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=580&#038;h=243" alt="" width="580" height="243" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-pebshellcode.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>It then reads kernel32.dll export table to locate the desired Windows API’s by comparing them with stacked strings. Then, the shellcode decompresses a DLL (offset 0x784) MD5 333e2767c8e575fbbb1c47147b9f9643, into memory using the LZNT1 algorithm by leveraging ntdll.dll.RtlDecompressBuffer API. The DLL contains the PE header replaced with the “XV” value. Restoring the PE header signature allows us to recover the malicious DLL.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png"><img data-attachment-id="3965" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-modifiedpeheader/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png" data-orig-size="510,797" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-modifiedpeheader" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png?w=192" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png?w=510" loading="lazy" class="aligncenter size-full wp-image-3965" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png?w=580" alt=""   srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png 510w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png?w=96&amp;h=150 96w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-modifiedpeheader.png?w=192&amp;h=300 192w" sizes="(max-width: 510px) 100vw, 510px" /></a></p>
<p>Next, the payload will start performing different actions to achieve persistence. On Windows 7 and beyond, PlugX creates a folder “%ProgramData%\RasTl” where “RasTl” matches the installation settings defined in the builder. Then, it changes the folder attributes to “SYSTEM|HIDDEN” using the SetFileAttributesW API. Next, copies its three components into the folder and sets all files with the “SYSTEM|HIDDEN” attribute.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png"><img data-attachment-id="3966" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-setfileattributes/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png" data-orig-size="1245,100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-setfileattributes" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3966" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=580&#038;h=47" alt="" width="580" height="47" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfileattributes.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>The payload also modifies the timestamps of the created directory and files with the timestamps obtained from ntdll.dll using the SetFileTime API.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png"><img data-attachment-id="3967" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-setfiletime/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png" data-orig-size="1374,208" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-setfiletime" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3967" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=580&#038;h=88" alt="" width="580" height="88" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-setfiletime.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>Then it creates the service “RasTl” where the ImagePath points to “%ProgramData%\RasTl\avp.exe”</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png"><img data-attachment-id="3968" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-createservice/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png" data-orig-size="1447,422" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-createservice" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3968" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=580&#038;h=169" alt="" width="580" height="169" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createservice.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>If the malware fails to start the just installed service, it will delete it and then it will create a persistence mechanism in the registry by setting the registry value &#8220;C:\ProgramData\RasTls\avp.exe&#8221; to the key &#8220;HKLM\SOFTWARE\Classes\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\RasTls&#8221; using the RegSetValueExW API.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png"><img data-attachment-id="4031" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-registry-2/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png" data-orig-size="825,364" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-registry" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png?w=580" loading="lazy" class="aligncenter size-large wp-image-4031" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png?w=580&#038;h=256" alt="" width="580" height="256" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-registry1.png 825w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>If the builder options had the Keylogger functionality enabled, then it may create a file with a random name such as “%ProgramData%\RasTl\rjowfhxnzmdknsixtx” that stores the key strokes. If the payload has been built with Screen capture functionality, it may create the folder “%ProgramData%\RasTl \RasTl\Screen” to store JPG images in the format &lt;datetime&gt;.jpg that are taken at the frequency specified during the build process. The payload may also create the file “%ProgramData%\DEBUG.LOG” that contains debugging information about its execution (also interesting that during execution the malware outputs debug messages about what is happening using the OutputDebugString API. This messages could be viewed with DebugView from SysInternals). The malicious code completes its mission by starting a new instance of “svchost.exe” and then injects the malicious code into svchost.exe process address space using <a href="https://countuponsecurity.com/2015/12/07/malware-analysis-dridex-process-hollowing/">process hollowing technique</a>. The pictures below shows the first step of the process hollowing technique where the payload creates a new “svchost.exe” instance in SUSPENDED state.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png"><img data-attachment-id="3969" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-createprocess/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png" data-orig-size="1207,365" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-createprocess" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3969" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=580&#038;h=175" alt="" width="580" height="175" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=1157 1157w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-createprocess.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>and then uses WriteProcessMemory API to inject the malicious payload</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png"><img data-attachment-id="3970" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-writeprocessmem/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png" data-orig-size="1780,299" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-writeprocessmem" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3970" src="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=580&#038;h=97" alt="" width="580" height="97" srcset="https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=1155 1155w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/01/plugx-writeprocessmem.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>Then the main thread, which is still in suspended state, is changed in order to point to the entry point of the new image base using the SetThreadContext API. Finally, the ResumeThread API is invoked and the malicious code starts executing. The malware also has the capabilities to <a href="http://blog.jpcert.or.jp/2015/02/a-new-uac-bypass-method-that-dridex-uses.html">bypass</a> User Account Control (UAC) if needed. From this moment onward, the control is passed over “svchost.exe” and Plug-X starts doing its thing. In this case we have the builder so we know the settings which were defined during building process. However, we would like to understand how could we extract the configuration settings. During Black Hat 2014, <a href="https://twitter.com/cci_forensics">Takahiro Haruyama</a> and <a href="https://twitter.com/herosi_t">Hiroshi Suzuki</a> gave a presentation titled “<a href="https://www.blackhat.com/docs/asia-14/materials/Haruyama/Asia-14-Haruyama-I-Know-You-Want-Me-Unplugging-PlugX.pdf">I know You Want Me – Unplugging PlugX</a>” where the authors go to great length analyzing a variety of PlugX samples, its evolution and categorizing them into threat groups. But better is that the Takahiro released a set of <a href="http://takahiroharuyama.github.io/blog/2014/03/27/id-slash-idapython-scripts-extracting-plugx-configs/">PlugX parsers</a> for the different types of PlugX samples i.e, Type I, Type II and Type III. How can we use this parser? The one we are dealing in this article is considered a PlugX type II. To dump the configuration, we need to use Immunity Debugger and use the Python API. We need to place the “plugx_dumper.py” file into the “PyCommands” folder inside Immunity Debugger installation path. Then attached the debugger to the infected process e.g, “svchost.exe” and run the plugin. The plugin will dump the configuration settings and will also extract the decompressed DLL</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png"><img data-attachment-id="3980" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-dumper/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png" data-orig-size="1042,1017" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-dumper" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=580" loading="lazy" class="aligncenter size-large wp-image-3980" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=580&#038;h=566" alt="" width="580" height="566" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png?w=1024 1024w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-dumper.png 1042w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>We can see that this parser is able to find the injected shellcode, decode its configuration and all the settings an attacker would set on the builder and also dump the injected DLL which contains the core functionality of the malware.</p>
<p>In terms of networking, as observed in the PlugX controller, the malware can be configured to speak with a controller using several network protocols. In this case we configured it to speak using HTTP on port 80. The network traffic contains a 16-byte header followed by a payload. The header is encoded with a custom routine and the payload is encoded and compressed with LZNT1. Far from a comprehensive analysis we launched a Shell prompt from the controller, typed command “ipconfig” and observed the network traffic. In parallel, we attached a debugger to &#8220;svchost.exe&#8221; and set breakpoints: on Ws2_32.dll!WSASend and Ws2_32.dll!WSARecv to capture the packets ; on ntdll.dll!RtlCompressBuffer and ntdll.dll!RtlDecompressBuffer to view the data before and after compression. ; On custom encoding routine to view the data before and after. The figure below shows a disassemble listing of the custom encoding routine.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png"><img data-attachment-id="4005" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-customencoding/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png" data-orig-size="357,502" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-customencoding" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png?w=213" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png?w=357" loading="lazy" class="aligncenter size-full wp-image-4005" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png?w=580" alt=""   srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png 357w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png?w=107&amp;h=150 107w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-customencoding.png?w=213&amp;h=300 213w" sizes="(max-width: 357px) 100vw, 357px" /></a></p>
<p>So, from a debugger view, with the right breakpoints we could start to observe what is happening. In the picture below, on the left-hand side it shows the packet before encoding and compression. It contains a 16-byte header, where the first 4-bytes are the key for the custom encoding routine. The next 4-bytes are the flags which contain the commands/plugins being used. Then the next 4-bytes is the size. After the header there is the payload which in this case contains is output of the ipconfig.exe command. On the right-hand side, we have the packet after encoding and compressing. It contains the 16-byte header encoded following by the payload encoded and compressed.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png"><img data-attachment-id="4001" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-c2shelltraffic/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png" data-orig-size="1561,603" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-c2shelltraffic" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=580" loading="lazy" class="aligncenter size-large wp-image-4001" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=580&#038;h=224" alt="" width="580" height="224" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2shelltraffic.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>Then, the malware uses WSASend API to send the traffic.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png"><img data-attachment-id="4002" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-c2wsasend/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png" data-orig-size="1350,162" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-C2wsasend" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=580" loading="lazy" class="aligncenter size-large wp-image-4002" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=580&#038;h=70" alt="" width="580" height="70" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=1160 1160w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-c2wsasend.png?w=1024 1024w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>Capturing the traffic, we can observe the same data.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png"><img data-attachment-id="4003" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-packet/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png" data-orig-size="1106,916" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-packet" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=580" loading="lazy" class="aligncenter size-large wp-image-4003" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=580&#038;h=480" alt="" width="580" height="480" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png?w=1024 1024w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-packet.png 1106w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>On the controller side, when the packet arrives, the header will be decoded and then the payload will be decoded and decompressed. Finally, the output is showed to the operator.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png"><img data-attachment-id="4004" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plgux-operatorshell/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png" data-orig-size="1014,752" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plgux-operatorshell" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png?w=300" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png?w=580" loading="lazy" class="aligncenter size-large wp-image-4004" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png?w=580&#038;h=430" alt="" width="580" height="430" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png?w=150 150w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png?w=300 300w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png?w=768 768w, https://countuponsecurity.com/wp-content/uploads/2018/02/plgux-operatorshell.png 1014w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>Now that we started to understand how C2 traffic is handled, we can capture it and decode it.  Kyle Creyts has created a <a href="https://github.com/kcreyts/plugxdecoder">PlugX decoder</a> that supports PCAP’s. The decoder supports decryption of PlugX Type I.But Fabien Perigaud <a href="https://airbus-cyber-security.com/plugx-v2-meet-scontroller/">reversed</a> the Type II algorithm and implemented it in python. If we combine Kyle’s work with the work from Takahiro Haruyama and Fabien Perigaud we could create a PCAP parser to extract PlugX Type II and Type III. Below illustrates a proof-of-concept for this exercise against 1 packet. We captured the traffic and then used a small python script to decrypt a packet. No dependencies on Windows because it uses the <a href="https://gist.github.com/herrcore/344ba2ea540f622b52efba858050539f">herrcore&#8217;s</a> standalone LZNT1 implementation that is based on the one from the <a href="https://github.com/MITRECND/chopshop">ChopShop</a> protocol analysis and decoder framework by MITRE.</p>
<p><a href="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png"><img data-attachment-id="4006" data-permalink="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/plugx-decoder/" data-orig-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png" data-orig-size="616,793" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="plugx-decoder" data-image-description="" data-image-caption="" data-medium-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png?w=233" data-large-file="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png?w=580" loading="lazy" class="aligncenter size-large wp-image-4006" src="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png?w=580&#038;h=747" alt="" width="580" height="747" srcset="https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png?w=580 580w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png?w=117 117w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png?w=233 233w, https://countuponsecurity.com/wp-content/uploads/2018/02/plugx-decoder.png 616w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p>That&#8217;s it for today! We build a lab with a PlugX controller, got a view on its capabilities. Then we looked at the malware installation and debugged it in order to find and interpret some of its mechanics such as DLL search order hijacking, obfuscated shellcode, persistence mechanism and process hollowing. Then, we used a readily available parser to dump its configuration from memory. Finally, we briefly looked the way the malware communicates with the C2 and created a small script to decode the traffic. Now, with such environment ready, in a controlled and isolated lab, we can further simulate different tools and techniques and observe how an attacker would operate compromised systems. Then we can learn, practice at our own pace and look behind the scenes to better understand attack methods and ideally find and implement countermeasures.</p>
<p>References:<br />
<a href="http://circl.lu/assets/files/tr-12/tr-12-circl-plugx-analysis-v1.pdf">Analysis of a PlugX malware variant used for targeted attacks by CRCL.lu</a><br />
<a href="https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf">Operation Cloud Hopper by PWC</a><br />
<a href="https://info.contextis.com/acton/attachment/24535/f-030c/1/-/-/-/-/PlugX%20-%20Payload%20Extraction.pdf">PlugX Payload Extraction by Kevin O&#8217;Reilly<br />
</a>Other than the authors and articles cited troughout the article, a fantastic compilation about PlugX articles and papers since 2011 is available <a href="http://tracker.h3x.eu/info/290">here</a>.</p>
<p>Credits: Thanks to <a href="https://twitter.com/mykill">Michael Bailey</a> who showed me new techniques on how to deal with shellcode which I will likely cover on a post soon.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-3953" class="share-twitter sd-button share-icon" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-3953" class="share-facebook sd-button share-icon" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-3953" class="share-linkedin sd-button share-icon" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-tumblr"><a rel="nofollow noopener noreferrer" data-shared="" class="share-tumblr sd-button share-icon" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?share=tumblr" target="_blank" title="Click to share on Tumblr" ><span>Tumblr</span></a></li><li class="share-email"><a rel="nofollow noopener noreferrer" data-shared="" class="share-email sd-button share-icon" href="mailto:?subject=%5BShared%20Post%5D%20Malware%20Analysis%20-%20PlugX&body=https%3A%2F%2Fcountuponsecurity.com%2F2018%2F02%2F04%2Fmalware-analysis-plugx%2F&share=email" target="_blank" title="Click to email a link to a friend" data-email-share-error-title="Do you have email set up?" data-email-share-error-text="If you&#039;re having problems sharing via email, you might not have email set up for your browser. You may need to create a new email yourself." data-email-share-nonce="3d3c4467cb" data-email-share-track-url="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?share=email"><span>Email</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-42387852-3953-6762741aa2f67' data-src='//widgets.wp.com/likes/index.html?ver=20241218#blog_id=42387852&amp;post_id=3953&amp;origin=countuponsecurity.wordpress.com&amp;obj_id=42387852-3953-6762741aa2f67&amp;domain=countuponsecurity.com' data-name='like-post-frame-42387852-3953-6762741aa2f67' data-title='Like or Reblog'><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class='loading'>Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>		</div>
		<span class="tag-links"><strong>Tagged</strong> <a href="https://countuponsecurity.com/tag/apt/" rel="tag">APT</a>, <a href="https://countuponsecurity.com/tag/dll-hijacking/" rel="tag">DLL Hijacking</a>, <a href="https://countuponsecurity.com/tag/plugx/" rel="tag">PlugX</a>, <a href="https://countuponsecurity.com/tag/plugx-analysis/" rel="tag">PlugX Analysis</a>, <a href="https://countuponsecurity.com/tag/process-hollowing/" rel="tag">Process Hollowing</a>, <a href="https://countuponsecurity.com/tag/sogu/" rel="tag">SOGU</a></span>	</div>
</div>


<div id="comments">

			<h2 id="comments-title">
			6 thoughts on &ldquo;<span>Malware Analysis &#8211;&nbsp;PlugX</span>&rdquo;		</h2>

		<ol class="commentlist">
					<li class="comment even thread-even depth-1" id="comment-17118">
				<div id="div-comment-17118" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://0.gravatar.com/avatar/6dc4231e1b1b89668c63b3f988b4f785f67cc0771e1d1a8f281901474fa01913?s=32&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/6dc4231e1b1b89668c63b3f988b4f785f67cc0771e1d1a8f281901474fa01913?s=32&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/6dc4231e1b1b89668c63b3f988b4f785f67cc0771e1d1a8f281901474fa01913?s=48&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/6dc4231e1b1b89668c63b3f988b4f785f67cc0771e1d1a8f281901474fa01913?s=64&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/6dc4231e1b1b89668c63b3f988b4f785f67cc0771e1d1a8f281901474fa01913?s=96&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/6dc4231e1b1b89668c63b3f988b4f785f67cc0771e1d1a8f281901474fa01913?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />			<cite class="fn">Nathan Martz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata">
			<a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comment-17118">February 5, 2018 at 4:01 pm</a>		</div>

		<p>Cool, Luis!</p>
<p id="comment-like-17118" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?like_comment=17118&#038;_wpnonce=1ff763ad67" class="comment-like-link needs-login" rel="nofollow" data-blog="42387852"><span>Like</span></a><span id="comment-like-count-17118" class="comment-like-feedback">Like</span></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?replytocom=17118#respond" data-commentid="17118" data-postid="3953" data-belowelement="div-comment-17118" data-respondelement="respond" data-replyto="Reply to Nathan Martz" aria-label="Reply to Nathan Martz">Reply</a></div>
				</div>
				</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-17120">
				<div id="div-comment-17120" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=32&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=32&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=48&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=64&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=96&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />			<cite class="fn">suner0v</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata">
			<a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comment-17120">February 5, 2018 at 8:00 pm</a>		</div>

		<p>Is the builder publically available? I’ve been looking for one for awhile</p>
<p id="comment-like-17120" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?like_comment=17120&#038;_wpnonce=1fe054b659" class="comment-like-link needs-login" rel="nofollow" data-blog="42387852"><span>Like</span></a><span id="comment-like-count-17120" class="comment-like-feedback">Like</span></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?replytocom=17120#respond" data-commentid="17120" data-postid="3953" data-belowelement="div-comment-17120" data-respondelement="respond" data-replyto="Reply to suner0v" aria-label="Reply to suner0v">Reply</a></div>
				</div>
				<ul class="children">
		<li class="comment byuser comment-author-countuponsecurity bypostauthor even depth-2 parent" id="comment-17128">
				<div id="div-comment-17128" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=32&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=32&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=48&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=64&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=96&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://countuponsecurity.wordpress.com" class="url" rel="ugc external nofollow">Luis Rocha</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata">
			<a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comment-17128">February 6, 2018 at 9:29 am</a>		</div>

		<p>Hi, the ones I found was by reading the articles from Fabien Perigaud and using the information he shared as leads.</p>
<p id="comment-like-17128" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?like_comment=17128&#038;_wpnonce=e6f91c54e8" class="comment-like-link needs-login" rel="nofollow" data-blog="42387852"><span>Like</span></a><span id="comment-like-count-17128" class="comment-like-feedback">Like</span></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?replytocom=17128#respond" data-commentid="17128" data-postid="3953" data-belowelement="div-comment-17128" data-respondelement="respond" data-replyto="Reply to Luis Rocha" aria-label="Reply to Luis Rocha">Reply</a></div>
				</div>
				<ul class="children">
		<li class="comment odd alt depth-3" id="comment-17134">
				<div id="div-comment-17134" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=32&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=32&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=48&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=64&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=96&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/4e7de3452565dd3344ea60724e1bc1b7c44adda38ee51628da6cf508e7d665bc?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />			<cite class="fn">suner0v</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata">
			<a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comment-17134">February 6, 2018 at 5:54 pm</a>		</div>

		<p>Thanks Luis, I’ll see what I can find!</p>
<p id="comment-like-17134" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?like_comment=17134&#038;_wpnonce=e7743bacc3" class="comment-like-link needs-login" rel="nofollow" data-blog="42387852"><span>Like</span></a><span id="comment-like-count-17134" class="comment-like-feedback">Like</span></p>

		
				</div>
				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-17129">
				<div id="div-comment-17129" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://1.gravatar.com/avatar/1ea62aab4d7b8e00e275da2c9d73acebbea4443533520a5ea6f9ae243fc6869c?s=32&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/1ea62aab4d7b8e00e275da2c9d73acebbea4443533520a5ea6f9ae243fc6869c?s=32&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/1ea62aab4d7b8e00e275da2c9d73acebbea4443533520a5ea6f9ae243fc6869c?s=48&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/1ea62aab4d7b8e00e275da2c9d73acebbea4443533520a5ea6f9ae243fc6869c?s=64&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/1ea62aab4d7b8e00e275da2c9d73acebbea4443533520a5ea6f9ae243fc6869c?s=96&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/1ea62aab4d7b8e00e275da2c9d73acebbea4443533520a5ea6f9ae243fc6869c?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://github.com/ctxis/CAPE" class="url" rel="ugc external nofollow">Kev O'Reilly</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata">
			<a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comment-17129">February 6, 2018 at 10:52 am</a>		</div>

		<p>Hi Luis, thanks for referencing my payload extraction paper. Just to let you know, this project evolved over the years into what is now known as CAPE: a sandbox designed for automated malware configuration and payload extraction: <a href="https://github.com/ctxis/CAPE" rel="nofollow ugc">https://github.com/ctxis/CAPE</a>.</p>
<p>PlugX was the very first malware family to have a dedicated package in CAPE which allows the payload and configuration to be extracted and parsed, using of course Fabien Perigaud&#8217;s excellent parser. An example using the same package as the one is this article can be found at:</p>
<p><a href="https://cape.contextis.com/analysis/691" rel="nofollow ugc">https://cape.contextis.com/analysis/691</a></p>
<p id="comment-like-17129" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?like_comment=17129&#038;_wpnonce=030971b56a" class="comment-like-link needs-login" rel="nofollow" data-blog="42387852"><span>Like</span></a><span id="comment-like-count-17129" class="comment-like-feedback">Like</span></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?replytocom=17129#respond" data-commentid="17129" data-postid="3953" data-belowelement="div-comment-17129" data-respondelement="respond" data-replyto="Reply to Kev O&#039;Reilly" aria-label="Reply to Kev O&#039;Reilly">Reply</a></div>
				</div>
				<ul class="children">
		<li class="comment byuser comment-author-countuponsecurity bypostauthor odd alt depth-2" id="comment-17130">
				<div id="div-comment-17130" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=32&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=32&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=48&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=64&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=96&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://countuponsecurity.wordpress.com" class="url" rel="ugc external nofollow">Luis Rocha</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata">
			<a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comment-17130">February 6, 2018 at 11:02 am</a>		</div>

		<p>Really nice Kevin, thanks for sharing. Didn&#8217;t knew about CAPE.</p>
<p id="comment-like-17130" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?like_comment=17130&#038;_wpnonce=8403cc729a" class="comment-like-link needs-login" rel="nofollow" data-blog="42387852"><span>Like</span></a><span id="comment-like-count-17130" class="comment-like-feedback">Like</span></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/?replytocom=17130#respond" data-commentid="17130" data-postid="3953" data-belowelement="div-comment-17130" data-respondelement="respond" data-replyto="Reply to Luis Rocha" aria-label="Reply to Luis Rocha">Reply</a></div>
				</div>
				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol>

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/02/04/malware-analysis-plugx/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://countuponsecurity.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">


<div id="comment-form__verbum" class="transparent"></div><div class="verbum-form-meta"><input type='hidden' name='comment_post_ID' value='3953' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="ca4dccea44" />
			<input type="hidden" name="verbum_show_subscription_modal" value="" /></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0ce9f6e3e0" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="164"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->			</div><!-- #contents -->

	<div class="navigation">
		<div class="nav-previous"><a href="https://countuponsecurity.com/2017/11/22/digital-forensics-artifacts-of-interactive-sessions/" rel="prev"><span class="meta-nav">&larr;</span> Previous post</a></div>
		<div class="nav-next"><a href="https://countuponsecurity.com/2018/03/07/intro-to-american-fuzzy-lop-fuzzing-in-5-steps/" rel="next">Next post <span class="meta-nav">&rarr;</span></a></div>
	</div>


<div id="widgets">
		<div class="widget-area">
		<aside id="follow_button_widget-2" class="widget widget_follow_button_widget">
		<a class="wordpress-follow-button" href="https://countuponsecurity.com" data-blog="42387852" data-lang="en" data-show-follower-count="true">Follow Count Upon Security on WordPress.com</a>
		<script type="text/javascript">(function(d){ window.wpcomPlatform = {"titles":{"timelines":"Embeddable Timelines","followButton":"Follow Button","wpEmbeds":"WordPress Embeds"}}; var f = d.getElementsByTagName('SCRIPT')[0], p = d.createElement('SCRIPT');p.type = 'text/javascript';p.async = true;p.src = '//widgets.wp.com/platform.js';f.parentNode.insertBefore(p,f);}(document));</script>

		</aside><aside id="twitter_timeline-2" class="widget widget_twitter_timeline"><h3 class="widget-title">Follow me on Twitter</h3><a class="twitter-timeline" data-theme="light" data-border-color="#e8e8e8" data-tweet-limit="1" data-lang="EN" data-partner="jetpack" href="https://twitter.com/@countuponsec" href="https://twitter.com/@countuponsec">My Tweets</a></aside><aside id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://countuponsecurity.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="https://countuponsecurity.com/2021/05/17/fireeye-endpoint-security-hx-supplementary-tools/">FireEye Endpoint Security (HX) – Supplementary&nbsp;Tools</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2019/10/14/notes-on-linux-memory-analysis-lime-volatility-and-lkms/">Notes on Linux Memory Analysis &#8211; LiME, Volatility and&nbsp;LKM’s</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2018/11/05/six-years-ago/">Six Years ago&nbsp;&#8230;</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2018/06/20/digital-forensics-plugx-and-artifacts-left-behind/">Digital Forensics – PlugX and Artifacts left&nbsp;behind</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2018/05/09/malware-analysis-plugx-part-2/">Malware Analysis – PlugX &#8211; Part&nbsp;2</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2018/04/24/intro-to-american-fuzzy-lop-fuzzing-with-asan-and-beyond/">Intro to American Fuzzy Lop – Fuzzing with ASAN and&nbsp;beyond</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2018/03/07/intro-to-american-fuzzy-lop-fuzzing-in-5-steps/">Intro to American Fuzzy Lop – Fuzzing in 5&nbsp;steps</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/" aria-current="page">Malware Analysis &#8211;&nbsp;PlugX</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2017/11/22/digital-forensics-artifacts-of-interactive-sessions/">Digital Forensics &#8211; Artifacts of interactive&nbsp;sessions</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2017/07/02/analysis-of-a-master-boot-record-eternalpetya/">Analysis of a Master Boot Record &#8211;&nbsp;EternalPetya</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/">Threat Hunting in the Enterprise with AppCompatProcessor</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2017/05/25/digital-forensics-ntfs-change-journal/">Digital Forensics &#8211; NTFS Change&nbsp;Journal</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2017/04/12/intro-to-linux-forensics/">Intro to Linux&nbsp;Forensics</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2017/02/26/offensive-tools-and-techniques/">Offensive Tools and&nbsp;Techniques</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2017/01/12/extract-and-use-indicators-of-compromise-from-security-reports/">Extract and use Indicators of Compromise from Security&nbsp;Reports</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/11/20/blockchain-brainwallet-cracking/">Blockchain &amp; Brainwallet&nbsp;cracking</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/10/17/rig-exploit-kit-analysis-part-3/">RIG Exploit Kit Analysis – Part&nbsp;3</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/10/05/rig-exploit-kit-analysis-part-2/">RIG Exploit Kit Analysis – Part&nbsp;2</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/09/30/rig-exploit-kit-analysis-part-1/">RIG Exploit Kit Analysis &#8211; Part&nbsp;1</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/08/28/malware-analysis-dridex-loader-part-2/">Malware Analysis – Dridex Loader – Part&nbsp;2</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/08/17/malware-analysis-dridex-loader-part-i/">Malware Analysis &#8211; Dridex Loader &#8211; Part&nbsp;I</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/06/29/the-abcs-of-a-cyber-intrusion/">The ABC&#8217;s of a Cyber&nbsp;Intrusion</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/05/30/digital-forensics-ntfs-indx-and-journaling/">Digital Forensics &#8211; NTFS INDX and&nbsp;Journaling</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/05/24/digital-forensics-dll-search-order/">Digital Forensics &#8211; DLL Search&nbsp;Order</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/05/18/digital-forensics-shimcache-artifacts/">Digital Forensics – ShimCache&nbsp;Artifacts</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/05/16/digital-forensics-prefetch-artifacts/">Digital Forensics &#8211; Prefetch&nbsp;Artifacts</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/04/11/evolution-of-stack-based-buffer-overflows/">Evolution of Stack Based Buffer&nbsp;Overflows</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/03/09/unleashing-yara-part-3/">Unleashing YARA &#8211; Part&nbsp;3</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/02/29/retefe-banking-trojan/">Retefe Banking Trojan</a>
									</li>
											<li>
					<a href="https://countuponsecurity.com/2016/02/18/unleashing-yara-part-2/">Unleashing YARA &#8211; Part&nbsp;2</a>
									</li>
					</ul>

		</aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href='https://countuponsecurity.com/2021/05/'>May 2021</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2019/10/'>October 2019</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2018/11/'>November 2018</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2018/06/'>June 2018</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2018/05/'>May 2018</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2018/04/'>April 2018</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2018/03/'>March 2018</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2018/02/'>February 2018</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2017/11/'>November 2017</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2017/07/'>July 2017</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2017/06/'>June 2017</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2017/05/'>May 2017</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2017/04/'>April 2017</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2017/02/'>February 2017</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2017/01/'>January 2017</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2016/11/'>November 2016</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2016/10/'>October 2016</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2016/09/'>September 2016</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2016/08/'>August 2016</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2016/06/'>June 2016</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2016/05/'>May 2016</a>&nbsp;(4)</li>
	<li><a href='https://countuponsecurity.com/2016/04/'>April 2016</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2016/03/'>March 2016</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2016/02/'>February 2016</a>&nbsp;(4)</li>
	<li><a href='https://countuponsecurity.com/2016/01/'>January 2016</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2015/12/'>December 2015</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2015/11/'>November 2015</a>&nbsp;(6)</li>
	<li><a href='https://countuponsecurity.com/2015/10/'>October 2015</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2015/08/'>August 2015</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2015/07/'>July 2015</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2015/06/'>June 2015</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2015/05/'>May 2015</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2015/04/'>April 2015</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2015/03/'>March 2015</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2015/02/'>February 2015</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2015/01/'>January 2015</a>&nbsp;(7)</li>
	<li><a href='https://countuponsecurity.com/2014/12/'>December 2014</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2014/11/'>November 2014</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2014/10/'>October 2014</a>&nbsp;(3)</li>
	<li><a href='https://countuponsecurity.com/2014/09/'>September 2014</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2014/08/'>August 2014</a>&nbsp;(5)</li>
	<li><a href='https://countuponsecurity.com/2014/07/'>July 2014</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2014/06/'>June 2014</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2014/05/'>May 2014</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2014/04/'>April 2014</a>&nbsp;(3)</li>
	<li><a href='https://countuponsecurity.com/2014/03/'>March 2014</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2014/02/'>February 2014</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2014/01/'>January 2014</a>&nbsp;(3)</li>
	<li><a href='https://countuponsecurity.com/2013/12/'>December 2013</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2013/11/'>November 2013</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2013/10/'>October 2013</a>&nbsp;(5)</li>
	<li><a href='https://countuponsecurity.com/2013/09/'>September 2013</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2013/08/'>August 2013</a>&nbsp;(1)</li>
	<li><a href='https://countuponsecurity.com/2013/06/'>June 2013</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2013/04/'>April 2013</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2013/01/'>January 2013</a>&nbsp;(2)</li>
	<li><a href='https://countuponsecurity.com/2012/12/'>December 2012</a>&nbsp;(5)</li>
	<li><a href='https://countuponsecurity.com/2012/11/'>November 2012</a>&nbsp;(12)</li>
			</ul>

			</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>
			<ul>
					<li class="cat-item cat-item-45210"><a href="https://countuponsecurity.com/category/anniversary/">Anniversary</a>
</li>
	<li class="cat-item cat-item-64575263"><a href="https://countuponsecurity.com/category/blockchain/">Blockchain</a>
</li>
	<li class="cat-item cat-item-244977"><a href="https://countuponsecurity.com/category/common-criteria/">Common Criteria</a>
</li>
	<li class="cat-item cat-item-147678700"><a href="https://countuponsecurity.com/category/digital-forensics-and-incident-response/">Digital Forensics and Incident Response</a>
</li>
	<li class="cat-item cat-item-301311"><a href="https://countuponsecurity.com/category/exploitation/">Exploitation</a>
</li>
	<li class="cat-item cat-item-1643774"><a href="https://countuponsecurity.com/category/fuzzing/">Fuzzing</a>
</li>
	<li class="cat-item cat-item-38980355"><a href="https://countuponsecurity.com/category/gamification/">Gamification</a>
</li>
	<li class="cat-item cat-item-125822783"><a href="https://countuponsecurity.com/category/incident-handling-and-hacker-techniques/">Incident Handling and Hacker Techniques</a>
</li>
	<li class="cat-item cat-item-101156704"><a href="https://countuponsecurity.com/category/intrusion-analysis/">Intrusion Analysis</a>
</li>
	<li class="cat-item cat-item-1280723"><a href="https://countuponsecurity.com/category/malware-analysis/">Malware Analysis</a>
</li>
	<li class="cat-item cat-item-177400"><a href="https://countuponsecurity.com/category/penetration-testing/">Penetration Testing</a>
</li>
	<li class="cat-item cat-item-141930"><a href="https://countuponsecurity.com/category/red-team/">Red Team</a>
</li>
	<li class="cat-item cat-item-21808394"><a href="https://countuponsecurity.com/category/security-essentials/">Security Essentials</a>
</li>
	<li class="cat-item cat-item-138231575"><a href="https://countuponsecurity.com/category/security-infrastructure-2/">Security Infrastructure</a>
</li>
	<li class="cat-item cat-item-2556114"><a href="https://countuponsecurity.com/category/security-monitoring/">Security Monitoring</a>
</li>
	<li class="cat-item cat-item-21182911"><a href="https://countuponsecurity.com/category/threat-intelligence/">Threat Intelligence</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://countuponsecurity.com/category/uncategorized/">Uncategorized</a>
</li>
			</ul>

			</aside><aside id="wp_tag_cloud-2" class="widget wp_widget_tag_cloud"><h3 class="widget-title">Tags</h3><a href="https://countuponsecurity.com/tag/botnet/" class="tag-cloud-link tag-link-68579 tag-link-position-1" style="font-size: 8pt;" aria-label="botnet (3 items)">botnet</a>
<a href="https://countuponsecurity.com/tag/cryptowall/" class="tag-cloud-link tag-link-233918507 tag-link-position-2" style="font-size: 8pt;" aria-label="CryptoWall (3 items)">CryptoWall</a>
<a href="https://countuponsecurity.com/tag/cve/" class="tag-cloud-link tag-link-5010150 tag-link-position-3" style="font-size: 10.545454545455pt;" aria-label="CVE (4 items)">CVE</a>
<a href="https://countuponsecurity.com/tag/cve-2013-2551/" class="tag-cloud-link tag-link-168645430 tag-link-position-4" style="font-size: 10.545454545455pt;" aria-label="CVE-2013-2551 (4 items)">CVE-2013-2551</a>
<a href="https://countuponsecurity.com/tag/digital-forensics/" class="tag-cloud-link tag-link-685392 tag-link-position-5" style="font-size: 14.363636363636pt;" aria-label="Digital Forensics (6 items)">Digital Forensics</a>
<a href="https://countuponsecurity.com/tag/gaining-access/" class="tag-cloud-link tag-link-6942549 tag-link-position-6" style="font-size: 8pt;" aria-label="Gaining Access (3 items)">Gaining Access</a>
<a href="https://countuponsecurity.com/tag/honeypot/" class="tag-cloud-link tag-link-318562 tag-link-position-7" style="font-size: 8pt;" aria-label="honeypot (3 items)">honeypot</a>
<a href="https://countuponsecurity.com/tag/incident-handling-and-hacker-techniques/" class="tag-cloud-link tag-link-125822783 tag-link-position-8" style="font-size: 14.363636363636pt;" aria-label="Incident Handling and Hacker Techniques (6 items)">Incident Handling and Hacker Techniques</a>
<a href="https://countuponsecurity.com/tag/incident-response/" class="tag-cloud-link tag-link-2360537 tag-link-position-9" style="font-size: 16.909090909091pt;" aria-label="Incident Response (8 items)">Incident Response</a>
<a href="https://countuponsecurity.com/tag/intrusion-analysis-2/" class="tag-cloud-link tag-link-197756614 tag-link-position-10" style="font-size: 15.636363636364pt;" aria-label="intrusion analysis (7 items)">intrusion analysis</a>
<a href="https://countuponsecurity.com/tag/log2timeline/" class="tag-cloud-link tag-link-39299971 tag-link-position-11" style="font-size: 10.545454545455pt;" aria-label="log2timeline (4 items)">log2timeline</a>
<a href="https://countuponsecurity.com/tag/malware/" class="tag-cloud-link tag-link-15593 tag-link-position-12" style="font-size: 8pt;" aria-label="malware (3 items)">malware</a>
<a href="https://countuponsecurity.com/tag/malware-analysis/" class="tag-cloud-link tag-link-1280723 tag-link-position-13" style="font-size: 22pt;" aria-label="Malware Analysis (13 items)">Malware Analysis</a>
<a href="https://countuponsecurity.com/tag/network-security/" class="tag-cloud-link tag-link-45655 tag-link-position-14" style="font-size: 12.581818181818pt;" aria-label="network security (5 items)">network security</a>
<a href="https://countuponsecurity.com/tag/openioc/" class="tag-cloud-link tag-link-68545951 tag-link-position-15" style="font-size: 8pt;" aria-label="OpenIOC (3 items)">OpenIOC</a>
<a href="https://countuponsecurity.com/tag/penetration-testing-2/" class="tag-cloud-link tag-link-38078899 tag-link-position-16" style="font-size: 14.363636363636pt;" aria-label="penetration testing (6 items)">penetration testing</a>
<a href="https://countuponsecurity.com/tag/plugx/" class="tag-cloud-link tag-link-112172791 tag-link-position-17" style="font-size: 10.545454545455pt;" aria-label="PlugX (4 items)">PlugX</a>
<a href="https://countuponsecurity.com/tag/remnux/" class="tag-cloud-link tag-link-39541356 tag-link-position-18" style="font-size: 19.2pt;" aria-label="REMnux (10 items)">REMnux</a>
<a href="https://countuponsecurity.com/tag/sans/" class="tag-cloud-link tag-link-13501 tag-link-position-19" style="font-size: 8pt;" aria-label="SANS (3 items)">SANS</a>
<a href="https://countuponsecurity.com/tag/security-hands-on-training/" class="tag-cloud-link tag-link-318480957 tag-link-position-20" style="font-size: 14.363636363636pt;" aria-label="security hands-on-training (6 items)">security hands-on-training</a>
<a href="https://countuponsecurity.com/tag/security-intelligence/" class="tag-cloud-link tag-link-11654108 tag-link-position-21" style="font-size: 15.636363636364pt;" aria-label="Security Intelligence (7 items)">Security Intelligence</a>
<a href="https://countuponsecurity.com/tag/shimcache/" class="tag-cloud-link tag-link-224441086 tag-link-position-22" style="font-size: 10.545454545455pt;" aria-label="ShimCache (4 items)">ShimCache</a>
<a href="https://countuponsecurity.com/tag/sogu/" class="tag-cloud-link tag-link-83783386 tag-link-position-23" style="font-size: 10.545454545455pt;" aria-label="SOGU (4 items)">SOGU</a>
<a href="https://countuponsecurity.com/tag/sql-injection/" class="tag-cloud-link tag-link-129960 tag-link-position-24" style="font-size: 8pt;" aria-label="SQL Injection (3 items)">SQL Injection</a>
<a href="https://countuponsecurity.com/tag/threat-intelligence/" class="tag-cloud-link tag-link-21182911 tag-link-position-25" style="font-size: 19.2pt;" aria-label="Threat Intelligence (10 items)">Threat Intelligence</a></aside><aside id="authors-3" class="widget widget_authors"><h3 class="widget-title">Authors</h3><ul><li><a href="https://countuponsecurity.com/author/countuponsecurity/"> <img alt='' src='https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=16&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=16&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=24&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=32&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=48&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/56d458165fa593154c119119859c50b9228cdeebac8bb7832481152cf123ae39?s=64&#038;d=identicon&#038;r=G 4x' class='avatar avatar-16' height='16' width='16' loading='lazy' decoding='async' /> <strong>Luis Rocha</strong></a></li><li><a href="https://countuponsecurity.com/author/hxnoyd/"> <img alt='' src='https://1.gravatar.com/avatar/aec1796dd4f8e6aa5d03dee4a4b65652c4c4df8081557a640a0a155a503849c4?s=16&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/aec1796dd4f8e6aa5d03dee4a4b65652c4c4df8081557a640a0a155a503849c4?s=16&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/aec1796dd4f8e6aa5d03dee4a4b65652c4c4df8081557a640a0a155a503849c4?s=24&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/aec1796dd4f8e6aa5d03dee4a4b65652c4c4df8081557a640a0a155a503849c4?s=32&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/aec1796dd4f8e6aa5d03dee4a4b65652c4c4df8081557a640a0a155a503849c4?s=48&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/aec1796dd4f8e6aa5d03dee4a4b65652c4c4df8081557a640a0a155a503849c4?s=64&#038;d=identicon&#038;r=G 4x' class='avatar avatar-16' height='16' width='16' loading='lazy' decoding='async' /> <strong>Ricardo Dias</strong></a></li><li><a href="https://countuponsecurity.com/author/parrizas/"> <img alt='' src='https://1.gravatar.com/avatar/49445a065c9ac71431c2a15971cdd499e3a94ef464cc4f54cb85b3815494d080?s=16&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/49445a065c9ac71431c2a15971cdd499e3a94ef464cc4f54cb85b3815494d080?s=16&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/49445a065c9ac71431c2a15971cdd499e3a94ef464cc4f54cb85b3815494d080?s=24&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/49445a065c9ac71431c2a15971cdd499e3a94ef464cc4f54cb85b3815494d080?s=32&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/49445a065c9ac71431c2a15971cdd499e3a94ef464cc4f54cb85b3815494d080?s=48&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/49445a065c9ac71431c2a15971cdd499e3a94ef464cc4f54cb85b3815494d080?s=64&#038;d=identicon&#038;r=G 4x' class='avatar avatar-16' height='16' width='16' loading='lazy' decoding='async' /> <strong>Angel Alonso-Parrizas</strong></a></li></ul></aside>	</div><!-- #first .widget-area -->
	</div><!-- #widgets -->
	<div id="footer">
		<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
		
			</div>

</div>

<!--  -->
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=202451b213a1cbb4e3271ca470eb7790af362ac2e18ce468f8945952c7bd3456d2132e" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile →': 'Edit your profile →',
							'View profile →': 'View profile →',
							'Contact': 'Contact',
							'Send money': 'Send money',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Profile not found.': 'Profile not found.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-79f2d4c36ae2b9e2ff720b6b267f63e2">
	</div>
	<div class="grofile-hash-map-7a5dfe24ea822d01bae3c948ea41f436">
	</div>
	<div class="grofile-hash-map-2c328f5163376e4efae4ce1b97d0c603">
	</div>
	<div class="grofile-hash-map-f1498a0097b7dbec024ae4384724cf8d">
	</div>
	</div>
	<div id="actionbar" style="display: none;"
			class="actnbr-pub-chunk actnbr-has-follow">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/#comments">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"/></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"/></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://countuponsecurity.com">
				<img loading='lazy' alt='' src='https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=50&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' srcset='https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=50&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=75&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1.5x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=100&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 2x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=150&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 3x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=200&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 4x' class='avatar avatar-50' height='50' width='50' />				Count Upon Security			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 175 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="42387852" />
										<input type="hidden" name="source" value="https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="28340b825e" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fcountuponsecurity.com%252F2018%252F02%252F04%252Fmalware-analysis-plugx%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename">
			<a href="https://countuponsecurity.com">
				<img loading='lazy' alt='' src='https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=50&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' srcset='https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=50&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=75&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1.5x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=100&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 2x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=150&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 3x, https://secure.gravatar.com/blavatar/2add3e574750b5f019353f9d868c30c783ca71fb68106b24c5aef4c92c02bde1?s=200&#038;d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 4x' class='avatar avatar-50' height='50' width='50' />				Count Upon Security			</a>
		</li>
								<li class="actnbr-folded-customize">
								<a href="https://countuponsecurity.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fcountuponsecurity.wordpress.com%2F2018%2F02%2F04%2Fmalware-analysis-plugx%2F">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"/></g></svg>									<span>Customize</span>
								</a>
							</li>
																<li class="actnbr-folded-follow">
												<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
										</li>
																	<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fcountuponsecurity.com%252F2018%252F02%252F04%252Fmalware-analysis-plugx%252F">Log in</a></li>
																	<li class="actnbr-shortlink"><a href="https://wp.me/p2RR12-11L">Copy shortlink</a></li>
																	<li class="flb-report">
										<a href="https://wordpress.com/abuse/?report_url=https://countuponsecurity.com/2018/02/04/malware-analysis-plugx/" target="_blank" rel="noopener noreferrer">
											Report this content										</a>
									</li>
																	<li class="actnbr-reader">
										<a href="https://wordpress.com/read/blogs/42387852/posts/3953">
											View post in Reader										</a>
									</li>
																	<li class="actnbr-subs">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
																		<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
															</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20241015";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/countuponsecurity.com\/2018\/02\/04\/malware-analysis-plugx\/":3953};
	</script>
				<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-2' href='https://s0.wp.com/_static/??-eJyljEsKgDAMBS9kDUUquhDPom0Qaz/BNHh9KdgTuBl4w2PgIWVzKpgKRFEU5DgTg8dCm72+DTHnCicBGex2Z2EMwM9JeKtdkgvYW+YOftTaqYkaXOOix8noQU+z8S9MR0BZ&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="comment-like-js-extra">
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading...","swipeUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/comment-likes\/js\/lib\/swipe.js?ver=20131008"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/countuponsecurity.com\/wp-admin\/admin-ajax.php","nonce":"b0bf3bec23","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/countuponsecurity.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fcountuponsecurity.com%2F2018%2F02%2F04%2Fmalware-analysis-plugx%2F","blog_id":"42387852","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=42387852&v=wpcom&tz=0&user_id=0&subd=countuponsecurity","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="verbum-settings-js-before">
/* <![CDATA[ */
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from Count Upon Security","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","siteId":42387852,"postId":3953,"mustLogIn":false,"requireNameEmail":true,"commentRegistration":false,"connectURL":"https:\/\/countuponsecurity.wordpress.com\/public.api\/connect\/?action=request&domain=countuponsecurity.com","logoutURL":"https:\/\/countuponsecurity.wordpress.com\/wp-login.php?action=logout&_wpnonce=3fc39b95e5","homeURL":"https:\/\/countuponsecurity.com\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":"https:\/\/0.gravatar.com\/avatar\/?s=96&amp;d=identicon&amp;r=G","enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"c7fc681eca","verbumBundleUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1721244820,"iframeUniqueId":0}
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??-eJydUVtSwzAMvBCOgcDQH4ajMIqtpEokO/WDTG6PaRIo0ClMv2yv1qtdSU+jMt4ldEn3UYtviFHliAG6gilyra/6eKNPeJLVyLkjFzXTgFEfMmbcg7OMYSOTM5xtKRZVSzHpN3TWh4/S6HluibkSche0e0wjmEEVaBqNl7VQPHq3qUFOXiAlMr/oOgajm0xsCzk0WUoPkdIjaogRy2FnB0JGsQf7ZfyMk/WjWtL2P4BziTdCwJHnf+Y8jfdaxHSaKCUMKpEgk8NrNJYBGAi+7JQ/eRvwhzUYKAomVVe3i9wGtOFItpeGtrZYt/H9eX2UuIeAFqydj1dy3ZrhRZ7vnup691g/3O/6dx8bEg0='></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-tumblr' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-tumblr' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtumblr', 'menubar=1,resizable=1,width=450,height=450' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src='https://widgets.wp.com/likes/master.html?ver=20241218#ver=20241218&amp;origin=https://countuponsecurity.com' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="//stats.wp.com/w.js?67" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'42387852','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'42387852','v':'wpcom','tz':'0','user_id':'0','post':'3953','subd':'countuponsecurity'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1mNzc2NTVTamdsd0xoLz9RQkM2K298TXY9bERQMXc2MjhEaVZfb2wwakRoSj0mUkp1THptM1NdbkV1WjZIcU9mVWQmPUIvMlN6Jk8wW3NYVEJ3dWZOWExuWD8lYzAxU0gsPU5OR0xfNjJUekssV35rfEI/UEZfb1ZMXWcycU1MSVBCTXl5QnUudkg2YiY1YXV0MEcyMnpOQWwwNk56V1VIczRnWSVVaHRiLVJ+eVZ+SkF0NmJVPS9KUzdYVXg1MWtYXUhwd11UamFHK2J6NSY2TDA5ekJueWI9YVIxTGM3dDI1TkFXOTU1N0xPUE0mODFOdDRWQVh8SWltTUdILFRjRzg/LmM9cjBvVy9naV0tTl1WbWgzLmhQT3xfa0ZqMWU9OV1IL3NzcWVSaFNQdnBNMEMwK3x0dUVSP2x5TFJZRDdzY2FqOTh3LCx+YUw='}]);
_stq.push([ 'clickTrackerInit', '42387852', '3953' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script defer id="bilmur"  data-provider="wordpress.com" data-service="simple"   src="/wp-content/js/bilmur-4.min.js?i=12&m=202451"></script><script>
( function() {
	function getMobileUserAgentInfo() {
		if ( typeof wpcom_mobile_user_agent_info === 'object' ) {
			wpcom_mobile_user_agent_info.init();
			var mobileStatsQueryString = '';

			if ( wpcom_mobile_user_agent_info.matchedPlatformName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
			}

			if ( wpcom_mobile_user_agent_info.matchedUserAgentName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
			}

			if ( wpcom_mobile_user_agent_info.isIPad() ) {
				mobileStatsQueryString += '&x_' + 'ipad_views' + '=' + 'views';
			}

			if ( mobileStatsQueryString != '' ) {
				new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
			}
		}
	}

	document.addEventListener( 'DOMContentLoaded', getMobileUserAgentInfo );
} )();
</script>
<script type='disabled' id='wp-enqueue-dynamic-script:wp-i18n:after:1'>
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>

<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'wp-hooks': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v19.8.0/build/hooks/index.min.js?m=1733324323i&ver=84e753e2b66eb7028d38',
		'wp-i18n': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v19.8.0/build/i18n/index.min.js?m=1733324323i&ver=bd5a2533e717a1043151',
		'verbum': 'https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1733934734i&minify=false&ver=0b4f9908fccda8a8b143'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('wp-hooks');
			fetchExternalScript('wp-i18n');
			fetchExternalScript('verbum');
			promises['wp-hooks'] = promises['wp-hooks'] || loadWPScript('wp-hooks');
			promises['wp-i18n'] = promises['wp-i18n'] || promises['wp-hooks'].then( () => loadWPScript('wp-i18n') );
			promises['verbum'] = promises['verbum'] || promises['wp-i18n'].then( () => loadWPScript('verbum') );
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		'wp-i18n': { translations: 0, before: 0, after: 1 },
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		// Core loads scripts in this order. See: https://github.com/WordPress/WordPress/blob/a59eb9d39c4fcba834b70c9e8dfd64feeec10ba6/wp-includes/class-wp-scripts.php#L428.
		return loadExtra(handle, 'translations')
			.then(() => loadExtra(handle, 'before'))
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>

</body>
</html>