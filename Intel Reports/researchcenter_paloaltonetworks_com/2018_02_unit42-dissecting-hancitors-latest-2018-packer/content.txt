<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var maindomain_lang = 'https://www.paloaltonetworks.com';
var main_site_url = 'https://www.paloaltonetworks.com';
var ajax_url = 'https://unit42.paloaltonetworks.com/wp-admin/admin-ajax.php';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
</script>


<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v24.2 (Yoast SEO v24.2) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Dissecting Hancitor’s Latest 2018 Packer</title>
	<meta name="description" content="Unit 42 dives into the technical inner-workings of Hancitor’s latest malware packer." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Dissecting Hancitor’s Latest 2018 Packer" />
	<meta property="og:description" content="Unit 42 dives into the technical inner-workings of Hancitor’s latest malware packer." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2018-02-27T13:00:27+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
	<meta property="og:image:width" content="650" />
	<meta property="og:image:height" content="300" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Jeff White" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Dissecting Hancitor’s Latest 2018 Packer Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:unit42-dissecting-hancitors-latest-2018-packer";
webData.pageURL = "https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer";
webData.article_title = "Dissecting Hancitor’s Latest 2018 Packer";
webData.author = "Jeff White";
webData.published_time = "2018-02-27T05:00:27-08:00";
webData.description = "Unit 42 dives into the technical inner-workings of Hancitor’s latest malware packer.";
webData.keywords = "Cybercrime,Malware,Threat Research,hancitor";
webData.resourceAssetID = "5e349f1063224345771692700fb0b950";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="11"/>
<meta property="og:readtime" content="16"/>
<meta property="og:views" content="44,153"/>
<meta property="og:date_created" content="February 27, 2018 at 5:00 AM"/>
<meta property="og:post_length" content="4599"/>
<meta property="og:category" content="Cybercrime"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cybercrime/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Jeff White"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jeff-white/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="hancitor"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Dissecting Hancitor\u2019s Latest 2018 Packer","name":"Dissecting Hancitor\u2019s Latest 2018 Packer","description":"Unit 42 dives into the technical inner-workings of Hancitor\u2019s latest malware packer. ","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-dissecting-hancitors-latest-2018-packer\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-dissecting-hancitors-latest-2018-packer\/","datePublished":"February 27, 2018","articleBody":"Summary\nOver the past two years, the Hancitor malware family has been a fairly regular nuisance that defenders on the front line of organizations have to deal with on an almost weekly basis. The malware itself has gone through more than 80 variations during this time, sometimes just to define new variables for campaigns and other times a complete rewrite of the malware\u2019s core functionality by the code authors. Every now and then though, they venture out into the unknown with techniques unlike what Hancitor has used before. These occasions tend to be short-lived and I look at them more as \u201ctesting\u201d phases. I suspect the malware authors monitor their infection rates and when they deviate from the tried and true, campaigns end up being less successful. For those interested in an overview of how a typical Hancitor malspam campaign operates, Unit 42 recently published a blog on the subject. \u00a0In this post, I\u2019ll be diving into the technical inner-workings of their latest malware packer.\nFor this particular instance,\u00a0 campaigns on January 24, 2018 and January 25, 2018 used a different document format, Rich Text Format (RTF), that leveraged an exploit (CVE-2017-11882) to launch shellcode which executed a PowerShell command used to download the standard binary which has been used for months. Usually, Hancitor is distributed through Microsoft Word documents utilizing macros but RTF documents typically require some kind of exploit to execute code. In the past, Hancitor has kept itself at arm\u2019s length from exploitation and instead relied entirely on social-engineering. This most likely helps evade against anti-virus (AV) and endpoint detection and response (EDR) systems monitoring for that type of activity.\nThe first RTF variant on the 24th is fairly straightforward; however, on the 25th, the RTF now included an embedded PE file that was entirely different than their standard binary. This PE file exhibited a new unpacking technique that the Hancitor developers have never employed before and this will be the meat of the blog post. My end goal is to identify the standard Hancitor command and control (C2) gate URL\u2019s, which stayed the same even with the new dropper in use.\nFor this analysis, I\u2019ll be using the following sample:\n\n\n\nSHA256\nB489CA02DCEA8DC7D5420908AD5D58F99A6FEF160721DCECFD512095F2163F7A\n\n\n\n&nbsp;\nRTF Dropper\nI won\u2019t be getting into the details of the exploit but suffice to say, they used the CVE-2017-11882 exploit in their RTF document to launch shellcode and execute a PowerShell command. The PowerShell command in this campaign will save a base64 encoded PE to disk and then call the Start-Process cmdlet on it.\n$EUX4JTF7 = '';foreach($82OJU7FY3US in (1..12 | foreach{ '{0:X}' -f (Get  Random -Max 235) })){$EUX4JTF7 += \"$82OJU7FY3US\"};$NR3MNTAYNI =  \"$env:USERPROFILE\\\" + $EUX4JTF7 +  \".exe\";[IO.File]::WriteAllBytes($NR3MNTAYNI,  [System.Convert]::FromBase64String('TVqQAAMAAAAEAAAA\/\/8AALgAAAAAAAAAQAAAAAAA  AAAAAAAAAA\u2026&lt;TRUNCATED&gt;\u2026AAAAAAAAAAAAA'));Start-Process $NR3MNTAYNI\n&nbsp;\nHancitor PE\nOnce the PE is launched, it will create a simple mutex called \u201ce\u201d and then begin to employ some anti-disassembly techniques that seek to hinder static analysis. In general, most popular disassemblers default to flow-oriented disassembly as opposed to linear disassembly. This means that when the disassembler analyzes instructions, if the instruction would shift the execution of the program to another location, then the disassembler may follow the instructions to that location to continue analysis. All bytes which would come after the branching may go unanalyzed and won\u2019t be disassembled. Abusing this functionality to confuse the disassembler is a very common technique.\nEffectively, this sample builds an address location into a register and then uses that register as the operand for a CALL instruction to shift execution to a section of code that the disassembler hasn\u2019t analyzed. Since the disassembler doesn\u2019t know what value will be in that register upon analysis, assuming the code isn\u2019t analyzed due to other reasons, then it just leaves it as \u2018data\u2019. In a debugger, this problem is fairly trivial to deal with as you can just instruct the debugger to re-analyze the code from any point you choose.\nAfter its initial jump into unanalyzed code, the malware begins to employ more anti-disassembly and anti-debugging techniques. Specifically, it starts executing code where there will be one or two instructions immediately followed by a jump. Normally, you would be able to read instructions linearly and get an understanding of the overall functionality, but with jumps interspersed between each instruction, the flow is obscured and harder to analyze as you only ever see one or two pieces of the overall function on your screen. This requires you keep track of what\u2019s going on, step-by-step.\nIn this case, the first thing the code does is to load the address for VirtualProtect() into the EAX register and build the parameters on the stack for a call to it. Again, using a call to the register further helps prevent static analysis. Once the call is made, it adjusts the privileges for all memory space loaded by this PE to have read, write, and execute (RWE) bits set, shown below. This is also new to the Hancitor malware, but is specifically used within the packer which we will discuss shortly.\nAddress\tSize\tOwner\tSection\tContains\tType\tAccess\tInitial\tMapped as\n00400000\t00001000\tb489ca02\t\tPE header\tImag\tRWE CopyOnWr\tRWE\n00401000\t00008000\tb489ca02\t.text\tcode\tImag\tRWE CopyOnWr\tRWE\n00409000\t00002000\tb489ca02\t.rdata\timports\tImag\tRWE CopyOnWr\tRWE\n0040B000\t00001000\tb489ca02\t.data\tdata\tImag\tRWE CopyOnWr\tRWE\n0040C000\t00001000\tb489ca02\t.rsrc\tresources\tImag\tRWE CopyOnWr\tRWE\n\nSetting all of the permissions to RWE allows for execution in the program to be transferred to any of the mapped memory regions, whereas typically it\u2019s limited to the \u201ccode\u201d section. There is also no reason they couldn\u2019t have contained all of this within the \u201ccode\u201d section, so it\u2019s a good indicator for detection when everything is converted to RWE. This is commonly done when there will be code hidden outside of the originally defined area; however, in this sample, they never actually execute code outside of this memory region so it\u2019s a shotgun approach to adjusting privileges.\nThe next action it will take, still using the same instruction-jump obfuscation, begins to XOR 0xC80 bytes beginning at address 0x402185 with the value 0xD1. One interesting oddity to their method here is that they move the value 0x5AF06AD1 to the EAX register, but only use the lower byte, AL (0xD1), for the XOR and ignore the other three bytes. It wouldn\u2019t be the first time the Hancitor malware has intended to use a full value but introduced errors in their code that caused it to only partially work as intended. The decoding routine looks like the following.\n004040EA    3007            XOR BYTE PTR DS:[EDI],AL\n004040EC    E9 8B000000     JMP b489ca02.0040417C\n--\n0040417C    41              INC ECX\n0040417D    EB DD           JMP SHORT b489ca02.0040415C\n--\n0040415C    47              INC EDI\n0040415D    EB D8           JMP SHORT b489ca02.00404137\n--\n00404137    39F1            CMP ECX,ESI\n00404139    0F81 24FFFFFF   JNO b489ca02.00404063\n--\n00404063    0F82 81000000   JB b489ca02.004040EA\n\nOnce this loop finishes decoding new shellcode, it will transfer execution to address 0x402185 with a JMP instruction.\nTo illustrate looking at assembly that hasn\u2019t been analyzed yet, from a debugger perspective, you would see these bytes as data within the \u201ccode\u201d section.\n00402185       55              DB 55                                          ;  CHAR 'U'\n00402186       8B              DB 8B\n00402187       EC              DB EC\n00402188       81              DB 81\n00402189       EC              DB EC\n0040218A       04              DB 04\n0040218B       02              DB 02\n0040218C       00              DB 00\n0040218D       00              DB 00\n0040218E       53              DB 53                                         ;  CHAR 'S'\n0040218F       56              DB 56                                         ;  CHAR 'V'\n00402190       57              DB 57                                         ;  CHAR 'W'\n00402191       60              DB 60                                         ;  CHAR '`'\n00402192       FC              DB FC\n\nSimply telling the debugger to reanalyze the code found will make it human readable.\n00402185    .  55              PUSH EBP\n00402186    .  8BEC            MOV EBP,ESP\n00402188    .  81EC 04020000   SUB ESP,204\n0040218E    .  53              PUSH EBX\n0040218F    .  56              PUSH ESI\n00402190    .  57              PUSH EDI                                      ;  b489ca02.00402E05\n00402191    .  60              PUSHAD\n00402192    .  FC              CLD\n\n\nInitial Shellcode\nOnce inside this new shellcode it begins to look up the address locations for a number of functions using GetProcAddress(). These functions will be used throughout the unpacking routines. The function names are not obfuscated and, once decoded from the above, can be seen in plain text.\n\n&nbsp;\n&nbsp;\nSome of the functions and DLL names looked up are listed below:\n\n \tGetModuleHandleA\n \tLoadLibraryA\n \tVirtualAlloc\n \tVirtualFree\n \tOutputDebugStringA\n \tntdll.dll\n \t_stricmp\n \tmemset\n \tmemcpy\n\nThroughout the unpacking, VirtualAlloc(), memcpy(), and VirtualFree() are heavily used for moving data around and overwriting existing data.\nOnce it has all of the addresses, the sample will allocate a 0x1000 byte memory page and copy all of the decoded shellcode into it. Next, it will begin to egg hunt for two DWORD values, 0x88BAC570 and 0x48254000 respectively, in which it will find the address four bytes from the start of the second egg. Egg hunting allows the code to be position independent and is a technique found in almost all Hancitor variants. After identifying the address, it will be used in another \u201cJMP EAX\u201d instruction to transfer execution to a new function within the copied shellcode, at offset 0x3E4, in the newly allocated memory range.\n&nbsp;\nData Setup\nFrom a control flow perspective, the same code is being executed, albeit from a new location, which frees up the unpacking functions to overwrite the code in the main body of the Hancitor PE.\nThe first actions taken is to overwrite code in three locations by copying data toward the end of the \u201ccode\u201d section to earlier areas, shown below.\n\n\n\nSource memcpy()\nSize\nDest Addr Range\n\n\n0x407C9E\n0x514\n0x4058D4-0x405DE8\n\n\n0x4078B6\n0x3E8\n0x40400A-0x4043F2\n\n\n0x406C36\n0xC80\n0x402185-0x402E05\n\n\n\n&nbsp;\nDuring this operation, there is another good example that illustrates some of the anti-analysis tricks in use.\n001F0453    EB 10             JMP SHORT 001F0465\n001F0455    82EF 3D           SUB BH,3D\n001F0458    3C 5D             CMP AL,5D\n001F045A    53                PUSH EBX\n001F045B    C8 E8518D         ENTER 51E8,8D\n001F045F    FB                STI\n001F0460    D9D0              FNOP\n001F0462    231B              AND EBX,DWORD PTR DS:[EBX]\n001F0464    14 83             ADC AL,83\n001F0466    C003 89           ROL BYTE PTR DS:[EBX],89\n001F0469    8540 FF           TEST DWORD PTR DS:[EAX-1],EAX\n\nBeginning at the top of the code, you\u2019ll notice the \u201cJMP SHORT 001F0465\u201d instruction which is not actually in the address listing on the left side of this snippet. This is a common technique to obscure code flow because it was disassembled linearly at the instruction boundaries, but the JMP instruction is redirecting execution outside of the boundary. Once this jump is actually taken and lands in the middle of the shown instruction 0x1F0464, the code will be re-analyzed based on the instruction pointer location and change the meaning entirely.\n001F0465    83C0 03           ADD EAX,3\n001F0468    8985 40FFFFFF     MOV DWORD PTR SS:[EBP-C0],EAX\n\n\nUnpacking More Shellcode\nThis next phase is where the unpacking actually occurs and the main purpose of this blog. Before I get into it, I\u2019ll preface it with if you know how RC4 works, you may want to skip ahead as the first two sections will cover the RC4 key-scheduling algorithm (KSA) and the RC4 pseudo-random generation algorithm (PRGA), which are used as part of this unpacking algorithm.\nIn general, packers seek to modify data or code in such a way that it\u2019s unlike the original content, effectively obfuscating it. Packers are not inherently bad but it adds another layer of evasion to malware, so they tend to go hand-in-hand. Each packer typically attempts to put their own spin on how to do this by coming up with unique algorithms; this makes it difficult to programmatically unpack malware at scale but also allows for varying levels of protection. Code packing algorithms can be as simple as a one-byte XOR across the data to full-on encryption or compression.\nIn the case of this malware, they\u2019ve created an algorithm which initially uses RC4 KSA and incorporates the RC4 PRGA within a loop to generate a table of offsets that dictate the order in which to piece back together more shellcode.\n&nbsp;\nRC4 KSA\nTo kick things off, this sample creates the substitution box (S-box) used in RC4 KSA. First, it will allocate an array of incrementing values starting from 0x0 to 0x100 (0-256) entirely on the stack.\nI\u2019ve annotated the assembly below which covers building and modifying the S-box, which is heavily utilized throughout the rest of the unpacking.\n# Counter Check\n001F04CA     8B4D F8           MOV ECX,DWORD PTR SS:[EBP-8]                  ; Set ECX to counter value\n001F04CD     83C1 01           ADD ECX,1                                     ; Increment counter by 0x1\n001F04D0     894D F8           MOV DWORD PTR SS:[EBP-8],ECX                  ; Store counter on stack\n001F04D3     817D F8 00010000  CMP DWORD PTR SS:[EBP-8],100                  ; Compare counter to 0x100\n001F04DA     74 61             JE SHORT 001F053D                             ; End loop if counter is at 0x100\n# Add previous loop value to value found at index in array 2 and the counter\n001F04DC     8B45 F8           MOV EAX,DWORD PTR SS:[EBP-8]                  ; Set EAX to counter value\n001F04DF     33D2              XOR EDX,EDX                                   ; Zero-out EDX register\n001F04E1     F7B5 48FFFFFF     DIV DWORD PTR SS:[EBP-B8]                     ; Divide counter by 0x10 to retrieve index value for array 2\n001F04E7     8B85 40FFFFFF     MOV EAX,DWORD PTR SS:[EBP-C0]                 ; Set EAX to value of array 2 offset\n001F04ED     0FB60410          MOVZX EAX,BYTE PTR DS:[EAX+EDX]               ; Set EAX to value at array 2 offset + counter\n001F04F1     0345 EC           ADD EAX,DWORD PTR SS:[EBP-14]                 ; Add previous result to EAX (0 on first run)\n001F04F4     8B4D F8           MOV ECX,DWORD PTR SS:[EBP-8]                  ; Set ECX to counter value\n001F04F7     0FB6940D FCFDFFFF MOVZX EDX,BYTE PTR SS:[EBP+ECX-204]           ; Set EDX to value of array 1 offset + counter\n001F04FF     03C2              ADD EAX,EDX                                   ; Add the array 1 and array 2 values\n001F0501     33D2              XOR EDX,EDX                                   ; Zero-out EDX register\n001F0503     B9 00010000       MOV ECX,100                                   ; Set ECX 0x100\n001F0508     F7F1              DIV ECX                                       ; Divide value in new value by 0x100\n001F050A     8955 EC           MOV DWORD PTR SS:[EBP-14],EDX                 ; Copy remainder value to stack (now \"old\" value)\n001F050D     8B55 F8           MOV EDX,DWORD PTR SS:[EBP-8]                   ; Set EDX to counter value\n# Swap the array 1 dereferenced values\n001F0510     8A8415 FCFDFFFF   MOV AL,BYTE PTR SS:[EBP+EDX-204]              ; Set AL to value of array 1 offset + counter\n001F0517     8845 F7           MOV BYTE PTR SS:[EBP-9],AL                    ; Store original value on stack\n001F051A     8B4D F8           MOV ECX,DWORD PTR SS:[EBP-8]                  ; Set ECX to counter value\n001F051D     8B55 EC           MOV EDX,DWORD PTR SS:[EBP-14]                 ; Copy \"old\" value to EDX\n001F0520     8A8415 FCFDFFFF   MOV AL,BYTE PTR SS:[EBP+EDX-204]              ; Set AL to value of array 1 offset + old value\n001F0527     88840D FCFDFFFF   MOV BYTE PTR SS:[EBP+ECX-204],AL              ; Set first index in array 1 to new value\n001F052E     8B4D EC           MOV ECX,DWORD PTR SS:[EBP-14]                 ; Set ECX to counter value\n001F0531     8A55 F7           MOV DL,BYTE PTR SS:[EBP-9]                    ; Copy \"old\" value from stack\n001F0534     88940D FCFDFFFF   MOV BYTE PTR SS:[EBP+ECX-204],DL              ; Set second index in array 1 to old value\n001F053B   ^ EB 8D             JMP SHORT 001F04CA                            ; Next iteration\n\nIn this case, there are two arrays, the S-box built on the stack and another 16-byte \u201ckey\u201d array found at 0x455 into the new shellcode. This key array is used to modify values throughout the KSA. Effectively, it takes the counter and uses 0x10 to calculate its modulo, afterwards this is used as an index into the key array. The dereferenced value found at the index is added to the \u201cfinal\u201d value from the previous iteration. In the case of the first iteration, this \u201cfinal\u201d value will be zero. Once those two values are added together, it will add the counter value to the sum and use 0x100 to calculate its modulo, becoming the new \u201cfinal\u201d value for the next iteration.\nAfter completing that equation, it takes the \u201cfinal\u201d value as an index in the 256-byte S-box array and swaps the dereferenced value with the dereferenced value found at the index in the first array using the counter. This is the RC4 KSA in a nut shell.\nHere is an example of this on iteration 0x14 in the loop, after some of the data has been modified already. You can see that after 0xC6, at offset 0x13, there are incrementing values: 0x14, 0x15, 0x16, 0x17, etc.\n\n&nbsp;\n&nbsp;\nFor value 0x14, it retrieves the modulus of 0x4 by using 0x10 for the calculation, which is then used to find the additive value in the key array. The value at key[4] is 0x5D and this is added to the previous \u201cfinal\u201d value, 0xC6, which can be seen at offset 0x13.\n0x5D + 0xC6 = 0x123\nNext, it uses the counter as an index and dereferences the value to add into the equation. For the first couple of runs, the dereferenced value equates to the counter, but eventually these begin to overwrite and the values change accordingly.\n0x123 + 0x14 = 0x137 % 0x100 = 0x37\nNow the values at sbox1[0x37] and sbox1[0x14] are swapped, as can be seen below.\n&nbsp;\n\n&nbsp;\n&nbsp;\nOn the next iteration, with the key value being 0x53, it would look like this:\n(0x53 + 0x37 + 0x15) % 0x100 = 0x9F\nThe values at sbox1[0x9F] and sbox1[0x15] would be swapped.\nYou\u2019ll see that at offset 0x1A in the example output above, the value is 0xC. On iteration 0x1A then, 0xC will be the value added to the key and the previous \u201cfinal\u201d value. This happens for 256 iterations and every value gets shifted around from its original starting point. Talos has a nice blog from 2014 that talks about S-box creation in malware and the RC4 entry on Wikipedia has a succinct overview as well.\nI\u2019ve recreated the logic shown previously Python as it may be easier to illustrate it with code.\ndef sbox1init():\n    return [x for x in range(0, 0x100)]\ndef rc4ksa(sbox1, key):\n    oldValue = 0x0\n    for counter in range(0, len(sbox1)):\n        addValue = key[counter % len(key)]\n        fnlValue = (oldValue + addValue + sbox1[counter]) % 0x100\n        sbox1[fnlValue], sbox1[counter] = sbox1[counter], sbox1[fnlValue]\n        oldValue = fnlValue\n    return sbox1\nkey = [0x82, 0xEF, 0x3D, 0x3C, 0x5D, 0x53, 0xC8, 0xE8, 0x51, 0x8D, 0xFB, 0xD9, 0xD0, 0x23, 0x1B, 0x14]\nsbox1 = rc4ksa(sbox1init(), key)\n\nIn the Python codes first iteration, where the value in sbox1[0x0] is 0x00 and key[0x0] is 0x82, you would add 0x0 to 0x82 to 0x0 (the value at sbox1[counter]) and divide by 0x100. The remainder, 0x82, would then be placed in sbox1[0x0] and the value which was at sbox1[0x0] would be swapped into sbox1[0x82]. There are a lot of cleaner examples of code available online for the RC4 KSA but for the sake of learning, along with making sure that if there were any errors introduced by the malware authors, I created everything based on their logic used.\n&nbsp;\nRC4 PRGA\nThe RC4 PRGA is used within the main unpacking loop specifically to generate a keystream value but how that value is used is where the malware author begins to diverge from RC4.\nI\u2019ll briefly cover PRGA and then move onto the parent unpacking loop, which will make reference back to this algorithm.\nUsing a loop counter as an index into the original S-box, PRGA will dereference the value at sbox1[counter] and add it to the previous keystream value to create the second index. These values will then get swapped around in the S-box, similar to how the KSA does it. Finally, it will retrieve the value at sbox1[counter] and sbox1[secondIndex], add them together, and then use them in a modulo calculation with 0x100 to generate the new keystream value.\nFor example, the first byte referenced (counter starting at 0x1 in this case) is sbox1[0x1], which is 0x7 after completing the KSA. The value at sbox1[0x7] is 0xA6 and they swap values so that sbox1[0x1] is 0xA6 and the value at sbox1[0x7] is 0x7. It then adds 0xA6 to 0x7 to make 0xAD and takes the dereferenced value at sbox1[0xAD], in this case 0x58, as the keystream value.\nNow, at this point, in regular RC4, the new keystream value would be used in an XOR operation to decode or encode a byte of ciphertext or plaintext. As you can guess, that is not the case with this malware.\n&nbsp;\nOffset Table\nTaking a step back, once the S-box generation is complete, the next step is to allocate two more regions of memory. It fills the first region, again, with incrementing values until it hits 0x5C36 but this time each value is a DWORD instead of a singular byte. This region will show itself to be yet another S-box in function.\nNext, it launches into the main unpacking loop, which is the meat of the operation. On each iteration of this loop, it will use an inner-loop (the previously detailed RC4 PRGA) to retrieve a keystream byte \u2013 performed four times each parent loop iteration.\nAfter obtaining the four bytes of keystream values, it will combine them into a DWORD and use it in a modulo calculation with the loop counter from the parent loop, decrementing by one each iteration from the length of the data (0x5C36).\nFor example, the first four bytes of keystream values are 0x58, 0x58, 0xF2, and 0xEA, which is combined to form 0xEAF25858.\n0xEAF25858 % 0x5C36 = 0x5200\nIt takes the result of this operation and uses it as an index into the second S-Box of DWORD\u2019s. Next, it takes the dereferenced value found at the index and stores it in the third memory region, incrementing by an offset of 4 each time. Finally, it swaps the dereferenced values in the second memory region with the value found at the index into the second S-box.\nIn this case, the first DWORD in the third memory region will be 0x5200. It swaps the dereferenced values in the second memory region with the counter value so the value at the offset for 0x5200 will become 0x5C35 (decremented by 4 bytes) and the value found at the offset for 0x5C35 will be 0x5200.\nThis process continues until the parent loop finishes and, once complete, it will allocate another memory region wherein it copies 0x5C36 bytes from address 0x401000 in the main program.\nAlright, if you\u2019ve stuck with me this long, what I want to convey is that all of the above is to create an elaborate table of DWORD offsets, used as indexes, that define how the data will be unshuffled, which is finally what happens next.\nFor each byte in the new memory region, which is the data just copied from address range 0x401000-0x406C36, it will add the corresponding DWORD value for the respective iteration to the base of 0x401000 and copy that byte over. As a reminder, the data being copied at this point is the same data initially moved into position by the first three memcpy() calls.\nThe first DWORD in the third memory region is 0x5200, as discussed previously, and the first byte at 0x401000 is 0x8B, thus at 0x406200 (0x401000 + 0x5200) the value 0x8B will be placed. At no point are any of the bytes manipulated, as would be standard in an RC4 implementation, but instead are just rearranged into their respective order.\nTo help illustrate with code, below is the full implementation of the algorithm in Python. To save space, I\u2019ve removed the data but this is available in full on GitHub if you want to review further.\ndef sbox1init():\n    return [x for x in range(0, 0x100)]\ndef sbox2init():\n    return [x for x in range(0, 0x5C36)]\ndef rc4ksa(sbox1, key):\n    oldValue = 0x0\n    for counter in range(0, len(sbox1)):\n        addValue = key[counter % len(key)]\n        fnlValue = (oldValue + addValue + sbox1[counter]) % 0x100\n        sbox1[fnlValue], sbox1[counter] = sbox1[counter], sbox1[fnlValue]\n        oldValue = fnlValue\n    return sbox1\ndef offsetGen(sbox1, sbox2):\n    offsetTable = []\n    innerCount = 1\n    oldValue = 0x0\n    for counter in range(len(sbox2), 0, -1):\n        fnlValue = \"\"\n        for x in range(0, 4):\n            innerIdx = innerCount % len(sbox1)\n            oldValue = (sbox1[innerIdx] + oldValue) % 0x100\n            addValue = (sbox1[oldValue] + sbox1[innerIdx]) % 0x100\n            sbox1[innerIdx], sbox1[oldValue] = sbox1[oldValue], sbox1[innerIdx]\n            fnlValue = \"%02X\" % sbox1[addValue] + fnlValue\n            innerCount += 1\n        fnlValue = int(fnlValue, 16) % counter\n        offsetTable.append(sbox2[fnlValue])\n        sbox2[fnlValue], sbox2[counter-1] = sbox2[counter-1], sbox2[fnlValue]\n    return offsetTable\ndef unshuffle(data, offsetTable):\n    unshuffle = [0x0] * len(offsetTable)\n    data = [data[x:x+2] for x in range(0, len(data), 2)]\n    for counter, entry in enumerate(offsetTable):\n        unshuffle[entry] = chr(int(data[counter], 16))\n    return \"\".join(unshuffle)\nkey = [0x82, 0xEF, 0x3D, 0x3C, 0x5D, 0x53, 0xC8, 0xE8, 0x51, 0x8D, 0xFB, 0xD9, 0xD0, 0x23, 0x1B, 0x14]\ndata = \"\"\noffsetTable = offsetGen(rc4ksa(sbox1init(), key), sbox2init())\ndata = unshuffle(data, offsetTable)\n\nThus, concludes the unpacking algorithm. You\u2019ll see familiar strings for the actual Hancitor malware once it finishes.\n&nbsp;\n\n&nbsp;\n&nbsp;\nHancitor\nBefore execution shifts back to the main program, they use more anti-debugging tricks by calling the OutputDebugStringA() function to check whether or not the program is being debugged. Once that check is passed, it will begin executing the code found at 0x404000.\nI won\u2019t spend too much time on the functionality of Hancitor as it has been blogged about endlessly but this is what this particular sample will do.\n\n \tGet OS version\n \tGet adapter address\n \tGet Windows directory\n \tGet volume information\n \tCheck external IP with api[.]ipify[.]org\n\nOnce it has the information it needs, depending on whether you\u2019re running on x86 or x64 architecture, it formats the following string used in the initial POST to the Hancitor gate.\n\n&nbsp;\n&nbsp;\nAfter filling it out it will look similar to the below.\n\nGates\nGoing back to the entire reason I even delved into this was that I\u2019ve maintained a Hancitor decoder for the past two years and, with each new variant, I try to find a way to decode out the Hancitor gates so they can quickly be identified and blocked. This variant, even after all of the above unpacking, still left me in the dark as to where the gates were.\nTo figure that out, we have to look a bit further into the code. At the address 0x402B51 in the unpacked shellcode we\u2019ll find a series of Windows decryption calls that take a blob of encrypted data, decrypt it, and reveal the Hancitor gate URL\u2019s and campaign code.\n\n \tCryptAcquireContextA\n \tCryptCreasteHash\n \tCryptHashData\n \tCryptDeriveKey\n \tCryptDecrypt\n \tCryptDestroyHash\n \tCryptDestroyKey\n\nThe algorithm in use here is SHA1 hashing with actual RC4 encryption. It uses an 8-byte value (0xAAE8678C261EC5DB) to derive the SHA1 key and then decrypts 0x2000 bytes.\n&nbsp;\n\n&nbsp;\n&nbsp;\nThe first entry is the campaign code which correlates to the date the campaign was ran on, in this case January 24th, subsequently followed by the three Hancitor gates.\n&nbsp;\nConclusion\nWhile Hancitor continues to evolve, they stick to a fairly strict playbook. This sample diverged from that playbook quite heavily but only saw usage in one campaign before they reverted back to other, older, variants. This may be due to the way it\u2019s packed being detected more frequently or some other unknown reason that caused a drop in their infection rates that prompted removing it. Either way, it\u2019s important to continue tracking their operation and documenting new techniques and tactics used by this adversary.\nPalo Alto Networks customers are protected from Hancitor by WildFire and Traps. This threat can be tracked within AutoFocus by using the Hancitor tag.\n&nbsp;\nIOCs\nHancitor Gates\n\n \thxxp:\/\/naveundpa[.]com\/ls5\/forum[.]php\n \thxxp:\/\/undronride[.]ru\/ls5\/forum[.]php\n \thxxp:\/\/dingparjushis[.]ru\/ls5\/forum[.]php\n\nUser-Agent\n\n \tMozilla\/5.0 (Windows NT 6.1; Win64; x64; Trident\/7.0; rv:11.0) like Gecko\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Jeff White"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.8' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":64492,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"58181e1a44","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.8" id="post-views-counter-frontend-js"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/64492" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=64492' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.15 stt:60,62,1,4,3,27,28,29,43,2,64;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="pingback" href="https://unit42.paloaltonetworks.com/xmlrpc.php"><link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

    </head>
<body class="post-template-default single single-post postid-64492 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}        
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
            if( pcontainer.indexOf('CloudCortex') != -1){
                referer = 'CloudCortex' ;
            }
            else{
                referer = 'Cortex' ;
            }	    
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            if( nContainer.indexOf('CloudCortex') != -1){
                                referer = 'CloudCortex';
                                sessionStorage.setItem("container","CloudCortex");
                            }
                            else{
                                referer = 'Cortex';
                                sessionStorage.setItem("container","Cortex");
                            }                            
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "CloudCortex" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'CloudCortex'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php?type=cortexcloud&domain=en';
        searchResultsPagePath = referrer_domain+"/search/cortexcloudsearch";	
    }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php?type=unit42&domain=en';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
            observer_lozad.observe();
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'CloudCortex' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'CloudCortex'){
        article.dataset.type = 'cloudcortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    
<section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg')">
          <div class="l-container"> 
			              <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>Dissecting Hancitor’s Latest 2018 Packer</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 16</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:Jeff White" href="https://unit42.paloaltonetworks.com/author/jeff-white/">Jeff White</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>February 27, 2018</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:Cybercrime" href="https://unit42.paloaltonetworks.com/category/cybercrime/">Cybercrime</a></li><li><a data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:hancitor" href="https://unit42.paloaltonetworks.com/tag/hancitor/">Hancitor</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/?pdf=download&#038;lg=en&#038;_wpnonce=ef347f070c" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/?pdf=print&#038;lg=en&#038;_wpnonce=ef347f070c" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/" role="link" title="Copy link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Dissecting%20Hancitor&rsquo;s%20Latest%202018%20Packer&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F&#038;title=Dissecting%20Hancitor’s%20Latest%202018%20Packer" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F&#038;text=Dissecting%20Hancitor&rsquo;s%20Latest%202018%20Packer" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Dissecting%20Hancitor’s%20Latest%202018%20Packer%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-dissecting-hancitors-latest-2018-packer%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p><span style="font-size: 18pt;">Summary</span><br />
Over the past two years, the <a href="https://blog.paloaltonetworks.com/2016/08/unit42-vb-dropper-and-shellcode-for-hancitor-reveal-new-techniques-behind-uptick/">Hancitor malware family</a> has been a <a href="https://blog.paloaltonetworks.com/2016/08/unit42-pythons-and-unicorns-and-hancitoroh-my-decoding-binaries-through-emulation/">fairly regular</a> nuisance that defenders on the front line of organizations have to deal with on an almost weekly basis. The malware itself has gone through more than 80 variations during this time, sometimes just to define new variables for campaigns and other times a complete rewrite of the malware’s core functionality by the code authors. Every now and then though, they venture out into the unknown with techniques unlike what Hancitor has used before. These occasions tend to be short-lived and I look at them more as “testing” phases. I suspect the malware authors monitor their infection rates and when they deviate from the tried and true, campaigns end up being less successful. For those interested in an overview of how a typical Hancitor malspam campaign operates, Unit 42 recently published a<a href="https://blog.paloaltonetworks.com/2018/02/unit42-compromised-servers-fraud-accounts-recent-hancitor-attacks/"> blog</a> on the subject.  In this post, I’ll be diving into the technical inner-workings of their latest malware packer.<br />
For this particular instance,  campaigns on January 24, 2018 and January 25, 2018 used a different document format, Rich Text Format (RTF), that leveraged an exploit (<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882">CVE-2017-11882</a>) to launch shellcode which executed a PowerShell command used to download the standard binary which has been used for months. Usually, Hancitor is distributed through Microsoft Word documents utilizing macros but RTF documents typically require some kind of exploit to execute code. In the past, Hancitor has kept itself at arm’s length from exploitation and instead relied entirely on social-engineering. This most likely helps evade against anti-virus (AV) and endpoint detection and response (EDR) systems monitoring for that type of activity.<br />
The first RTF variant on the 24<sup>th</sup> is fairly straightforward; however, on the 25th, the RTF now included an embedded PE file that was entirely different than their standard binary. This PE file exhibited a new unpacking technique that the Hancitor developers have never employed before and this will be the meat of the blog post. My end goal is to identify the standard Hancitor command and control (C2) gate URL’s, which stayed the same even with the new dropper in use.<br />
For this analysis, I’ll be using the following sample:</p>
<table align="center">
<tbody>
<tr>
<td width="45"><strong>SHA256</strong></td>
<td width="423">B489CA02DCEA8DC7D5420908AD5D58F99A6FEF160721DCECFD512095F2163F7A</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
<span style="font-size: 18pt;">RTF Dropper</span><br />
I won’t be getting into the details of the exploit but suffice to say, they used the CVE-2017-11882 exploit in their RTF document to launch shellcode and execute a PowerShell command. The PowerShell command in this campaign will save a base64 encoded PE to disk and then call the Start-Process cmdlet on it.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc2c295542897" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$EUX4JTF7 = '';foreach($82OJU7FY3US in (1..12 | foreach{ '{0:X}' -f (Get  Random -Max 235) })){$EUX4JTF7 += "$82OJU7FY3US"};$NR3MNTAYNI =  "$env:USERPROFILE\" + $EUX4JTF7 +  ".exe";[IO.File]::WriteAllBytes($NR3MNTAYNI,  [System.Convert]::FromBase64String('TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAA  AAAAAAAAAA…&lt;TRUNCATED&gt;…AAAAAAAAAAAAA'));Start-Process $NR3MNTAYNI</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc2c295542897-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc2c295542897-1"><span class="crayon-sy">$</span><span class="crayon-i">EUX4JTF7</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span><span class="crayon-st">foreach</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-cn">82OJU7FY3US</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1..12</span><span class="crayon-h"> </span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">foreach</span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-s">'{0:X}'</span><span class="crayon-h"> </span>-<span class="crayon-e">f</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Get&nbsp;&nbsp;</span><span class="crayon-i">Random</span><span class="crayon-h"> </span>-<span class="crayon-i">Max</span><span class="crayon-h"> </span><span class="crayon-cn">235</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-i">EUX4JTF7</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-s">"$82OJU7FY3US"</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-i">NR3MNTAYNI</span><span class="crayon-h"> </span>=<span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"$env:USERPROFILE\" + $EUX4JTF7 +&nbsp;&nbsp;"</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span>"<span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-i">IO</span><span class="crayon-sy">.</span><span class="crayon-i">File</span><span class="crayon-sy">]</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">WriteAllBytes</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">NR3MNTAYNI</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-i">System</span><span class="crayon-sy">.</span><span class="crayon-i">Convert</span><span class="crayon-sy">]</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">FromBase64String</span><span class="crayon-sy">(</span><span class="crayon-s">'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAA&nbsp;&nbsp;AAAAAAAAAA…&lt;TRUNCATED&gt;…AAAAAAAAAAAAA'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-i">Start</span>-<span class="crayon-i">Process</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">NR3MNTAYNI</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>&nbsp;<br />
<span style="font-size: 18pt;">Hancitor PE</span><br />
Once the PE is launched, it will create a simple mutex called <em>“e”</em> and then begin to employ some anti-disassembly techniques that seek to hinder static analysis. In general, most popular disassemblers default to flow-oriented disassembly as opposed to linear disassembly. This means that when the disassembler analyzes instructions, if the instruction would shift the execution of the program to another location, then the disassembler may follow the instructions to that location to continue analysis. All bytes which would come after the branching may go unanalyzed and won’t be disassembled. Abusing this functionality to confuse the disassembler is a very common technique.<br />
Effectively, this sample builds an address location into a register and then uses that register as the operand for a CALL instruction to shift execution to a section of code that the disassembler hasn’t analyzed. Since the disassembler doesn’t know what value will be in that register upon analysis, assuming the code isn’t analyzed due to other reasons, then it just leaves it as ‘data’. In a debugger, this problem is fairly trivial to deal with as you can just instruct the debugger to re-analyze the code from any point you choose.<br />
After its initial jump into unanalyzed code, the malware begins to employ more anti-disassembly and anti-debugging techniques. Specifically, it starts executing code where there will be one or two instructions immediately followed by a jump. Normally, you would be able to read instructions linearly and get an understanding of the overall functionality, but with jumps interspersed between each instruction, the flow is obscured and harder to analyze as you only ever see one or two pieces of the overall function on your screen. This requires you keep track of what’s going on, step-by-step.<br />
In this case, the first thing the code does is to load the address for VirtualProtect() into the EAX register and build the parameters on the stack for a call to it. Again, using a call to the register further helps prevent static analysis. Once the call is made, it adjusts the privileges for all memory space loaded by this PE to have read, write, and execute (RWE) bits set, shown below. This is also new to the Hancitor malware, but is specifically used within the packer which we will discuss shortly.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc35626280150" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Address	Size	Owner	Section	Contains	Type	Access	Initial	Mapped as
00400000	00001000	b489ca02		PE header	Imag	RWE CopyOnWr	RWE
00401000	00008000	b489ca02	.text	code	Imag	RWE CopyOnWr	RWE
00409000	00002000	b489ca02	.rdata	imports	Imag	RWE CopyOnWr	RWE
0040B000	00001000	b489ca02	.data	data	Imag	RWE CopyOnWr	RWE
0040C000	00001000	b489ca02	.rsrc	resources	Imag	RWE CopyOnWr	RWE</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc35626280150-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc35626280150-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc35626280150-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc35626280150-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc35626280150-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc35626280150-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc35626280150-1"><span class="crayon-e">Address	</span><span class="crayon-e">Size	</span><span class="crayon-e">Owner	</span><span class="crayon-e">Section	</span><span class="crayon-e">Contains	</span><span class="crayon-e">Type	</span><span class="crayon-e">Access	</span><span class="crayon-e">Initial	</span><span class="crayon-e">Mapped </span><span class="crayon-st">as</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc35626280150-2"><span class="crayon-cn">00400000</span><span class="crayon-h">	</span><span class="crayon-cn">00001000</span><span class="crayon-h">	</span><span class="crayon-e">b489ca02		</span><span class="crayon-e">PE </span><span class="crayon-e">header	</span><span class="crayon-e">Imag	</span><span class="crayon-e">RWE </span><span class="crayon-e">CopyOnWr	</span><span class="crayon-i">RWE</span></div><div class="crayon-line" id="crayon-67e61f14cfc35626280150-3"><span class="crayon-cn">00401000</span><span class="crayon-h">	</span><span class="crayon-cn">00008000</span><span class="crayon-h">	</span><span class="crayon-i">b489ca02</span><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-e">text	</span><span class="crayon-e">code	</span><span class="crayon-e">Imag	</span><span class="crayon-e">RWE </span><span class="crayon-e">CopyOnWr	</span><span class="crayon-i">RWE</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc35626280150-4"><span class="crayon-cn">00409000</span><span class="crayon-h">	</span><span class="crayon-cn">00002000</span><span class="crayon-h">	</span><span class="crayon-i">b489ca02</span><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-e">rdata	</span><span class="crayon-e">imports	</span><span class="crayon-e">Imag	</span><span class="crayon-e">RWE </span><span class="crayon-e">CopyOnWr	</span><span class="crayon-i">RWE</span></div><div class="crayon-line" id="crayon-67e61f14cfc35626280150-5"><span class="crayon-cn">0040B000</span><span class="crayon-h">	</span><span class="crayon-cn">00001000</span><span class="crayon-h">	</span><span class="crayon-i">b489ca02</span><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-e">data	</span><span class="crayon-e">data	</span><span class="crayon-e">Imag	</span><span class="crayon-e">RWE </span><span class="crayon-e">CopyOnWr	</span><span class="crayon-i">RWE</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc35626280150-6"><span class="crayon-cn">0040C000</span><span class="crayon-h">	</span><span class="crayon-cn">00001000</span><span class="crayon-h">	</span><span class="crayon-i">b489ca02</span><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-e">rsrc	</span><span class="crayon-e">resources	</span><span class="crayon-e">Imag	</span><span class="crayon-e">RWE </span><span class="crayon-e">CopyOnWr	</span><span class="crayon-i">RWE</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Setting all of the permissions to RWE allows for execution in the program to be transferred to any of the mapped memory regions, whereas typically it’s limited to the “code” section. There is also no reason they couldn’t have contained all of this within the “code” section, so it’s a good indicator for detection when everything is converted to RWE. This is commonly done when there will be code hidden outside of the originally defined area; however, in this sample, they never actually execute code outside of this memory region so it’s a shotgun approach to adjusting privileges.<br />
The next action it will take, still using the same instruction-jump obfuscation, begins to XOR 0xC80 bytes beginning at address 0x402185 with the value 0xD1. One interesting oddity to their method here is that they move the value 0x5AF06AD1 to the EAX register, but only use the lower byte, AL (0xD1), for the XOR and ignore the other three bytes. It wouldn’t be the first time the Hancitor malware has intended to use a full value but introduced errors in their code that caused it to only partially work as intended. The decoding routine looks like the following.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc37027013508" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
004040EA    3007            XOR BYTE PTR DS:[EDI],AL
004040EC    E9 8B000000     JMP b489ca02.0040417C
--
0040417C    41              INC ECX
0040417D    EB DD           JMP SHORT b489ca02.0040415C
--
0040415C    47              INC EDI
0040415D    EB D8           JMP SHORT b489ca02.00404137
--
00404137    39F1            CMP ECX,ESI
00404139    0F81 24FFFFFF   JNO b489ca02.00404063
--
00404063    0F82 81000000   JB b489ca02.004040EA</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc37027013508-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc37027013508-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc37027013508-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc37027013508-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc37027013508-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc37027013508-6">6</div><div class="crayon-num" data-line="crayon-67e61f14cfc37027013508-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc37027013508-8">8</div><div class="crayon-num" data-line="crayon-67e61f14cfc37027013508-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc37027013508-10">10</div><div class="crayon-num" data-line="crayon-67e61f14cfc37027013508-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc37027013508-12">12</div><div class="crayon-num" data-line="crayon-67e61f14cfc37027013508-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc37027013508-1"><span class="crayon-cn">004040EA</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">3007</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">XOR</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">DS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EDI</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">AL</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc37027013508-2"><span class="crayon-cn">004040EC</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">E9</span><span class="crayon-h"> </span><span class="crayon-cn">8B000000</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">JMP </span><span class="crayon-i">b489ca02</span><span class="crayon-sy">.</span><span class="crayon-cn">0040417C</span></div><div class="crayon-line" id="crayon-67e61f14cfc37027013508-3">--</div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc37027013508-4"><span class="crayon-cn">0040417C</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">41</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">INC </span><span class="crayon-i">ECX</span></div><div class="crayon-line" id="crayon-67e61f14cfc37027013508-5"><span class="crayon-cn">0040417D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">EB </span><span class="crayon-e">DD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-i">b489ca02</span><span class="crayon-sy">.</span><span class="crayon-cn">0040415C</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc37027013508-6">--</div><div class="crayon-line" id="crayon-67e61f14cfc37027013508-7"><span class="crayon-cn">0040415C</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">47</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">INC </span><span class="crayon-i">EDI</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc37027013508-8"><span class="crayon-cn">0040415D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">EB </span><span class="crayon-e">D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-i">b489ca02</span><span class="crayon-sy">.</span><span class="crayon-cn">00404137</span></div><div class="crayon-line" id="crayon-67e61f14cfc37027013508-9">--</div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc37027013508-10"><span class="crayon-cn">00404137</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">39F1</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">CMP </span><span class="crayon-i">ECX</span><span class="crayon-sy">,</span><span class="crayon-i">ESI</span></div><div class="crayon-line" id="crayon-67e61f14cfc37027013508-11"><span class="crayon-cn">00404139</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0F81</span><span class="crayon-h"> </span><span class="crayon-cn">24FFFFFF</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">JNO </span><span class="crayon-i">b489ca02</span><span class="crayon-sy">.</span><span class="crayon-cn">00404063</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc37027013508-12">--</div><div class="crayon-line" id="crayon-67e61f14cfc37027013508-13"><span class="crayon-cn">00404063</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0F82</span><span class="crayon-h"> </span><span class="crayon-cn">81000000</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">JB </span><span class="crayon-i">b489ca02</span><span class="crayon-sy">.</span><span class="crayon-cn">004040EA</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Once this loop finishes decoding new shellcode, it will transfer execution to address 0x402185 with a JMP instruction.<br />
To illustrate looking at assembly that hasn’t been analyzed yet, from a debugger perspective, you would see these bytes as data within the “code” section.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc3a843854933" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
00402185       55              DB 55                                          ;  CHAR 'U'
00402186       8B              DB 8B
00402187       EC              DB EC
00402188       81              DB 81
00402189       EC              DB EC
0040218A       04              DB 04
0040218B       02              DB 02
0040218C       00              DB 00
0040218D       00              DB 00
0040218E       53              DB 53                                         ;  CHAR 'S'
0040218F       56              DB 56                                         ;  CHAR 'V'
00402190       57              DB 57                                         ;  CHAR 'W'
00402191       60              DB 60                                         ;  CHAR '`'
00402192       FC              DB FC</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc3a843854933-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3a843854933-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc3a843854933-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3a843854933-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc3a843854933-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3a843854933-6">6</div><div class="crayon-num" data-line="crayon-67e61f14cfc3a843854933-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3a843854933-8">8</div><div class="crayon-num" data-line="crayon-67e61f14cfc3a843854933-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3a843854933-10">10</div><div class="crayon-num" data-line="crayon-67e61f14cfc3a843854933-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3a843854933-12">12</div><div class="crayon-num" data-line="crayon-67e61f14cfc3a843854933-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3a843854933-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc3a843854933-1"><span class="crayon-cn">00402185</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">55</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-s">'U'</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3a843854933-2"><span class="crayon-cn">00402186</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">8B</span></div><div class="crayon-line" id="crayon-67e61f14cfc3a843854933-3"><span class="crayon-cn">00402187</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DB </span><span class="crayon-i">EC</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3a843854933-4"><span class="crayon-cn">00402188</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">81</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">81</span></div><div class="crayon-line" id="crayon-67e61f14cfc3a843854933-5"><span class="crayon-cn">00402189</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DB </span><span class="crayon-i">EC</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3a843854933-6"><span class="crayon-cn">0040218A</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">04</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">04</span></div><div class="crayon-line" id="crayon-67e61f14cfc3a843854933-7"><span class="crayon-cn">0040218B</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">02</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">02</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3a843854933-8"><span class="crayon-cn">0040218C</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">00</span></div><div class="crayon-line" id="crayon-67e61f14cfc3a843854933-9"><span class="crayon-cn">0040218D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">00</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3a843854933-10"><span class="crayon-cn">0040218E</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">53</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-s">'S'</span></div><div class="crayon-line" id="crayon-67e61f14cfc3a843854933-11"><span class="crayon-cn">0040218F</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">56</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">56</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-s">'V'</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3a843854933-12"><span class="crayon-cn">00402190</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">57</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">57</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-s">'W'</span></div><div class="crayon-line" id="crayon-67e61f14cfc3a843854933-13"><span class="crayon-cn">00402191</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">60</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-s">'`'</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3a843854933-14"><span class="crayon-cn">00402192</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DB </span><span class="crayon-i">FC</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Simply telling the debugger to reanalyze the code found will make it human readable.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc3c699191083" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
00402185    .  55              PUSH EBP
00402186    .  8BEC            MOV EBP,ESP
00402188    .  81EC 04020000   SUB ESP,204
0040218E    .  53              PUSH EBX
0040218F    .  56              PUSH ESI
00402190    .  57              PUSH EDI                                      ;  b489ca02.00402E05
00402191    .  60              PUSHAD
00402192    .  FC              CLD</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc3c699191083-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3c699191083-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc3c699191083-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3c699191083-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc3c699191083-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3c699191083-6">6</div><div class="crayon-num" data-line="crayon-67e61f14cfc3c699191083-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3c699191083-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc3c699191083-1"><span class="crayon-cn">00402185</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">55</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PUSH </span><span class="crayon-i">EBP</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3c699191083-2"><span class="crayon-cn">00402186</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">8BEC</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">MOV </span><span class="crayon-i">EBP</span><span class="crayon-sy">,</span><span class="crayon-i">ESP</span></div><div class="crayon-line" id="crayon-67e61f14cfc3c699191083-3"><span class="crayon-cn">00402188</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">81EC</span><span class="crayon-h"> </span><span class="crayon-cn">04020000</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">SUB </span><span class="crayon-i">ESP</span><span class="crayon-sy">,</span><span class="crayon-cn">204</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3c699191083-4"><span class="crayon-cn">0040218E</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">53</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PUSH </span><span class="crayon-i">EBX</span></div><div class="crayon-line" id="crayon-67e61f14cfc3c699191083-5"><span class="crayon-cn">0040218F</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">56</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PUSH </span><span class="crayon-i">ESI</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3c699191083-6"><span class="crayon-cn">00402190</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">57</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PUSH </span><span class="crayon-i">EDI</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">b489ca02</span><span class="crayon-sy">.</span><span class="crayon-cn">00402E05</span></div><div class="crayon-line" id="crayon-67e61f14cfc3c699191083-7"><span class="crayon-cn">00402191</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">60</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">PUSHAD</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3c699191083-8"><span class="crayon-cn">00402192</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">CLD</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h1></h1>
<p><span style="font-size: 18pt;">Initial Shellcode</span><br />
Once inside this new shellcode it begins to look up the address locations for a number of functions using GetProcAddress(). These functions will be used throughout the unpacking routines. The function names are not obfuscated and, once decoded from the above, can be seen in plain text.<br />
<img  class="aligncenter wp-image-64726 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor1-5.png" alt="hancitor1" width="600" height="145" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor1-5.png 970w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor1-5-900x217.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor1-5-300x72.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor1-5-768x185.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor1-5-370x89.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;<br />
&nbsp;<br />
Some of the functions and DLL names looked up are listed below:</p>
<ul>
<li>GetModuleHandleA</li>
<li>LoadLibraryA</li>
<li>VirtualAlloc</li>
<li>VirtualFree</li>
<li>OutputDebugStringA</li>
<li>ntdll.dll</li>
<li>_stricmp</li>
<li>memset</li>
<li>memcpy</li>
</ul>
<p>Throughout the unpacking, VirtualAlloc(), memcpy(), and VirtualFree() are heavily used for moving data around and overwriting existing data.<br />
Once it has all of the addresses, the sample will allocate a 0x1000 byte memory page and copy all of the decoded shellcode into it. Next, it will begin to egg hunt for two DWORD values, 0x88BAC570 and 0x48254000 respectively, in which it will find the address four bytes from the start of the second egg. Egg hunting allows the code to be position independent and is a technique found in almost all Hancitor variants. After identifying the address, it will be used in another “JMP EAX” instruction to transfer execution to a new function within the copied shellcode, at offset 0x3E4, in the newly allocated memory range.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Data Setup</span><br />
From a control flow perspective, the same code is being executed, albeit from a new location, which frees up the unpacking functions to overwrite the code in the main body of the Hancitor PE.<br />
The first actions taken is to overwrite code in three locations by copying data toward the end of the “code” section to earlier areas, shown below.</p>
<table align="center">
<tbody>
<tr>
<td width="156"><strong>Source memcpy()</strong></td>
<td width="156"><strong>Size</strong></td>
<td width="156"><strong>Dest Addr Range</strong></td>
</tr>
<tr>
<td width="156">0x407C9E</td>
<td width="156">0x514</td>
<td width="156">0x4058D4-0x405DE8</td>
</tr>
<tr>
<td width="156">0x4078B6</td>
<td width="156">0x3E8</td>
<td width="156">0x40400A-0x4043F2</td>
</tr>
<tr>
<td width="156">0x406C36</td>
<td width="156">0xC80</td>
<td width="156">0x402185-0x402E05</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
During this operation, there is another good example that illustrates some of the anti-analysis tricks in use.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc3d613956844" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
001F0453    EB 10             JMP SHORT 001F0465
001F0455    82EF 3D           SUB BH,3D
001F0458    3C 5D             CMP AL,5D
001F045A    53                PUSH EBX
001F045B    C8 E8518D         ENTER 51E8,8D
001F045F    FB                STI
001F0460    D9D0              FNOP
001F0462    231B              AND EBX,DWORD PTR DS:[EBX]
001F0464    14 83             ADC AL,83
001F0466    C003 89           ROL BYTE PTR DS:[EBX],89
001F0469    8540 FF           TEST DWORD PTR DS:[EAX-1],EAX</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc3d613956844-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3d613956844-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc3d613956844-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3d613956844-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc3d613956844-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3d613956844-6">6</div><div class="crayon-num" data-line="crayon-67e61f14cfc3d613956844-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3d613956844-8">8</div><div class="crayon-num" data-line="crayon-67e61f14cfc3d613956844-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc3d613956844-10">10</div><div class="crayon-num" data-line="crayon-67e61f14cfc3d613956844-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc3d613956844-1"><span class="crayon-cn">001F0453</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">EB</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-cn">001F0465</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3d613956844-2"><span class="crayon-cn">001F0455</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">82EF</span><span class="crayon-h"> </span><span class="crayon-cn">3D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">SUB </span><span class="crayon-i">BH</span><span class="crayon-sy">,</span><span class="crayon-cn">3D</span></div><div class="crayon-line" id="crayon-67e61f14cfc3d613956844-3"><span class="crayon-cn">001F0458</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">3C</span><span class="crayon-h"> </span><span class="crayon-cn">5D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">CMP </span><span class="crayon-i">AL</span><span class="crayon-sy">,</span><span class="crayon-cn">5D</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3d613956844-4"><span class="crayon-cn">001F045A</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">53</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PUSH </span><span class="crayon-i">EBX</span></div><div class="crayon-line" id="crayon-67e61f14cfc3d613956844-5"><span class="crayon-cn">001F045B</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">C8 </span><span class="crayon-e">E8518D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">ENTER</span><span class="crayon-h"> </span><span class="crayon-cn">51E8</span><span class="crayon-sy">,</span><span class="crayon-cn">8D</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3d613956844-6"><span class="crayon-cn">001F045F</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">FB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">STI</span></div><div class="crayon-line" id="crayon-67e61f14cfc3d613956844-7"><span class="crayon-cn">001F0460</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">D9D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">FNOP</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3d613956844-8"><span class="crayon-cn">001F0462</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">231B</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-i">EBX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">DS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBX</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc3d613956844-9"><span class="crayon-cn">001F0464</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">14</span><span class="crayon-h"> </span><span class="crayon-cn">83</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ADC </span><span class="crayon-i">AL</span><span class="crayon-sy">,</span><span class="crayon-cn">83</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc3d613956844-10"><span class="crayon-cn">001F0466</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">C003</span><span class="crayon-h"> </span><span class="crayon-cn">89</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ROL </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">DS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBX</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-cn">89</span></div><div class="crayon-line" id="crayon-67e61f14cfc3d613956844-11"><span class="crayon-cn">001F0469</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">8540</span><span class="crayon-h"> </span><span class="crayon-e">FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">TEST </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">DS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EAX</span>-<span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">EAX</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Beginning at the top of the code, you’ll notice the “JMP SHORT 001F0465” instruction which is not actually in the address listing on the left side of this snippet. This is a common technique to obscure code flow because it was disassembled linearly at the instruction boundaries, but the JMP instruction is redirecting execution outside of the boundary. Once this jump is actually taken and lands in the middle of the shown instruction 0x1F0464, the code will be re-analyzed based on the instruction pointer location and change the meaning entirely.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc40321673026" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
001F0465    83C0 03           ADD EAX,3
001F0468    8985 40FFFFFF     MOV DWORD PTR SS:[EBP-C0],EAX</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc40321673026-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc40321673026-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc40321673026-1"><span class="crayon-cn">001F0465</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">83C0</span><span class="crayon-h"> </span><span class="crayon-cn">03</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ADD </span><span class="crayon-i">EAX</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc40321673026-2"><span class="crayon-cn">001F0468</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">8985</span><span class="crayon-h"> </span><span class="crayon-cn">40FFFFFF</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-i">C0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">EAX</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h1></h1>
<p><span style="font-size: 18pt;">Unpacking More Shellcode</span><br />
This next phase is where the unpacking actually occurs and the main purpose of this blog. Before I get into it, I’ll preface it with if you know how RC4 works, you may want to skip ahead as the first two sections will cover the RC4 key-scheduling algorithm (KSA) and the RC4 pseudo-random generation algorithm (PRGA), which are used as part of this unpacking algorithm.<br />
In general, packers seek to modify data or code in such a way that it’s unlike the original content, effectively obfuscating it. Packers are not inherently bad but it adds another layer of evasion to malware, so they tend to go hand-in-hand. Each packer typically attempts to put their own spin on how to do this by coming up with unique algorithms; this makes it difficult to programmatically unpack malware at scale but also allows for varying levels of protection. Code packing algorithms can be as simple as a one-byte XOR across the data to full-on encryption or compression.<br />
In the case of this malware, they’ve created an algorithm which initially uses RC4 KSA and incorporates the RC4 PRGA within a loop to generate a table of offsets that dictate the order in which to piece back together more shellcode.<br />
&nbsp;<br />
<span style="font-size: 18pt;">RC4 KSA</span><br />
To kick things off, this sample creates the substitution box (S-box) used in RC4 KSA. First, it will allocate an array of incrementing values starting from 0x0 to 0x100 (0-256) entirely on the stack.<br />
I’ve annotated the assembly below which covers building and modifying the S-box, which is heavily utilized throughout the rest of the unpacking.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc41451323188" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Counter Check
001F04CA     8B4D F8           MOV ECX,DWORD PTR SS:[EBP-8]                  ; Set ECX to counter value
001F04CD     83C1 01           ADD ECX,1                                     ; Increment counter by 0x1
001F04D0     894D F8           MOV DWORD PTR SS:[EBP-8],ECX                  ; Store counter on stack
001F04D3     817D F8 00010000  CMP DWORD PTR SS:[EBP-8],100                  ; Compare counter to 0x100
001F04DA     74 61             JE SHORT 001F053D                             ; End loop if counter is at 0x100
# Add previous loop value to value found at index in array 2 and the counter
001F04DC     8B45 F8           MOV EAX,DWORD PTR SS:[EBP-8]                  ; Set EAX to counter value
001F04DF     33D2              XOR EDX,EDX                                   ; Zero-out EDX register
001F04E1     F7B5 48FFFFFF     DIV DWORD PTR SS:[EBP-B8]                     ; Divide counter by 0x10 to retrieve index value for array 2
001F04E7     8B85 40FFFFFF     MOV EAX,DWORD PTR SS:[EBP-C0]                 ; Set EAX to value of array 2 offset
001F04ED     0FB60410          MOVZX EAX,BYTE PTR DS:[EAX+EDX]               ; Set EAX to value at array 2 offset + counter
001F04F1     0345 EC           ADD EAX,DWORD PTR SS:[EBP-14]                 ; Add previous result to EAX (0 on first run)
001F04F4     8B4D F8           MOV ECX,DWORD PTR SS:[EBP-8]                  ; Set ECX to counter value
001F04F7     0FB6940D FCFDFFFF MOVZX EDX,BYTE PTR SS:[EBP+ECX-204]           ; Set EDX to value of array 1 offset + counter
001F04FF     03C2              ADD EAX,EDX                                   ; Add the array 1 and array 2 values
001F0501     33D2              XOR EDX,EDX                                   ; Zero-out EDX register
001F0503     B9 00010000       MOV ECX,100                                   ; Set ECX 0x100
001F0508     F7F1              DIV ECX                                       ; Divide value in new value by 0x100
001F050A     8955 EC           MOV DWORD PTR SS:[EBP-14],EDX                 ; Copy remainder value to stack (now "old" value)
001F050D     8B55 F8           MOV EDX,DWORD PTR SS:[EBP-8]                   ; Set EDX to counter value
# Swap the array 1 dereferenced values
001F0510     8A8415 FCFDFFFF   MOV AL,BYTE PTR SS:[EBP+EDX-204]              ; Set AL to value of array 1 offset + counter
001F0517     8845 F7           MOV BYTE PTR SS:[EBP-9],AL                    ; Store original value on stack
001F051A     8B4D F8           MOV ECX,DWORD PTR SS:[EBP-8]                  ; Set ECX to counter value
001F051D     8B55 EC           MOV EDX,DWORD PTR SS:[EBP-14]                 ; Copy "old" value to EDX
001F0520     8A8415 FCFDFFFF   MOV AL,BYTE PTR SS:[EBP+EDX-204]              ; Set AL to value of array 1 offset + old value
001F0527     88840D FCFDFFFF   MOV BYTE PTR SS:[EBP+ECX-204],AL              ; Set first index in array 1 to new value
001F052E     8B4D EC           MOV ECX,DWORD PTR SS:[EBP-14]                 ; Set ECX to counter value
001F0531     8A55 F7           MOV DL,BYTE PTR SS:[EBP-9]                    ; Copy "old" value from stack
001F0534     88940D FCFDFFFF   MOV BYTE PTR SS:[EBP+ECX-204],DL              ; Set second index in array 1 to old value
001F053B   ^ EB 8D             JMP SHORT 001F04CA                            ; Next iteration</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-6">6</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-8">8</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-10">10</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-12">12</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-14">14</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-16">16</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-18">18</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-20">20</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-22">22</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-24">24</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-26">26</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-28">28</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-30">30</div><div class="crayon-num" data-line="crayon-67e61f14cfc41451323188-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc41451323188-32">32</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc41451323188-1"><span class="crayon-p"># Counter Check</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-2"><span class="crayon-cn">001F04CA</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B4D</span><span class="crayon-h"> </span><span class="crayon-e">F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">ECX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">ECX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-i">value</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-3"><span class="crayon-cn">001F04CD</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">83C1</span><span class="crayon-h"> </span><span class="crayon-cn">01</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ADD </span><span class="crayon-i">ECX</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Increment </span><span class="crayon-e">counter </span><span class="crayon-i">by</span><span class="crayon-h"> </span><span class="crayon-cn">0x1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-4"><span class="crayon-cn">001F04D0</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">894D</span><span class="crayon-h"> </span><span class="crayon-e">F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">ECX</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Store </span><span class="crayon-e">counter </span><span class="crayon-e">on </span><span class="crayon-i">stack</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-5"><span class="crayon-cn">001F04D3</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">817D</span><span class="crayon-h"> </span><span class="crayon-i">F8</span><span class="crayon-h"> </span><span class="crayon-cn">00010000</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">CMP </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-cn">100</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Compare </span><span class="crayon-e">counter </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-6"><span class="crayon-cn">001F04DA</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">61</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-cn">001F053D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-e">loop </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-7"><span class="crayon-p"># Add previous loop value to value found at index in array 2 and the counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-8"><span class="crayon-cn">001F04DC</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B45</span><span class="crayon-h"> </span><span class="crayon-e">F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">EAX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">EAX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-i">value</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-9"><span class="crayon-cn">001F04DF</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">33D2</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">XOR</span><span class="crayon-h"> </span><span class="crayon-i">EDX</span><span class="crayon-sy">,</span><span class="crayon-i">EDX</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">Zero</span>-<span class="crayon-e">out </span><span class="crayon-e">EDX </span><span class="crayon-i">register</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-10"><span class="crayon-cn">001F04E1</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">F7B5</span><span class="crayon-h"> </span><span class="crayon-cn">48FFFFFF</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">DIV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-i">B8</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Divide </span><span class="crayon-e">counter </span><span class="crayon-i">by</span><span class="crayon-h"> </span><span class="crayon-cn">0x10</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">retrieve </span><span class="crayon-e">index </span><span class="crayon-e">value </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-11"><span class="crayon-cn">001F04E7</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B85</span><span class="crayon-h"> </span><span class="crayon-cn">40FFFFFF</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">EAX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-i">C0</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">EAX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-e">of </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-i">offset</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-12"><span class="crayon-cn">001F04ED</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0FB60410</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">MOVZX </span><span class="crayon-i">EAX</span><span class="crayon-sy">,</span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">DS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EAX</span>+<span class="crayon-i">EDX</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">EAX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-e">at </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-i">offset</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">counter</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-13"><span class="crayon-cn">001F04F1</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0345</span><span class="crayon-h"> </span><span class="crayon-e">EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ADD </span><span class="crayon-i">EAX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">14</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Add </span><span class="crayon-e">previous </span><span class="crayon-e">result </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">EAX</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-e">on </span><span class="crayon-e">first </span><span class="crayon-i">run</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-14"><span class="crayon-cn">001F04F4</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B4D</span><span class="crayon-h"> </span><span class="crayon-e">F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">ECX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">ECX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-i">value</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-15"><span class="crayon-cn">001F04F7</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0FB6940D</span><span class="crayon-h"> </span><span class="crayon-e">FCFDFFFF </span><span class="crayon-e">MOVZX </span><span class="crayon-i">EDX</span><span class="crayon-sy">,</span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>+<span class="crayon-i">ECX</span>-<span class="crayon-cn">204</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">EDX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-e">of </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-i">offset</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-16"><span class="crayon-cn">001F04FF</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">03C2</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ADD </span><span class="crayon-i">EAX</span><span class="crayon-sy">,</span><span class="crayon-i">EDX</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Add </span><span class="crayon-e">the </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-17"><span class="crayon-cn">001F0501</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">33D2</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">XOR</span><span class="crayon-h"> </span><span class="crayon-i">EDX</span><span class="crayon-sy">,</span><span class="crayon-i">EDX</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">Zero</span>-<span class="crayon-e">out </span><span class="crayon-e">EDX </span><span class="crayon-i">register</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-18"><span class="crayon-cn">001F0503</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">B9</span><span class="crayon-h"> </span><span class="crayon-cn">00010000</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">ECX</span><span class="crayon-sy">,</span><span class="crayon-cn">100</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-i">ECX</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-19"><span class="crayon-cn">001F0508</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">F7F1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DIV </span><span class="crayon-i">ECX</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Divide </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-i">by</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-20"><span class="crayon-cn">001F050A</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8955</span><span class="crayon-h"> </span><span class="crayon-e">EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">14</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">EDX</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Copy </span><span class="crayon-e">remainder </span><span class="crayon-e">value </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">stack</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">now</span><span class="crayon-h"> </span><span class="crayon-s">"old"</span><span class="crayon-h"> </span><span class="crayon-i">value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-21"><span class="crayon-cn">001F050D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B55</span><span class="crayon-h"> </span><span class="crayon-e">F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">EDX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">EDX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-i">value</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-22"><span class="crayon-p"># Swap the array 1 dereferenced values</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-23"><span class="crayon-cn">001F0510</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8A8415</span><span class="crayon-h"> </span><span class="crayon-e">FCFDFFFF&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">AL</span><span class="crayon-sy">,</span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>+<span class="crayon-i">EDX</span>-<span class="crayon-cn">204</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">AL </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-e">of </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-i">offset</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-24"><span class="crayon-cn">001F0517</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8845</span><span class="crayon-h"> </span><span class="crayon-e">F7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">9</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">AL</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Store </span><span class="crayon-e">original </span><span class="crayon-e">value </span><span class="crayon-e">on </span><span class="crayon-i">stack</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-25"><span class="crayon-cn">001F051A</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B4D</span><span class="crayon-h"> </span><span class="crayon-e">F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">ECX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">ECX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-i">value</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-26"><span class="crayon-cn">001F051D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B55</span><span class="crayon-h"> </span><span class="crayon-e">EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">EDX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">14</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">Copy</span><span class="crayon-h"> </span><span class="crayon-s">"old"</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-i">EDX</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-27"><span class="crayon-cn">001F0520</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8A8415</span><span class="crayon-h"> </span><span class="crayon-e">FCFDFFFF&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">AL</span><span class="crayon-sy">,</span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>+<span class="crayon-i">EDX</span>-<span class="crayon-cn">204</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">AL </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-e">of </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-i">offset</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">old </span><span class="crayon-i">value</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-28"><span class="crayon-cn">001F0527</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">88840D</span><span class="crayon-h"> </span><span class="crayon-e">FCFDFFFF&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>+<span class="crayon-i">ECX</span>-<span class="crayon-cn">204</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">AL</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">first </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-i">value</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-29"><span class="crayon-cn">001F052E</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8B4D</span><span class="crayon-h"> </span><span class="crayon-e">EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">ECX</span><span class="crayon-sy">,</span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">14</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">ECX </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-i">value</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-30"><span class="crayon-cn">001F0531</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8A55</span><span class="crayon-h"> </span><span class="crayon-e">F7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-i">DL</span><span class="crayon-sy">,</span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>-<span class="crayon-cn">9</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">Copy</span><span class="crayon-h"> </span><span class="crayon-s">"old"</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-e">from </span><span class="crayon-i">stack</span></div><div class="crayon-line" id="crayon-67e61f14cfc41451323188-31"><span class="crayon-cn">001F0534</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">88940D</span><span class="crayon-h"> </span><span class="crayon-e">FCFDFFFF&nbsp;&nbsp; </span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">EBP</span>+<span class="crayon-i">ECX</span>-<span class="crayon-cn">204</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">DL</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-e">second </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">old </span><span class="crayon-i">value</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc41451323188-32"><span class="crayon-cn">001F053B</span><span class="crayon-h">&nbsp;&nbsp; </span>^<span class="crayon-h"> </span><span class="crayon-i">EB</span><span class="crayon-h"> </span><span class="crayon-cn">8D</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-cn">001F04CA</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Next </span><span class="crayon-i">iteration</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>In this case, there are two arrays, the S-box built on the stack and another 16-byte “key” array found at 0x455 into the new shellcode. This key array is used to modify values throughout the KSA. Effectively, it takes the counter and uses 0x10 to calculate its modulo, afterwards this is used as an index into the key array. The dereferenced value found at the index is added to the “final” value from the previous iteration. In the case of the first iteration, this “final” value will be zero. Once those two values are added together, it will add the counter value to the sum and use 0x100 to calculate its modulo, becoming the new “final” value for the next iteration.<br />
After completing that equation, it takes the “final” value as an index in the 256-byte S-box array and swaps the dereferenced value with the dereferenced value found at the index in the first array using the counter. This is the RC4 KSA in a nut shell.<br />
Here is an example of this on iteration 0x14 in the loop, after some of the data has been modified already. You can see that after 0xC6, at offset 0x13, there are incrementing values: 0x14, 0x15, 0x16, 0x17, etc.<br />
<img  class="aligncenter wp-image-64765 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor2-1.png" alt="hancitor2" width="600" height="102" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor2-1.png 738w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor2-1-300x51.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor2-1-370x63.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;<br />
&nbsp;<br />
For value 0x14, it retrieves the modulus of 0x4 by using 0x10 for the calculation, which is then used to find the additive value in the key array. The value at key[4] is 0x5D and this is added to the previous “final” value, 0xC6, which can be seen at offset 0x13.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc44350026936" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
0x5D + 0xC6 = 0x123</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc44350026936-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc44350026936-1"><span class="crayon-cn">0x5D</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">0xC6</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x123</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Next, it uses the counter as an index and dereferences the value to add into the equation. For the first couple of runs, the dereferenced value equates to the counter, but eventually these begin to overwrite and the values change accordingly.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc46812754445" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
0x123 + 0x14 = 0x137 % 0x100 = 0x37</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc46812754445-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc46812754445-1"><span class="crayon-cn">0x123</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">0x14</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x137</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x37</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now the values at sbox1[0x37] and sbox1[0x14] are swapped, as can be seen below.<br />
&nbsp;<br />
<img  class="aligncenter wp-image-64804 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor3-1.png" alt="hancitor3" width="600" height="95" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor3-1.png 736w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor3-1-300x47.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor3-1-370x58.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;<br />
&nbsp;<br />
On the next iteration, with the key value being 0x53, it would look like this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc48729723519" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(0x53 + 0x37 + 0x15) % 0x100 = 0x9F</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc48729723519-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc48729723519-1"><span class="crayon-sy">(</span><span class="crayon-cn">0x53</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">0x37</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">0x15</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x9F</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The values at sbox1[0x9F] and sbox1[0x15] would be swapped.<br />
You’ll see that at offset 0x1A in the example output above, the value is 0xC. On iteration 0x1A then, 0xC will be the value added to the key and the previous “final” value. This happens for 256 iterations and every value gets shifted around from its original starting point. Talos has a nice <a href="https://blog.talosintelligence.com/2014/06/an-introduction-to-recognizing-and.html">blog</a> from 2014 that talks about S-box creation in malware and the <a href="https://en.wikipedia.org/wiki/RC4">RC4 entry on Wikipedia</a> has a succinct overview as well.<br />
I’ve recreated the logic shown previously Python as it may be easier to illustrate it with code.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc49603677080" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def sbox1init():
    return [x for x in range(0, 0x100)]
def rc4ksa(sbox1, key):
    oldValue = 0x0
    for counter in range(0, len(sbox1)):
        addValue = key[counter % len(key)]
        fnlValue = (oldValue + addValue + sbox1[counter]) % 0x100
        sbox1[fnlValue], sbox1[counter] = sbox1[counter], sbox1[fnlValue]
        oldValue = fnlValue
    return sbox1
key = [0x82, 0xEF, 0x3D, 0x3C, 0x5D, 0x53, 0xC8, 0xE8, 0x51, 0x8D, 0xFB, 0xD9, 0xD0, 0x23, 0x1B, 0x14]
sbox1 = rc4ksa(sbox1init(), key)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc49603677080-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc49603677080-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc49603677080-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc49603677080-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc49603677080-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc49603677080-6">6</div><div class="crayon-num" data-line="crayon-67e61f14cfc49603677080-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc49603677080-8">8</div><div class="crayon-num" data-line="crayon-67e61f14cfc49603677080-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc49603677080-10">10</div><div class="crayon-num" data-line="crayon-67e61f14cfc49603677080-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc49603677080-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc49603677080-1"><span class="crayon-e">def </span><span class="crayon-e">sbox1init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc49603677080-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc49603677080-3"><span class="crayon-e">def </span><span class="crayon-e">rc4ksa</span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc49603677080-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x0</span></div><div class="crayon-line" id="crayon-67e61f14cfc49603677080-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc49603677080-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">addValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">key</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc49603677080-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">fnlValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">addValue</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc49603677080-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc49603677080-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">fnlValue</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc49603677080-10"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sbox1</span></div><div class="crayon-line" id="crayon-67e61f14cfc49603677080-11"><span class="crayon-i">key</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0x82</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xEF</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x3D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x3C</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x5D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xC8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xE8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x51</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x8D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xFB</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xD9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xD0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x23</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x1B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x14</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc49603677080-12"><span class="crayon-i">sbox1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">rc4ksa</span><span class="crayon-sy">(</span><span class="crayon-e">sbox1init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>In the Python codes first iteration, where the value in sbox1[0x0] is 0x00 and key[0x0] is 0x82, you would add 0x0 to 0x82 to 0x0 (the value at sbox1[counter]) and divide by 0x100. The remainder, 0x82, would then be placed in sbox1[0x0] and the value which was at sbox1[0x0] would be swapped into sbox1[0x82]. There are a lot of <a href="https://en.wikipedia.org/wiki/RC4">cleaner examples of code</a> available online for the RC4 KSA but for the sake of learning, along with making sure that if there were any errors introduced by the malware authors, I created everything based on their logic used.<br />
&nbsp;<br />
<span style="font-size: 18pt;">RC4 PRGA</span><br />
The RC4 PRGA is used within the main unpacking loop specifically to generate a keystream value but how that value is used is where the malware author begins to diverge from RC4.<br />
I’ll briefly cover PRGA and then move onto the parent unpacking loop, which will make reference back to this algorithm.<br />
Using a loop counter as an index into the original S-box, PRGA will dereference the value at sbox1[counter] and add it to the previous keystream value to create the second index. These values will then get swapped around in the S-box, similar to how the KSA does it. Finally, it will retrieve the value at sbox1[counter] and sbox1[secondIndex], add them together, and then use them in a modulo calculation with 0x100 to generate the new keystream value.<br />
For example, the first byte referenced (counter starting at 0x1 in this case) is sbox1[0x1], which is 0x7 after completing the KSA. The value at sbox1[0x7] is 0xA6 and they swap values so that sbox1[0x1] is 0xA6 and the value at sbox1[0x7] is 0x7. It then adds 0xA6 to 0x7 to make 0xAD and takes the dereferenced value at sbox1[0xAD], in this case 0x58, as the keystream value.<br />
Now, at this point, in regular RC4, the new keystream value would be used in an XOR operation to decode or encode a byte of ciphertext or plaintext. As you can guess, that is not the case with this malware.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Offset Table</span><br />
Taking a step back, once the S-box generation is complete, the next step is to allocate two more regions of memory. It fills the first region, again, with incrementing values until it hits 0x5C36 but this time each value is a DWORD instead of a singular byte. This region will show itself to be yet another S-box in function.<br />
Next, it launches into the main unpacking loop, which is the meat of the operation. On each iteration of this loop, it will use an inner-loop (the previously detailed RC4 PRGA) to retrieve a keystream byte – performed four times each parent loop iteration.<br />
After obtaining the four bytes of keystream values, it will combine them into a DWORD and use it in a modulo calculation with the loop counter from the parent loop, decrementing by one each iteration from the length of the data (0x5C36).<br />
For example, the first four bytes of keystream values are 0x58, 0x58, 0xF2, and 0xEA, which is combined to form 0xEAF25858.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc4c286998807" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
0xEAF25858 % 0x5C36 = 0x5200</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc4c286998807-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc4c286998807-1"><span class="crayon-cn">0xEAF25858</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x5C36</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x5200</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>It takes the result of this operation and uses it as an index into the second S-Box of DWORD’s. Next, it takes the dereferenced value found at the index and stores it in the third memory region, incrementing by an offset of 4 each time. Finally, it swaps the dereferenced values in the second memory region with the value found at the index into the second S-box.<br />
In this case, the first DWORD in the third memory region will be 0x5200. It swaps the dereferenced values in the second memory region with the counter value so the value at the offset for 0x5200 will become 0x5C35 (decremented by 4 bytes) and the value found at the offset for 0x5C35 will be 0x5200.<br />
This process continues until the parent loop finishes and, once complete, it will allocate another memory region wherein it copies 0x5C36 bytes from address 0x401000 in the main program.<br />
Alright, if you’ve stuck with me this long, what I want to convey is that all of the above is to create an elaborate table of DWORD offsets, used as indexes, that define how the data will be unshuffled, which is finally what happens next.<br />
For each byte in the new memory region, which is the data just copied from address range 0x401000-0x406C36, it will add the corresponding DWORD value for the respective iteration to the base of 0x401000 and copy that byte over. As a reminder, the data being copied at this point is the same data initially moved into position by the first three memcpy() calls.<br />
The first DWORD in the third memory region is 0x5200, as discussed previously, and the first byte at 0x401000 is 0x8B, thus at 0x406200 (0x401000 + 0x5200) the value 0x8B will be placed. At no point are any of the bytes manipulated, as would be standard in an RC4 implementation, but instead are just rearranged into their respective order.<br />
To help illustrate with code, below is the full implementation of the algorithm in Python. To save space, I’ve removed the data but this is available in full on <a href="https://github.com/pan-unit42/public_tools/blob/master/hancitor/hancitor_offsetgen.py">GitHub</a> if you want to review further.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67e61f14cfc4e897526767" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def sbox1init():
    return [x for x in range(0, 0x100)]
def sbox2init():
    return [x for x in range(0, 0x5C36)]
def rc4ksa(sbox1, key):
    oldValue = 0x0
    for counter in range(0, len(sbox1)):
        addValue = key[counter % len(key)]
        fnlValue = (oldValue + addValue + sbox1[counter]) % 0x100
        sbox1[fnlValue], sbox1[counter] = sbox1[counter], sbox1[fnlValue]
        oldValue = fnlValue
    return sbox1
def offsetGen(sbox1, sbox2):
    offsetTable = []
    innerCount = 1
    oldValue = 0x0
    for counter in range(len(sbox2), 0, -1):
        fnlValue = ""
        for x in range(0, 4):
            innerIdx = innerCount % len(sbox1)
            oldValue = (sbox1[innerIdx] + oldValue) % 0x100
            addValue = (sbox1[oldValue] + sbox1[innerIdx]) % 0x100
            sbox1[innerIdx], sbox1[oldValue] = sbox1[oldValue], sbox1[innerIdx]
            fnlValue = "%02X" % sbox1[addValue] + fnlValue
            innerCount += 1
        fnlValue = int(fnlValue, 16) % counter
        offsetTable.append(sbox2[fnlValue])
        sbox2[fnlValue], sbox2[counter-1] = sbox2[counter-1], sbox2[fnlValue]
    return offsetTable
def unshuffle(data, offsetTable):
    unshuffle = [0x0] * len(offsetTable)
    data = [data[x:x+2] for x in range(0, len(data), 2)]
    for counter, entry in enumerate(offsetTable):
        unshuffle[entry] = chr(int(data[counter], 16))
    return "".join(unshuffle)
key = [0x82, 0xEF, 0x3D, 0x3C, 0x5D, 0x53, 0xC8, 0xE8, 0x51, 0x8D, 0xFB, 0xD9, 0xD0, 0x23, 0x1B, 0x14]
data = ""
offsetTable = offsetGen(rc4ksa(sbox1init(), key), sbox2init())
data = unshuffle(data, offsetTable)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-2">2</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-4">4</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-6">6</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-8">8</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-10">10</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-12">12</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-14">14</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-16">16</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-18">18</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-20">20</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-22">22</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-24">24</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-26">26</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-28">28</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-30">30</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-32">32</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-34">34</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-36">36</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-67e61f14cfc4e897526767-38">38</div><div class="crayon-num" data-line="crayon-67e61f14cfc4e897526767-39">39</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-1"><span class="crayon-e">def </span><span class="crayon-e">sbox1init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-3"><span class="crayon-e">def </span><span class="crayon-e">sbox2init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x5C36</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-5"><span class="crayon-e">def </span><span class="crayon-e">rc4ksa</span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x0</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">addValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">key</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">fnlValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">addValue</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">fnlValue</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-12"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sbox1</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-13"><span class="crayon-e">def </span><span class="crayon-e">offsetGen</span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox2</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">offsetTable</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">innerCount</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x0</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">counter </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">sbox2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>-<span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">fnlValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">innerIdx</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">innerCount</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">oldValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">innerIdx</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">oldValue</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">addValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">oldValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">innerIdx</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">innerIdx</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">oldValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">oldValue</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">innerIdx</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">fnlValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"%02X"</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-i">sbox1</span><span class="crayon-sy">[</span><span class="crayon-i">addValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">fnlValue</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-25"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">innerCount</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">fnlValue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-e">counter</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-27"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">offsetTable</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-i">sbox2</span><span class="crayon-sy">[</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">sbox2</span><span class="crayon-sy">[</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox2</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span>-<span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">sbox2</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span>-<span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sbox2</span><span class="crayon-sy">[</span><span class="crayon-i">fnlValue</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">offsetTable</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-30"><span class="crayon-e">def </span><span class="crayon-e">unshuffle</span><span class="crayon-sy">(</span><span class="crayon-i">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">offsetTable</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">unshuffle</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0x0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">offsetTable</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">data</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">data</span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-sy">:</span><span class="crayon-i">x</span>+<span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">data</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">counter</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">entry </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-i">offsetTable</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">unshuffle</span><span class="crayon-sy">[</span><span class="crayon-i">entry</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-i">data</span><span class="crayon-sy">[</span><span class="crayon-i">counter</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-i">unshuffle</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-36"><span class="crayon-i">key</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0x82</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xEF</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x3D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x3C</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x5D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xC8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xE8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x51</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x8D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xFB</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xD9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xD0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x23</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x1B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x14</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-37"><span class="crayon-i">data</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-67e61f14cfc4e897526767-38"><span class="crayon-i">offsetTable</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">offsetGen</span><span class="crayon-sy">(</span><span class="crayon-e">rc4ksa</span><span class="crayon-sy">(</span><span class="crayon-e">sbox1init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">sbox2init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67e61f14cfc4e897526767-39"><span class="crayon-i">data</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">unshuffle</span><span class="crayon-sy">(</span><span class="crayon-i">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">offsetTable</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Thus, concludes the unpacking algorithm. You’ll see familiar strings for the actual Hancitor malware once it finishes.<br />
&nbsp;<br />
<img  class="aligncenter wp-image-64843 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor4.png" alt="hancitor4" width="600" height="144" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor4.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor4-900x216.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor4-300x72.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor4-768x185.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor4-370x89.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;<br />
&nbsp;<br />
<span style="font-size: 18pt;">Hancitor</span><br />
Before execution shifts back to the main program, they use more anti-debugging tricks by calling the OutputDebugStringA() function to check whether or not the program is being debugged. Once that check is passed, it will begin executing the code found at 0x404000.<br />
I won’t spend too much time on the functionality of Hancitor as it has been blogged about endlessly but this is what this particular sample will do.</p>
<ul>
<li>Get OS version</li>
<li>Get adapter address</li>
<li>Get Windows directory</li>
<li>Get volume information</li>
<li>Check external IP with api[.]ipify[.]org</li>
</ul>
<p>Once it has the information it needs, depending on whether you’re running on x86 or x64 architecture, it formats the following string used in the initial POST to the Hancitor gate.<br />
<img  class="aligncenter wp-image-64882 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor5.png" alt="hancitor5" width="600" height="58" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor5.png 970w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor5-900x86.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor5-300x29.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor5-768x74.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor5-370x35.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;<br />
&nbsp;<br />
After filling it out it will look similar to the below.<br />
<img  class="aligncenter wp-image-64921 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor6.png" alt="hancitor6" width="600" height="120" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor6.png 976w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor6-900x181.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor6-300x60.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor6-768x154.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor6-370x74.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
<span style="font-size: 18pt;">Gates</span><br />
Going back to the entire reason I even delved into this was that I’ve maintained a <a href="https://github.com/pan-unit42/public_tools/blob/master/hancitor/h_decrypt.py">Hancitor decoder</a> for the past two years and, with each new variant, I try to find a way to decode out the Hancitor gates so they can quickly be identified and blocked. This variant, even after all of the above unpacking, still left me in the dark as to where the gates were.<br />
To figure that out, we have to look a bit further into the code. At the address 0x402B51 in the unpacked shellcode we’ll find a series of Windows decryption calls that take a blob of encrypted data, decrypt it, and reveal the Hancitor gate URL’s and campaign code.</p>
<ul>
<li>CryptAcquireContextA</li>
<li>CryptCreasteHash</li>
<li>CryptHashData</li>
<li>CryptDeriveKey</li>
<li>CryptDecrypt</li>
<li>CryptDestroyHash</li>
<li>CryptDestroyKey</li>
</ul>
<p>The algorithm in use here is SHA1 hashing with actual RC4 encryption. It uses an 8-byte value (0xAAE8678C261EC5DB) to derive the SHA1 key and then decrypts 0x2000 bytes.<br />
&nbsp;<br />
<img  class="aligncenter wp-image-64960 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor7.png" alt="hancitor7" width="600" height="116" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor7.png 970w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor7-900x174.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor7-300x58.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor7-768x148.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/hancitor7-370x71.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;<br />
&nbsp;<br />
The first entry is the campaign code which correlates to the date the campaign was ran on, in this case January 24<sup>th</sup>, subsequently followed by the three Hancitor gates.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Conclusion</span><br />
While Hancitor continues to evolve, they stick to a fairly strict playbook. This sample diverged from that playbook quite heavily but only saw usage in one campaign before they reverted back to other, older, variants. This may be due to the way it’s packed being detected more frequently or some other unknown reason that caused a drop in their infection rates that prompted removing it. Either way, it’s important to continue tracking their operation and documenting new techniques and tactics used by this adversary.<br />
Palo Alto Networks customers are protected from Hancitor by WildFire and Traps. This threat can be tracked within AutoFocus by using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Hancitor">Hancitor</a> tag.<br />
&nbsp;<br />
<span style="font-size: 18pt;">IOCs</span><br />
Hancitor Gates</p>
<ul>
<li>hxxp://naveundpa[.]com/ls5/forum[.]php</li>
<li>hxxp://undronride[.]ru/ls5/forum[.]php</li>
<li>hxxp://dingparjushis[.]ru/ls5/forum[.]php</li>
</ul>
<p>User-Agent</p>
<ul>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0) like Gecko</li>
</ul>
      
              </div>
              <!--<span class="post__date">Updated 27 February, 2018 at 5:00 AM PST</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/hancitor/" role="link" title="hancitor" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:tags:hancitor">Hancitor</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/unit42-rig-ek-one-year-later-from-ransomware-to-coin-miners-and-information-stealers/" role="link" title="Rig EK One Year Later: From Ransomware to Coin Miners and Information Stealers" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:article-nav:Rig EK One Year Later: From Ransomware to Coin Miners and Information Stealers"> 
            <span>Next: Rig EK One Year Later: From Ransomware to Coin Miners and Information Stealers</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/wireshark-tutorial-hancitor-followup-malware/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:sidebar:related-articles:Wireshark Tutorial: Examining Traffic from Hancitor Infections">
                      Wireshark Tutorial: Examining Traffic from Hancitor Infections                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/hancitor-infections-cobalt-strike/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:sidebar:related-articles:Hancitor’s Use of Cobalt Strike and a Noisy Network Ping Tool">
                      Hancitor’s Use of Cobalt Strike and a Noisy Network Ping Tool                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/unit42-traps-prevents-adobe-flash-player-zero-day/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:sidebar:related-articles:Traps Prevents Adobe Flash Player Zero-Day">
                      Traps Prevents Adobe Flash Player Zero-Day                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related  Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of unusual malware. A glowing pink warning triangle with an exclamation point on a screen with the word &quot;malware.&quot; There are other text elements on the screen suggesting a coding environment. The colors are neon blue and pink." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Off the Beaten Path: Recent Unusual Malware:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-14T10:00:04+00:00">March 14, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/unusual-malware/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Off the Beaten Path: Recent Unusual Malware">
                    <h4 class="post-title">Off the Beaten Path: Recent Unusual Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/net/" title=".NET" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Off the Beaten Path: Recent Unusual Malware:.NET">.NET</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Off the Beaten Path: Recent Unusual Malware:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/c/" title="C++" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Off the Beaten Path: Recent Unusual Malware:C++">C++</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/unusual-malware/" title="Off the Beaten Path: Recent Unusual Malware" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Off the Beaten Path: Recent Unusual Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of scam crypto investment platforms. A digital image featuring glowing numerical data and key cybersecurity terms like &quot;Crime,&quot; &quot;Hackers,&quot; and &quot;Security&quot; highlighted across a dark, abstract background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-13T10:00:21+00:00">March 13, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/fraud-crypto-platforms-campaign/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims">
                    <h4 class="post-title">Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/scams/" title="Scams" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Scams">Scams</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/phishing/" title="phishing" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:phishing">Phishing</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Cryptocurrency">Cryptocurrency</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fraud-crypto-platforms-campaign/" title="Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of popular malware families like Agent Tesla, XWorm and FormBook/XLoader. A blurred image of a person in a dynamic coding environment, with visible code on screens and colorful lighting predominantly in blue and pink tones. The scene suggests an intense focus on technology and software development." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-03T11:00:19+00:00">March 3, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/malware-obfuscation-techniques/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization">
                    <h4 class="post-title">Uncovering .NET Malware Obfuscated by Encryption and Virtualization</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/net/" title=".NET" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:.NET">.NET</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/agenttesla/" title="AgentTesla" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:AgentTesla">AgentTesla</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/anti-analysis/" title="anti-analysis" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:anti-analysis">Anti-analysis</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/malware-obfuscation-techniques/" title="Uncovering .NET Malware Obfuscated by Encryption and Virtualization" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-786x368.jpg" class="lozad" alt="A pictorial representation of Squidoor. A vivid display of multiple monitors showing graphics and text related to a cyber attack, featuring skull symbols and digital distortions." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-27T11:00:15+00:00">February 27, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/advanced-backdoor-squidoor/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations">
                    <h4 class="post-title">Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/web-shells/" title="web shells" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:web shells">Web shells</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/advanced-backdoor-squidoor/" title="Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of Koi Stealer and RustDoor. Digital code in various shades of blue on a black background in the shape of a skull." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-26T11:00:59+00:00">February 26, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/macos-malware-targets-crypto-sector/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector">
                    <h4 class="post-title">RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:macOS">MacOS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/infostealer/" title="Infostealer" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Infostealer">Infostealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/contagious-interview/" title="Contagious Interview" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Contagious Interview">Contagious Interview</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/macos-malware-targets-crypto-sector/" title="RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of new Linux malware Auto-color. Close-up view of a circuit board with illuminated red data streams and microchips, symbolizing advanced digital technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-24T23:00:52+00:00">February 24, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/new-linux-backdoor-auto-color/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor">
                    <h4 class="post-title">Auto-Color: An Emerging and Evasive Linux Backdoor</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/linux/" title="Linux" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:Linux">Linux</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:backdoor">Backdoor</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/new-linux-backdoor-auto-color/" title="Auto-Color: An Emerging and Evasive Linux Backdoor" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="292" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-786x292.png" class="lozad" alt="Pictorial representation of APT Stately Taurus. The silhouette of a bull and the Taurus constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-786x292.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-768x285.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-1536x570.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1.png 1616w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2025-02-20T11:00:23+00:00">February 20, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-uses-bookworm-malware/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware">
                    <h4 class="post-title">Stately Taurus Activity in Southeast Asia Links to Bookworm Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/stately-taurus/" title="Stately Taurus" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Stately Taurus">Stately Taurus</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/bookworm/" title="Bookworm" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Bookworm">Bookworm</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-uses-bookworm-malware/" title="Stately Taurus Activity in Southeast Asia Links to Bookworm Malware" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of macOS infostealers. Laptop on a desk displaying advanced cybersecurity software interface with vibrant red graphics, in a dimly lit room." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-04T11:00:12+00:00">February 4, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/macos-stealers-growing/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat">
                    <h4 class="post-title">Stealers on the Rise: A Closer Look at a Growing macOS Threat</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:macOS">MacOS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/infostealer/" title="Infostealer" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:Infostealer">Infostealer</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/macos-stealers-growing/" title="Stealers on the Rise: A Closer Look at a Growing macOS Threat" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-786x368.jpg" class="lozad" alt="Digital representation of jailbreaking DeepSeek. A dynamic, multicolored wave pattern with luminous particles, set against a dark background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-01-30T21:30:36+00:00">January 30, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/jailbreaking-deepseek-three-techniques/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek">
                    <h4 class="post-title">Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/llm/" title="LLM" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:LLM">LLM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/jailbroken/" title="jailbroken" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:jailbroken">Jailbroken</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/genai/" title="GenAI" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:GenAI">GenAI</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/jailbreaking-deepseek-three-techniques/" title="Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of an espionage operation against high-value targets in South Asia. Digital artwork featuring an abstract blend of vibrant blue, pink, and black colors with fragments of HTML code visible, creating a dynamic and modern visual effect against a glitch effect photo of someone typing on a keyboard." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-01-29T23:00:17+00:00">January 29, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities/" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia">
                    <h4 class="post-title">CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:China">China</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cobalt-strike/" title="Cobalt Strike" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Cobalt Strike">Cobalt Strike</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mimikatz/" title="Mimikatz" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Mimikatz">Mimikatz</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities/" title="CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia" role="link" data-page-track="true" data-page-track-value="unit42-dissecting-hancitors-latest-2018-packer:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			                 <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->
<link id="criticalTop-css" rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/dynamicComponents/mainFooterComp/clientlibs/panClean/criticalTop.min.css" >
<link id="defered-css" rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/dynamicComponents/mainFooterComp/clientlibs/panClean/defered.min.css">
<style type="text/css">
	
 .language-nav {
/*     padding: 12px 0; */
    transition: padding-top 0.25s ease-in-out;
    will-change: padding-top;
  }
  @media (min-width: 768px) {
     .language-nav {
      position: absolute;
      right: 4.5rem;
    }
  }
   .language-nav .language-btn {
    border: 1px solid #FFFFFF;
    padding: 10px 10px 10px 5px;
    color: #FFFFFF;
    font-weight: 600;
    border-radius: 30px;
    width: 100%;
    justify-content: space-between;
	font-family: TTHoves, Arial;
  }
  @media (min-width: 576px) {
     .language-nav .language-btn {
      width: fit-content;
      justify-content: flex-start;
    }
  }
   .language-nav .language-btn:hover {
    text-decoration: none;
  }
   .language-nav .language-btn .icon-globe,
   .language-nav .language-btn .icon-down {
    padding: 0 0.5rem;
    cursor: pointer;
	display: flex;
    align-items: center;
  }
   .language-nav .language-btn .icon-down::before {
    content: "";
/*     background: url("../images/icons/icon-globe.svg"); */
    width: 1rem;
    height: 1rem;
    background-repeat: no-repeat;
    display: inline-block;
    transition: transform 0.25s;
  }
   .language-nav .language-btn .icon-down::before {
    background: url("https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/chevron-down-white.svg");
    height: 0.5rem;
    background-position: center;
  }
   .language-nav .language-btn.expand .icon-down::before {
    transform: rotate(-180deg);
  }
   .language-nav .language-btn span {
    pointer-events: none;
  }
   .language-nav .language-dropdown {
    display: none;
    position: absolute;
    top: 45px;
    right: 0px;
    width: 100%;
    padding: 25px;
    background-color: #fff;
    box-shadow: 0px 0px 10px 5px rgba(0, 0, 0, 0.15);
  }
  @media (min-width: 575px) {
     .language-nav .language-dropdown {
      width: 480px;
    }
  }
   .language-nav .language-dropdown.expand {
    display: block;
    z-index: 3;
  }
   .language-nav .language-dropdown ul {
    margin: 0;
    padding: 0;
    gap: 10px;
    justify-content: flex-start;
  }
   .language-nav .language-dropdown ul li {
    padding: 0;
    flex: 0 0 100%;
	font-family: TTHoves, Arial;
  }
  @media (min-width: 768px) {
     .language-nav .language-dropdown ul li {
      flex: 0 0 calc(50% - 5px);
    }
  }
   .language-nav .language-dropdown ul li::before {
    content: none !important;
  }
   .language-nav .language-dropdown ul li.active a {
	  background: linear-gradient(90deg, #ff2314 0%, #fa582d 100.33%);
	  font-weight: 600;
	  color: #000;
  }
   .language-nav .language-dropdown ul li a {
    width: 100%;
    display: inline-block;
    color: inherit;
    padding: 15px 10px;
    text-align: center;
    background-color: #f4f4f2;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 400;
    line-height: 100%;
  }
   .language-nav .language-dropdown ul li a:hover {
    text-decoration: none;
    background: linear-gradient(90deg, rgba(255, 35, 20, 0.7) 0%, rgba(255, 35, 20, 0.7) 100.33%);
    color: #000;
    font-weight: 600;
  }
	@media(max-width:767.98px){
		.language-nav {
			position:static;
    		padding: 12px 0 18px 0px;
		}
		.language-nav .language-dropdown {
			right:0px;
			top: 80px;
		}
	}
	@media (min-width: 1920px) {
		.language-nav {
			right: 9.5rem;
		}
	}
@media (min-width: 1400px) {
    .mainFooterComp .col-xxl-8 {
        flex: 0 0 66.66667%;
        max-width: 66.66667%;
    }
    .mainFooterComp .col-xxl-4 {
        flex: 0 0 33.33333%;
        max-width: 33.33333%;
    }
	 .mainFooterComp .col-xxl-2 {
        flex: 0 0 16.66667%;
        max-width: 16.66667%;
    }
}
/*PANW Nav dropdown*/
.dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent} 
    .mainFooterComp {
    background-color: #fff;
}
.cleanDynamicFooter{
    margin-top: 0px;
}
.mainFooterComp .h1,.mainFooterComp .h2, .mainFooterComp .h3, .mainFooterComp .h4, .mainFooterComp .h5, .mainFooterComp .h6, .mainFooterComp h1, .mainFooterComp h2, .mainFooterComp  h3, .mainFooterComp  h4, .mainFooterComp  h5, .mainFooterComp  h6{
    color: #000;
}
.text-white, .text-dark {
    color: #fff !important;
}
.text-black, .text-light {
    color: #141414 !important;
}
.body-serif-1, .body-serif-2, .body-serif-3, .body-serif-4, .body-serif-5 {
    font-family: CelestePro, Georgia, serif;
    color: #141414;
    line-height: 120%;
}
.body-serif-1, .body-serif-2 {
    font-size: 1rem;
}
.label-3 {
    font-family: TTHoves, Arial;
    color: #141414;
    font-weight: 600;
    font-size: 0.75rem;
    line-height: 140%;
}
.text-400 {
    font-weight: 400;
}
.list-item {
    font-family: CelestePro, Georgia, serif;
    color: #141414;
    font-weight: 400;
    font-size: 1rem;
    line-height: 150%;
}
.nav-headline, .nav-subheader, .nav-list {
    font-family: TTHoves, Arial;
    color: #141414;
    line-height: 140%;
    letter-spacing: .02rem;
}
.nav-headline {
    font-size: 1rem;
    font-weight: 600;
}
.nav-subheader, .nav-list {
    font-size: 0.75rem;
}
.nav-subheader {
    font-weight: 600;
}
.nav-list {
    font-weight: 500;
}
@media (min-width: 768px) {
    .label-3 {
        font-size: 0.75rem;
   }
    .nav-headline {
        font-size: 1rem;
   }
    .nav-subheader, .nav-list {
        font-size: 0.75rem;
   }
}
@media (min-width: 992px) {
    .label-3 {
        font-size: 0.775rem;
   }
    .nav-headline {
        font-size: 1.025rem;
   }
    .nav-subheader, .nav-list {
        font-size: 0.775rem;
   }
    .body-serif-1 {
        font-size: 1.1rem;
   }
}
@media (min-width: 1200px) {
    .label-3 {
        font-size: 0.8rem;
   }
    .nav-headline {
        font-size: 1.05rem;
   }
    .nav-subheader, .nav-list {
        font-size: 0.8rem;
   }
    .body-serif-1, .body-serif-2, .body-serif-3, .body-serif-4, .body-serif-5 {
        line-height: 150%;
   }
    .body-serif-1 {
        font-size: 1.2rem;
   }
}
@media (min-width: 1400px) {
    .label-3 {
        font-size: 0.825rem;
   }
    .nav-headline {
        font-size: 1.075rem;
   }
    .nav-subheader, .nav-list {
        font-size: 0.825rem;
   }
    .body-serif-1 {
        font-size: 1.3rem;
   }
}
@media (min-width: 1600px) {
    .label-3 {
        font-size: 0.85rem;
   }
    .nav-headline {
        font-size: 1.1rem;
   }
    .nav-subheader, .nav-list {
        font-size: 0.85rem;
   }
    .body-serif-1 {
        font-size: 1.4rem;
   }
}
@media (min-width: 1920px) {
    .label-3 {
        font-size: 0.875rem;
   }
    .nav-headline {
        font-size: 1.125rem;
   }
    .nav-subheader, .nav-list {
        font-size: 0.875rem;
   }
    .body-serif-1 {
        font-size: 1.5rem;
   }
}

@media (min-width: 576px) {
    .mega-footer .container-fluid,
    .footer-bottom .container-fluid{
        width: auto;
        margin-left: 7.14285714%;
        margin-right: 7.14285714%;
    }
}
@media (max-width: 575.98px) {
    .mega-footer .container-fluid,
    .footer-bottom .container-fluid {
        padding: 0 30px;
    }
}
.cleanDynamicFooter .dropdown .btn-language{
    height: auto;
    color: #141414;
}  
.cleanDynamicFooter .h8{
    font-family: TT Hoves, Arial, "Helvetica Neue", Helvetica, sans-serif;
    font-weight: 500;
    color: #141414;
    padding-bottom: .5rem !important;
    font-size: 1rem;
    line-height: 140%;
}   
.mainFooterComp h2{
    color: #141414;
}
.mainFooterComp .text-black, 
.mainFooterComp a.text-black:focus,
.mainFooterComp a.text-black:hover,
.mainFooterComp button.text-black:focus,
.mainFooterComp button.text-black:hover{
    color: #141414;
}
.footer-bottom ul{
    margin-bottom: 1rem;
} 
</style>
<script type="text/javascript">
	$(document).ready(function(){
		$("html").on("click", ".language-btn", function () {
			$(this).toggleClass("expand");
			$(".language-dropdown").toggleClass("expand");
		});

		$("html").on("click", "body", function (b) {
			if (!$(b.target).is(".language-btn")) {
				$(".language-btn").removeClass("expand");
				$(".language-dropdown").removeClass("expand");
			}
		});
	});
</script>
<div class="cleanDynamicFooter mainFooterComp baseComponent parbase">   
<!-- custom spacing -->





<a class="page-anchor" name="footer"></a>




<section class="lozad-background footer-form" style="" data-background-image=" url('\2f etc\2f clientlibs\2f clean\2fimgs\2f 2023\2f footer-form-bg.svg')">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 col-md-4 col-xl-6">
                <h2 class="h4 form-title text-white mb-0">Get the latest news, invites to events, and threat alerts</h2>
            </div>
            <div class="col-12 col-md-8 col-xl-6 col-xxxl-5 offset-xxxl-1">
                <form id="footer_form_manage_subscriptions" name="footer_form_manage_subscriptions" class="form d-flex flex-wrap" action="/apps/pan/public/formsubmithandler.submitform.json" method="POST" novalidate data-lang="en_US">
                    
                    <input type="hidden" name="mktoOptIn" value="true"/>
                    <input type="hidden" name="Qualifying_Campaign__c" value="7010g000001J5shAAC"/>
                    <input type="hidden" name="emailFormMask" value=""/>
                    <input type="hidden" name="Company" id="Company" value=""/>
                    <input type="hidden" name="FormName" value="subscription-all-corp-site-us"/>
                    <input type="hidden" name="formid" value="1086"/>
                    <input type="hidden" name="formVid" value="1086"/>
                    <input type="hidden" name="munchkinId" value="531-OCS-018"/>
                    <input type="hidden" name="programId" value="5373"/>
                    <div class="footer-form-input-container d-flex flex-column">
                        <div class="d-flex">
                            <label class="form-field" aria-label="Enter your email now to subscribe!" for="PAN_FOOTER_EMAIL_FIELD">
                                <span class="sr-only" style="display: none;">Enter your email now to subscribe!</span>
                                <input type="text" name="Email" required class="mb-md-3 body-serif-1 text-white" placeholder="Enter your email now to subscribe!" id="PAN_FOOTER_EMAIL_FIELD" pattern="[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}$"/>
                                <div class="form-validation validation body-serif-4"></div>
                                <div class="validation-icon"></div>
                            </label>
                            <div class="actions d-none d-md-block">
                                
                                    <button type="submit" class="btn btn-primary flex-grow-0 flex-shrink-0 ml-md-4" disabled data-page-track="true" data-page-track-value="en_US:footer:Sign up">Sign up <i></i></button>
                                
                                
                                
                            </div>
                        </div>

                        
                            <div id="PAN_FOOTER_CAPTCHA_HOLDER" class="mb-2 mt-sm-2 mt-xl-0">
                                <div class="g-recaptcha" data-expired-callback="recaptchaExpired" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                            </div>
                        

                        <div class="legal">
                            
                                <p class="label-3 text-400 text-white form-legal">
                            
                            
                                
                                    By submitting this form, you agree to our
                                    <a class="text-white" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="en_us:footer:terms-of-use">Terms of Use</a>
                                    and acknowledge our
                                    <a class="text-white" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="en_us:footer:privacy">Privacy Statement</a>.

                                
                                
                            </p>

                        </div>
                        <div class="mobile-actions d-block d-md-none">
                            
                                <button type="submit" class="btn btn-primary flex-grow-0 flex-shrink-0 ml-0" disabled data-page-track="true" data-page-track-value="en_US:footer:mobile:Sign up">Sign up <i></i></button>
                            
                            
                            
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>
<section class="mega-footer accordion" id="footer_accordion">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 col-md-16 col-xxl-8">
                <div class="heading-col collapsed pr-4 pr-md-0" data-toggle="collapse" data-target="#collapse_col_0">
                    <h2 class="nav-headline mb-0">Products and Services</h2>
                </div>
                <div id="collapse_col_0" class="columns collapse d-md-flex flex-nowrap" data-parent="#footer_accordion">
                    <ul class="list-unstyled nav-list mb-0">
                        <li class="sub-title nav-subheader">
                            <a href="https://www.paloaltonetworks.com/network-security" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-0:network security platform" rel="noopener"> 
                                Network Security Platform
                            </a>
                        </li>
                    
                        <li class="sub-title nav-subheader">
                            <a href="https://www.paloaltonetworks.com/network-security/security-subscriptions" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-1:cloud delivered security services" rel="noopener"> 
                                CLOUD DELIVERED SECURITY SERVICES
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-2:advanced threat prevention" rel="noopener"> 
                                Advanced Threat Prevention
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/advanced-wildfire" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-3:advanced wildfire" rel="noopener"> 
                                Advanced WildFire
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-4:dns security" rel="noopener"> 
                                DNS Security
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-5:data loss prevention" rel="noopener"> 
                                Data Loss Prevention
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-6:iot security" rel="noopener"> 
                                IoT Security
                            </a>
                        </li>
                    
                        <li class="sub-title nav-subheader">
                            <a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-7:next-generation firewalls" rel="noopener"> 
                                Next-Generation Firewalls
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-8:hardware firewalls" rel="noopener"> 
                                Hardware Firewalls
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/software-firewalls" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-9:software firewalls" rel="noopener"> 
                                Software Firewalls
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-10:strata cloud manager" rel="noopener"> 
                                Strata Cloud Manager
                            </a>
                        </li>
                    
                        <li class="sub-title nav-subheader">
                            <a href="https://www.paloaltonetworks.com/sase" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-11:secure access service edge" rel="noopener"> 
                                SECURE ACCESS SERVICE EDGE
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/sase/access" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-12:prisma access" rel="noopener"> 
                                Prisma Access
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/sase/sd-wan" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-13:prisma sd-wan" rel="noopener"> 
                                Prisma SD-WAN
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/sase/adem" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-14:autonomous digital experience management" rel="noopener"> 
                                Autonomous Digital Experience Management
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/sase/next-gen-casb" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-15:cloud access security broker" rel="noopener"> 
                                Cloud Access Security Broker
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/sase/ztna" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-16:zero trust network access" rel="noopener"> 
                                Zero Trust Network Access
                            </a>
                        </li>
                    </ul>
                
                    <ul class="list-unstyled nav-list mb-0">
                        <li class="sub-title nav-subheader">
                            <a href="https://www.paloaltonetworks.com/cortex/cloud" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-0:cloud security" rel="noopener"> 
                                Cloud Security
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/cloud" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-1:cortex cloud" rel="noopener"> 
                                Cortex Cloud
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/prisma/cloud" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-2:prisma cloud" rel="noopener"> 
                                Prisma Cloud
                            </a>
                        </li>
                    </ul>
                
                    <ul class="list-unstyled nav-list mb-0">
                        <li class="sub-title nav-subheader">
                            <a href="https://www.paloaltonetworks.com/cortex" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-0:ai-driven security operations platform" rel="noopener"> 
                                AI-Driven Security Operations Platform
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/cortex-xdr" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-1:cortex xdr" rel="noopener"> 
                                Cortex XDR
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-2:cortex xsoar" rel="noopener"> 
                                Cortex XSOAR
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-3:cortex xpanse" rel="noopener"> 
                                Cortex Xpanse
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-4:cortex xsiam" rel="noopener"> 
                                Cortex XSIAM
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-5:external attack surface protection" rel="noopener"> 
                                External Attack Surface Protection
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/security-operations-automation" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-6:security automation" rel="noopener"> 
                                Security Automation
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cortex/detection-and-response" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-7:threat prevention detection &amp;amp; response" rel="noopener"> 
                                Threat Prevention, Detection &amp; Response
                            </a>
                        </li>
                    </ul>
                
                    <ul class="list-unstyled nav-list mb-0">
                        <li class="sub-title nav-subheader">
                            <a href="https://www.paloaltonetworks.com/unit42" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-0:threat intel and incident response services" rel="noopener"> 
                                Threat Intel and Incident Response Services
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/unit42/assess" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-1:proactive assessments" rel="noopener"> 
                                Proactive Assessments
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/unit42/respond" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-2:incident response" rel="noopener"> 
                                Incident Response
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/unit42/transform" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-3:transform your security strategy" rel="noopener"> 
                                Transform Your Security Strategy
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-0:link-4:discover threat intelligence" rel="noopener"> 
                                Discover Threat Intelligence
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        
            <div class="col-12 col-md-4 col-xxl-2">
                <div class="heading-col collapsed pr-4 pr-md-0" data-toggle="collapse" data-target="#collapse_col_1">
                    <h2 class="nav-headline mb-0">Company</h2>
                </div>
                <div id="collapse_col_1" class="columns collapse d-md-flex flex-nowrap" data-parent="#footer_accordion">
                    <ul class="list-unstyled nav-list mb-0">
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/about-us" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-0:about us" rel="noopener"> 
                                About Us
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://jobs.paloaltonetworks.com/en/" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-1:careers" rel="noopener"> 
                                Careers
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/company/contact-sales" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-2:contact us" rel="noopener"> 
                                Contact Us
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-3:corporate responsiblity" rel="noopener"> 
                                Corporate Responsiblity
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/customers" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-4:customers" rel="noopener"> 
                                Customers
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://investors.paloaltonetworks.com/" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-5:investor relations" rel="noopener"> 
                                Investor Relations
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/about-us/locations" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-6:location" rel="noopener"> 
                                Location
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/company/newsroom" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-1:link-7:newsroom" rel="noopener"> 
                                Newsroom
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        
            <div class="col-12 col-md-4 col-xxl-2">
                <div class="heading-col collapsed pr-4 pr-md-0" data-toggle="collapse" data-target="#collapse_col_2">
                    <h2 class="nav-headline mb-0">Popular Links</h2>
                </div>
                <div id="collapse_col_2" class="columns collapse d-md-flex flex-nowrap" data-parent="#footer_accordion">
                    <ul class="list-unstyled nav-list mb-0">
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/blog/" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-0:blog" rel="noopener"> 
                                Blog
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/communities" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-1:communities" rel="noopener"> 
                                Communities
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/resources" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-2:content library" rel="noopener"> 
                                Content Library
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/cyberpedia" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-3:cyberpedia" rel="noopener"> 
                                Cyberpedia
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://events.paloaltonetworks.com/" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-4:event center" rel="noopener"> 
                                Event Center
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://start.paloaltonetworks.com/preference-center" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-5:manage email preferences" rel="noopener"> 
                                Manage Email Preferences
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/products/products-a-z" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-6:products a-z" rel="noopener"> 
                                Products A-Z
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/legal-notices/trust-center/compliance" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-7:product certifications" rel="noopener"> 
                                Product Certifications
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/security-disclosure" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-8:report a vulnerability" rel="noopener"> 
                                Report a Vulnerability
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://www.paloaltonetworks.com/sitemap" class="d-flex d-md-inline text-black" target="_self" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-9:sitemap" rel="noopener"> 
                                Sitemap
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://docs.paloaltonetworks.com/" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-10:tech docs" rel="nofollow noopener"> 
                                Tech Docs
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://unit42.paloaltonetworks.com/" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-11:unit 42" rel="noopener"> 
                                Unit 42
                            </a>
                        </li>
                    
                        <li class="link">
                            <a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" class="d-flex d-md-inline text-black" target="_blank" data-page-track="true" data-page-track-value="en_us:mainfootercomp:col-2:link-12:do not sell or share my personal information" onclick="noSell(event)" rel="noopener"> 
                                Do Not Sell or Share My Personal Information
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
<footer class="footer-bottom">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col-12 col-md-6 order-md-1 col-xxl-12">
                <div class="pan-logo d-flex">
                    <img data-src="https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/pan-logo-dark.svg" alt="PAN logo" class="lozad "/>
                </div>
            </div>
            <div class="col-12 col-md-12 order-md-3 col-xxl-8 order-xxl-2">
                <ul class="list-unstyled bottom-links nav-list d-flex flex-column flex-md-row">
                    <li>
                        <a href="https://www.paloaltonetworks.com/legal-notices/privacy" class="text-black" data-page-track="true" data-page-track-value="en_us:mainfootercomp:bottomlinks-0:privacy">
                            Privacy
                        </a>
                    </li>
                
                    <li>
                        <a href="https://www.paloaltonetworks.com/legal-notices/trust-center" class="text-black" data-page-track="true" data-page-track-value="en_us:mainfootercomp:bottomlinks-1:trust center">
                            Trust Center
                        </a>
                    </li>
                
                    <li>
                        <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" class="text-black" data-page-track="true" data-page-track-value="en_us:mainfootercomp:bottomlinks-2:terms of use">
                            Terms of Use
                        </a>
                    </li>
                
                    <li>
                        <a href="https://www.paloaltonetworks.com/legal" class="text-black" data-page-track="true" data-page-track-value="en_us:mainfootercomp:bottomlinks-3:documents">
                            Documents
                        </a>
                    </li>
                </ul>
                <p class="copyright text-black nav-list mb-3 mb-md-0">Copyright © 2025 Palo Alto Networks. All Rights Reserved</p>
            </div>
            <div class="col-12 col-md-6 order-md-2 col-xxl-4 order-xxl-3">
                <ul class="list-unstyled social-icons d-flex justify-content-start justify-content-md-end align-items-center">
                    
                        <li>
                            <a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" class="social-icon d-flex" aria-label="social link" data-page-track="true" data-page-track-value="en_us:mainfootercomp:socials-0:youtube" rel="noopener">
                                <img data-src="https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/social/youtube-black.svg" alt="Youtube" class="lozad "/>
                            </a>
                        </li>
                    
                        <li>
                            <a href="https://twitter.com/PaloAltoNtwks" target="_blank" class="social-icon d-flex" aria-label="social link" data-page-track="true" data-page-track-value="en_us:mainfootercomp:socials-1:twitter" rel="noopener">
                                <img data-src="https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/social/twitter-x-black.svg" alt="Twitter" class="lozad "/>
                            </a>
                        </li>
                    
                        <li>
                            <a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" class="social-icon d-flex" aria-label="social link" data-page-track="true" data-page-track-value="en_us:mainfootercomp:socials-2:facebook" rel="noopener">
                                <img data-src="https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/social/facebook-black.svg" alt="Facebook" class="lozad "/>
                            </a>
                        </li>
                    
                        <li>
                            <a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" class="social-icon d-flex" aria-label="social link" data-page-track="true" data-page-track-value="en_us:mainfootercomp:socials-3:linkedin" rel="noopener">
                                <img data-src="https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/social/linkedin-black.svg" alt="LinkedIn" class="lozad "/>
                            </a>
                        </li>
                    
                        <li>
                            <a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" target="_blank" class="social-icon d-flex" aria-label="social link" data-page-track="true" data-page-track-value="en_us:mainfootercomp:socials-4:podcast" rel="noopener">
                                <img data-src="https://www.paloaltonetworks.com/content/dam/pan/en_US/images/icons/podcast.svg" alt="Podcast" class="lozad "/>
                            </a>
                        </li>
                    
                    <li>
                        <div class="dropdown" data-language-json="[{&#39;localTitle&#39;:&#39;USA (ENGLISH)&#39;, &#39;localLink&#39;:&#39;#&#39;}, {&#39;localTitle&#39;:&#39;AUSTRALIA (ENGLISH)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.com.au&#39;}, {&#39;localTitle&#39;:&#39;BRAZIL (PORTUGUÉS)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.com.br&#39;}, {&#39;localTitle&#39;:&#39;CANADA (ENGLISH)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.ca&#39;}, {&#39;localTitle&#39;:&#39;CHINA (简体中文)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.cn&#39;}, {&#39;localTitle&#39;:&#39;FRANCE (FRANÇAIS)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.fr&#39;}, {&#39;localTitle&#39;:&#39;GERMANY (DEUTSCH)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.de&#39;}, {&#39;localTitle&#39;:&#39;INDIA (ENGLISH)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.in&#39;}, {&#39;localTitle&#39;:&#39;ITALY (ITALIANO)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.it&#39;}, {&#39;localTitle&#39;:&#39;JAPAN (日本語)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.jp&#39;}, {&#39;localTitle&#39;:&#39;KOREA (한국어)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.co.kr&#39;}, {&#39;localTitle&#39;:&#39;LATIN AMERICA (ESPAÑOL)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.lat&#39;}, {&#39;localTitle&#39;:&#39;MEXICO (ESPAÑOL)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.com.mx&#39;}, {&#39;localTitle&#39;:&#39;SINGAPORE (ENGLISH)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.sg&#39;}, {&#39;localTitle&#39;:&#39;SPAIN (ESPAÑOL)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.es&#39;}, {&#39;localTitle&#39;:&#39;TAIWAN (繁體中文)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.tw&#39;}, {&#39;localTitle&#39;:&#39;UK (ENGLISH)&#39;, &#39;localLink&#39;:&#39;https://www.paloaltonetworks.co.uk&#39;}]">
                            <button class="btn btn-language d-inline-flex align-items-center lozad-background" type="button" id="language_dropdown_menu_button" data-toggle="dropdown" aria-expanded="false" data-offset="30" data-background-image="url('/etc/clientlibs/clean/imgs/globe-black.svg')">
                                <span class="d-inline-flex">EN</span>
                                <i class="d-inline-flex"></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="language_dropdown_menu_button">
                                <span class="h8 title d-flex pb-2">Select your language</span>

                                <ul class="list-unstyled nav-list p-0 d-block d-md-flex flex-wrap"></ul>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
</div>
<!--<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex/cloud"   role="link" title="Cloud Security" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security">Cloud Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cloud"   role="link" title="Cortex Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security:Cortex Cloud">Cortex Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security:Cortex Cloud:Prisma Cloud">Prisma Cloud</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item do-not-sell-link"> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2025 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/unit42-dissecting-hancitors-latest-2018-packer/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>-->
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.7.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

function noSell(event) {
    event.preventDefault();
   if (( typeof OneTrust != 'undefined') &&  (!!OneTrust)) {
       OneTrust.ToggleInfoDisplay();
    }else{
      var href = event.target.getAttribute('href');
        window.open(href, '_blank'); 
    }
}

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "CloudCortex" || referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}


  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';

window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "CloudCortex" || referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
    
    $( ".do-not-sell-link a" ).on( "click", function( event ) {
        noSell(event);
      });
});
$('.footer-form').remove();
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://www.paloaltonetworks.com/etc.clientlibs/panClean/dynamicComponents/mainFooterComp/clientlibs/panClean/defered.min.js"></script>
</body>
</html>
