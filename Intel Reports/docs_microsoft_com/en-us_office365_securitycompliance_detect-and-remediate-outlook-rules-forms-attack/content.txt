<!DOCTYPE html><html
	class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light"
	lang="en-us"
	dir="ltr"
	data-authenticated="false"
	data-auth-status-determined="false"
	data-target="docs"
	x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Detect and remediate the Outlook rules and custom forms injections attacks. - Microsoft Defender for Office 365" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://learn.microsoft.com/en-us/defender-office-365/detect-and-remediate-outlook-rules-forms-attack" /><meta property="og:description" content="Learn how to recognize and remediate the Outlook rules and custom forms injections attacks in Office 365" /><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />

	<meta property="og:image:alt" content="Microsoft Learn" />

	<meta name="twitter:card" content="summary_large_image" />

	<meta name="twitter:site" content="@MicrosoftLearn" />

	<meta name="color-scheme" content="light dark"><meta name="audience" content="ITPro" />
<meta name="author" content="chrisda" />
<meta name="breadcrumb_path" content="/defender-office-365/breadcrumb/toc.json" />
<meta name="depot_name" content="Learn.defender-office-365" />
<meta name="description" content="Learn how to recognize and remediate the Outlook rules and custom forms injections attacks in Office 365" />
<meta name="document_id" content="f9ad8274-1e30-b14f-f26f-9abbd62338b1" />
<meta name="document_version_independent_id" content="f9ad8274-1e30-b14f-f26f-9abbd62338b1" />
<meta name="f1.keywords" content="NOCSH" />
<meta name="feedback_help_link_type" content="" />
<meta name="feedback_help_link_url" content="" />
<meta name="feedback_product_url" content="https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance" />
<meta name="feedback_system" content="Standard" />
<meta name="git_commit_id" content="f3612dab46b73f622bd9b5faec1a231d207c39da" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/defender-docs-pr/blob/f3612dab46b73f622bd9b5faec1a231d207c39da/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md" />
<meta name="locale" content="en-us" />
<meta name="manager" content="deniseb" />
<meta name="ms.author" content="chrisda" />
<meta name="ms.collection" content="tier2" />
<meta name="ms.collection" content="m365-security" />
<meta name="ms.custom" content="seo-marvel-apr2020" />
<meta name="ms.date" content="9/7/2023" />
<meta name="ms.localizationpriority" content="medium" />
<meta name="ms.service" content="defender-office-365" />
<meta name="ms.topic" content="conceptual" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md" />
<meta name="page_type" content="conceptual" />
<meta name="permissioned-type" content="public" />
<meta name="schema" content="Conceptual" />
<meta name="search.appverid" content="MET150" />
<meta name="site_name" content="Docs" />
<meta name="toc_rel" content="toc.json" />
<meta name="uhfHeaderId" content="MSDocsHeader-MicrosoftDefender" />
<meta name="updated_at" content="2024-06-24 05:37 PM" />
<meta name="word_count" content="2369" />
<meta name="persistent_id" content="8cf084a0-d7c9-c65c-98a1-846793cf5fb4" />
	
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/97159432-14a9-4307-a469-d2f2c75f0e33" data-source="generated" />
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/3e34b70d-bca0-4369-a01b-71d1edfd427b" data-source="generated" />
	
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/50565c62-5f6b-4687-be38-323113c72c2e" data-source="generated" />
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/8ca32b3f-fa14-46df-b09a-9c4a591d6396" data-source="generated" />
	<meta name="scope" content="Microsoft Defender Office 365" /><meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md" /><link href="https://learn.microsoft.com/en-us/defender-office-365/detect-and-remediate-outlook-rules-forms-attack" rel="canonical"><title>Detect and remediate the Outlook rules and custom forms injections attacks. - Microsoft Defender for Office 365 | Microsoft Learn</title><link rel="stylesheet" href="/static/assets/0.4.028516059/styles/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: true,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: true,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'Standard',
			feedbackGitHubRepo: '',
			feedbackProductUrl: 'https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance',extendBreadcrumb: false,isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,contributors: [{ name: "chrisda", url: "https://github.com/chrisda" },{ name: "denisebmsft", url: "https://github.com/denisebmsft" },{ name: "Dansimp", url: "https://github.com/Dansimp" },{ name: "alexbuckgit", url: "https://github.com/alexbuckgit" },{ name: "v-ratulach", url: "https://github.com/v-ratulach" },{ name: "v-mathavale", url: "https://github.com/v-mathavale" },{ name: "Ratulch", url: "https://github.com/Ratulch" },{ name: "Angelines-YG", url: "https://github.com/Angelines-YG" },{ name: "chrfox", url: "https://github.com/chrfox" },{ name: "DaniHalfin", url: "https://github.com/DaniHalfin" },{ name: "dariomws", url: "https://github.com/dariomws" },{ name: "Ajayan1008", url: "https://github.com/Ajayan1008" },{ name: "walsehgal", url: "https://github.com/walsehgal" },{ name: "jdmartinez36", url: "https://github.com/jdmartinez36" },{ name: "lhcole", url: "https://github.com/lhcole" },{ name: "pebaum", url: "https://github.com/pebaum" },{ name: "robmazz", url: "https://github.com/robmazz" },{ name: "mjcaparas", url: "https://github.com/mjcaparas" }],},
		functions:{}
	};
	</script><script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script><script src="/static/assets/0.4.028516059/global/deprecation.js"></script><script src="/static/assets/0.4.028516059/scripts/en-us/index-docs.js"></script></head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a><div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">Download Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">More info about Internet Explorer and Microsoft Edge</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
			<div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button>
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none">

										</div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs><div id="article-header-page-actions"  class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
											id="lang-link-tablet"
											class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
											title="Read in English" data-bi-name="language-toggle"
											data-read-in-link
											hidden>
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon>
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text>Read in English</span>
										</a><button
												type="button"
												class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet"
												data-list-type="collection"
												data-bi-name="collection"
												title="Add to collection">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Save</span>
											</button><a	data-contenteditbtn
												class="button button-clear button-sm text-decoration-none button-primary display-none display-inline-flex-tablet"
												aria-label="Edit"
												title="Edit This Document"
												data-bi-name="edit"
														href="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md"
														data-original_content_git_url="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md"
														data-original_content_git_url_template="{repo}/blob/{branch}/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md"
														data-pr_repo=""
														data-pr_branch="">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-edit-outline"></span>
												</span>
											</a>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button
														data-page-action-item="overflow-mobile"
														type="button"
														class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
														data-bi-name="contents-expand"
														data-contents-button
														data-popover-close>
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span></button><a
													id="lang-link-overflow"
													class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
													title="Read in English" data-bi-name="language-toggle"
													data-page-action-item="overflow-mobile"
													data-check-hidden="true"
													data-read-in-link
													hidden
													>
													<span class="icon" aria-hidden="true" data-read-in-link-icon>
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text>Read in English</span>
												</a><button
														type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="collection"
														data-bi-name="collection"
														title="Save"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Save</span>
													</button>

			 										
													<button
													 	type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="plan"
														data-bi-name="plan"
														title="Add to Plan"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close
														hidden>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">Add to Plan</span>
													</button><a	data-contenteditbtn
														class="button button-clear button-block button-sm has-inner-focus justify-content-flex-start text-decoration-none display-none-tablet"
														aria-label="Edit"
														title="Edit This Document"
														data-bi-name="edit"
																href="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md"
																data-original_content_git_url="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md"
																data-original_content_git_url_template="{repo}/blob/{branch}/defender-office-365/detect-and-remediate-outlook-rules-forms-attack.md"
																data-pr_repo=""
																data-pr_branch="">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-edit-outline"></span>
														</span>
														<span>Edit</span>
													</a><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs" />
														<h4 class="font-size-sm padding-left-xxs">Share via</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">Email</span>
														</a><hr />
													<button
														class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
														title="Print"
														type="button"
														aria-label="Print"
														data-bi-name="print"
														data-page-action-item="overflow-all"
														data-popover-close
														data-print-page
														data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">Print</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button hidden>
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr"><li>Article</li><li class="visibility-hidden-visual-diff"><time class="is-invisible" data-article-date aria-label="Article review date" datetime="2024-04-24T19:20:00Z" data-article-date-source="calculated">04/24/2024</time>
															</li><li class="contributors-holder display-none-print">
															<button aria-label="View all contributors" class="contributors-button link-button" data-bi-name="contributors" title="View all contributors">18 contributors</button>
														</li><li class="attributeList-holder">
														<dl class="attributeList">
															<dt>Applies to:</dt>
															<dd>â <a href="https://learn.microsoft.com/defender-office-365/eop-about" target="_blank">Exchange Online Protection</a>, â <a href="https://learn.microsoft.com/defender-office-365/mdo-about#defender-for-office-365-plan-1-vs-plan-2-cheat-sheet" target="_blank">Microsoft Defender for Office 365 Plan 1 and Plan 2</a>, â <a href="https://learn.microsoft.com/defender-xdr/microsoft-365-defender" target="_blank">Microsoft Defender XDR</a></dd>
														</dl>
													</li></ul>
										</div>
<div id="user-feedback" class="margin-block-xxs display-none-print" data-hide-on-archived>
	<button
		id="user-feedback-button"
		data-test-id="conceptual-feedback-button"
		class="button button-sm button-clear button-primary"
		type="button"
		data-bi-name="user-feedback-button"
		data-user-feedback-button
	>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-like"></span>
		</span>
		<span>Feedback</span>
	</button>
</div></div><nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav><!-- <content> --><div class="TIP">
<p>Tip</p>
<p><em>Did you know you can try the features in Microsoft Defender XDR for Office 365 Plan 2 for free?</em> Use the 90-day Defender for Office 365 trial at the <a href="https://security.microsoft.com/trialHorizontalHub?sku=MDO&amp;ref=DocsRef" data-linktype="external">Microsoft Defender portal trials hub</a>. Learn about who can sign up and trial terms on <a href="/en-us/defender-office-365/try-microsoft-defender-for-office-365" data-linktype="absolute-path">Try Microsoft Defender for Office 365</a>.</p>
</div>
<p><strong>Summary</strong> Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</p>
<h2 id="what-is-the-outlook-rules-and-custom-forms-injection-attack">What is the Outlook Rules and Custom Forms injection attack?</h2>
<p>After an attacker gains access to your organization, they try to establish a foothold to stay in or get back in after they're discovered. This activity is called <em>establishing a persistence mechanism</em>. There are two ways that an attacker can use Outlook to establish a persistence mechanism:</p>
<ul>
<li>By exploiting Outlook rules.</li>
<li>By injecting custom forms into Outlook.</li>
</ul>
<p>Reinstalling Outlook, or even giving the affected person a new computer doesn't help. When the fresh installation of Outlook connects to the mailbox, all rules and forms are synchronized from the cloud. The rules or forms are typically designed to run remote code and install malware on the local machine. The malware steals credentials or performs other illicit activity.</p>
<p>The good news is: if you keep Outlook clients patched to the latest version, you aren't vulnerable to the threat as current Outlook client defaults block both mechanisms.</p>
<p>The attacks typically follow these patterns:</p>
<p><strong>The Rules Exploit</strong>:</p>
<ol>
<li>The attacker steals a user's credentials.</li>
<li>The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</li>
<li>The attacker creates a forwarding Inbox rule in the mailbox. The forwarding rule is triggered when the mailbox receives a specific message from the attacker that matches the conditions of the rule. The rule conditions and message format are tailor-made for each other.</li>
<li>The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</li>
<li>When the mailbox receives a message that matches the conditions of rule, the action of the rule is applied. Typically, the rule action is to launch an application on a remote (WebDAV) server.</li>
<li>Typically, the application installs malware on the user's machine (for example, <a href="https://github.com/EmpireProject/Empire/" data-linktype="external">PowerShell Empire</a>).</li>
<li>The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</li>
</ol>
<p><strong>The Forms Exploit</strong>:</p>
<ol>
<li>The attacker steals a user's credentials.</li>
<li>The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</li>
<li>The attacker inserts a custom mail form template into the user's mailbox. The custom form is triggered when the mailbox receives a specific message from the attacker that requires the mailbox to load the custom form. The custom form and the message format are tailor-made for each other.</li>
<li>The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</li>
<li>When the mailbox receives the message, the mailbox loads the required form. The form launches an application on a remote (WebDAV) server.</li>
<li>Typically, the application installs malware on the user's machine (for example, <a href="https://github.com/EmpireProject/Empire" data-linktype="external">PowerShell Empire</a>).</li>
<li>The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</li>
</ol>
<h2 id="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365">What a Rules and Custom Forms Injection attack might look like Office 365?</h2>
<p>Users are unlikely to notice these persistence mechanisms and they might even be invisible to them. The following list describes the signs (Indicators of Compromise) that indicate remediation steps are required:</p>
<ul>
<li><p><strong>Indicators of the Rules compromise</strong>:</p>
<ul>
<li>Rule Action is to start an application.</li>
<li>Rule References an EXE, ZIP, or URL.</li>
<li>On the local machine, look for new process starts that originate from the Outlook PID.</li>
</ul>
</li>
<li><p><strong>Indicators of the Custom forms compromise</strong>:</p>
<ul>
<li>Custom forms present saved as their own message class.</li>
<li>Message class contains executable code.</li>
<li>Typically, malicious forms are stored in Personal Forms Library or Inbox folders.</li>
<li>Form is named IPM.Note.[custom name].</li>
</ul>
</li>
</ul>
<h2 id="steps-for-finding-signs-of-this-attack-and-confirming-it">Steps for finding signs of this attack and confirming it</h2>
<p>You can use either of the following methods to confirm the attack:</p>
<ul>
<li><p>Manually examine the rules and forms for each mailbox using the Outlook client. This method is thorough, but you can only check one mailbox at a time. This method can be very time consuming if you have many users to check, and might also infect the computer that you're using.</p>
</li>
<li><p>Use the <a href="https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1" data-linktype="external">Get-AllTenantRulesAndForms.ps1</a> PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your organization. This method is the fastest and safest with the least amount of overhead.</p>
<div class="NOTE">
<p>Note</p>
<p>As of January 2021, the script (and everything else in the repository) is read-only and archived. Lines 154 to 158 attempt to connect to Exchange Online PowerShell using a method that's no longer supported due to the <a href="https://techcommunity.microsoft.com/t5/exchange-team-blog/deprecation-of-remote-powershell-in-exchange-online-re-enabling/ba-p/3779692" data-linktype="external">deprecation of remote PowerShell connections</a> in July 2023. Remove lines 154 to 158 and <a href="/en-us/powershell/exchange/connect-to-exchange-online-powershell" data-linktype="absolute-path">Connect to Exchange Online PowerShell</a> before you run the script.</p>
</div>
</li>
</ul>
<h3 id="confirm-the-rules-attack-using-the-outlook-client">Confirm the Rules Attack Using the Outlook client</h3>
<ol>
<li><p>Open the users Outlook client as the user. The user may need your help in examining the rules on their mailbox.</p>
</li>
<li><p>Refer to <a href="https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59" data-linktype="external">Manage email messages by using rules</a> article for the procedures on how to open the rules interface in Outlook.</p>
</li>
<li><p>Look for rules that the user didn't create, or any unexpected rules or rules with suspicious names.</p>
</li>
<li><p>Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</p>
</li>
<li><p>Look for any new processes that start using the Outlook process ID. Refer to <a href="/en-us/windows-hardware/drivers/debugger/finding-the-process-id" data-linktype="absolute-path">Find the Process ID</a>.</p>
</li>
</ol>
<h3 id="steps-to-confirm-the-forms-attack-using-the-outlook-client">Steps to confirm the Forms attack using the Outlook client</h3>
<ol>
<li><p>Open the user Outlook client as the user.</p>
</li>
<li><p>Follow the steps in, <a href="https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45" data-linktype="external">Show the Developer tab</a> for the user's version of Outlook.</p>
</li>
<li><p>Open the now visible developer tab in Outlook and select <strong>design a form</strong>.</p>
</li>
<li><p>Select the <strong>Inbox</strong> from the <strong>Look In</strong> list. Look for any custom forms. Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</p>
</li>
<li><p>Investigate any custom forms, especially forms marked as hidden.</p>
</li>
<li><p>Open any custom forms and in the <strong>Form</strong> group, select <strong>View Code</strong> to see what runs when the form is loaded.</p>
</li>
</ol>
<h3 id="steps-to-confirm-the-rules-and-forms-attack-using-powershell">Steps to confirm the Rules and Forms attack using PowerShell</h3>
<p>The simplest way to verify a rules or custom forms attack is to run the <a href="https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1" data-linktype="external">Get-AllTenantRulesAndForms.ps1</a> PowerShell script. This script connects to every mailbox in your organization and dumps all the rules and forms into two .csv files.</p>
<h4 id="prerequisites">Prerequisites</h4>
<p>You need to be a member of the Global Administrator<sup>*</sup> role in <a href="/en-us/entra/identity/role-based-access-control/manage-roles-portal" data-linktype="absolute-path">Microsoft Entra ID</a> or the Organization Management role group in <a href="/en-us/exchange/permissions-exo/permissions-exo" data-linktype="absolute-path">Exchange Online</a>, because the script connects to every mailbox in the organization to read rules and forms.</p>
<div class="IMPORTANT">
<p>Important</p>
<p><sup>*</sup> Microsoft recommends that you use roles with the fewest permissions. Using lower permissioned accounts helps improve security for your organization. Global Administrator is a highly privileged role that should be limited to emergency scenarios when you can't use an existing role.</p>
</div>
<ol>
<li><p>Use an account with local administrator rights to sign in to the computer where you intend to run the script.</p>
</li>
<li><p>Download or copy the contents of the <strong>Get-AllTenantRulesAndForms.ps1</strong> script from GitHub to a folder that's easy to find and run the script from. The script creates two date stamped files in the folder: <code>MailboxFormsExport-yyyy-MM-dd.csv</code> and <code>MailboxRulesExport-yyyy-MM-dd.csv</code>.</p>
<p>Remove lines 154 to 158 from the script, because that connection method no longer works as of July 2023.</p>
</li>
<li><p><a href="/en-us/powershell/exchange/connect-to-exchange-online-powershell" data-linktype="absolute-path">Connect to Exchange Online PowerShell</a>.</p>
</li>
<li><p>Navigate in PowerShell to the folder where you saved the script, and then run the following command:</p>
<pre><code class="lang-powershell">.\Get-AllTenantRulesAndForms.ps1
</code></pre>
</li>
</ol>
<h4 id="interpreting-the-output">Interpreting the output</h4>
<ul>
<li><strong>MailboxRulesExport-<em>yyyy-MM-dd</em>.csv</strong>: Examine the rules (one per row) for action conditions that include applications or executables:
<ul>
<li><strong>ActionType (column A)</strong>: The rule is likely malicious if this column contains the value <code>ID_ACTION_CUSTOM</code>.</li>
<li><strong>IsPotentiallyMalicious (column D)</strong>: The rule is likely malicious if this column contains the value <code>TRUE</code>.</li>
<li><strong>ActionCommand (column G)</strong>: The rule is likely malicious if this column contains any of the following values:
<ul>
<li>An application.</li>
<li>An .exe or .zip file.</li>
<li>An unknown entry that refers to a URL.</li>
</ul>
</li>
</ul>
</li>
<li><strong>MailboxFormsExport-<em>yyyy-MM-dd</em>.csv</strong>: In general, the use of custom forms is rare. If you find any in this workbook, open that user's mailbox and examine the form itself. If your organization didn't put it there intentionally, it's likely malicious.</li>
</ul>
<h2 id="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack">How to stop and remediate the Outlook Rules and Forms attack</h2>
<p>If you find any evidence of either of these attacks, remediation is simple: just delete the rule or form in the mailbox. You can delete the rule or form using the Outlook client or using Exchange PowerShell.</p>
<h3 id="using-outlook">Using Outlook</h3>
<ol>
<li><p>Identify all devices where the user has used Outlook. They all need to be cleaned of potential malware. Don't allow the user to sign on and use email until all devices have been cleaned.</p>
</li>
<li><p>On each device, follow the steps in <a href="https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f" data-linktype="external">Delete a rule</a>.</p>
</li>
<li><p>If you're unsure about the presence of other malware, you can format and reinstall all the software on the device. For mobile devices, you can follow the manufacturers steps to reset the device to the factory image.</p>
</li>
<li><p>Install the most up-to-date versions of Outlook. Remember, current version of Outlook blocks both types of this attack by default.</p>
</li>
<li><p>Once all offline copies of the mailbox have been removed, do the following steps:</p>
<ul>
<li>Reset the user's password using a high quality value (length and complexity).</li>
<li>If multi-factor authentication (MFA) isn't turned on for the user, follow the steps in <a href="/en-us/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication" data-linktype="absolute-path">Setup multi-factor authentication for users</a></li>
</ul>
<p>These steps ensure that the user's credentials aren't exposed via other means (for example, phishing or password reuse).</p>
</li>
</ol>
<h3 id="using-powershell">Using PowerShell</h3>
<p>Connect to the required Exchange PowerShell environment:</p>
<ul>
<li><p><strong>Mailboxes on on-premises Exchange servers</strong>: <a href="/en-us/powershell/exchange/connect-to-exchange-servers-using-remote-powershell" data-linktype="absolute-path">Connect to Exchange servers using remote PowerShell</a> or <a href="/en-us/powershell/exchange/open-the-exchange-management-shell" data-linktype="absolute-path">Open the Exchange Management Shell</a>.</p>
</li>
<li><p><strong>Mailboxes in Exchange Online</strong>: <a href="/en-us/powershell/exchange/connect-to-exchange-online-powershell" data-linktype="absolute-path">Connect to Exchange Online PowerShell</a>.</p>
</li>
</ul>
<p>After you connect to the required Exchange PowerShell environment, you can take the following actions on Inbox rules in user mailboxes:</p>
<ul>
<li><p><strong>View Inbox rules in a mailbox</strong>:</p>
<ul>
<li><p><strong>View a summary list of all rules</strong></p>
<pre><code class="lang-powershell">Get-InboxRule -Mailbox laura@contoso.onmicrosoft.com
</code></pre>
</li>
<li><p><strong>View detailed information for a specific rule</strong>:</p>
<pre><code class="lang-powershell">Get-InboxRule -Mailbox laura@contoso.onmicrosoft.com -Identity "Suspicious Rule Name" | Format-List
</code></pre>
</li>
</ul>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/get-inboxrule" data-linktype="absolute-path">Get-InboxRule</a>.</p>
</li>
<li><p><strong>Remove Inbox rules from a mailbox</strong>:</p>
<ul>
<li><p><strong>Remove a specific rule</strong>:</p>
<pre><code class="lang-powershell">Remove-InboxRule -Mailbox laura@contoso.onmicrosoft.com -Identity "Suspicious Rule Name"
</code></pre>
</li>
<li><p><strong>Remove all rules</strong>:</p>
<pre><code class="lang-powershell">Get-InboxRule -Mailbox laura@contoso.onmicrosoft.com | Remove-InboxRule
</code></pre>
</li>
</ul>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/remove-inboxrule" data-linktype="absolute-path">Remove-InboxRule</a>.</p>
</li>
<li><p><strong>Turn off an Inbox rule for further investigation</strong>:</p>
<pre><code class="lang-powershell">Disable-InboxRule -Mailbox laura@contoso.onmicrosoft.com -Identity "Suspicious Rule Name"
</code></pre>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/disable-inboxrule" data-linktype="absolute-path">Disable-InboxRule</a>.</p>
</li>
</ul>
<h2 id="how-to-minimize-future-attacks">How to minimize future attacks</h2>
<h3 id="first-protect-accounts">First: protect accounts</h3>
<p>The Rules and Forms exploits are only used by an attacker after they've stolen or breached a user's account. So, your first step to preventing the use of these exploits against your organization is to aggressively protect user accounts. Some of the most common ways that accounts are breached are through phishing or <a href="https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/" data-linktype="external">password spray attacks</a>.</p>
<p>The best way to protect user accounts (especially admin accounts) is to <a href="/en-us/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication" data-linktype="absolute-path">set up MFA for users</a>. You should also:</p>
<ul>
<li><p>Monitor how user accounts are <a href="/en-us/entra/identity/monitoring-health/overview-monitoring-health" data-linktype="absolute-path">accessed and used</a>. You may not prevent the initial breach, but you can shorten the duration and the effects of the breach by detecting it sooner. You can use these <a href="/en-us/cloud-app-security/what-is-cloud-app-security" data-linktype="absolute-path">Office 365 Cloud App Security policies</a> to monitor accounts and alert you to unusual activity:</p>
<ul>
<li><p><strong>Multiple failed login attempts</strong>: Triggers an alert when users perform multiple failed sign in activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</p>
</li>
<li><p><strong>Impossible travel</strong>: Triggers an alert when activities are detected from the same user in different locations within a time period that's shorter than the expected travel time between the two locations. This activity could indicate that a different user is using the same credentials. Detecting this anomalous behavior necessitates an initial learning period of seven days to learn a new user's activity pattern.</p>
</li>
<li><p><strong>Unusual impersonated activity (by user)</strong>: Triggers an alert when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</p>
</li>
</ul>
</li>
<li><p>Use a tool like <a href="/en-us/defender-xdr/microsoft-secure-score" data-linktype="absolute-path">Office 365 Secure Score</a> to manage account security configurations and behaviors.</p>
</li>
</ul>
<h3 id="second-keep-outlook-clients-current">Second: Keep Outlook clients current</h3>
<p>Fully updated and patched versions of Outlook 2013, and 2016 disable the "Start Application" rule/form action by default. Even if an attacker breaches the account, the rule and form actions are blocked. You can install the latest updates and security patches by following the steps in <a href="https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5" data-linktype="external">Install Office updates</a>.</p>
<p>Here are the patch versions for Outlook 2013 and 2016 clients:</p>
<ul>
<li><strong>Outlook 2016</strong>: 16.0.4534.1001 or greater.</li>
<li><strong>Outlook 2013</strong>: 15.0.4937.1000 or greater.</li>
</ul>
<p>For more information on the individual security patches, see:</p>
<ul>
<li><a href="https://support.microsoft.com/help/3191883" data-linktype="external">Outlook 2016 Security Patch</a></li>
<li><a href="https://support.microsoft.com/help/3191938" data-linktype="external">Outlook 2013 Security Patch</a></li>
</ul>
<h3 id="third-monitor-outlook-clients">Third: Monitor Outlook clients</h3>
<p>Even with the patches and updates installed, it's possible for an attacker to change the local machine configuration to reenable the "Start Application" behavior. You can use <a href="/en-us/microsoft-desktop-optimization-pack/agpm/" data-linktype="absolute-path">Advanced Group Policy Management</a> to monitor and enforce local machine policies on client devices.</p>
<p>You can see if "Start Application" has been re-enabled through an override in the registry by using the information in <a href="https://support.microsoft.com/help/305097" data-linktype="external">How to view the system registry by using 64-bit versions of Windows</a>. Check these subkeys:</p>
<ul>
<li><strong>Outlook 2016</strong>: <code>HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\</code></li>
<li><strong>Outlook 2013</strong>: <code>HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\</code></li>
</ul>
<p>Look for the key <code>EnableUnsafeClientMailRules</code>:</p>
<ul>
<li>If the value is 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</li>
<li>If the value is 0, the "Start Application" action is disabled.</li>
<li>If the registry key isn't present and the updated and patched version of Outlook is installed, then the system isn't vulnerable to these attacks.</li>
</ul>
<p>Customers with on-premises Exchange installations should consider blocking older versions of Outlook that don't have patches available. Details on this process can be found in the article <a href="/en-us/exchange/configure-outlook-client-blocking-exchange-2013-help" data-linktype="absolute-path">Configure Outlook client blocking</a>.</p>
<h2 id="see-also">See also:</h2>
<ul>
<li><a href="https://silentbreaksecurity.com/malicious-outlook-rules/" data-linktype="external">Malicious Outlook Rules</a> by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</li>
<li><a href="https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/" data-linktype="external">MAPI over HTTP and Mailrule Pwnage</a> on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</li>
<li><a href="https://sensepost.com/blog/2017/outlook-forms-and-shells/" data-linktype="external">Outlook forms and shells</a> on the Sensepost blog about Forms Threat Vector.</li>
<li><a href="https://github.com/sensepost/ruler" data-linktype="external">Ruler Codebase</a></li>
<li><a href="https://github.com/sensepost/notruler/blob/master/iocs.md" data-linktype="external">Ruler Indicators of Compromise</a></li>
</ul>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><section id="site-user-feedback-footer" class="font-size-sm margin-top-md" data-test-id="site-user-feedback-footer" data-bi-name="site-feedback-section">
	<hr class="hr" />
	<h2 id="feedback" class="title is-3">Feedback</h2>
	<div class="display-flex flex-wrap-wrap align-items-center">
		<p class="font-weight-semibold margin-xxs margin-left-none">Was this page helpful?</p>
		<div class="buttons">
			<button
				class="thumb-rating-button like button button-primary button-sm"
				data-test-id="footer-rating-yes"
				data-binary-rating-response="rating-yes"
				type="button"
				title="This article is helpful"
				data-bi-name="button-rating-yes"
				aria-pressed="false"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-like"></span>
				</span>
				<span>Yes</span>
			</button>
			<button
				class="thumb-rating-button dislike button button-primary button-sm"
				data-test-id="footer-rating-no"
				data-binary-rating-response="rating-no"
				type="button"
				title="This article is not helpful"
				data-bi-name="button-rating-no"
				aria-pressed="false"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-dislike"></span>
				</span>
				<span>No</span>
			</button>
		</div>
	</div><div class="display-flex flex-wrap-wrap margin-top-xxs"><div>
			<a
				data-bi-name="provide-feedback-cta"
				class="has-external-link-indicator"
				href="https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance"
				data-bi-name="product-feedback"
			>
				<span>Provide product feedback</span>
			</a></div></div>

</section><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside
								id="ms--additional-resources-mobile"
								aria-label="Additional resources"
								class="display-none-desktop display-none-print"
							>
								<hr class="hr" hidden />
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer></div></div><div
							id="ms--additional-resources"
							class="right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Additional resources"
						>
							<div id="affixed-right-container" class="margin-top-sm-tablet" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden>Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer>

	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>