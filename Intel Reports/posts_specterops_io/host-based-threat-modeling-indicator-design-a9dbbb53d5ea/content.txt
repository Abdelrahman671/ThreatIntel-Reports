<!doctype html><html lang="en"><head><title data-rh="true">Host-based Threat Modeling &amp; Indicator Design | by Jared Atkinson | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2017-07-18T13:39:13.182Z"/><meta data-rh="true" name="title" content="Host-based Threat Modeling &amp; Indicator Design | by Jared Atkinson | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="Host-based Threat Modeling &amp; Indicator Design"/><meta data-rh="true" property="al:android:url" content="medium://p/a9dbbb53d5ea"/><meta data-rh="true" property="al:ios:url" content="medium://p/a9dbbb53d5ea"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Focused around malicious use of NTFS Extended Attributes, this post describes a methodology for understanding attack techniques and building behavioral detections for them."/><meta data-rh="true" property="og:description" content="Detecting Zeroaccess Trojan’s abuse of NTFS Extended Attributes… Behaviorally"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fill:1200:632/g:fp:0.51:0.09/0*7fpGVXnGJQxwapSC."/><meta data-rh="true" property="article:author" content="https://medium.com/@jaredcatkinson"/><meta data-rh="true" name="author" content="Jared Atkinson"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Host-based Threat Modeling &amp; Indicator Design"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/a9dbbb53d5ea"/><meta data-rh="true" property="twitter:description" content="Detecting Zeroaccess Trojan’s abuse of NTFS Extended Attributes… Behaviorally"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fill:1200:632/g:fp:0.51:0.09/0*7fpGVXnGJQxwapSC."/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@jaredcatkinson"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="14 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*D-FDlfkqivRBQZoESrwtqw.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@jaredcatkinson"/><link data-rh="true" rel="canonical" href="https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/a9dbbb53d5ea"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fill:1200:675\u002Fg:fp:0.51:0.09\u002F0*7fpGVXnGJQxwapSC.","https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fill:1200:900\u002Fg:fp:0.51:0.09\u002F0*7fpGVXnGJQxwapSC.","https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fill:1200:1200\u002Fg:fp:0.51:0.09\u002F0*7fpGVXnGJQxwapSC."],"url":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea","dateCreated":"2017-07-18T13:35:14.535Z","datePublished":"2017-07-18T13:35:14.535Z","dateModified":"2018-05-04T17:59:59.894Z","headline":"Host-based Threat Modeling & Indicator Design - Posts By SpecterOps Team Members","name":"Host-based Threat Modeling & Indicator Design - Posts By SpecterOps Team Members","description":"Focused around malicious use of NTFS Extended Attributes, this post describes a methodology for understanding attack techniques and building behavioral detections for them.","identifier":"a9dbbb53d5ea","author":{"@type":"Person","name":"Jared Atkinson","url":"https:\u002F\u002Fposts.specterops.io\u002F@jaredcatkinson"},"creator":["Jared Atkinson"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":149,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:298\u002F1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea"}</script><style type="text/css" data-fela-rehydration="550" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="550" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(128, 128, 183, 1)}.es{border-color:rgba(128, 128, 183, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(128, 128, 183, 1)}.ez:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(128, 128, 183, 1)}.iu{fill:rgba(128, 128, 183, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{margin-left:4px}.lr{margin-top:0px}.ls{opacity:1}.lt{padding:4px 0}.lw{width:16px}.ly{display:inline-flex}.me{max-width:100%}.mf{padding:8px 2px}.mg svg{color:#6B6B6B}.mx{line-height:1.12}.my{letter-spacing:-0.022em}.mz{font-weight:600}.nu{margin-bottom:-0.28em}.nv{line-height:1.58}.nw{letter-spacing:-0.004em}.nx{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.os{margin-bottom:-0.46em}.ot{text-decoration:underline}.oz{line-height:1.18}.pn{margin-bottom:-0.31em}.po{font-style:italic}.pp{list-style-type:disc}.pq{margin-left:30px}.pr{padding-left:0px}.px{margin-left:auto}.py{margin-right:auto}.pz{max-width:646px}.qf{clear:both}.qg{height:auto}.qh{margin-top:10px}.qi{max-width:728px}.ql{max-width:1600px}.qn{cursor:zoom-in}.qo{z-index:auto}.qq{max-width:1278px}.qr{max-width:1442px}.qs{max-width:1438px}.qy{padding-top:5px}.qz{padding-bottom:5px}.ra{max-width:1534px}.rb{margin-top:32px}.rc{margin-bottom:14px}.rd{padding-top:24px}.re{padding-bottom:10px}.rf{background-color:#000000}.rg{height:3px}.rh{width:3px}.ri{margin-right:20px}.ro{margin:auto}.rp{padding-bottom:100%}.rq{height:0}.rr{margin-bottom:26px}.rs{margin-top:6px}.rt{margin-top:8px}.ru{margin-right:8px}.rv{padding:8px 16px}.rw{border-radius:100px}.rx{transition:background 300ms ease}.rz{white-space:nowrap}.sa{border-top:none}.sg{height:52px}.sh{max-height:52px}.si{box-sizing:content-box}.sj{position:static}.sl{max-width:155px}.sw{align-items:flex-end}.sx{width:76px}.sy{height:76px}.sz{border:2px solid #F9F9F9}.ta{height:72px}.tb{width:72px}.tc{margin-left:-16px}.td{width:36px}.te{height:36px}.tf{stroke:#F2F2F2}.tg{color:#F2F2F2}.th{fill:#F2F2F2}.ti{background:#F2F2F2}.tj{border-color:#F2F2F2}.tp{font-weight:500}.tq{font-size:24px}.tr{line-height:30px}.ts{letter-spacing:-0.016em}.tt{margin-top:16px}.tu{height:0px}.tv{border-bottom:solid 1px #E5E5E5}.ub{margin-top:72px}.uc{padding:24px 0}.ud{margin-bottom:0px}.ue{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(110, 110, 154, 1)}.eu:hover{border-color:rgba(110, 110, 154, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(110, 110, 154, 1)}.iw:hover:not(:disabled){fill:rgba(110, 110, 154, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.lu:hover{fill:#000000}.lv:hover p{color:#000000}.lx:hover{color:#000000}.mh:hover svg{color:#000000}.ry:hover{background-color:#F2F2F2}.tk:hover{background:#F2F2F2}.tl:hover{border-color:#F2F2F2}.tm:hover{cursor:wait}.tn:hover{color:#F2F2F2}.to:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mi:focus svg{color:#000000}.qp:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.md{margin:0}.nq{font-size:24px}.nr{margin-top:1.95em}.ns{line-height:30px}.nt{letter-spacing:-0.016em}.oo{font-size:20px}.op{margin-top:0.94em}.oq{line-height:32px}.or{letter-spacing:-0.003em}.oy{margin-top:2.14em}.pk{margin-top:1.72em}.pl{line-height:24px}.pm{letter-spacing:0}.pw{margin-top:1.14em}.qe{margin-top:56px}.qx{max-width:1192px}.rn{margin-top:1.25em}.sf{margin-bottom:88px}.sq{display:inline-block}.sv{padding-top:72px}.ua{margin-top:40px}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.qj{margin-left:auto}.qk{text-align:center}.sp{display:inline-block}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.so{display:inline-block}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.sn{display:inline-block}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.lz{margin:0}.mj{border:1px solid #F2F2F2}.mk{border-radius:99em}.ml{padding:0px 16px 0px 12px}.mm{height:38px}.mn{align-items:center}.mp svg{margin-right:8px}.na{font-size:20px}.nb{margin-top:1.2em}.nc{line-height:24px}.nd{letter-spacing:0}.ny{font-size:18px}.nz{margin-top:0.67em}.oa{line-height:28px}.ob{letter-spacing:-0.003em}.ou{margin-top:1.56em}.pa{font-size:16px}.pb{margin-top:1.23em}.ps{margin-top:1.34em}.qa{margin-top:40px}.qt{max-width:100%}.rj{margin-top:0.93em}.sb{margin-bottom:80px}.sm{display:inline-block}.sr{padding-top:48px}.tw{margin-top:32px}.mo:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mc{margin:0}.nm{font-size:24px}.nn{margin-top:1.95em}.no{line-height:30px}.np{letter-spacing:-0.016em}.ok{font-size:20px}.ol{margin-top:0.94em}.om{line-height:32px}.on{letter-spacing:-0.003em}.ox{margin-top:2.14em}.ph{margin-top:1.72em}.pi{line-height:24px}.pj{letter-spacing:0}.pv{margin-top:1.14em}.qd{margin-top:56px}.qw{max-width:1192px}.rm{margin-top:1.25em}.se{margin-bottom:88px}.su{padding-top:72px}.tz{margin-top:40px}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.mb{margin:0}.ni{font-size:24px}.nj{margin-top:1.95em}.nk{line-height:30px}.nl{letter-spacing:-0.016em}.og{font-size:20px}.oh{margin-top:0.94em}.oi{line-height:32px}.oj{letter-spacing:-0.003em}.ow{margin-top:2.14em}.pe{margin-top:1.72em}.pf{line-height:24px}.pg{letter-spacing:0}.pu{margin-top:1.14em}.qc{margin-top:56px}.qv{max-width:100%}.rl{margin-top:1.25em}.sd{margin-bottom:88px}.st{padding-top:72px}.ty{margin-top:40px}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.ma{margin:0}.mq{border:1px solid #F2F2F2}.mr{border-radius:99em}.ms{padding:0px 16px 0px 12px}.mt{height:38px}.mu{align-items:center}.mw svg{margin-right:8px}.ne{font-size:20px}.nf{margin-top:1.2em}.ng{line-height:24px}.nh{letter-spacing:0}.oc{font-size:18px}.od{margin-top:0.67em}.oe{line-height:28px}.of{letter-spacing:-0.003em}.ov{margin-top:1.56em}.pc{font-size:16px}.pd{margin-top:1.23em}.pt{margin-top:1.34em}.qb{margin-top:40px}.qu{max-width:100%}.rk{margin-top:0.93em}.sc{margin-bottom:80px}.ss{padding-top:48px}.tx{margin-top:32px}.mv:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="print">.sk{display:none}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.qm{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa9dbbb53d5ea&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="1a73" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Host-based Threat Modeling &amp; Indicator Design</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a href="https://medium.com/@jaredcatkinson?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="Jared Atkinson" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener  ugc nofollow"><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><div class="l ii ij by id ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" href="https://medium.com/@jaredcatkinson?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow">Jared Atkinson</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb206c297df42&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=post_page-b206c297df42----a9dbbb53d5ea---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://posts.specterops.io/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">14 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Jul 18, 2017</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=-----a9dbbb53d5ea---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la ls lt ab q fk lu lv" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv z du"><span class="pw-responses-count lq lr">1</span></p></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lw k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=-----a9dbbb53d5ea---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lx" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd ly cn"><div class="l ae"><div class="ab cb"><div class="lz ma mb mc md me ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi mj mk ml mm s mn mo mp mq mr ms mt u mu mv mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi mj mk ml mm s mn mo mp mq mr ms mt u mu mv mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="d4e5" class="mx my gu bf mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu bk">Introduction and Background</h1><p id="9edc" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">Last week, my colleague Brian Reitz (<a class="af ot" href="https://twitter.com/brian_psu" rel="noopener ugc nofollow" target="_blank">@brian_psu</a>) wrote a brilliant <a class="af ot" rel="noopener ugc nofollow" target="_blank" href="/hiding-registry-keys-with-psreflect-b18ec5ac8353">post</a> about leveraging <a class="af ot" href="https://github.com/mattifestation/PSReflect" rel="noopener ugc nofollow" target="_blank">PSReflect</a> to model malware techniques. This post builds upon his thought process and explicitly lays out SpecterOps’ methodology surrounding threat modeling and design of defensive indicators.</p><p id="a087" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Ultimately, this process is designed to facilitate researching a technique from the underlying technology all the way to specific implementations. We start by identifying the offensive technique we want to focus on. Once we have a technique, we identify the actual technology that the technique targets. This step forces us to look at the technique from the macro level, while still maintaining a technical perspective. For the next portion of the process we will build on the knowledge we gained to identify relevant data sets, understand how to collect it, and write a proof-of-concept (POC) for implementing the specific attack technique. With these tools we can then begin to understand the technology’s normal behavior and identify how the attack technique deviates from normal as well as validate any assumptions made along the way. Lastly, we will check how the scale of an enterprise environment challenges our assumption and adapt our detection based on this reality.</p><p id="c52b" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">In this post I will leverage the <a class="af ot" href="http://attack.mitre.org/" rel="noopener ugc nofollow" target="_blank">MITRE ATT&amp;CK Framework</a> to identify post-exploitation techniques that we may want to focus on.</p><h1 id="dcf5" class="mx my gu bf mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu bk">Methodology</h1><p id="05d4" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">Describing the methodology seems to make the most sense if I work through it using an actual example technique. For the remainder of the post, I will explain my thought process on detecting malicious use of NTFS Extended Attributes (<a class="af ot" href="https://attack.mitre.org/wiki/Technique/T1096" rel="noopener ugc nofollow" target="_blank">ATT&amp;CK: T1096 — Defense Evasion/NTFS Extended Attributes</a>), a technique used by the Zeroaccess Trojan since at least 2012.</p><h2 id="5d85" class="oz my gu bf mz pa pb dy nd pc pd ea nh og pe pf pg ok ph pi pj oo pk pl pm pn bk">Research Underlying Technology</h2><p id="135d" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">Developing a lasting behavioral detection requires a solid understanding not only of the possible attacker implementations of the technique, but of the underlying technology as well. In this case, how can we truly detect the malicious use of NTFS Extended Attributes (EA) if we don’t actually understand them?! A good place to start delving into this technology is the ATT&amp;CK Framework’s wiki entry for our chosen technique. If we refer to the technique’s wiki we can see the description of the attack and how adversaries leverage this technique to evade in-place defenses:</p><p id="70e7" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk"><em class="po">“Data or executables may be stored in New Technology File System (NTFS) partition metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus.</em></p><p id="6a0e" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk"><em class="po">The NTFS format has a feature called Extended Attributes (EA), which allows data to be stored as an attribute of a file or folder.”</em></p><p id="9dd6" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">After reading this, I walk away with some level of understanding, but I also have some questions. Let’s take a look at what we know after reading these sentences:</p><ul class=""><li id="b0c3" class="nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os pp pq pr bk">Attackers are hiding data in NTFS metadata structures (namely Extended Attributes).</li><li id="d9f4" class="nv nw gu nx b ny ps oa ob oc pt oe of og pu oi oj ok pv om on oo pw oq or os pp pq pr bk">Data is being hidden so the attacker can bypass AV and other automated scanning solutions.</li></ul><p id="6627" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Let’s take a peek at the questions I’ve come up with:</p><ul class=""><li id="49f9" class="nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os pp pq pr bk">What are Extended Attributes?</li><li id="62d4" class="nv nw gu nx b ny ps oa ob oc pt oe of og pu oi oj ok pv om on oo pw oq or os pp pq pr bk">Where are Extended Attributes stored?</li><li id="7c87" class="nv nw gu nx b ny ps oa ob oc pt oe of og pu oi oj ok pv om on oo pw oq or os pp pq pr bk">Why are attackers using Extended Attributes?</li><li id="a71e" class="nv nw gu nx b ny ps oa ob oc pt oe of og pu oi oj ok pv om on oo pw oq or os pp pq pr bk">Is there any particular advantage to this technique?</li><li id="c875" class="nv nw gu nx b ny ps oa ob oc pt oe of og pu oi oj ok pv om on oo pw oq or os pp pq pr bk">How are the attackers interacting with the Extended Attributes (storing and retrieving data)?</li></ul><p id="3a23" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Ok! Lets see what we can do to answer these questions!</p><p id="8abb" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">First things first, we know that EAs are part of NTFS, so we should start by checking out some NTFS documentation. Technically speaking, NTFS is a proprietary file system, so we cannot simply find information about Extended Attributes on MSDN. Luckily, Richard Russon provides excellent <a class="af ot" href="https://flatcap.org/linux-ntfs/ntfs/index.html" rel="noopener ugc nofollow" target="_blank">documentation</a> derived from the Linux NTFS driver project. While working on <a class="af ot" href="https://github.com/invoke-ir/powerforensics" rel="noopener ugc nofollow" target="_blank">PowerForensics</a> development, this is my first stop when I have an NTFS related question. The page is a gold mine of information about NTFS, including the most niche details about the Master File Table (MFT) and its attributes.</p><p id="4560" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Upon arriving on the page, I searched for “Extended Attribute” and was directed to the <a class="af ot" href="https://flatcap.org/linux-ntfs/ntfs/attributes/ea.html" rel="noopener ugc nofollow" target="_blank">$EA page</a>. The “Overview” section describes the $EA attribute as:</p><p id="929a" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">“<em class="po">Used to implement the HPFS extended attribute under NTFS. This file attribute may be non-resident because its stream is likely to grow.</em></p><p id="0c98" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk"><em class="po">As defined in </em><a class="af ot" href="https://flatcap.org/linux-ntfs/ntfs/files/attrdef.html" rel="noopener ugc nofollow" target="_blank"><em class="po">$AttrDef</em></a><em class="po">, this attribute has a no minimum size but a maximum of 65536 bytes.</em>”</p><p id="ec2c" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">The documentation also provides a the $EA attribute data structure as shown below:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div class="px py pz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vd9kotlrDoDOzZeZ5hpNsQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vd9kotlrDoDOzZeZ5hpNsQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vd9kotlrDoDOzZeZ5hpNsQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vd9kotlrDoDOzZeZ5hpNsQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vd9kotlrDoDOzZeZ5hpNsQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vd9kotlrDoDOzZeZ5hpNsQ.png 1100w, https://miro.medium.com/v2/resize:fit:1292/format:webp/1*vd9kotlrDoDOzZeZ5hpNsQ.png 1292w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 646px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vd9kotlrDoDOzZeZ5hpNsQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vd9kotlrDoDOzZeZ5hpNsQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vd9kotlrDoDOzZeZ5hpNsQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vd9kotlrDoDOzZeZ5hpNsQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vd9kotlrDoDOzZeZ5hpNsQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vd9kotlrDoDOzZeZ5hpNsQ.png 1100w, https://miro.medium.com/v2/resize:fit:1292/1*vd9kotlrDoDOzZeZ5hpNsQ.png 1292w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 646px"/><img alt="" class="bh me qg c" width="646" height="340" loading="lazy" role="presentation"/></picture></div><figcaption class="qh ff qi px py qj qk bf b bg z du">$EA attribute structure retrieved from <a class="af ot" href="https://flatcap.org/linux-ntfs/ntfs/attributes/ea.html" rel="noopener ugc nofollow" target="_blank">https://flatcap.org/linux-ntfs/ntfs/attributes/ea.html</a></figcaption></figure><p id="e6a1" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Turns out Extended Attributes are Master File Table attributes, meaning it serves to provide some sort of metadata about a file. For some context, a few of the more well known attributes are the <a class="af ot" href="https://flatcap.org/linux-ntfs/ntfs/attributes/standard_information.html" rel="noopener ugc nofollow" target="_blank">$STANDARD_INFORMATION</a> attribute (stores the timestamps we see in File Explorer), the <a class="af ot" href="https://flatcap.org/linux-ntfs/ntfs/attributes/file_name.html" rel="noopener ugc nofollow" target="_blank">$FILE_NAME</a> attribute (keeps track of the file’s name), and the <a class="af ot" href="https://flatcap.org/linux-ntfs/ntfs/attributes/data.html" rel="noopener ugc nofollow" target="_blank">$DATA</a> attribute (which contains or points to the file’s contents). It also looks like the $EA is used for compatibility with the High Performance File System (HPFS), which is a legacy file system that is unlikely to be used in conjunction with modern operating systems. I also see that a $EA is basically a name/value pair where the Value field can store arbitrary data (possibly code) with a maximum size of ~65536 bytes.</p><p id="21fc" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">With a generic concept of EA, we can look at the overarching concept of the Master File Table. The MFT is a metadata structure present on every NTFS formatted partition. The MFT maintains a record for every “file” (data files and directories) on the partition and each record contains file data and metadata. For a bit more understanding of how the MFT works, I’ve included a poster I made to break down the structure of a Master File Table record below:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*7fpGVXnGJQxwapSC. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*7fpGVXnGJQxwapSC. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*7fpGVXnGJQxwapSC. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*7fpGVXnGJQxwapSC. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*7fpGVXnGJQxwapSC. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*7fpGVXnGJQxwapSC. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7fpGVXnGJQxwapSC. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*7fpGVXnGJQxwapSC. 640w, https://miro.medium.com/v2/resize:fit:720/0*7fpGVXnGJQxwapSC. 720w, https://miro.medium.com/v2/resize:fit:750/0*7fpGVXnGJQxwapSC. 750w, https://miro.medium.com/v2/resize:fit:786/0*7fpGVXnGJQxwapSC. 786w, https://miro.medium.com/v2/resize:fit:828/0*7fpGVXnGJQxwapSC. 828w, https://miro.medium.com/v2/resize:fit:1100/0*7fpGVXnGJQxwapSC. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*7fpGVXnGJQxwapSC. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="534" loading="lazy" role="presentation"/></picture></div></div></figure><p id="29b8" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Notice that an MFT Record is composed of a header that describes the record’s place in the MFT itself and an array of “Attributes.” As mentioned earlier, there are numerous attribute types and some are more common than others. For instance, every MFT Record has a $STANDARD_INFORMATION attribute and at least one $FILE_NAME attribute, while a data file will also have at least one $DATA attribute (any additional $DATA attributes are what we all know as “Alternate Data Streams”). Other attributes are used in certain situations, including $EA attributes (Extended Attributes), which seem to be used rather infrequently.</p><p id="4df5" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">With this understanding of Extended Attributes and how they fit into the MFT picture, we can begin looking at how attackers leverage this technique to achieve their objectives.</p><h1 id="db01" class="mx my gu bf mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu bk">Understand and Model Technique</h1><p id="709f" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">In the last section, we learned about NTFS, specifically the Master File Table and its $EA attribute. During our research, one thing stood out to me. You may have noticed that I mentioned Alternate Data Streams (ADS). ADS is a popular place for attackers to hide files, but the proliferation of this technique has led to the popularization of ADS detections. When we looked at the structure of the $EA attribute, it appears to be a good place to store arbitrary data that matches up with the description on the technique’s <a class="af ot" href="https://attack.mitre.org/wiki/Technique/T1096" rel="noopener ugc nofollow" target="_blank">wiki page</a>. It appears we are dealing with a creative alternative to hiding data in ADS and banking on the idea that less tools/people are looking for Extended Attributes being used to store attacker-supplied data.</p><p id="2c95" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Our background of the Master File Table, and more specifically Extended Attributes, allows us to address detecting this technique behaviorally. This portion of the process focuses on modeling the technique. This includes identifying data relating to this technique, collecting said data, and writing a simple POC to confirm your understanding and to test your data collection.</p><h2 id="2c3c" class="oz my gu bf mz pa pb dy nd pc pd ea nh og pe pf pg ok ph pi pj oo pk pl pm pn bk">Identify Related Data Set</h2><p id="23a0" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">First things first, we need to identify what data we need to collect. Some situations call for multiple data sets that must be compared to identify the malicious behavior, but in this case it appears that we only need to look for Extended Attributes throughout the file system.</p><h2 id="a75c" class="oz my gu bf mz pa pb dy nd pc pd ea nh og pe pf pg ok ph pi pj oo pk pl pm pn bk">Implement Collection</h2><p id="7bc0" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">Before we begin analyzing behavior for detections, we need to understand how to collect relevant data (in this case NTFS Extended Attributes).</p><p id="f902" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">As the developer of PowerForensics, my initial thought was to add support for $EA attributes (something I need to do anyway) and then use my MFT parser to identify all $EA attributes on the file system. After considering this method for a bit, I decided I wanted to also provide a more lightweight option that leverages the Windows API to check a file for an Extended Attribute.</p><p id="9829" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Initially, I had no idea how to enumerate Extended Attributes through the Windows API, but the ATT&amp;CK wiki pointed me to a <a class="af ot" href="http://www.symantec.com/connect/blogs/trojanzeroaccessc-hidden-ntfs-ea" rel="noopener ugc nofollow" target="_blank">blog post</a> by Symantec researcher Mircea Ciubotariu. Mircea finds that Zeroaccess Trojan used the <a class="af ot" href="https://msdn.microsoft.com/en-us/library/windows/hardware/ff961908(v=vs.85).aspx" rel="noopener ugc nofollow" target="_blank">ZwSetEaFile</a> and <a class="af ot" href="https://msdn.microsoft.com/en-us/library/windows/hardware/ff961907(v=vs.85).aspx" rel="noopener ugc nofollow" target="_blank">ZwQueryEaFile</a> functions to interact with the Extended Attributes. Awesome! We now know the API calls we need to implement to create and enumerate Extended Attributes.</p><p id="ab2e" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">NOTE: Since this is a post about methodology, I am not going to get into details about the code itself as I believe that will distract from the point of this post. I plan on writing a follow up post that will cover the specific implementation of the “Zw*EaFile” family of functions. For now, there will be a bit of hand waving just to get the point across.</p><p id="68c3" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Since this section is focusing on collection, let’s start with ZwQueryEaFile. I wrote an abstraction function for ZwQueryEaFile in PowerShell using <a class="af ot" href="https://github.com/mattifestation/PSReflect" rel="noopener ugc nofollow" target="_blank">PSReflect</a>. Below you will find the MSDN C++ function definition for ZwQueryEaFile:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*bCNHLLzKy8Dq5OLT. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*bCNHLLzKy8Dq5OLT. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*bCNHLLzKy8Dq5OLT. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*bCNHLLzKy8Dq5OLT. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*bCNHLLzKy8Dq5OLT. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*bCNHLLzKy8Dq5OLT. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bCNHLLzKy8Dq5OLT. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*bCNHLLzKy8Dq5OLT. 640w, https://miro.medium.com/v2/resize:fit:720/0*bCNHLLzKy8Dq5OLT. 720w, https://miro.medium.com/v2/resize:fit:750/0*bCNHLLzKy8Dq5OLT. 750w, https://miro.medium.com/v2/resize:fit:786/0*bCNHLLzKy8Dq5OLT. 786w, https://miro.medium.com/v2/resize:fit:828/0*bCNHLLzKy8Dq5OLT. 828w, https://miro.medium.com/v2/resize:fit:1100/0*bCNHLLzKy8Dq5OLT. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*bCNHLLzKy8Dq5OLT. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="294" loading="lazy" role="presentation"/></picture></div></div></figure><p id="8160" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">A couple of high level observations: the function appears to require multiple calls to enumerate ALL Extended Attributes (a file can have multiple $EA attributes). Also, ZwQueryEaFile requires a handle to the file you are querying, so we need to find a way to get that file handle. After a bit of Googling, I found that NtOpenFile did the trick; you can see the C++ function definition for NtOpenFile below:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*49j6pX6xsRtHP79P. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*49j6pX6xsRtHP79P. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*49j6pX6xsRtHP79P. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*49j6pX6xsRtHP79P. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*49j6pX6xsRtHP79P. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*49j6pX6xsRtHP79P. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*49j6pX6xsRtHP79P. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*49j6pX6xsRtHP79P. 640w, https://miro.medium.com/v2/resize:fit:720/0*49j6pX6xsRtHP79P. 720w, https://miro.medium.com/v2/resize:fit:750/0*49j6pX6xsRtHP79P. 750w, https://miro.medium.com/v2/resize:fit:786/0*49j6pX6xsRtHP79P. 786w, https://miro.medium.com/v2/resize:fit:828/0*49j6pX6xsRtHP79P. 828w, https://miro.medium.com/v2/resize:fit:1100/0*49j6pX6xsRtHP79P. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*49j6pX6xsRtHP79P. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="321" loading="lazy" role="presentation"/></picture></div></div></figure><p id="38ae" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Now that we presumably have all the code we need to enumerate a single file for Extended Attributes, we can wrap that functionality and recursively check every file on the file system. Our collection mechanism is now complete.</p><h2 id="aa43" class="oz my gu bf mz pa pb dy nd pc pd ea nh og pe pf pg ok ph pi pj oo pk pl pm pn bk">Implement Technique POC or Malware Sample</h2><p id="1796" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">After implementing ZwQueryEaFile, ZwSetEaFile should be pretty straightforward. Again we write an abstracted function using PSReflect, so we can add custom Extended Attributes to any file of our choosing. This function is also simpler because you are choosing the file to write to instead of looking for every instance of a file that has Extended Attributes. Below is the C++ function definition for ZwSetEaFile:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*dyq3jGGw9AQln0mO. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*dyq3jGGw9AQln0mO. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*dyq3jGGw9AQln0mO. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*dyq3jGGw9AQln0mO. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*dyq3jGGw9AQln0mO. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*dyq3jGGw9AQln0mO. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dyq3jGGw9AQln0mO. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*dyq3jGGw9AQln0mO. 640w, https://miro.medium.com/v2/resize:fit:720/0*dyq3jGGw9AQln0mO. 720w, https://miro.medium.com/v2/resize:fit:750/0*dyq3jGGw9AQln0mO. 750w, https://miro.medium.com/v2/resize:fit:786/0*dyq3jGGw9AQln0mO. 786w, https://miro.medium.com/v2/resize:fit:828/0*dyq3jGGw9AQln0mO. 828w, https://miro.medium.com/v2/resize:fit:1100/0*dyq3jGGw9AQln0mO. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*dyq3jGGw9AQln0mO. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="221" loading="lazy" role="presentation"/></picture></div></div></figure><p id="e334" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">In some cases, writing a POC could be a too big of an investment. In these situations, I like to find a malware sample that implements this technique and use that sample for testing purposes. Each technique’s wiki entry includes references to blog posts or white papers from which the technique’s knowledge was derived. These posts are often a great starting point for understanding the technique itself, as well as the way malware used it in the wild.</p><p id="8464" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Each technique wiki page includes examples of malware that leverage it. An example from the NTFS Extended Attribute entry is below:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*MxEPq2geR6F7bxWO. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*MxEPq2geR6F7bxWO. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*MxEPq2geR6F7bxWO. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*MxEPq2geR6F7bxWO. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*MxEPq2geR6F7bxWO. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*MxEPq2geR6F7bxWO. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MxEPq2geR6F7bxWO. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*MxEPq2geR6F7bxWO. 640w, https://miro.medium.com/v2/resize:fit:720/0*MxEPq2geR6F7bxWO. 720w, https://miro.medium.com/v2/resize:fit:750/0*MxEPq2geR6F7bxWO. 750w, https://miro.medium.com/v2/resize:fit:786/0*MxEPq2geR6F7bxWO. 786w, https://miro.medium.com/v2/resize:fit:828/0*MxEPq2geR6F7bxWO. 828w, https://miro.medium.com/v2/resize:fit:1100/0*MxEPq2geR6F7bxWO. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*MxEPq2geR6F7bxWO. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="101" loading="lazy" role="presentation"/></picture></div></div></figure><p id="a186" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">What if we just get a copy of Regin or Zeroaccess Trojan and test it in a lab environment? If we refer back to the articles analyzing Zeroaccess and its use of Extended Attributes, we can look for a way to identify the specific version of Zeroaccess that implements this technique. When we review Corey Harrell’s <a class="af ot" href="http://journeyintoir.blogspot.com/2012/12/extracting-zeroaccess-from-ntfs.html" rel="noopener ugc nofollow" target="_blank">post</a>, we find the hash for this version of the malware (ee14dcd20b2ee118618e3a28db72cce92ccd9e85dd8410e02479d9d624934b13). We can now use whatever means are available to us to download a copy of this file to use for testing (I found the sample on <a class="af ot" href="https://virusshare.com/" rel="noopener ugc nofollow" target="_blank">VirusShare</a>).</p><p id="c638" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Always consider reimplementing the basic functionality involved in the attack technique, as a first priority. This allows threats to be modeled on a generic level without focusing on a specific tool’s implementation. For example, in his <a class="af ot" href="http://journeyintoir.blogspot.com/2012/12/extracting-zeroaccess-from-ntfs.html" rel="noopener ugc nofollow" target="_blank">post</a> Corey Harrell provides the following description of Zeroaccess Trojan’s implementation of this technique:</p><p id="50ec" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">“<em class="po">A large amount of binary data is also written to the NTFS Extended Attributes of services.exe. … ZeroAccess uses this feature to hide a whole PE file as well as shellcode that loads the PE file. The overwritten subroutine in services.exe reads in all the data from the Extended Attributes and executes it.”</em></p><p id="7749" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">If we only analyze ZeroAccess Trojan, we may mistakenly conclude that we only need to check services.exe for Extended Attributes which would obviously not solve the problem in the way we’d like.</p><h1 id="09cf" class="mx my gu bf mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu bk">Detection</h1><p id="53da" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">With the ability to collect Extended Attributes and implement a POC “malicious EA,” we can work on identifying ways to detect malicious use specifically.</p><p id="18fc" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">The first step in building a detection is identifying normal. How normal are Extended Attributes on your average enterprise computer? Is there a different “normal” depending on the Operating System version? Do these normal instances follow an identifiable pattern? If we can answer these questions, then we can begin to wrap our heads around identifying the malicious use or more generically, deviations from normal.</p><p id="0381" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">One thing that is important to remember in this case is that attackers aren’t using Extended Attributes for their original purpose. Attackers are using them as data storage (often PE files) which is not consistent with the “key/value pair” concept we saw in documentation. This information can help us look for patterns when considering normal use versus malicious use.</p><p id="f2ab" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">I put together a couple PowerShell functions to recursively enumerate all files for Extended Attributes (details will be discussed in a future post). You can find my code at the end of the post.</p><p id="c69c" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">First, I ran the function on a stock Windows 7 VM which came back with exactly 0 EAs. This lines up with our original assumption that Extended Attributes are a legacy compatibility feature that is no longer used in modern operating systems. As I mentioned earlier, just because a stock Windows 7 image has no EAs does not mean that this is the default behavior on all OS’s. For this reason I decided to test a Windows 10 VM as well.</p><p id="e3d9" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Before running my Windows 10 test, I wrote an Extended Attribute named <strong class="nx gv">TEST</strong> to a file located at C:\demo\ea.exe. I want to make sure the function detects my custom EA, as well as, any built in EAs.</p><p id="e917" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Next, I ran the function on my Windows 10 VM and found 35751 EAs! Either EAs made a come back, or I’m pwned! To get an idea of what is going on, I used PowerShell’s Group-Object cmdlet to group all EAs based on name to see if there is an identifiable pattern.</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Gtx0Gz7-pa6s2xaG. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Gtx0Gz7-pa6s2xaG. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Gtx0Gz7-pa6s2xaG. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Gtx0Gz7-pa6s2xaG. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Gtx0Gz7-pa6s2xaG. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Gtx0Gz7-pa6s2xaG. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Gtx0Gz7-pa6s2xaG. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Gtx0Gz7-pa6s2xaG. 640w, https://miro.medium.com/v2/resize:fit:720/0*Gtx0Gz7-pa6s2xaG. 720w, https://miro.medium.com/v2/resize:fit:750/0*Gtx0Gz7-pa6s2xaG. 750w, https://miro.medium.com/v2/resize:fit:786/0*Gtx0Gz7-pa6s2xaG. 786w, https://miro.medium.com/v2/resize:fit:828/0*Gtx0Gz7-pa6s2xaG. 828w, https://miro.medium.com/v2/resize:fit:1100/0*Gtx0Gz7-pa6s2xaG. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Gtx0Gz7-pa6s2xaG. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="189" loading="lazy" role="presentation"/></picture></div></div></figure><p id="10a7" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">35749 out of 35751 EAs are named either <strong class="nx gv">$CI.CATALOGHINT</strong> or <strong class="nx gv">$KERNEL.PURGE.ESBCACHE</strong>. The remaining two EAs are my “TEST” EA and one named <strong class="nx gv">$KERNEL.PURGE.CATALOGHINT</strong> which appears related to the other built in EAs.</p><p id="39d9" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Now we want to see if we can understand the purpose of these EAs. I’ll start with the most prevalent EA <strong class="nx gv">$CI.CATALOGHINT</strong>. Let’s take a look at one:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*tc7WOgfjnRi9dnMt. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*tc7WOgfjnRi9dnMt. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*tc7WOgfjnRi9dnMt. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*tc7WOgfjnRi9dnMt. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*tc7WOgfjnRi9dnMt. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*tc7WOgfjnRi9dnMt. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tc7WOgfjnRi9dnMt. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*tc7WOgfjnRi9dnMt. 640w, https://miro.medium.com/v2/resize:fit:720/0*tc7WOgfjnRi9dnMt. 720w, https://miro.medium.com/v2/resize:fit:750/0*tc7WOgfjnRi9dnMt. 750w, https://miro.medium.com/v2/resize:fit:786/0*tc7WOgfjnRi9dnMt. 786w, https://miro.medium.com/v2/resize:fit:828/0*tc7WOgfjnRi9dnMt. 828w, https://miro.medium.com/v2/resize:fit:1100/0*tc7WOgfjnRi9dnMt. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*tc7WOgfjnRi9dnMt. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="127" loading="lazy" role="presentation"/></picture></div></div></figure><p id="305b" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Upon further review, it appears that all <strong class="nx gv">$CI.CATALOGHINT</strong> EAs have a value that is related to a .cat file or a “<a class="af ot" href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/catalog-files" rel="noopener ugc nofollow" target="_blank">digitally-signed catalog file</a>”. These are files that are used to verify the digital signature of other files as a collection and alternative to Authenticode signing each individual file.</p><p id="9e44" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">We can assume that the catalog referenced in the EA is the catalog file that would be used to validate our file’s signature (C:\Windows\bfsvc.exe), but it is best not to assume. We use PowerShell’s Get-AuthenticodeSignature cmdlet to check the digital signature of C:\Windows\bfsvc.exe and it tells us that the file is indeed “Catalog” signed.</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*h7o2AwsIBn3ax5qw. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*h7o2AwsIBn3ax5qw. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*h7o2AwsIBn3ax5qw. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*h7o2AwsIBn3ax5qw. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*h7o2AwsIBn3ax5qw. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*h7o2AwsIBn3ax5qw. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*h7o2AwsIBn3ax5qw. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*h7o2AwsIBn3ax5qw. 640w, https://miro.medium.com/v2/resize:fit:720/0*h7o2AwsIBn3ax5qw. 720w, https://miro.medium.com/v2/resize:fit:750/0*h7o2AwsIBn3ax5qw. 750w, https://miro.medium.com/v2/resize:fit:786/0*h7o2AwsIBn3ax5qw. 786w, https://miro.medium.com/v2/resize:fit:828/0*h7o2AwsIBn3ax5qw. 828w, https://miro.medium.com/v2/resize:fit:1100/0*h7o2AwsIBn3ax5qw. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*h7o2AwsIBn3ax5qw. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="279" loading="lazy" role="presentation"/></picture></div></div></figure><p id="495e" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Next we check the catalog file’s digital signature and it turns out that the catalog file is Authenticode signed (the file itself contains an embedded signature).</p></div></div><div class="qf"><div class="ab cb"><div class="lz qt ma qu mb qv cf qw cg qx ci bh"><figure class="qa qb qc qd qe qf qy qz paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*ioo7Jq1cNCS7WBhQ. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*ioo7Jq1cNCS7WBhQ. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*ioo7Jq1cNCS7WBhQ. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*ioo7Jq1cNCS7WBhQ. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*ioo7Jq1cNCS7WBhQ. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*ioo7Jq1cNCS7WBhQ. 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*ioo7Jq1cNCS7WBhQ. 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*ioo7Jq1cNCS7WBhQ. 640w, https://miro.medium.com/v2/resize:fit:720/0*ioo7Jq1cNCS7WBhQ. 720w, https://miro.medium.com/v2/resize:fit:750/0*ioo7Jq1cNCS7WBhQ. 750w, https://miro.medium.com/v2/resize:fit:786/0*ioo7Jq1cNCS7WBhQ. 786w, https://miro.medium.com/v2/resize:fit:828/0*ioo7Jq1cNCS7WBhQ. 828w, https://miro.medium.com/v2/resize:fit:1100/0*ioo7Jq1cNCS7WBhQ. 1100w, https://miro.medium.com/v2/resize:fit:2000/0*ioo7Jq1cNCS7WBhQ. 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh me qg c" width="1000" height="282" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="ffe8" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">One thing to notice is that both files have an identical Thumbprint. This proves that the catalog file referenced in the <strong class="nx gv">$CI.CATALOGHINT </strong>EA is the catalog used to validate the base file’s digital signature. Another way to resolve what catalog to use for validating a file is to use <a class="af ot" href="https://technet.microsoft.com/en-us/sysinternals/bb897441.aspx" rel="noopener ugc nofollow" target="_blank">sigcheck</a> sysinternals with the <strong class="nx gv">-i</strong> parameter.</p><p id="766c" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">When I thought about why this EA is unique to Windows 10, it struck me that $CI likely stands for Code Integrity which is related to Device Guard. This is a security feature included in Windows 10, but unfortunately there is literally no documentation how Device Guard interacts with Extended Attributes. We can now make an educated guess as to the purpose of the <strong class="nx gv">$CI.CATALOGHINT</strong>.</p><p id="cff6" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">I will leave the other two EAs as an exercise for the reader, but I’d recommend investigating the relationship between <strong class="nx gv">$KERNEL.PURGE.ESBCACHE </strong>and the <a class="af ot" href="https://msdn.microsoft.com/en-us/library/aa475433(v=bts.10).aspx" rel="noopener ugc nofollow" target="_blank">Enterprise Service Bus</a>. I also stumbled upon this <a class="af ot" href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/kernel-extended-attributes" rel="noopener ugc nofollow" target="_blank">page</a> which describes the <strong class="nx gv">$KERNEL.PURGE </strong>prefix with the statement below:</p><figure class="qa qb qc qd qe qf px py paragraph-image"><div role="button" tabindex="0" class="qm qn fj qo bh qp"><div class="px py ra"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*DQfSQQ7YM49OZo06. 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*DQfSQQ7YM49OZo06. 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*DQfSQQ7YM49OZo06. 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*DQfSQQ7YM49OZo06. 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*DQfSQQ7YM49OZo06. 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*DQfSQQ7YM49OZo06. 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DQfSQQ7YM49OZo06. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*DQfSQQ7YM49OZo06. 640w, https://miro.medium.com/v2/resize:fit:720/0*DQfSQQ7YM49OZo06. 720w, https://miro.medium.com/v2/resize:fit:750/0*DQfSQQ7YM49OZo06. 750w, https://miro.medium.com/v2/resize:fit:786/0*DQfSQQ7YM49OZo06. 786w, https://miro.medium.com/v2/resize:fit:828/0*DQfSQQ7YM49OZo06. 828w, https://miro.medium.com/v2/resize:fit:1100/0*DQfSQQ7YM49OZo06. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*DQfSQQ7YM49OZo06. 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me qg c" width="700" height="349" loading="eager" role="presentation"/></picture></div></div></figure><p id="aa6f" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">I’m interested to hear what EAs you come across and how you think they are being used!</p><p id="9c56" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">Hopefully, this example demonstrated the process I like to follow to understand “normal” behavior on a system.</p><h2 id="7584" class="oz my gu bf mz pa pb dy nd pc pd ea nh og pe pf pg ok ph pi pj oo pk pl pm pn bk">Test Detection at Scale</h2><p id="539c" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">It’s one thing to get a working detection on one machine in your test lab, but things can surprise you when you attempt to apply that detection at scale. Once we have identified a detection with fairly low false positive rates in the lab, we need to see how that detection works at scale.</p><p id="b702" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">In my testing, Extended Attributes seem to remain consistent in large environments. In order to not skip this section, I want to describe how to approach this portion of the methodology from the perspective of the <a class="af ot" href="https://adsecurity.org/?p=1640" rel="noopener ugc nofollow" target="_blank">Golden Ticket</a> technique. When I think of detections that work in labs, but needed a little more thought after testing at scale, I think of some of the problems I faced with detections I use for Golden Tickets.</p><p id="4793" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">The original assumption was Kerberos tickets (both Ticket Granting Tickets and Service Tickets), in modern environments, should not use RC4 encryption. In our lab environment, this was true and a 100% detection. While an adversary could upgrade to AES encryption, any ticket with RC4 was in fact malicious. We decided to test this at scale and collect tickets across a fairly large environment, and were surprised when we saw TONS of RC4 and therefore, appeared to be TONS of Golden Tickets in the environment (fortunately this was not the case!). After some research and consulting with Sean Metcalf (<a class="af ot" href="https://twitter.com/PyroTek3" rel="noopener ugc nofollow" target="_blank">@PyroTek3</a>) over at <a class="af ot" href="https://trimarcsecurity.com/" rel="noopener ugc nofollow" target="_blank">Trimarc Security</a>, it turns out that cross-domain and cross-forest tickets use RC4 by default. I assume this is to maintain backward compatibility in cases where the domain being requested is not functional level 2008. Testing this detection at scale can prevent a large amount of effort on trying to address false positives in the future.</p><p id="6f41" class="pw-post-body-paragraph nv nw gu nx b ny ou oa ob oc ov oe of og ow oi oj ok ox om on oo oy oq or os gn bk">This step of the process should also be catered to your environment. For example, many organizations have very few WMI Permanent Event Subscriptions, but maybe someone in your organization has found a useful way to leverage this technology. In most companies, you are unlikely to learn about that just by asking around. Many organizations are too complex for any individual to know everything. The only true way to know how each technology/technique is used in your environment is to look yourself. Every network has its own unique quirks that are sure to surprise you.</p><h1 id="bad6" class="mx my gu bf mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu bk">Conclusion</h1><p id="4601" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">So why go through this lengthy process to build detections? A mature threat hunting program continuously maps documented attack techniques (those found in the MITRE ATT&amp;CK Framework) to durable, behavior based detections. Target techniques should be identified based on your resources and you should cover as much of the attack chain as possible. An attacker must evade all detections throughout the chain to be successful. There is an implicit need to fully understand a technology in order to identify detections that are neither too tactical in nature (something an adversary can easily change) nor too broad (with a high false positive rate). Hopefully this methodology can help your organization work toward a more mature threat hunting program.</p></div></div></div><div class="ab cb rb rc rd re" role="separator"><span class="rf by bm rg rh ri"></span><span class="rf by bm rg rh ri"></span><span class="rf by bm rg rh"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="0717" class="mx my gu bf mz na rj nc nd ne rk ng nh ni rl nk nl nm rm no np nq rn ns nt nu bk">Code Snippet</h1><p id="2013" class="pw-post-body-paragraph nv nw gu nx b ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os gn bk">The following code is for demonstration purposes only. It is quite inefficient in how it recursively traverses the file system. Additionally, the code has a dependency on Matt Graeber’s <a class="af ot" href="https://github.com/mattifestation/psreflect" rel="noopener ugc nofollow" target="_blank">PSReflect</a> project.</p><figure class="qa qb qc qd qe qf"><div class="ro jf l fj"><div class="rp rq l"></div></div></figure></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rr rs ab ja"><div class="rt ab"><a class="ru ay am ao" href="https://medium.com/tag/threat-hunting?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><div class="rv fj cx rw ge rx ry bf b bg z bk rz">Threat Hunting</div></a></div><div class="rt ab"><a class="ru ay am ao" href="https://medium.com/tag/dfir?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><div class="rv fj cx rw ge rx ry bf b bg z bk rz">Dfir</div></a></div><div class="rt ab"><a class="ru ay am ao" href="https://medium.com/tag/specterops?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><div class="rv fj cx rw ge rx ry bf b bg z bk rz">Specterops</div></a></div><div class="rt ab"><a class="ru ay am ao" href="https://medium.com/tag/powershell?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><div class="rv fj cx rw ge rx ry bf b bg z bk rz">Powershell</div></a></div></div></div></div><div class="l"></div><footer class="sa sb sc sd se sf sg sh si ab q sj ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sk"><div class="ab q kv"><div class="sl l"><span class="l sm sn so e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=-----a9dbbb53d5ea---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f sp sq"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=-----a9dbbb53d5ea---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la ls lt ab q fk lu lv" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z du"><span class="pw-responses-count lq lr">1</span></p></button></div></div></div></div><div class="ab q"><div class="ri l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lx" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="ri l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sr ss st su sv l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab sw cp"><div class="ab ia"><a href="https://medium.com/@jaredcatkinson?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><div class="l sx sy by sz ie"><div class="l fj"><img alt="Jared Atkinson" class="l fd by ta tb cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg" width="72" height="72" loading="lazy"/><div class="if by l ta tb fs n ig ft"></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><div class="tc ab fj"><div><div class="bm" aria-hidden="false"><div class="l td te by sz ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*D-FDlfkqivRBQZoESrwtqw.png" width="32" height="32" loading="lazy"/><div class="if by l bz ca fs n ig ft"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><a class="bf b bg z ep rv eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb206c297df42&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=post_page-b206c297df42----a9dbbb53d5ea---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbca152e9d97b&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;newsletterV3=b206c297df42&amp;newsletterV3Id=bca152e9d97b&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=-----a9dbbb53d5ea---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tg am th ti tj tk tl tm tn to ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tf te td"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@jaredcatkinson?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf tp tq tr ts bk"><span class="gn jo">Written by <!-- -->Jared Atkinson</span></h2></a></div><div class="rt ab"><div class="l ix"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://medium.com/@jaredcatkinson/followers?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow">941 Followers</a></span></div><div class="bf b bg z jf jg jh ab jj jk jl jm du jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l ix">Editor for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" href="https://posts.specterops.io/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="tt l"></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z ep rv eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb206c297df42&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=post_page-b206c297df42----a9dbbb53d5ea---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbca152e9d97b&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;newsletterV3=b206c297df42&amp;newsletterV3Id=bca152e9d97b&amp;user=Jared+Atkinson&amp;userId=b206c297df42&amp;source=-----a9dbbb53d5ea---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tg am th ti tj tk tl tm tn to ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tf te td"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tu bh tv tw tx ty tz ua"></div></div></div><div class="h k j"><div class="tu bh tv ub"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="uc ab kv ja"><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="ud l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241017-182126-a0128a89d2"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-a9dbbb53d5ea","user-b206c297df42","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true},"viewerIsBot":false},"debug":{"requestId":"832a8633-17f2-45b4-87fb-353864ac5ff5","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-cd88624e78fe46b6d7304ea0fa96c803-1e2bbf01a98ba9da-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20241017-182126-a0128a89d2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241017-182126-a0128a89d2","commit":"a0128a89d2d76bfa55b25492370b0bae4050224f"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_boost_nia_v01","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_ranker_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_indexeddb","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"posts.specterops.io\"})":{"__ref":"Collection:f05f8696e3cc"},"viewer":null,"postResult({\"id\":\"a9dbbb53d5ea\"})":{"__ref":"Post:a9dbbb53d5ea"}},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"__typename":"ImageMetadata","id":"1*D-FDlfkqivRBQZoESrwtqw.png"},"Collection:f05f8696e3cc":{"__typename":"Collection","id":"f05f8696e3cc","favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"googleAnalyticsId":"UA-102239211-2","editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:74ad66811b78"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:70f84c574024"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f4ab382d41"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1bb43103a9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b9c2df322eaf"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b206c297df42"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d59f95c1ed1c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6e849bed7683"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:9bef3c9a8b49"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:10eca8f7a844"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d248a36145f8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:2562fc45d9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:645ffcef8682"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a041d7ac11fe"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:507d73de7b97"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:e7dfc7678b59"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ff850017e32a"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4d7214ceeaf8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:760e415ea3c9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f95d89c4ba81"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:59a56792287a"}}],"name":"Posts By SpecterOps Team Members","avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"domain":"posts.specterops.io","slug":"specter-ops-posts","description":"Posts from SpecterOps team members on various topics relating information security","subscriberCount":4702,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__typename":"Post","title":"Closing the Gaps: How Attack Path Management Improves Vulnerability Management Programs","latestPublishedAt":1727878988539}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_e78bbf760c55"},"twitterUsername":"specterops","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"User:74ad66811b78":{"__typename":"User","id":"74ad66811b78"},"User:70f84c574024":{"__typename":"User","id":"70f84c574024"},"User:f4ab382d41":{"__typename":"User","id":"f4ab382d41"},"User:1bb43103a9a9":{"__typename":"User","id":"1bb43103a9a9"},"User:b9c2df322eaf":{"__typename":"User","id":"b9c2df322eaf"},"User:b206c297df42":{"__typename":"User","id":"b206c297df42","name":"Jared Atkinson","username":"jaredcatkinson","newsletterV3":{"__ref":"NewsletterV3:bca152e9d97b"},"linkedAccounts":{"__ref":"LinkedAccounts:b206c297df42"},"isSuspended":false,"imageId":"1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":941},"customDomainState":null,"hasSubdomain":false,"bio":"","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:b206c297df42-viewerId:lo_e78bbf760c55"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":null,"allowNotes":true,"twitterScreenName":"jaredcatkinson"},"User:d59f95c1ed1c":{"__typename":"User","id":"d59f95c1ed1c"},"User:6e849bed7683":{"__typename":"User","id":"6e849bed7683"},"User:9bef3c9a8b49":{"__typename":"User","id":"9bef3c9a8b49"},"User:10eca8f7a844":{"__typename":"User","id":"10eca8f7a844"},"User:d248a36145f8":{"__typename":"User","id":"d248a36145f8"},"User:2562fc45d9a9":{"__typename":"User","id":"2562fc45d9a9"},"User:645ffcef8682":{"__typename":"User","id":"645ffcef8682"},"User:a041d7ac11fe":{"__typename":"User","id":"a041d7ac11fe"},"User:507d73de7b97":{"__typename":"User","id":"507d73de7b97"},"User:e7dfc7678b59":{"__typename":"User","id":"e7dfc7678b59"},"User:ff850017e32a":{"__typename":"User","id":"ff850017e32a"},"User:4d7214ceeaf8":{"__typename":"User","id":"4d7214ceeaf8"},"User:760e415ea3c9":{"__typename":"User","id":"760e415ea3c9"},"User:f95d89c4ba81":{"__typename":"User","id":"f95d89c4ba81"},"User:59a56792287a":{"__typename":"User","id":"59a56792287a"},"LinkedAccounts:b206c297df42":{"__typename":"LinkedAccounts","mastodon":null,"id":"b206c297df42"},"UserViewerEdge:userId:b206c297df42-viewerId:lo_e78bbf760c55":{"__typename":"UserViewerEdge","id":"userId:b206c297df42-viewerId:lo_e78bbf760c55","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:bca152e9d97b":{"__typename":"NewsletterV3","id":"bca152e9d97b","type":"NEWSLETTER_TYPE_AUTHOR","slug":"b206c297df42","name":"b206c297df42","collection":null,"user":{"__ref":"User:b206c297df42"}},"Paragraph:b6654670b1e4_0":{"__typename":"Paragraph","id":"b6654670b1e4_0","name":"1a73","type":"H3","href":null,"layout":null,"metadata":null,"text":"Host-based Threat Modeling & Indicator Design","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_1":{"__typename":"Paragraph","id":"b6654670b1e4_1","name":"d4e5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Introduction and Background","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_2":{"__typename":"Paragraph","id":"b6654670b1e4_2","name":"9edc","type":"P","href":null,"layout":null,"metadata":null,"text":"Last week, my colleague Brian Reitz (@brian_psu) wrote a brilliant post about leveraging PSReflect to model malware techniques. This post builds upon his thought process and explicitly lays out SpecterOps’ methodology surrounding threat modeling and design of defensive indicators.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":37,"end":47,"href":"https:\u002F\u002Ftwitter.com\u002Fbrian_psu","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":67,"end":71,"href":"https:\u002F\u002Fposts.specterops.io\u002Fhiding-registry-keys-with-psreflect-b18ec5ac8353","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":89,"end":98,"href":"https:\u002F\u002Fgithub.com\u002Fmattifestation\u002FPSReflect","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_3":{"__typename":"Paragraph","id":"b6654670b1e4_3","name":"a087","type":"P","href":null,"layout":null,"metadata":null,"text":"Ultimately, this process is designed to facilitate researching a technique from the underlying technology all the way to specific implementations. We start by identifying the offensive technique we want to focus on. Once we have a technique, we identify the actual technology that the technique targets. This step forces us to look at the technique from the macro level, while still maintaining a technical perspective. For the next portion of the process we will build on the knowledge we gained to identify relevant data sets, understand how to collect it, and write a proof-of-concept (POC) for implementing the specific attack technique. With these tools we can then begin to understand the technology’s normal behavior and identify how the attack technique deviates from normal as well as validate any assumptions made along the way. Lastly, we will check how the scale of an enterprise environment challenges our assumption and adapt our detection based on this reality.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_4":{"__typename":"Paragraph","id":"b6654670b1e4_4","name":"c52b","type":"P","href":null,"layout":null,"metadata":null,"text":"In this post I will leverage the MITRE ATT&CK Framework to identify post-exploitation techniques that we may want to focus on.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":33,"end":55,"href":"http:\u002F\u002Fattack.mitre.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_5":{"__typename":"Paragraph","id":"b6654670b1e4_5","name":"dcf5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Methodology","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_6":{"__typename":"Paragraph","id":"b6654670b1e4_6","name":"05d4","type":"P","href":null,"layout":null,"metadata":null,"text":"Describing the methodology seems to make the most sense if I work through it using an actual example technique. For the remainder of the post, I will explain my thought process on detecting malicious use of NTFS Extended Attributes (ATT&CK: T1096 — Defense Evasion\u002FNTFS Extended Attributes), a technique used by the Zeroaccess Trojan since at least 2012.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":233,"end":289,"href":"https:\u002F\u002Fattack.mitre.org\u002Fwiki\u002FTechnique\u002FT1096","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_7":{"__typename":"Paragraph","id":"b6654670b1e4_7","name":"5d85","type":"H4","href":null,"layout":null,"metadata":null,"text":"Research Underlying Technology","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_8":{"__typename":"Paragraph","id":"b6654670b1e4_8","name":"135d","type":"P","href":null,"layout":null,"metadata":null,"text":"Developing a lasting behavioral detection requires a solid understanding not only of the possible attacker implementations of the technique, but of the underlying technology as well. In this case, how can we truly detect the malicious use of NTFS Extended Attributes (EA) if we don’t actually understand them?! A good place to start delving into this technology is the ATT&CK Framework’s wiki entry for our chosen technique. If we refer to the technique’s wiki we can see the description of the attack and how adversaries leverage this technique to evade in-place defenses:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_9":{"__typename":"Paragraph","id":"b6654670b1e4_9","name":"70e7","type":"P","href":null,"layout":null,"metadata":null,"text":"“Data or executables may be stored in New Technology File System (NTFS) partition metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":217,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_10":{"__typename":"Paragraph","id":"b6654670b1e4_10","name":"6a0e","type":"P","href":null,"layout":null,"metadata":null,"text":"The NTFS format has a feature called Extended Attributes (EA), which allows data to be stored as an attribute of a file or folder.”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_11":{"__typename":"Paragraph","id":"b6654670b1e4_11","name":"9dd6","type":"P","href":null,"layout":null,"metadata":null,"text":"After reading this, I walk away with some level of understanding, but I also have some questions. Let’s take a look at what we know after reading these sentences:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_12":{"__typename":"Paragraph","id":"b6654670b1e4_12","name":"b0c3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Attackers are hiding data in NTFS metadata structures (namely Extended Attributes).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_13":{"__typename":"Paragraph","id":"b6654670b1e4_13","name":"d9f4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Data is being hidden so the attacker can bypass AV and other automated scanning solutions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_14":{"__typename":"Paragraph","id":"b6654670b1e4_14","name":"6627","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s take a peek at the questions I’ve come up with:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_15":{"__typename":"Paragraph","id":"b6654670b1e4_15","name":"49f9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"What are Extended Attributes?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_16":{"__typename":"Paragraph","id":"b6654670b1e4_16","name":"62d4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Where are Extended Attributes stored?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_17":{"__typename":"Paragraph","id":"b6654670b1e4_17","name":"7c87","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Why are attackers using Extended Attributes?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_18":{"__typename":"Paragraph","id":"b6654670b1e4_18","name":"a71e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Is there any particular advantage to this technique?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_19":{"__typename":"Paragraph","id":"b6654670b1e4_19","name":"c875","type":"ULI","href":null,"layout":null,"metadata":null,"text":"How are the attackers interacting with the Extended Attributes (storing and retrieving data)?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_20":{"__typename":"Paragraph","id":"b6654670b1e4_20","name":"3a23","type":"P","href":null,"layout":null,"metadata":null,"text":"Ok! Lets see what we can do to answer these questions!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_21":{"__typename":"Paragraph","id":"b6654670b1e4_21","name":"8abb","type":"P","href":null,"layout":null,"metadata":null,"text":"First things first, we know that EAs are part of NTFS, so we should start by checking out some NTFS documentation. Technically speaking, NTFS is a proprietary file system, so we cannot simply find information about Extended Attributes on MSDN. Luckily, Richard Russon provides excellent documentation derived from the Linux NTFS driver project. While working on PowerForensics development, this is my first stop when I have an NTFS related question. The page is a gold mine of information about NTFS, including the most niche details about the Master File Table (MFT) and its attributes.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":287,"end":300,"href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Findex.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":362,"end":376,"href":"https:\u002F\u002Fgithub.com\u002Finvoke-ir\u002Fpowerforensics","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_22":{"__typename":"Paragraph","id":"b6654670b1e4_22","name":"4560","type":"P","href":null,"layout":null,"metadata":null,"text":"Upon arriving on the page, I searched for “Extended Attribute” and was directed to the $EA page. The “Overview” section describes the $EA attribute as:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":87,"end":95,"href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fea.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_23":{"__typename":"Paragraph","id":"b6654670b1e4_23","name":"929a","type":"P","href":null,"layout":null,"metadata":null,"text":"“Used to implement the HPFS extended attribute under NTFS. This file attribute may be non-resident because its stream is likely to grow.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":1,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_24":{"__typename":"Paragraph","id":"b6654670b1e4_24","name":"0c98","type":"P","href":null,"layout":null,"metadata":null,"text":"As defined in $AttrDef, this attribute has a no minimum size but a maximum of 65536 bytes.”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":14,"end":22,"href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Ffiles\u002Fattrdef.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_25":{"__typename":"Paragraph","id":"b6654670b1e4_25","name":"ec2c","type":"P","href":null,"layout":null,"metadata":null,"text":"The documentation also provides a the $EA attribute data structure as shown below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vd9kotlrDoDOzZeZ5hpNsQ.png":{"__typename":"ImageMetadata","id":"1*vd9kotlrDoDOzZeZ5hpNsQ.png","originalHeight":340,"originalWidth":646,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_26":{"__typename":"Paragraph","id":"b6654670b1e4_26","name":"950a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vd9kotlrDoDOzZeZ5hpNsQ.png"},"text":"$EA attribute structure retrieved from https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fea.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":39,"end":93,"href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fea.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_27":{"__typename":"Paragraph","id":"b6654670b1e4_27","name":"e6a1","type":"P","href":null,"layout":null,"metadata":null,"text":"Turns out Extended Attributes are Master File Table attributes, meaning it serves to provide some sort of metadata about a file. For some context, a few of the more well known attributes are the $STANDARD_INFORMATION attribute (stores the timestamps we see in File Explorer), the $FILE_NAME attribute (keeps track of the file’s name), and the $DATA attribute (which contains or points to the file’s contents). It also looks like the $EA is used for compatibility with the High Performance File System (HPFS), which is a legacy file system that is unlikely to be used in conjunction with modern operating systems. I also see that a $EA is basically a name\u002Fvalue pair where the Value field can store arbitrary data (possibly code) with a maximum size of ~65536 bytes.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":195,"end":216,"href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fstandard_information.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":280,"end":290,"href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Ffile_name.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":343,"end":348,"href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fdata.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_28":{"__typename":"Paragraph","id":"b6654670b1e4_28","name":"21fc","type":"P","href":null,"layout":null,"metadata":null,"text":"With a generic concept of EA, we can look at the overarching concept of the Master File Table. The MFT is a metadata structure present on every NTFS formatted partition. The MFT maintains a record for every “file” (data files and directories) on the partition and each record contains file data and metadata. For a bit more understanding of how the MFT works, I’ve included a poster I made to break down the structure of a Master File Table record below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*7fpGVXnGJQxwapSC.":{"__typename":"ImageMetadata","id":"0*7fpGVXnGJQxwapSC.","originalHeight":1219,"originalWidth":1600,"focusPercentX":51,"focusPercentY":9,"alt":null},"Paragraph:b6654670b1e4_29":{"__typename":"Paragraph","id":"b6654670b1e4_29","name":"e9f3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*7fpGVXnGJQxwapSC."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_30":{"__typename":"Paragraph","id":"b6654670b1e4_30","name":"29b8","type":"P","href":null,"layout":null,"metadata":null,"text":"Notice that an MFT Record is composed of a header that describes the record’s place in the MFT itself and an array of “Attributes.” As mentioned earlier, there are numerous attribute types and some are more common than others. For instance, every MFT Record has a $STANDARD_INFORMATION attribute and at least one $FILE_NAME attribute, while a data file will also have at least one $DATA attribute (any additional $DATA attributes are what we all know as “Alternate Data Streams”). Other attributes are used in certain situations, including $EA attributes (Extended Attributes), which seem to be used rather infrequently.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_31":{"__typename":"Paragraph","id":"b6654670b1e4_31","name":"4df5","type":"P","href":null,"layout":null,"metadata":null,"text":"With this understanding of Extended Attributes and how they fit into the MFT picture, we can begin looking at how attackers leverage this technique to achieve their objectives.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_32":{"__typename":"Paragraph","id":"b6654670b1e4_32","name":"db01","type":"H3","href":null,"layout":null,"metadata":null,"text":"Understand and Model Technique","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_33":{"__typename":"Paragraph","id":"b6654670b1e4_33","name":"709f","type":"P","href":null,"layout":null,"metadata":null,"text":"In the last section, we learned about NTFS, specifically the Master File Table and its $EA attribute. During our research, one thing stood out to me. You may have noticed that I mentioned Alternate Data Streams (ADS). ADS is a popular place for attackers to hide files, but the proliferation of this technique has led to the popularization of ADS detections. When we looked at the structure of the $EA attribute, it appears to be a good place to store arbitrary data that matches up with the description on the technique’s wiki page. It appears we are dealing with a creative alternative to hiding data in ADS and banking on the idea that less tools\u002Fpeople are looking for Extended Attributes being used to store attacker-supplied data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":523,"end":532,"href":"https:\u002F\u002Fattack.mitre.org\u002Fwiki\u002FTechnique\u002FT1096","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_34":{"__typename":"Paragraph","id":"b6654670b1e4_34","name":"2c95","type":"P","href":null,"layout":null,"metadata":null,"text":"Our background of the Master File Table, and more specifically Extended Attributes, allows us to address detecting this technique behaviorally. This portion of the process focuses on modeling the technique. This includes identifying data relating to this technique, collecting said data, and writing a simple POC to confirm your understanding and to test your data collection.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_35":{"__typename":"Paragraph","id":"b6654670b1e4_35","name":"2c3c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Identify Related Data Set","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_36":{"__typename":"Paragraph","id":"b6654670b1e4_36","name":"23a0","type":"P","href":null,"layout":null,"metadata":null,"text":"First things first, we need to identify what data we need to collect. Some situations call for multiple data sets that must be compared to identify the malicious behavior, but in this case it appears that we only need to look for Extended Attributes throughout the file system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_37":{"__typename":"Paragraph","id":"b6654670b1e4_37","name":"a75c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implement Collection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_38":{"__typename":"Paragraph","id":"b6654670b1e4_38","name":"7bc0","type":"P","href":null,"layout":null,"metadata":null,"text":"Before we begin analyzing behavior for detections, we need to understand how to collect relevant data (in this case NTFS Extended Attributes).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_39":{"__typename":"Paragraph","id":"b6654670b1e4_39","name":"f902","type":"P","href":null,"layout":null,"metadata":null,"text":"As the developer of PowerForensics, my initial thought was to add support for $EA attributes (something I need to do anyway) and then use my MFT parser to identify all $EA attributes on the file system. After considering this method for a bit, I decided I wanted to also provide a more lightweight option that leverages the Windows API to check a file for an Extended Attribute.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_40":{"__typename":"Paragraph","id":"b6654670b1e4_40","name":"9829","type":"P","href":null,"layout":null,"metadata":null,"text":"Initially, I had no idea how to enumerate Extended Attributes through the Windows API, but the ATT&CK wiki pointed me to a blog post by Symantec researcher Mircea Ciubotariu. Mircea finds that Zeroaccess Trojan used the ZwSetEaFile and ZwQueryEaFile functions to interact with the Extended Attributes. Awesome! We now know the API calls we need to implement to create and enumerate Extended Attributes.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":123,"end":132,"href":"http:\u002F\u002Fwww.symantec.com\u002Fconnect\u002Fblogs\u002Ftrojanzeroaccessc-hidden-ntfs-ea","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":220,"end":231,"href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fhardware\u002Fff961908(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":236,"end":249,"href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fhardware\u002Fff961907(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_41":{"__typename":"Paragraph","id":"b6654670b1e4_41","name":"ab2e","type":"P","href":null,"layout":null,"metadata":null,"text":"NOTE: Since this is a post about methodology, I am not going to get into details about the code itself as I believe that will distract from the point of this post. I plan on writing a follow up post that will cover the specific implementation of the “Zw*EaFile” family of functions. For now, there will be a bit of hand waving just to get the point across.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_42":{"__typename":"Paragraph","id":"b6654670b1e4_42","name":"68c3","type":"P","href":null,"layout":null,"metadata":null,"text":"Since this section is focusing on collection, let’s start with ZwQueryEaFile. I wrote an abstraction function for ZwQueryEaFile in PowerShell using PSReflect. Below you will find the MSDN C++ function definition for ZwQueryEaFile:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":148,"end":157,"href":"https:\u002F\u002Fgithub.com\u002Fmattifestation\u002FPSReflect","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*bCNHLLzKy8Dq5OLT.":{"__typename":"ImageMetadata","id":"0*bCNHLLzKy8Dq5OLT.","originalHeight":672,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_43":{"__typename":"Paragraph","id":"b6654670b1e4_43","name":"9ea9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*bCNHLLzKy8Dq5OLT."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_44":{"__typename":"Paragraph","id":"b6654670b1e4_44","name":"8160","type":"P","href":null,"layout":null,"metadata":null,"text":"A couple of high level observations: the function appears to require multiple calls to enumerate ALL Extended Attributes (a file can have multiple $EA attributes). Also, ZwQueryEaFile requires a handle to the file you are querying, so we need to find a way to get that file handle. After a bit of Googling, I found that NtOpenFile did the trick; you can see the C++ function definition for NtOpenFile below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*49j6pX6xsRtHP79P.":{"__typename":"ImageMetadata","id":"0*49j6pX6xsRtHP79P.","originalHeight":732,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_45":{"__typename":"Paragraph","id":"b6654670b1e4_45","name":"cb7b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*49j6pX6xsRtHP79P."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_46":{"__typename":"Paragraph","id":"b6654670b1e4_46","name":"38ae","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we presumably have all the code we need to enumerate a single file for Extended Attributes, we can wrap that functionality and recursively check every file on the file system. Our collection mechanism is now complete.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_47":{"__typename":"Paragraph","id":"b6654670b1e4_47","name":"aa43","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implement Technique POC or Malware Sample","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_48":{"__typename":"Paragraph","id":"b6654670b1e4_48","name":"1796","type":"P","href":null,"layout":null,"metadata":null,"text":"After implementing ZwQueryEaFile, ZwSetEaFile should be pretty straightforward. Again we write an abstracted function using PSReflect, so we can add custom Extended Attributes to any file of our choosing. This function is also simpler because you are choosing the file to write to instead of looking for every instance of a file that has Extended Attributes. Below is the C++ function definition for ZwSetEaFile:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*dyq3jGGw9AQln0mO.":{"__typename":"ImageMetadata","id":"0*dyq3jGGw9AQln0mO.","originalHeight":504,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_49":{"__typename":"Paragraph","id":"b6654670b1e4_49","name":"5fa4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*dyq3jGGw9AQln0mO."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_50":{"__typename":"Paragraph","id":"b6654670b1e4_50","name":"e334","type":"P","href":null,"layout":null,"metadata":null,"text":"In some cases, writing a POC could be a too big of an investment. In these situations, I like to find a malware sample that implements this technique and use that sample for testing purposes. Each technique’s wiki entry includes references to blog posts or white papers from which the technique’s knowledge was derived. These posts are often a great starting point for understanding the technique itself, as well as the way malware used it in the wild.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_51":{"__typename":"Paragraph","id":"b6654670b1e4_51","name":"8464","type":"P","href":null,"layout":null,"metadata":null,"text":"Each technique wiki page includes examples of malware that leverage it. An example from the NTFS Extended Attribute entry is below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*MxEPq2geR6F7bxWO.":{"__typename":"ImageMetadata","id":"0*MxEPq2geR6F7bxWO.","originalHeight":184,"originalWidth":1278,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_52":{"__typename":"Paragraph","id":"b6654670b1e4_52","name":"673b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*MxEPq2geR6F7bxWO."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_53":{"__typename":"Paragraph","id":"b6654670b1e4_53","name":"a186","type":"P","href":null,"layout":null,"metadata":null,"text":"What if we just get a copy of Regin or Zeroaccess Trojan and test it in a lab environment? If we refer back to the articles analyzing Zeroaccess and its use of Extended Attributes, we can look for a way to identify the specific version of Zeroaccess that implements this technique. When we review Corey Harrell’s post, we find the hash for this version of the malware (ee14dcd20b2ee118618e3a28db72cce92ccd9e85dd8410e02479d9d624934b13). We can now use whatever means are available to us to download a copy of this file to use for testing (I found the sample on VirusShare).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":313,"end":317,"href":"http:\u002F\u002Fjourneyintoir.blogspot.com\u002F2012\u002F12\u002Fextracting-zeroaccess-from-ntfs.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":560,"end":570,"href":"https:\u002F\u002Fvirusshare.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_54":{"__typename":"Paragraph","id":"b6654670b1e4_54","name":"c638","type":"P","href":null,"layout":null,"metadata":null,"text":"Always consider reimplementing the basic functionality involved in the attack technique, as a first priority. This allows threats to be modeled on a generic level without focusing on a specific tool’s implementation. For example, in his post Corey Harrell provides the following description of Zeroaccess Trojan’s implementation of this technique:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":237,"end":241,"href":"http:\u002F\u002Fjourneyintoir.blogspot.com\u002F2012\u002F12\u002Fextracting-zeroaccess-from-ntfs.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_55":{"__typename":"Paragraph","id":"b6654670b1e4_55","name":"50ec","type":"P","href":null,"layout":null,"metadata":null,"text":"“A large amount of binary data is also written to the NTFS Extended Attributes of services.exe. … ZeroAccess uses this feature to hide a whole PE file as well as shellcode that loads the PE file. The overwritten subroutine in services.exe reads in all the data from the Extended Attributes and executes it.”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":1,"end":307,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_56":{"__typename":"Paragraph","id":"b6654670b1e4_56","name":"7749","type":"P","href":null,"layout":null,"metadata":null,"text":"If we only analyze ZeroAccess Trojan, we may mistakenly conclude that we only need to check services.exe for Extended Attributes which would obviously not solve the problem in the way we’d like.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_57":{"__typename":"Paragraph","id":"b6654670b1e4_57","name":"09cf","type":"H3","href":null,"layout":null,"metadata":null,"text":"Detection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_58":{"__typename":"Paragraph","id":"b6654670b1e4_58","name":"53da","type":"P","href":null,"layout":null,"metadata":null,"text":"With the ability to collect Extended Attributes and implement a POC “malicious EA,” we can work on identifying ways to detect malicious use specifically.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_59":{"__typename":"Paragraph","id":"b6654670b1e4_59","name":"18fc","type":"P","href":null,"layout":null,"metadata":null,"text":"The first step in building a detection is identifying normal. How normal are Extended Attributes on your average enterprise computer? Is there a different “normal” depending on the Operating System version? Do these normal instances follow an identifiable pattern? If we can answer these questions, then we can begin to wrap our heads around identifying the malicious use or more generically, deviations from normal.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_60":{"__typename":"Paragraph","id":"b6654670b1e4_60","name":"0381","type":"P","href":null,"layout":null,"metadata":null,"text":"One thing that is important to remember in this case is that attackers aren’t using Extended Attributes for their original purpose. Attackers are using them as data storage (often PE files) which is not consistent with the “key\u002Fvalue pair” concept we saw in documentation. This information can help us look for patterns when considering normal use versus malicious use.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_61":{"__typename":"Paragraph","id":"b6654670b1e4_61","name":"f2ab","type":"P","href":null,"layout":null,"metadata":null,"text":"I put together a couple PowerShell functions to recursively enumerate all files for Extended Attributes (details will be discussed in a future post). You can find my code at the end of the post.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_62":{"__typename":"Paragraph","id":"b6654670b1e4_62","name":"c69c","type":"P","href":null,"layout":null,"metadata":null,"text":"First, I ran the function on a stock Windows 7 VM which came back with exactly 0 EAs. This lines up with our original assumption that Extended Attributes are a legacy compatibility feature that is no longer used in modern operating systems. As I mentioned earlier, just because a stock Windows 7 image has no EAs does not mean that this is the default behavior on all OS’s. For this reason I decided to test a Windows 10 VM as well.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_63":{"__typename":"Paragraph","id":"b6654670b1e4_63","name":"e3d9","type":"P","href":null,"layout":null,"metadata":null,"text":"Before running my Windows 10 test, I wrote an Extended Attribute named TEST to a file located at C:\\demo\\ea.exe. I want to make sure the function detects my custom EA, as well as, any built in EAs.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":71,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_64":{"__typename":"Paragraph","id":"b6654670b1e4_64","name":"e917","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, I ran the function on my Windows 10 VM and found 35751 EAs! Either EAs made a come back, or I’m pwned! To get an idea of what is going on, I used PowerShell’s Group-Object cmdlet to group all EAs based on name to see if there is an identifiable pattern.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Gtx0Gz7-pa6s2xaG.":{"__typename":"ImageMetadata","id":"0*Gtx0Gz7-pa6s2xaG.","originalHeight":388,"originalWidth":1442,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_65":{"__typename":"Paragraph","id":"b6654670b1e4_65","name":"ec3e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Gtx0Gz7-pa6s2xaG."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_66":{"__typename":"Paragraph","id":"b6654670b1e4_66","name":"10a7","type":"P","href":null,"layout":null,"metadata":null,"text":"35749 out of 35751 EAs are named either $CI.CATALOGHINT or $KERNEL.PURGE.ESBCACHE. The remaining two EAs are my “TEST” EA and one named $KERNEL.PURGE.CATALOGHINT which appears related to the other built in EAs.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":40,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":59,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":136,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_67":{"__typename":"Paragraph","id":"b6654670b1e4_67","name":"39d9","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we want to see if we can understand the purpose of these EAs. I’ll start with the most prevalent EA $CI.CATALOGHINT. Let’s take a look at one:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":104,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*tc7WOgfjnRi9dnMt.":{"__typename":"ImageMetadata","id":"0*tc7WOgfjnRi9dnMt.","originalHeight":260,"originalWidth":1438,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_68":{"__typename":"Paragraph","id":"b6654670b1e4_68","name":"b7ad","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*tc7WOgfjnRi9dnMt."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_69":{"__typename":"Paragraph","id":"b6654670b1e4_69","name":"305b","type":"P","href":null,"layout":null,"metadata":null,"text":"Upon further review, it appears that all $CI.CATALOGHINT EAs have a value that is related to a .cat file or a “digitally-signed catalog file”. These are files that are used to verify the digital signature of other files as a collection and alternative to Authenticode signing each individual file.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":111,"end":140,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Finstall\u002Fcatalog-files","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":41,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_70":{"__typename":"Paragraph","id":"b6654670b1e4_70","name":"9e44","type":"P","href":null,"layout":null,"metadata":null,"text":"We can assume that the catalog referenced in the EA is the catalog file that would be used to validate our file’s signature (C:\\Windows\\bfsvc.exe), but it is best not to assume. We use PowerShell’s Get-AuthenticodeSignature cmdlet to check the digital signature of C:\\Windows\\bfsvc.exe and it tells us that the file is indeed “Catalog” signed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*h7o2AwsIBn3ax5qw.":{"__typename":"ImageMetadata","id":"0*h7o2AwsIBn3ax5qw.","originalHeight":636,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_71":{"__typename":"Paragraph","id":"b6654670b1e4_71","name":"a99e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*h7o2AwsIBn3ax5qw."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_72":{"__typename":"Paragraph","id":"b6654670b1e4_72","name":"495e","type":"P","href":null,"layout":null,"metadata":null,"text":"Next we check the catalog file’s digital signature and it turns out that the catalog file is Authenticode signed (the file itself contains an embedded signature).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ioo7Jq1cNCS7WBhQ.":{"__typename":"ImageMetadata","id":"0*ioo7Jq1cNCS7WBhQ.","originalHeight":450,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_73":{"__typename":"Paragraph","id":"b6654670b1e4_73","name":"3e6b","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*ioo7Jq1cNCS7WBhQ."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_74":{"__typename":"Paragraph","id":"b6654670b1e4_74","name":"ffe8","type":"P","href":null,"layout":null,"metadata":null,"text":"One thing to notice is that both files have an identical Thumbprint. This proves that the catalog file referenced in the $CI.CATALOGHINT EA is the catalog used to validate the base file’s digital signature. Another way to resolve what catalog to use for validating a file is to use sigcheck sysinternals with the -i parameter.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":282,"end":290,"href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fbb897441.aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":121,"end":137,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":313,"end":315,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_75":{"__typename":"Paragraph","id":"b6654670b1e4_75","name":"766c","type":"P","href":null,"layout":null,"metadata":null,"text":"When I thought about why this EA is unique to Windows 10, it struck me that $CI likely stands for Code Integrity which is related to Device Guard. This is a security feature included in Windows 10, but unfortunately there is literally no documentation how Device Guard interacts with Extended Attributes. We can now make an educated guess as to the purpose of the $CI.CATALOGHINT.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":364,"end":379,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_76":{"__typename":"Paragraph","id":"b6654670b1e4_76","name":"cff6","type":"P","href":null,"layout":null,"metadata":null,"text":"I will leave the other two EAs as an exercise for the reader, but I’d recommend investigating the relationship between $KERNEL.PURGE.ESBCACHE and the Enterprise Service Bus. I also stumbled upon this page which describes the $KERNEL.PURGE prefix with the statement below:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":150,"end":172,"href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Faa475433(v=bts.10).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":200,"end":204,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Fifs\u002Fkernel-extended-attributes","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":119,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":225,"end":239,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*DQfSQQ7YM49OZo06.":{"__typename":"ImageMetadata","id":"0*DQfSQQ7YM49OZo06.","originalHeight":764,"originalWidth":1534,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:b6654670b1e4_77":{"__typename":"Paragraph","id":"b6654670b1e4_77","name":"a69b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*DQfSQQ7YM49OZo06."},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_78":{"__typename":"Paragraph","id":"b6654670b1e4_78","name":"aa6f","type":"P","href":null,"layout":null,"metadata":null,"text":"I’m interested to hear what EAs you come across and how you think they are being used!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_79":{"__typename":"Paragraph","id":"b6654670b1e4_79","name":"9c56","type":"P","href":null,"layout":null,"metadata":null,"text":"Hopefully, this example demonstrated the process I like to follow to understand “normal” behavior on a system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_80":{"__typename":"Paragraph","id":"b6654670b1e4_80","name":"7584","type":"H4","href":null,"layout":null,"metadata":null,"text":"Test Detection at Scale","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_81":{"__typename":"Paragraph","id":"b6654670b1e4_81","name":"539c","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s one thing to get a working detection on one machine in your test lab, but things can surprise you when you attempt to apply that detection at scale. Once we have identified a detection with fairly low false positive rates in the lab, we need to see how that detection works at scale.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_82":{"__typename":"Paragraph","id":"b6654670b1e4_82","name":"b702","type":"P","href":null,"layout":null,"metadata":null,"text":"In my testing, Extended Attributes seem to remain consistent in large environments. In order to not skip this section, I want to describe how to approach this portion of the methodology from the perspective of the Golden Ticket technique. When I think of detections that work in labs, but needed a little more thought after testing at scale, I think of some of the problems I faced with detections I use for Golden Tickets.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":214,"end":227,"href":"https:\u002F\u002Fadsecurity.org\u002F?p=1640","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_83":{"__typename":"Paragraph","id":"b6654670b1e4_83","name":"4793","type":"P","href":null,"layout":null,"metadata":null,"text":"The original assumption was Kerberos tickets (both Ticket Granting Tickets and Service Tickets), in modern environments, should not use RC4 encryption. In our lab environment, this was true and a 100% detection. While an adversary could upgrade to AES encryption, any ticket with RC4 was in fact malicious. We decided to test this at scale and collect tickets across a fairly large environment, and were surprised when we saw TONS of RC4 and therefore, appeared to be TONS of Golden Tickets in the environment (fortunately this was not the case!). After some research and consulting with Sean Metcalf (@PyroTek3) over at Trimarc Security, it turns out that cross-domain and cross-forest tickets use RC4 by default. I assume this is to maintain backward compatibility in cases where the domain being requested is not functional level 2008. Testing this detection at scale can prevent a large amount of effort on trying to address false positives in the future.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":602,"end":611,"href":"https:\u002F\u002Ftwitter.com\u002FPyroTek3","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":621,"end":637,"href":"https:\u002F\u002Ftrimarcsecurity.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_84":{"__typename":"Paragraph","id":"b6654670b1e4_84","name":"6f41","type":"P","href":null,"layout":null,"metadata":null,"text":"This step of the process should also be catered to your environment. For example, many organizations have very few WMI Permanent Event Subscriptions, but maybe someone in your organization has found a useful way to leverage this technology. In most companies, you are unlikely to learn about that just by asking around. Many organizations are too complex for any individual to know everything. The only true way to know how each technology\u002Ftechnique is used in your environment is to look yourself. Every network has its own unique quirks that are sure to surprise you.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_85":{"__typename":"Paragraph","id":"b6654670b1e4_85","name":"bad6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_86":{"__typename":"Paragraph","id":"b6654670b1e4_86","name":"4601","type":"P","href":null,"layout":null,"metadata":null,"text":"So why go through this lengthy process to build detections? A mature threat hunting program continuously maps documented attack techniques (those found in the MITRE ATT&CK Framework) to durable, behavior based detections. Target techniques should be identified based on your resources and you should cover as much of the attack chain as possible. An attacker must evade all detections throughout the chain to be successful. There is an implicit need to fully understand a technology in order to identify detections that are neither too tactical in nature (something an adversary can easily change) nor too broad (with a high false positive rate). Hopefully this methodology can help your organization work toward a more mature threat hunting program.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_87":{"__typename":"Paragraph","id":"b6654670b1e4_87","name":"0717","type":"H3","href":null,"layout":null,"metadata":null,"text":"Code Snippet","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:b6654670b1e4_88":{"__typename":"Paragraph","id":"b6654670b1e4_88","name":"2013","type":"P","href":null,"layout":null,"metadata":null,"text":"The following code is for demonstration purposes only. It is quite inefficient in how it recursively traverses the file system. Additionally, the code has a dependency on Matt Graeber’s PSReflect project.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":186,"end":195,"href":"https:\u002F\u002Fgithub.com\u002Fmattifestation\u002Fpsreflect","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:45aacbbdc057affa6acd51c15b5187d3":{"__typename":"MediaResource","id":"45aacbbdc057affa6acd51c15b5187d3","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Get-ExtendedAttribute is a function to iterate through the C:\\ volume looking for files with Extended Attributes. This code is beta and meant only for the purpose of a blog post on detection methodology."},"Paragraph:b6654670b1e4_89":{"__typename":"Paragraph","id":"b6654670b1e4_89","name":"e177","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:45aacbbdc057affa6acd51c15b5187d3"}},"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_e78bbf760c55":{"__typename":"CollectionViewerEdge","id":"collectionId:f05f8696e3cc-viewerId:lo_e78bbf760c55","isEditor":false,"isMuting":false},"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg":{"__typename":"ImageMetadata","id":"1*s-5BWBr8XsgtIU5azKNhZQ.jpeg","originalWidth":2000,"originalHeight":805},"PostViewerEdge:postId:a9dbbb53d5ea-viewerId:lo_e78bbf760c55":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:a9dbbb53d5ea-viewerId:lo_e78bbf760c55"},"Tag:threat-hunting":{"__typename":"Tag","id":"threat-hunting","displayTitle":"Threat Hunting","normalizedTagSlug":"threat-hunting"},"Tag:dfir":{"__typename":"Tag","id":"dfir","displayTitle":"Dfir","normalizedTagSlug":"dfir"},"Tag:specterops":{"__typename":"Tag","id":"specterops","displayTitle":"Specterops","normalizedTagSlug":"specterops"},"Tag:powershell":{"__typename":"Tag","id":"powershell","displayTitle":"Powershell","normalizedTagSlug":"powershell"},"Post:a9dbbb53d5ea":{"__typename":"Post","id":"a9dbbb53d5ea","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"83c9","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"2d5e","startIndex":87,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:b6654670b1e4_0"},{"__ref":"Paragraph:b6654670b1e4_1"},{"__ref":"Paragraph:b6654670b1e4_2"},{"__ref":"Paragraph:b6654670b1e4_3"},{"__ref":"Paragraph:b6654670b1e4_4"},{"__ref":"Paragraph:b6654670b1e4_5"},{"__ref":"Paragraph:b6654670b1e4_6"},{"__ref":"Paragraph:b6654670b1e4_7"},{"__ref":"Paragraph:b6654670b1e4_8"},{"__ref":"Paragraph:b6654670b1e4_9"},{"__ref":"Paragraph:b6654670b1e4_10"},{"__ref":"Paragraph:b6654670b1e4_11"},{"__ref":"Paragraph:b6654670b1e4_12"},{"__ref":"Paragraph:b6654670b1e4_13"},{"__ref":"Paragraph:b6654670b1e4_14"},{"__ref":"Paragraph:b6654670b1e4_15"},{"__ref":"Paragraph:b6654670b1e4_16"},{"__ref":"Paragraph:b6654670b1e4_17"},{"__ref":"Paragraph:b6654670b1e4_18"},{"__ref":"Paragraph:b6654670b1e4_19"},{"__ref":"Paragraph:b6654670b1e4_20"},{"__ref":"Paragraph:b6654670b1e4_21"},{"__ref":"Paragraph:b6654670b1e4_22"},{"__ref":"Paragraph:b6654670b1e4_23"},{"__ref":"Paragraph:b6654670b1e4_24"},{"__ref":"Paragraph:b6654670b1e4_25"},{"__ref":"Paragraph:b6654670b1e4_26"},{"__ref":"Paragraph:b6654670b1e4_27"},{"__ref":"Paragraph:b6654670b1e4_28"},{"__ref":"Paragraph:b6654670b1e4_29"},{"__ref":"Paragraph:b6654670b1e4_30"},{"__ref":"Paragraph:b6654670b1e4_31"},{"__ref":"Paragraph:b6654670b1e4_32"},{"__ref":"Paragraph:b6654670b1e4_33"},{"__ref":"Paragraph:b6654670b1e4_34"},{"__ref":"Paragraph:b6654670b1e4_35"},{"__ref":"Paragraph:b6654670b1e4_36"},{"__ref":"Paragraph:b6654670b1e4_37"},{"__ref":"Paragraph:b6654670b1e4_38"},{"__ref":"Paragraph:b6654670b1e4_39"},{"__ref":"Paragraph:b6654670b1e4_40"},{"__ref":"Paragraph:b6654670b1e4_41"},{"__ref":"Paragraph:b6654670b1e4_42"},{"__ref":"Paragraph:b6654670b1e4_43"},{"__ref":"Paragraph:b6654670b1e4_44"},{"__ref":"Paragraph:b6654670b1e4_45"},{"__ref":"Paragraph:b6654670b1e4_46"},{"__ref":"Paragraph:b6654670b1e4_47"},{"__ref":"Paragraph:b6654670b1e4_48"},{"__ref":"Paragraph:b6654670b1e4_49"},{"__ref":"Paragraph:b6654670b1e4_50"},{"__ref":"Paragraph:b6654670b1e4_51"},{"__ref":"Paragraph:b6654670b1e4_52"},{"__ref":"Paragraph:b6654670b1e4_53"},{"__ref":"Paragraph:b6654670b1e4_54"},{"__ref":"Paragraph:b6654670b1e4_55"},{"__ref":"Paragraph:b6654670b1e4_56"},{"__ref":"Paragraph:b6654670b1e4_57"},{"__ref":"Paragraph:b6654670b1e4_58"},{"__ref":"Paragraph:b6654670b1e4_59"},{"__ref":"Paragraph:b6654670b1e4_60"},{"__ref":"Paragraph:b6654670b1e4_61"},{"__ref":"Paragraph:b6654670b1e4_62"},{"__ref":"Paragraph:b6654670b1e4_63"},{"__ref":"Paragraph:b6654670b1e4_64"},{"__ref":"Paragraph:b6654670b1e4_65"},{"__ref":"Paragraph:b6654670b1e4_66"},{"__ref":"Paragraph:b6654670b1e4_67"},{"__ref":"Paragraph:b6654670b1e4_68"},{"__ref":"Paragraph:b6654670b1e4_69"},{"__ref":"Paragraph:b6654670b1e4_70"},{"__ref":"Paragraph:b6654670b1e4_71"},{"__ref":"Paragraph:b6654670b1e4_72"},{"__ref":"Paragraph:b6654670b1e4_73"},{"__ref":"Paragraph:b6654670b1e4_74"},{"__ref":"Paragraph:b6654670b1e4_75"},{"__ref":"Paragraph:b6654670b1e4_76"},{"__ref":"Paragraph:b6654670b1e4_77"},{"__ref":"Paragraph:b6654670b1e4_78"},{"__ref":"Paragraph:b6654670b1e4_79"},{"__ref":"Paragraph:b6654670b1e4_80"},{"__ref":"Paragraph:b6654670b1e4_81"},{"__ref":"Paragraph:b6654670b1e4_82"},{"__ref":"Paragraph:b6654670b1e4_83"},{"__ref":"Paragraph:b6654670b1e4_84"},{"__ref":"Paragraph:b6654670b1e4_85"},{"__ref":"Paragraph:b6654670b1e4_86"},{"__ref":"Paragraph:b6654670b1e4_87"},{"__ref":"Paragraph:b6654670b1e4_88"},{"__ref":"Paragraph:b6654670b1e4_89"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:b206c297df42"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"b6654670b1e4","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":1},"clapCount":79,"allowResponses":true,"isLimitedState":false,"title":"Host-based Threat Modeling & Indicator Design","isSeries":false,"sequence":null,"uniqueSlug":"host-based-threat-modeling-indicator-design-a9dbbb53d5ea","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"Focused around malicious use of NTFS Extended Attributes, this post describes a methodology for understanding attack techniques and building behavioral detections for them.","latestPublishedAt":1500385153182,"readingTime":13.89245283018868,"previewContent":{"__typename":"PreviewContent","subtitle":"Detecting Zeroaccess Trojan’s abuse of NTFS Extended Attributes… Behaviorally"},"previewImage":{"__ref":"ImageMetadata:0*7fpGVXnGJQxwapSC."},"isShortform":false,"seoTitle":"","firstPublishedAt":1500384914535,"updatedAt":1525456799894,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:a9dbbb53d5ea-viewerId:lo_e78bbf760c55"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:dfir"},{"__ref":"Tag:specterops"},{"__ref":"Tag:powershell"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":3337,"layerCake":0}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7e50e797.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.018e7ca9.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ae4dd3e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.598cb8b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.d10c9ba0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.55c925ce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.4d7a2738.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.563d0db5.chunk.js"></script><script>window.main();</script></body></html>