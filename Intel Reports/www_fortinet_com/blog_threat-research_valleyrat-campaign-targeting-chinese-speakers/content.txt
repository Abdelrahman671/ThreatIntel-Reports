
    <!DOCTYPE HTML>
    <html lang="en" data-template="post-page">
    <head>
        
        
        
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/visitorapi.min.js"/>
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/at.js"/>
            <script>

                   ;(function(win, doc, style, timeout) {
                   var STYLE_ID = 'at-body-style';
                   function getParent() {
                      return doc.getElementsByTagName('head')[0];
                   }
                   function addStyle(parent, id, def) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.createElement('style');
                      style.id = id;
                      style.innerHTML = def;
                      parent.appendChild(style);
                   }
                   function removeStyle(parent, id) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.getElementById(id);
                      if (!style) {
                      return;
                      }
                      parent.removeChild(style);
                   }
                   addStyle(getParent(), STYLE_ID, style);
                   setTimeout(function() {
                      removeStyle(getParent(), STYLE_ID);
                   }, timeout);
                   }(window, document, "body {opacity: 0 !important}", 3000));
                </script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/visitorapi.min.js"></script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/at.js"></script>
        
        
    <meta charset="UTF-8"/>
    <title>A Deep Dive into a New ValleyRAT Campaign Targeting Chinese Speakers | FortiGuard Labs</title>
    <meta name="keywords" content="FortiGuard Labs Threat Research,malware"/>
    <meta name="description" content="A technical analysis of the ongoing ValleyRat multi-stage malware campaign&#39;s diverse techniques and characteristics."/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="A Deep Dive into a New ValleyRAT Campaign Targeting Chinese Speakers | FortiGuard Labs"/>
<meta property="og:url" content="https://www.fortinet.com/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A technical analysis of the ongoing ValleyRat multi-stage malware campaign&#39;s diverse techniques and characteristics.…"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-heros/vrat24-hero.png"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Eduardo Altares, Joie Salvio"/>

    <meta property="article:section" content="FortiGuard Labs Threat Research"/>


    <meta property="article:published_time" content="2024-08-15T13:00:00.000Z"/>


    <meta property="article:tag" content="malware"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>

<link rel="canonical" href="https://www.fortinet.com/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers"/>










    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.900b148ab7b87024003111a1245cca9c.css" type="text/css">





<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    



        <!-- BE IXF: BE IXF: Place getHeadOpen just inside of the head tag -->
        
        
<!-- be_ixf, sdk, gho-->
<meta name="be:sdk" content="java_sdk_1.6.7" />
<meta name="be:timer" content="31ms" />
<meta name="be:norm_url" content="https://www.fortinet.com/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers" />
<meta name="be:capsule_url" content="https://ixfd1-api.bc0a.com/api/ixf/1.0.0/get_capsule/f00000000310757/01138138001" />
<meta name="be:api_dt" content="pny_2024; pnm_10; pnd_22; pnh_11; pnmh_14; pn_epoch:1729620888572" />
<meta name="be:mod_dt" content="pny_1969; pnm_12; pnd_31; pnh_16; pnmh_00; pn_epoch:0" />
<meta name="be:orig_url" content="https://www.fortinet.com/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers" />
<meta name="be:messages" content="34146" /><script type='text/javascript'>
if (window.BEJSSDKObserver === undefined) {
  (function(BEJSSDKObserver, $, undefined) {
    var observer = void 0;
    var listeners = [];
    var readySet = [];
    var doc = window.document;
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;

    function checkSelector(selector, fn, indexList) {
      var elements = doc.querySelectorAll(selector);
  /**
    issues on IE @see https://www.codesd.com/item/javascript-es6-not-a-function-error.html
    elements = Array.from(elements);

    */
    for (var i = 0, len = elements.length; i < len; i++) {
      /* -1 means all instances */
      if (indexList != -1 && !(i in indexList)) {
        continue;
      }
      var element = elements[i];
      for (var j = 0; j < readySet.length; j++) {
        if (readySet[j] == element.className || readySet[j] == element.id) {
          return;
        }
      }
      if (element.className) {
        readySet.push(element.className);
      }
      if (element.id) {
        readySet.push(element.id);
      }

      if (!element.ready || MutationObserver==null) {
        element.ready = true;
        fn.call(element, element);
      }
    }
  }

  function checkListeners() {
    listeners.forEach(function (listener) {
      return checkSelector(listener.selector, listener.fn, listener.indexList);
    });
  }

  function removeListener(selector, fn) {
    var i = listeners.length;
    while (i--) {
      var listener = listeners[i];
      if (listener.selector === selector && listener.fn === fn) {
        listeners.splice(i, 1);
        if (!listeners.length && observer) {
          observer.disconnect();
          observer = null;
        }
      }
    }
  }

/**
 * Fire event on first js selector
 * @param selector string to watch on
 * @param fn       callback function
 * @param index_list can be undefined which means only first one
 *                   or -1 which means all
 *                   or a list of allowable indexes
 */
 BEJSSDKObserver.jsElementReady = function(selector, fn, index_list) {
  if (index_list === undefined) {
    index_list = [];
    index_list.push(0);
  }

  if (MutationObserver != null) {
    if (!observer) {
      observer = new MutationObserver(checkListeners);
      observer.observe(doc.documentElement, {
        childList: true,
        subtree: true
      });
    }
    listeners.push({ selector: selector, fn: fn, indexList: index_list });
  } else {
    /* <= IE8 */
    if (!document.addEventListener) {
      /* log("<=IE8 attachEvent assignment"); */
      document.addEventListener = document.attachEvent;
    }
    document.addEventListener("DOMContentLoaded", function(event) {
      var elements = doc.querySelectorAll(selector);
      for (var i = 0, len = elements.length; i < len; i++) {
        /* -1 means all instances */
        if (index_list != -1 && !(i in index_list)) {
          continue;
        }
        var element = elements[i];
        element.ready = true;
        fn.call(element, element);
      }
    });
  }

  checkSelector(selector, fn, index_list);
  return function () {
    return removeListener(selector, fn);
  };
};
}(window.BEJSSDKObserver = window.BEJSSDKObserver || {}));
}
var jsElementReady = window.BEJSSDKObserver.jsElementReady;

if (window.BELinkBlockGenerator === undefined) {
  (function(BELinkBlockGenerator, $, undefined) {
    BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = 100;
    BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = 200;

    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE = 0;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE = 1;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE = 2;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE = 3;

    BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE = 0;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_POST_APPEND_ELEMENT = 1;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT = 2;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT = 3;

    BELinkBlockGenerator.setMaximumHeadlineLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = length;
    };

    BELinkBlockGenerator.setMaximumDescriptionLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = length;
    };

    BELinkBlockGenerator.generateIndividualLinks = function(parentElement, linkStructure, link) {
      var link_level_element_tag = linkStructure[0];
      var link_level_element = document.createElement(link_level_element_tag);
      var link_attribute_dictionary = linkStructure[1];
      var allowable_elements = linkStructure[2];
      var children_link_structures = linkStructure[3];
      for (var link_attribute_key in link_attribute_dictionary) {
        link_level_element.setAttribute(link_attribute_key, link_attribute_dictionary[link_attribute_key]);
      }

      var added_something = false;
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE)>=0) {
        link_level_element.setAttribute('href', link.url);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE)>=0 && link.h1) {
        var headline_text = link.h1;
        if (headline_text.length > BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) {
          headline_text = headline_text.substring(0, BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) + '...';
        }
        var text_node = document.createTextNode(headline_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE)>=0 && link.desc) {
        var desc_text = link.desc;
        if (desc_text.length > BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) {
          desc_text = desc_text.substring(0, BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) + '...';
        }
        var text_node = document.createTextNode(desc_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE)>=0 && link.image) {
        link_level_element.setAttribute('src', link.image);
        added_something = true;
      }
/**
    don't emit for empty links, desc, headline, image
    except for parent structures where allowable_length=0
    */
    if (!added_something && allowable_elements.length != 0) {

      return;
    }
    /* go depth first */
    for (var childrenIndex=0; childrenIndex<children_link_structures.length; childrenIndex++) {
      var childLinkStructure = children_link_structures[childrenIndex];
      BELinkBlockGenerator.generateIndividualLinks(link_level_element, childLinkStructure, link);
    }
    parentElement.appendChild(link_level_element);
  };

  BELinkBlockGenerator.insertLinkBlocks = function(targetElement, replacementStrategy, overallStructure, linkStructure, links,
                                                   titleStructure) {
    if (targetElement == null) {
      return;
    }

    if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE) {
      while (targetElement.firstChild) {
        targetElement.removeChild(targetElement.firstChild);
      }
    }

    var previousElement = targetElement;
    for (var i=0;i<overallStructure.length;i++) {
      var level_definition = overallStructure[i];
      var level_element_tag = level_definition[0];
      var level_element = document.createElement(level_element_tag);
      var attribute_dictionary = level_definition[1];
      for (var attribute_key in attribute_dictionary) {
        level_element.setAttribute(attribute_key, attribute_dictionary[attribute_key]);
      }

      /* need to place title structure */
      if (titleStructure && titleStructure[0] == i) {
        var title_element_tag = titleStructure[1];
        var title_element = document.createElement(title_element_tag);
        var title_attribute_dictionary = titleStructure[2];
        var title_text_content = titleStructure[3];
        for (var title_attribute_key in title_attribute_dictionary) {
          title_element.setAttribute(title_attribute_key, title_attribute_dictionary[title_attribute_key]);
        }

        var title_text_node = document.createTextNode(title_text_content);
        title_element.appendChild(title_text_node);


        level_element.appendChild(title_element);
      }

      /* last level place links */
      if (i == overallStructure.length-1) {
        for (var link_i=0; link_i < links.length; link_i++) {
          var link = links[link_i];
          for (var linkStructureIndex=0;linkStructureIndex < linkStructure.length; linkStructureIndex++) {
            BELinkBlockGenerator.generateIndividualLinks(level_element, linkStructure[linkStructureIndex], link)
          }
        }
      }

      /* first level child we need to check placement */
      if (previousElement == targetElement) {
        if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT) {
          /* 2 means insert right before */
          previousElement.insertBefore(level_element, targetElement.firstChild);
        } else if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT) {
          /* 3 means insert right before at parent level */
          var parentElement = previousElement.parentElement;
          parentElement.insertBefore(level_element, previousElement);
        } else {
          previousElement.appendChild(level_element);
        }
      } else {
        previousElement.appendChild(level_element);
      }
      previousElement = level_element;
    }
  };
}(window.BELinkBlockGenerator = window.BELinkBlockGenerator || {}))
};
</script>


        <!--BE IXF: Header End -->


    </head>
    <body class="table-of-content-body">
    



    
<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>FortiGuard Labs Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/life-at-fortinet">
                                <span>Life at Fortinet</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>FortiGuard Labs Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/life-at-fortinet">
                    <span>Life at Fortinet</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div id="blog-site-search" class="b1-header__search" aria-expanded="false"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <button class="b1-header__search-toggle" aria-controls="blog-site-search" aria-label="Search">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </button>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-heros/vrat24-hero.png);">
    <img class="ratio" alt="A Deep Dive into a New ValleyRAT Campaign Targeting Chinese Speakers | FortiGuard Labs" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">FortiGuard Labs Threat Research</p>
        
        
        

        <h1 class="b4-hero__headline">A Deep Dive into a New ValleyRAT Campaign Targeting Chinese Speakers</h1>
        
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                          
                                              <a href="/blog/search?author=Eduardo+Altares">Eduardo Altares</a> and
                                          
                                           
                                      
                                  
                          

                                  
                                      
                                            
                                              <a href="/blog/search?author=+Joie+Salvio"> Joie Salvio</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | August 15, 2024</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="Table-Content aem-GridColumn aem-GridColumn--default--12">
<div class="blog-toc">
    <div class="b3-blog-list__row ">
        <div class="b3-blog-list__column-left table-content-wrapper automatic">
            <ul class="table-of-content">
                <li class="header"><img class="toc-icon" src="/content/dam/fortinet/images/toc-icon.jpg" alt=""/>Article Contents</li>
                
            </ul>
        </div>
        <div class="aem-GridColumn aem-GridColumn--default--8 b3-blog-list__column-right scrolling-content automatic">
            

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                          
                                              <a href="/blog/search?author=Eduardo+Altares">Eduardo Altares</a> and
                                          
                                           
                                      
                                  
                          

                                  
                                      
                                            
                                              <a href="/blog/search?author=+Joie+Salvio"> Joie Salvio</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | August 15, 2024</span>
</div>

            




    
    
    <div class="cmp cmp-text">
  <p style="margin-left: 80.0px;"><b>Affected platforms:</b> Microsoft Windows<br />
<b>Impacted parties: </b>Targeted Windows users<br />
<b>Impact: </b>Compromised machines are under the control of the threat actor<br />
<b>Severity level: </b>Medium</p>
<p>FortiGuard Labs recently encountered an ongoing ValleyRAT campaign specifically targeting Chinese speakers. This malware has historically targeted e-commerce, finance, sales, and management enterprises.</p>
<p>ValleyRAT is a multi-stage malware that utilizes diverse techniques to monitor and control its victims and deploy arbitrary plugins to cause further damage. Another noteworthy characteristic of this malware is its heavy usage of shellcode to execute its many components directly in memory, significantly reducing its file footprint in the victim’s system.</p>
<p>This blog provides a technical analysis of this campaign.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image.img.png/1723574158837/fig01-fortiguard-valleyrat-attack-flow.png" data-title="Fig 1: Attack Flow">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image.img.png/1723574158837/fig01-fortiguard-valleyrat-attack-flow.png" alt="Fig 1: Attack Flow" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 1: Attack Flow</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2><span style="font-weight: normal;">First Stage Loader</span></h2>
<h4><span style="font-weight: normal;">Masquerading</span></h4>
<p>This malware uses icons of legitimate applications, including Microsoft Office, with filenames related to financial documents similar to the following:</p>
<ul>
<li>工商年报大师.exe (translation: Industrial and Commercial Annual Report Master.exe)</li>
<li>详情查看.exe (translation: View Details.exe)</li>
<li>3月份涉税财会人员征信拉黑名单如下.exe (translation: The blacklist of tax-related accounting personnel in March is as follows.exe)</li>
<li>补单对接更新记录txt.exe (translation: Update record of order docking txt.exe)</li>
<li>票<i>{random characters}</i>助手.exe (translation Ticket <i>{random characters}</i> Assistant.exe)</li>
</ul>
<p>To make the lure more believable to the user, it creates an empty file <i>%TEMP%\dome.doc </i>and executes the default application for opening Microsoft Office Word documents. If no default application is set, it shows an error message box with the text, “Open The Document Fail.”</p>
<h4><span style="font-weight: normal;">Initialization</span></h4>
<p>Upon execution, it attempts to create a mutex named <i>TEST</i> to ensure that only one instance of the malware process is running on the system.</p>
<p>After that, it deletes the following registry entries, which could have been added in a previous installation of the malware:</p>
<ul>
<li><i>HKEY_CURRENT_USER\Software\Console\IpDate</i></li>
<li><i>HKEY_CURRENT_USER\Software\Console\IpDateInfo</i></li>
</ul>
<p>It then stores the IP and the port of the Command and Control (C2) in the following registry entry:</p>
<ul>
<li><i>HKEY_CURRENT_USER\Software\Console\</i></li>
</ul>
<p><i>IpDateInfo = “</i>|i:154.82.85.12|p:5689|”</p>
<h4><span style="font-weight: normal;">Sandbox Evasio</span>n</h4>
<p>Before continuing, it determines if it’s running under a virtual machine by enumerating all services and checking if any of the following VM-related strings are on the service display names:</p>
<ul>
<li>VMWARE Tools</li>
<li>VMWare 共享</li>
<li>Virtual Machine</li>
<li>VirtualBox Guest</li>
</ul>
<p>If any of these services are found, a blank error message box is shown before it terminates.</p>
<h4><span style="font-weight: normal;">Sleep Obfuscatio</span>n</h4>
<p>Before the shellcode is executed to load the next stage, this malware uses a known technique called sleep obfuscation to evade memory scanners. This involves adding a callback functionality to Sleep or similar APIs that modify the permissions of the allocated memory where the malicious code resides to values not commonly deemed suspicious by scanners. Furthermore, during this process, the malicious shellcode is encoded with a simple XOR operation to evade pattern-based signatures.</p>
<p>After decoding the malicious shellcode using XOR with a single-byte key, <i>0x60</i> in this case, it copies the first 0xc bytes from the Sleep API function and stores it for later use. It then replaces it with code that will lead to executing the malicious callback function.</p>
<p>This callback function changes the permission of the malicious shellcode and attempts to obfuscate it using the following procedure:</p>
<ol>
<li>Change the shellcode memory region permission to PAGE_READWRITE</li>
<li>Encode the shellcode using XOR</li>
<li>Change the shellcode memory region permission to PAGE_NOACCESS</li>
<li>Restore the original code of Sleep for it to operate normally</li>
<li>Call Sleep API</li>
<li>Change the shellcode memory region permission back to PAGE_READWRITE</li>
<li>Decode the shellcode</li>
<li>Change the shellcode memory region permission to PAGE_EXECUTE for it to become executable again</li>
</ol>
<h4><span style="font-weight: normal;">Shellcode for Reflective DLL Loading</span></h4>
<p>In general, this malware uses shellcode blocks to run its components directly in memory. This shellcode is similar to the one shared in this GitHub repository: <a href="https://github.com/killeven/DllToShellCode/blob/master/DllToShellCode/shellcode_data.c" target="_blank">https://github.com/killeven/DllToShellCode/blob/master/DllToShellCode/shellcode_data.c</a>. This specific shellcode has also been seen in older malware campaigns and detected by Fortinet as W64/Agent.CCF!tr.</p>
<p>Once this malware has finished initializing, it decrypts a shellcode with the AES-256 algorithm using a key derived from a hardcoded 16-byte value. The result is then XOR-ed with <i>0x60</i> to reveal the final shellcode. It then triggers the previously mentioned sleep obfuscation routine by calling the Sleep API before finally executing the shellcode by using it as a callback procedure for the <i>EnumSystemLocalesA </i>API<i>.</i></p>
<p>The shellcode uses a hashing algorithm called BKDR to obfuscate the API names, which are then used to search for the target APIs by directly traversing the Process Environment Block (PEB).</p>
<p>After checking standard 64-bit PE characteristics from the payload, the shellcode reflectively loads the embedded DLL, in this case, the beaconing module, by copying it to another memory location, adjusting its base relocation, and manually resolving its imports before its entry point is executed.</p>
<h2><span style="font-weight: normal;">Beaconing Module</span></h2>
<p>The beaconing module is responsible for loading the RuntimeBroker and RemoteShellcode components. It also allows the malware to persist and gain administrator privileges in the system while ensuring that no AV-related processes are running before it starts communicating with its C2 server.</p>
<h4><span style="font-weight: normal;">Persistenc</span>e</h4>
<p>This malware adds a scheduled task to allow its component, <i>Loader </i>- discussed in a later section – to execute automatically upon user login. Furthermore, for the <i>Loader </i>component to be executed with high privilege without triggering Windows’ UAC, it employs a known technique that abuses the auto-elevate properties of the legitimate applications, <i>C:\Windows\System32\zh-CN\eventvwr.msc</i> or <i>C:\Windows\System32\CompMgmtLauncher.exe</i>.  By design, these applications eventually lead to the execution of the current default value set on the registry entry <i>HKEY_CURRENT_USER\Software\Classes\mscfile\Shell\Open\Command</i>, which will be set to the path of the <i>Loader </i>component in a later stage of infection.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1077692842.img.png/1723574179856/fig02-fortiguard-valleyrat-campaign-scheduled-task.png" data-title="Fig 2:  Scheduled Task added by the malware">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1077692842.img.png/1723574179856/fig02-fortiguard-valleyrat-campaign-scheduled-task.png" alt="Fig 2:  Scheduled Task added by the malware" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 2:  Scheduled Task added by the malware</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2>AV Evasion</h2>
<p>It attempts to evade detection from Microsoft Windows Defender by adding the root drive of the malware path to the exclusion by executing the following PowerShell command:</p>
<p style="margin-left: 40.0px;"><i>Invoke-Command -Command {Add-MpPreference -ExclusionPath {drive}</i></p>
<p>Instead of usually running the command as an argument to the PowerShell process, it uses pipes to communicate with a newly created PowerShell process to execute commands. This could be an attempt to evade AV products that inspect suspicious process arguments.</p>
<p>By default, it adds the common root drive &quot;C:\&quot; to the list of excluded paths. If the malware was executed from another root drive, it will also be added to the list.</p>
<p>It then proceeds to kill AV-related processes containing the following executable filenames:</p>
<ul>
<li>360Sd.exe</li>
<li>360leakfixer.exe</li>
<li>safesvr.exe</li>
<li>MultiTip.exe</li>
<li>ZhuDongFangYu.exe</li>
<li>kscan.exe</li>
<li>kwsprotect64.exe</li>
<li>kxescore.exe</li>
<li>HipsMain.exe</li>
<li>HipsDaemon.exe</li>
<li>QMDL.exe</li>
<li>QMPersonalCenter.exe</li>
<li>QQPCPatch.exe</li>
<li>QQPCRealTimeSpeedup.exe</li>
<li>QQPCRTP.exe</li>
<li>QQRepair.exe</li>
</ul>
<p>Notably, the executable names listed are components of products developed by Chinese companies reaffirming their target preference.</p>
<p>To determine if the processes have been successfully terminated, it does another scan of the running processes to check if any process with the following executable filenames is still running:</p>
<ul>
<li>360Tray.exe</li>
<li>360tray.exe</li>
<li>360Safe.exe</li>
<li>360safe.exe</li>
<li>kxetray.exe</li>
<li>QQPCTray.exe</li>
</ul>
<p>If any of these processes are still running, it performs another attempt to kill them by injecting a shellcode with an embedded DLL into a running <i>lsass</i> process. This DLL performs the following procedures:</p>
<ol>
<li>Add <i>SeDebugPrivilege </i>privilege to the <i>lsass </i>process<i></i></li>
<li>End execution if &quot;colorcpl.exe&quot; or &quot;cleanmgr.exe&quot; processes are running. This is an indicator that the malware has successfully progressed to the later stages of infection, which will be discussed in the later section</li>
<li>Search and terminate processes with the following executable filenames:</li>
</ol>
<ul>
<li>kxescore.exe</li>
<li>kxetray.exe</li>
<li>360rp.exe</li>
<li>360rps.exe</li>
<li>360sd.exe</li>
<li>360Tray.exe</li>
<li>360tray.exe</li>
<li>360Safe.exe</li>
<li>360speedld.exe</li>
<li>ZhuDongFangYu.exe</li>
<li>SoftMgrLite.exe</li>
<li>QQPCLeakScan.exe</li>
<li>QQPCRTP.exe</li>
<li>QQPCTray.exe</li>
</ul>
<p>Once the AV processes are no longer running, it modifies the following AV product settings in the registry to disable their autostart and/or reduce their effectiveness:</p>
<ul>
<li>HKLM\SOFTWARE\WOW6432Node\kingsoft\antivirus\Windhunter<br />
   WindhunterLevel = 4<br />
   WindhunterSwitch = 0</li>
<li>HKLM\SOFTWARE\WOW6432Node\kingsoft\antivirus\KSetting<br />
   kxesc = 0</li>
<li>HKLM\SOFTWARE\WOW6432Node\kingsoft\antivirus\KAVReport<br />
   AutoStart = 0</li>
<li>HKLM\SOFTWARE\WOW6432Node\Tencent\QQPCMgr<br />
  autostart = 0</li>
</ul>
<p>If the AV programs are still found running, the malware process displays an “ERROR” message box and terminates.</p>
<h4><span style="font-weight: normal;">Privilege Escalation</span></h4>
<p>If the user has administrator privileges, it attempts to execute a new process of itself with elevated privileges without prompting Windows’ UAC(User Access Control) security feature using two known methods.</p>
<p>The first method involves abusing the CMSTPLUA COM class, specifically the <i>ShellExec </i>method of the ICMLuaUtil interface. Since the system automatically grants this class elevated privileges, any process executed using this interface will gain the same. Before using the interface to execute a new process of itself, it attempts to disguise itself as a legitimate explorer.exe process by locating the ProcessParameters structure in the Process Environment Block (PEB) and replacing its ImagePathName and CommandLine fields with the path of the legitimate explorer.exe.</p>
<p>The second method exploits another legitimate application called fodhelper.exe<i>. </i>Like the first method, this executable gets high privilege upon execution. First, it creates the registry key <i>HKCU\Software\Classes\<b>.pwn</b>\Shell\Open\command</i> and sets its default value to the malware path. Next, it creates another registry key, HKCU\Software\Classes\ms-settings\CurVer, and sets its default value data to .pwn, associating it with the previously created malicious registry entry. Finally, it executes the legitimate fodhelper.exe, which executes whatever ProgID is defined in the CurVer subkey. This leads to the execution of the malware with high privilege.</p>
<h4><span style="font-weight: normal;">Execute RemoteShellCode and RuntimeBroker</span></h4>
<p>At this stage, the malware initiates its communication with its C2 to request other components needed for the next stages of the infection. Prior to this, it checks for internet connectivity by attempting to connect to the legitimate Chinese search engine, <a href="http://www.baidu.com" target="_blank">http://www.baidu.com</a>.</p>
<p>The requests sent by this malware at this stage are all in plaintext, but the responses from the C2 are encoded with a randomly generated single-byte XOR key, except for the requests to get the component sizes. This key is included in the malware’s requests in the format <i>{request}</i>_<i>{xor key}</i>.</p>
<p>There are three possible configurations with the malware request methods to the C2 and its corresponding procedure for storing and executing succeeding components in the system.</p>
<p>In the specific sample we analyzed, it is configured to request two shellcode blocks from its C2: internally named <i>RemoteShellcode</i> and <i>RuntimeBroker. </i>To do this, it determines the sizes of the shellcode blocks by sending <i>GetRemoteShellcodeSize_{xor key} </i>and <i>GetRuntimeBrokerSize_{xor_key}</i>. The sizes received from the C2 are used to check the integrity of the shellcode upon receipt. After that, the C2 sends the shellcode encoded with the XOR key included in the malware’s requests. A traffic example is provided in the image below:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_527655980.img.png/1723574208223/fig03-fortiguard-valleyrat-campaign-traffic-sample.png" data-title="Fig 3: Traffic sample to get RemoteShellcode and RuntimeBroker components ">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_527655980.img.png/1723574208223/fig03-fortiguard-valleyrat-campaign-traffic-sample.png" alt="Fig 3: Traffic sample to get RemoteShellcode and RuntimeBroker components " class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 3: Traffic sample to get RemoteShellcode and RuntimeBroker components </span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p><i>RemoteShellCode </i>and <i>RuntimeBroker </i>are decoded and injected into newly created processes of legitimate Windows applications C:\Windows\System32\colorcpl.exe and C:\Windows\System32\cleanmgr.exe, respectively. The functions for these components are detailed in the next sections.</p>
<p>Meanwhile, the second method is like the first in that they both request two components from the C2—this time, they are <i>wwlib.dl</i>l and <i>Winword.exe. </i>While the previous method’s execution of the components takes place in-memory, this method involves writing the components to the disk. Like the previous method, it also requests the sizes of the components. For the size of <i>wwlib.dll</i>, it sends <i>GetWwlibSize_{xor key}. </i>Although the sample we analyzed does not contain the request string for retrieving the size of <i>Winword.exe, </i>extrapolating from the analysis of the first method, it can be assumed that it could send <i>GetWinWordSize_{xor key} </i>beforehand<i>.</i> After the sizes have been determined, it sends <i>GetWWlib_{xor key}</i> and <i>GetWinWord_ {xor key} </i>to receive the binaries, which are then written to the <i>%UserProfile% </i>directory<i>. </i>It then executes <i>Winword.exe. </i>Based on other reports, <i>Winword.exe</i> is a legitimate Microsoft Office Word executable, which would then be executed, inadvertently loading the malicious <i>wwlib.dll </i>upon execution<i>.</i></p>
<p>Finally, the last method sends <i>GetOnline_{xor key} </i>to download an executable file, which is then saved as <i>algbg.exe</i> in the <i>%UserProfile% </i>directory. It could send <i>GetOnlineSize_{xor key}</i> to get the executable size beforehand.</p>
<h2><span style="font-weight: normal;">RuntimeBroker</span></h2>
<p>This shellcode loads and executes a DLL whose primary purpose is downloading a component named <i>Loader </i>from the C2 server.</p>
<p>The DLL sends the request strings <i>GetLoaderSize_{xor key}</i> and <i>GetLoader_{xor key} </i>to the C2, which responds with the size and the requested executable file, respectively. This file is then saved as <i>Loader.exe </i>in the <i>%USERPROFILE%</i> directory.<i> </i>After dropping the executable file, it sets the default value of the registry entry <i>HKEY_CURRENT_USER\Software\Classes\mscfile\Shell\Open\Command</i> to the said file path. This is to complete the autostart mechanism partially set up by the beaconing module mentioned earlier. This effectively allows the new <i>Loader</i> component to run automatically when the user logs in.</p>
<h2><span style="font-weight: normal;">Updated Loader</span></h2>
<h4><span style="font-weight: normal;">Updater</span></h4>
<p>At the time of analysis, the <i>Loader</i> component received from the C2 has the same function as the first-stage loader, which is to execute the beaconing module. We can see in the figure below that the WinMain of the first-stage <i>Loader</i> is very similar to the <i>WinMain </i>of the newer <i>Loader </i>executable from the C2.  </p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_2068221427.img.png/1723574226323/fig04-fortiguard-valleyrat-campaign-code-comparison.png" data-title="Fig 4: Code comparison between the First stage loader and the updated loader from C2">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_2068221427.img.png/1723574226323/fig04-fortiguard-valleyrat-campaign-code-comparison.png" alt="Fig 4: Code comparison between the First stage loader and the updated loader from C2" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 4: Code comparison between the First stage loader and the updated loader from C2</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Fortinet detects these variants as <b>W64/RCShell.A!tr</b>.</p>
<p>Setting aside the striking similarities, this new component has a few behaviors outside the first-stage loader, as detailed below.</p>
<h4><span style="font-weight: normal;">Sandbox Evasion</span></h4>
<p>It attempts to detect if it is running inside a sandbox system by counting the files inside the <i>%TEMP%</i> directory. This malware terminates if the number of temporary files is less than 30. Since these systems are restored after every test, they usually have fewer temporary files than conventional systems.</p>
<h4><span style="font-weight: normal;">Chinese Environment Detection</span></h4>
<p>To continue execution, it makes sure that any of the following registry keys related to popular communication applications in China are found in the system, further confirming our belief that this malware specifically targets Chinese systems:</p>
<ul>
<li><i>HKEY_CURRENT_USER\Software\Tencent\Wechat</i></li>
<li><i>HKEY_CURRENT_USER\Software\Dingtalk</i></li>
</ul>
<h4><span style="font-weight: normal;">Obfuscated Embedded Payload</span></h4>
<p>While the first-stage loader uses the AES-256 algorithm to encrypt the shellcode, an interesting method this malware uses in other samples is to disguise the payload within the malware body by keeping them as UUID strings or IP addresses and then converting these benign-looking strings into their hex-byte equivalent to form the shellcode.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1124537304.img.png/1723574246438/fig05-fortiguard-valleyrat-campaign-uuid-strings.png" data-title="Fig 5: Using UUID strings">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1124537304.img.png/1723574246438/fig05-fortiguard-valleyrat-campaign-uuid-strings.png" alt="Fig 5: Using UUID strings" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 5: Using UUID strings</span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1405562461.img.png/1723574259550/fig06-fortiguard-valleyrat-campaign-using-ip-addresses.png" data-title="Fig 6: Using IP addresses">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1405562461.img.png/1723574259550/fig06-fortiguard-valleyrat-campaign-using-ip-addresses.png" alt="Fig 6: Using IP addresses" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 6: Using IP addresses</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2><span style="font-weight: normal;">RemoteShellCode</span></h2>
<p>The primary purpose of this component is to request the downloader of the ValleyRAT payload. In addition, it contains the embedded configuration marked with the string “codemark” for the payload to use during its execution at a later stage. This configuration is very similar to the previously reported ValleyRat campaigns, where it contains the latest C2 servers as well as other settings for the RAT.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_5618614.img.png/1723574277277/fig07-fortiguard-valleyrat-campaign-decoded-config.png" data-title="Fig 7: Decoded ValleyRAT configuration">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_5618614.img.png/1723574277277/fig07-fortiguard-valleyrat-campaign-decoded-config.png" alt="Fig 7: Decoded ValleyRAT configuration" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 7: Decoded ValleyRAT configuration</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>To request the payload downloader, it sends the string 64 or 32, depending on the system’s architecture. As shown in the image below, the C2 responds with the payload downloader encoded with XOR, where the key is derived by adding 0x36 to a 10-byte value from the C2's response.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_467381154.img.png/1723574300166/fig08-fortiguard-valleyrat-campaign-traffic-request.png" data-title="Fig 8: Traffic to request for the payload downloader component">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_467381154.img.png/1723574300166/fig08-fortiguard-valleyrat-campaign-traffic-request.png" alt="Fig 8: Traffic to request for the payload downloader component" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 8: Traffic to request for the payload downloader component</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Similar to how the earlier components are loaded, the shellcode reflectively loads the embedded payloader DLL and executes its export named <i>load </i>while passing the previously mentioned configuration as an argument.</p>
<h2><span style="font-weight: normal;">Payload Downloader</span></h2>
<p>We detect this component as<i> </i>W64/ValleyRat.A!tr.spy<i>. </i>The C2 configuration from the previous module is decoded by simple string reverse, which is then parsed to configure the downloader. Depending on the configuration, it uses UDP or TCP sockets to connect to the C2 and receive the final payload. First, it will send the size and the key for encrypting the payload, to which the C2 responds with the encoded SHA256 hash of the payload. Lastly, it sends <i>登录模块.dll_bin</i> (translated as <i>Login module.dll_bin</i>) to request the ValleyRAT malware. A shellcode with the embedded ValleyRAT DLL is then decoded using the same method used to decode the payload downloader. This shellcode is stored in the registry value <i>d33f351a4aeea5e608853d1a56661059 </i>on key <i>HKEY_CURRENT_USER\Console\1</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1359961431.img.png/1723574322055/fig09-fortiguard-valleyrat-campaign-shellcode-placed-registry.png" data-title="Fig 9: Shellcode placed on the registry ">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1359961431.img.png/1723574322055/fig09-fortiguard-valleyrat-campaign-shellcode-placed-registry.png" alt="Fig 9: Shellcode placed on the registry " class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Fig 9: Shellcode placed on the registry </span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Upon execution of the shellcode, the ValleyRAT DLL is reflectively loaded and executed in the system.</p>
<h2><span style="font-weight: normal;">ValleyRAT</span></h2>
<p>This relatively new RAT is attributed to the suspected APT group “Silver Fox”.</p>
<p>This malware's capabilities are focused on graphically monitoring the user's activities and delivering other plugins and possibly other malware to the victim system.</p>
<p>These are the commands supported by this variant:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1477513231.img.png/1723574362384/fig09t-fortiguard-valleyrat-campaign-commands.png" data-title="valleyrat supported commands">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/valleyrat-campaign-targeting-chinese-speakers/_jcr_content/root/responsivegrid/table_content/par/image_1477513231.img.png/1723574362384/fig09t-fortiguard-valleyrat-campaign-commands.png" alt="valleyrat supported commands" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2><span style="font-weight: normal;">Conclusion</span></h2>
<p>In this article, we have detailed an elaborate and ongoing ValleyRAT campaign specifically targeting Chinese systems. This malware involves several components loaded in different stages and mainly uses shellcode to execute them directly in memory, significantly reducing its file trace in the system. Once the malware gains a foothold in the system, it supports commands capable of monitoring the victim's activities and delivering arbitrary plugins to further the threat actors’ intentions.</p>
<p>FortiGuard Labs will continue to monitor this ongoing campaign.</p>
<h3><span style="font-weight: normal;">Fortinet Protections</span></h3>
<p> FortiGuard AntiVirus detects the malicious files identified in this report as</p>
<ul>
<li>W64/Agent.CCF!tr</li>
<li>W64/ValleyRat.A!tr.spy</li>
<li>W64/RCShell.A!tr</li>
</ul>
<p>The FortiGuard AntiVirus service is supported by FortiGate, FortiMail, FortiClient, and FortiEDR. The Fortinet AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.</p>
<p>FortiEDR detects the malicious event and is detected by the “Unmapped Executable” rule within the “Exfiltration Prevention” security policy.</p>
<p>The FortiGuard Web Filtering Service detects the C2 URLs cited in this report as Malicious and blocks them.</p>
<p>Due to the ease of disruption, damage to daily operations, potential impact to an organization's reputation, and the unwanted destruction or release of PII, etc., it is important to keep all AV and IPS signatures up to date.</p>
<p>We also suggest that organizations have their end users undergo our free NSE training: <a href="https://training.fortinet.com/?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=nse-institute">NSE 1 – Information Security Awareness</a>. It includes a module on internet threats designed to help end users learn how to identify and protect themselves from various types of phishing attacks.</p>
<p>If you believe these or any other cybersecurity threat has impacted your organization, please contact our <a href="https://www.fortinet.com/corporate/about-us/contact-us/experienced-a-breach">Global FortiGuard Incident Response Team</a>.</p>
<h2><b>IOCs</b></h2>
<h4><span style="font-weight: normal;">C2</span></h4>
<p>154[.]82[.]85[.]12<br />
154[.]92[.]19[.]81<br />
</p>
<h4><span style="font-weight: normal;">Files</span></h4>
<p>1ded5a6c54a7b10365c41bc850ce41f18d86435fbe9315c37bd767ecdf255135<br />
7b98622db7a62ace626dcc8af5bb7ac3726a968241c94612c5b9cb906175f5f3<br />
fb73e089d0a276617b9a213080f84d0e411592c7db5548790e3fe1c53295f5a3<br />
a676c7490086a4112f920936e57ee49e213aaffd12bb38bc433a073ddfae0f24<br />
1235419877ccc1f1820cc75e773fe79f9ad0296dd8eea9aa44f511a7b6348cfd<br />
02aed2b21a90c82d2ca597340aabfa1d6c52302b08aa9f58e87893f6997c2681<br />
02c8f22e9d2df7e051fffc49c7d2d240787fbe8395b4c3c96be40b5a111a03ce<br />
0a971e606e839e7d5e72dcea0a8a3d081c951250ce25b0ddaf2429bad87ebe3d<br />
12ae203fa199291754649a4e592fb0880339c88b07f1d69798114afca06b8061<br />
14bf52de60e60a526141ffe61ef5afc2a3bc7d60d4086e644ec80e67513d2684<br />
17ff585fadcf40e25ad9d09cf007d20f6691ccf31d93a5d48d25f7e811cb0ca4<br />
22bfdc52a65905088b8b897a630c66c16ec5c2eba992c1c0722e5c8da9afa181<br />
24a871b7b837b217d271747337381fbbcff61edfe44e087c55921564b170a8c9<br />
47d7ce4ce72ca7e0cebab472e2165a1ebbd9395a60d7478990fd4dbec2eb195f<br />
583001d3d4dc0a72c92cf27a390e95e1fad6229d18ab255b625985939eb4b90f<br />
7172dff66af9c34958a3b095210664c26a934b5f734b64ea3170f1507a120503<br />
72542f81546656de73e009b541ed12cbcc9feced4f6ab79f9e9a0ee9df148b6a<br />
76b1c8b026ac9e72ffe8ac1dd8d18abfbb4eb9c23bccb42ab9af2580ed72b7ad<br />
8378960ee2bfc32930e19f762f561f4a6448160de2bde6ce330309326d745f89<br />
8790506401a3bac69f6669a3dd832650e4752ff68dd6f0cef35b43e6ad59d7df<br />
8a6b352c45e48e3564e259ade4f544d01900e8c3f9a74e52ae3bc62f74ddf013<br />
8b7d3de2c77c59663ec5d8969b688530a3c9228b72807bc17a9822d558c42ee8<br />
a47423b59d75e228198450f7a9a2e051eeca6388028a6deb8e9843951bf21575<br />
aae7f34bdc0aa362bb42eb5e4cff69b60d67f7f155a3e2b9b905c90a1cc2aac4<br />
ad753becec205160b78de45c11ed42f3da707c9cee0688fa4190233a9b4f1379<br />
ad9bd41e73eff193caab25960b6a990641ea8d412b5ba456b64ad165b7216c48<br />
b50ad87cd7ce19ae30cb709ea3ceb7107b129c64ec9c314157fc6a8df079262b<br />
c486ca7291799a7474196c7cf60158421a2d81697e24e693e76cd1da06b9bf1c<br />
ce8224de916a5eb0c76c9ba7acc3833f8cdc7f7d31a72dfbe69d2be1f8b7cc48<br />
d208b80a6608c72c3c590f86d93b074533c0c4ef8a46b6d36ed52cc2b4c179d5<br />
d63792ee67c6f1702188695387c64991029dabd702d48eac3ea3f0eef280d4a1<br />
ebd3a506c226e98dcedc1b882a11addd25ded8ee5110249b5b1a391e4d77d327<br />
</p>


</div>



        </div>
    </div>
</div>
</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container" style="display:none">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=malware">malware</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/threat-research/an-inside-look-at-cve-2017-0199-hta-and-scriptlet-file-handler-vulnerability" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/individual-images/an-inside-look-at-cve-2017-0199-hta-and-scriptlet-file-handler-vulnerability.png.thumb.319.319.png);">
                <img class="ratio" alt="An Inside Look at CVE-2017-0199 – HTA and Scriptlet File Handler Vulnerability" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">An Inside Look at CVE-2017-0199 – HTA and Scriptlet File Handler Vulnerability</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/wrap-up-us-campaign-themed-malware-and-trolls" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/individual-images/elec1.png.thumb.319.319.png);">
                <img class="ratio" alt="Wrap-up: US Campaign-themed Malware and Trolls" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Wrap-up: US Campaign-themed Malware and Trolls</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/debugging-postscript-with-ghostscript" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/debugging-postscript-with-ghostscript-thumb.jpg.thumb.319.319.png);">
                <img class="ratio" alt="Debugging PostScript with Ghostscript" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Debugging PostScript with Ghostscript</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  
  
 </div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.x.com/Fortinet" target="_blank">
                
    <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"/>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/channel/UCJHo4AuVomwMRzgkA5DQEOA?sub_confirmation=1" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/fortinet/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware Prevention</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="https://community.fortinet.com/" target="_blank">Fortinet Community</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/partners/partner-program/become-a-fortinet-partner" target="_blank">Partner Portal</a>
              </li>
            
              <li>
                <a href="https://investor.fortinet.com/" target="_blank">Investor Relations</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications" target="_blank">Product Certifications</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/nse-training" target="_self">Training</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards" target="_self">Industry Awards</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/corporate-social-responsibility" target="_self">Social Responsibility</a>
              </li>
            
              <li>
                <a href="/resources/cyberglossary" target="_self">CyberGlossary</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/sitemap" target="_self">Sitemap</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/blog/blog-sitemap" target="_self">Blog Sitemap</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2024 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>


    
    
    
    
    
<script src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.ba4f082a77dabb2c6baf715d9eb61c22.js"></script>





    


    

    <!-- BE IXF: The following <div> block needs to be placed in the location where the link block will be displayed
    BE IXF: For your website, the location is above/below ...-->
    <div class="be-ix-link-block">
        <!--
   be_sdkms_pub:bec-built-in; bec-built-in_1.0.0; bodystr;
   be_sdkms_date_modified:pn_tstr:Wed Oct 23 19:00:17 UTC 2024; pn_epoch:1729710017958;
   be_sdkms_timer: 0;
-->

        
    </div>
    <!-- BE IXF: Footer End -->
    </body>
    </html>
