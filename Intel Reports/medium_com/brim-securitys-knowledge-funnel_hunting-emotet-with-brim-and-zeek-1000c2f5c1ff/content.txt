<!doctype html><html lang="en"><head><title data-rh="true">Hunting Emotet with Brim and Zeek | by Oliver Rochford | Brim Security | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-12-08T15:49:19.670Z"/><meta data-rh="true" name="title" content="Hunting Emotet with Brim and Zeek | by Oliver Rochford | Brim Security | Medium"/><meta data-rh="true" property="og:title" content="Hunting Emotet with Brim and Zeek"/><meta data-rh="true" property="al:android:url" content="medium://p/1000c2f5c1ff"/><meta data-rh="true" property="al:ios:url" content="medium://p/1000c2f5c1ff"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="The US Cybersecurity and Infrastructure Security Agency recently released an advisory warning of a resurgence of the Emotet malware. Emotet started out in 2014 as a Banking Trojan, but has since…"/><meta data-rh="true" property="og:description" content="The US Cybersecurity and Infrastructure Security Agency recently released an advisory warning of a resurgence of the Emotet malware."/><meta data-rh="true" property="og:url" content="https://medium.com/brim-securitys-knowledge-funnel/hunting-emotet-with-brim-and-zeek-1000c2f5c1ff"/><meta data-rh="true" property="al:web:url" content="https://medium.com/brim-securitys-knowledge-funnel/hunting-emotet-with-brim-and-zeek-1000c2f5c1ff"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*TAbpSPSFIlaqWjc-"/><meta data-rh="true" property="article:author" content="https://oliver-77164.medium.com"/><meta data-rh="true" name="author" content="Oliver Rochford"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Hunting Emotet with Brim and Zeek"/><meta data-rh="true" name="twitter:site" content="@Brimsecurity"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/1000c2f5c1ff"/><meta data-rh="true" property="twitter:description" content="The US Cybersecurity and Infrastructure Security Agency recently released an advisory warning of a resurgence of the Emotet malware."/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*TAbpSPSFIlaqWjc-"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="8 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://oliver-77164.medium.com"/><link data-rh="true" rel="canonical" href="https://medium.com/brim-securitys-knowledge-funnel/hunting-emotet-with-brim-and-zeek-1000c2f5c1ff"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/1000c2f5c1ff"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*TAbpSPSFIlaqWjc-"],"url":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff","dateCreated":"2020-11-05T12:50:44.960Z","datePublished":"2020-11-05T12:50:44.960Z","dateModified":"2021-12-16T11:25:55.503Z","headline":"Hunting Emotet with Brim and Zeek - Brim Security - Medium","name":"Hunting Emotet with Brim and Zeek - Brim Security - Medium","description":"The US Cybersecurity and Infrastructure Security Agency recently released an advisory warning of a resurgence of the Emotet malware. Emotet started out in 2014 as a Banking Trojan, but has since…","identifier":"1000c2f5c1ff","author":{"@type":"Person","name":"Oliver Rochford","url":"https:\u002F\u002Foliver-77164.medium.com"},"creator":["Oliver Rochford"],"publisher":{"@type":"Organization","name":"Brim Security","url":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel","logo":{"@type":"ImageObject","width":58,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:116\u002F1*UpGFft4ro1MPusfAK6gl2A.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff"}</script><style type="text/css" data-fela-rehydration="581" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="581" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{margin-left:4px}.lr{margin-top:0px}.ls{opacity:1}.lt{padding:4px 0}.lw{width:16px}.ly{display:inline-flex}.me{max-width:100%}.mf{padding:8px 2px}.mg svg{color:#6B6B6B}.mx{line-height:1.58}.my{letter-spacing:-0.004em}.mz{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nu{margin-bottom:-0.46em}.nv{text-decoration:underline}.nw{box-shadow:inset 3px 0 0 0 #242424}.nx{padding-left:23px}.ny{margin-left:-20px}.nz{font-style:italic}.oa{line-height:1.12}.ob{letter-spacing:-0.022em}.oc{font-weight:600}.ox{margin-bottom:-0.28em}.pd{margin-left:auto}.pe{margin-right:auto}.pf{max-width:1555px}.pl{clear:both}.pn{cursor:zoom-in}.po{z-index:auto}.pq{height:auto}.pr{margin-top:10px}.ps{max-width:728px}.pv{overflow-x:auto}.pw{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.px{padding:20px}.py{border-radius:0}.pz{background:#F2F2F2}.qa{line-height:1.18}.qb{margin-top:-0.09em}.qc{margin-bottom:-0.09em}.qd{min-width:fit-content}.qe{max-width:645px}.qf{max-width:656px}.qg{max-width:1600px}.qh{max-width:818px}.qi{max-width:1545px}.qj{max-width:1562px}.qk{max-width:996px}.ql{max-width:634px}.qm{max-width:571px}.qn{max-width:678px}.qo{max-width:1481px}.qp{max-width:1531px}.qq{max-width:1492px}.qr{max-width:718px}.qs{max-width:947px}.qt{max-width:800px}.qu{max-width:954px}.qv{margin-bottom:26px}.qw{margin-top:6px}.qx{margin-top:8px}.qy{margin-right:8px}.qz{padding:8px 16px}.ra{border-radius:100px}.rb{transition:background 300ms ease}.rd{white-space:nowrap}.re{border-top:none}.rf{margin-bottom:14px}.rg{height:52px}.rh{max-height:52px}.ri{box-sizing:content-box}.rj{position:static}.rl{max-width:155px}.rr{margin-right:20px}.rx{height:0px}.ry{margin-bottom:40px}.rz{margin-bottom:48px}.sn{border-radius:2px}.sp{height:64px}.sq{width:64px}.sr{align-self:flex-end}.ss{flex:1 1 auto}.sy{padding-right:4px}.sz{font-weight:500}.tm{margin-top:16px}.tn{color:rgba(255, 255, 255, 1)}.to{fill:rgba(255, 255, 255, 1)}.tp{background:rgba(25, 25, 25, 1)}.tq{border-color:rgba(25, 25, 25, 1)}.tt:disabled{opacity:0.1}.tu:disabled:hover{background:rgba(25, 25, 25, 1)}.tv:disabled:hover{border-color:rgba(25, 25, 25, 1)}.ue{gap:18px}.uf{fill:rgba(61, 61, 61, 1)}.uh{padding-bottom:6px}.ui{border-bottom:1px solid #F2F2F2}.uo{margin-top:32px}.up{fill:#242424}.uq{background:0}.ur{border-color:#242424}.us:disabled:hover{color:#242424}.ut:disabled:hover{fill:#242424}.uu:disabled:hover{border-color:#242424}.vf{border-bottom:solid 1px #E5E5E5}.vg{margin-top:72px}.vh{padding:24px 0}.vi{margin-bottom:0px}.vj{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.lu:hover{fill:#000000}.lv:hover p{color:#000000}.lx:hover{color:#000000}.mh:hover svg{color:#000000}.rc:hover{background-color:#F2F2F2}.so:hover{background-color:none}.tr:hover{background:#000000}.ts:hover{border-color:#242424}.ug:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mi:focus svg{color:#000000}.pp:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.md{margin:0}.nq{font-size:20px}.nr{margin-top:2.14em}.ns{line-height:32px}.nt{letter-spacing:-0.003em}.ot{font-size:24px}.ou{margin-top:1.95em}.ov{line-height:30px}.ow{letter-spacing:-0.016em}.pc{margin-top:0.94em}.pk{margin-top:56px}.rq{display:inline-block}.rw{margin-bottom:104px}.sa{flex-direction:row}.sd{margin-bottom:0}.se{margin-right:20px}.st{max-width:500px}.tk{line-height:24px}.tl{letter-spacing:0}.ua{margin-bottom:88px}.ud{margin-bottom:72px}.un{margin:40px 0 16px}.uz{width:min-width}.ve{padding-top:72px}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.pt{margin-left:auto}.pu{text-align:center}.rp{display:inline-block}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.ro{display:inline-block}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.rn{display:inline-block}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.lz{margin:0}.mj{border:1px solid #F2F2F2}.mk{border-radius:99em}.ml{padding:0px 16px 0px 12px}.mm{height:38px}.mn{align-items:center}.mp svg{margin-right:8px}.na{font-size:18px}.nb{margin-top:1.56em}.nc{line-height:28px}.nd{letter-spacing:-0.003em}.od{font-size:20px}.oe{margin-top:1.2em}.of{line-height:24px}.og{letter-spacing:0}.oy{margin-top:0.67em}.pg{margin-top:40px}.rm{display:inline-block}.rs{margin-bottom:96px}.sl{margin-bottom:20px}.sm{margin-right:0}.sx{max-width:100%}.ta{font-size:24px}.tb{line-height:30px}.tc{letter-spacing:-0.016em}.tw{margin-bottom:64px}.uj{margin:32px 0 16px}.uv{width:100%}.va{padding-top:48px}.mo:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mc{margin:0}.nm{font-size:20px}.nn{margin-top:2.14em}.no{line-height:32px}.np{letter-spacing:-0.003em}.op{font-size:24px}.oq{margin-top:1.95em}.or{line-height:30px}.os{letter-spacing:-0.016em}.pb{margin-top:0.94em}.pj{margin-top:56px}.rv{margin-bottom:104px}.sb{flex-direction:row}.sf{margin-bottom:0}.sg{margin-right:20px}.su{max-width:500px}.ti{line-height:24px}.tj{letter-spacing:0}.tz{margin-bottom:88px}.uc{margin-bottom:72px}.um{margin:40px 0 16px}.uy{width:min-width}.vd{padding-top:72px}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.mb{margin:0}.ni{font-size:20px}.nj{margin-top:2.14em}.nk{line-height:32px}.nl{letter-spacing:-0.003em}.ol{font-size:24px}.om{margin-top:1.95em}.on{line-height:30px}.oo{letter-spacing:-0.016em}.pa{margin-top:0.94em}.pi{margin-top:56px}.ru{margin-bottom:104px}.sc{flex-direction:row}.sh{margin-bottom:0}.si{margin-right:20px}.sv{max-width:500px}.tg{line-height:24px}.th{letter-spacing:0}.ty{margin-bottom:88px}.ub{margin-bottom:72px}.ul{margin:40px 0 16px}.ux{width:min-width}.vc{padding-top:72px}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.ma{margin:0}.mq{border:1px solid #F2F2F2}.mr{border-radius:99em}.ms{padding:0px 16px 0px 12px}.mt{height:38px}.mu{align-items:center}.mw svg{margin-right:8px}.ne{font-size:18px}.nf{margin-top:1.56em}.ng{line-height:28px}.nh{letter-spacing:-0.003em}.oh{font-size:20px}.oi{margin-top:1.2em}.oj{line-height:24px}.ok{letter-spacing:0}.oz{margin-top:0.67em}.ph{margin-top:40px}.rt{margin-bottom:96px}.sj{margin-bottom:20px}.sk{margin-right:0}.sw{max-width:100%}.td{font-size:24px}.te{line-height:30px}.tf{letter-spacing:-0.016em}.tx{margin-bottom:64px}.uk{margin:32px 0 16px}.uw{width:100%}.vb{padding-top:48px}.mv:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="print">.rk{display:none}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pm{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1000c2f5c1ff&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="f50d" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Hunting Emotet with Brim and Zeek</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@oliver-77164?source=post_page---byline--1000c2f5c1ff--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Oliver Rochford" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*gKZqXtatbhNKvonPm_9J1w.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/brim-securitys-knowledge-funnel?source=post_page---byline--1000c2f5c1ff--------------------------------" rel="noopener follow"><div class="l ii ij by id ik"><div class="l fj"><img alt="Brim Security" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*UpGFft4ro1MPusfAK6gl2A.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@oliver-77164?source=post_page---byline--1000c2f5c1ff--------------------------------">Oliver Rochford</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b62ed97c539&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;user=Oliver+Rochford&amp;userId=2b62ed97c539&amp;source=post_page-2b62ed97c539--byline--1000c2f5c1ff---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/brim-securitys-knowledge-funnel?source=post_page---byline--1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Brim Security</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Nov 5, 2020</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fbrim-securitys-knowledge-funnel%2F1000c2f5c1ff&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;user=Oliver+Rochford&amp;userId=2b62ed97c539&amp;source=---header_actions--1000c2f5c1ff---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la ls lt ab q fk lu lv" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv z du"><span class="pw-responses-count lq lr">2</span></p></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lw k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1000c2f5c1ff&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;source=---header_actions--1000c2f5c1ff---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lx" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd ly cn"><div class="l ae"><div class="ab cb"><div class="lz ma mb mc md me ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi mj mk ml mm s mn mo mp mq mr ms mt u mu mv mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi mj mk ml mm s mn mo mp mq mr ms mt u mu mv mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="c8a8" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">The US Cybersecurity and Infrastructure Security Agency recently released an <a class="af nv" href="https://us-cert.cisa.gov/ncas/alerts/aa20-280a" rel="noopener ugc nofollow" target="_blank">advisory</a> warning of a resurgence of the <a class="af nv" href="https://www.malwarebytes.com/emotet/" rel="noopener ugc nofollow" target="_blank">Emotet</a> malware.</p><p id="cbce" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Emotet started out in <a class="af nv" href="https://www.zdnet.com/article/meet-the-white-hat-group-fighting-emotet-the-worlds-most-dangerous-malware/" rel="noopener ugc nofollow" target="_blank">2014 as a Banking Trojan</a>, but has since evolved into a sophisticated malware, offered on the Darknet as a commercial Cybercrime-as-a-Service platform.</p><p id="276e" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Victims that are infected with Emotet are usually targeted with a phishing email containing a macro-enabled malicious document, or a link to one hosted on a compromised website. The malware frequently acts as a “<a class="af nv" href="https://blog.malwarebytes.com/detections/trojan-dropper/" rel="noopener ugc nofollow" target="_blank">dropper</a>” and downloads additional components and payloads. Emotet has <a class="af nv" href="https://blog.malwarebytes.com/detections/worm/" rel="noopener ugc nofollow" target="_blank">worming</a> capabilities and may attempt to enumerate and infect further victims on accessible networks. Command and Control (C2) is executed via HTTP POST requests on ports 80, 443 and 8080 to randomized alphanumerical named directories on compromised C2 servers.</p><p id="caf2" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">What makes Emotet really dangerous is that it is sold as an operational platform to a variety of different threat actors with diverse motivations. Further, the malware can deploy different payloads depending on the objective — from stealing banking credentials to ransomware. It is essentially infrastructure-as-a-service for hacking. In practise this means that it constantly evolves and can come in many guises.</p><p id="d4dc" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">With Emotet on the rise again, blue team and incident response teams should familiarise themselves with how this dangerous threat behaves and evaluate how best to detect and hunt it. Luckily, there are samples available. In this article, we are specifically working with the following sample from the good people at <a class="af nv" href="https://www.malware-traffic-analysis.net/" rel="noopener ugc nofollow" target="_blank">Malware Traffic Analysis</a>:</p><p id="6a42" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk"><a class="af nv" href="https://www.malware-traffic-analysis.net/2020/09/02/2020-09-01-Emotet-epoch-3-infection-with-Trickbot-gtag-mor119.pcap.zip" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">2020–09–01-Emotet-epoch-3-infection-with-Trickbot-gtag-mor119.pcap.zip</strong></a></p><p id="a5af" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">We’ll also be using the <a class="af nv" href="https://github.com/brimsec/brim" rel="noopener ugc nofollow" target="_blank">Brim Desktop</a> client. Let’s go hunt!</p><blockquote class="nw nx ny"><p id="09ac" class="mx my nz mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk"><strong class="mz gv">TIP! </strong>You can find detailed installation instructions for Brim on Windows, Linux and macOS under <a class="af nv" href="https://github.com/brimsec/brim/wiki/Installation" rel="noopener ugc nofollow" target="_blank">https://github.com/brimsec/brim/wiki/Installation</a></p></blockquote><h1 id="9a3e" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Finding Patient X</h1><p id="2d68" class="pw-post-body-paragraph mx my gu mz b na oy nc nd ne oz ng nh ni pa nk nl nm pb no np nq pc ns nt nu gn bk">As we discussed in the first <a class="af nv" rel="noopener" href="/brim-securitys-knowledge-funnel/five-elegant-brim-queries-to-threat-hunt-in-zeek-logs-and-packet-captures-30eec4c09933">article</a>, a good first step when investigating malware is to investigate the DNS activity, specifically for which domains there are resolution requests. Zeek provides a DNS protocol analyzer specifically for this purpose.</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe pf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*TAbpSPSFIlaqWjc- 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*TAbpSPSFIlaqWjc- 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*TAbpSPSFIlaqWjc- 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*TAbpSPSFIlaqWjc- 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*TAbpSPSFIlaqWjc- 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*TAbpSPSFIlaqWjc- 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TAbpSPSFIlaqWjc- 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*TAbpSPSFIlaqWjc- 640w, https://miro.medium.com/v2/resize:fit:720/0*TAbpSPSFIlaqWjc- 720w, https://miro.medium.com/v2/resize:fit:750/0*TAbpSPSFIlaqWjc- 750w, https://miro.medium.com/v2/resize:fit:786/0*TAbpSPSFIlaqWjc- 786w, https://miro.medium.com/v2/resize:fit:828/0*TAbpSPSFIlaqWjc- 828w, https://miro.medium.com/v2/resize:fit:1100/0*TAbpSPSFIlaqWjc- 1100w, https://miro.medium.com/v2/resize:fit:1400/0*TAbpSPSFIlaqWjc- 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="181" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Zeek’s DNS stream in Brim</figcaption></figure><p id="714d" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">To gain an overview of what’s going on, we’ll use a ZQL query to stack the queries by count</p><pre class="pg ph pi pj pk pv pw px py ay pz bk"><span id="6714" class="qa ob gu pw b io qb qc l jd qd">_path=dns | count() by query | sort -r</span></pre><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div class="pd pe qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*x_VxZUBzYVGAUwFj 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*x_VxZUBzYVGAUwFj 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*x_VxZUBzYVGAUwFj 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*x_VxZUBzYVGAUwFj 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*x_VxZUBzYVGAUwFj 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*x_VxZUBzYVGAUwFj 1100w, https://miro.medium.com/v2/resize:fit:1290/format:webp/0*x_VxZUBzYVGAUwFj 1290w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 645px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*x_VxZUBzYVGAUwFj 640w, https://miro.medium.com/v2/resize:fit:720/0*x_VxZUBzYVGAUwFj 720w, https://miro.medium.com/v2/resize:fit:750/0*x_VxZUBzYVGAUwFj 750w, https://miro.medium.com/v2/resize:fit:786/0*x_VxZUBzYVGAUwFj 786w, https://miro.medium.com/v2/resize:fit:828/0*x_VxZUBzYVGAUwFj 828w, https://miro.medium.com/v2/resize:fit:1100/0*x_VxZUBzYVGAUwFj 1100w, https://miro.medium.com/v2/resize:fit:1290/0*x_VxZUBzYVGAUwFj 1290w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 645px"/><img alt="" class="bh me pq c" width="645" height="721" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Count of unique DNS queries</figcaption></figure><p id="ac3f" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">We see a number of different windows network requests, for example for “<em class="nz">WORKGROUP</em>”, some legitimate “<em class="nz">Microsoft.com</em>” requests, and single requests to threat-intelligence related addresses such as for <em class="nz">Spamhaus</em>. We can right-click on any domain we do not recognize and verify them using <a class="af nv" href="https://www.virustotal.com/gui/" rel="noopener ugc nofollow" target="_blank">VirusTotal</a>.</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div class="pd pe qf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*k0Aaxyf3PmRDHyQC 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*k0Aaxyf3PmRDHyQC 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*k0Aaxyf3PmRDHyQC 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*k0Aaxyf3PmRDHyQC 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*k0Aaxyf3PmRDHyQC 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*k0Aaxyf3PmRDHyQC 1100w, https://miro.medium.com/v2/resize:fit:1312/format:webp/0*k0Aaxyf3PmRDHyQC 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*k0Aaxyf3PmRDHyQC 640w, https://miro.medium.com/v2/resize:fit:720/0*k0Aaxyf3PmRDHyQC 720w, https://miro.medium.com/v2/resize:fit:750/0*k0Aaxyf3PmRDHyQC 750w, https://miro.medium.com/v2/resize:fit:786/0*k0Aaxyf3PmRDHyQC 786w, https://miro.medium.com/v2/resize:fit:828/0*k0Aaxyf3PmRDHyQC 828w, https://miro.medium.com/v2/resize:fit:1100/0*k0Aaxyf3PmRDHyQC 1100w, https://miro.medium.com/v2/resize:fit:1312/0*k0Aaxyf3PmRDHyQC 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px"/><img alt="" class="bh me pq c" width="656" height="733" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Right-click on any domain to validate it using VirusTotal</figcaption></figure><p id="004a" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">VirusTotal flags one of the domains, “ <em class="nz">t-privat.de</em>”, as malicious, and known to have hosted malware in the past. We now have a trail to follow.</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*4ltBY_PJPLtNw2TX 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*4ltBY_PJPLtNw2TX 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*4ltBY_PJPLtNw2TX 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*4ltBY_PJPLtNw2TX 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*4ltBY_PJPLtNw2TX 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*4ltBY_PJPLtNw2TX 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4ltBY_PJPLtNw2TX 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*4ltBY_PJPLtNw2TX 640w, https://miro.medium.com/v2/resize:fit:720/0*4ltBY_PJPLtNw2TX 720w, https://miro.medium.com/v2/resize:fit:750/0*4ltBY_PJPLtNw2TX 750w, https://miro.medium.com/v2/resize:fit:786/0*4ltBY_PJPLtNw2TX 786w, https://miro.medium.com/v2/resize:fit:828/0*4ltBY_PJPLtNw2TX 828w, https://miro.medium.com/v2/resize:fit:1100/0*4ltBY_PJPLtNw2TX 1100w, https://miro.medium.com/v2/resize:fit:1400/0*4ltBY_PJPLtNw2TX 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="299" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">VirusTotal shows the suspicious URI as malicious</figcaption></figure><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*0BszizHl3mM3_mTF 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*0BszizHl3mM3_mTF 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*0BszizHl3mM3_mTF 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*0BszizHl3mM3_mTF 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*0BszizHl3mM3_mTF 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*0BszizHl3mM3_mTF 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0BszizHl3mM3_mTF 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*0BszizHl3mM3_mTF 640w, https://miro.medium.com/v2/resize:fit:720/0*0BszizHl3mM3_mTF 720w, https://miro.medium.com/v2/resize:fit:750/0*0BszizHl3mM3_mTF 750w, https://miro.medium.com/v2/resize:fit:786/0*0BszizHl3mM3_mTF 786w, https://miro.medium.com/v2/resize:fit:828/0*0BszizHl3mM3_mTF 828w, https://miro.medium.com/v2/resize:fit:1100/0*0BszizHl3mM3_mTF 1100w, https://miro.medium.com/v2/resize:fit:1400/0*0BszizHl3mM3_mTF 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="393" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Details for the malicious Domain</figcaption></figure><p id="d1e1" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">A nice little blind check at this point is to verify if the relevant Host A Record IP address “<em class="nz">81.169.145.161</em>” is present anywhere else in our dataset.</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*q3BwfxHy9CF_Isi8 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*q3BwfxHy9CF_Isi8 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*q3BwfxHy9CF_Isi8 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*q3BwfxHy9CF_Isi8 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*q3BwfxHy9CF_Isi8 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*q3BwfxHy9CF_Isi8 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*q3BwfxHy9CF_Isi8 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*q3BwfxHy9CF_Isi8 640w, https://miro.medium.com/v2/resize:fit:720/0*q3BwfxHy9CF_Isi8 720w, https://miro.medium.com/v2/resize:fit:750/0*q3BwfxHy9CF_Isi8 750w, https://miro.medium.com/v2/resize:fit:786/0*q3BwfxHy9CF_Isi8 786w, https://miro.medium.com/v2/resize:fit:828/0*q3BwfxHy9CF_Isi8 828w, https://miro.medium.com/v2/resize:fit:1100/0*q3BwfxHy9CF_Isi8 1100w, https://miro.medium.com/v2/resize:fit:1400/0*q3BwfxHy9CF_Isi8 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="209" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Hit! The IP address related to the VirusTotal alert matches our data</figcaption></figure><p id="4b1c" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">The search returns positive — we are looking at the same threat that was submitted to VirusTotal. Note the file transfer via HTTP to an internal host. That’s something we want to investigate further.</p><p id="0a0c" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">We’ll revisit one of our <a class="af nv" rel="noopener" href="/brim-securitys-knowledge-funnel/five-elegant-brim-queries-to-threat-hunt-in-zeek-logs-and-packet-captures-30eec4c09933">Power Queries</a> to show all of the relevant file activity within our data that has a complete filename, but extend it to provide us with a tailored view showing us only the fields that are relevant to us at this juncture:</p><pre class="pg ph pi pj pk pv pw px py ay pz bk"><span id="df8c" class="qa ob gu pw b io qb qc l jd qd">filename!=null | cut _path, tx_hosts, rx_hosts, conn_uids, mime_type, filename, md5, sha1</span></pre><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*r_lBSVdaanQ-C4po 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*r_lBSVdaanQ-C4po 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*r_lBSVdaanQ-C4po 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*r_lBSVdaanQ-C4po 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*r_lBSVdaanQ-C4po 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*r_lBSVdaanQ-C4po 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r_lBSVdaanQ-C4po 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*r_lBSVdaanQ-C4po 640w, https://miro.medium.com/v2/resize:fit:720/0*r_lBSVdaanQ-C4po 720w, https://miro.medium.com/v2/resize:fit:750/0*r_lBSVdaanQ-C4po 750w, https://miro.medium.com/v2/resize:fit:786/0*r_lBSVdaanQ-C4po 786w, https://miro.medium.com/v2/resize:fit:828/0*r_lBSVdaanQ-C4po 828w, https://miro.medium.com/v2/resize:fit:1100/0*r_lBSVdaanQ-C4po 1100w, https://miro.medium.com/v2/resize:fit:1400/0*r_lBSVdaanQ-C4po 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="138" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Curated File Activity view — the Plot thickens</figcaption></figure><p id="f3cc" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">There are a number of strange looking HTTP connections with filenames lacking any type of extension or MIME type. We also find the full filename, “UR608.exe”, from our malicious internet host “<em class="nz">81.169.145.161</em>” (<em class="nz">t-privat.de</em>). Thanks to Zeek’s MD5 and SHA1 processors, we can harness VirusTotal again. Our Patient X is “<em class="nz">10.9.1.101</em>”.</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*MSsKmBqvNbMxuIOb 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*MSsKmBqvNbMxuIOb 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*MSsKmBqvNbMxuIOb 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*MSsKmBqvNbMxuIOb 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*MSsKmBqvNbMxuIOb 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*MSsKmBqvNbMxuIOb 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MSsKmBqvNbMxuIOb 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*MSsKmBqvNbMxuIOb 640w, https://miro.medium.com/v2/resize:fit:720/0*MSsKmBqvNbMxuIOb 720w, https://miro.medium.com/v2/resize:fit:750/0*MSsKmBqvNbMxuIOb 750w, https://miro.medium.com/v2/resize:fit:786/0*MSsKmBqvNbMxuIOb 786w, https://miro.medium.com/v2/resize:fit:828/0*MSsKmBqvNbMxuIOb 828w, https://miro.medium.com/v2/resize:fit:1100/0*MSsKmBqvNbMxuIOb 1100w, https://miro.medium.com/v2/resize:fit:1400/0*MSsKmBqvNbMxuIOb 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="264" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Emotet sighted! VirusTotal confirms the file is associated with known malware.</figcaption></figure><h1 id="8394" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Identifying Command and Control</h1><p id="ea33" class="pw-post-body-paragraph mx my gu mz b na oy nc nd ne oz ng nh ni pa nk nl nm pb no np nq pc ns nt nu gn bk">Now that we’ve verified the initial point of access for the attack, we can follow how the attack unfolded. When we reviewed the files contained in our data, we saw three other connections originating from the infected system. If we double-click on any of the records in question, we conjure up a detailed view showing a waterfall that includes all app transactions and file payloads throughout the life of a flow:</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*4KUWvqsHhWzoCQW4 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*4KUWvqsHhWzoCQW4 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*4KUWvqsHhWzoCQW4 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*4KUWvqsHhWzoCQW4 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*4KUWvqsHhWzoCQW4 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*4KUWvqsHhWzoCQW4 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4KUWvqsHhWzoCQW4 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*4KUWvqsHhWzoCQW4 640w, https://miro.medium.com/v2/resize:fit:720/0*4KUWvqsHhWzoCQW4 720w, https://miro.medium.com/v2/resize:fit:750/0*4KUWvqsHhWzoCQW4 750w, https://miro.medium.com/v2/resize:fit:786/0*4KUWvqsHhWzoCQW4 786w, https://miro.medium.com/v2/resize:fit:828/0*4KUWvqsHhWzoCQW4 828w, https://miro.medium.com/v2/resize:fit:1100/0*4KUWvqsHhWzoCQW4 1100w, https://miro.medium.com/v2/resize:fit:1400/0*4KUWvqsHhWzoCQW4 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="393" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Connection Diagram for the suspicious HTTP requests from our Patient X</figcaption></figure><p id="8e8e" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">We can see a connection over a three minute time period. If you’re familiar with Zeek, the “dpd” and “weird” events immediately stick out. Let’s look into these. You can pivot right into the relevant details by clicking on any entry in the Connection Diagram. Zeek’s “<a class="af nv" href="https://old.zeek.org/development/howtos/dpd.html" rel="noopener ugc nofollow" target="_blank">Dynamic Protocol Detection</a>” (dpd) stream processor detects network protocol anomalies. The “<a class="af nv" href="https://zeek.org/2019/11/13/what-is-weird-in-zeek/" rel="noopener ugc nofollow" target="_blank">weird</a>” processor on the other hand alerts on unusual activity such as malformed requests.</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*YgzGQ-PrqiSgxSzw 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*YgzGQ-PrqiSgxSzw 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*YgzGQ-PrqiSgxSzw 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*YgzGQ-PrqiSgxSzw 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*YgzGQ-PrqiSgxSzw 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*YgzGQ-PrqiSgxSzw 1100w, https://miro.medium.com/v2/resize:fit:1268/format:webp/0*YgzGQ-PrqiSgxSzw 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*YgzGQ-PrqiSgxSzw 640w, https://miro.medium.com/v2/resize:fit:720/0*YgzGQ-PrqiSgxSzw 720w, https://miro.medium.com/v2/resize:fit:750/0*YgzGQ-PrqiSgxSzw 750w, https://miro.medium.com/v2/resize:fit:786/0*YgzGQ-PrqiSgxSzw 786w, https://miro.medium.com/v2/resize:fit:828/0*YgzGQ-PrqiSgxSzw 828w, https://miro.medium.com/v2/resize:fit:1100/0*YgzGQ-PrqiSgxSzw 1100w, https://miro.medium.com/v2/resize:fit:1268/0*YgzGQ-PrqiSgxSzw 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px"/><img alt="" class="bh me pq c" width="634" height="437" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Brim’s detailed view for Zeek’s “dpd” stream</figcaption></figure><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div class="pd pe qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*YzvswDb621aQ0IHW 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*YzvswDb621aQ0IHW 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*YzvswDb621aQ0IHW 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*YzvswDb621aQ0IHW 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*YzvswDb621aQ0IHW 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*YzvswDb621aQ0IHW 1100w, https://miro.medium.com/v2/resize:fit:1142/format:webp/0*YzvswDb621aQ0IHW 1142w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 571px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*YzvswDb621aQ0IHW 640w, https://miro.medium.com/v2/resize:fit:720/0*YzvswDb621aQ0IHW 720w, https://miro.medium.com/v2/resize:fit:750/0*YzvswDb621aQ0IHW 750w, https://miro.medium.com/v2/resize:fit:786/0*YzvswDb621aQ0IHW 786w, https://miro.medium.com/v2/resize:fit:828/0*YzvswDb621aQ0IHW 828w, https://miro.medium.com/v2/resize:fit:1100/0*YzvswDb621aQ0IHW 1100w, https://miro.medium.com/v2/resize:fit:1142/0*YzvswDb621aQ0IHW 1142w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 571px"/><img alt="" class="bh me pq c" width="571" height="453" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Brim’s detailed view for Zeek’s “weird” stream</figcaption></figure><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div class="pd pe qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*lQMp7EtyNDODnRHH 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*lQMp7EtyNDODnRHH 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*lQMp7EtyNDODnRHH 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*lQMp7EtyNDODnRHH 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*lQMp7EtyNDODnRHH 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*lQMp7EtyNDODnRHH 1100w, https://miro.medium.com/v2/resize:fit:1356/format:webp/0*lQMp7EtyNDODnRHH 1356w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 678px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*lQMp7EtyNDODnRHH 640w, https://miro.medium.com/v2/resize:fit:720/0*lQMp7EtyNDODnRHH 720w, https://miro.medium.com/v2/resize:fit:750/0*lQMp7EtyNDODnRHH 750w, https://miro.medium.com/v2/resize:fit:786/0*lQMp7EtyNDODnRHH 786w, https://miro.medium.com/v2/resize:fit:828/0*lQMp7EtyNDODnRHH 828w, https://miro.medium.com/v2/resize:fit:1100/0*lQMp7EtyNDODnRHH 1100w, https://miro.medium.com/v2/resize:fit:1356/0*lQMp7EtyNDODnRHH 1356w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 678px"/><img alt="" class="bh me pq c" width="678" height="462" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Brim’s detailed view for Zeek’s “weird” stream</figcaption></figure><p id="129c" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Zeek has detected that the connection in question does not appear to be standard HTTP. Of note is also the non-standard destination port “8080” under “id.resp_p”, commonly used for HTTP Proxying . We’d usually expect to see port 443 for web traffic, or port 80 in rare legacy cases. Attackers will frequently attempt C2 via ports that have a high probability of being permitted through any network access controls such as a firewall. VirusTotal also confirms that the IP address “<em class="nz">118.110.236.121</em>” is malicious. Lastly, when we look at the Log Detail for the initial HTTP requests, we see it’s an <em class="nz">HTTP POST</em> request. The random character URI also seems suspicious:</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*M6fJ-CZ6M0QCnz6U 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*M6fJ-CZ6M0QCnz6U 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*M6fJ-CZ6M0QCnz6U 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*M6fJ-CZ6M0QCnz6U 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*M6fJ-CZ6M0QCnz6U 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*M6fJ-CZ6M0QCnz6U 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*M6fJ-CZ6M0QCnz6U 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*M6fJ-CZ6M0QCnz6U 640w, https://miro.medium.com/v2/resize:fit:720/0*M6fJ-CZ6M0QCnz6U 720w, https://miro.medium.com/v2/resize:fit:750/0*M6fJ-CZ6M0QCnz6U 750w, https://miro.medium.com/v2/resize:fit:786/0*M6fJ-CZ6M0QCnz6U 786w, https://miro.medium.com/v2/resize:fit:828/0*M6fJ-CZ6M0QCnz6U 828w, https://miro.medium.com/v2/resize:fit:1100/0*M6fJ-CZ6M0QCnz6U 1100w, https://miro.medium.com/v2/resize:fit:1400/0*M6fJ-CZ6M0QCnz6U 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="394" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">HTTP POST request to URI including randomized alphanumeric directory name</figcaption></figure><p id="e948" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">A safe hunch would be that this is the command and control (C2) traffic we’re seeing here. When we filter for our suspected C2 Server “<em class="nz">118.110.236.121</em>” with the <em class="nz">HTTP POST</em> method in the Zeek HTTP Stream, we can see the beaconing:</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*aVvbBYkcXKMhlbWI 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*aVvbBYkcXKMhlbWI 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*aVvbBYkcXKMhlbWI 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*aVvbBYkcXKMhlbWI 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*aVvbBYkcXKMhlbWI 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*aVvbBYkcXKMhlbWI 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aVvbBYkcXKMhlbWI 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*aVvbBYkcXKMhlbWI 640w, https://miro.medium.com/v2/resize:fit:720/0*aVvbBYkcXKMhlbWI 720w, https://miro.medium.com/v2/resize:fit:750/0*aVvbBYkcXKMhlbWI 750w, https://miro.medium.com/v2/resize:fit:786/0*aVvbBYkcXKMhlbWI 786w, https://miro.medium.com/v2/resize:fit:828/0*aVvbBYkcXKMhlbWI 828w, https://miro.medium.com/v2/resize:fit:1100/0*aVvbBYkcXKMhlbWI 1100w, https://miro.medium.com/v2/resize:fit:1400/0*aVvbBYkcXKMhlbWI 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="215" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Emotet C2 Traffic</figcaption></figure><h1 id="2def" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Enumerating Command and Control</h1><blockquote class="nw nx ny"><p id="14a1" class="mx my nz mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk"><strong class="mz gv">TIP! </strong>To evade detection and provide redundancy against C2 servers being blocked by inclusion on threat intelligence sources, Malware operators use a network of compromised systems for their command and control infrastructure. The list of C2 servers are constantly updated to try and always stay one step ahead of threat researchers. If you’re interested in further details about how Malware C2 works, see this article: <a class="af nv" href="https://searchsecurity.techtarget.com/feature/Command-and-control-servers-The-puppet-masters-that-govern-malware" rel="noopener ugc nofollow" target="_blank">https://searchsecurity.techtarget.com/feature/Command-and-control-servers-The-puppet-masters-that-govern-malware</a></p></blockquote><p id="174a" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">It would be unusual for Emotet to rely on a single C2 instance. One way we can quickly validate this is to search for any additional <em class="nz">HTTP POST</em> requests Victim X may be sending:</p><pre class="pg ph pi pj pk pv pw px py ay pz bk"><span id="8e62" class="qa ob gu pw b io qb qc l jd qd">id.orig_h=10.9.1.101 method=POST | cut ts, uid, id, method, uri, status_code</span></pre><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*ah73tiHyU3lnC7NL 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*ah73tiHyU3lnC7NL 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*ah73tiHyU3lnC7NL 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*ah73tiHyU3lnC7NL 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*ah73tiHyU3lnC7NL 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*ah73tiHyU3lnC7NL 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ah73tiHyU3lnC7NL 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*ah73tiHyU3lnC7NL 640w, https://miro.medium.com/v2/resize:fit:720/0*ah73tiHyU3lnC7NL 720w, https://miro.medium.com/v2/resize:fit:750/0*ah73tiHyU3lnC7NL 750w, https://miro.medium.com/v2/resize:fit:786/0*ah73tiHyU3lnC7NL 786w, https://miro.medium.com/v2/resize:fit:828/0*ah73tiHyU3lnC7NL 828w, https://miro.medium.com/v2/resize:fit:1100/0*ah73tiHyU3lnC7NL 1100w, https://miro.medium.com/v2/resize:fit:1400/0*ah73tiHyU3lnC7NL 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="220" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">HTTP POST activity from Patient X</figcaption></figure><p id="72f6" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Victim X is concerningly making a number of other successful suspicious <em class="nz">HTTP POST</em> requests. VirusTotal confirms that all of the involved destination IP addresses are malicious.</p><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*AiGFwTvcqJjSbDa_ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*AiGFwTvcqJjSbDa_ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*AiGFwTvcqJjSbDa_ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*AiGFwTvcqJjSbDa_ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*AiGFwTvcqJjSbDa_ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*AiGFwTvcqJjSbDa_ 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AiGFwTvcqJjSbDa_ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*AiGFwTvcqJjSbDa_ 640w, https://miro.medium.com/v2/resize:fit:720/0*AiGFwTvcqJjSbDa_ 720w, https://miro.medium.com/v2/resize:fit:750/0*AiGFwTvcqJjSbDa_ 750w, https://miro.medium.com/v2/resize:fit:786/0*AiGFwTvcqJjSbDa_ 786w, https://miro.medium.com/v2/resize:fit:828/0*AiGFwTvcqJjSbDa_ 828w, https://miro.medium.com/v2/resize:fit:1100/0*AiGFwTvcqJjSbDa_ 1100w, https://miro.medium.com/v2/resize:fit:1400/0*AiGFwTvcqJjSbDa_ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="305" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">VirusTotal confirms our suspicious IP address is malicious</figcaption></figure><p id="1c82" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">A further search for the malicious IP addresses in our data yields no further results, but of course we can now take our list (<em class="nz">45.230.228.26</em>, <em class="nz">118.110.236.121</em>, <em class="nz">195.123.242.119</em>) and conduct further searches across other detection and search tools, for example a SIEM, as well as adding them to our access control deny list.</p><h1 id="4026" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Evaluating the spread of Infection</h1><p id="4538" class="pw-post-body-paragraph mx my gu mz b na oy nc nd ne oz ng nh ni pa nk nl nm pb no np nq pc ns nt nu gn bk">As Emotet is known to propagate via the network, we should also establish whether any other hosts have been infected.</p><p id="8fd0" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">First let’s see what sort of traffic our data contains. We can lean on Zeek’s streams here again, and generate a list of any contained in the packet capture with associated counts:</p><pre class="pg ph pi pj pk pv pw px py ay pz bk"><span id="70c5" class="qa ob gu pw b io qb qc l jd qd">_path | count() by _path | sort -r</span></pre><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*aAy8J-aeuUVZJdxr 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*aAy8J-aeuUVZJdxr 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*aAy8J-aeuUVZJdxr 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*aAy8J-aeuUVZJdxr 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*aAy8J-aeuUVZJdxr 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*aAy8J-aeuUVZJdxr 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aAy8J-aeuUVZJdxr 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*aAy8J-aeuUVZJdxr 640w, https://miro.medium.com/v2/resize:fit:720/0*aAy8J-aeuUVZJdxr 720w, https://miro.medium.com/v2/resize:fit:750/0*aAy8J-aeuUVZJdxr 750w, https://miro.medium.com/v2/resize:fit:786/0*aAy8J-aeuUVZJdxr 786w, https://miro.medium.com/v2/resize:fit:828/0*aAy8J-aeuUVZJdxr 828w, https://miro.medium.com/v2/resize:fit:1100/0*aAy8J-aeuUVZJdxr 1100w, https://miro.medium.com/v2/resize:fit:1400/0*aAy8J-aeuUVZJdxr 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="610" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Zeek Streams by count</figcaption></figure><p id="2e4f" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Interestingly enough, we don’t see any activity that would indicate internal reconnaissance or propagation. If present, we’d typically expect to see something like Windows SMB and DCE/RPC activity here. This does not necessarily mean that no further infection occurred — just that we don’t have any indicators in our data.</p><p id="b492" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Lastly, just to be sure, we’ll enumerate any connections our patient X may have attempted on the internal network. For this, we’re going to use ZQL’s <a class="af nv" href="https://github.com/brimsec/zq/blob/master/zql/docs/data-types/README.md" rel="noopener ugc nofollow" target="_blank">rich data typing</a>, specifically that there is an IP address data type that supports CIDR filtering:</p><pre class="pg ph pi pj pk pv pw px py ay pz bk"><span id="9ff6" class="qa ob gu pw b io qb qc l jd qd">id.orig_h=10.9.1.101 id.resp_h=~10.0.0.0/8 | count() by id.resp_h,_path</span></pre><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*cGIu-tYTPqeg9tYq 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*cGIu-tYTPqeg9tYq 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*cGIu-tYTPqeg9tYq 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*cGIu-tYTPqeg9tYq 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*cGIu-tYTPqeg9tYq 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*cGIu-tYTPqeg9tYq 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cGIu-tYTPqeg9tYq 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*cGIu-tYTPqeg9tYq 640w, https://miro.medium.com/v2/resize:fit:720/0*cGIu-tYTPqeg9tYq 720w, https://miro.medium.com/v2/resize:fit:750/0*cGIu-tYTPqeg9tYq 750w, https://miro.medium.com/v2/resize:fit:786/0*cGIu-tYTPqeg9tYq 786w, https://miro.medium.com/v2/resize:fit:828/0*cGIu-tYTPqeg9tYq 828w, https://miro.medium.com/v2/resize:fit:1100/0*cGIu-tYTPqeg9tYq 1100w, https://miro.medium.com/v2/resize:fit:1400/0*cGIu-tYTPqeg9tYq 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="274" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">All connections in the 10.0.0.0/8 subnet that patient X communicated with</figcaption></figure><p id="7743" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">We see there is some DNS traffic to two other hosts, which we may assume are DNS servers. Nothing in the data indicates further infections.</p><h1 id="785a" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Putting it all together</h1><p id="8a95" class="pw-post-body-paragraph mx my gu mz b na oy nc nd ne oz ng nh ni pa nk nl nm pb no np nq pc ns nt nu gn bk">While we didn’t see any propagation events, we did successfully pinpoint the initial infection, identified Patient X and enumerated the C2 servers. This will allow us to conduct further threat hunting, develop detections and create signatures and watch lists for blocking the threat on the network. The diagram below outlines the activity we’ve been investigating:</p><h1 id="e426" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Emotet Sample observed activity</h1><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*2uauAZMOZGBUxfk7 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*2uauAZMOZGBUxfk7 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*2uauAZMOZGBUxfk7 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*2uauAZMOZGBUxfk7 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*2uauAZMOZGBUxfk7 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*2uauAZMOZGBUxfk7 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2uauAZMOZGBUxfk7 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*2uauAZMOZGBUxfk7 640w, https://miro.medium.com/v2/resize:fit:720/0*2uauAZMOZGBUxfk7 720w, https://miro.medium.com/v2/resize:fit:750/0*2uauAZMOZGBUxfk7 750w, https://miro.medium.com/v2/resize:fit:786/0*2uauAZMOZGBUxfk7 786w, https://miro.medium.com/v2/resize:fit:828/0*2uauAZMOZGBUxfk7 828w, https://miro.medium.com/v2/resize:fit:1100/0*2uauAZMOZGBUxfk7 1100w, https://miro.medium.com/v2/resize:fit:1400/0*2uauAZMOZGBUxfk7 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="394" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pd pe pt pu bf b bg z du">Emotet Incident outline</figcaption></figure><h1 id="498a" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Observed Indicators of Compromise</h1><figure class="pg ph pi pj pk pl pd pe paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pd pe qu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SwkHokqni8ufS9ogmbqgSw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SwkHokqni8ufS9ogmbqgSw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SwkHokqni8ufS9ogmbqgSw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SwkHokqni8ufS9ogmbqgSw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SwkHokqni8ufS9ogmbqgSw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SwkHokqni8ufS9ogmbqgSw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwkHokqni8ufS9ogmbqgSw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*SwkHokqni8ufS9ogmbqgSw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SwkHokqni8ufS9ogmbqgSw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SwkHokqni8ufS9ogmbqgSw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SwkHokqni8ufS9ogmbqgSw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SwkHokqni8ufS9ogmbqgSw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SwkHokqni8ufS9ogmbqgSw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SwkHokqni8ufS9ogmbqgSw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me pq c" width="700" height="368" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="d793" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Observed MITRE ATT&amp;CK Techniques</h1><p id="052d" class="pw-post-body-paragraph mx my gu mz b na oy nc nd ne oz ng nh ni pa nk nl nm pb no np nq pc ns nt nu gn bk">We assume that the malicious file we observed being downloaded from “t-privat.de” was the tail end of an initial phishing attempt. That would entail the following MITRE ATT&amp;CK Techniques:</p><p id="a89b" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk"><a class="af nv" href="https://attack.mitre.org/techniques/T1566" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">T1566</strong></a><strong class="mz gv">:002 </strong><a class="af nv" href="https://attack.mitre.org/techniques/T1566" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">Phishing</strong></a><strong class="mz gv">: </strong><a class="af nv" href="https://attack.mitre.org/techniques/T1566/002" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">Spearphishing Link</strong></a></p><p id="6586" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Emotet has been delivered by phishing emails containing links</p><p id="4bf7" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk"><a class="af nv" href="https://attack.mitre.org/versions/v7/techniques/T1204/001/" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">T1204</strong></a><strong class="mz gv">:001 </strong><a class="af nv" href="https://attack.mitre.org/techniques/T1204/001/" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">User Execution: Malicious Link</strong></a></p><p id="0126" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Emotet has relied upon users clicking on a malicious link delivered through spearphishing.</p><p id="fab6" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">The following MITRE ATT&amp;CK Tactic was also observed:</p><p id="503d" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk"><a class="af nv" href="https://attack.mitre.org/tactics/TA0011/" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">TA0011</strong></a><strong class="mz gv">:001 </strong><a class="af nv" href="https://attack.mitre.org/techniques/T1071/001/" rel="noopener ugc nofollow" target="_blank"><strong class="mz gv">Command and Control: Web Protocols</strong></a></p><p id="394e" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.</p><h1 id="c8ce" class="oa ob gu bf oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bk">Conclusion</h1><p id="5076" class="pw-post-body-paragraph mx my gu mz b na oy nc nd ne oz ng nh ni pa nk nl nm pb no np nq pc ns nt nu gn bk">We hope you enjoyed our little Emotet safari. There’s also a video version of this article, you can find it under <a class="af nv" href="https://www.youtube.com/watch?v=CW1rNrd7KYU" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=CW1rNrd7KYU</a>.</p><p id="308f" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Also, don’t forget to check out our last two articles, <a class="af nv" rel="noopener" href="/brim-securitys-knowledge-funnel/five-elegant-brim-queries-to-threat-hunt-in-zeek-logs-and-packet-captures-30eec4c09933">Five Elegant Brim Queries to Threat Hunt in Zeek Logs and Packet Captures</a> and <a class="af nv" rel="noopener" href="/brim-securitys-knowledge-funnel/investigating-network-traffic-activity-using-brim-and-zeek-97efdf725f8e">Investigating Network traffic activity using Brim and Zeek</a>. And watch this space, there’s more coming soon!</p><p id="1f0d" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">In the meantime, if you haven’t checked out Brim yet, go ahead. It’s free and it’s Open Source.</p><p id="6e45" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk"><a class="af nv" href="https://www.brimsecurity.com/" rel="noopener ugc nofollow" target="_blank">https://www.brimsecurity.com/</a></p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qv qw ab ja"><div class="qx ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/emotet?source=post_page-----1000c2f5c1ff--------------------------------"><div class="qz fj cx ra ge rb rc bf b bg z bk rd">Emotet</div></a></div><div class="qx ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/threat-hunting?source=post_page-----1000c2f5c1ff--------------------------------"><div class="qz fj cx ra ge rb rc bf b bg z bk rd">Threat Hunting</div></a></div><div class="qx ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/open-source-security?source=post_page-----1000c2f5c1ff--------------------------------"><div class="qz fj cx ra ge rb rc bf b bg z bk rd">Open Source Security</div></a></div><div class="qx ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/malware?source=post_page-----1000c2f5c1ff--------------------------------"><div class="qz fj cx ra ge rb rc bf b bg z bk rd">Malware</div></a></div><div class="qx ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/zeek?source=post_page-----1000c2f5c1ff--------------------------------"><div class="qz fj cx ra ge rb rc bf b bg z bk rd">Zeek</div></a></div></div></div></div><div class="l"></div><footer class="re rf rg rh ri ab q rj ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rk"><div class="ab q kv"><div class="rl l"><span class="l rm rn ro e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fbrim-securitys-knowledge-funnel%2F1000c2f5c1ff&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;user=Oliver+Rochford&amp;userId=2b62ed97c539&amp;source=---footer_actions--1000c2f5c1ff---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f rp rq"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fbrim-securitys-knowledge-funnel%2F1000c2f5c1ff&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;user=Oliver+Rochford&amp;userId=2b62ed97c539&amp;source=---footer_actions--1000c2f5c1ff---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la ls lt ab q fk lu lv" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z du"><span class="pw-responses-count lq lr">2</span></p></button></div></div></div></div><div class="ab q"><div class="rr l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1000c2f5c1ff&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fbrim-securitys-knowledge-funnel%2Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff&amp;source=---footer_actions--1000c2f5c1ff---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lx" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="rr l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rs rt ru rv rw l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rx bh r ry"></div><div class="rz l"><div class="ab sa sb sc iz iy"><div class="sd se sf sg sh si sj sk sl sm ab cp"><div class="h k"><a href="https://medium.com/brim-securitys-knowledge-funnel?source=post_page---post_publication_info--1000c2f5c1ff--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Brim Security" class="sn ib ic cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*UpGFft4ro1MPusfAK6gl2A.png" width="48" height="48" loading="lazy"/><div class="sn l ic ib fs n fr so"></div></div></a></div><div class="j i d"><a href="https://medium.com/brim-securitys-knowledge-funnel?source=post_page---post_publication_info--1000c2f5c1ff--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Brim Security" class="sn sq sp cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*UpGFft4ro1MPusfAK6gl2A.png" width="64" height="64" loading="lazy"/><div class="sn l sp sq fs n fr so"></div></div></a></div><div class="j i d sr ix"><div class="ab"></div></div></div><div class="ab co ss"><div class="st su sv sw sx l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/brim-securitys-knowledge-funnel?source=post_page---post_publication_info--1000c2f5c1ff--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf sz ta tb tc td te tf ni tg th nm ti tj nq tk tl bk"><span class="gn sy">Published in <!-- -->Brim Security</span></h2></a><div class="qx ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/brim-securitys-knowledge-funnel/followers?source=post_page---post_publication_info--1000c2f5c1ff--------------------------------">132 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/brim-securitys-knowledge-funnel/visualizing-network-cyber-attacks-with-suricata-and-zeek-using-brim-and-networkx-332dd265d4b6?source=post_page---post_publication_info--1000c2f5c1ff--------------------------------">Last published <span>Feb 24, 2021</span></a></div></div><div class="tm l"><p class="bf b bg z bk"><span class="gn">Learn about Brim through hands-on threat hunting and security data science</span></p></div></div></div><div class="h k"><div class="ab"></div></div></div></div><div class="ab sa sb sc iz iy"><div class="sd se sf sg sh si sj sk sl sm ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@oliver-77164?source=post_page---post_author_info--1000c2f5c1ff--------------------------------"><div class="l fj"><img alt="Oliver Rochford" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*gKZqXtatbhNKvonPm_9J1w.png" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay so"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@oliver-77164?source=post_page---post_author_info--1000c2f5c1ff--------------------------------"><div class="l fj"><img alt="Oliver Rochford" class="l fd by sp sq cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*gKZqXtatbhNKvonPm_9J1w.png" width="64" height="64" loading="lazy"/><div class="fr by l sp sq fs n ay so"></div></div></a></div><div class="j i d sr ix"><div class="ab"><span><button class="bf b bg z tn qz to tp tq tr ts ev ew tt tu tv fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co ss"><div class="st su sv sw sx l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@oliver-77164?source=post_page---post_author_info--1000c2f5c1ff--------------------------------"><h2 class="pw-author-name bf sz ta tb tc td te tf ni tg th nm ti tj nq tk tl bk"><span class="gn sy">Written by <!-- -->Oliver Rochford</span></h2></a><div class="qx ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@oliver-77164/followers?source=post_page---post_author_info--1000c2f5c1ff--------------------------------">113 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@oliver-77164/following?source=post_page---post_author_info--1000c2f5c1ff--------------------------------">8 Following</a></div></div><div class="tm l"><p class="bf b bg z bk"><span class="gn">Oliver is a Security Subject Matter Expert at Brim Security</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z tn qz to tp tq tr ts ev ew tt tu tv fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tw tx ty tz ua l"><div class="rx bh r tw tx ub uc ud"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf sz od of og oh oj ok ol on oo op or os ot ov ow bk">Responses (<!-- -->2<!-- -->)</h2><div class="ab ue"><div><div class="bm" aria-hidden="false"><a class="uf ug" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--1000c2f5c1ff--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="uh ui uj uk ul um un l"></div><div class="uo l"><button class="bf b bg z bk qz up uq ur lx lu ts ev ew ex us ut uu fa uv uw ux uy uz fb fc fd bm fe ff">See all responses</button></div></div></div></div><div class="va vb vc vd ve l bx"><div class="h k j"><div class="rx bh vf vg"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="vh ab kv ja"><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----1000c2f5c1ff--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----1000c2f5c1ff--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----1000c2f5c1ff--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vi l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----1000c2f5c1ff--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-1000c2f5c1ff","user-2b62ed97c539","collection-75708f7ea725"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"edd4b72d-a761-4c49-9fe4-a2bc092b3f72","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-587f856bc4c8f3be891d2d543b6f545a-21bec2d8b210de59-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","collectionByDomainOrSlug({\"domainOrSlug\":\"brim-securitys-knowledge-funnel\"})":{"__ref":"Collection:75708f7ea725"},"viewer":null,"postResult({\"id\":\"1000c2f5c1ff\"})":{"__ref":"Post:1000c2f5c1ff"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:75708f7ea725":{"__typename":"Collection","id":"75708f7ea725","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"domain":null,"slug":"brim-securitys-knowledge-funnel","googleAnalyticsId":null,"name":"Brim Security","subscriberCount":132,"description":"Learn about Brim through hands-on threat hunting and security data science","avatar":{"__ref":"ImageMetadata:1*UpGFft4ro1MPusfAK6gl2A.png"},"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:332dd265d4b6"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:75708f7ea725-viewerId:lo_527e8f182224"},"twitterUsername":"Brimsecurity","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*UpGFft4ro1MPusfAK6gl2A.png"}},"ImageMetadata:1*UpGFft4ro1MPusfAK6gl2A.png":{"__typename":"ImageMetadata","id":"1*UpGFft4ro1MPusfAK6gl2A.png","originalWidth":224,"originalHeight":228},"User:2b62ed97c539":{"__typename":"User","id":"2b62ed97c539","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"oliver-77164.medium.com"}},"hasSubdomain":true,"username":"oliver-77164","linkedAccounts":{"__ref":"LinkedAccounts:2b62ed97c539"},"isSuspended":false,"name":"Oliver Rochford","imageId":"1*gKZqXtatbhNKvonPm_9J1w.png","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":113,"followingCount":3,"collectionFollowingCount":5},"bio":"Oliver is a Security Subject Matter Expert at Brim Security","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:2b62ed97c539-viewerId:lo_527e8f182224"},"twitterScreenName":""},"Post:332dd265d4b6":{"__typename":"Post","id":"332dd265d4b6","firstPublishedAt":1614167542834,"creator":{"__ref":"User:2b62ed97c539"},"collection":{"__ref":"Collection:75708f7ea725"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Fvisualizing-network-cyber-attacks-with-suricata-and-zeek-using-brim-and-networkx-332dd265d4b6","sequence":null,"uniqueSlug":"visualizing-network-cyber-attacks-with-suricata-and-zeek-using-brim-and-networkx-332dd265d4b6"},"LinkedAccounts:2b62ed97c539":{"__typename":"LinkedAccounts","mastodon":null,"id":"2b62ed97c539"},"Paragraph:55c528c3b2da_0":{"__typename":"Paragraph","id":"55c528c3b2da_0","name":"f50d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Hunting Emotet with Brim and Zeek","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_1":{"__typename":"Paragraph","id":"55c528c3b2da_1","name":"c8a8","type":"P","href":null,"layout":null,"metadata":null,"text":"The US Cybersecurity and Infrastructure Security Agency recently released an advisory warning of a resurgence of the Emotet malware.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":77,"end":85,"href":"https:\u002F\u002Fus-cert.cisa.gov\u002Fncas\u002Falerts\u002Faa20-280a","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":117,"end":123,"href":"https:\u002F\u002Fwww.malwarebytes.com\u002Femotet\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_2":{"__typename":"Paragraph","id":"55c528c3b2da_2","name":"cbce","type":"P","href":null,"layout":null,"metadata":null,"text":"Emotet started out in 2014 as a Banking Trojan, but has since evolved into a sophisticated malware, offered on the Darknet as a commercial Cybercrime-as-a-Service platform.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":22,"end":46,"href":"https:\u002F\u002Fwww.zdnet.com\u002Farticle\u002Fmeet-the-white-hat-group-fighting-emotet-the-worlds-most-dangerous-malware\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_3":{"__typename":"Paragraph","id":"55c528c3b2da_3","name":"276e","type":"P","href":null,"layout":null,"metadata":null,"text":"Victims that are infected with Emotet are usually targeted with a phishing email containing a macro-enabled malicious document, or a link to one hosted on a compromised website. The malware frequently acts as a “dropper” and downloads additional components and payloads. Emotet has worming capabilities and may attempt to enumerate and infect further victims on accessible networks. Command and Control (C2) is executed via HTTP POST requests on ports 80, 443 and 8080 to randomized alphanumerical named directories on compromised C2 servers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":212,"end":219,"href":"https:\u002F\u002Fblog.malwarebytes.com\u002Fdetections\u002Ftrojan-dropper\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":282,"end":289,"href":"https:\u002F\u002Fblog.malwarebytes.com\u002Fdetections\u002Fworm\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_4":{"__typename":"Paragraph","id":"55c528c3b2da_4","name":"caf2","type":"P","href":null,"layout":null,"metadata":null,"text":"What makes Emotet really dangerous is that it is sold as an operational platform to a variety of different threat actors with diverse motivations. Further, the malware can deploy different payloads depending on the objective — from stealing banking credentials to ransomware. It is essentially infrastructure-as-a-service for hacking. In practise this means that it constantly evolves and can come in many guises.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_5":{"__typename":"Paragraph","id":"55c528c3b2da_5","name":"d4dc","type":"P","href":null,"layout":null,"metadata":null,"text":"With Emotet on the rise again, blue team and incident response teams should familiarise themselves with how this dangerous threat behaves and evaluate how best to detect and hunt it. Luckily, there are samples available. In this article, we are specifically working with the following sample from the good people at Malware Traffic Analysis:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":316,"end":340,"href":"https:\u002F\u002Fwww.malware-traffic-analysis.net\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_6":{"__typename":"Paragraph","id":"55c528c3b2da_6","name":"6a42","type":"P","href":null,"layout":null,"metadata":null,"text":"2020–09–01-Emotet-epoch-3-infection-with-Trickbot-gtag-mor119.pcap.zip","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":70,"href":"https:\u002F\u002Fwww.malware-traffic-analysis.net\u002F2020\u002F09\u002F02\u002F2020-09-01-Emotet-epoch-3-infection-with-Trickbot-gtag-mor119.pcap.zip","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_7":{"__typename":"Paragraph","id":"55c528c3b2da_7","name":"a5af","type":"P","href":null,"layout":null,"metadata":null,"text":"We’ll also be using the Brim Desktop client. Let’s go hunt!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":24,"end":36,"href":"https:\u002F\u002Fgithub.com\u002Fbrimsec\u002Fbrim","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_8":{"__typename":"Paragraph","id":"55c528c3b2da_8","name":"09ac","type":"BQ","href":null,"layout":null,"metadata":null,"text":"TIP! You can find detailed installation instructions for Brim on Windows, Linux and macOS under https:\u002F\u002Fgithub.com\u002Fbrimsec\u002Fbrim\u002Fwiki\u002FInstallation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":96,"end":145,"href":"https:\u002F\u002Fgithub.com\u002Fbrimsec\u002Fbrim\u002Fwiki\u002FInstallation","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_9":{"__typename":"Paragraph","id":"55c528c3b2da_9","name":"9a3e","type":"H3","href":null,"layout":null,"metadata":null,"text":"Finding Patient X","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_10":{"__typename":"Paragraph","id":"55c528c3b2da_10","name":"2d68","type":"P","href":null,"layout":null,"metadata":null,"text":"As we discussed in the first article, a good first step when investigating malware is to investigate the DNS activity, specifically for which domains there are resolution requests. Zeek provides a DNS protocol analyzer specifically for this purpose.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":29,"end":36,"href":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Ffive-elegant-brim-queries-to-threat-hunt-in-zeek-logs-and-packet-captures-30eec4c09933","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*TAbpSPSFIlaqWjc-":{"__typename":"ImageMetadata","id":"0*TAbpSPSFIlaqWjc-","originalHeight":400,"originalWidth":1555,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_11":{"__typename":"Paragraph","id":"55c528c3b2da_11","name":"a384","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*TAbpSPSFIlaqWjc-"},"text":"Zeek’s DNS stream in Brim","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_12":{"__typename":"Paragraph","id":"55c528c3b2da_12","name":"714d","type":"P","href":null,"layout":null,"metadata":null,"text":"To gain an overview of what’s going on, we’ll use a ZQL query to stack the queries by count","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_13":{"__typename":"Paragraph","id":"55c528c3b2da_13","name":"6714","type":"PRE","href":null,"layout":null,"metadata":null,"text":"_path=dns | count() by query | sort -r","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*x_VxZUBzYVGAUwFj":{"__typename":"ImageMetadata","id":"0*x_VxZUBzYVGAUwFj","originalHeight":721,"originalWidth":645,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_14":{"__typename":"Paragraph","id":"55c528c3b2da_14","name":"6131","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*x_VxZUBzYVGAUwFj"},"text":"Count of unique DNS queries","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_15":{"__typename":"Paragraph","id":"55c528c3b2da_15","name":"ac3f","type":"P","href":null,"layout":null,"metadata":null,"text":"We see a number of different windows network requests, for example for “WORKGROUP”, some legitimate “Microsoft.com” requests, and single requests to threat-intelligence related addresses such as for Spamhaus. We can right-click on any domain we do not recognize and verify them using VirusTotal.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":284,"end":294,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":72,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":101,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":199,"end":207,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*k0Aaxyf3PmRDHyQC":{"__typename":"ImageMetadata","id":"0*k0Aaxyf3PmRDHyQC","originalHeight":733,"originalWidth":656,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_16":{"__typename":"Paragraph","id":"55c528c3b2da_16","name":"19fb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*k0Aaxyf3PmRDHyQC"},"text":"Right-click on any domain to validate it using VirusTotal","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_17":{"__typename":"Paragraph","id":"55c528c3b2da_17","name":"004a","type":"P","href":null,"layout":null,"metadata":null,"text":"VirusTotal flags one of the domains, “ t-privat.de”, as malicious, and known to have hosted malware in the past. We now have a trail to follow.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":39,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*4ltBY_PJPLtNw2TX":{"__typename":"ImageMetadata","id":"0*4ltBY_PJPLtNw2TX","originalHeight":683,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_18":{"__typename":"Paragraph","id":"55c528c3b2da_18","name":"b012","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*4ltBY_PJPLtNw2TX"},"text":"VirusTotal shows the suspicious URI as malicious","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*0BszizHl3mM3_mTF":{"__typename":"ImageMetadata","id":"0*0BszizHl3mM3_mTF","originalHeight":459,"originalWidth":818,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_19":{"__typename":"Paragraph","id":"55c528c3b2da_19","name":"c302","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*0BszizHl3mM3_mTF"},"text":"Details for the malicious Domain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_20":{"__typename":"Paragraph","id":"55c528c3b2da_20","name":"d1e1","type":"P","href":null,"layout":null,"metadata":null,"text":"A nice little blind check at this point is to verify if the relevant Host A Record IP address “81.169.145.161” is present anywhere else in our dataset.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":95,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*q3BwfxHy9CF_Isi8":{"__typename":"ImageMetadata","id":"0*q3BwfxHy9CF_Isi8","originalHeight":461,"originalWidth":1545,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_21":{"__typename":"Paragraph","id":"55c528c3b2da_21","name":"b2fc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*q3BwfxHy9CF_Isi8"},"text":"Hit! The IP address related to the VirusTotal alert matches our data","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_22":{"__typename":"Paragraph","id":"55c528c3b2da_22","name":"4b1c","type":"P","href":null,"layout":null,"metadata":null,"text":"The search returns positive — we are looking at the same threat that was submitted to VirusTotal. Note the file transfer via HTTP to an internal host. That’s something we want to investigate further.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_23":{"__typename":"Paragraph","id":"55c528c3b2da_23","name":"0a0c","type":"P","href":null,"layout":null,"metadata":null,"text":"We’ll revisit one of our Power Queries to show all of the relevant file activity within our data that has a complete filename, but extend it to provide us with a tailored view showing us only the fields that are relevant to us at this juncture:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":25,"end":38,"href":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Ffive-elegant-brim-queries-to-threat-hunt-in-zeek-logs-and-packet-captures-30eec4c09933","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_24":{"__typename":"Paragraph","id":"55c528c3b2da_24","name":"df8c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"filename!=null | cut _path, tx_hosts, rx_hosts, conn_uids, mime_type, filename, md5, sha1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*r_lBSVdaanQ-C4po":{"__typename":"ImageMetadata","id":"0*r_lBSVdaanQ-C4po","originalHeight":306,"originalWidth":1562,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_25":{"__typename":"Paragraph","id":"55c528c3b2da_25","name":"6ab5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*r_lBSVdaanQ-C4po"},"text":"Curated File Activity view — the Plot thickens","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_26":{"__typename":"Paragraph","id":"55c528c3b2da_26","name":"f3cc","type":"P","href":null,"layout":null,"metadata":null,"text":"There are a number of strange looking HTTP connections with filenames lacking any type of extension or MIME type. We also find the full filename, “UR608.exe”, from our malicious internet host “81.169.145.161” (t-privat.de). Thanks to Zeek’s MD5 and SHA1 processors, we can harness VirusTotal again. Our Patient X is “10.9.1.101”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":193,"end":207,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":210,"end":221,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":317,"end":327,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*MSsKmBqvNbMxuIOb":{"__typename":"ImageMetadata","id":"0*MSsKmBqvNbMxuIOb","originalHeight":602,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_27":{"__typename":"Paragraph","id":"55c528c3b2da_27","name":"cc22","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*MSsKmBqvNbMxuIOb"},"text":"Emotet sighted! VirusTotal confirms the file is associated with known malware.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_28":{"__typename":"Paragraph","id":"55c528c3b2da_28","name":"8394","type":"H3","href":null,"layout":null,"metadata":null,"text":"Identifying Command and Control","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_29":{"__typename":"Paragraph","id":"55c528c3b2da_29","name":"ea33","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we’ve verified the initial point of access for the attack, we can follow how the attack unfolded. When we reviewed the files contained in our data, we saw three other connections originating from the infected system. If we double-click on any of the records in question, we conjure up a detailed view showing a waterfall that includes all app transactions and file payloads throughout the life of a flow:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*4KUWvqsHhWzoCQW4":{"__typename":"ImageMetadata","id":"0*4KUWvqsHhWzoCQW4","originalHeight":559,"originalWidth":996,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_30":{"__typename":"Paragraph","id":"55c528c3b2da_30","name":"59c8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*4KUWvqsHhWzoCQW4"},"text":"Connection Diagram for the suspicious HTTP requests from our Patient X","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_31":{"__typename":"Paragraph","id":"55c528c3b2da_31","name":"8e8e","type":"P","href":null,"layout":null,"metadata":null,"text":"We can see a connection over a three minute time period. If you’re familiar with Zeek, the “dpd” and “weird” events immediately stick out. Let’s look into these. You can pivot right into the relevant details by clicking on any entry in the Connection Diagram. Zeek’s “Dynamic Protocol Detection” (dpd) stream processor detects network protocol anomalies. The “weird” processor on the other hand alerts on unusual activity such as malformed requests.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":268,"end":294,"href":"https:\u002F\u002Fold.zeek.org\u002Fdevelopment\u002Fhowtos\u002Fdpd.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":360,"end":365,"href":"https:\u002F\u002Fzeek.org\u002F2019\u002F11\u002F13\u002Fwhat-is-weird-in-zeek\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*YgzGQ-PrqiSgxSzw":{"__typename":"ImageMetadata","id":"0*YgzGQ-PrqiSgxSzw","originalHeight":436,"originalWidth":634,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_32":{"__typename":"Paragraph","id":"55c528c3b2da_32","name":"5db7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*YgzGQ-PrqiSgxSzw"},"text":"Brim’s detailed view for Zeek’s “dpd” stream","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*YzvswDb621aQ0IHW":{"__typename":"ImageMetadata","id":"0*YzvswDb621aQ0IHW","originalHeight":453,"originalWidth":571,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_33":{"__typename":"Paragraph","id":"55c528c3b2da_33","name":"3ff3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*YzvswDb621aQ0IHW"},"text":"Brim’s detailed view for Zeek’s “weird” stream","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*lQMp7EtyNDODnRHH":{"__typename":"ImageMetadata","id":"0*lQMp7EtyNDODnRHH","originalHeight":462,"originalWidth":678,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_34":{"__typename":"Paragraph","id":"55c528c3b2da_34","name":"52aa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*lQMp7EtyNDODnRHH"},"text":"Brim’s detailed view for Zeek’s “weird” stream","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_35":{"__typename":"Paragraph","id":"55c528c3b2da_35","name":"129c","type":"P","href":null,"layout":null,"metadata":null,"text":"Zeek has detected that the connection in question does not appear to be standard HTTP. Of note is also the non-standard destination port “8080” under “id.resp_p”, commonly used for HTTP Proxying . We’d usually expect to see port 443 for web traffic, or port 80 in rare legacy cases. Attackers will frequently attempt C2 via ports that have a high probability of being permitted through any network access controls such as a firewall. VirusTotal also confirms that the IP address “118.110.236.121” is malicious. Lastly, when we look at the Log Detail for the initial HTTP requests, we see it’s an HTTP POST request. The random character URI also seems suspicious:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":480,"end":495,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":596,"end":605,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*M6fJ-CZ6M0QCnz6U":{"__typename":"ImageMetadata","id":"0*M6fJ-CZ6M0QCnz6U","originalHeight":900,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_36":{"__typename":"Paragraph","id":"55c528c3b2da_36","name":"8feb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*M6fJ-CZ6M0QCnz6U"},"text":"HTTP POST request to URI including randomized alphanumeric directory name","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_37":{"__typename":"Paragraph","id":"55c528c3b2da_37","name":"e948","type":"P","href":null,"layout":null,"metadata":null,"text":"A safe hunch would be that this is the command and control (C2) traffic we’re seeing here. When we filter for our suspected C2 Server “118.110.236.121” with the HTTP POST method in the Zeek HTTP Stream, we can see the beaconing:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":135,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":161,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*aVvbBYkcXKMhlbWI":{"__typename":"ImageMetadata","id":"0*aVvbBYkcXKMhlbWI","originalHeight":454,"originalWidth":1481,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_38":{"__typename":"Paragraph","id":"55c528c3b2da_38","name":"4532","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*aVvbBYkcXKMhlbWI"},"text":"Emotet C2 Traffic","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_39":{"__typename":"Paragraph","id":"55c528c3b2da_39","name":"2def","type":"H3","href":null,"layout":null,"metadata":null,"text":"Enumerating Command and Control","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_40":{"__typename":"Paragraph","id":"55c528c3b2da_40","name":"14a1","type":"BQ","href":null,"layout":null,"metadata":null,"text":"TIP! To evade detection and provide redundancy against C2 servers being blocked by inclusion on threat intelligence sources, Malware operators use a network of compromised systems for their command and control infrastructure. The list of C2 servers are constantly updated to try and always stay one step ahead of threat researchers. If you’re interested in further details about how Malware C2 works, see this article: https:\u002F\u002Fsearchsecurity.techtarget.com\u002Ffeature\u002FCommand-and-control-servers-The-puppet-masters-that-govern-malware","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":419,"end":531,"href":"https:\u002F\u002Fsearchsecurity.techtarget.com\u002Ffeature\u002FCommand-and-control-servers-The-puppet-masters-that-govern-malware","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_41":{"__typename":"Paragraph","id":"55c528c3b2da_41","name":"174a","type":"P","href":null,"layout":null,"metadata":null,"text":"It would be unusual for Emotet to rely on a single C2 instance. One way we can quickly validate this is to search for any additional HTTP POST requests Victim X may be sending:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":133,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_42":{"__typename":"Paragraph","id":"55c528c3b2da_42","name":"8e62","type":"PRE","href":null,"layout":null,"metadata":null,"text":"id.orig_h=10.9.1.101 method=POST | cut ts, uid, id, method, uri, status_code","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ah73tiHyU3lnC7NL":{"__typename":"ImageMetadata","id":"0*ah73tiHyU3lnC7NL","originalHeight":480,"originalWidth":1531,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_43":{"__typename":"Paragraph","id":"55c528c3b2da_43","name":"dbca","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*ah73tiHyU3lnC7NL"},"text":"HTTP POST activity from Patient X","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_44":{"__typename":"Paragraph","id":"55c528c3b2da_44","name":"72f6","type":"P","href":null,"layout":null,"metadata":null,"text":"Victim X is concerningly making a number of other successful suspicious HTTP POST requests. VirusTotal confirms that all of the involved destination IP addresses are malicious.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":72,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*AiGFwTvcqJjSbDa_":{"__typename":"ImageMetadata","id":"0*AiGFwTvcqJjSbDa_","originalHeight":650,"originalWidth":1492,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_45":{"__typename":"Paragraph","id":"55c528c3b2da_45","name":"f3ca","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*AiGFwTvcqJjSbDa_"},"text":"VirusTotal confirms our suspicious IP address is malicious","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_46":{"__typename":"Paragraph","id":"55c528c3b2da_46","name":"1c82","type":"P","href":null,"layout":null,"metadata":null,"text":"A further search for the malicious IP addresses in our data yields no further results, but of course we can now take our list (45.230.228.26, 118.110.236.121, 195.123.242.119) and conduct further searches across other detection and search tools, for example a SIEM, as well as adding them to our access control deny list.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":127,"end":140,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":142,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":159,"end":174,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_47":{"__typename":"Paragraph","id":"55c528c3b2da_47","name":"4026","type":"H3","href":null,"layout":null,"metadata":null,"text":"Evaluating the spread of Infection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_48":{"__typename":"Paragraph","id":"55c528c3b2da_48","name":"4538","type":"P","href":null,"layout":null,"metadata":null,"text":"As Emotet is known to propagate via the network, we should also establish whether any other hosts have been infected.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_49":{"__typename":"Paragraph","id":"55c528c3b2da_49","name":"8fd0","type":"P","href":null,"layout":null,"metadata":null,"text":"First let’s see what sort of traffic our data contains. We can lean on Zeek’s streams here again, and generate a list of any contained in the packet capture with associated counts:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_50":{"__typename":"Paragraph","id":"55c528c3b2da_50","name":"70c5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"_path | count() by _path | sort -r","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*aAy8J-aeuUVZJdxr":{"__typename":"ImageMetadata","id":"0*aAy8J-aeuUVZJdxr","originalHeight":625,"originalWidth":718,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_51":{"__typename":"Paragraph","id":"55c528c3b2da_51","name":"f29e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*aAy8J-aeuUVZJdxr"},"text":"Zeek Streams by count","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_52":{"__typename":"Paragraph","id":"55c528c3b2da_52","name":"2e4f","type":"P","href":null,"layout":null,"metadata":null,"text":"Interestingly enough, we don’t see any activity that would indicate internal reconnaissance or propagation. If present, we’d typically expect to see something like Windows SMB and DCE\u002FRPC activity here. This does not necessarily mean that no further infection occurred — just that we don’t have any indicators in our data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_53":{"__typename":"Paragraph","id":"55c528c3b2da_53","name":"b492","type":"P","href":null,"layout":null,"metadata":null,"text":"Lastly, just to be sure, we’ll enumerate any connections our patient X may have attempted on the internal network. For this, we’re going to use ZQL’s rich data typing, specifically that there is an IP address data type that supports CIDR filtering:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":150,"end":166,"href":"https:\u002F\u002Fgithub.com\u002Fbrimsec\u002Fzq\u002Fblob\u002Fmaster\u002Fzql\u002Fdocs\u002Fdata-types\u002FREADME.md","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_54":{"__typename":"Paragraph","id":"55c528c3b2da_54","name":"9ff6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"id.orig_h=10.9.1.101 id.resp_h=~10.0.0.0\u002F8 | count() by id.resp_h,_path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*cGIu-tYTPqeg9tYq":{"__typename":"ImageMetadata","id":"0*cGIu-tYTPqeg9tYq","originalHeight":370,"originalWidth":947,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_55":{"__typename":"Paragraph","id":"55c528c3b2da_55","name":"952a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*cGIu-tYTPqeg9tYq"},"text":"All connections in the 10.0.0.0\u002F8 subnet that patient X communicated with","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_56":{"__typename":"Paragraph","id":"55c528c3b2da_56","name":"7743","type":"P","href":null,"layout":null,"metadata":null,"text":"We see there is some DNS traffic to two other hosts, which we may assume are DNS servers. Nothing in the data indicates further infections.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_57":{"__typename":"Paragraph","id":"55c528c3b2da_57","name":"785a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Putting it all together","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_58":{"__typename":"Paragraph","id":"55c528c3b2da_58","name":"8a95","type":"P","href":null,"layout":null,"metadata":null,"text":"While we didn’t see any propagation events, we did successfully pinpoint the initial infection, identified Patient X and enumerated the C2 servers. This will allow us to conduct further threat hunting, develop detections and create signatures and watch lists for blocking the threat on the network. The diagram below outlines the activity we’ve been investigating:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_59":{"__typename":"Paragraph","id":"55c528c3b2da_59","name":"e426","type":"H3","href":null,"layout":null,"metadata":null,"text":"Emotet Sample observed activity","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*2uauAZMOZGBUxfk7":{"__typename":"ImageMetadata","id":"0*2uauAZMOZGBUxfk7","originalHeight":450,"originalWidth":800,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_60":{"__typename":"Paragraph","id":"55c528c3b2da_60","name":"335a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*2uauAZMOZGBUxfk7"},"text":"Emotet Incident outline","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_61":{"__typename":"Paragraph","id":"55c528c3b2da_61","name":"498a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Observed Indicators of Compromise","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SwkHokqni8ufS9ogmbqgSw.png":{"__typename":"ImageMetadata","id":"1*SwkHokqni8ufS9ogmbqgSw.png","originalHeight":501,"originalWidth":954,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:55c528c3b2da_62":{"__typename":"Paragraph","id":"55c528c3b2da_62","name":"a62a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SwkHokqni8ufS9ogmbqgSw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_63":{"__typename":"Paragraph","id":"55c528c3b2da_63","name":"d793","type":"H3","href":null,"layout":null,"metadata":null,"text":"Observed MITRE ATT&CK Techniques","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_64":{"__typename":"Paragraph","id":"55c528c3b2da_64","name":"052d","type":"P","href":null,"layout":null,"metadata":null,"text":"We assume that the malicious file we observed being downloaded from “t-privat.de” was the tail end of an initial phishing attempt. That would entail the following MITRE ATT&CK Techniques:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_65":{"__typename":"Paragraph","id":"55c528c3b2da_65","name":"a89b","type":"P","href":null,"layout":null,"metadata":null,"text":"T1566:002 Phishing: Spearphishing Link","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":5,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1566","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":10,"end":18,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1566","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":20,"end":38,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1566\u002F002","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_66":{"__typename":"Paragraph","id":"55c528c3b2da_66","name":"6586","type":"P","href":null,"layout":null,"metadata":null,"text":"Emotet has been delivered by phishing emails containing links","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_67":{"__typename":"Paragraph","id":"55c528c3b2da_67","name":"4bf7","type":"P","href":null,"layout":null,"metadata":null,"text":"T1204:001 User Execution: Malicious Link","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":5,"href":"https:\u002F\u002Fattack.mitre.org\u002Fversions\u002Fv7\u002Ftechniques\u002FT1204\u002F001\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":10,"end":40,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1204\u002F001\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_68":{"__typename":"Paragraph","id":"55c528c3b2da_68","name":"0126","type":"P","href":null,"layout":null,"metadata":null,"text":"Emotet has relied upon users clicking on a malicious link delivered through spearphishing.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_69":{"__typename":"Paragraph","id":"55c528c3b2da_69","name":"fab6","type":"P","href":null,"layout":null,"metadata":null,"text":"The following MITRE ATT&CK Tactic was also observed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_70":{"__typename":"Paragraph","id":"55c528c3b2da_70","name":"503d","type":"P","href":null,"layout":null,"metadata":null,"text":"TA0011:001 Command and Control: Web Protocols","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":6,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftactics\u002FTA0011\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":11,"end":45,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1071\u002F001\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_71":{"__typename":"Paragraph","id":"55c528c3b2da_71","name":"394e","type":"P","href":null,"layout":null,"metadata":null,"text":"Adversaries may communicate using application layer protocols associated with web traffic to avoid detection\u002Fnetwork filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_72":{"__typename":"Paragraph","id":"55c528c3b2da_72","name":"c8ce","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_73":{"__typename":"Paragraph","id":"55c528c3b2da_73","name":"5076","type":"P","href":null,"layout":null,"metadata":null,"text":"We hope you enjoyed our little Emotet safari. There’s also a video version of this article, you can find it under https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=CW1rNrd7KYU.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":114,"end":157,"href":"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=CW1rNrd7KYU","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_74":{"__typename":"Paragraph","id":"55c528c3b2da_74","name":"308f","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, don’t forget to check out our last two articles, Five Elegant Brim Queries to Threat Hunt in Zeek Logs and Packet Captures and Investigating Network traffic activity using Brim and Zeek. And watch this space, there’s more coming soon!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":55,"end":128,"href":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Ffive-elegant-brim-queries-to-threat-hunt-in-zeek-logs-and-packet-captures-30eec4c09933","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":133,"end":191,"href":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Finvestigating-network-traffic-activity-using-brim-and-zeek-97efdf725f8e","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_75":{"__typename":"Paragraph","id":"55c528c3b2da_75","name":"1f0d","type":"P","href":null,"layout":null,"metadata":null,"text":"In the meantime, if you haven’t checked out Brim yet, go ahead. It’s free and it’s Open Source.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:55c528c3b2da_76":{"__typename":"Paragraph","id":"55c528c3b2da_76","name":"6e45","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.brimsecurity.com\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":29,"href":"https:\u002F\u002Fwww.brimsecurity.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:75708f7ea725-viewerId:lo_527e8f182224":{"__typename":"CollectionViewerEdge","id":"collectionId:75708f7ea725-viewerId:lo_527e8f182224","isEditor":false,"isMuting":false},"UserViewerEdge:userId:2b62ed97c539-viewerId:lo_527e8f182224":{"__typename":"UserViewerEdge","id":"userId:2b62ed97c539-viewerId:lo_527e8f182224","isMuting":false},"PostViewerEdge:postId:1000c2f5c1ff-viewerId:lo_527e8f182224":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:1000c2f5c1ff-viewerId:lo_527e8f182224"},"Tag:emotet":{"__typename":"Tag","id":"emotet","displayTitle":"Emotet","normalizedTagSlug":"emotet"},"Tag:threat-hunting":{"__typename":"Tag","id":"threat-hunting","displayTitle":"Threat Hunting","normalizedTagSlug":"threat-hunting"},"Tag:open-source-security":{"__typename":"Tag","id":"open-source-security","displayTitle":"Open Source Security","normalizedTagSlug":"open-source-security"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Tag:zeek":{"__typename":"Tag","id":"zeek","displayTitle":"Zeek","normalizedTagSlug":"zeek"},"Post:1000c2f5c1ff":{"__typename":"Post","id":"1000c2f5c1ff","collection":{"__ref":"Collection:75708f7ea725"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"7820","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:55c528c3b2da_0"},{"__ref":"Paragraph:55c528c3b2da_1"},{"__ref":"Paragraph:55c528c3b2da_2"},{"__ref":"Paragraph:55c528c3b2da_3"},{"__ref":"Paragraph:55c528c3b2da_4"},{"__ref":"Paragraph:55c528c3b2da_5"},{"__ref":"Paragraph:55c528c3b2da_6"},{"__ref":"Paragraph:55c528c3b2da_7"},{"__ref":"Paragraph:55c528c3b2da_8"},{"__ref":"Paragraph:55c528c3b2da_9"},{"__ref":"Paragraph:55c528c3b2da_10"},{"__ref":"Paragraph:55c528c3b2da_11"},{"__ref":"Paragraph:55c528c3b2da_12"},{"__ref":"Paragraph:55c528c3b2da_13"},{"__ref":"Paragraph:55c528c3b2da_14"},{"__ref":"Paragraph:55c528c3b2da_15"},{"__ref":"Paragraph:55c528c3b2da_16"},{"__ref":"Paragraph:55c528c3b2da_17"},{"__ref":"Paragraph:55c528c3b2da_18"},{"__ref":"Paragraph:55c528c3b2da_19"},{"__ref":"Paragraph:55c528c3b2da_20"},{"__ref":"Paragraph:55c528c3b2da_21"},{"__ref":"Paragraph:55c528c3b2da_22"},{"__ref":"Paragraph:55c528c3b2da_23"},{"__ref":"Paragraph:55c528c3b2da_24"},{"__ref":"Paragraph:55c528c3b2da_25"},{"__ref":"Paragraph:55c528c3b2da_26"},{"__ref":"Paragraph:55c528c3b2da_27"},{"__ref":"Paragraph:55c528c3b2da_28"},{"__ref":"Paragraph:55c528c3b2da_29"},{"__ref":"Paragraph:55c528c3b2da_30"},{"__ref":"Paragraph:55c528c3b2da_31"},{"__ref":"Paragraph:55c528c3b2da_32"},{"__ref":"Paragraph:55c528c3b2da_33"},{"__ref":"Paragraph:55c528c3b2da_34"},{"__ref":"Paragraph:55c528c3b2da_35"},{"__ref":"Paragraph:55c528c3b2da_36"},{"__ref":"Paragraph:55c528c3b2da_37"},{"__ref":"Paragraph:55c528c3b2da_38"},{"__ref":"Paragraph:55c528c3b2da_39"},{"__ref":"Paragraph:55c528c3b2da_40"},{"__ref":"Paragraph:55c528c3b2da_41"},{"__ref":"Paragraph:55c528c3b2da_42"},{"__ref":"Paragraph:55c528c3b2da_43"},{"__ref":"Paragraph:55c528c3b2da_44"},{"__ref":"Paragraph:55c528c3b2da_45"},{"__ref":"Paragraph:55c528c3b2da_46"},{"__ref":"Paragraph:55c528c3b2da_47"},{"__ref":"Paragraph:55c528c3b2da_48"},{"__ref":"Paragraph:55c528c3b2da_49"},{"__ref":"Paragraph:55c528c3b2da_50"},{"__ref":"Paragraph:55c528c3b2da_51"},{"__ref":"Paragraph:55c528c3b2da_52"},{"__ref":"Paragraph:55c528c3b2da_53"},{"__ref":"Paragraph:55c528c3b2da_54"},{"__ref":"Paragraph:55c528c3b2da_55"},{"__ref":"Paragraph:55c528c3b2da_56"},{"__ref":"Paragraph:55c528c3b2da_57"},{"__ref":"Paragraph:55c528c3b2da_58"},{"__ref":"Paragraph:55c528c3b2da_59"},{"__ref":"Paragraph:55c528c3b2da_60"},{"__ref":"Paragraph:55c528c3b2da_61"},{"__ref":"Paragraph:55c528c3b2da_62"},{"__ref":"Paragraph:55c528c3b2da_63"},{"__ref":"Paragraph:55c528c3b2da_64"},{"__ref":"Paragraph:55c528c3b2da_65"},{"__ref":"Paragraph:55c528c3b2da_66"},{"__ref":"Paragraph:55c528c3b2da_67"},{"__ref":"Paragraph:55c528c3b2da_68"},{"__ref":"Paragraph:55c528c3b2da_69"},{"__ref":"Paragraph:55c528c3b2da_70"},{"__ref":"Paragraph:55c528c3b2da_71"},{"__ref":"Paragraph:55c528c3b2da_72"},{"__ref":"Paragraph:55c528c3b2da_73"},{"__ref":"Paragraph:55c528c3b2da_74"},{"__ref":"Paragraph:55c528c3b2da_75"},{"__ref":"Paragraph:55c528c3b2da_76"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:2b62ed97c539"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fbrim-securitys-knowledge-funnel\u002Fhunting-emotet-with-brim-and-zeek-1000c2f5c1ff","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"55c528c3b2da","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":2},"clapCount":86,"allowResponses":true,"isLimitedState":false,"title":"Hunting Emotet with Brim and Zeek","isSeries":false,"sequence":null,"uniqueSlug":"hunting-emotet-with-brim-and-zeek-1000c2f5c1ff","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1607442559670,"readingTime":7.6443396226415095,"previewContent":{"__typename":"PreviewContent","subtitle":"The US Cybersecurity and Infrastructure Security Agency recently released an advisory warning of a resurgence of the Emotet malware."},"previewImage":{"__ref":"ImageMetadata:0*TAbpSPSFIlaqWjc-"},"isShortform":false,"seoTitle":"","firstPublishedAt":1604580644960,"updatedAt":1639653955503,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:1000c2f5c1ff-viewerId:lo_527e8f182224"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:emotet"},{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:open-source-security"},{"__ref":"Tag:malware"},{"__ref":"Tag:zeek"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1562,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3d28396db06d70',t:'MTczNDUwMzk4MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3d28396db06d70","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>