<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.7 (Yoast SEO v23.7) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory</title>
	<meta name="description" content="Using real-world examples and offering plenty of pragmatic tips, learn how to protect your directory services from LDAP-based attacks. Using real-world examples and offering plenty of pragmatic tips, learn how to protect your directory services from LDAP-based attacks." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory" />
	<meta property="og:description" content="Using real-world examples and offering plenty of pragmatic tips, learn how to protect your directory services from LDAP-based attacks. Using real-world examples and offering plenty of pragmatic tips, learn how to protect your directory services from LDAP-based attacks." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2024-12-17T23:00:43+00:00" />
	<meta property="article:modified_time" content="2024-12-17T17:46:09+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Stav Setty, Shachar Roitman, Tom Fakterman" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory Comments Feed" href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:lightweight-directory-access-protocol-based-attacks";
webData.pageURL = "https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks";
webData.article_title = "LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory";
webData.author = "Stav Setty,Shachar Roitman,Tom Fakterman";
webData.published_time = "2024-12-17T15:00:43-08:00";
webData.description = "%%excerpt%% Using real-world examples and offering plenty of pragmatic tips, learn how to protect your directory services from LDAP-based attacks.";
webData.keywords = "Cybercrime,Malware,Threat Actor Groups,Threat Research,Active Directory,AdFind,ALPHV,Ambitious Scorpius,Blackcat,BloodHound,Enumeration,IcedID,LDAP,Rubeus,SharpHound,Stately Taurus";
webData.resourceAssetID = "20ae5b84c045e199296acdccbeb38b57";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="4,704"/>
<meta property="og:date_created" content="December 17, 2024 at 3:00 PM"/>
<meta property="og:post_length" content="2566"/>
<meta property="og:category" content="Cybercrime"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Actor Groups"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cybercrime/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-actor-groups/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Stav Setty"/>
<meta property="og:author" content="Shachar Roitman"/>
<meta property="og:author" content="Tom Fakterman"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="Active Directory,AdFind,ALPHV,Ambitious Scorpius,Blackcat,BloodHound,Enumeration,IcedID,LDAP,Rubeus,SharpHound,Stately Taurus"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory","name":"LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory","description":"Using real-world examples and offering plenty of pragmatic tips, learn how to protect your directory services from LDAP-based attacks.","url":"https:\/\/unit42.paloaltonetworks.com\/lightweight-directory-access-protocol-based-attacks\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/lightweight-directory-access-protocol-based-attacks\/","datePublished":"December 17, 2024","articleBody":"Executive Summary\r\nThis article provides a practical guide to developing a detection strategy for Lightweight Directory Access Protocol (LDAP)-based attacks. We analyze real-world examples of nation-state and cybercriminal threat actors abusing LDAP attributes. We also examine common LDAP enumeration queries and assess their potential risks.\r\n\r\nLDAP is a powerful protocol for accessing and managing directory services like Active Directory. LDAP is commonly used by criminals for lateral movement and critical assets enumeration in on-premises cyberattacks. Threat actors also frequently use tools like BloodHound and SharpHound, which leverage LDAP for malicious purposes.\r\n\r\nDistinguishing benign from malicious LDAP activity within an organization is challenging. The high volume of benign event logs generated by a domain controller makes collecting as well as detecting malicious LDAP activity extremely difficult.\r\n\r\nPalo Alto Networks customers are better protected against LDAP-based attacks through Cortex XDR, XSIAM and Xpanse, which we detail further in the Conclusion.\r\n\r\nIf you think you might have been compromised or have an urgent matter, contact the Unit 42 Incident Response team.\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nCybercrime, Ransomware\r\n\r\n\r\n\r\nWhat Is LDAP?\r\nLDAP is a fundamental protocol used across nearly every Windows environment, enabling administrators to access directory services like Active Directory. This protocol is used for managing users and groups, as well as allowing applications to query directory data in the background. Although developed by Microsoft and primarily used in Windows environments, LDAP is vendor-agnostic and can be used on non-Windows systems like macOS and Linux.\r\n\r\nThreat actors often use LDAP because its functionality is so useful. Advanced persistent threat (APT) groups and other adversaries often use LDAP for network enumeration during the discovery phase of an attack. Attackers query directories to extract sensitive information such as user accounts, group memberships and permissions, which they then use to escalate privileges and target critical assets.\r\nThe Evolution of LDAP Protocols and Tools\r\nLDAP has evolved significantly since its introduction in the early 1990s, adapting to the changing needs of directory services and security challenges. Below are two examples of changes in the more recent versions of LDAP:\r\n\r\n \tLDAP over SSL (LDAPS): This secure version of LDAP encrypts data in transit, protecting sensitive information from interception during communication.\r\n \tActive Directory Web Services (ADWS): This provides a more RESTful approach to interacting with directory services. Notably, ADWS tools often operate under the radar of traditional monitoring systems, as they do not generate direct LDAP traffic.\r\n\r\nTools like BloodHound and its C# data collector, SharpHound, have evolved alongside these protocols to visualize and analyze Active Directory environments. SOAPHound builds on these advancements by using ADWS to enumerate Active Directory data.\r\nLDAP Logs: Visibility and Challenges\r\nThe high volume of log data generated by LDAP can overwhelm detection systems and make it difficult to identify malicious activity. It generates so much log data because it is used by many systems and applications.\r\n\r\nCommon processes like Outlook generate LDAP logs for example, highlighting the protocol\u2019s extensive role in directory services. This pervasive use means that malicious LDAP activity can get lost amid the noise of normal operations.\r\n\r\nTo manage LDAP log volume effectively, focus on filtering relevant data, such as:\r\n\r\n \tPrioritize filtering: Focus on logs based on the type of account or service generating them to reduce noise.\r\n \tExclude system-generated queries: Filter out queries that are unlikely to indicate user-initiated actions.\r\n\r\nTo address these challenges, Windows offers native logging of LDAP activity from the following sources:\r\n\r\n \tMicrosoft-Windows-LDAP-Client - Event ID 30: System administrators can enable debug logging for LDAP clients to track activity on the initiating host. This logs details such as the initiating process, search entry, filter and search scope when LDAP is accessed via the LDAP client API through wldap32.dll. Figure 1 shows an Event ID 30 entry from the debug logs of an LDAP client.\r\n\r\n[caption id=\"attachment_137903\" align=\"alignnone\" width=\"1000\"] Figure 1. Event ID 30 entry from LDAP-Client shown in Event Viewer on a Windows client.[\/caption]\r\n\r\n \tMicrosoft-Windows-ActiveDirectory_DomainService - Event ID 1644: This captures expensive, inefficient or slow LDAP queries made to domain controllers from all interacting hosts. Note that this Event ID is not enabled by default and requires updates to the Windows registry for activation. Figure 2 shows an Event ID 1644 entry seen in Event Viewer.\r\n\r\n[caption id=\"attachment_137905\" align=\"alignnone\" width=\"877\"] Figure 2. Event ID 1644 from ActiveDirectory_DomainService seen in Event Viewer on a Windows Server.[\/caption]\r\nReal-World Scenarios of LDAP Enumeration\r\nThis section provides real-world examples of attackers using LDAP enumeration tools against Active Directory environments.\r\nStately Taurus Linked to Use of AdFind in Attacks Against Southeast Asian Government\r\nAs part of a campaign targeting government entities in Southeast Asia from 2021 to 2023, Stately Taurus was linked to the use of AdFind during the reconnaissance stage of the attack.\r\n\r\nAdFind is a command-line query tool that can be used for LDAP enumeration by gathering information from an Active Directory domain controller. During the attack, threat actors renamed the tool from adfind.exe to a.logs in an attempt to evade detection.\r\n\r\nFigure 3 shows a screenshot from a Cortex XDR alert in which the threat actor attempted to save the results of an AdFind query to the following filenames:\r\n\r\n \tDomain_users_light.txt\r\n \tDomain_computers_light.txt\r\n \tDomain_groups_light.txt\r\n\r\n[caption id=\"attachment_137907\" align=\"alignnone\" width=\"1000\"] Figure 3. Screenshot from a Cortex XDR alert that prevented AdFind attempts to dump domain users\u2019 details.[\/caption]\r\nAmbitious Scorpius Wielded ADRecon in Ransomware Operations\r\nAffiliates of the BlackCat (ALPHV) ransomware group, which we track as Ambitious Scorpius, have used ADRecon in multiple intrusions. ADRecon is a PowerShell script that uses LDAP to gather information about an Active Directory environment and generates a report that provides a snapshot of the targeted network.\r\n\r\nDue to this group's continued use of ADRecon, we assess that the tool could be a part of the Ambitious Scorpius playbook. Figure 4 shows a Cortex XDR alert on the detection and prevention of ADRecon activity.\r\n\r\n&nbsp;\r\n\r\n[caption id=\"attachment_137909\" align=\"alignnone\" width=\"800\"] Figure 4. Screenshot from a Cortex XDR alert on the detection and prevention of ADRecon.[\/caption]\r\nSharpHound Used in an IcedID and Dagon Locker Ransomware Operation\r\nIn April 2024, The DFIR Report described an intrusion that involved IcedID malware and Dagon Locker ransomware. During this intrusion, the attackers used SharpHound to collect data about the Active Directory environment.\r\n\r\nSharpHound is a data collector component of BloodHound. It uses Windows API and LDAP functions to collect data from domain controllers and Windows systems that are part of the domain. Figure 5 shows the detection and prevention of SharpHound in Cortex XDR.\r\n\r\n[caption id=\"attachment_137911\" align=\"alignnone\" width=\"800\"] Figure 5. Screenshot from a Cortex XDR alert showing the detection and prevention of SharpHound.[\/caption]\r\nDetection Strategies for LDAP-Based Attacks\r\nDetecting LDAP-based attacks effectively involves monitoring LDAP logs for suspicious activity. Event logs capture crucial data, including:\r\n\r\n \tVisited entries: This represents the total number of LDAP queries made.\r\n \tReturned entries: This indicates the actual results returned from those queries or their count.\r\n\r\nLegitimate LDAP queries typically target specific objects or attributes, resulting in fewer visited and returned entries. On the other hand, enumeration attempts use broader queries as attackers seek to collect as much information as possible by querying all users, computers or groups.\r\n\r\nBelow are key detection strategies to help identify and mitigate LDAP enumeration attempts:\r\n\r\n1. Visited and returned entries\r\n\r\nReview logs for Event ID 1644 events for both visited and returned entries.\r\n\r\n \tLow \u201cvisited to returned\u201d ratio: This low ratio is typical of legitimate queries targeting a wide range of objects.\r\n \tHigh sum of returned entries: This indicates an attempt to gather large amounts of directory data. This is a possible indicator of enumeration by an attacker.\r\n\r\n2. User context\r\n\r\nAnalyzing LDAP queries for user context can also reveal enumeration activity:\r\n\r\n \tUser title or role: Consider whether the LDAP activity fits the user\u2019s typical role. For example, service accounts and IT personnel might legitimately perform extensive LDAP queries. However, if a user outside these roles engages in a similar activity, this could indicate potential enumeration.\r\n \tSearch scope anomalies: Users who suddenly expand their search scope beyond typical patterns could be conducting reconnaissance.\r\n\r\n3. Baseline and anomalies \r\n\r\nEstablishing a baseline for LDAP query data can help reveal anomalies or deviations from standard user and machine behavior. This strategy has three components:\r\n\r\n \tNormalization: Standardize query data to identify patterns and deviations\r\n \tDistribution: Track how many machines executed a query\r\n \tUser diversity: Monitor how many users have run a query\r\n\r\n4. LDAP query filters \r\n\r\nSince attackers use diverse LDAP query filters to extract directory data, a wide variety of these filters in LDAP query logs often point to enumeration activity. The type of LDAP query filter can reveal the type of enumeration. Some common types of LDAP enumeration that are important to monitor include:\r\n\r\n \tAdmin enumeration: Queries targeting administrative accounts and privileges\r\n \tService accounts enumeration: Identification of service accounts and their configurations\r\n \tGPO enumeration: Retrieval of Group Policy Objects and their settings\r\n \tDomain machine enumeration: Gathering information about machines under the same domain\r\n\r\n5. Suspicious Attributes\r\n\r\nMonitoring queries for specific attributes like memberOf, pwdLastSet, lastLogon, and admincount can help detect suspicious activity.\r\n\r\nAttackers commonly use the following attributes in LDAP queries:\r\n\r\n \tadmincount\r\n \tbadpwdcount\r\n \thomeDirectory\r\n \tlastLogon\r\n \tmemberOf\r\n \tmsDS-AllowedToActOnBehalfOfOtherIdentity\r\n \tmsDS-AllowedToDelegateTo\r\n \tmsds-groupmsamembership\r\n \tmsds-managedpassword\r\n \tprofilePath\r\n \tpwdLastSet\r\n \tsIDHistory\r\n \tuserAccountControl\r\n \tuserPassword\r\n\r\nAppendix A shows an example of an XQL query in Cortex XDR to track the above LDAP attributes.\r\n\r\nFigure 6 displays a table detailing examples of LDAP attributes, including their definitions and potential implications for security.\r\n\r\n[caption id=\"attachment_137913\" align=\"alignnone\" width=\"1000\"] Figure 6. Interesting LDAP attributes.[\/caption]\r\nConclusion\r\nLDAP is a double-edged sword in Active Directory. It is essential for administration yet vulnerable to exploitation. While LDAP simplifies directory management, attackers can exploit its powerful querying capabilities to gather sensitive information.\r\n\r\nThis article highlights the challenges of detecting malicious LDAP activity. It also provides real-world examples of LDAP enumeration attacks, along with practical detection tips.\r\n\r\nUnderstanding and monitoring LDAP enumeration, coupled with robust detection strategies, is essential to mitigating risks and securing directory services.\r\nProtections and Mitigations\r\nFor Palo Alto Networks customers, our products and services provide the following coverage:\r\n\r\n \tCortex XDR and XSIAM are designed to:\r\n\r\n \tProtect against exploitation of different vulnerabilities as well as against malicious behaviors, through Behavioral Threat Protection.\r\n \tDetect user and credential-based threats by analyzing user activity from multiple data sources including endpoints, network firewalls, Active Directory, identity and access management solutions and cloud workloads. Cortex builds behavioral profiles of user activity over time with machine learning. It detects anomalous activity indicative of credential-based attacks by comparing new activity to past activity, peer activity and the expected behavior of the entity.\r\n \tDetect LDAP network attacks, including those mentioned in this article, with behavioral analytics, through Cortex XDR Pro and XSIAM.\r\n \tHelp protect against post-exploitation activities using the multi-layer approach.\r\n \tCortex XSIAM has released a Suspicious LDAP Search Query Playbook to enhance the response to analytics LDAP alerts. This playbook evaluates the risk score of the entities involved, examines the prevalence of the related processes, and checks the executed command line for suspicious parameters. If any suspicious activity is detected during the investigation phase, the playbook will terminate the causality process as a remediation action.\r\n\r\n\r\n \tCortex Xpanse and the ASM module for XSIAM are capable of detecting Internet-exposed LDAP servers.\r\n\r\nIf you think you might have been impacted or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\r\n\r\n \tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\r\n \tEMEA: +31.20.299.3130\r\n \tAPAC: +65.6983.8730\r\n \tJapan: +81.50.1790.0200\r\n\r\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the Cyber Threat Alliance.\r\nAdditional Resources\r\n\r\n \tCyberespionage Attacks Against Southeast Asian Government Linked to Stately Taurus, Aka Mustang Panda \u2013 Unit 42, Palo Alto Networks\r\n \tThe Anatomy of a BlackCat (ALPHV) Attack \u2013 Sygnia\r\n \tThe many lives of BlackCat ransomware \u2013 Microsoft\r\n \tFrom IcedID to Dagon Locker Ransomware in 29 Days \u2013 The DFIR Report\r\n \tSharpHound \u2014 BloodHound 4.3.1 documentation \u2013 BloodHound\r\n\r\nAppendix A\r\nThe following XQL query in Cortex tracks LDAP query attributes commonly targeted by attackers:\r\ndataset = xdr_data \/\/ Using the xdr dataset\r\n\r\n| filter event_type = ENUM.EVENT_LOG and action_evtlog_event_id in (1644, 30)\r\n\r\n| alter\r\n\r\nevtlog_ldap_domain_service_attributes = json_extract_scalar(action_evtlog_data_fields, \"$.param7\"),\r\n\r\nldap_attribute_list = json_extract_scalar(action_evtlog_data_fields, \"$.AttributeList\"),\r\n\r\nldap_1644_search_filter = json_extract_scalar(action_evtlog_data_fields, \"$.param2\"),\r\n\r\nldap_30_search_filter = json_extract_scalar(action_evtlog_data_fields, \"$.SearchFilter\")\r\n\r\n| alter\r\n\r\nattribute_list = lowercase(coalesce(evtlog_ldap_domain_service_attributes, ldap_attribute_list)),\r\n\r\nsearch_filter = lowercase(coalesce(ldap_30_search_filter, ldap_1644_search_filter))\r\n\r\n| alter attribute_regex_check = regextract(\r\n\r\nattribute_list,\r\n\r\n\"All_with_list|all|memberOf|pwdLastSet|lastLogon|sIDHistory|homeDirectory|profilePath|userAccountControl|userPassword|msds-managedpassword|msds-groupmsamembership|admincount|msDS-AllowedToDelegateTo|badpwdcount|msDS-AllowedToActOnBehalfOfOtherIdentity\"\r\n\r\n)\r\n\r\n| filter attribute_regex_check != Null\r\n\r\n\/\/ Filter out spamming queries\r\n\r\n| filter search_filter != \"(objectclass=*)\"\r\n\r\n| filter search_filter != \"(objectcategory=*)\"\r\n\r\n| fields attribute_list, attribute_regex_check, action_evtlog_data_fields, actor_process_image_name, search_filter\r\nAppendix B\r\nA Dive into LDAP Queries and Tools\r\nBasics of LDAP Query Filters\r\nLDAP queries retrieve directory objects like users, groups or computers based on specific filters. This section provides examples of query filters that system administrators can use for legitimate purposes, but that adversaries could also use for malicious purposes.\r\n\r\nFor example, to find all user accounts in an Active Directory environment, we can use the following query filter:\r\n(&amp;(objectClass=user)(objectCategory=person))\r\nAdditionally, we can refine queries to target specific needs by adding more attributes to the query filter. For example, to find users in privileged groups, we can use this LDAP query filter:\r\n(&amp;(objectClass=user)(objectCategory=person)(adminCount=1))\r\nThe above examples use the &amp; symbol, which is a logical AND operator and means all the specified conditions must be met. LDAP supports logical operators for advanced filtering:\r\n\r\n \tAND (&amp;): Ensures all specified conditions must be met\r\n \tOR (|): Allows any one of the conditions to be met\r\n \tNOT (!): Excludes objects that match a certain condition\r\n\r\nTools for LDAP Enumeration\r\nAttackers have an array of tools at their disposal for LDAP enumeration. Figure 7 depicts some of these key tools. Figure 7 also shows examples of queries each tool can execute:\r\n\r\n[caption id=\"attachment_137915\" align=\"alignnone\" width=\"1000\"] Figure 7. LDAP enumeration tools and example queries.[\/caption]\r\n\r\nEach tool facilitates different types of LDAP queries that attackers use to map Active Directory environments, helping them identify key targets such as service accounts and privileged users.\r\nAnalysis of LDAP Enumeration Query Attributes\r\nUnderstanding the nature of LDAP enumeration queries that attackers use is critical for detecting malicious activity in Active Directory environments. Here are some common queries and their potential risks:\r\nUsers With Kerberos Pre-authentication Disabled\r\nuserAccountControl:1.2.840.113556.1.4.803:=4194304\r\n\r\n \tDescription: The userAccountControl attribute is used to identify user accounts that have Kerberos pre-authentication disabled. This setting is a key condition for the AS-REP roasting attack.\r\n \tRisk: Attackers can request and potentially crack AS-REP tickets from these accounts, which can lead to unauthorized access.\r\n\r\nService Accounts\r\nservicePrincipalName=*\r\n\r\n \tDescription: Identifies user accounts that have any service principal name (SPN) entries.\r\n \tRisk: SPNs are used in Kerberos authentication to associate service instances with user accounts. Attackers use this information to perform Kerberoasting attacks, where they attempt to crack service tickets.\r\n\r\nEnumerate Active Directory Users\r\nsamAccountType=805306368\r\n\r\n \tDescription: The samAccountType attribute with the value 805306368 specifies Active Directory user accounts.\r\n \tRisk: An LDAP query with this attribute provides a list of all user accounts, which can be used for further enumeration or to identify targets for attacks.\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/12\/02_Vulnerabilities_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Stav Setty"},{"@type":"Person","name":"Shachar Roitman"},{"@type":"Person","name":"Tom Fakterman"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":137899,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"1cf91516fb","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"2f37607ffa"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.13" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/137899" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=137899' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.13 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

    </head>
<body class="post-template-default single single-post postid-137899 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex/" style="--card-color: #00cc66" role="link" title="Cortex" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Cortex"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex icon">Cortex</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xpanse/" style="--card-color: #00cc66" role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Cortex Xpanse"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex Xpanse icon">Cortex Xpanse</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xsiam/" style="--card-color: #00cc66" role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Cortex XSIAM"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XSIAM icon">Cortex XSIAM</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/unit-42-incident-response/" style="--card-color: #c94727" role="link" title="Unit 42 Incident Response" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Unit 42 Incident Response"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Unit 42 Incident Response icon">Unit 42 Incident Response</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Stav Setty" href="https://unit42.paloaltonetworks.com/author/stav-setty/">Stav Setty</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Shachar Roitman" href="https://unit42.paloaltonetworks.com/author/shachar-roitman/">Shachar Roitman</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Tom Fakterman" href="https://unit42.paloaltonetworks.com/author/tom-fakterman/">Tom Fakterman</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>December 17, 2024</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Cybercrime" href="https://unit42.paloaltonetworks.com/category/cybercrime/">Cybercrime</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Threat Actor Groups" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/">Threat Actor Groups</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Active Directory" href="https://unit42.paloaltonetworks.com/tag/active-directory/">Active Directory</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:AdFind" href="https://unit42.paloaltonetworks.com/tag/adfind/">AdFind</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:ALPHV" href="https://unit42.paloaltonetworks.com/tag/alphv/">ALPHV</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Ambitious Scorpius" href="https://unit42.paloaltonetworks.com/tag/ambitious-scorpius/">Ambitious Scorpius</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Blackcat" href="https://unit42.paloaltonetworks.com/tag/blackcat/">Blackcat</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:BloodHound" href="https://unit42.paloaltonetworks.com/tag/bloodhound/">BloodHound</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Enumeration" href="https://unit42.paloaltonetworks.com/tag/enumeration/">Enumeration</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:IcedID" href="https://unit42.paloaltonetworks.com/tag/icedid/">IcedID</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:LDAP" href="https://unit42.paloaltonetworks.com/tag/ldap/">LDAP</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Rubeus" href="https://unit42.paloaltonetworks.com/tag/rubeus/">Rubeus</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:SharpHound" href="https://unit42.paloaltonetworks.com/tag/sharphound/">SharpHound</a></li><li><a data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:Stately Taurus" href="https://unit42.paloaltonetworks.com/tag/stately-taurus/">Stately Taurus</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/?pdf=download&#038;lg=en&#038;_wpnonce=d7148a5ba5" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/?pdf=print&#038;lg=en&#038;_wpnonce=d7148a5ba5" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" role="link" title="Copy link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=LDAP%20Enumeration:%20Unveiling%20the%20Double-Edged%20Sword%20of%20Active%20Directory&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F&#038;title=LDAP%20Enumeration:%20Unveiling%20the%20Double-Edged%20Sword%20of%20Active%20Directory" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F&#038;text=LDAP%20Enumeration:%20Unveiling%20the%20Double-Edged%20Sword%20of%20Active%20Directory" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=LDAP%20Enumeration:%20Unveiling%20the%20Double-Edged%20Sword%20of%20Active%20Directory%20https%3A%2F%2Funit42.paloaltonetworks.com%2Flightweight-directory-access-protocol-based-attacks%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <h2><a id="post-137899-_t557wonds37q"></a><strong>Executive Summary</strong></h2>
<p>This article provides a practical guide to developing a detection strategy for Lightweight Directory Access Protocol (LDAP)-based attacks. We analyze real-world examples of nation-state and cybercriminal threat actors abusing LDAP attributes. We also examine common LDAP enumeration queries and assess their potential risks.</p>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/_ldap/" target="_blank" rel="noopener">LDAP</a> is a powerful protocol for accessing and managing directory services like <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview" target="_blank" rel="noopener">Active Directory</a>. LDAP is commonly used by criminals for <a href="https://attack.mitre.org/tactics/TA0008/" target="_blank" rel="noopener">lateral movement</a> and critical assets <a href="https://attack.mitre.org/tactics/TA0102/" target="_blank" rel="noopener">enumeration</a> in on-premises cyberattacks. Threat actors also frequently use tools like <a href="https://github.com/BloodHoundAD/BloodHound" target="_blank" rel="noopener">BloodHound</a> and <a href="https://github.com/BloodHoundAD/SharpHound" target="_blank" rel="noopener">SharpHound</a>, which leverage LDAP for malicious purposes.</p>
<p>Distinguishing benign from malicious LDAP activity within an organization is challenging. The high volume of benign event logs generated by a domain controller makes collecting as well as detecting malicious LDAP activity extremely difficult.</p>
<p>Palo Alto Networks customers are better protected against LDAP-based attacks through <a href="https://www.paloaltonetworks.com/cortex/cortex-xdr" target="_blank" rel="noopener">Cortex XDR</a>, <a href="https://docs-cortex.paloaltonetworks.com/p/XSIAM" target="_blank" rel="noopener">XSIAM</a> and <a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse">Xpanse</a>, which we detail further in the <a href="#post-137899-_lnk4dnak8y4i">Conclusion</a>.</p>
<p>If you think you might have been compromised or have an urgent matter, contact the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a>.</p>
<table style="width: 100%;">
<thead>
<tr>
<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/category/cybercrime/" target="_blank" rel="noopener"><b>Cybercrime</b></a>, <strong><a href="https://unit42.paloaltonetworks.com/category/ransomware/" target="_blank" rel="noopener">Ransomware</a></strong></td>
</tr>
</thead>
</table>
<h2><a id="post-137899-_abnqm19u8v4a"></a><strong>What Is LDAP?</strong></h2>
<p><a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/ldap/what-is-ldap" target="_blank" rel="noopener">LDAP</a> is a fundamental protocol used across nearly every Windows environment, enabling administrators to access directory services like Active Directory. This protocol is used for managing users and groups, as well as allowing applications to query directory data in the background. Although developed by Microsoft and primarily used in Windows environments, LDAP is vendor-agnostic and can be used on non-Windows systems like <a href="https://support.apple.com/guide/directory-utility/configure-ldap-directory-access-diru566b498a/mac" target="_blank" rel="noopener">macOS</a> and <a href="https://www.redhat.com/en/topics/security/what-is-ldap-authentication" target="_blank" rel="noopener">Linux</a>.</p>
<p>Threat actors often use LDAP because its functionality is so useful. Advanced persistent threat (APT) groups and other adversaries often use LDAP for network enumeration during the <a href="https://attack.mitre.org/tactics/TA0007/" target="_blank" rel="noopener">discovery phase</a> of an attack. Attackers query directories to extract sensitive information such as user accounts, group memberships and permissions, which they then use to escalate privileges and target critical assets.</p>
<h3><a id="post-137899-_oee1tjt9n350"></a>The Evolution of LDAP Protocols and Tools</h3>
<p>LDAP has evolved significantly since its introduction in the early 1990s, adapting to the changing needs of directory services and security challenges. Below are two examples of changes in the more recent versions of LDAP:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/active-directory/enable-ldap-over-ssl-3rd-certification-authority" target="_blank" rel="noopener"><strong>LDAP over SSL (LDAPS)</strong></a>: This secure version of LDAP encrypts data in transit, protecting sensitive information from interception during communication.</li>
<li><a href="https://learn.microsoft.com/en-us/services-hub/unified/health/remediation-steps-ad/configure-the-active-directory-web-services-adws-to-start-automatically-on-all-servers" target="_blank" rel="noopener"><strong>Active Directory Web Services (ADWS)</strong></a>: This provides a more <a href="https://www.codecademy.com/article/what-is-rest" target="_blank" rel="noopener">RESTful</a> approach to interacting with directory services. Notably, ADWS tools often operate under the radar of traditional monitoring systems, as they do not generate direct LDAP traffic.</li>
</ul>
<p>Tools like <a href="https://attack.mitre.org/software/S0521/" target="_blank" rel="noopener">BloodHound</a> and its C# data collector, SharpHound, have evolved alongside these protocols to visualize and analyze Active Directory environments. <a href="https://github.com/FalconForceTeam/SOAPHound?tab=readme-ov-file#description" target="_blank" rel="noopener">SOAPHound</a> builds on these advancements by using ADWS to enumerate Active Directory data.</p>
<h3><a id="post-137899-_ilgg6grsujb"></a>LDAP Logs: Visibility and Challenges</h3>
<p>The high volume of log data generated by LDAP can overwhelm detection systems and make it difficult to identify malicious activity. It generates so much log data because it is used by many systems and applications.</p>
<p>Common processes like Outlook generate LDAP logs for example, highlighting the protocol’s extensive role in directory services. This pervasive use means that malicious LDAP activity can get lost amid the noise of normal operations.</p>
<p>To manage LDAP log volume effectively, focus on filtering relevant data, such as:</p>
<ul>
<li><strong>Prioritize filtering:</strong> Focus on logs based on the type of account or service generating them to reduce noise.</li>
<li><strong>Exclude system-generated queries:</strong> Filter out queries that are unlikely to indicate user-initiated actions.</li>
</ul>
<p>To address these challenges, Windows offers native logging of LDAP activity from the following sources:</p>
<ul>
<li><strong>Microsoft-Windows-LDAP-Client - Event ID 30:</strong> System administrators can enable <a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/active-directory/turn-on-debug-logging-ldap-client" target="_blank" rel="noopener">debug logging for LDAP clients</a> to track activity on the initiating host. This logs details such as the initiating process, search entry, filter and search scope when LDAP is accessed via the <a href="https://learn.microsoft.com/en-us/windows/win32/api/_ldap/" target="_blank" rel="noopener">LDAP client API</a> through <span style="font-family: 'courier new', courier, monospace;">wldap32.dll</span>. Figure 1 shows an Event ID 30 entry from the debug logs of an LDAP client.</li>
</ul>
<figure id="attachment_137903" aria-describedby="caption-attachment-137903" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137903 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-461955-137899-1.png" alt="Screenshot of a Windows Event Viewer application showing various system logs with details such as Event ID, Date and Time, Source, and Task Category." width="1000" height="705" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-461955-137899-1.png 1047w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-461955-137899-1-624x440.png 624w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-461955-137899-1-993x700.png 993w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-461955-137899-1-768x541.png 768w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137903" class="wp-caption-text">Figure 1. Event ID 30 entry from LDAP-Client shown in Event Viewer on a Windows client.</figcaption></figure>
<ul>
<li><strong>Microsoft-Windows-ActiveDirectory_DomainService - Event ID </strong><a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/active-directory/event1644reader-analyze-ldap-query-performance" target="_blank" rel="noopener"><strong>1644</strong></a><strong>:</strong> This captures expensive, inefficient or slow LDAP queries made to domain controllers from all interacting hosts. Note that this Event ID is not enabled by default and requires <a href="https://techcommunity.microsoft.com/blog/coreinfrastructureandsecurityblog/how-to-find-expensive-inefficient-and-long-running-ldap-queries-in-active-direct/257859" target="_blank" rel="noopener">updates to the Windows registry</a> for activation. Figure 2 shows an Event ID 1644 entry seen in Event Viewer.</li>
</ul>
<figure id="attachment_137905" aria-describedby="caption-attachment-137905" style="width: 877px" class="wp-caption alignnone"><img  class="wp-image-137905 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-464802-137899-2.png" alt="Screenshot of a Windows Event Viewer application showing various system logs with details such as Event ID, Date and Time, Source, and Task Category." width="877" height="633" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-464802-137899-2.png 877w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-464802-137899-2-610x440.png 610w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-464802-137899-2-768x554.png 768w" sizes="(max-width: 877px) 100vw, 877px" /><figcaption id="caption-attachment-137905" class="wp-caption-text">Figure 2. Event ID 1644 from ActiveDirectory_DomainService seen in Event Viewer on a Windows Server.</figcaption></figure>
<h2><a id="post-137899-_11kyw4tezllg"></a><strong>Real-World Scenarios of LDAP Enumeration</strong></h2>
<p>This section provides real-world examples of attackers using LDAP enumeration tools against Active Directory environments.</p>
<h3><a id="post-137899-_rpsk66f0mofr"></a>Stately Taurus Linked to Use of AdFind in Attacks Against Southeast Asian Government</h3>
<p>As part of a <a href="https://unit42.paloaltonetworks.com/stately-taurus-attacks-se-asian-government/" target="_blank" rel="noopener">campaign targeting government entities in Southeast Asia from 2021 to 2023</a>, Stately Taurus was linked to the use of <a href="https://www.joeware.net/freetools/tools/adfind/" target="_blank" rel="noopener">AdFind</a> during the reconnaissance stage of the attack.</p>
<p>AdFind is a command-line query tool that can be used for LDAP enumeration by gathering information from an Active Directory domain controller. During the attack, threat actors renamed the tool from <span style="font-family: 'courier new', courier, monospace;">adfind.exe</span> to <span style="font-family: 'courier new', courier, monospace;">a.logs</span> in an attempt to evade detection.</p>
<p>Figure 3 shows a screenshot from a Cortex XDR alert in which the threat actor attempted to save the results of an AdFind query to the following filenames:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">Domain_users_light.txt</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">Domain_computers_light.txt</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">Domain_groups_light.txt</span></li>
</ul>
<figure id="attachment_137907" aria-describedby="caption-attachment-137907" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137907 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467373-137899-3.png" alt="Screenshot from a Cortex XDR alert depicting a process with three stages linked by arrows. The first stage is labeled &quot;WinPrvSE.exe,&quot; the second &quot;cmd.exe,&quot; and the third &quot;a.logs,&quot; each within a circular border. The cmd.exe stage includes a command line script related to fetching user mailbox details in a Windows environment." width="1000" height="438" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467373-137899-3.png 1085w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467373-137899-3-786x344.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467373-137899-3-768x336.png 768w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137907" class="wp-caption-text">Figure 3. Screenshot from a Cortex XDR alert that prevented AdFind attempts to dump domain users’ details.</figcaption></figure>
<h3><a id="post-137899-_6pkuj54p51yt"></a>Ambitious Scorpius Wielded ADRecon in Ransomware Operations</h3>
<p>Affiliates of the BlackCat (ALPHV) ransomware group, which we track as <a href="https://unit42.paloaltonetworks.com/threat-actor-groups-tracked-by-palo-alto-networks-unit-42/#section10SubHeading4:~:text=Ambitious%20Scorpius%20is,distributing%20BlackCat%20Ransomware." target="_blank" rel="noopener">Ambitious Scorpius</a>, have used <a href="https://github.com/sense-of-security/ADRecon?tab=readme-ov-file#adrecon-active-directory-recon-" target="_blank" rel="noopener">ADRecon</a> in <a href="https://www.sygnia.co/blog/blackcat-ransomware/" target="_blank" rel="noopener">multiple intrusions</a>. ADRecon is a PowerShell script that uses LDAP to gather information about an Active Directory environment and generates a report that provides a snapshot of the targeted network.</p>
<p>Due to this group's <a href="https://www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/" target="_blank" rel="noopener">continued use</a> of ADRecon, we assess that the tool could be a part of the Ambitious Scorpius playbook. Figure 4 shows a Cortex XDR alert on the detection and prevention of ADRecon activity.</p>
<p>&nbsp;</p>
<figure id="attachment_137909" aria-describedby="caption-attachment-137909" style="width: 800px" class="wp-caption alignnone"><img  class="wp-image-137909 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470143-137899-4.png" alt="Cortex XDR alert notification screenshot showing high severity warning of possible LDAP Enumeration Tool usage involving 'ADRecon.ps1', run by 'powershell.exe'." width="800" height="333" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470143-137899-4.png 1376w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470143-137899-4-786x327.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470143-137899-4-768x319.png 768w" sizes="(max-width: 800px) 100vw, 800px" /><figcaption id="caption-attachment-137909" class="wp-caption-text">Figure 4. Screenshot from a Cortex XDR alert on the detection and prevention of ADRecon.</figcaption></figure>
<h3><a id="post-137899-_ycpzhovl75od"></a>SharpHound Used in an IcedID and Dagon Locker Ransomware Operation</h3>
<p>In April 2024, <a href="https://thedfirreport.com/2024/04/29/from-icedid-to-dagon-locker-ransomware-in-29-days/" target="_blank" rel="noopener">The DFIR Report described</a> an intrusion that involved <a href="https://attack.mitre.org/software/S0483/" target="_blank" rel="noopener">IcedID</a> malware and Dagon Locker ransomware. During this intrusion, the attackers used SharpHound to collect data about the Active Directory environment.</p>
<p>SharpHound is a data collector component of BloodHound. It uses Windows API and LDAP functions to collect data from domain controllers and Windows systems that are part of the domain. Figure 5 shows the detection and prevention of SharpHound in Cortex XDR.</p>
<figure id="attachment_137911" aria-describedby="caption-attachment-137911" style="width: 800px" class="wp-caption alignnone"><img  class="wp-image-137911 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-473290-137899-5.png" alt="Cortex XDR screenshot showing an alert message titled 'Suspicious GPO Enumeration by an LDAP tool' with a description, the source as XDR Analytics BIOC, discovery method, and a high severity level. The right side of the image displays an icon with the number 2 and indicates the SharpHound EXE." width="800" height="285" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-473290-137899-5.png 1430w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-473290-137899-5-786x280.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-473290-137899-5-768x274.png 768w" sizes="(max-width: 800px) 100vw, 800px" /><figcaption id="caption-attachment-137911" class="wp-caption-text">Figure 5. Screenshot from a Cortex XDR alert showing the detection and prevention of SharpHound.</figcaption></figure>
<h2><a id="post-137899-_mi0rxaopwsso"></a><strong>Detection Strategies for LDAP-Based Attacks</strong></h2>
<p>Detecting LDAP-based attacks effectively involves monitoring LDAP logs for suspicious activity. Event logs capture crucial data, including:</p>
<ul>
<li><strong>Visited entries</strong>: This represents the total number of LDAP queries made.</li>
<li><strong>Returned entries</strong>: This indicates the actual results returned from those queries or their count.</li>
</ul>
<p>Legitimate LDAP queries typically target specific objects or attributes, resulting in fewer visited and returned entries. On the other hand, enumeration attempts use broader queries as attackers seek to collect as much information as possible by querying all users, computers or groups.</p>
<p>Below are key detection strategies to help identify and mitigate LDAP enumeration attempts:</p>
<p><strong>1. Visited and returned entries</strong></p>
<p>Review logs for Event ID 1644 events for both visited and returned entries.</p>
<ul>
<li><strong>Low “visited to returned” ratio:</strong> This low ratio is typical of legitimate queries targeting a wide range of objects.</li>
<li><strong>High sum of returned entries:</strong> This indicates an attempt to gather large amounts of directory data. This is a possible indicator of enumeration by an attacker.</li>
</ul>
<p><strong>2. User context</strong></p>
<p>Analyzing LDAP queries for user context can also reveal enumeration activity:</p>
<ul>
<li><strong>User title or role: </strong>Consider whether the LDAP activity fits the user’s typical role. For example, service accounts and IT personnel might legitimately perform extensive LDAP queries. However, if a user outside these roles engages in a similar activity, this could indicate potential enumeration.</li>
<li><strong>Search scope anomalies: </strong>Users who suddenly expand their search scope beyond typical patterns could be conducting reconnaissance.</li>
</ul>
<p><strong>3. Baseline and anomalies </strong></p>
<p>Establishing a baseline for LDAP query data can help reveal anomalies or deviations from standard user and machine behavior. This strategy has three components:</p>
<ul>
<li><strong>Normalization:</strong> Standardize query data to identify patterns and deviations</li>
<li><strong>Distribution:</strong> Track how many machines executed a query</li>
<li><strong>User diversity:</strong> Monitor how many users have run a query</li>
</ul>
<p><strong>4. LDAP query filters </strong></p>
<p>Since attackers use diverse <a href="https://learn.microsoft.com/en-us/windows/win32/ad/creating-a-query-filter" target="_blank" rel="noopener">LDAP query filters</a> to extract directory data, a wide variety of these filters in LDAP query logs often point to enumeration activity. The type of LDAP query filter can reveal the type of enumeration. Some common types of LDAP enumeration that are important to monitor include:</p>
<ul>
<li><strong>Admin enumeration:</strong> Queries targeting administrative accounts and privileges</li>
<li><strong>Service accounts enumeration:</strong> Identification of service accounts and their configurations</li>
<li><strong>GPO enumeration:</strong> Retrieval of <a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/policy/group-policy-objects" target="_blank" rel="noopener">Group Policy Objects</a> and their settings</li>
<li><strong>Domain machine enumeration:</strong> Gathering information about machines under the same domain</li>
</ul>
<p><strong>5. Suspicious Attributes</strong></p>
<p>Monitoring queries for specific attributes like <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ada2/cc24555b-61c7-49a2-9748-167b8ce5a512" target="_blank" rel="noopener">memberOf</a></span>, <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ada3/9663282b-c880-4061-ba8e-e8509c8aa336" target="_blank" rel="noopener">pwdLastSet</a></span>, <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ada1/93258066-276d-4357-8458-981c19caad95" target="_blank" rel="noopener">lastLogon</a></span>, and <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ada1/c1c2f7ca-5705-4619-9b62-527b87bf1801" target="_blank" rel="noopener">admincount</a></span> can help detect suspicious activity.</p>
<p>Attackers commonly use the following attributes in LDAP queries:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">admincount</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">badpwdcount</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">homeDirectory</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">lastLogon</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">memberOf</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">msDS-AllowedToActOnBehalfOfOtherIdentity</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">msDS-AllowedToDelegateTo</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">msds-groupmsamembership</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">msds-managedpassword</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">profilePath</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">pwdLastSet</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">sIDHistory</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">userAccountControl</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">userPassword</span></li>
</ul>
<p><a href="#post-137899-_ojz7xan5g0mo">Appendix A</a> shows an example of an XQL query in Cortex XDR to track the above LDAP attributes.</p>
<p>Figure 6 displays a table detailing examples of <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ada1/8beac51f-579d-4429-9ce8-2be2d1be66d1" target="_blank" rel="noopener">LDAP attributes</a>, including their definitions and potential implications for security.</p>
<figure id="attachment_137913" aria-describedby="caption-attachment-137913" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137913 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-476370-137899-6.png" alt="A table titled &quot;Attribute Definition&quot; lists various computer account attributes, including &quot;sAMAccountName&quot;, &quot;memberOf&quot;, and &quot;pwdLastSet&quot;, with a short description for each. Logos of Palo Alto Networks and Unit 42 are displayed at the bottom right." width="1000" height="1142" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-476370-137899-6.png 1794w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-476370-137899-6-385x440.png 385w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-476370-137899-6-613x700.png 613w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-476370-137899-6-768x877.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-476370-137899-6-1346x1536.png 1346w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137913" class="wp-caption-text">Figure 6. Interesting LDAP attributes.</figcaption></figure>
<h2><a id="post-137899-_lnk4dnak8y4i"></a><strong>Conclusion</strong></h2>
<p>LDAP is a double-edged sword in Active Directory. It is essential for administration yet vulnerable to exploitation. While LDAP simplifies directory management, attackers can exploit its powerful querying capabilities to gather sensitive information.</p>
<p>This article highlights the challenges of detecting malicious LDAP activity. It also provides real-world examples of LDAP enumeration attacks, along with practical detection tips.</p>
<p>Understanding and monitoring LDAP enumeration, coupled with robust detection strategies, is essential to mitigating risks and securing directory services.</p>
<h3><a id="post-137899-_m2wtwaz51nkv"></a>Protections and Mitigations</h3>
<p>For Palo Alto Networks customers, our products and services provide the following coverage:</p>
<ul>
<li><a href="https://www.paloaltonetworks.com/cortex/cortex-xdr" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://docs-cortex.paloaltonetworks.com/p/XSIAM" target="_blank" rel="noopener">XSIAM</a> are designed to:
<ul>
<li>Protect against exploitation of different vulnerabilities as well as against malicious behaviors, through Behavioral Threat Protection.</li>
<li>Detect user and credential-based threats by analyzing user activity from multiple data sources including endpoints, network firewalls, Active Directory, identity and access management solutions and cloud workloads. Cortex builds behavioral profiles of user activity over time with machine learning. It detects anomalous activity indicative of credential-based attacks by comparing new activity to past activity, peer activity and the expected behavior of the entity.</li>
<li>Detect LDAP network attacks, including those mentioned in this article, with behavioral <a href="https://docs-cortex.paloaltonetworks.com/r/Cortex-XDR/Cortex-XDR-Pro-Administrator-Guide/Analytics-Concepts" target="_blank" rel="noopener">analytics</a>, through Cortex XDR Pro and XSIAM.</li>
<li>Help protect against post-exploitation activities using the multi-layer approach.</li>
<li><a href="https://docs-cortex.paloaltonetworks.com/p/XSIAM" target="_blank" rel="noopener">Cortex XSIAM</a> has released a <a href="https://xsoar.pan.dev/docs/reference/playbooks/suspicious-ldap-search-query" target="_blank" rel="noopener">Suspicious LDAP Search Query</a> Playbook to enhance the response to analytics LDAP alerts. This playbook evaluates the risk score of the entities involved, examines the prevalence of the related processes, and checks the executed command line for suspicious parameters. If any suspicious activity is detected during the investigation phase, the playbook will terminate the causality process as a remediation action.</li>
</ul>
</li>
<li><a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse" target="_blank" rel="noopener">Cortex Xpanse</a> and the <a href="https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Administrator-Guide/Analytics-behavioral-indicators-of-compromise-ABIOCs" target="_blank" rel="noopener">ASM module</a> for XSIAM are capable of detecting Internet-exposed LDAP servers.</li>
</ul>
<p>If you think you might have been impacted or have an urgent matter, get in touch with the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a> or call:</p>
<ul>
<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>
<li>EMEA: +31.20.299.3130</li>
<li>APAC: +65.6983.8730</li>
<li>Japan: +81.50.1790.0200</li>
</ul>
<p>Palo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="https://www.cyberthreatalliance.org/" target="_blank" rel="noopener">Cyber Threat Alliance</a>.</p>
<h2><a id="post-137899-_ly8i91te62ls"></a><strong>Additional Resources</strong></h2>
<ul>
<li><a href="https://unit42.paloaltonetworks.com/stately-taurus-attacks-se-asian-government/" target="_blank" rel="noopener">Cyberespionage Attacks Against Southeast Asian Government Linked to Stately Taurus, Aka Mustang Panda</a> <span style="font-weight: 400;">–</span> Unit 42, Palo Alto Networks</li>
<li><a href="https://www.sygnia.co/blog/blackcat-ransomware/" target="_blank" rel="noopener">The Anatomy of a BlackCat (ALPHV) Attack</a> <span style="font-weight: 400;">– S</span>ygnia</li>
<li><a href="https://www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/" target="_blank" rel="noopener">The many lives of BlackCat ransomware</a> <span style="font-weight: 400;">–</span> Microsoft</li>
<li><a href="https://thedfirreport.com/2024/04/29/from-icedid-to-dagon-locker-ransomware-in-29-days/" target="_blank" rel="noopener">From IcedID to Dagon Locker Ransomware in 29 Days</a> <span style="font-weight: 400;">– </span>The DFIR Report</li>
<li><a href="https://bloodhound.readthedocs.io/en/latest/data-collection/sharphound.html#:~:text=SharpHound%20is%20the%20official%20data,and%20domain%2Djoined%20Windows%20systems" target="_blank" rel="noopener">SharpHound — BloodHound 4.3.1 documentation</a> <span style="font-weight: 400;">– </span>BloodHound</li>
</ul>
<h2><a id="post-137899-_ojz7xan5g0mo"></a><strong>Appendix A</strong></h2>
<p>The following XQL query in Cortex tracks LDAP query attributes commonly targeted by attackers:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676c5bd88192b250903094" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
dataset = xdr_data // Using the xdr dataset

| filter event_type = ENUM.EVENT_LOG and action_evtlog_event_id in (1644, 30)

| alter

evtlog_ldap_domain_service_attributes = json_extract_scalar(action_evtlog_data_fields, "$.param7"),

ldap_attribute_list = json_extract_scalar(action_evtlog_data_fields, "$.AttributeList"),

ldap_1644_search_filter = json_extract_scalar(action_evtlog_data_fields, "$.param2"),

ldap_30_search_filter = json_extract_scalar(action_evtlog_data_fields, "$.SearchFilter")

| alter

attribute_list = lowercase(coalesce(evtlog_ldap_domain_service_attributes, ldap_attribute_list)),

search_filter = lowercase(coalesce(ldap_30_search_filter, ldap_1644_search_filter))

| alter attribute_regex_check = regextract(

attribute_list,

"All_with_list|all|memberOf|pwdLastSet|lastLogon|sIDHistory|homeDirectory|profilePath|userAccountControl|userPassword|msds-managedpassword|msds-groupmsamembership|admincount|msDS-AllowedToDelegateTo|badpwdcount|msDS-AllowedToActOnBehalfOfOtherIdentity"

)

| filter attribute_regex_check != Null

// Filter out spamming queries

| filter search_filter != "(objectclass=*)"

| filter search_filter != "(objectcategory=*)"

| fields attribute_list, attribute_regex_check, action_evtlog_data_fields, actor_process_image_name, search_filter</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-2">2</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-4">4</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-6">6</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-8">8</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-10">10</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-12">12</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-14">14</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-16">16</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-18">18</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-20">20</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-22">22</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-24">24</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-26">26</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-28">28</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-30">30</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-32">32</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-34">34</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-676c5bd88192b250903094-36">36</div><div class="crayon-num" data-line="crayon-676c5bd88192b250903094-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676c5bd88192b250903094-1"><span class="crayon-i">dataset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">xdr_data</span><span class="crayon-h"> </span><span class="crayon-c">// Using the xdr dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-2">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">event_type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-e">EVENT_LOG </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">action_evtlog_event_id </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1644</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-4">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-5"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">alter</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-6">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-7"><span class="crayon-i">evtlog_ldap_domain_service_attributes</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">json_extract_scalar</span><span class="crayon-sy">(</span><span class="crayon-i">action_evtlog_data_fields</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"$.param7"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-8">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-9"><span class="crayon-i">ldap_attribute_list</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">json_extract_scalar</span><span class="crayon-sy">(</span><span class="crayon-i">action_evtlog_data_fields</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"$.AttributeList"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-10">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-11"><span class="crayon-i">ldap_1644_search_filter</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">json_extract_scalar</span><span class="crayon-sy">(</span><span class="crayon-i">action_evtlog_data_fields</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"$.param2"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-12">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-13"><span class="crayon-i">ldap_30_search_filter</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">json_extract_scalar</span><span class="crayon-sy">(</span><span class="crayon-i">action_evtlog_data_fields</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"$.SearchFilter"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-14">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-15"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">alter</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-16">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-17"><span class="crayon-i">attribute_list</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">lowercase</span><span class="crayon-sy">(</span><span class="crayon-e">coalesce</span><span class="crayon-sy">(</span><span class="crayon-i">evtlog_ldap_domain_service_attributes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ldap_attribute_list</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-18">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-19"><span class="crayon-i">search_filter</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">lowercase</span><span class="crayon-sy">(</span><span class="crayon-e">coalesce</span><span class="crayon-sy">(</span><span class="crayon-i">ldap_30_search_filter</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ldap_1644_search_filter</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-20">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-21"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">alter </span><span class="crayon-i">attribute_regex_check</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">regextract</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-22">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-23"><span class="crayon-i">attribute_list</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-24">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-25"><span class="crayon-s">"All_with_list|all|memberOf|pwdLastSet|lastLogon|sIDHistory|homeDirectory|profilePath|userAccountControl|userPassword|msds-managedpassword|msds-groupmsamembership|admincount|msDS-AllowedToDelegateTo|badpwdcount|msDS-AllowedToActOnBehalfOfOtherIdentity"</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-26">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-27"><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-28">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-29"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">attribute_regex_check</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-t">Null</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-30">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-31"><span class="crayon-c">// Filter out spamming queries</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-32">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-33"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">search_filter</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-s">"(objectclass=*)"</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-34">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-35"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">search_filter</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-s">"(objectcategory=*)"</span></div><div class="crayon-line crayon-striped-line" id="crayon-676c5bd88192b250903094-36">&nbsp;</div><div class="crayon-line" id="crayon-676c5bd88192b250903094-37"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">attribute_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">attribute_regex_check</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_evtlog_data_fields</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">search_filter</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h2><a id="post-137899-_zgfxcufwzy6i"></a><strong>Appendix B</strong></h2>
<h3><a id="post-137899-_2ewrevr5eahn"></a>A Dive into LDAP Queries and Tools</h3>
<h4><a id="post-137899-_qwgsomt3y91n"></a>Basics of LDAP Query Filters</h4>
<p>LDAP queries retrieve directory objects like users, groups or computers based on specific filters. This section provides examples of query filters that system administrators can use for legitimate purposes, but that adversaries could also use for malicious purposes.</p>
<p>For example, to find all user accounts in an Active Directory environment, we can use the following query filter:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676c5bd881938741732268" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(&amp;(objectClass=user)(objectCategory=person))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676c5bd881938741732268-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676c5bd881938741732268-1"><span class="crayon-sy">(</span>&<span class="crayon-sy">(</span><span class="crayon-i">objectClass</span>=<span class="crayon-i">user</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">objectCategory</span>=<span class="crayon-i">person</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Additionally, we can refine queries to target specific needs by adding more attributes to the query filter. For example, to find users in privileged groups, we can use this LDAP query filter:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676c5bd88193a171132091" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(&amp;(objectClass=user)(objectCategory=person)(adminCount=1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676c5bd88193a171132091-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676c5bd88193a171132091-1"><span class="crayon-sy">(</span>&<span class="crayon-sy">(</span><span class="crayon-i">objectClass</span>=<span class="crayon-i">user</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">objectCategory</span>=<span class="crayon-i">person</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">adminCount</span>=<span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The above examples use the <span style="font-family: 'courier new', courier, monospace;">&amp;</span> symbol, which is a logical AND operator and means all the specified conditions must be met. LDAP supports logical operators for advanced filtering:</p>
<ul>
<li><strong>AND</strong> (<span style="font-family: 'courier new', courier, monospace;">&amp;</span>): Ensures all specified conditions must be met</li>
<li><strong>OR</strong> (<span style="font-family: 'courier new', courier, monospace;">|</span>): Allows any one of the conditions to be met</li>
<li><strong>NOT</strong> (<span style="font-family: 'courier new', courier, monospace;">!</span>): Excludes objects that match a certain condition</li>
</ul>
<h3><a id="post-137899-_51l29edkyck"></a>Tools for LDAP Enumeration</h3>
<p>Attackers have an array of tools at their disposal for LDAP enumeration. Figure 7 depicts some of these key tools. Figure 7 also shows examples of queries each tool can execute:</p>
<figure id="attachment_137915" aria-describedby="caption-attachment-137915" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137915 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-479961-137899-7.png" alt="A diagram detailing the hierarchy and relationships of various LDAP enumeration tools, such as Users, Groups, and Group Policy Objects, using boxes and connecting lines in different colors to represent different types of connections or data. The first column shows the Tool Name, the second column the Enumeration Type and the third column the Example Search Filters. " width="1000" height="684" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-479961-137899-7.png 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-479961-137899-7-644x440.png 644w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-479961-137899-7-1024x700.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-479961-137899-7-768x525.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-479961-137899-7-1536x1050.png 1536w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137915" class="wp-caption-text">Figure 7. LDAP enumeration tools and example queries.</figcaption></figure>
<p>Each tool facilitates different types of LDAP queries that attackers use to map Active Directory environments, helping them identify key targets such as <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-service-accounts" target="_blank" rel="noopener">service accounts</a> and privileged users.</p>
<h3><a id="post-137899-_cvfqgv6snzw4"></a>Analysis of LDAP Enumeration Query Attributes</h3>
<p>Understanding the nature of LDAP enumeration queries that attackers use is critical for detecting malicious activity in Active Directory environments. Here are some common queries and their potential risks:</p>
<h4><strong>Users With Kerberos Pre-authentication Disabled</strong></h4>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676c5bd88193c018535165" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
userAccountControl:1.2.840.113556.1.4.803:=4194304</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676c5bd88193c018535165-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676c5bd88193c018535165-1"><span class="crayon-i">userAccountControl</span><span class="crayon-sy">:</span><span class="crayon-cn">1.2.840.113556.1.4.803</span><span class="crayon-sy">:</span>=<span class="crayon-cn">4194304</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<ul>
<li><strong>Description:</strong> The <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/windows/win32/adschema/a-useraccountcontrol" target="_blank" rel="noopener">userAccountControl</a></span> attribute is used to identify user accounts that have <a href="https://docs.paloaltonetworks.com/pan-os/10-1/pan-os-admin/authentication/authentication-types/kerberos" target="_blank" rel="noopener">Kerberos</a> pre-authentication disabled. This setting is a key condition for the <a href="https://attack.mitre.org/techniques/T1558/004/" target="_blank" rel="noopener">AS-REP roasting attack</a>.</li>
<li><strong>Risk:</strong> Attackers can request and potentially crack AS-REP tickets from these accounts, which can lead to unauthorized access.</li>
</ul>
<h4><strong>Service Accounts</strong></h4>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676c5bd88193d900963437" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
servicePrincipalName=*</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676c5bd88193d900963437-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676c5bd88193d900963437-1"><span class="crayon-i">servicePrincipalName</span>=*</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<ul>
<li><strong>Description: </strong>Identifies user accounts that have any <a href="https://learn.microsoft.com/en-us/windows/win32/ad/service-principal-names" target="_blank" rel="noopener">service principal name</a> (SPN) entries.</li>
<li><strong>Risk:</strong> SPNs are used in Kerberos authentication to associate service instances with user accounts. Attackers use this information to perform <a href="https://attack.mitre.org/techniques/T1558/003/" target="_blank" rel="noopener">Kerberoasting</a> attacks, where they attempt to crack service tickets.</li>
</ul>
<h4><strong>Enumerate Active Directory Users</strong></h4>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676c5bd88193f622976196" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
samAccountType=805306368</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676c5bd88193f622976196-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676c5bd88193f622976196-1"><span class="crayon-i">samAccountType</span>=<span class="crayon-cn">805306368</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<ul>
<li><strong>Description:</strong> The <a href="https://learn.microsoft.com/en-us/windows/win32/adschema/a-samaccounttype" target="_blank" rel="noopener">samAccountType</a> attribute with the value <span style="font-family: 'courier new', courier, monospace;">805306368</span> specifies Active Directory user accounts.</li>
<li><strong>Risk:</strong> An LDAP query with this attribute provides a list of all user accounts, which can be used for further enumeration or to identify targets for attacks.</li>
</ul>
      
              </div>
              <!--<span class="post__date">Updated 17 December, 2024 at 9:46 AM PST</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/active-directory/" role="link" title="Active Directory" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:Active Directory">Active Directory</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/adfind/" role="link" title="AdFind" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:AdFind">AdFind</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/alphv/" role="link" title="ALPHV" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:ALPHV">ALPHV</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/ambitious-scorpius/" role="link" title="Ambitious Scorpius" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:Ambitious Scorpius">Ambitious Scorpius</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/blackcat/" role="link" title="Blackcat" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:Blackcat">Blackcat</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/bloodhound/" role="link" title="BloodHound" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:BloodHound">BloodHound</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/enumeration/" role="link" title="Enumeration" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:Enumeration">Enumeration</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/icedid/" role="link" title="IcedID" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:IcedID">IcedID</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/ldap/" role="link" title="LDAP" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:LDAP">LDAP</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/rubeus/" role="link" title="Rubeus" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:Rubeus">Rubeus</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/sharphound/" role="link" title="SharpHound" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:SharpHound">SharpHound</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/stately-taurus/" role="link" title="Stately Taurus" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:tags:Stately Taurus">Stately Taurus</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/" role="link" title="Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:article-nav:Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration"> 
            <span>Next: Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="lightweight-directory-access-protocol-based-attacks:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/detecting-dns-tunneling-campaigns/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:sidebar:related-articles:No Way to Hide: Uncovering New Campaigns from Daily Tunneling Detection">
                      No Way to Hide: Uncovering New Campaigns from Daily Tunneling Detection                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/repellent-scorpius-cicada3301-ransomware/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:sidebar:related-articles:Threat Assessment: Repellent Scorpius, Distributors of Cicada3301 Ransomware">
                      Threat Assessment: Repellent Scorpius, Distributors of Cicada3301 Ransomware                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/unit-42-ransomware-leak-site-data-analysis/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:sidebar:related-articles:Ransomware Review: First Half of 2024">
                      Ransomware Review: First Half of 2024                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related  Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of using LLMs to obfuscate malicious JavaScript detection. A man wearing glasses, looking intently at a screen with reflections visible in the glasses of computer code." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-20T11:00:39+00:00">December 20, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript">
                    <h4 class="post-title">Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/credential-stealer/" title="credential stealer" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:credential stealer">Credential stealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/data-augmentation/" title="Data Augmentation" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:Data Augmentation">Data Augmentation</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/fraudgpt/" title="FraudGPT" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:FraudGPT">FraudGPT</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/" title="Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                          <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of HeartCrypt. A laptop on a desk displaying a vivid graphical interface with cyber security and data analytics themes, illuminated by red ambient lighting." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-13T23:00:21+00:00">December 13, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation">
                    <h4 class="post-title">Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/redline-infostealer/" title="Redline infostealer" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Redline infostealer">Redline infostealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/lumma-stealer/" title="Lumma Stealer" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Lumma Stealer">Lumma Stealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remcos/" title="Remcos" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Remcos">Remcos</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/" title="Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of suspicious registration scam campaigns. Close-up image of a glowing red WiFi connectivity symbol on a textured black surface, symbolizing digital security technology." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-06T23:00:40+00:00">December 6, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams">
                    <h4 class="post-title">Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/network-scanning/" title="network scanning" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:network scanning">Network scanning</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cybersquatting/" title="cybersquatting" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:cybersquatting">Cybersquatting</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/chatgpt/" title="ChatGPT" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:ChatGPT">ChatGPT</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/" title="Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of Akira ransomware, distributed by Howling Scorpius. A person&#039;s hand typing on a keyboard with a digital screen displaying the word &quot;password&quot; highlighted in blue, set against a backdrop of various cybersecurity interface graphics." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-12-02T23:00:10+00:00">December 2, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware)">
                    <h4 class="post-title">Threat Assessment: Howling Scorpius (Akira Ransomware)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/howling-scorpius/" title="Howling Scorpius" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):Howling Scorpius">Howling Scorpius</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/leak-site/" title="Leak site" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):Leak site">Leak site</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/torrenting/" title="torrenting" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):torrenting">Torrenting</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/" title="Threat Assessment: Howling Scorpius (Akira Ransomware)" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-786x368.jpg" class="lozad" alt="Close-up of a person wearing glasses, reflecting computer code on the lens." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-22T11:00:26+00:00">November 22, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples">
                    <h4 class="post-title">Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:macOS">MacOS</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/" title="Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of a threat like BlackSuit ransomware. An illustration of a modern workspace with a laptop displaying cybersecurity icons, surrounded by stacks of coins and a credit card, all depicted in a neon, digital art style." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-11-20T11:00:53+00:00">November 20, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-blacksuit-ransomware-ignoble-scorpius/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware">
                    <h4 class="post-title">Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/blacksuit-ransomware/" title="BlackSuit ransomware" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:BlackSuit ransomware">BlackSuit ransomware</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/construction/" title="construction" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:construction">Construction</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/education/" title="Education" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:Education">Education</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-blacksuit-ransomware-ignoble-scorpius/" title="Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of FrostyGoop malware. Close-up view of a digital screen displaying a pixelated, abstract image, possibly representing a face." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-19T11:00:15+00:00">November 19, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications">
                    <h4 class="post-title">FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/bustleberm/" title="BUSTLEBERM" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:BUSTLEBERM">BUSTLEBERM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/frostygoop/" title="FrostyGoop" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:FrostyGoop">FrostyGoop</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/go/" title="Go" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:Go">Go</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/" title="FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of global companies paying North Korean IT workers. Abstract digital world map with interconnected lines and dots, depicting global data and network connections, highlighted in blue and red colors." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-13T11:00:36+00:00">November 13, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/north-korean-it-workers/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them">
                    <h4 class="post-title">Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dprk/" title="DPRK" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:DPRK">DPRK</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-it-workers/" title="Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial represntation of cybercrime like Silent Skimmer. A glowing red padlock on a wet surface with red particles floating in a misty, dark blue background." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Silent Skimmer Gets Loud (Again):Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2024-11-07T11:00:13+00:00">November 7, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/silent-skimmer-latest-campaign/" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Silent Skimmer Gets Loud (Again)">
                    <h4 class="post-title">Silent Skimmer Gets Loud (Again)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Silent Skimmer Gets Loud (Again):Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Silent Skimmer Gets Loud (Again):Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/reverse-shells/" title="reverse shells" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Silent Skimmer Gets Loud (Again):reverse shells">Reverse shells</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/silent-skimmer-latest-campaign/" title="Silent Skimmer Gets Loud (Again)" role="link" data-page-track="true" data-page-track-value="lightweight-directory-access-protocol-based-attacks:related-resources:Silent Skimmer Gets Loud (Again):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.2' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
