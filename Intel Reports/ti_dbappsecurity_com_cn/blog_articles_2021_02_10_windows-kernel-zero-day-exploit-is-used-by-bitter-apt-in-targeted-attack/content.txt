<!DOCTYPE html>
<html lang="zh-CN" class="no-js no-svg">
<head>
	<meta charset="UTF-8">
	<meta name="keywords" content="威胁情报,威胁情报中心,APT检测,APT分析,追踪溯源,猎影实验室,关联分析,安全研究,Exploit,漏洞利用">
	<meta name="description" content="威胁情报,威胁情报中心,APT检测,APT分析,追踪溯源,猎影实验室,关联分析,安全研究,Exploit,漏洞利用">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
	<link rel="icon" href="https://ti.dbappsecurity.com.cn/favicon.png">
	<title>安全星图平台</title>
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

	<!-- This site is optimized with the Yoast SEO plugin v21.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack -    安恒威胁情报中心</title>
	<meta name="description" content="In December 2020, DBAPPSecurity Threat Intelligence Center found a new component of BITTER APT. Further analysis into this component led us to uncover a zero-day vulnerability in win32kfull.sys. The origin in-the-wild sample was designed to target newest Windows10 1909 64-bits operating system at that time. The vulnerability also affects and could be exploited on the latest Windows10 20H2 64-bits operating system. We reported this vulnerability to MSRC, and it is fixed as CVE-2021-1732 in the February 2021 Security Update." />
	<link rel="canonical" href="https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/" />
	<meta property="og:locale" content="zh_CN" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack -    安恒威胁情报中心" />
	<meta property="og:description" content="In December 2020, DBAPPSecurity Threat Intelligence Center found a new component of BITTER APT. Further analysis into this component led us to uncover a zero-day vulnerability in win32kfull.sys. The origin in-the-wild sample was designed to target newest Windows10 1909 64-bits operating system at that time. The vulnerability also affects and could be exploited on the latest Windows10 20H2 64-bits operating system. We reported this vulnerability to MSRC, and it is fixed as CVE-2021-1732 in the February 2021 Security Update." />
	<meta property="og:url" content="https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/" />
	<meta property="og:site_name" content="   安恒威胁情报中心" />
	<meta property="article:published_time" content="2021-02-10T00:12:00+00:00" />
	<meta property="article:modified_time" content="2021-02-10T00:13:07+00:00" />
	<meta property="og:image" content="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44.png" />
	<meta name="author" content="猎影实验室" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="作者" />
	<meta name="twitter:data1" content="猎影实验室" />
	<meta name="twitter:label2" content="预计阅读时间" />
	<meta name="twitter:data2" content="12 分" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/","url":"https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/","name":"Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack -    安恒威胁情报中心","isPartOf":{"@id":"https://starmap.dbappsecurity.com.cn/blog/#website"},"primaryImageOfPage":{"@id":"https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/#primaryimage"},"image":{"@id":"https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/#primaryimage"},"thumbnailUrl":"https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44.png","datePublished":"2021-02-10T00:12:00+00:00","dateModified":"2021-02-10T00:13:07+00:00","author":{"@id":"https://starmap.dbappsecurity.com.cn/blog/#/schema/person/bf2cd9d8253773ba33082f45928ffae1"},"description":"In December 2020, DBAPPSecurity Threat Intelligence Center found a new component of BITTER APT. Further analysis into this component led us to uncover a zero-day vulnerability in win32kfull.sys. The origin in-the-wild sample was designed to target newest Windows10 1909 64-bits operating system at that time. The vulnerability also affects and could be exploited on the latest Windows10 20H2 64-bits operating system. We reported this vulnerability to MSRC, and it is fixed as CVE-2021-1732 in the February 2021 Security Update.","breadcrumb":{"@id":"https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/#breadcrumb"},"inLanguage":"zh-CN","potentialAction":[{"@type":"ReadAction","target":["https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/"]}]},{"@type":"ImageObject","inLanguage":"zh-CN","@id":"https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/#primaryimage","url":"https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44.png","contentUrl":"https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44.png","width":1154,"height":754},{"@type":"BreadcrumbList","@id":"https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"首页","item":"https://starmap.dbappsecurity.com.cn/blog/"},{"@type":"ListItem","position":2,"name":"Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack"}]},{"@type":"WebSite","@id":"https://starmap.dbappsecurity.com.cn/blog/#website","url":"https://starmap.dbappsecurity.com.cn/blog/","name":"安恒威胁情报中心","description":"","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://starmap.dbappsecurity.com.cn/blog/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"zh-CN"},{"@type":"Person","@id":"https://starmap.dbappsecurity.com.cn/blog/#/schema/person/bf2cd9d8253773ba33082f45928ffae1","name":"猎影实验室","image":{"@type":"ImageObject","inLanguage":"zh-CN","@id":"https://starmap.dbappsecurity.com.cn/blog/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/f0256006f69c840c69a99e2c5721e3ca?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/f0256006f69c840c69a99e2c5721e3ca?s=96&d=mm&r=g","caption":"猎影实验室"},"url":"https://starmap.dbappsecurity.com.cn/blog/articles/author/admin/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//starmap.dbappsecurity.com.cn' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="    安恒威胁情报中心 &raquo; Feed" href="https://starmap.dbappsecurity.com.cn/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="    安恒威胁情报中心 &raquo; 评论 Feed" href="https://starmap.dbappsecurity.com.cn/blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="    安恒威胁情报中心 &raquo; Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack 评论 Feed" href="https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/starmap.dbappsecurity.com.cn\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://starmap.dbappsecurity.com.cn/blog/wp-includes/css/dist/block-library/style.min.css?ver=6.6.1' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='bootstrap-css' href='https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/css/bootstrap.css?ver=6.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css' href='https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/font-awesome/css/font-awesome.min.css?ver=6.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='nisarg-style-css' href='https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/style.css?ver=6.6.1' type='text/css' media='all' />
<style id='nisarg-style-inline-css' type='text/css'>
	/* Color Scheme */

	/* Accent Color */

	a:active,
	a:hover,
	a:focus {
	    color: #009688;
	}

	.main-navigation .primary-menu > li > a:hover, .main-navigation .primary-menu > li > a:focus {
		color: #009688;
	}
	
	.main-navigation .primary-menu .sub-menu .current_page_item > a,
	.main-navigation .primary-menu .sub-menu .current-menu-item > a {
		color: #009688;
	}
	.main-navigation .primary-menu .sub-menu .current_page_item > a:hover,
	.main-navigation .primary-menu .sub-menu .current_page_item > a:focus,
	.main-navigation .primary-menu .sub-menu .current-menu-item > a:hover,
	.main-navigation .primary-menu .sub-menu .current-menu-item > a:focus {
		background-color: #fff;
		color: #009688;
	}
	.dropdown-toggle:hover,
	.dropdown-toggle:focus {
		color: #009688;
	}

	@media (min-width: 768px){
		.main-navigation .primary-menu > .current_page_item > a,
		.main-navigation .primary-menu > .current_page_item > a:hover,
		.main-navigation .primary-menu > .current_page_item > a:focus,
		.main-navigation .primary-menu > .current-menu-item > a,
		.main-navigation .primary-menu > .current-menu-item > a:hover,
		.main-navigation .primary-menu > .current-menu-item > a:focus,
		.main-navigation .primary-menu > .current_page_ancestor > a,
		.main-navigation .primary-menu > .current_page_ancestor > a:hover,
		.main-navigation .primary-menu > .current_page_ancestor > a:focus,
		.main-navigation .primary-menu > .current-menu-ancestor > a,
		.main-navigation .primary-menu > .current-menu-ancestor > a:hover,
		.main-navigation .primary-menu > .current-menu-ancestor > a:focus {
			border-top: 4px solid #009688;
		}
		.main-navigation ul ul a:hover,
		.main-navigation ul ul a.focus {
			color: #fff;
			background-color: #009688;
		}
	}

	.main-navigation .primary-menu > .open > a, .main-navigation .primary-menu > .open > a:hover, .main-navigation .primary-menu > .open > a:focus {
		color: #009688;
	}

	.main-navigation .primary-menu > li > .sub-menu  li > a:hover,
	.main-navigation .primary-menu > li > .sub-menu  li > a:focus {
		color: #fff;
		background-color: #009688;
	}

	@media (max-width: 767px) {
		.main-navigation .primary-menu .open .sub-menu > li > a:hover {
			color: #fff;
			background-color: #009688;
		}
	}

	.sticky-post{
		color: #fff;
	    background: #009688; 
	}
	
	.entry-title a:hover,
	.entry-title a:focus{
	    color: #009688;
	}

	.entry-header .entry-meta::after{
	    background: #009688;
	}

	.fa {
		color: #009688;
	}

	.btn-default{
		border-bottom: 1px solid #009688;
	}

	.btn-default:hover, .btn-default:focus{
	    border-bottom: 1px solid #009688;
	    background-color: #009688;
	}

	.nav-previous:hover, .nav-next:hover{
	    border: 1px solid #009688;
	    background-color: #009688;
	}

	.next-post a:hover,.prev-post a:hover{
	    color: #009688;
	}

	.posts-navigation .next-post a:hover .fa, .posts-navigation .prev-post a:hover .fa{
	    color: #009688;
	}


	#secondary .widget-title::after{
		position: absolute;
	    width: 50px;
	    display: block;
	    height: 4px;    
	    bottom: -15px;
		background-color: #009688;
	    content: "";
	}

	#secondary .widget a:hover,
	#secondary .widget a:focus{
		color: #009688;
	}

	#secondary .widget_calendar tbody a {
		color: #fff;
		padding: 0.2em;
	    background-color: #009688;
	}

	#secondary .widget_calendar tbody a:hover{
		color: #fff;
	    padding: 0.2em;
	    background-color: #009688;  
	}	

</style>
<link rel='stylesheet' id='nisarggooglefonts-css' href='//fonts.googleapis.com/css?family=Lato:400,300italic,700|Source+Sans+Pro:400,400italic' type='text/css' media='all' />
<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<!--[if lt IE 9]>
<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/js/html5shiv.js?ver=3.7.3" id="html5shiv-js"></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://starmap.dbappsecurity.com.cn/blog/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://starmap.dbappsecurity.com.cn/blog/wp-json/wp/v2/posts/1519" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://starmap.dbappsecurity.com.cn/blog/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://starmap.dbappsecurity.com.cn/blog/?p=1519' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://starmap.dbappsecurity.com.cn/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fstarmap.dbappsecurity.com.cn%2Fblog%2Farticles%2F2021%2F02%2F10%2Fwindows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://starmap.dbappsecurity.com.cn/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fstarmap.dbappsecurity.com.cn%2Fblog%2Farticles%2F2021%2F02%2F10%2Fwindows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack%2F&#038;format=xml" />

<style type="text/css">
        .site-header { background: ; }
</style>

		<style type="text/css" id="nisarg-header-css">
					.site-header{
				-webkit-box-shadow: 0px 0px 1px 1px rgba(182,182,182,0.3);
		    	-moz-box-shadow: 0px 0px 1px 1px rgba(182,182,182,0.3);
		    	-o-box-shadow: 0px 0px 1px 1px rgba(182,182,182,0.3);
		    	box-shadow: 0px 0px 1px 1px rgba(182,182,182,0.3);
			}
			.site-header {
					height: 300px;
				}
				@media (max-width: 767px) {
					.site-header {
						height: 200px;
					}
				}
				@media (max-width: 359px) {
					.site-header {
						height: 150px;
					}
				}
					.site-title,
			.site-description {
				position: absolute;
				clip: rect(1px 1px 1px 1px); /* IE7 */
				clip: rect(1px, 1px, 1px, 1px);
			}
					.site-header .home-link {
				min-height: 0;
			}
					.site-title,
			.site-description {
				color: #blank;
			}
			.site-title::after{
				background: #blank;
				content:"";
			}
		</style>
				<style type="text/css" id="wp-custom-css">
			.site-content-contain {
  padding-top: 30px
}

html, body {
  padding: 0;
  margin: 0;
}


a {
  text-decoration: none;
}
.navbar-wrapper {
  height: 2.917vw;
  width: 100%;
  display: flex;
  align-items: center;
  padding: 0 3.333vw;
  top: 0;
  z-index: 999;
  background-image: url("https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/08/nav-bg.png");
  min-width: 1050px;
}
.navbar-wrapper * {
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}
.navbar-wrapper .logo-wrapper {
  display: flex;
  align-items: center;
  cursor: pointer;
}
.navbar-wrapper .logo-wrapper .logo-img {
  width: 1.389vw;
}
.navbar-wrapper .logo-wrapper .logo-text {
  font-size: .972vw;
  font-weight: 700;
  color: #ffffff;
  margin-left: .694vw;
}
.navbar-wrapper .nav-ul {
  height: 100%;
  display: flex;
}
.navbar-wrapper .nav-ul .nav-li {
  display: flex;
  align-items: center;
  margin-left: 2.222vw;
  cursor: pointer;
  position: relative;
}
.navbar-wrapper .nav-ul .nav-li span {
  font-size: .833vw;
  padding: .556vw .208vw;
  font-weight: 400;
  color: #ffffff;
}
.navbar-wrapper .nav-ul .nav-li.is-active span {
  border-bottom: 2px solid #fff;
}
.navbar-wrapper .nav-ul .nav-li:hover .submenu .sub-item {
  display: block;
}
.navbar-wrapper .nav-ul .nav-li .submenu {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  top: 100%;
  z-index: 999;
}
.navbar-wrapper .nav-ul .nav-li .submenu .sub-item {
  cursor: pointer;
  display: none;
  background: #3e494e;
  margin-top: 1px;
  transition: all 0.5s;
  height: 2.083vw;
  width: 4.861vw;
  font-size: .833vw;
  text-align: center;
  line-height: 2.083vw;
  font-weight: 400;
  color: #ffffff;
}
.navbar-wrapper .nav-ul .nav-li .submenu .sub-item:hover {
  background: #49bcff;
}
.navbar-wrapper .login-wrapper {
  flex: 1 1 auto;
  display: flex;
  justify-content: flex-end;
}

@media screen and (max-width: 1440px) {

  .navbar-wrapper {
    height: 42px;
    width: 100%;
    display: flex;
    align-items: center;
    padding: 0 48px;
    top: 0;
    z-index: 999;
    background-image: url("https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/08/nav-bg.png");
    min-width: 1050px;
  }
  .navbar-wrapper * {
    padding: 0;
    margin: 0;
    box-sizing: border-box;
  }
  .navbar-wrapper .logo-wrapper {
    display: flex;
    align-items: center;
    cursor: pointer;
  }
  .navbar-wrapper .logo-wrapper .logo-img {
    width: 20px;
  }
  .navbar-wrapper .logo-wrapper .logo-text {
    font-size: 14px;
    font-weight: 700;
    color: #ffffff;
    margin-left: 10px;
  }
  .navbar-wrapper .nav-ul {
    height: 100%;
    display: flex;
  }
  .navbar-wrapper .nav-ul .nav-li {
    display: flex;
    align-items: center;
    margin-left: 32px;
    cursor: pointer;
    position: relative;
  }
  .navbar-wrapper .nav-ul .nav-li span {
    font-size: 12px;
    padding: 8px 3px;
    font-weight: 400;
    color: #ffffff;
  }
  .navbar-wrapper .nav-ul .nav-li.is-active span {
    border-bottom: 2px solid #fff;
  }
  .navbar-wrapper .nav-ul .nav-li:hover .submenu .sub-item {
    display: block;
  }
  .navbar-wrapper .nav-ul .nav-li .submenu {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 100%;
    z-index: 999;
  }
  .navbar-wrapper .nav-ul .nav-li .submenu .sub-item {
    cursor: pointer;
    display: none;
    background: #3e494e;
    margin-top: 1px;
    transition: all 0.5s;
    height: 30px;
    width: 70px;
    font-size: 12px;
    text-align: center;
    line-height: 30px;
    font-weight: 400;
    color: #ffffff;
  }
  .navbar-wrapper .nav-ul .nav-li .submenu .sub-item:hover {
    background: #49bcff;
  }
}

.footer-wrapper {
  height: 13.542vw;
  position: relative;
  background: #fafafa;
  font-size: .833vw;
  font-weight: 400;
  color: #192024;
  box-sizing: border-box;
}

.footer-wrapper * {
  box-sizing: border-box;
}

.footer-wrapper .center-wrapper {
  display: flex;
  width: 72.917vw;
  margin: 0 auto;
}

.footer-wrapper .center-wrapper .company-info {
  width: 28.472vw;
}

.footer-wrapper .center-wrapper .company-info .company-logo {
  margin-top: 2.431vw;
  width: 5.625vw;
}

.footer-wrapper .center-wrapper .company-info .copyright {
  width: 100%;
  margin-top: 1.042vw;
  line-height: 1.25vw;
}

.footer-wrapper .center-wrapper .company-info .record {
  margin-top: 1.458vw;
}

.footer-wrapper .center-wrapper .company-info .record span {
  margin-right: 1.667vw;
  color: #192024;
}

.footer-wrapper .center-wrapper .product-info {
  width: 34.167vw;
}

.footer-wrapper .center-wrapper .footer-title {
  margin-top: 3.611vw;
  font-weight: 700;
  color: #192024;
  line-height: 1;
  font-size: .833vw;
}

.footer-wrapper .center-wrapper .product-info .product-container {
  display: flex;
  flex-wrap: wrap;
  margin-top: .625vw;
  width: 30vw;
}

.footer-wrapper .center-wrapper .product-info .product-container .product-item {
  margin-top: 1.25vw;
}

.footer-wrapper .center-wrapper .product-info .product-container .product-item0 {
  width: 9.097vw;
}

.footer-wrapper .center-wrapper .product-info .product-container .product-item1 {
  padding-left: 1.597vw;
  width: 11.111vw;
  position: relative;
}

.footer-wrapper .center-wrapper .product-info .product-container .product-item1::before {
  content: " ";
  height: 0.694vw;
  width: 0;
  display: inline-block;
  position: absolute;
  top: 50%;
  border-left: 1px solid #c0cedb;
  transform: translateY(-50%);
  left: 0;
}

.footer-wrapper .center-wrapper .product-info .product-container .product-item1::after {
  content: " ";
  height: 0.694vw;
  width: 0;
  display: inline-block;
  position: absolute;
  top: 50%;
  border-left: 1px solid #c0cedb;
  transform: translateY(-50%);
  right: 0;
}

.footer-wrapper .center-wrapper .product-info .product-container .product-item2 {
  padding-left: 1.458vw;
}

.footer-wrapper .center-wrapper .contact-us .contact-container {
  margin-top: .833vw;
}

.footer-wrapper .center-wrapper .contact-us .contact-container a {
  text-decoration: none;
  display: flex;
  align-items: center;
  color: #1d2029;
}

.footer-wrapper .center-wrapper .contact-us .contact-container .qcode {
  width: 4.931vw;
  margin-top: .278vw;
}

@media screen and (max-width: 1440px) {
  .footer-wrapper {
    height: 195px;
    position: relative;
    background: #fafafa;
    font-size: 12px;
    font-weight: 400;
    color: #192024;
  }

  .footer-wrapper .center-wrapper {
    display: flex;
    width: 1050px;
    margin: 0 auto;
  }

  .footer-wrapper .center-wrapper .footer-title {
    margin-top: 52px;
    font-weight: 400;
    color: #192024;
    line-height: 1;
    font-size: 12px;
  }

  .footer-wrapper .center-wrapper .company-info {
    width: 410px;
  }

  .footer-wrapper .center-wrapper .company-info .company-logo {
    margin-top: 35px;
    width: 81px;
  }

  .footer-wrapper .center-wrapper .company-info .copyright {
    width: 100%;
    margin-top: 15px;
    line-height: 18px;
  }

  .footer-wrapper .center-wrapper .company-info .record {
    margin-top: 21px;
  }

  .footer-wrapper .center-wrapper .company-info .record span {
    margin-right: 24px;
    font-size: 12px;
  }

  .footer-wrapper .center-wrapper .product-info {
    width: 492px;
  }

  .footer-wrapper .center-wrapper .product-info .product-container {
    display: flex;
    flex-wrap: wrap;
    margin-top: 9px;
    width: 432px;
  }

  .footer-wrapper .center-wrapper .product-info .product-container .product-item {
    margin-top: 18px;
  }

  .footer-wrapper .center-wrapper .product-info .product-container .product-item0 {
    width: 131px;
  }

  .footer-wrapper .center-wrapper .product-info .product-container .product-item1 {
    padding-left: 23px;
    width: 160px;
    position: relative;
  }

  .footer-wrapper .center-wrapper .product-info .product-container .product-item1::before {
    content: " ";
    height: 10px;
    width: 0;
    display: inline-block;
    position: absolute;
    top: 50%;
    border-left: 1px solid #c0cedb;
    transform: translateY(-50%);
    left: 0;
  }

  .footer-wrapper .center-wrapper .product-info .product-container .product-item1::after {
    content: " ";
    height: 10px;
    width: 0;
    display: inline-block;
    position: absolute;
    top: 50%;
    border-left: 1px solid #c0cedb;
    transform: translateY(-50%);
    right: 0;
  }

  .footer-wrapper .center-wrapper .product-info .product-container .product-item2 {
    padding-left: 21px;
  }

  .footer-wrapper .center-wrapper .contact-us .contact-container {
    margin-top: 12px;
  }

  .footer-wrapper .center-wrapper .contact-us .contact-container a {
    text-decoration: none;
    display: flex;
    align-items: center;
    color: #1d2029;
  }

  .footer-wrapper .center-wrapper .contact-us .contact-container a i {
    margin-right: 5px;
    font-size: 14px;
  }

  .footer-wrapper .center-wrapper .contact-us .contact-container .qcode {
    width: 71px;
    margin-top: 4px;
  }
}
		</style>
		</head>

<body data-rsssl=1 class="post-template-default single single-post postid-1519 single-format-standard group-blog">
   <div class="navbar-wrapper">
      <a href="/" class="logo-wrapper"><img src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2023/01/logo-6.png" alt="安全星图平台" class="logo-img" />
       <div class="logo-text">
        安全星图平台
       </div></a> 
      <div class="nav-ul">
       <a href="/" class="nav-li"><span>平台首页</span></a>
       <a href="/info" class="nav-li"><span>情报社区</span></a>
       <a href="/vul" class="nav-li"><span>漏洞情报</span></a>
       <a href="/blog" class="nav-li is-active"><span>安全研究</span></a>
       <a href="/sandbox" class="nav-li"><span>云沙盒</span></a>
       <!-- <a href="/sdk_page" class="nav-li"><span>高级接口</span></a> -->
       <div class="nav-li">
        <span>APT组织</span> 
        <div class="submenu">
         <a href="/apt/map" class="sub-item"> 全景图</a> 
         <a href="/apt/list" class="sub-item">组织列表</a>
        </div>
       </div>
      </div>
     </div>

	
	<div class="site-content-contain">
		<div id="content" class="site-content">

	<div class="container">
		<div class="row">
			<div id="primary" class="col-md-9 content-area">
				<main id="main" role="main">

									
					
<article id="post-1519"  class="post-content post-1519 post type-post status-publish format-standard hentry category-apt">

	
	
	<header class="entry-header">
		<span class="screen-reader-text">Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack</span>
					<h1 class="entry-title">Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack</h1>
		
				<div class="entry-meta">
			<h5 class="entry-date"><i class="fa fa-calendar-o"></i> <a href="https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/" title="上午8:12" rel="bookmark"><time class="entry-date" datetime="2021-02-10T08:12:00+08:00" pubdate>2021年2月10日 </time></a><span class="byline"><span class="sep"></span><i class="fa fa-user"></i>
<span class="author vcard"><a class="url fn n" href="https://starmap.dbappsecurity.com.cn/blog/articles/author/admin/" title="View all posts by 猎影实验室" rel="author">猎影实验室</a></span></span> <i class="fa fa-comments-o"></i><span class="screen-reader-text">Comments </span> <a href="https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/#respond" class="comments-link" >0 Comment</a>&nbsp;&nbsp;&nbsp;94,081 次浏览</h5>
		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

			<div class="entry-content">
				<h2>Background</h2>
<p>In December 2020, DBAPPSecurity Threat Intelligence Center found a new component of BITTER APT. Further analysis into this component led us to uncover a zero-day vulnerability in win32kfull.sys. The origin in-the-wild sample was designed to target newest Windows10 1909 64-bits operating system at that time. The vulnerability also affects and could be exploited on the latest Windows10 20H2 64-bits operating system. We reported this vulnerability to MSRC, and it is fixed as CVE-2021-1732 in the February 2021 Security Update.</p>
<p>So far, we have detected a very limited number of attacks using this vulnerability. The victims are located in China.</p>
<h2>Timeline</h2>
<ul>
<li>· 2020/12/10: DBAPPSecurity Threat Intelligence Center caught a new component of BITTER APT.</li>
<li style="text-align: left;">· 2020/12/15: DBAPPSecurity Threat Intelligence Center uncovered an unknown windows kernel vulnerability in the component and started the root cause analysis.</li>
<li>· 2020/12/29: DBAPPSecurity Threat Intelligence Center reported the vulnerability to MSRC.</li>
<li>· 2020/12/29: MSRC confirmed the report has been received and opened a case for it.</li>
<li>· 2020/12/31: MSRC confirmed the vulnerability is a zero-day and asked for more information.</li>
<li>· 2020/12/31: DBAPPSecurity provided more detail to MSRC.</li>
<li>· 2021/01/06: MSRC thanked for the addition information and started working for a fix for the vulnerability.</li>
<li>· 2021/02/09: MSRC fixes the vulnerability as CVE-2021-1732.</li>
</ul>
<h2>Highlights</h2>
<p>According to our analysis, the in-the-wild zero-day has the following highlights:</p>
<ol>
<li>1. <strong>It targets the latest version of Windows10 operating system</strong>
<ol>
<li>1.1. The in-the-wild sample targets the latest version of Windows10 1909 64-bits operating system (The sample was compiled in May 2020).</li>
<li>1.2. The origin exploit aims to target several Windows 10 versions, from Windows10 1709 to Windows10 1909.</li>
<li>1.3. The origin exploit could be exploited on Windows10 20H2 with minor modifications.</li>
</ol>
</li>
<li>2. <strong>The vulnerability is high quality and the exploit is sophisticated</strong>
<ol>
<li>2.1. The origin exploit bypasses KASLR with the help of the vulnerability feature.</li>
<li>2.2. This is not a UAF vulnerability. The whole exploit process is not involved heap spray or memory reuse. The Type Isolation mitigation can’t mitigate this exploit. It is unable to detect it by Driver Verifier, the in-the-wild sample can exploit successfully when Driver Verifier is turned on. It’s hard to hunt the in-the-wild sample through sandbox.</li>
<li>2.3. The arbitrary read primitive is achieved by vulnerability feature in conjunction with GetMenuBarInfo, which is impressive.</li>
<li>2.4. After achieving arbitrary read/write primitives, the exploit uses Data Only Attack to perform privilege escalation, which can’t be mitigated by current kernel mitigations.</li>
<li>2.5. The success rate of the exploit is almost 100%.</li>
<li>2.6. When finishing exploit, the exploit will restore all key struct members, there will be no BSOD after exploit.</li>
</ol>
</li>
<li>3. <strong>The attacker used it with caution</strong>
<ol>
<li>3.1. Before exploit, the in-the-wild sample detects specific antivirus software.</li>
<li>3.2. The in-the-wild sample performs operating system build version check, if current build version is under than 16535(Windows10 1709), the exploit will never be called.</li>
<li>3.3. The in-the-wild sample was compiled in May 2020, and caught by us in December 2020, it survived at least 7 months. This indirectly reflects the difficulty of capturing such stealthy sample.</li>
</ol>
</li>
</ol>
<h2>Technical Analysis</h2>
<h3>0x00 Trigger Effect</h3>
<p>If we run the in-the-wild sample in the lasted windows10 1909 64-bits environment, we could observe current process initially runs under Medium Integrity Level.</p>
<p><img fetchpriority="high" decoding="async" width="1154" height="754" class="wp-image-1520" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44.png 1154w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44-300x196.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44-1024x669.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44-768x502.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-44-413x270.png 413w" sizes="(max-width: 1154px) 100vw, 1154px" /></p>
<p>After the exploit code executing, we could observe current process runs under System Integrity Level. This indicates that the Token of the current process has been replaced with the Token of System process, which is a common method of exploiting kernel privilege escalation vulnerabilities.</p>
<p><img decoding="async" width="1156" height="752" class="wp-image-1521" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-45.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-45.png 1156w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-45-300x195.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-45-1024x666.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-45-768x500.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-45-415x270.png 415w" sizes="(max-width: 1156px) 100vw, 1156px" /></p>
<p>If we run the in-the-wild sample in the lasted windows10 20H2 64-bits environment, we could observe BSOD immediately.</p>
<p><img decoding="async" width="1238" height="753" class="wp-image-1522" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-46.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-46.png 1238w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-46-300x182.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-46-1024x623.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-46-768x467.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-46-444x270.png 444w" sizes="(max-width: 1238px) 100vw, 1238px" /></p>
<h3>0x01 Overview Of The Vulnerability</h3>
<p>This vulnerability is caused by xxxClientAllocWindowClassExtraBytes callback in win32kfull!xxxCreateWindowEx. The callback causes the setting of a kernel struct member and its corresponding flag to be out of sync.</p>
<p>When xxxCreateWindowEx creating a window that has WndExtra area, it will call xxxClientAllocWindowClassExtraBytes to trigger a callback, the callback will return to user mode to allocate WndExtra area. In the custom callback function, the attacker could call NtUserConsoleControl and pass in the handle of current window, this will change a kernel struct member (which points to the WndExtra area) to offset, and setting a corresponding flag to indicate that the member now is an offset. After that, the attacker could call NtCallbackReturn in the callback and return an arbitrary value. When the callback ends and return to kernel mode, the return value will overwrite the previous offset member, but the corresponding flag is not cleared. After that, the unchecked offset value is directly used by kernel code for heap memory addressing, causing out-of-bounds access.</p>
<h3>0x02 Root Cause</h3>
<p>We completely reversed the exploit code of the in-the-wild sample, and constructed a poc base it. The following figure is the main execution logic of our poc, we will explain the vulnerability trigger logic in conjunction with this figure.</p>
<p><img loading="lazy" decoding="async" width="1849" height="1242" class="wp-image-1523" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-47.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-47.png 1849w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-47-300x202.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-47-1024x688.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-47-768x516.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-47-1536x1032.png 1536w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-47-402x270.png 402w" sizes="(max-width: 1849px) 100vw, 1849px" /></p>
<p>In win32kfull!xxxCreateWindowEx, it will call user32!_xxxClientAllocWindowClassExtraBytes callback function to allocate the memory of WndExtra by default. The return value of the callback is a use mode pointer which will then been saved to a kernel struct member (the WndExtra member).</p>
<p><img loading="lazy" decoding="async" width="1444" height="223" class="wp-image-1524" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-48.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-48.png 1444w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-48-300x46.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-48-1024x158.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-48-768x119.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-48-604x93.png 604w" sizes="(max-width: 1444px) 100vw, 1444px" /></p>
<p>If we call win32kfull!xxxConsoleControl in a custom _xxxClientAllocWindowClassExtraBytes callback and pass in the handle of current window, the WndExtra member will be change to an offset, and a corresponding flag will be set (|=0x800).</p>
<p><img loading="lazy" decoding="async" width="1178" height="707" class="wp-image-1525" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-49.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-49.png 1178w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-49-300x180.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-49-1024x615.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-49-768x461.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-49-450x270.png 450w" sizes="(max-width: 1178px) 100vw, 1178px" /></p>
<p>The poc triggers an BSOD when calling DestoryWindow, win32kfull!xxxFreeWindow will check the flag above, if it has been set, indicating the WndExtra member is an offset, xxxFreeWindow will call RtlFreeHeap to free the WndExtra area; if not, indicating the WndExtra member is an use mode pointer, xxxFreeWindow will call xxxClientFreeWindowClassExtraBytes to free the WndExtra area.</p>
<p><img loading="lazy" decoding="async" width="814" height="753" class="wp-image-1526" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-50.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-50.png 814w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-50-300x278.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-50-768x710.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-50-292x270.png 292w" sizes="(max-width: 814px) 100vw, 814px" /></p>
<p>We could call NtCallbackReturn in the end of custom _xxxClientAllocWindowClassExtraBytes callback and return an arbitrary value. When the callback finishes and return to kernel mode, the return value will overwrite the offset member, but the corresponding flag is not cleared.</p>
<p>In the poc, we return an user mode heap address, the address overwrites the origin offset to an user mode heap address(fake_offset). This finally causes win32kfull!xxxFreeWindow to trigger an out-of-bound access when using RtlFreeHeap to release a kernel heap.</p>
<ul>
<li>What RtlFreeHeap expects to free is RtlHeapBase+offset</li>
<li>What RtlFreeHeap actually free is RtlHeapBase+fake_offset</li>
</ul>
<p><img loading="lazy" decoding="async" width="1967" height="914" class="wp-image-1527" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-51.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-51.png 1967w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-51-300x139.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-51-1024x476.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-51-768x357.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-51-1536x714.png 1536w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-51-581x270.png 581w" sizes="(max-width: 1967px) 100vw, 1967px" /></p>
<p>If we call the RtlFreeHeap here, it will trigger a BSOD.</p>
<p><img loading="lazy" decoding="async" width="1324" height="931" class="wp-image-1528" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-52.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-52.png 1324w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-52-300x211.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-52-1024x720.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-52-768x540.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-52-384x270.png 384w" sizes="(max-width: 1324px) 100vw, 1324px" /></p>
<h3>0x03 Exploit</h3>
<p>The in-the-wild sample is a 64-bits program, it first calls CreateToolhelp32Snapshot and some other functions to enumerate process to detect “avp.exe” (avp.exe is a process of Kaspersky Antivirus Software).</p>
<p><img loading="lazy" decoding="async" width="1246" height="766" class="wp-image-1529" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-53.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-53.png 1246w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-53-300x184.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-53-1024x630.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-53-768x472.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-53-439x270.png 439w" sizes="(max-width: 1246px) 100vw, 1246px" /></p>
<p>However, when detecting the “avp.exe” process, it will only save some value to custom struct and will not exit process, the full exploit function will still be called. We install the Kaspersky antivirus product and run the sample; it will obtain system privileges as usual.</p>
<p><img loading="lazy" decoding="async" width="945" height="322" class="wp-image-1530" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-54.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-54.png 945w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-54-300x102.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-54-768x262.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-54-604x206.png 604w" sizes="(max-width: 945px) 100vw, 945px" /></p>
<p>It then calls IsWow64Process to check whether the current environment is 32-bits or 64-bits, and fix some offsets based on the result. Here the code developer seems make a mistake, according to the source code below, g_x64 should be understood as g_x86, but subsequent calls indicate that this variable represents the 64-bits environment.</p>
<p>However, the code developer forces g_x64 to TRUE at initialization, the call to IsWow64Process actually can be ignored here. But this seems to imply that the developer had also developed another 32-bits version exploit.</p>
<p><img loading="lazy" decoding="async" width="1039" height="483" class="wp-image-1531" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-55.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-55.png 1039w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-55-300x139.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-55-1024x476.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-55-768x357.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-55-581x270.png 581w" sizes="(max-width: 1039px) 100vw, 1039px" /></p>
<p>After fixing some offsets, it obtains the address of RtlGetNtVersionNumbers, NtUserConsoleControl and NtCallbackReturn. Then it calls RtlGetNtVersionNumbers to get the build number of current operating system, the exploit function will only be called when the build number is larger than 16535(Windows10 1709), and if the build number larger than 18204(Windows10 1903), it will fix some kernel struct offset. This seems to imply that support for these versions was added later.</p>
<p><img loading="lazy" decoding="async" width="1052" height="285" class="wp-image-1532" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-56.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-56.png 1052w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-56-300x81.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-56-1024x277.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-56-768x208.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-56-604x164.png 604w" sizes="(max-width: 1052px) 100vw, 1052px" /></p>
<p>If the current environment passes the check, the exploit will be called by the in the wild sample. The exploit first searches bytes to get the address of HmValidateHandle, and hooks USER32!_xxxClientAllocWindowClassExtraBytes to a custom callback function.</p>
<p><img loading="lazy" decoding="async" width="1208" height="346" class="wp-image-1533" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-57.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-57.png 1208w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-57-300x86.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-57-1024x293.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-57-768x220.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-57-604x173.png 604w" sizes="(max-width: 1208px) 100vw, 1208px" /></p>
<p>The exploit then registers two type of windows class. The name of one class is “magicClass”, which is used to create the vulnerability window. The name of another class is “nolmalClass”, which is used to create normal windows which will assist the arbitrary address write primitive later.</p>
<p><img loading="lazy" decoding="async" width="957" height="301" class="wp-image-1534" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-58.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-58.png 957w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-58-300x94.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-58-768x242.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-58-604x190.png 604w" sizes="(max-width: 957px) 100vw, 957px" /></p>
<p>The exploit creates 10 windows using normalClass, and call HmValidateHandle to leak the user mode tagWND address of each window and an offset of each window through the tagWND address. Then the exploit destroys the last 8 windows, only keep the window 0 and window 1.</p>
<p>If current program is 64-bits, the exploit will call NtUserConsoleControl and pass the handle of windows 1, this will change the WndExtra member of window 0 to an offset. The exploit then leaks the kernel tagWND offset of windows 0 for later use.</p>
<p><img loading="lazy" decoding="async" width="937" height="202" class="wp-image-1535" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-59.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-59.png 937w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-59-300x65.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-59-768x166.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-59-604x130.png 604w" sizes="(max-width: 937px) 100vw, 937px" /></p>
<p>Then the exploit uses magicClass to create another window (windows 2), windows 2 has a certain cbWndExtra value which was generated before. In the process of creating window 2, it will trigger the xxxClientAllocWindowClassExtraBytes callback, and enter the custom callback function.</p>
<p>In the custom callback function, the exploit first checks if the cbWndExtra of current window match a certain value, then checks if current process is 64-bits. If both checks pass, the exploit calls NtUserConsoleControl and passes the handle of windows 2, this changes the WndExtra of window 2 to an offset and set the corresponding flag. Then the exploit call NtCallbackReturn and pass the kernel tagWND offset of windows 0. When return to kernel mode, kernel WndExtra offset of windows 2 will been changed to the kernel tagWND offset of windows 0. This causes the subsequent read/write on the WndExtra area of window 2 to the read/write on the kernel tagWND structure of window 0.</p>
<p><img loading="lazy" decoding="async" width="1062" height="465" class="wp-image-1536" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-60.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-60.png 1062w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-60-300x131.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-60-1024x448.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-60-768x336.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-60-604x264.png 604w" sizes="(max-width: 1062px) 100vw, 1062px" /></p>
<p>After window 2 is created, the exploit obtains the primitive to write the kernel tagWND of window 0 by setting the WndExtra area of window 2. The exploit makes a call to SetWindowLongW on window 2 to test if this primitive works fine.</p>
<p>If all works fine, the exploit calls SetWindowLongW to set cbWndExtra of windows 0 to 0xfffffff, this gives window 0 the OOB read/write primitives. The exploit then using the OOB write primitive to modify the style of window 1(dwStyle|=WS_CHILD), after that, the exploit replaces the origin spmenu of window 1 with a fake spmenu.</p>
<p><img loading="lazy" decoding="async" width="1064" height="403" class="wp-image-1537" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-61.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-61.png 1064w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-61-300x114.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-61-1024x388.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-61-768x291.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-61-604x229.png 604w" sizes="(max-width: 1064px) 100vw, 1064px" /></p>
<p>The arbitrary read primitive is achieved by fake spmenu works with GetMenuBarInfo. The exploit reads a 64-bits value using tagMenuBarInfo.rcBar.left and tagMenuBarInfo.rcBar.top. This method has not been used publicly before, but is similar with the ideas in《LPE vulnerabilities exploitation on Windows 10 Anniversary Update》(ZeroNight, 2016)</p>
<p><img loading="lazy" decoding="async" width="1103" height="48" class="wp-image-1538" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-62.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-62.png 1103w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-62-300x13.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-62-1024x45.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-62-768x33.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-62-604x26.png 604w" sizes="(max-width: 1103px) 100vw, 1103px" /></p>
<p>The arbitrary write primitive is achieved via window 0 and window 1, work with SetWindowLongPtrA, see below.</p>
<p><img loading="lazy" decoding="async" width="1226" height="168" class="wp-image-1539" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-63.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-63.png 1226w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-63-300x41.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-63-1024x140.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-63-768x105.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-63-604x83.png 604w" sizes="(max-width: 1226px) 100vw, 1226px" /></p>
<p>After achieving the arbitrary read/write primitives, the exploit leaks a kernel address from the origin spmemu, then searches through it to find the EPROCESS of current process.</p>
<p>Finally, the exploit traversals ActiveProcessLinks to get the Token of SYSTEM EPROCESS and the Token area address of current EPROCESS, and swaps the current process Token value with SYSTEM Token.</p>
<p><img loading="lazy" decoding="async" width="1091" height="321" class="wp-image-1540" title="" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-64.png" srcset="https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-64.png 1091w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-64-300x88.png 300w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-64-1024x301.png 1024w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-64-768x226.png 768w, https://starmap.dbappsecurity.com.cn/blog/wp-content/uploads/2021/01/word-image-64-604x178.png 604w" sizes="(max-width: 1091px) 100vw, 1091px" /></p>
<p>After achieving privilege escalation, the exploit restores the modified area of window 0, window 1 and window 2 using arbitrary write primitive, such as the origin spmenu of window 1 and the flag of window 2, to ensure that it will not cause a BSOD. The entire exploit process is very stable.</p>
<h3>0x04 Conclusion</h3>
<p>This zero-day is a new vulnerability which caused by win32k callback, it could be used to escape the sandbox of Microsoft IE browser or Adobe Reader on the lasted Windows 10 version. The quality of this vulnerability high and the exploit is sophisticated. The use of this in-the-wild zero-day reflects the organization’s strong vulnerability reserve capability. The threat organization may have recruited members with certain strength, or buying it from vulnerability brokers.</p>
<h2>Summary</h2>
<p>Zero-day plays a pivotal role in cyberspace. It is usually used as a strategic reserve for threat organizations and has a special mission and strategic significance.With the iteration of software/hardware and the improvement of the defense system, the cost of mining and exploiting software/hardware zero-day is getting higher and higher.</p>
<p>Over the years, vendors over the world have investment a lot on detecting APT attacks. This makes the APT organization more cautious in the use of zero-day. In order to maximize its value, it will only be used for very few specific targets. A little carelessness will shorten the life cycle of a zero-day. Meanwhile, some zero-days have been lurking for a long time before being exposed, the most remarkable example is the MS17-010 used by EternalBlue,</p>
<p>Over the last year (2020), dozens of 0Day/1Day attacks in the wild were disclosed globally, including three attacks which tracked by DBAPPSecurity Threat Intelligence Center. Based on the data we have, we predict there will be more zero-day disclose on browser and privilege escalation in 2021.</p>
<p>The detection capability on zero-day is one of key aspect that requires continuous improvement in the APT confrontation process. In addition to endpoint attacks, the attacks on boundary systems, critical equipment, and centralized control systems are also worth noting. There are also several security incidents in these areas over the past years.</p>
<p>Being undiscovered does not mean that it does not exist, it may be more in a stealthy state. The discovery, detection and defense of advanced threats attacks require constant iteration and strengthening during the game. It’s necessary to think more about how to strengthen the defense capabilities in all points, lines and surfaces. Cyber security has a long way to go, and we need to encourage each other.</p>
<h2>How To Defend Against Such Attacks</h2>
<p>The <a href="http://dbappsecurity.com/html/show-62-4-1.html">DBAPPSecurity APT Attack Early Warning Platform</a> could find known/unknown threat. The platform can monitor, capture and analyze the threats of malicious files or programs in real time, and can conduct powerful monitoring of malicious samples such as Trojan horses associated with each stage of email delivery, vulnerability exploitation, installation/implantation and C2.</p>
<p>At the same time, the platform conducts in-depth analysis of network traffic based on two-way traffic analysis, intelligent machine learning, efficient sandbox dynamic analysis, rich signature libraries, comprehensive detection strategies, and massive threat intelligence data. The detection capability completely covers the entire APT attack chain, effectively discovering APT attacks, unknown threats and network security incidents that users care about.</p>
<h2>Yara Rule</h2>


<pre class="wp-block-code"><code>rule apt_bitter_win32k_0day {
    meta:
        author = "dbappsecurity_lieying_lab"
        data = "01-01-2021"

    strings:
        $s1 = "NtUserConsoleControl" ascii wide
        $s2 = "NtCallbackReturn" ascii wide
        $s3 = "CreateWindowEx" ascii wide
        $s4 = "SetWindowLong" ascii wide

        $a1 = {48 C1 E8 02 48 C1 E9 02 C7 04 8A}
        $a2 = {66 0F 1F 44 00 00 80 3C 01 E8 74 22 FF C2 48 FF C1}
        $a3 = {48 63 05 CC 69 05 00 8B 0D C2 69 05 00 48 C1 E0 20 48 03 C1}

    condition:
        uint16(0) == 0x5a4d and all of ($s*) and 1 of ($a*)
}</code></pre>

							</div><!-- .entry-content -->

	<footer class="entry-footer">
		<hr><div class="row"><div class="col-md-6 cattegories"><span class="cat-links"><i class="fa fa-folder-open"></i>
		 <a href="https://starmap.dbappsecurity.com.cn/blog/articles/category/apt/" rel="category tag">apt分析</a></span></div></div>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
				</main><!-- #main -->
				<div class="post-navigation">
						<nav class="navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links">
			<div class="row">

			<!-- Get Previous Post -->
			
							<div class="col-md-6 prev-post">
					<a class="" href="https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack-cn/">
						<span class="next-prev-text">
							<i class="fa fa-angle-left"></i> PREVIOUS 						</span><br>
						0Day攻击！首次发现蔓灵花组织在针对国内的攻击活动中使用Windows内核提权0Day漏洞（CVE-2021-1732）					</a>
				</div>
			
			<!-- Get Next Post -->
			
							<div class="col-md-6 next-post">
					<a class="" href="https://starmap.dbappsecurity.com.cn/blog/articles/2021/05/10/darkside/">
						<span class="next-prev-text">
							 NEXT <i class="fa fa-angle-right"></i>
						</span><br>
						美国成品油管道运营商遭勒索软件攻击停运事件分析					</a>
				</div>
						
			</div><!-- row -->
		</div><!-- .nav-links -->
	</nav><!-- .navigation-->
					</div>
				<div class="post-comments">
									</div>
							</div><!-- #primary -->
			<div id="secondary" class="col-md-3 sidebar widget-area" role="complementary">
		<aside id="archives-2" class="widget widget_archive"><h4 class="widget-title">归档</h4>
			<ul>
					<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2024/08/'>2024 年 8 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2024/07/'>2024 年 7 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2024/03/'>2024 年 3 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2024/02/'>2024 年 2 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2024/01/'>2024 年 1 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/11/'>2023 年 11 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/10/'>2023 年 10 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/09/'>2023 年 9 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/08/'>2023 年 8 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/07/'>2023 年 7 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/06/'>2023 年 6 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/05/'>2023 年 5 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/04/'>2023 年 4 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/03/'>2023 年 3 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/02/'>2023 年 2 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2023/01/'>2023 年 1 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/11/'>2022 年 11 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/10/'>2022 年 10 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/08/'>2022 年 8 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/07/'>2022 年 7 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/06/'>2022 年 6 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/05/'>2022 年 5 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/04/'>2022 年 4 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/03/'>2022 年 3 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2022/01/'>2022 年 1 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/11/'>2021 年 11 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/10/'>2021 年 10 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/09/'>2021 年 9 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/08/'>2021 年 8 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/07/'>2021 年 7 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/06/'>2021 年 6 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/05/'>2021 年 5 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/'>2021 年 2 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2021/01/'>2021 年 1 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/12/'>2020 年 12 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/11/'>2020 年 11 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/10/'>2020 年 10 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/09/'>2020 年 9 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/08/'>2020 年 8 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/07/'>2020 年 7 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/06/'>2020 年 6 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/05/'>2020 年 5 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/04/'>2020 年 4 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/03/'>2020 年 3 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2020/02/'>2020 年 2 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2019/11/'>2019 年 11 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2019/10/'>2019 年 10 月</a></li>
	<li><a href='https://starmap.dbappsecurity.com.cn/blog/articles/2019/08/'>2019 年 8 月</a></li>
			</ul>

			</aside><aside id="categories-2" class="widget widget_categories"><h4 class="widget-title">分类</h4>
			<ul>
					<li class="cat-item cat-item-1"><a href="https://starmap.dbappsecurity.com.cn/blog/articles/category/apt/">apt分析</a>
</li>
	<li class="cat-item cat-item-89"><a href="https://starmap.dbappsecurity.com.cn/blog/articles/category/%e4%b8%93%e9%a2%98%e5%88%86%e6%9e%90/">专题分析</a>
</li>
	<li class="cat-item cat-item-46"><a href="https://starmap.dbappsecurity.com.cn/blog/articles/category/serious-incident/">安全事件</a>
</li>
	<li class="cat-item cat-item-45"><a href="https://starmap.dbappsecurity.com.cn/blog/articles/category/exploit/">漏洞分析</a>
</li>
	<li class="cat-item cat-item-44"><a href="https://starmap.dbappsecurity.com.cn/blog/articles/category/pentest/">红蓝对抗</a>
</li>
			</ul>

			</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h4 class="widget-title">标签</h4><div class="tagcloud"><a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/0day/" class="tag-cloud-link tag-link-74 tag-link-position-1" style="font-size: 11.733333333333pt;" aria-label="0day (4 项)">0day</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/apt/" class="tag-cloud-link tag-link-6 tag-link-position-2" style="font-size: 22pt;" aria-label="APT (62 项)">APT</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/apt37/" class="tag-cloud-link tag-link-167 tag-link-position-3" style="font-size: 9.68pt;" aria-label="apt37 (2 项)">apt37</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/bitter/" class="tag-cloud-link tag-link-7 tag-link-position-4" style="font-size: 13.133333333333pt;" aria-label="BITTER (6 项)">BITTER</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/confucius/" class="tag-cloud-link tag-link-141 tag-link-position-5" style="font-size: 9.68pt;" aria-label="Confucius (2 项)">Confucius</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/conti/" class="tag-cloud-link tag-link-93 tag-link-position-6" style="font-size: 9.68pt;" aria-label="Conti (2 项)">Conti</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/cve-2023-38831/" class="tag-cloud-link tag-link-193 tag-link-position-7" style="font-size: 9.68pt;" aria-label="CVE-2023-38831 (2 项)">CVE-2023-38831</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/donot/" class="tag-cloud-link tag-link-36 tag-link-position-8" style="font-size: 11.733333333333pt;" aria-label="DONOT (4 项)">DONOT</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/evilnum/" class="tag-cloud-link tag-link-106 tag-link-position-9" style="font-size: 9.68pt;" aria-label="evilnum (2 项)">evilnum</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/grp-ly-1001/" class="tag-cloud-link tag-link-135 tag-link-position-10" style="font-size: 9.68pt;" aria-label="GRP-LY-1001 (2 项)">GRP-LY-1001</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/hades/" class="tag-cloud-link tag-link-4 tag-link-position-11" style="font-size: 9.68pt;" aria-label="Hades (2 项)">Hades</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/lazarus/" class="tag-cloud-link tag-link-65 tag-link-position-12" style="font-size: 12.48pt;" aria-label="lazarus (5 项)">lazarus</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/lockbit/" class="tag-cloud-link tag-link-194 tag-link-position-13" style="font-size: 9.68pt;" aria-label="lockbit (2 项)">lockbit</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/ninikachu/" class="tag-cloud-link tag-link-9 tag-link-position-14" style="font-size: 8pt;" aria-label="Ninikachu (1 项)">Ninikachu</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/oceanlotus/" class="tag-cloud-link tag-link-8 tag-link-position-15" style="font-size: 8pt;" aria-label="OceanLotus (1 项)">OceanLotus</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/olympic-destroyer/" class="tag-cloud-link tag-link-5 tag-link-position-16" style="font-size: 8pt;" aria-label="Olympic Destroyer (1 项)">Olympic Destroyer</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/patchwork/" class="tag-cloud-link tag-link-114 tag-link-position-17" style="font-size: 9.68pt;" aria-label="Patchwork (2 项)">Patchwork</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/phishing/" class="tag-cloud-link tag-link-41 tag-link-position-18" style="font-size: 10.8pt;" aria-label="phishing (3 项)">phishing</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/ransom/" class="tag-cloud-link tag-link-157 tag-link-position-19" style="font-size: 10.8pt;" aria-label="ransom (3 项)">ransom</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/ransomware/" class="tag-cloud-link tag-link-170 tag-link-position-20" style="font-size: 10.8pt;" aria-label="ransomware (3 项)">ransomware</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/revil/" class="tag-cloud-link tag-link-111 tag-link-position-21" style="font-size: 9.68pt;" aria-label="REvil (2 项)">REvil</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/saaiwc-group/" class="tag-cloud-link tag-link-152 tag-link-position-22" style="font-size: 9.68pt;" aria-label="Saaiwc Group (2 项)">Saaiwc Group</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/sangfor/" class="tag-cloud-link tag-link-29 tag-link-position-23" style="font-size: 9.68pt;" aria-label="Sangfor (2 项)">Sangfor</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/scarcruft/" class="tag-cloud-link tag-link-181 tag-link-position-24" style="font-size: 9.68pt;" aria-label="ScarCruft (2 项)">ScarCruft</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/sidecopy/" class="tag-cloud-link tag-link-113 tag-link-position-25" style="font-size: 11.733333333333pt;" aria-label="Sidecopy (4 项)">Sidecopy</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/sidewinder/" class="tag-cloud-link tag-link-18 tag-link-position-26" style="font-size: 10.8pt;" aria-label="SideWinder (3 项)">SideWinder</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/ta505/" class="tag-cloud-link tag-link-11 tag-link-position-27" style="font-size: 8pt;" aria-label="TA505 (1 项)">TA505</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/trickymouse/" class="tag-cloud-link tag-link-2 tag-link-position-28" style="font-size: 8pt;" aria-label="TrickyMouse (1 项)">TrickyMouse</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/vpn/" class="tag-cloud-link tag-link-30 tag-link-position-29" style="font-size: 9.68pt;" aria-label="VPN (2 项)">VPN</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e4%b8%ad%e4%b8%9c/" class="tag-cloud-link tag-link-131 tag-link-position-30" style="font-size: 10.8pt;" aria-label="中东 (3 项)">中东</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e4%bf%84%e7%bd%97%e6%96%af/" class="tag-cloud-link tag-link-109 tag-link-position-31" style="font-size: 11.733333333333pt;" aria-label="俄罗斯 (4 项)">俄罗斯</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%8a%a0%e5%af%86%e8%b4%a7%e5%b8%81/" class="tag-cloud-link tag-link-68 tag-link-position-32" style="font-size: 10.8pt;" aria-label="加密货币 (3 项)">加密货币</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%8b%92%e7%b4%a2/" class="tag-cloud-link tag-link-87 tag-link-position-33" style="font-size: 13.6pt;" aria-label="勒索 (7 项)">勒索</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%8b%92%e7%b4%a2%e5%9b%a2%e4%bc%99/" class="tag-cloud-link tag-link-92 tag-link-position-34" style="font-size: 9.68pt;" aria-label="勒索团伙 (2 项)">勒索团伙</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%8b%92%e7%b4%a2%e8%bd%af%e4%bb%b6/" class="tag-cloud-link tag-link-112 tag-link-position-35" style="font-size: 11.733333333333pt;" aria-label="勒索软件 (4 项)">勒索软件</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%8d%b0%e5%ba%a6/" class="tag-cloud-link tag-link-105 tag-link-position-36" style="font-size: 9.68pt;" aria-label="印度 (2 项)">印度</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%93%8d%e5%b0%be%e8%9b%87/" class="tag-cloud-link tag-link-19 tag-link-position-37" style="font-size: 9.68pt;" aria-label="响尾蛇 (2 项)">响尾蛇</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%9c%9f%e8%80%b3%e5%85%b6/" class="tag-cloud-link tag-link-147 tag-link-position-38" style="font-size: 9.68pt;" aria-label="土耳其 (2 项)">土耳其</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e5%b7%b4%e5%9f%ba%e6%96%af%e5%9d%a6/" class="tag-cloud-link tag-link-117 tag-link-position-39" style="font-size: 11.733333333333pt;" aria-label="巴基斯坦 (4 项)">巴基斯坦</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e6%8b%89%e6%92%92%e8%b7%af/" class="tag-cloud-link tag-link-66 tag-link-position-40" style="font-size: 9.68pt;" aria-label="拉撒路 (2 项)">拉撒路</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e7%ba%a2%e8%93%9d%e5%af%b9%e6%8a%97/" class="tag-cloud-link tag-link-39 tag-link-position-41" style="font-size: 11.733333333333pt;" aria-label="红蓝对抗 (4 项)">红蓝对抗</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e8%94%93%e7%81%b5%e8%8a%b1/" class="tag-cloud-link tag-link-12 tag-link-position-42" style="font-size: 13.133333333333pt;" aria-label="蔓灵花 (6 项)">蔓灵花</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e9%ad%94%e8%8a%8b%e8%a1%8c%e5%8a%a8/" class="tag-cloud-link tag-link-10 tag-link-position-43" style="font-size: 8pt;" aria-label="魔芋行动 (1 项)">魔芋行动</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e9%ad%94%e9%bc%a0%e8%a1%8c%e5%8a%a8/" class="tag-cloud-link tag-link-3 tag-link-position-44" style="font-size: 8pt;" aria-label="魔鼠行动 (1 项)">魔鼠行动</a>
<a href="https://starmap.dbappsecurity.com.cn/blog/articles/tag/%e9%bb%91%e7%81%b0%e4%ba%a7/" class="tag-cloud-link tag-link-177 tag-link-position-45" style="font-size: 10.8pt;" aria-label="黑灰产 (3 项)">黑灰产</a></div>
</aside>
		<aside id="recent-posts-4" class="widget widget_recent_entries">
		<h4 class="widget-title">近期文章</h4>
		<ul>
											<li>
					<a href="https://starmap.dbappsecurity.com.cn/blog/articles/2024/08/12/weiliezhe-apt-group-exploits-multiple-localized-software-vulnerabilities-to-launch-attacks-on-china/">韩国“伪猎者”APT组织利用多款国产化软件漏洞对中国的攻击活动</a>
									</li>
											<li>
					<a href="https://starmap.dbappsecurity.com.cn/blog/articles/2024/07/23/facai-group/">FaCai团伙利用APT技术针对国内的攻击活动分析</a>
									</li>
											<li>
					<a href="https://starmap.dbappsecurity.com.cn/blog/articles/2024/07/11/patchwork-apt-attacks-using-notifications-from-chinese-university-information-offices-as-bait/">Patchwork APT以中国高校信息办通知为诱饵的攻击事件分析</a>
									</li>
											<li>
					<a href="https://starmap.dbappsecurity.com.cn/blog/articles/2024/03/04/apt37-attack-south-korea/">APT37利用朝鲜政治话题针对韩国的攻击活动分析</a>
									</li>
											<li>
					<a href="https://starmap.dbappsecurity.com.cn/blog/articles/2024/02/21/lockbit-under-the-control/">全球最为猖獗的勒索组织LockBit遭到执法部门打击,或将取缔</a>
									</li>
					</ul>

		</aside></div><!-- #secondary .widget-area -->


		</div> <!--.row-->
	</div><!--.container-->
	


<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/js/bootstrap.js?ver=6.6.1" id="bootstrap-js"></script>
<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/js/navigation.js?ver=6.6.1" id="nisarg-navigation-js"></script>
<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/js/skip-link-focus-fix.js?ver=6.6.1" id="nisarg-skip-link-focus-fix-js"></script>
<script type="text/javascript" id="nisarg-js-js-extra">
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-content/themes/nisarg/js/nisarg.js?ver=6.6.1" id="nisarg-js-js"></script>
<script type="text/javascript" src="https://starmap.dbappsecurity.com.cn/blog/wp-includes/js/comment-reply.min.js?ver=6.6.1" id="comment-reply-js" async="async" data-wp-strategy="async"></script>

<div class="footer-wrapper" data-v-0d1fd21e="">
   <div class="center-wrapper">
    <div class="company-info">
     <img alt="安恒信息" class="company-logo" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/08/logo-4.png" />
     <p class="copyright"> 杭州安恒信息技术股份有限公司 - 威胁情报中心 Copyright @ <br />Dbappsecurity All Rights Reserved </p> 
     <div class="record">
      <span>浙ICP备09102757号-1</span> 
      <span>浙公网安备33010802003444号</span>
     </div>
    </div> 
    <div class="product-info">
     <div class="footer-title">
      更多产品
     </div> 
     <div class="product-container">
      <div class="product-item product-item0">
        威胁狩猎平台（THP） 
      </div>
      <div class="product-item product-item1">
        威胁检测平台（TDP） 
      </div>
      <div class="product-item product-item2">
        威胁情报平台（TIP） 
      </div>
      <div class="product-item product-item0">
        威胁情报云API服务 
      </div>
      <div class="product-item product-item1">
        威胁情报SaaS订阅 
      </div>
      <div class="product-item product-item2">
        威胁情报社区订阅 
      </div>
     </div>
    </div> 
    <div class="contact-us">
     <div class="footer-title">
      联系我们
     </div> 
     <div class="contact-container">
      <a href="mailto:ti_support@dbappsecurity.com.cn"><i class="el-icon-message"></i>ti_support@dbappsecurity.com.cn</a> 
      <img alt="安恒信息" class="qcode" src="https://ti.dbappsecurity.com.cn/blog/wp-content/uploads/2021/08/qcode.png"/>
    </div>
    </div>
   </div>
  </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5ceaa896b2dc6006d57f45a9d179ae6f";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<iframe style="width: 1;height: 0;visibility: hidden;" sandbox="allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups-to-escape-sandbox allow-popups allow-presentation allow-same-origin allow-scripts allow-top-navigation" src="https://ti.dbappsecurity.com.cn/4e4408c6390d5ce6d33b8d8d5f638c25.html"></iframe>

</body>
</html>
