<!DOCTYPE html><html
	class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light"
	lang="en-us"
	dir="ltr"
	data-authenticated="false"
	data-auth-status-determined="false"
	data-target="docs"
	x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Sysmon - Sysinternals" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon" /><meta property="og:description" content="Monitors and reports key system activity via the Windows event log." /><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />

	<meta property="og:image:alt" content="Microsoft Learn" />

	<meta name="twitter:card" content="summary_large_image" />

	<meta name="twitter:site" content="@MicrosoftLearn" />

	<meta name="color-scheme" content="light dark"><meta name="author" content="markruss" />
<meta name="breadcrumb_path" content="/sysinternals/bread/toc.json" />
<meta name="depot_name" content="MSDN.sysinternals" />
<meta name="description" content="Monitors and reports key system activity via the Windows event log." />
<meta name="document_id" content="c311f67d-8cee-d839-9ef2-902f8fa95004" />
<meta name="document_version_independent_id" content="f0b7a369-a961-5c5d-9912-66f9d6c609a8" />
<meta name="feedback_help_link_type" content="" />
<meta name="feedback_help_link_url" content="" />
<meta name="feedback_product_url" content="" />
<meta name="feedback_system" content="None" />
<meta name="git_commit_id" content="fff5b9941ef8b187803f46d1f9f02e98007d68df" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/sysinternals/blob/fff5b9941ef8b187803f46d1f9f02e98007d68df/sysinternals/downloads/sysmon.md" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="markruss" />
<meta name="ms.date" content="07/23/2024" />
<meta name="ms.service" content="sysinternals" />
<meta name="ms.subservice" content="system-utilities" />
<meta name="ms.topic" content="system-utilities" />
<meta name="ms:assetid" content="f49b1cb3-c689-469e-ade0-6fa98d72f9d6" />
<meta name="ms:mtpsurl" content="https://technet.microsoft.com/Dn798348(v=MSDN.10)" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/sysinternals/blob/live/sysinternals/downloads/sysmon.md" />
<meta name="page_type" content="conceptual" />
<meta name="pdf_url_template" content="https://learn.microsoft.com/pdfstore/en-us/MSDN.sysinternals/{branchName}{pdfName}" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="toc_rel" content="../toc.json" />
<meta name="TOCTitle" content="Sysmon" />
<meta name="uhfHeaderId" content="MSDocsHeader-Sysinternals" />
<meta name="updated_at" content="2024-07-23 03:15 PM" />
<meta name="word_count" content="3102" />
<meta name="persistent_id" content="5c38a65c-4a33-30f5-8476-cff9ea1ed310" />
	
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/bcbcbad5-4208-4783-8035-8481272c98b8" data-source="generated" />
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/07bb3e10-d135-43ff-bc8b-360497cb39fa" data-source="generated" />
	<meta name="cmProducts" content="https://microsoft-devrel.poolparty.biz/DevRelOfferingOntology/4ca1c773-9341-4241-b9f7-b89d0b8ec794" data-source="generated" />
	
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/43b2e5aa-8a6d-4de2-a252-692232e5edc8" data-source="generated" />
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/12e559b9-eaf6-4aee-9af7-62334e15f863" data-source="generated" />
	<meta name="spProducts" content="https://microsoft-devrel.poolparty.biz/DevRelOfferingOntology/dd6bfba4-3d64-4c95-ab74-30bcb91cb6a3" data-source="generated" />
	<meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/sysinternals/blob/live/sysinternals/downloads/sysmon.md" /><link href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon" rel="canonical"><title>Sysmon - Sysinternals | Microsoft Learn</title><link rel="stylesheet" href="/static/assets/0.4.028516059/styles/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: true,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',extendBreadcrumb: false,isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,contributors: [{ name: "markruss", url: "https://github.com/markruss" },{ name: "foxmsft", url: "https://github.com/foxmsft" },{ name: "bluPhy", url: "https://github.com/bluPhy" },{ name: "janlinhart-BC", url: "https://github.com/janlinhart-BC" },{ name: "MarioHewardt", url: "https://github.com/MarioHewardt" },{ name: "lukekim", url: "https://github.com/lukekim" },{ name: "asteinbr", url: "https://github.com/asteinbr" },{ name: "analyze-v", url: "https://github.com/analyze-v" },{ name: "markrussinovich", url: "https://github.com/markrussinovich" },{ name: "VSC-Service-Account", url: "https://github.com/VSC-Service-Account" }],},
		functions:{}
	};
	</script><script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script><script src="/static/assets/0.4.028516059/global/deprecation.js"></script><script src="/static/assets/0.4.028516059/scripts/en-us/index-docs.js"></script></head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a><div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">Download Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">More info about Internet Explorer and Microsoft Edge</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
			<div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button>
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none">

										</div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs><div id="article-header-page-actions"  class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
											id="lang-link-tablet"
											class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
											title="Read in English" data-bi-name="language-toggle"
											data-read-in-link
											hidden>
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon>
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text>Read in English</span>
										</a><button
												type="button"
												class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet"
												data-list-type="collection"
												data-bi-name="collection"
												title="Add to collection">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Save</span>
											</button><a	data-contenteditbtn
												class="button button-clear button-sm text-decoration-none button-primary display-none display-inline-flex-tablet"
												aria-label="Edit"
												title="Edit This Document"
												data-bi-name="edit"
														href="https://github.com/MicrosoftDocs/sysinternals/blob/live/sysinternals/downloads/sysmon.md">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-edit-outline"></span>
												</span>
											</a>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button
														data-page-action-item="overflow-mobile"
														type="button"
														class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
														data-bi-name="contents-expand"
														data-contents-button
														data-popover-close>
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span></button><a
													id="lang-link-overflow"
													class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
													title="Read in English" data-bi-name="language-toggle"
													data-page-action-item="overflow-mobile"
													data-check-hidden="true"
													data-read-in-link
													hidden
													>
													<span class="icon" aria-hidden="true" data-read-in-link-icon>
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text>Read in English</span>
												</a><button
														type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="collection"
														data-bi-name="collection"
														title="Save"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Save</span>
													</button>

			 										
													<button
													 	type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="plan"
														data-bi-name="plan"
														title="Add to Plan"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close
														hidden>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">Add to Plan</span>
													</button><a	data-contenteditbtn
														class="button button-clear button-block button-sm has-inner-focus justify-content-flex-start text-decoration-none display-none-tablet"
														aria-label="Edit"
														title="Edit This Document"
														data-bi-name="edit"
																href="https://github.com/MicrosoftDocs/sysinternals/blob/live/sysinternals/downloads/sysmon.md">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-edit-outline"></span>
														</span>
														<span>Edit</span>
													</a><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs" />
														<h4 class="font-size-sm padding-left-xxs">Share via</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">Email</span>
														</a><hr />
													<button
														class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
														title="Print"
														type="button"
														aria-label="Print"
														data-bi-name="print"
														data-page-action-item="overflow-all"
														data-popover-close
														data-print-page
														data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">Print</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button hidden>
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="sysmon-v1515">Sysmon v15.15</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr"><li>Article</li><li class="visibility-hidden-visual-diff"><time class="is-invisible" data-article-date aria-label="Article review date" datetime="2024-07-23T08:00:00Z" data-article-date-source="calculated">07/23/2024</time>
															</li><li class="contributors-holder display-none-print">
															<button aria-label="View all contributors" class="contributors-button link-button" data-bi-name="contributors" title="View all contributors">10 contributors</button>
														</li></ul>
										</div>
<div id="user-feedback" class="margin-block-xxs display-none-print" data-hide-on-archived>
	<button
		id="user-feedback-button"
		data-test-id="conceptual-feedback-button"
		class="button button-sm button-clear button-primary"
		type="button"
		data-bi-name="user-feedback-button"
		data-user-feedback-button
	>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-like"></span>
		</span>
		<span>Feedback</span>
	</button>
</div></div><nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav><!-- <content> --><p><strong>By Mark Russinovich and Thomas Garnier</strong></p>
<p>Published: July 23, 2024</p>
<p><a href="https://download.sysinternals.com/files/Sysmon.zip" data-linktype="external"><img src="media/shared/download_sm.png" alt="Download" data-linktype="relative-path"></a> <a href="https://download.sysinternals.com/files/Sysmon.zip" data-linktype="external"><strong>Download Sysmon</strong></a> <strong>(4.6 MB)</strong></p>
<p><a href="https://github.com/Sysinternals/SysmonForLinux" data-linktype="external"><strong>Download Sysmon for Linux (GitHub)</strong></a></p>
<h2 id="introduction">Introduction</h2>
<p><em>System Monitor</em> (<em>Sysmon</em>) is a Windows system service and device
driver that, once installed on a system, remains resident across system
reboots to monitor and log system activity to the Windows event log. It
provides detailed information about process creations, network
connections, and changes to file creation time. By collecting the events
it generates using
<a href="https://msdn.microsoft.com/library/windows/desktop/bb427443(v=vs.85).aspx" data-linktype="external">Windows Event Collection</a>
or
<a href="https://en.wikipedia.org/wiki/security_information_and_event_management" data-linktype="external">SIEM</a>
agents and subsequently analyzing them, you can identify malicious or
anomalous activity and understand how intruders and malware operate on
your network. The service runs as a
<a href="/en-us/windows/win32/services/protecting-anti-malware-services-#system-protected-process" data-linktype="absolute-path">protected process</a>,
thus disallowing a wide range of user mode interactions.</p>
<p>Note that <em>Sysmon</em> does not provide analysis of the events it generates,
nor does it attempt to hide itself from attackers.</p>
<h2 id="overview-of-sysmon-capabilities">Overview of Sysmon Capabilities</h2>
<p><em>Sysmon</em> includes the following capabilities:</p>
<ul>
<li>Logs process creation with full command line for both current and
parent processes.</li>
<li>Records the hash of process image files using SHA1 (the default),
MD5, SHA256 or IMPHASH.</li>
<li>Multiple hashes can be used at the same time.</li>
<li>Includes a process GUID in process create events to allow for
correlation of events even when Windows reuses process IDs.</li>
<li>Includes a session GUID in each event to allow correlation of events
on same logon session.</li>
<li>Logs loading of drivers or DLLs with their signatures and hashes.</li>
<li>Logs opens for raw read access of disks and volumes.</li>
<li>Optionally logs network connections, including each connectionâs
source process, IP addresses, port numbers, hostnames and port
names.</li>
<li>Detects changes in file creation time to understand when a file was
really created. Modification of file create timestamps is a
technique commonly used by malware to cover its tracks.</li>
<li>Automatically reload configuration if changed in the registry.</li>
<li>Rule filtering to include or exclude certain events dynamically.</li>
<li>Generates events from early in the boot process to capture activity
made by even sophisticated kernel-mode malware.</li>
</ul>
<h2 id="screenshots">Screenshots</h2>
<p><img src="media/sysmon/event-screen-optimized.png" alt="EventViewer" data-linktype="relative-path"></p>
<h2 id="usage">Usage</h2>
<p>Common usage featuring simple command-line options to install and uninstall
Sysmon, as well as to check and modify its configuration:</p>
<p>Install:                 <code>sysmon64 -i [&lt;configfile&gt;]</code><br>
Update configuration:    <code>sysmon64 -c [&lt;configfile&gt;]</code><br>
Install event manifest:  <code>sysmon64 -m</code><br>
Print schema:            <code>sysmon64 -s</code><br>
Uninstall:               <code>sysmon64 -u [force]</code></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>-i</strong></td>
<td>Install service and driver. Optionally take a configuration file.</td>
</tr>
<tr>
<td><strong>-c</strong></td>
<td>Update configuration of an installed Sysmon driver or dump the current configuration if no other argument is provided. Optionally takes a configuration file.</td>
</tr>
<tr>
<td><strong>-m</strong></td>
<td>Install the event manifest (implicitly done on service install as well).</td>
</tr>
<tr>
<td><strong>-s</strong></td>
<td>Print configuration schema definition.</td>
</tr>
<tr>
<td><strong>-u</strong></td>
<td>Uninstall service and driver. Using <code>-u force</code> causes uninstall to proceed even when some components are not installed.</td>
</tr>
</tbody>
</table>
<p>The service logs events immediately and the driver installs as a
boot-start driver to capture activity from early in the boot that the
service will write to the event log when it starts.</p>
<p>On Vista and higher, events are stored in
<code>Applications and Services Logs/Microsoft/Windows/Sysmon/Operational</code>.
On older systems, events are written to the <code>System</code> event log.</p>
<p>If you need more information on configuration files, use the <code>-? config</code>
command.</p>
<p>Specify <code>-accepteula</code> to automatically accept the EULA on installation,
otherwise you will be interactively prompted to accept it.</p>
<p>Neither install nor uninstall requires a reboot.</p>
<h2 id="examples">Examples</h2>
<p>Install with default settings (process images hashed with SHA1 and no
network monitoring)</p>
<pre><code class="lang-cmd">sysmon -accepteula -i
</code></pre>
<p>Install Sysmon with a configuration file (as described below)</p>
<pre><code class="lang-cmd">sysmon -accepteula -i c:\windows\config.xml
</code></pre>
<p>Uninstall</p>
<pre><code class="lang-cmd">sysmon -u
</code></pre>
<p>Dump the current configuration</p>
<pre><code class="lang-cmd">sysmon -c
</code></pre>
<p>Reconfigure an active Sysmon with a configuration file (as described below)</p>
<pre><code class="lang-cmd">sysmon -c c:\windows\config.xml
</code></pre>
<p>Change the configuration to default settings</p>
<pre><code class="lang-cmd">sysmon -c --
</code></pre>
<p>Show the configuration schema</p>
<pre><code class="lang-cmd">sysmon -s
</code></pre>
<h2 id="events">Events</h2>
<p>On Vista and higher, events are stored in
<code>Applications and Services Logs/Microsoft/Windows/Sysmon/Operational</code>, and on
older systems events are written to the <code>System</code> event log.
Event timestamps are in UTC standard time.</p>
<p>The following are examples of each event type that Sysmon generates.</p>
<h3 id="event-id-1-process-creation">Event ID 1: Process creation</h3>
<p>The process creation event provides extended information about a newly
created process. The full command line provides context on the process
execution. The <code>ProcessGUID</code> field is a unique value for this process
across a domain to make event correlation easier. The hash is a full
hash of the file with the algorithms in the <code>HashType</code> field.</p>
<h3 id="event-id-2-a-process-changed-a-file-creation-time">Event ID 2: A process changed a file creation time</h3>
<p>The change file creation time event is registered when a file creation
time is explicitly modified by a process. This event helps tracking the
real creation time of a file. Attackers may change the file creation
time of a backdoor to make it look like it was installed with the
operating system. Note that many processes legitimately change the
creation time of a file; it does not necessarily indicate malicious
activity.</p>
<h3 id="event-id-3-network-connection">Event ID 3: Network connection</h3>
<p>The network connection event logs TCP/UDP connections on the machine. It
is disabled by default. Each connection is linked to a process through
the <code>ProcessId</code> and <code>ProcessGuid</code> fields. The event also contains the source
and destination host names IP addresses, port numbers and IPv6 status.</p>
<h3 id="event-id-4-sysmon-service-state-changed">Event ID 4: Sysmon service state changed</h3>
<p>The service state change event reports the state of the Sysmon service
(started or stopped).</p>
<h3 id="event-id-5-process-terminated">Event ID 5: Process terminated</h3>
<p>The process terminate event reports when a process terminates. It
provides the <code>UtcTime</code>, <code>ProcessGuid</code> and <code>ProcessId</code> of the process.</p>
<h3 id="event-id-6-driver-loaded">Event ID 6: Driver loaded</h3>
<p>The driver loaded events provides information about a driver being
loaded on the system. The configured hashes are provided as well as
signature information. The signature is created asynchronously for
performance reasons and indicates if the file was removed after loading.</p>
<h3 id="event-id-7-image-loaded">Event ID 7: Image loaded</h3>
<p>The image loaded event logs when a module is loaded in a specific
process. This event is disabled by default and needs to be configured
with the "<code>âl</code>" option. It indicates the process in which the module is
loaded, hashes and signature information. The signature is created
asynchronously for performance reasons and indicates if the file was
removed after loading. This event should be configured carefully, as
monitoring all image load events will generate a significant amount of logging.</p>
<h3 id="event-id-8-createremotethread">Event ID 8: CreateRemoteThread</h3>
<p>The <code>CreateRemoteThread</code> event detects when a process creates a thread in
another process. This technique is used by malware to inject code and
hide in other processes. The event indicates the source and target
process. It gives information on the code that will be run in the new
thread: <code>StartAddress</code>, <code>StartModule</code> and <code>StartFunction</code>. Note that
<code>StartModule</code> and <code>StartFunction</code> fields are inferred, they might be empty
if the starting address is outside loaded modules or known exported
functions.</p>
<h3 id="event-id-9-rawaccessread">Event ID 9: RawAccessRead</h3>
<p>The <code>RawAccessRead</code> event detects when a process conducts reading
operations from the drive using the <code>\\.\</code> denotation. This technique
is often used by malware for data exfiltration of files that are locked
for reading, as well as to avoid file access auditing tools. The event
indicates the source process and target device.</p>
<h3 id="event-id-10-processaccess">Event ID 10: ProcessAccess</h3>
<p>The process accessed event reports when a process opens another process,
an operation thatâs often followed by information queries or reading and
writing the address space of the target process. This enables detection
of hacking tools that read the memory contents of processes like Local
Security Authority (Lsass.exe) in order to steal credentials for use in
Pass-the-Hash attacks. Enabling it can generate significant amounts of
logging if there are diagnostic utilities active that repeatedly open
processes to query their state, so it generally should only be done so
with filters that remove expected accesses.</p>
<h3 id="event-id-11-filecreate">Event ID 11: FileCreate</h3>
<p>File create operations are logged when a file is created or overwritten.
This event is useful for monitoring autostart locations, like the
Startup folder, as well as temporary and download directories, which are
common places malware drops during initial infection.</p>
<h3 id="event-id-12-registryevent-object-create-and-delete">Event ID 12: RegistryEvent (Object create and delete)</h3>
<p>Registry key and value create and delete operations map to this event
type, which can be useful for monitoring for changes to Registry
autostart locations, or specific malware registry modifications.</p>
<p>Sysmon uses abbreviated versions of Registry root key names, with the
following mappings:</p>
<table>
<thead>
<tr>
<th>Key name</th>
<th>Abbreviation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HKEY_LOCAL_MACHINE</code></td>
<td><code>HKLM</code></td>
</tr>
<tr>
<td><code>HKEY_USERS</code></td>
<td><code>HKU</code></td>
</tr>
<tr>
<td><code>HKEY_LOCAL_MACHINE\System\ControlSet00x</code></td>
<td><code>HKLM\System\CurrentControlSet</code></td>
</tr>
<tr>
<td><code>HKEY_LOCAL_MACHINE\Classes</code></td>
<td><code>HKCR</code></td>
</tr>
</tbody>
</table>
<h3 id="event-id-13-registryevent-value-set">Event ID 13: RegistryEvent (Value Set)</h3>
<p>This Registry event type identifies Registry value modifications. The
event records the value written for Registry values of type <code>DWORD</code> and
<code>QWORD</code>.</p>
<h3 id="event-id-14-registryevent-key-and-value-rename">Event ID 14: RegistryEvent (Key and Value Rename)</h3>
<p>Registry key and value rename operations map to this event type,
recording the new name of the key or value that was renamed.</p>
<h3 id="event-id-15-filecreatestreamhash">Event ID 15: FileCreateStreamHash</h3>
<p>This event logs when a named file stream is created, and it generates
events that log the hash of the contents of the file to which the stream
is assigned (the unnamed stream), as well as the contents of the named
stream. There are malware variants that drop their executables or
configuration settings via browser downloads, and this event is aimed at
capturing that based on the browser attaching a <code>Zone.Identifier</code> "mark of
the web" stream.</p>
<h3 id="event-id-16-serviceconfigurationchange">Event ID 16: ServiceConfigurationChange</h3>
<p>This event logs changes in the Sysmon configuration - for example when the
filtering rules are updated.</p>
<h3 id="event-id-17-pipeevent-pipe-created">Event ID 17: PipeEvent (Pipe Created)</h3>
<p>This event generates when a named pipe is created. Malware often uses named
pipes for interprocess communication.</p>
<h3 id="event-id-18-pipeevent-pipe-connected">Event ID 18: PipeEvent (Pipe Connected)</h3>
<p>This event logs when a named pipe connection is made between a client and a
server.</p>
<h3 id="event-id-19-wmievent-wmieventfilter-activity-detected">Event ID 19: WmiEvent (WmiEventFilter activity detected)</h3>
<p>When a WMI event filter is registered, which is a method used by malware to
execute, this event logs the WMI namespace, filter name and filter expression.</p>
<h3 id="event-id-20-wmievent-wmieventconsumer-activity-detected">Event ID 20: WmiEvent (WmiEventConsumer activity detected)</h3>
<p>This event logs the registration of WMI consumers, recording the consumer name,
log, and destination.</p>
<h3 id="event-id-21-wmievent-wmieventconsumertofilter-activity-detected">Event ID 21: WmiEvent (WmiEventConsumerToFilter activity detected)</h3>
<p>When a consumer binds to a filter, this event logs the consumer name and filter
path.</p>
<h3 id="event-id-22-dnsevent-dns-query">Event ID 22: DNSEvent (DNS query)</h3>
<p>This event is generated when a process executes a DNS query, whether the result
is successful or fails, cached or not. The telemetry for this event was added
for Windows 8.1 so it is not available on Windows 7 and earlier.</p>
<h3 id="event-id-23-filedelete-file-delete-archived">Event ID 23: FileDelete (File Delete archived)</h3>
<p>A file was deleted. Additionally to logging the event, the deleted file is also
saved in the <code>ArchiveDirectory</code> (which is <code>C:\Sysmon</code> by default). Under normal
operating conditions this directory might grow to an unreasonable size - see
event ID 26: <code>FileDeleteDetected</code> for similar behavior but without saving the
deleted files.</p>
<h3 id="event-id-24-clipboardchange-new-content-in-the-clipboard">Event ID 24: ClipboardChange (New content in the clipboard)</h3>
<p>This event is generated when the system clipboard contents change.</p>
<h3 id="event-id-25-processtampering-process-image-change">Event ID 25: ProcessTampering (Process image change)</h3>
<p>This event is generated when process hiding techniques such as "hollow" or
"herpaderp" are being detected.</p>
<h3 id="event-id-26-filedeletedetected-file-delete-logged">Event ID 26: FileDeleteDetected (File Delete logged)</h3>
<p>A file was deleted.</p>
<h3 id="event-id-27-fileblockexecutable">Event ID 27: FileBlockExecutable</h3>
<p>This event is generated when Sysmon detects and blocks the creation of
executable files (PE format).</p>
<h3 id="event-id-28-fileblockshredding">Event ID 28: FileBlockShredding</h3>
<p>This event is generated when Sysmon detects and blocks file shredding from tools such as <a href="sdelete" data-linktype="relative-path">SDelete</a>.</p>
<h3 id="event-id-29-fileexecutabledetected">Event ID 29: FileExecutableDetected</h3>
<p>This event is generated when Sysmon detects the creation of a new executable
file (PE format).</p>
<h3 id="event-id-255-error">Event ID 255: Error</h3>
<p>This event is generated when an error occurred within Sysmon. They can
happen if the system is under heavy load and certain tasks could not be
performed or a bug exists in the Sysmon service, or even if certain security
and integrity conditions are not met. You can report any bugs
on the Sysinternals forum or over Twitter
(<a href="https://twitter.com/markrussinovich" data-linktype="external">@markrussinovich</a>).</p>
<h2 id="configuration-files">Configuration files</h2>
<p>Configuration files can be specified after the <strong>-i</strong> (installation) or
<strong>-c</strong> (installation) configuration switches. They make it easier to
deploy a preset configuration and to filter captured events.</p>
<p>A simple configuration xml file looks like this:</p>
<pre><code class="lang-xml">&lt;Sysmon schemaversion="4.82"&gt;
  &lt;!-- Capture all hashes --&gt;
  &lt;HashAlgorithms&gt;*&lt;/HashAlgorithms&gt;
  &lt;EventFiltering&gt;
    &lt;!-- Log all drivers except if the signature --&gt;
    &lt;!-- contains Microsoft or Windows --&gt;
    &lt;DriverLoad onmatch="exclude"&gt;
      &lt;Signature condition="contains"&gt;microsoft&lt;/Signature&gt;
      &lt;Signature condition="contains"&gt;windows&lt;/Signature&gt;
    &lt;/DriverLoad&gt;
    &lt;!-- Do not log process termination --&gt;
    &lt;ProcessTerminate onmatch="include" /&gt;
    &lt;!-- Log network connection if the destination port equal 443 --&gt;
    &lt;!-- or 80, and process isn't InternetExplorer --&gt;
    &lt;NetworkConnect onmatch="include"&gt;
      &lt;DestinationPort&gt;443&lt;/DestinationPort&gt;
      &lt;DestinationPort&gt;80&lt;/DestinationPort&gt;
    &lt;/NetworkConnect&gt;
    &lt;NetworkConnect onmatch="exclude"&gt;
      &lt;Image condition="end with"&gt;iexplore.exe&lt;/Image&gt;
    &lt;/NetworkConnect&gt;
  &lt;/EventFiltering&gt;
&lt;/Sysmon&gt;
</code></pre>
<p>The configuration file contains a schemaversion attribute on the Sysmon
tag. This version is independent from the Sysmon binary version and
allows the parsing of older configuration files. You can get the current
schema version by using the "<code>-? config</code>" command line. Configuration
entries are directly under the <code>Sysmon</code> tag and filters are under the
<code>EventFiltering</code> tag.</p>
<h2 id="configuration-entries">Configuration Entries</h2>
<p>Configuration entries are similar to command line switches and include the following</p>
<p>Configuration entries include the following:</p>
<table>
<thead>
<tr>
<th>Entry</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ArchiveDirectory</td>
<td>String</td>
<td>Name of directories at volume roots into which copy-on-delete files are moved. The directory is protected with a System ACL (you can use PsExec from Sysinternals to access the directory                                 using <code>psexec -sid cmd</code>). Default: <code>Sysmon</code></td>
</tr>
<tr>
<td>CheckRevocation</td>
<td>Boolean</td>
<td>Controls signature revocation checks. Default: <code>True</code></td>
</tr>
<tr>
<td>CopyOnDeletePE</td>
<td>Boolean</td>
<td>Preserves deleted executable image files. Default: <code>False</code></td>
</tr>
<tr>
<td>CopyOnDeleteSIDs</td>
<td>Strings</td>
<td>Comma-separated list of account SIDs for which file deletes will be preserved.</td>
</tr>
<tr>
<td>CopyOnDeleteExtensions</td>
<td>Strings</td>
<td>Extensions for files that are preserved on delete.</td>
</tr>
<tr>
<td>CopyOnDeleteProcesses</td>
<td>Strings</td>
<td>Process name(s) for which file deletes will be preserved.</td>
</tr>
<tr>
<td>DnsLookup</td>
<td>Boolean</td>
<td>Controls reverse DNS lookup. Default: <code>True</code></td>
</tr>
<tr>
<td>DriverName</td>
<td>String</td>
<td>Uses specified name for driver and service images.</td>
</tr>
<tr>
<td>HashAlgorithms</td>
<td>Strings</td>
<td>Hash algorithm(s) to apply for hashing. Algorithms supported include MD5, SHA1, SHA256, IMPHASH and * (all). Default: <code>None</code></td>
</tr>
</tbody>
</table>
<p>Command line switches have their configuration entry described in the Sysmon usage
output. Parameters are optional based on the tag. If a command line
switch also enables an event, it needs to be configured though its
filter tag. You can specify the <code>-s</code> switch to have Sysmon print the full
configuration schema, including event tags as well as the field names
and types for each event. For example, hereâs the schema for the
<code>RawAccessRead</code> event type:</p>
<pre><code class="lang-xml">&lt;event name="SYSMON_RAWACCESS_READ" value="9" level="Informational "template="RawAccessRead detected" rulename="RawAccessRead" version="2"&gt;  
  &lt;data name="UtcTime" inType="win:UnicodeString" outType="xs:string"/&gt;  
  &lt;data name="ProcessGuid" inType="win:GUID"/&gt;  
  &lt;data name="ProcessId" inType="win:UInt32" outType="win:PID"/&gt;  
  &lt;data name="Image" inType="win:UnicodeString" outType="xs:string"/&gt;  
  &lt;data name="Device" inType="win:UnicodeString" outType="xs:string"/&gt;  
&lt;/event&gt;  
</code></pre>
<h2 id="event-filtering-entries">Event filtering entries</h2>
<p>Event filtering allows you to filter generated events. In many cases
events can be noisy and gathering everything is not possible. For
example, you might be interested in network connections only for a
certain process, but not all of them. You can filter the output on the
host reducing the data to collect.</p>
<p>Each event has its own filter tag under the EventFiltering node in a
configuration file:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Tag</th>
<th>Event</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1</strong></td>
<td>ProcessCreate</td>
<td>Process Create</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>FileCreateTime</td>
<td>File creation time</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>NetworkConnect</td>
<td>Network connection detected</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>n/a</td>
<td>Sysmon service state change (cannot be filtered)</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>ProcessTerminate</td>
<td>Process terminated</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>DriverLoad</td>
<td>Driver Loaded</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>ImageLoad</td>
<td>Image loaded</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>CreateRemoteThread</td>
<td>CreateRemoteThread detected</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>RawAccessRead</td>
<td>RawAccessRead detected</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>ProcessAccess</td>
<td>Process accessed</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>FileCreate</td>
<td>File created</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>RegistryEvent</td>
<td>Registry object added or deleted</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>RegistryEvent</td>
<td>Registry value set</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>RegistryEvent</td>
<td>Registry object renamed</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>FileCreateStreamHash</td>
<td>File stream created</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>n/a</td>
<td>Sysmon configuration change (cannot be filtered)</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>PipeEvent</td>
<td>Named pipe created</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>PipeEvent</td>
<td>Named pipe connected</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>WmiEvent</td>
<td>WMI filter</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>WmiEvent</td>
<td>WMI consumer</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>WmiEvent</td>
<td>WMI consumer filter</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>DNSQuery</td>
<td>DNS query</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>FileDelete</td>
<td>File Delete archived</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>ClipboardChange</td>
<td>New content in the clipboard</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>ProcessTampering</td>
<td>Process image change</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>FileDeleteDetected</td>
<td>File Delete logged</td>
</tr>
<tr>
<td><strong>27</strong></td>
<td>FileBlockExecutable</td>
<td>File Block Executable</td>
</tr>
<tr>
<td><strong>28</strong></td>
<td>FileBlockShredding</td>
<td>File Block Shredding</td>
</tr>
<tr>
<td><strong>29</strong></td>
<td>FileExecutableDetected</td>
<td>File Executable Detected</td>
</tr>
</tbody>
</table>
<p>You can also find these tags in the event viewer on the task name.</p>
<p>The <code>onmatch</code> filter is applied if events are matched. It can be changed
with the <code>onmatch</code> attribute for the filter tag. If the value is
<code>"include"</code>, it means only matched events are included. If it is set to
<code>"exclude"</code>, the event will be included except if a rule match. You can
specify both an include filter set and an exclude filter set for each
event ID, where exclude matches take precedence.</p>
<p>Each filter can include zero or more rules. Each tag under the filter
tag is a field name from the event. Rules that specify a condition for
the same field name behave as OR conditions, and ones that specify
different field name behave as AND conditions. Field rules can also use
conditions to match a value. The conditions are as follows (all are case
insensitive):</p>
<table>
<thead>
<tr>
<th><strong>Condition</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>is</strong></td>
<td>Default, values are equals</td>
</tr>
<tr>
<td><strong>is any</strong></td>
<td>The field is one of the <code>;</code> delimited values</td>
</tr>
<tr>
<td><strong>is not</strong></td>
<td>Values are different</td>
</tr>
<tr>
<td><strong>contains</strong></td>
<td>The field contains this value</td>
</tr>
<tr>
<td><strong>contains any</strong></td>
<td>The field contains any of the <code>;</code> delimited values</td>
</tr>
<tr>
<td><strong>contains all</strong></td>
<td>The field contains all of the <code>;</code> delimited values</td>
</tr>
<tr>
<td><strong>excludes</strong></td>
<td>The field does not contain this value</td>
</tr>
<tr>
<td><strong>excludes any</strong></td>
<td>The field does not contain one or more of the <code>;</code> delimited values</td>
</tr>
<tr>
<td><strong>excludes all</strong></td>
<td>The field does not contain any of the <code>;</code> delimited values</td>
</tr>
<tr>
<td><strong>begin with</strong></td>
<td>The field begins with this value</td>
</tr>
<tr>
<td><strong>end with</strong></td>
<td>The field ends with this value</td>
</tr>
<tr>
<td><strong>not begin with</strong></td>
<td>The field does not begin with this value</td>
</tr>
<tr>
<td><strong>not end with</strong></td>
<td>The field does not end with this value</td>
</tr>
<tr>
<td><strong>less than</strong></td>
<td>Lexicographical comparison is less than zero</td>
</tr>
<tr>
<td><strong>more than</strong></td>
<td>Lexicographical comparison is more than zero</td>
</tr>
<tr>
<td><strong>image</strong></td>
<td>Match an image path (full path or only image name). For example: <code>lsass.exe</code> will match <code>c:\windows\system32\lsass.exe</code></td>
</tr>
</tbody>
</table>
<p>You can use a different condition by specifying it as an attribute. This
excludes network activity from processes with iexplore.exe in their
path:</p>
<pre><code class="lang-xml">&lt;NetworkConnect onmatch="exclude"&gt;
  &lt;Image condition="contains"&gt;iexplore.exe&lt;/Image&gt;
&lt;/NetworkConnect&gt;
</code></pre>
<p>To have Sysmon report which rule match resulted in an event being logged, add
names to rules:</p>
<pre><code class="lang-xml">&lt;NetworkConnect onmatch="exclude"&gt;
  &lt;Image name="network iexplore" condition="contains"&gt;iexplore.exe&lt;/Image&gt;
&lt;/NetworkConnect&gt;
</code></pre>
<p>You can use both include and exclude rules for the same tag, where exclude rules
override include rules. Within a rule, filter conditions have OR behavior.</p>
<p>In the sample configuration shown earlier, the networking filter uses both an
include and exclude rule to capture activity to port 80 and 443 by all processes
except those that have <code>iexplore.exe</code> in their name.</p>
<p>It is also possible to override the way that rules are combined by using a rule
group which allows the rule combine type for one or more events to be set
explicitly to AND or OR.</p>
<p>The following example demonstrates this usage. In the first rule group, a
process create event will be generated when <code>timeout.exe</code> is executed only with
a command line argument of <code>100</code>, but a process terminate event will be
generated for the termination of <code>ping.exe</code> and <code>timeout.exe</code>.</p>
<pre><code class="lang-xml">  &lt;EventFiltering&gt;
    &lt;RuleGroup name="group 1" groupRelation="and"&gt;
      &lt;ProcessCreate onmatch="include"&gt;
        &lt;Image condition="contains"&gt;timeout.exe&lt;/Image&gt;
        &lt;CommandLine condition="contains"&gt;100&lt;/CommandLine&gt;
      &lt;/ProcessCreate&gt;
    &lt;/RuleGroup&gt;
    &lt;RuleGroup groupRelation="or"&gt;
      &lt;ProcessTerminate onmatch="include"&gt;
        &lt;Image condition="contains"&gt;timeout.exe&lt;/Image&gt;
        &lt;Image condition="contains"&gt;ping.exe&lt;/Image&gt;
      &lt;/ProcessTerminate&gt;        
    &lt;/RuleGroup&gt;
    &lt;ImageLoad onmatch="include"/&gt;
  &lt;/EventFiltering&gt;
</code></pre>
<p><a href="https://download.sysinternals.com/files/Sysmon.zip" data-linktype="external"><img src="media/shared/download_sm.png" alt="Download" data-linktype="relative-path"></a> <a href="https://download.sysinternals.com/files/Sysmon.zip" data-linktype="external"><strong>Download Sysmon</strong></a> <strong>(4.6 MB)</strong></p>
<p><strong>Runs on:</strong></p>
<ul>
<li>Client: Windows 10 and higher.</li>
<li>Server: Windows Server 2016 and higher.</li>
</ul>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside
								id="ms--additional-resources-mobile"
								aria-label="Additional resources"
								class="display-none-desktop display-none-print"
							>
								<hr class="hr" hidden />
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer></div></div><div
							id="ms--additional-resources"
							class="right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Additional resources"
						>
							<div id="affixed-right-container" class="margin-top-sm-tablet" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden>Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer>

	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>