<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-2016-updates-shifu-banking-trojan/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v24.2 (Yoast SEO v24.2) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>2016 Updates to Shifu Banking Trojan</title>
	<meta name="description" content="Overview Shifu is a Banking Trojan first discovered in 2015. Shifu is based on the Shiz source code which incorporated techniques used by Zeus. Attackers" />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="2016 Updates to Shifu Banking Trojan" />
	<meta property="og:description" content="Overview Shifu is a Banking Trojan first discovered in 2015. Shifu is based on the Shiz source code which incorporated techniques used by Zeus. Attackers" />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2017-01-06T20:00:22+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
	<meta property="og:image:width" content="650" />
	<meta property="og:image:height" content="300" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Dominik Reichel" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; 2016 Updates to Shifu Banking Trojan Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:unit42-2016-updates-shifu-banking-trojan";
webData.pageURL = "https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan";
webData.article_title = "2016 Updates to Shifu Banking Trojan";
webData.author = "Dominik Reichel";
webData.published_time = "2017-01-06T12:00:22-08:00";
webData.description = "";
webData.keywords = "Cybercrime,Malware,Threat Research,banking,Shifu,threat research,Trojan";
webData.resourceAssetID = "91cf630ed90382461771d929686fc445";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="5"/>
<meta property="og:readtime" content="21"/>
<meta property="og:views" content="58,781"/>
<meta property="og:date_created" content="January 6, 2017 at 12:00 PM"/>
<meta property="og:post_length" content="7620"/>
<meta property="og:category" content="Cybercrime"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cybercrime/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Dominik Reichel"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/dominik-reichel/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="banking,Shifu,threat research,Trojan"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"2016 Updates to Shifu Banking Trojan","name":"2016 Updates to Shifu Banking Trojan","description":"Overview Shifu is a Banking Trojan first discovered in 2015. Shifu is based on the Shiz source code which incorporated techniques used by Zeus. Attackers use Shifu to steal credentials for online banking websites around the world, starting in Russia but later including the UK, Italy, and others.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-2016-updates-shifu-banking-trojan\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-2016-updates-shifu-banking-trojan\/","datePublished":"January 6, 2017","articleBody":"Overview\nShifu is a Banking Trojan first discovered in 2015. Shifu is based on the Shiz source code which incorporated techniques used by Zeus. Attackers use Shifu to steal credentials for online banking websites around the world, starting in Russia but later including the UK, Italy, and others.\n\nPalo Alto Networks Unit 42 research has found that the Shifu authors have evolved Shifu in 2016. Our research has found that Shifu has incorporated multiple new techniques to infect and evade detection on Microsoft Windows systems. Some of these include:\n\n \tExploitation of CVE-2016-0167 a Microsoft Windows Privilege Escalation vulnerability to gain SYSTEM level privileges. Earlier versions of Shifu exploited CVE-2015-0003 to achieve the same goal\n \tUse of a Windows atom to identify if the host is already infected with Shifu in addition to the mutex used by previous versions\n \tUse of \u201cpush-calc-ret\u201d API obfuscation to hide function calls from malware analysts\n \tUse of alternative Namecoin .bit domains\n\nWe have also identified new links between Shifu and other tools which suggest Shifu isn\u2019t simply based on the Shiz Trojan, but is probably the latest evolution of Shiz.\n\nThe primary goal of this report is to introduce Shifu\u2019s new features to other malware analysts who may encounter this Trojan in the future. The following sections give an overview of the new features, and the appendix at the end includes the technical details on the overall functionality of Shifu.\nNew Developments and Features in Shifu\nThe Shifu version discussed in this analysis is comprised of several stages of payloads and was compiled in June 2016. The following image illustrates the different files included in the initial loader which get decrypted after execution:\n\n\n\nFigure 1. File structure of Shifu\n\nThe initial obfuscated loader (x86 exe) contains the encrypted second stage injector (x86 exe). It uses three layers for decryption by subsequently allocating memory via VirtualAlloc() for the next layer. The second stage injector gets decrypted into memory and the original loader process is then overwritten with it. Next, the section flags are adjusted and the IAT addresses are resolved. The final decryption layer then jumps to the entry point of the second stage injector.\n\nThe second stage injector contains two exploits for CVE-2016-0167 (x86\/x64) that have a compilation time stamp dated February, 2016. At the time of compilation, patches were not yet available for this vulnerability. However, the malware\u2019s compilation time stamp dates June 2016. This may indicate the people behind this Shifu version had access to the zero-day exploit at that time or gained access to it afterwards. The exploit uses an interesting technique which makes it possible to just copy the raw disk file into memory. To make the file executable in memory, it uses a custom PE loader shellcode appended to both versions of the exploit as an PE overlay. The shellcode takes care of all the adjustments needed to get a proper executable memory image and executes the exploit. By doing so, the file just needs to be copied into a memory buffer and execution needs to be passed to the shellcode.\n\nWe have also found multiple other variants of the exploit, standalone versions (x86\/64), but also versions which are embedded in an injector like in Shifu. Additionally, we identified a version of Vawtrak which contains an earlier version of the exploit dating back to November 2015, according to the compilation time stamp. The compilation time stamp of this Vawtrak sample itself dates January 2016 and thus is effectively the first malware known to us to use this exploit.\n\nThe second stage injector contains several anti-analysis tricks similar to the previous version. It also contains two command line parameters with functionality that indicate the malware is still in development. Further, the second stage injector uses an atom to check if the system is already infected, instead of using a mutex like most of the malware today. The use of atoms is not a new technique, but still not very widespread.\n\nThe main payload is encrypted and packed inside the .tls section of the second stage injector. It first gets decrypted and then unpacked with the aPLib compression library. As persistence method, the main payload copies the initial loader to the AppData folder and creates a Jscript file inside the Startup folder which points to it. The second stage injector injects the main payload inside a x86 instance of svchost and patches its API function calls with an obfuscation technique to make static and dynamic analysis of the malware more difficult.\n\nCompared to the previous version, the main payload contains some updates. This includes the strings to search on the victim\u2019s system, the browser target list, and the bot commands. The main payload uses .bit top-level domains to contact its C&amp;C server. The domain names, the user-agent string and the URL parameters are encrypted with a modified RC4 encryption algorithm. The domain names indicate that the attackers may be either located in Ukraine or have a Ukrainian background.\n\nUnfortunately, at the time of the analysis the C&amp;C server didn\u2019t respond with any commands and thus further analysis of the targeted financial institutions wasn\u2019t possible. This information would be normally downloaded into a configuration file on the victim\u2019s disk. For some of its functionality, the main payload hooks some API functions inside the svchost.exe process into which it is injected. Further, it uses the Apache web server for the web injections. If it was successfully downloaded from the C&amp;C server, the malware makes use of a layered service provider to hook into the Winsock API for intercepting and modifying inbound and outbound Internet traffic. It also contains the normally used methods to hook into the browsers networking functions found in many other banking Trojans.\n\nBoth the second stage injector and the main payload contain a lot of strings which are never used. This indicates the author(s) were either in a rush to build the malware or the development was done in a sloppy way.\n\nInstead of the string \u201cIntelPowerAgent6\u201d seen in the last version, this sample contains the string \u201cIntelPowerAgent32\u201d which is never used. In addition to the atom created by the second stage injector to check if the system is already infected, the main payload also creates a mutex with a name based on the same procedure to create the name for the atom (see Appendix). However, the mutex uses a hardcoded prefix named \u201cDAN6J0-\u201d before the byte sequence that is also used for the atom string: \u201c{DAN6J0-ae000000d2000000e100}\u201d\n\n\n\nFigure 2. Shifu mutex and the associated svchost process\nShifu, Shiz and Other Related Tools\nThe Shifu banking Trojan is mainly based on the Shiz\/iBank source code, which is one of the oldest banking Trojans still in the wild today. Shiz was first discovered in 2006 and has been through several stages of development since that time. It began as a banking Trojan which only focused on Russian financial institutions. Later, it also began targeting an Italian bank which may have set the stage for a more international focus. The internal versions we have tracked over the last five years ranged from generation 2 to 4 (2011) and 5 (2013\/2014). The fifth generation of Shiz was the last one we saw in the wild in 2014 (last internal version was 5.6.25) and it differs from the 4th generation in the coding style. It looks like it was developed by another coder, which could indicate the source code was sold or shared. The query string used to contact the C&amp;C server of one of the very first versions of the fifth generation supports our theory:\n\nbotid=%s&amp;ver=5.0.1&amp;up=%u&amp;os=%03u&amp;ltime=%s%d&amp;token=%d&amp;cn=reborn&amp;av=%s\n\nWe can see that the campaign name (cn) contains the string \u201creborn\u201d.\n\nShifu was first discovered in the wild in the middle of 2015 and we believe it's the evolution of the 5th generation of Shiz with a more international focus.\n\nWe have not only tracked the Shiz banking Trojan over the last couple of years, but also found several additional malware tools allegedly from the same author(s). Collected samples indicate the author(s) have developed a whole set of financially related malware. It\u2019s not clear if the author works as part of a group or uses the malware themselves. These tools are mainly based on the source code of the fifth generation of Shiz.\n\nWe have connected these tools together because they all contain a PDB path that has the same root folder:\n\nZ:\\coding\\...\n\nFurthermore, most of the tools are based on the Shiz source code, because the coding style and used API functions are very similar. Also, comparing the code between the tools with BinDiff shows a high degree of similarity. Moreover, those tools with network functionality contain query strings similar to the one in Shiz to contact their C&amp;C server.\n\nAs our colleagues from FireEye described last year, the PDB path found in Shifu is as follows:\n\nZ:\\coding\\project\\main\\payload\\payload.x86.pdb\n\nOther tools we have identified have the following PDB paths and are likely from the same author(s):\n\nZ:\\coding\\cryptor\\Release\\crypted.pdb\n\nZ:\\coding\\malware\\tests\\Release\\cryptoshit.pdb\n\nZ:\\coding\\malware\\RDP\\output\\Release\\rdp_bot.pdb\n\nZ:\\coding\\malware\\ScanBot\\Release\\bot.pdb\n\nThe malware internally named \"cryptor\" contains an encrypted sample of BifitAgent, the first malware known to attack the financial software from BIFIT. While it's possible that BifitAgent is developed from the same person, we haven't found any indications for that. According to the compilation time stamps, most of the samples were created in October\/November 2013.\n\nThe malware with the name \"rdp_bot\" is a small bot which uses the RDP protocol to gain full access to a computer. It uses the same modified RC4 encryption algorithm as the Shifu version discussed in this article. This tool was probably used along the Shiz banking Trojan, because the attacker is able to do his fraudulent activities directly from the victim\u2019s computer. By doing so, one could fool bank antifraud systems which check for the IP address, browser footprints or keyboard layouts. The tool is based on the research about RDP performed by Alisa Esage. The samples date from June to November 2013.\n\nThe tool which is named \"cryptoshit\" contains an encrypted sample of rdp_bot and also uses the same modified RC4 algorithm as the Shifu version described here. The samples date September\/October 2013 and January 2014 according to the compilation time stamp.\n\nThe malware with the internal name \"ScanBot\" is a small backdoor which uses the Super Light Regular Expression library (SRLE) for scanning a victim\u2019s computer for files via commands from its operator. The samples date June 2013 according to the time stamp.\nProtection Against Shifu\nPalo Alto Networks customers are protected from Shifu in the following ways:\n\n \tWildfire classifies Shifu files as malicious and signatures are loaded into Threat Prevention\n \tAutoFocus customers can track malware using the Shifu tag\n \tCommand and Control domains used by Shifu are blocked through Threat Prevention\n\nSHA256 Hashes of Samples Discussed\n\nInitial obfuscated loader\n\nd3f9c4037f8b4d24f2baff1e0940d2bf238032f9343d06478b5034d0981b2cd9\n368b23e6d9ec7843e537e9d6547777088cf36581076599d04846287a9162652b\ne7e154c65417f5594a8b4602db601ac39156b5758889f708dac7258e415d4a18\nf63ec1e5752eb8b9a07104f42392eebf143617708bfdd0fe31cbf00ef12383f9\n\nSecond stage injector\n\n003965bd25acb7e8c6e16de4f387ff9518db7bcca845502d23b6505d8d3cec01\n1188c5c9f04658bef20162f3001d9b89f69c93bf5343a1f849974daf6284a650\n\nExploit injector\n\ne7c1523d93154462ed9e15e84d3af01abe827aa6dd0082bc90fc8b58989e9a9a\n\nCVE-2016-0167 exploit (x86)\n\n5124f4fec24acb2c83f26d1e70d7c525daac6c9fb6e2262ed1c1c52c88636bad\n\nCVE-2016-0167 exploit (x64)\n\nf3c2d4090f6f563928e9a9ec86bf0f1c6ee49cdc110b7368db8905781a9a966e\n\nMain payload\n\ne9bd4375f9b0b95f385191895edf81c8eadfb3964204bbbe48f7700fc746e4dc\n5ca2a9de65c998b0d0a0a01b4aa103a9410d76ab86c75d7b968984be53e279b6\nAppendix - Technical details\nSecond Stage Injector Analysis\nThe second stage injector contains an exploit injector (x86 DLL) which in turn has two embedded exploits (x86\/64 DLL) for CVE-2016-0167. The second stage injector also contains the encrypted and aPLib packed main payload module (x86 DLL) in its .tls section. For decryption, it uses a modified version of the RC4 encryption algorithm with a salt that is stored in the .rsrc section. Significant strings in the second stage injector's .data section were XORed with the key 0x8D and get decrypted on-the-fly. Decrypted strings:\nAddMandatoryAce\nADVAPI\nAdvapi32.dlladvapi32.dllws2_32.dll\nWPUCloseEvent\nWPUCloseSocketHandleWPUCreateEvent\nWPUCreateSocketHandle\nWPUFDIsSet\nWPUGetProviderPath\nWPUModifyIFSHandle\nWPUPostMessage\nWPUQueryBlockingCallbackWPUQuerySocketHandleContext\nWPUQueueApc\nWPUResetEvent\nWPUSetEvent\nWPUOpenCurrentThreadWPUCloseThread\nWSPStartup\n &gt; %1\\r\\ndel %0\nsoftware\\\\microsoft\\\\windows\\\\currentversion\\\\run\nABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/echo \nrundll32.exe shell32.dll, ShellExec_RunDLL %s\nMicrosoft\\\\Microsoft AntimalwareSoftware\\\\Coranti\nSoftware\\\\risingSoftware\\\\TrendMicroSoftware\\\\Symantec\nSoftware\\\\ComodoGroup\nSoftware\\\\Network Associates\\\\TVD\nSoftware\\\\Data Fellows\\\\F-SecureSoftware\\\\Eset\\\\Nod\nSoftware\\\\Softed\\\\ViGUARD\nSoftware\\\\Zone Labs\\\\ZoneAlarm\nSoftware\\\\Avg\nSoftware\\\\VBA32\nSoftware\\\\Doctor WebSoftware\\\\G DataSoftware\\\\Avira\nSoftware\\\\AVAST Software\\\\Avast\nSoftware\\\\KasperskyLab\\\\protected\nSoftware\\\\Bitdefender\nSoftware\\\\Panda SoftwareSoftware\\\\Sophos.bat\\\\\\\\.\\\\%C:\n|$$$}rstuvwxyz{$$$$$$$&gt;?@ABCDEFGHIJKLMNOPQRSTUVW$$$$$$XYZ[\\\\]^_`abcdefghijklmnopq\nconhost\nCreateProcessInternalW\nConvertStringSecurityDescriptorToSecurityDescriptorWContent-Type: multipart\/form-data; boundary=---------------------------%s\\r\\n\nContent-Type: application\/x-www-form-urlencoded\\r\\n\nHost: %s\\r\\n%d.%d.%d.%d\n%d.%d.%d.%d.%x\n%temp%\\\\debug_file.txt\n[%u][%s:%s:%u][0x%x;0x%x] %sDnsFlushResolverCache\n\\\\*.*\ndnsapi.dll\nDnsGetCacheDataTable.dll.exedownload.windowsupdate.com\nvk.com\nyandex.ru\nHTTP\/1.1https:\/\/http:\/\/%s\nIsWow64Process\nkernel\nkernel32.dllLdrGetProcedureAddress\nMicrosoft\nNtAllocateVirtualMemory\nCLOSED\nLAST_ACKTIME_WAIT\nDELETE_TCB\nLISTEN\nSYN_SENTSYN_RCVDESTAB\nFIN_WAIT1\nFIN_WAIT2\nCLOSE_WAIT\nCLOSING\nTCP\\t%s:%d\\t%s:%d\\t%s\\n\nnetstat\\nProto\\tLocal address\\tRemote address\\tState\\n\nntdll.dll\nNtResumeProcess\nNtSuspendProcess\\\\\\\\?\\\\globalroot\\\\systemroot\\\\system32\\\\drivers\\\\null.sys\nNtWriteVirtualMemoryopenRegisterApplicationRestart\nRtlCreateUserThread\nResetSR\nRtlComputeCrc32\nrundll32SeDebugPrivilegeSystemDrive\n\\\\StringFileInfo\\\\%04x%04x\\\\ProductName\nsoftware\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon\nshell\nSleep\nsrclient.dllSeShutdownPrivilege\n\\\"%s\\\"\n%d\\t%s\\ntaskmgr\\nPID\\tProcess name\\nnet user\\n\nthe computer is joined to a domain\\n..\n\\\\VarFileInfo\\\\Translation\n%windir%\\\\system32\\\\%windir%\\\\syswow64\\\\POST*.exe\n%SystemDrive%\\\\\n*SYSTEM*%02x%s:Zone.Identifier\nGetProcessUserModeExceptionPolicy\nSetProcessUserModeExceptionPolicy\n%ws\\\\%ws\\n\nWORKGROUP\nHOMESoftware\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\ExplorerDisableCurrentUserRun\n%s.dat\nsoftware\\\\microsoft\\\\windows%OS%_%NUMBER_OF_PROCESSORS%\nS:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)\nS:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)(A;;GA;;;AC)\n\\\\\\\\.\\\\AVGIDSShim\nFFD3\\\\\\\\.\\\\NPF_NdisWanIpc:\\\\sample\\\\pos.exe\nANALYSERS\nSANDBOX\nVIRUS\nMALWARE\nFORTINETMALNETVMc:\\\\analysis\\\\sandboxstarter.exec:\\\\analysisc:\\\\insidetmc:\\\\windows\\\\system32\\\\drivers\\\\vmmouse.sys\nc:\\\\windows\\\\system32\\\\drivers\\\\vmhgfs.sys\nc:\\\\windows\\\\system32\\\\drivers\\\\vboxmouse.sys\nc:\\\\iDEFENSEc:\\\\popupkiller.exe\nc:\\\\tools\\\\execute.exe\nc:\\\\Perlc:\\\\Python27api_log.dll\ndir_watch.dll\npstorec.dll\ndbghelp.dll\nProcess32NextW\nSoftware\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\Zones\\\\3\n1406.bitMiniDumpWriteDump\n\\r\\nReferer: %s\\r\\n\n\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Cache\nvar %s = new ActiveXObject(\"WScript.Shell\"); %s.Run(\"%s\");\nIntelPowerAgent32\n%OS%_%NUMBER_OF_PROCESSORS%\n%s\\cmd.exe\nComSpec\nConsoleWindowClass\n.exekernel32.dllntdll.dll\nZwQuerySystemInformationZwAllocateVirtualMemory\nPsLookupProcessByProcessId\nPsReferencePrimaryToken\nClass\nWindow\nopen \"%s\" -q%windir%\\\\system32\\\\sdbinst.exe\n \/c \"start \"\" \"%s\" -d\"\n%windir%\\\\system32\\\\sndvol.exe\n \"%s\" -u \/c \"%s\\\\SysWOW64\\\\SysSndVol.exe \/c \"start \"\" \"%s\" -d\"\"\n%temp%\\\\%u\n%u.tmp\nWow64DisableWow64FsRedirection\nWow64RevertWow64FsRedirection\nrunas.exe\n%systemroot%\\\\system32\\\\svchost.exe\n%systemroot%\\\\system32\\\\wscript.exe\nsnxhk.dll\nsbiedll.dll\n \/c start \"\" \"%s\" \" \"\ncmd.exe\nrunas\n --crypt-test\nIt work's!\n --vm-test\n\nExploit Injector with Embedded CVE-2016-0167 Exploits\nThe exploit injector is used to gain SYSTEM privileges on the infected host. The injector contains the actual exploits for both x86 and x64 systems. The magic PE bytes (\"MZ\") at the beginning of the files are patched will null bytes to prevent them from automatic extraction.\n\nThe second stage injector checks for the current process' integrity level and the OS version. If the integrity level of the process is low and the OS version is 6.1 (Windows 7 \/ Windows Server 2008 R2), the second stage injector writes the exploit injector file into memory. Then, it searches for the magic value 0x99999999 in the exploit injector which marks the beginning of the PE overlay. When the address was found, 12 bytes are added and the second stage injector jumps to this address which is in fact a custom PE loader shellcode. The call to the shellcode looks as follows:\n00401EF5   pusha\n00401EF6   add esi, 0Ch\n00401EF9   call esi   -&gt; PE loader shellcode in overlay\n00401EFB   popa\n\nCustom PE loader shellcode\n\nIt first gets the end of the shellcode which is then used to scan the exploit injector file for the magic PE number (\"MZ\"). The code to get end of the shellcode looks as follows:\n00077174   jmp short 00077178\n00077176   pop eax\n00077177   retn\n00077178   call 00077176\n\nNext, a custom GetProcAddress() function is used together with a hashing function to find the address of VirtualAllocEx(). Then, VirtualAllocEx() is called to allocate a memory buffer of with full access rights into which the exploit injectors sections are written with the appropriate memory alignments. The necessary memory addresses are then adjusted with help of the relocation information, the API function addresses are resolved and the IAT is filled. Finally, the shellcode jumps to the DLL entry point of the freshly created exploit injector module.\n\nExploit injector\n\nAt first, the strings \"kernel32.dll\", \"LoadLibrary\" and \"GetProcAddress\" are created. Next, the image base address for kernel32.dll is searched and the addresses of LoadLibrary() and GetProcAddress() are obtained. With help of these API functions, the IAT addresses of the exploit injector get resolved and the IAT is filled. The purpose of this function is unclear, as it was already done by the second stage injector. Thereafter, a new thread gets created with API function CreateThread().\n\nThe thread first calls IsWow64Process() and according to the result either the embedded x86 or x64 version of the exploit file is written into a memory buffer. Next, the PE magic value (\"MZ\") is written to the beginning of the exploit file. Then, an event named \"WaitEventX\" is created which is later used by the exploit. Then, the main exploit loading function is called.\n\nThe exploit loading function searches for the following process names and if found also the module names for the following strings which are part of Trend Micro security software:\n\n \t\"uiSeAgnt.exe\"\n \t\"PtSessionAgent.exe\"\n \t\"PwmSvc.exe\"\n \t\"coreServiceShell.exe\"\n\nIf one of the processes is found, a suspended process of wuauclt.exe is created. Otherwise, a suspended process of svchost.exe is created. In both cases, the command line argument \"-k netsvcs\" is passed, but can be only used by svchost.exe. It should be noted that this functionality always fails if the x64 version of Trend Micro Internet Security is installed. The code (x86) calls CreateToolhelp32Snapshot() on a x64 process which results in an error (ERROR_PARTIAL_COPY). Moreover, it also fails because the code tries to access a protected Trend Micro process (ERROR_ACCESS_DENIED).\n\nNext, it maps the x86 or x64 file of the exploit into memory with CreateFileMapping() and MapViewOfFile() and fills in the memory with the exploit bytes. Finally, the section gets mapped into the suspended process of svchost.exe or wuauclt.exe by using ZwMapViewOfSection(). It then checks the OS version if it is 5.2 (Windows Server 2003 \/ Windows XP 64-Bit Edition) and exits the function if so. Afterwards, two memory buffers are created and a shellcode is written to each of them. The first obfuscated shellcode calls the second shellcode, which is a stager for the mapped exploit file. Next, it calls ResumeThread() to execute the suspended process so the exploit is executed.\n\nThe second stage injector verifies that the exploit was successful by checking if the integrity level of itself is still SECURITY_MANDATORY_LOW_RID. If not, the exploit successfully elevated privileges to SECURITY_MANDATORY_SYSTEM_RID and continues with the injection of the main payload. If the exploit failed, it tries to execute itself under the SYSTEM user account with help of the Windows command line (cmd.exe) and runas.exe tool.\nAtom String Building\nInstead of using a mutex like most of today\u2019s malware, the second stage injector creates an atom and checks the global atom table to see if an instance of Shifu is already running.\n\nAt first, it uses the template string \"%OS%_%NUMBER_OF_PROCESSORS%\" for the API ExpandEnvironmentStrings() to get the Windows version and number of processors. For example, in Windows 7 with one processor the result would be \"Windows_NT_1\". This string is then used to calculate four CRC32 hashes with RtlComputeCrc32() and the following initial values:\n\n \t0xFFFFFFFF\n \t0xEEEEEEEE\n \t0xAAAAAAAA\n \t0x77777777\n\nThe resulting CRC hashes of the string \"Windows_NT_1\" are as follows:\n\n \t0x395693AE\n \t0xB24495D2\n \t0xF39F86E1\n \t0xBAE0B5C8\n\nNext, the last byte of each CRC hash is stored as a DWORD value on the stack:\n\n \t0xAE000000 (from 0x395693AE)\n \t0xD2000000 (from 0xB24495D2)\n \t0xE1000000 (from 0xF39F86E1)\n \t0xC8000000 (from 0xBAE0B5C8)\n\nThe stack with the hash byte sequence looks as follows:\nAE 00 00 00 D2 00 00 00 E1 00 00 00 C8 00 00 00\nThe atom string is then created by converting first 8 bytes of the hash byte sequence to ASCII characters with snprintf() function. The result in this case would be:\n\"ae000000d2000000\"\nAt last, it calls GlobalFindAtom() API to check if the atom is present and calls GlobalAddAtom() if not.\n\n\n\nFigure 3. Shifu atom in the global atom table\nCommand Line Arguments\nThe second stage injector has two command line parameters of which only one has a functionality. They may be used for an upcoming feature or were just forgotten to be removed.\n\n \t--crypt-test\n\nShows just a message box with the text \"It work's!\"\n\n \t--vm-test\n\nNo functionality\nAnti-Analysis Tricks\nAnti Sandboxie \/ Avast\n\nShifu checks if the module snxhk.dll (Avast) or sbiedll.dll (Sandboxie) is present in its own process space by calling GetModuleHandleA() and runs an infinite Sleep() loop if a handle is returned.\n\nAll the following anti analysis tricks are only used if Shifu is executed on a 32-bit Windows machine (no Wow64 process).\n\nProcess name detection\n\nIt enumerates running process names, converts them to lowercase, calculates the CRC32 hashes of those names and compares to the following list:\n\n \t0x99DD4432 - ?\n \t0x1F413C1F - vmwaretray.exe\n \t0x6D3323D9 - vmusrvc.exe\n \t0x3BFFF885 - vmsrvc.exe\n \t0x64340DCE - ?\n \t0x63C54474 - vboxtray.exe\n \t0x2B05B17D - ?\n \t0xF725433E - ?\n \t0x77AE10F7 - ?\n \t0xCE7D304E - dumpcap.exe\n \t0xAF2015F2 - ollydbg.exe\n \t0x31FD677C - importrec.exe\n \t0x6E9AD238 - petools.exe\n \t0xE90ACC42 - idag.exe\n \t0x4231F0AD - sysanalyzer.exe\n \t0xD20981E0 - sniff_hit.exe\n \t0xCCEA165E - scktool.exe\n \t0xFCA978AC - proc_analyzer.exe\n \t0x46FA37FB - hookexplorer.exe\n \t0xEEBF618A - multi_pot.exe\n \t0x06AAAE60 - idaq.exe\n \t0x5BA9B1FE - procmon.exe\n \t0x3CE2BEF3 - regmon.exe\n \t0xA945E459 - procexp.exe\n \t0x877A154B - peid.exe\n \t0x33495995 - autoruns.exe\n \t0x68684B33 - autorunsc.exe\n \t0xB4364A7A - ?\n \t0x9305F80D - imul.exe\n \t0xC4AAED42 - emul.exe\n \t0x14078D5B - apispy.exe\n \t0x7E3DF4F6 - ?\n \t0xD3B48D5B - hookanaapp.exe\n \t0x332FD095 - fortitracer.exe\n \t0x2D6A6921 - ?\n \t0x2AAA273B - joeboxserver.exe\n \t0x777BE06C - joeboxcontrol.exe\n \t0x954B35E8 - ?\n \t0x870E13A2 - ?\n\nFile detection\n\nShifu checks if the following files or folders exist on the system and runs an infinite Sleep() loop if so:\n\n \tc:\\sample\\pos.exe\n \tc:\\analysis\\sandboxstarter.exe\n \tc:\\analysis\n \tc:\\insidetm\n \tc:\\windows\\system32\\drivers\\vmmouse.sys\n \tc:\\windows\\system32\\drivers\\vmhgfs.sys\n \tc:\\windows\\system32\\drivers\\vboxmouse.sys\n \tc:\\iDEFENSE\n \tc:\\popupkiller.exe\n \tc:\\tools\\execute.exe\n \tc:\\Perl\n \tc:\\Python27\n\nDebugger detection\n\nIt checks if it\u2019s being debugged by calling IsDebuggerPresent(). Also, it calls ZwQueryInformationSystem() with ProcessDebugPort and ProcessDebugObjectHandle to check for a debugger presence. If a debugger is detected it runs an infinite Sleep() loop.\n\nWireshark detection\n\nShifu attempts to open \\\\.\\NPF_NdisWanIp with CreateFile() and will enter an infinite Sleep() loop if it is successful.\n\nSelf-sanity checks\n\nIt checks its own file name length if it is longer than 30 characters and runs an infinite Sleep() loop if so. Also, it checks if its own process name CRC32 hash matches one of the following:\n\n \t0xE84126B8 - sample.exe\n \t0x0A84E285 - ?\n \t0x3C164BED - ?\n \t0xC19DADCE - ?\n \t0xA07ACEDD - ?\n \t0xD254F323 - ?\n \t0xF3C4E556 - ?\n \t0xF8782263 - ?\n \t0xCA96016D - ?\n\nFurthermore, it checks if one of the following modules from GFI Sandbox is present in its own process address space:\n\n \tapi_log.dll\n \tdir_watch.dll\n \tpstorec.dll\n\nUnknown anti-analysis trick\n\nShifu uses an anti-analysis trick whose purpose is unknown to us. It retrieves the address of Process32NextW() and compares the first 5 bytes with the sequence 0x33C0C20800 which disassembles to:\n33C0\u00a0\u00a0XOR EAX,EAX\nC2 0800   RETN 8\n\nThis code is only present in 32-bit Windows XP and not in later Windows versions, because the Unicode version of that function probably wasn't implemented yet. If the code sequence is found meaning that Shifu was executed on 32-bit Windows XP, it runs an infinite Sleep() loop.\n\nWindows domain name check\n\nIt checks if the computer workgroup name is either \"WORKGROUP\" or \"HOME\" with API functions NetServerGetInfo() and NetWkstaGetInfo() and runs an infinite Sleep() loop otherwise. Next, it checks for the name \"ANALYSERS\" and runs the infinite loop if found.\n\nComputer and user name check\n\nShifu gets the computer and user name with GetComputerName() and GetUserName() to check for the following strings:\n\n \tSANDBOX\n \tFORTINET\n \tVIRUS\n \tMALWARE\n \tMALNETVM\n\nIf one is found it runs an infinite loop.\n\nProcess termination feature\n\nSecond stage injector of Shifu enumerates all running processes, converts every name to lower case, calculates the CRC32 hash of it and compares it to the following ones:\n\n \t0xD2EFC6C4 - python.exe\n \t0xE185BD8C - pythonw.exe\n \t0xDE1BACD2 - perl.exe\n \t0xF2EAA55E - autoit3.exe\n \t0xB8BED542 - ?\n\nIf one matches, it first tries to terminate the process with OpenProcess() and TerminateProcess(). If that fails, it tries to close the main window handle of the process if it is flagged as HANDLE_FLAG_PROTECT_FROM_CLOSE with ZwClose(). Then, it opens the process with full access rights and unmaps it from memory with ZwUnmapViewOfSection(). At last, the main window handle of the unmapped process is closed.\nMain Payload Decryption, Unpacking and Injection\nTo decrypt the main payload, the second stage injector retrieves a salt needed for the decryption algorithm from its .rsrc section. It uses a modified RC4 algorithm where the salt is used to XOR the array of 256 bytes byte after byte at the beginning. The encrypted array is then used to decrypt the main payload located in the .tls section. The decrypted main payload is additionally packed with the aPLib compression library.\n\nIf the initial loader runs as a medium or high integrity level process, the routine which calculates the atom string name is called again. This time, only the first 4 bytes are used to build a string, for example \"ae000000\". Next, the CRC32 hash of this string is calculated and used to XOR another array of 256 bytes starting from 0x0 to 0xFF. This encrypted array is then used to again encrypt the decrypted main payload. The resulting encrypted data are written to registry for persistence purposes under the key \"HKCU\\software\\microsoft\\windows\" with a random CRC32 hash name, for example \"f4e64d63\". Also, a second value with the string \"ae000000\" as name is created and filled up with null bytes and the path of the initial loader, for example \"C:\\ProgramData\\7d5d6044.exe\". At last, the temporarily encrypted main payload gets decrypted again.\n\n\n\nFigure 4. Encrypted main payload and initial loader path stored in the Windows registry\n\nNext, the main payload gets unpacked into memory. Thereafter, a suspended svchost.exe process (x86) is created with the same integrity level as the parent process. The main payload gets mapped into the process and the magic PE value (MZ) patched. The svchost process gets then resumed so the main payload is executed. At last, a batch file is created and executed in the %TEMP% folder. It overwrites the original executed initial loader with a random number of bytes to cover the tracks. The random bytes are always followed by a space character and the CR LF control characters.\nMain Payload Analysis\nThe main payload module's IAT function names were XORed with the key 0xFF to make static analysis more difficult. Significant strings in the .data section are also XORed with the key 0x8D and get decrypted on-the-fly. Decrypted strings:\nAddMandatoryAce\nADVAPI\nAdvapi32.dlladvapi32.dllws2_32.dll\nWPUCloseEvent\nWPUCloseSocketHandleWPUCreateEvent\nWPUCreateSocketHandle\nWPUFDIsSet\nWPUGetProviderPath\nWPUModifyIFSHandle\nWPUPostMessage\nWPUQueryBlockingCallbackWPUQuerySocketHandleContext\nWPUQueueApc\nWPUResetEvent\nWPUSetEvent\nWPUOpenCurrentThreadWPUCloseThread\nWSPStartup\nABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/echo \n &gt; %1\\r\\ndel %0\nrundll32.exe shell32.dll, ShellExec_RunDLL %s\nsoftware\\\\microsoft\\\\windows\\\\currentversion\\\\run\nMicrosoft\\\\Microsoft AntimalwareSoftware\\\\Coranti\nSoftware\\\\risingSoftware\\\\TrendMicroSoftware\\\\Symantec\nSoftware\\\\ComodoGroup\nSoftware\\\\Network Associates\\\\TVD\nSoftware\\\\Data Fellows\\\\F-SecureSoftware\\\\Eset\\\\Nod\nSoftware\\\\Softed\\\\ViGUARD\nSoftware\\\\Zone Labs\\\\ZoneAlarm\nSoftware\\\\Avg\nSoftware\\\\VBA32\nSoftware\\\\Doctor WebSoftware\\\\G DataSoftware\\\\Avira\nSoftware\\\\AVAST Software\\\\Avast\nSoftware\\\\KasperskyLab\\\\protected\nSoftware\\\\Bitdefender\nSoftware\\\\Panda SoftwareSoftware\\\\Sophos.bat|$$$}rstuvwxyz{$$$$$$$&gt;?@ABCDEFGHIJKLMNOPQRSTUVW$$$$$$XYZ[\\\\]^_`abcdefghijklmnop\nq\n\\\\\\\\.\\\\%C:\nconhost\nCreateProcessInternalW\nConvertStringSecurityDescriptorToSecurityDescriptorWContent-Type: application\/x-www-form-urlencoded\\r\\n\nContent-Type: multipart\/form-data; boundary=---------------------------%s\\r\\n\nHost: %s\\r\\n%d.%d.%d.%d\n%d.%d.%d.%d.%x\n%temp%\\\\debug_file.txt\n[%u][%s:%s:%u][0x%x;0x%x] %sDnsFlushResolverCache\n\\\\*.*\ndnsapi.dll\nDnsGetCacheDataTable.dll.exedownload.windowsupdate.com\nvk.com\nyandex.ru\nHTTP\/1.1https:\/\/http:\/\/%s\nIsWow64Process\nkernel\nkernel32.dllLdrGetProcedureAddress\nMicrosoft\nNtAllocateVirtualMemory\nCLOSED\nLAST_ACKTIME_WAIT\nDELETE_TCB\nLISTEN\nSYN_SENTSYN_RCVDESTAB\nFIN_WAIT1\nFIN_WAIT2\nCLOSE_WAIT\nCLOSING\nTCP\\t%s:%d\\t%s:%d\\t%s\\n\nnetstat\\nProto\\tLocal address\\tRemote address\\tState\\n\nntdll.dll\nNtResumeProcess\nNtSuspendProcess\\\\\\\\?\\\\globalroot\\\\systemroot\\\\system32\\\\drivers\\\\null.sys\nNtWriteVirtualMemoryopenRegisterApplicationRestart\nRtlCreateUserThread\nResetSR\nRtlComputeCrc32\nrundll32SeDebugPrivilegeSystemDrive\n\\\\StringFileInfo\\\\%04x%04x\\\\ProductName\nsoftware\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon\nshell\nSleep\nsrclient.dllSeShutdownPrivilege\n\\\"%s\\\"\n%d\\t%s\\ntaskmgr\\nPID\\tProcess name\\nnet user\\n\nthe computer is joined to a domain\\n..\n\\\\VarFileInfo\\\\Translation\n%windir%\\\\system32\\\\%windir%\\\\syswow64\\\\POST*.exe\n%SystemDrive%\\\\\n*SYSTEM*%02x%s:Zone.Identifier\nGetProcessUserModeExceptionPolicy\nSetProcessUserModeExceptionPolicy\n%ws\\\\%ws\\n\nWORKGROUP\nHOMEsoftware\\\\microsoft\\\\windowsSoftware\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\ExplorerDisableCurrentUserRun\n%s.dat\n%OS%_%NUMBER_OF_PROCESSORS%\nS:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)\nS:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)(A;;GA;;;AC)\n\\\\\\\\.\\\\AVGIDSShim\nFFD3\\\\\\\\.\\\\NPF_NdisWanIpc:\\\\sample\\\\pos.exe\nANALYSERS\nSANDBOX\nVIRUS\nMALWARE\nFORTINETMALNETVMc:\\\\analysis\\\\sandboxstarter.exec:\\\\analysisc:\\\\insidetmc:\\\\windows\\\\system32\\\\drivers\\\\vmmouse.sys\nc:\\\\windows\\\\system32\\\\drivers\\\\vmhgfs.sys\nc:\\\\windows\\\\system32\\\\drivers\\\\vboxmouse.sys\nc:\\\\iDEFENSEc:\\\\popupkiller.exe\nc:\\\\tools\\\\execute.exe\nc:\\\\Perlc:\\\\Python27api_log.dll\ndir_watch.dll\npstorec.dll\ndbghelp.dll\nProcess32NextW\n1406Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\Zones\\\\3\n.bitMiniDumpWriteDump\n\\r\\nReferer: %s\\r\\n\n\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Cache\nvar %s = new ActiveXObject(\"WScript.Shell\"); %s.Run(\"%s\");\nGenuineIntelAuthenticAMDCentaurHauls7z\nfnbqooqdaixfueangywblgabirdgvkewdyqgfqaioluesyrpryfkjerfsouemaxnavrkguxmcmhckwprunurmhehclermtufwiyjbqhwlunbun\nuumeowfjmerxppxrgaxukyx\nPowerManager_M5VKII_%d\n[type=ftp]\\n[botid=%s]\\n[proc=%s]\\n[data=%s]\\n\n[type=pop3]\\n[botid=%s]\\n[proc=%s]\\n[data=%s]\\n\n%OS%_%NUMBER_OF_PROCESSORS%\n[type=post]\\n[botid=%s]\\n[url=%s]\\n[ua=%s]\\n[proc=%s]\\n[ref=%s]\\n[keys=%s]\\n[data=%s]\\n\nname=%s&amp;ok=%s&amp;id=%d&amp;res_code=%d&amp;res_text=%s_%x\nname=%s&amp;ok=%s&amp;id=%d&amp;res_code=%d&amp;res_text=%s\nbotid=%s&amp;ver=%s.%u&amp;up=%u&amp;os=%u&amp;ltime=%s%d&amp;token=%d&amp;cn=%s&amp;av=%s&amp;dmn=%s&amp;mitm=%u\njava.exe|javaw.exe|plugin-container.exe|acrobat.exe|acrod32.exe\ntellerplus|bancline|fidelity|micrsolv|bankman|vanity|episys|jack \nhenry|cruisenet|gplusmain|silverlake|v48d0250s1Root|TrustedPeople|SMS|Remote Desktop|REQUEST\nTREASURE|BUH|BANK|ACCOUNT|CASH|FINAN|MONEY|MANAGE|OPER|DIRECT|ROSPIL|CAPO|BOSS|TRADEactive_bc\n-----------------------------%s\\r\\nContent-Disposition: form-data; name=\\\"pcname\\\"\\r\\n\\r\\n%s!%s\\r\\n-----------------------------\n%s\\r\\nContent-Disposition: form-data; name=\\\"file\\\"; filename=\\\"report\\\"\\r\\nContent-Type: text\/plain\\r\\n\\r\\n%s\\r\\n--------------\n---------------%s--\\r\\n\n%domain%deactivebc\ninject\nkill_os\nloadactive_sk\ndeactive_sk\nwipe_cookiesmitm_modmitm_script\nmitm_geterr\nget_keylog\nget_sols!active_bc\\[(\\d+)\\] (\\S+) (\\d+)\n!deactive_bc\\[(\\d+)\\]\n!inject\\[(\\d+)\\] (\\S+)\n!kill_os\\[(\\d+)\\]\n!get_keylog\\[(\\d+)\\]!load\\[(\\d+)\\] (\\S+)!update\\[(\\d+)\\] (\\S+)\n!wipe_cookies\\[(\\d+)\\]\n!active_sk\\[(\\d+)\\] (\\S+) (\\d+)\n!deactive_sk\\[(\\d+)\\]\n!mitm_mod\\[(\\d+)\\] (\\S+) (\\d+) (\\S+)!mitm_script\\[(\\d+)\\] (\\S+)\n!mitm_geterr\\[(\\d+)\\]\n!get_sols\\[(\\d+)\\]\nATCASH\nATLOCAL\nCERTCERTX\nCOLVCRAIF\nCRYPT\nCTERM\nSCREEN\nINTER\nELBALOCAL\nELBAWEB\nELBAWEB\nELBAWEB\nPUTTY\nVNCVIEW\nMCLOCAL\nMCSIGN\nOPENVPN\nPIPEK\nPIPEK\nPIPEK\nPIPEK\nPOSTSAP\nchrome.dll\nmxwebkit.dlldragon_s.dlliron.dllvivaldi.dll\nnspr4.dll\nnss3.dllbrowser.dll\nAdvapi32.dllrsaenh.dll\nkernel32.dllIprivLibEx.dll\ncryptui.dll\ncrypt32.dll\nntdll.dll\nssleay32.dllurlmon.dll\nuser32.dll\nWininet.dll\nWs2_32.dll\nPSAPI.dll\nNzBrco.dll\nVirtualProtect\nLoadLibraryExW\nZwQuerySystemInformationWSARecv\nWSASend\nZwDeviceIoControlFile\nURLDownloadToCacheFileW\nURLDownloadToFileW\nTranslateMessageSSL_get_fd\nSSL_write\nPFXImportCertStore\nCryptEncryptCPExportKey\nCreateProcessInternalW\nCreateDialogParamW\nGetClipboardDatagetaddrinfo\ngethostbyname\nGetAddrInfoExW\nGetMessageA\nGetMessageW\nDeleteFileA\nGetModuleBaseNameW\nbad port value\ncan't find plug-in path\ncan't get bot path\ncan't download file\ncan't encrypt file\ncan't save inject config to filecan't get temp file\nfile is not valid PEcan't delete original file\ncan't replace original file\ncan't close handle\ncan't protect file\noriginal file not found\ncan't execute file\ncan't create directory\ncan't unzip file #1\ncan't unzip file #2\nmitm_mod is inactivehttpd.exe is anactive\nmicrosoft.com\ndropbox.com\nKEYGRAB\nPasswordTELEMACOScelta e Login dispositivo\nTLQ Web\ndb Corporate Banking WebSecureStoreCSP - enter PIN\ngoogle.com\nSoftware\\\\SimonTatham\\\\PuTTYreg.txt\nSoftware\\\\Microsoft\\\\Internet Explorer\\\\MainTabProcGrowth\nTemp\\\\Low\n crc32[%x]\nACCT \nAUTHINFO PASS \nAUTHINFO USER \nAuthorization\n:BA:[bks]\n%X!%X!%08X\nbtc_path.txtbtc_wallet.dat\nbitcoin\\\\wallet.dat\n%s%s\\\\%u_cert.pfx\ncmdline.txt\n1.3.6.1.5.5.7.3.3\nCodeSign\\n\nSoftware\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\n[del]\nDefault\n.exeELBA5\\\\ELBA_dataftp:\/\/anonymous:ftp:\/\/%s:%s@%s:%d\\n\nHBPData\\\\hbp.profileHH:mm:ssdd:MMM:yyyy\nI_CryptUIProtect\\\\exe\\\\\ninfected.exx%s%s\\\\%u_info.txt\n[ins]\nInstallDate\n%02u.jpg%s\\\\%02d.jpgKEYLOG\n%s\\\\keylog.txt\n[TOKEN ON]\n\\n\\n[%s (%s-%s) - %s (%s)]\\n[pst]%s[\/pst]\nltcd_path.txt\nltcd_wallet.dat\nlitecoind\\\\wallet.dat\nltc_path.txtltc_wallet.dat\nlitecoin\\\\wallet.dat\\\\MacromediaMultiCash@Sign\nC:\\\\Omikron\\\\MCSign\n[ML][MR]Global\\\\{4C470E-%08x-%08x-%08x}\nGlobal\\\\{DAN6J0-%s}\nnoneopera.exe\nPASS \npassword.txt\\\\\\\\.\\\\pipe\\\\%s\npop3:\/\/%s:%s@%s:%d\\n%PROCESSOR_ARCHITECTURE%Referer\n[ret]\n%08x\\\\system32\\\\rstrui.exe\n\\\\scrs\\\\send%s%s%s%d%s:%s\nsysinfo.txt\n[tab]\ndata.txt&lt;unnamed&gt;\n&lt;untitled&gt;\nupdate\nUSER \nUser-agent\nvkeys\n%x\\r\\n\n\\r\\n%x%x%x.tmp\n\\\\*.txt\n%02x%2b\ntorrent\n-config config.vnc\n--config \nconfig.ovpn\ndata.txt[type=post]\\n\nCreateFileW\npos.exe\nbank.exePOS\nsecure.\n.mozgoogle.com\nCertVerifyCertificateChainPolicyCertGetCertificateChain\nSSL_AuthCertificateHook\nUSERNAMESoftware\\\\ESET\\\\ESET Security\\\\CurrentVersion\\\\Info\nC8FFAD27AE1BBE28BE24DDF20AF36EF901C609968930ED82CEFBC64808BA34102C4FABA0560523FB4CCBF33684F77C8401DFB\n3A7D2D598E872DD78033E7F900B78A0C710CDF0941662FF7745A435D4BC18D5661E0582B21B2DB8FCA1C0CA3401D0FC9F051\n85A558AB6A76A010F606CD77B35A480B6B7176F0903299B91F1BBD141B4D33615849C35557357DAB819BC3D4A8722BB433DE\nB66C7A326BE859BD94930331B37DEE6EF4C475EA4B33DE4699FFDBCD34E196E19FE630E631D2C612705048620183BCF56709B\n484A4380C4B00D8D94D131C31DB53AE6BCDCCC14131BAC99A68C59A604D0AE9116E9196F7FA3EA5F86F67E9B175CC09D3E17\n997728B7D\n10001\nget=1\nCOMPNAMEAppDataDir\nupdfiles\\\\upd.ver\nupdfiles\\\\lastupd.ver\nSYSTEM\\\\CurrentControlSet\\\\services\\\\Avg\\\\SystemValues\nLocal AppData\nAvg2015\nAvg2014\nAvg2013\nAvg2012\nAvg2011\nupdate\nSoftware\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\explorer\\\\Browser Helper Objects\\\\{8CA7E745-EF75-4E7B-BB86-\n8065C0CE29CA}\nSoftware\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\explorer\\\\Browser Helper Objects\\\\{BB62FFF4-41CB-4AFC-BB8C-\n2A4D4B42BBDC}\nSoftware\\\\Microsoft\\\\Internet Explorer\\\\MainEnable Browser Extensions\nhttpd.exe\n%s\\\\httpd.exe\nconnect\ndata\\\\index.php\nlogs\\\\error.log\nerror.log\n&lt;?\\n';\\n$bot_id = '\n$bot_net = '$key_log_file = '\n$process_file = '\n127.0.0.1\nListen %s:%u\\n\nconf\\\\httpd.confSSL_PORT%u&gt;\\n\n[type=post]\\n\n[type=screen]\\n\n[type=knock]\\n\n74??834E0440B832FFFFFF\n74??834E04405F5EB832FFFFFF\nDEBUG\nmemory.dmp\nconfig.xml\nphp5ts.dll\nzend_stream_fixup\nzend_compile_file\nindex.php\nconfig.php\ncontent.php\niexplore.exe|firefox.exe|chrome.exe|opera.exe|browser.exe|dragon.exe|epic.exe|sbrender.exe|vivaldi.exe|maxthon.exe|ybr\nowser.exe|microsoftedgecp.exe\nInternetQueryDataAvailable\nInternetReadFileInternetReadFileExA\nInternetReadFileExW\nInternetSetStatusCallbackA\nInternetSetStatusCallbackW\nHttpSendRequestAHttpSendRequestExA\nHttpSendRequestExW\nHttpSendRequestW\\r\\n0\\r\\n\\r\\n\n.rdata\n\\r\\n\\r\\nHTTP\/1.\nTransfer-Encoding\nchunked\nContent-Length\nclose\nProxy-ConnectionHostAccept-Encoding\nx-xss-protectionx-content-security-policy\nx-frame-options\nx-content-type-options\nIf-Modified-Since\nIf-None-Match\ncontent-security-policy\nx-webkit-cspConnection\nhttp:\/\/\nhttps:\/\/NSS layer\nContent-TypeBasic \nPR_ClosePR_Connect\nPR_GetNameForIdentity\nPR_Read\nPR_SetError\nPR_WriteReferer: \nAccept-Encoding:\\r\\n1406SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\3\ndata_after\\ndata_before\\n\ndata_enddata_inject\\n\nset_url %BOTID%\n%BOTNET%InternetCloseHandle\nHTMLc:\\\\inject.txt\nDalvik\/1.6.0 (Linux; U; Android 4.1.2; GT-N7000 Build\/JZO54K)\nxxx_process_0x%08x\nCommon.js\n\nAPI Obfuscation\nThe main payload uses an API obfuscation technique known as Push-Calc-Ret obfuscation. The calls to the real API functions are patched by the second stage injector after the main payload gets injected into the svchost process. Whenever a Windows API function should have been called, instead the address of a trampoline function is called which calculates the actual function address. All the trampoline function addresses are stored in an array in memory.\n\nFor example, the main payload wants to call CreateFile(), but this call is patched. Now, it calls the trampoline function which could look as follows:\n00846110   PUSH 2B464C25\n00846115   PUSHFD\n00846116   XOR DWORD PTR SS:[ESP+4], 5DB5E13F\n0084611E   POPFD\n0084611F   RETN\n\nFirst, a value is pushed to the stack. Next, the EFLAGS register is saved to the stack, because it will be altered by the following XOR instruction (OF, CF flags are cleared and the SF, ZF, and PF flags are set according to the result). Then, the previously pushed value is XORed with another value to calculate the actual API function address. At last, the EFLAGS register gets restored and the real API function address is called via the RETN instruction.\nPersistence Method\nThe main payload copies the initial obfuscated loader file to the %ProgramData% folder with a random file retrieved with GetTickCount(). Then, it creates a JScript file named \"Common.js\" in the Startup folder of the current user. The file contains the following code which runs the initial loader after the system was rebooted:\nvar yqvltidpue = new ActiveXObject(\"WScript.Shell\");\nyqvltidpue.Run(\"C:\\\\PROGRA~3\\\\930d4a6d.exe\")\n\nUpdates of the Main Payload compared to Previous Version\nReports on previous versions of Shifu have been published by FireEye and Fortinet.\n\nIn comparison to the previous version, the list of substrings to scan for in the string that gets created with the computer name, user name, install date and system drive volume serial number was expanded:\n\n \tTREASURE\n \tBUH\n \tBANK\n \tACCOUNT\n \tCASH\n \tFINAN\n \tMONEY\n \tMANAGE\n \tOPER\n \tDIRECT\n \tROSPIL\n \tCAPO\n \tBOSS\n \tTRADE\n\nUpdated command list:\n\n \tactive_sk\n \tdeactive_sk\n \tdeactivebc\n \tget_keylog\n \tget_sols\n \tinject\n \tkill_os\n \tload\n \tmitm_geterr\n \tmitm_mod\n \tmitm_script\n \twipe_cookies\n\nUpdated list of targeted browsers:\n\n \tiexplore.exe\n \tfirefox.exe\n \tchrome.exe\n \topera.exe\n \tbrowser.exe\n \tdragon.exe\n \tepic.exe\n \tsbrender.exe\n \tvivaldi.exe\n \tmaxthon.exe\n \tybrowser.exe\n \tmicrosoftedgecp.exe\n\nThe main payload will download the Apache httpd.exe server file from one of the C&amp;C servers to store it on disk for web injection purposes. Compared to the previous version, the main payload also contains two strings which indicate some functionality for the Zend PHP Framework:\n\n \tzend_stream_fixup\n \tzend_compile_file\n\nFunction Hooking in Svchost\nLike in the previous version, the malware hooks some API functions to redirect URLs, capture network traffic, the clipboard and to log keystrokes. It uses a technique known as inline function hooking where the first 5 bytes of a function get patched with a jump to the malware's hook handlers. The following functions get hooked:\n\n \tNtDeviceIoControlFile (ntdll.dll)\n \tZwDeviceIoControlFile (ntdll.dll)\n \tGetClipboardData (user32.dll)\n \tGetMessageA (user32.dll)\n \tGetMessageW (user32.dll)\n \tTranslateMessage (user32.dll)\n \tGetAddrInfoExW (ws2_32.dll)\n \tgethostbyname (ws2_32.dll)\n \tgetaddrinfo (ws2_32.dll)\n\nNetwork Functionality\nThe main payload of Shifu uses .bit top-level domains which is a decentralized DNS system based on the Namecoin infrastructure. The malware requests the IP addresses of the domains by subsequently contacting the following hardcoded Namecoin DNS servers:\n\n \t92.222.80.28\n \t78.138.97.93\n \t77.66.108.93\n\nThe C&amp;C domain names, the user-agent string and the URL parameters are encrypted with a modified RC4 encryption algorithm. Decrypted strings:\n\n \tklyatiemoskali.bit\n \tslavaukraine.bit\n \tMozilla\/5.0 (Windows; U; Windows NT 5.2 x64; en-US; rv:1.9a1) Gecko\/20061007 Minefield\/3.0a1\n \tL9mS3THljZylEx46ymJ2eqIdsEguKC15KnyQdfx4RTcVu8gCT\n \thttps:\/\/www.bing.com\n \t\/english\/imageupload.php\n \t\/english\/userlogin.php\n \t\/english\/userpanel.php\n \t1brz\n\nThe encrypted strings are stored in the following format inside the .data section:\n&lt;LengthOfString&gt;&lt;EncryptedString&gt;\nThe domain string \u201cklyatiemoskali\u201c means roughly translated to wish something bad to Muscovites. The second domain string \u201cslavaukraine\u201d means translated \u201cglory to the Ukraine\u201d. The included RC4 key \"L9mS3THljZylEx46ymJ2eqIdsEguKC15KnyQdfx4RTcVu8gCT\" is used to encrypt the network traffic.\n\nAt the time of analysis, only the following Namecoin DNS server was answering with the IP address of the actual C&amp;C server:\n77.66.108.93 (ns1.dk.dns.d0wn.biz)\n\n\nFigure 5. Namecoin DNS server information of 77.66.108.93\n\nThe following screenshot shows the captured network traffic during the dynamic analysis of Shifu:\n\n\n\nFigure 6. Shifu network traffic captured with Wireshark\n\nWe can see that Shifu subsequently queries the Namecoin DNS servers with the domain name klyatiemoskali.bit to get the IP address. After one name server responds with the IP address of the C&amp;C server, it does a TLS handshake to open an encrypted network channel. Finally, it sends some encrypted data and gets an encrypted answer. However, no further network traffic could have been observed during the time of the analysis. Both domain names, klyatiemoskali.bit and slavaukraine.bit, resolved to the IP address 103.199.16.106 at the time of analysis.\n\nAs the .bit top-level domain relies on the Namecoin cryptocurrency which is based on the Bitcoin system, every transaction can be traced back. Thus, we can use a Namecoin block explorer to look when the .bit domains were registered and which IP addresses are connected to it. For example, if we use the web service namecha.in, we can get the following information for klyatiemaskali.bit:\n\n\n\nWe can see the same information for slavaukraine.bit:\n\n\n\nBoth domains were registered on 2016-06-03 and only one IP address is assigned to them. This IP address coincides with the response of the Namecoin DNS server we have seen in the captured network traffic. Moreover, we can see the domain seems to be still active.\nURL Query String for C&amp;C Server\nThe main payload contains a query string template used to send information of the victim to the C&amp;C server:\n\nbotid=%s&amp;ver=%s.%u&amp;up=%u&amp;os=%u&amp;ltime=%s%d&amp;token=%d&amp;cn=%s&amp;av=%s&amp;dmn=%s&amp;mitm=%u\n\nWe can see that some information is dynamically retrieved (bot identifier, uptime, operating system version, local timestamp, token, anti-virus software, domain name of workstation, man in the middle interception detected), while also static values like the bot version and the campaign name are send. An example of the created query string could look as follows:\n\nbotid=26C47136!A5A4B18A!F2F924F2&amp;ver=1.759&amp;up=18294&amp;os=6110&amp;ltime=-8&amp;token=0&amp;cn=1brz&amp;av=&amp;dmn=&amp;mitm=0\n\nWe can see that the internal Shifu version is \u201c1.759\u201d and the campaign name is stated \u201c1brz\u201d.\n\nIf we compare Shifu's query string with the one of the latest Shiz version we have tracked which dates February 2014 (internal version 5.6.25), we can see the similarity between those two malwares:\n\nbotid=%s&amp;ver=5.6.25&amp;up=%u&amp;os=%03u&amp;ltime=%s%d&amp;token=%d&amp;cn=sochi&amp;av=%s\nModified RC4 Encryption Algorithm\nShifu uses a modified version of the RC4 encryption algorithm. We have reconstructed the algorithm in Python and show how the domain name \"klyatiemoskali.bit\" present in the main payload will be encrypted as an example:\nimport os\nimport binascii\n\n###initial values##########\nstring = \"klyatiemoskali.bit\"\nseed = \n\"fnbqooqdaixfueangywblgabirdgvkewdyqgfqaioluesyrpryfkjerfsouemaxnavrkguxmcmhckwprunurmhehclermtufwi\nyjbqhwlunbunuumeowfjmerxppxrgaxukyx\"\nbuffer = [0] * (len(string))\ntable_encr = [0] * 0x102\ntable_encr[0x100] = 1\ntable_encr[0x101] = 0\n###########################\n\n###string2buffer###########\ni = 0\nwhile (i&lt;len(string)):\n    char_1 = string[i]\n    int_1 = ord (char_1)\n    buffer[i] = int_1\n    i += 1\n###string2buffer###########\n\n###encryption table########\ni = 0\nwhile (i &lt; 0x100):\n    table_encr[i] = 0x000000ff&amp;i\n    i += 1\n\ni = 0\nj = 0\nwhile (i &lt; 0x100):\n    char_1 = seed[j]\n    int_2 = ord (char_1)\n    table_encr[i] ^= int_2\n    i += 1\n    j += 1\n    if (j == len(seed)):\n        j = 0\n###########################\n\n###encryption##############\nsize_1 = len(string)\ni = 0\nwhile (size_1 != 0):\n    byte_buf = buffer[i]\n    ind_1 = table_encr[0x100]\n    ind_2 = table_encr[ind_1]\n    ind_3 = 0x000000ff&amp;(ind_2 + table_encr[0x101])\n    ind_4 = 0x000000ff&amp;(table_encr[ind_3])\n    table_encr[ind_1] = ind_4\n    table_encr[ind_3] = ind_2\n    buffer[i] = 0x000000ff&amp;(table_encr[0x000000ff&amp;(ind_2 + ind_4)] ^ byte_buf)\n    table_encr[0x100] = 0x000000ff&amp;(ind_1 + 1)\n    table_encr[0x101] = ind_3\n    i += 1\n    size_1 -= 1\n\ni = 0\nstr_1 = \"\"\nwhile (i &lt; len(string)):\n    str_1 = str_1 + chr(buffer[i])\n    i += 1\n###########################\n    \n###output##################\nprint (\"Cleartext string: %s\" % string)\nprint (\"Encrypted: 0x%s\" % binascii.hexlify(str_1)) \n###########################\n\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Dominik Reichel"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.8' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?v1&#038;ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":23081,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"2eb9d84156","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.8" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"9bdf4edfa3"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.15" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/23081" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=23081' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.15 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="pingback" href="https://unit42.paloaltonetworks.com/xmlrpc.php"><link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

    </head>
<body class="post-template-default single single-post postid-23081 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}        
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
            if( pcontainer.indexOf('CloudCortex') != -1){
                referer = 'CloudCortex' ;
            }
            else{
                referer = 'Cortex' ;
            }	    
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            if( nContainer.indexOf('CloudCortex') != -1){
                                referer = 'CloudCortex';
                                sessionStorage.setItem("container","CloudCortex");
                            }
                            else{
                                referer = 'Cortex';
                                sessionStorage.setItem("container","Cortex");
                            }                            
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "CloudCortex" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'CloudCortex'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php?type=cortexcloud';
        searchResultsPagePath = referrer_domain+"/search/cortexcloudsearch";	
    }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php?type=unit42';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
            observer_lozad.observe();
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'CloudCortex' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'CloudCortex'){
        article.dataset.type = 'cloudcortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/cybercrime/" role="link" title="Cybercrime" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:breadcrumb:Cybercrime">Cybercrime</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/cybercrime/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:Cybercrime"><span class="ab-title__pre">Cybercrime</span></a> 
              <h1>2016 Updates to Shifu Banking Trojan</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 21</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:Dominik Reichel" href="https://unit42.paloaltonetworks.com/author/dominik-reichel/">Dominik Reichel</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>January 6, 2017</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:Cybercrime" href="https://unit42.paloaltonetworks.com/category/cybercrime/">Cybercrime</a></li><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:banking" href="https://unit42.paloaltonetworks.com/tag/banking/">Banking</a></li><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:Shifu" href="https://unit42.paloaltonetworks.com/tag/shifu/">Shifu</a></li><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:threat research" href="https://unit42.paloaltonetworks.com/tag/threat-research/">Threat research</a></li><li><a data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:Trojan" href="https://unit42.paloaltonetworks.com/tag/trojan/">Trojan</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/?pdf=download&#038;lg=en&#038;_wpnonce=9a032d742f" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/?pdf=print&#038;lg=en&#038;_wpnonce=9a032d742f" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/" role="link" title="Copy link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=2016%20Updates%20to%20Shifu%20Banking%20Trojan&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F&#038;title=2016%20Updates%20to%20Shifu%20Banking%20Trojan" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F&#038;text=2016%20Updates%20to%20Shifu%20Banking%20Trojan" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=2016%20Updates%20to%20Shifu%20Banking%20Trojan%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-2016-updates-shifu-banking-trojan%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-2016-updates-shifu-banking-trojan/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja"></span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h3>Overview</h3>
<p>Shifu is a Banking Trojan first discovered in 2015. Shifu is based on the Shiz source code which incorporated techniques used by Zeus. Attackers use Shifu to steal credentials for online banking websites around the world, starting in Russia but later including the UK, Italy, and others.</p>
<p>Palo Alto Networks Unit 42 research has found that the Shifu authors have evolved Shifu in 2016. Our research has found that Shifu has incorporated multiple new techniques to infect and evade detection on Microsoft Windows systems. Some of these include:</p>
<ul>
<li>Exploitation of <a href="https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0167">CVE-2016-0167</a> a Microsoft Windows Privilege Escalation vulnerability to gain SYSTEM level privileges. Earlier versions of Shifu exploited <a href="https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0003">CVE-2015-0003</a> to achieve the same goal</li>
<li>Use of a Windows atom to identify if the host is already infected with Shifu in addition to the mutex used by previous versions</li>
<li>Use of push-calc-ret API obfuscation to hide function calls from malware analysts</li>
<li>Use of alternative Namecoin .bit domains</li>
</ul>
<p>We have also identified new links between Shifu and other tools which suggest Shifu isnt simply based on the Shiz Trojan, but is probably the latest evolution of Shiz.</p>
<p>The primary goal of this report is to introduce Shifus new features to other malware analysts who may encounter this Trojan in the future. The following sections give an overview of the new features, and the appendix at the end includes the technical details on the overall functionality of Shifu.</p>
<h3>New Developments and Features in Shifu</h3>
<p>The Shifu version discussed in this analysis is comprised of several stages of payloads and was compiled in June 2016. The following image illustrates the different files included in the initial loader which get decrypted after execution:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_1.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23105 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_1.png" alt="shifu_1" width="402" height="750" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_1.png 402w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_1-161x300.png 161w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_1-370x690.png 370w" sizes="(max-width: 402px) 100vw, 402px" /></a></p>
<p><em>Figure 1. File structure of Shifu</em></p>
<p>The initial obfuscated loader (x86 exe) contains the encrypted second stage injector (x86 exe). It uses three layers for decryption by subsequently allocating memory via VirtualAlloc() for the next layer. The second stage injector gets decrypted into memory and the original loader process is then overwritten with it. Next, the section flags are adjusted and the IAT addresses are resolved. The final decryption layer then jumps to the entry point of the second stage injector.</p>
<p>The second stage injector contains two exploits for <a href="https://technet.microsoft.com/en-us/library/security/ms16-039.aspx">CVE-2016-0167</a> (x86/x64) that have a compilation time stamp dated February, 2016. At the time of compilation, patches were not yet available for this vulnerability. However, the malwares compilation time stamp dates June 2016. This may indicate the people behind this Shifu version had access to the zero-day exploit at that time or gained access to it afterwards. The exploit uses an interesting technique which makes it possible to just copy the raw disk file into memory. To make the file executable in memory, it uses a custom PE loader shellcode appended to both versions of the exploit as an PE overlay. The shellcode takes care of all the adjustments needed to get a proper executable memory image and executes the exploit. By doing so, the file just needs to be copied into a memory buffer and execution needs to be passed to the shellcode.</p>
<p>We have also found multiple other variants of the exploit, standalone versions (x86/64), but also versions which are embedded in an injector like in Shifu. Additionally, we identified a version of Vawtrak which contains an earlier version of the exploit dating back to November 2015, according to the compilation time stamp. The compilation time stamp of this Vawtrak sample itself dates January 2016 and thus is effectively the first malware known to us to use this exploit.</p>
<p>The second stage injector contains several anti-analysis tricks similar to the previous version. It also contains two command line parameters with functionality that indicate the malware is still in development. Further, the second stage injector uses an atom to check if the system is already infected, instead of using a mutex like most of the malware today. The use of atoms is not a new technique, but still not very widespread.</p>
<p>The main payload is encrypted and packed inside the .tls section of the second stage injector. It first gets decrypted and then unpacked with the aPLib compression library. As persistence method, the main payload copies the initial loader to the AppData folder and creates a Jscript file inside the Startup folder which points to it. The second stage injector injects the main payload inside a x86 instance of svchost and patches its API function calls with an obfuscation technique to make static and dynamic analysis of the malware more difficult.</p>
<p>Compared to the previous version, the main payload contains some updates. This includes the strings to search on the victims system, the browser target list, and the bot commands. The main payload uses .bit top-level domains to contact its C&amp;C server. The domain names, the user-agent string and the URL parameters are encrypted with a modified RC4 encryption algorithm. The domain names indicate that the attackers may be either located in Ukraine or have a Ukrainian background.</p>
<p>Unfortunately, at the time of the analysis the C&amp;C server didnt respond with any commands and thus further analysis of the targeted financial institutions wasnt possible. This information would be normally downloaded into a configuration file on the victims disk. For some of its functionality, the main payload hooks some API functions inside the svchost.exe process into which it is injected. Further, it uses the Apache web server for the web injections. If it was successfully downloaded from the C&amp;C server, the malware makes use of a layered service provider to hook into the Winsock API for intercepting and modifying inbound and outbound Internet traffic. It also contains the normally used methods to hook into the browsers networking functions found in many other banking Trojans.</p>
<p>Both the second stage injector and the main payload contain a lot of strings which are never used. This indicates the author(s) were either in a rush to build the malware or the development was done in a sloppy way.</p>
<p>Instead of the string IntelPowerAgent6 seen in the last version, this sample contains the string IntelPowerAgent32 which is never used. In addition to the atom created by the second stage injector to check if the system is already infected, the main payload also creates a mutex with a name based on the same procedure to create the name for the atom (see Appendix). However, the mutex uses a hardcoded prefix named DAN6J0- before the byte sequence that is also used for the atom string: {DAN6J0-ae000000d2000000e100}</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_2.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23102 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_2.png" alt="shifu_2" width="945" height="593" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_2.png 945w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_2-900x565.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_2-300x188.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_2-768x482.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_2-370x232.png 370w" sizes="(max-width: 945px) 100vw, 945px" /></a></p>
<p><em>Figure 2. Shifu mutex and the associated svchost process</em></p>
<h3>Shifu, Shiz and Other Related Tools</h3>
<p>The Shifu banking Trojan is mainly based on the Shiz/iBank source code, which is one of the oldest banking Trojans still in the wild today. Shiz was first discovered in 2006 and has been through several stages of development since that time. It began as a banking Trojan which only focused on Russian financial institutions. Later, it also began targeting an Italian bank which may have set the stage for a more international focus. The internal versions we have tracked over the last five years ranged from generation 2 to 4 (2011) and 5 (2013/2014). The fifth generation of Shiz was the last one we saw in the wild in 2014 (last internal version was 5.6.25) and it differs from the 4th generation in the coding style. It looks like it was developed by another coder, which could indicate the source code was sold or shared. The query string used to contact the C&amp;C server of one of the very first versions of the fifth generation supports our theory:</p>
<p>botid=%s&amp;ver=5.0.1&amp;up=%u&amp;os=%03u&amp;ltime=%s%d&amp;token=%d&amp;cn=reborn&amp;av=%s</p>
<p>We can see that the campaign name (cn) contains the string reborn.</p>
<p>Shifu was first discovered in the wild in the middle of 2015 and we believe it's the evolution of the 5th generation of Shiz with a more international focus.</p>
<p>We have not only tracked the Shiz banking Trojan over the last couple of years, but also found several additional malware tools allegedly from the same author(s). Collected samples indicate the author(s) have developed a whole set of financially related malware. Its not clear if the author works as part of a group or uses the malware themselves. These tools are mainly based on the source code of the fifth generation of Shiz.</p>
<p>We have connected these tools together because they all contain a PDB path that has the same root folder:</p>
<p>Z:\coding\...</p>
<p>Furthermore, most of the tools are based on the Shiz source code, because the coding style and used API functions are very similar. Also, comparing the code between the tools with BinDiff shows a high degree of similarity. Moreover, those tools with network functionality contain query strings similar to the one in Shiz to contact their C&amp;C server.</p>
<p>As our colleagues from <a href="https://www.fireeye.com/blog/threat-research/2015/10/shifu-malware-analyzed-behavior-capabilities-and.html">FireEye described last year</a>, the PDB path found in Shifu is as follows:</p>
<p>Z:\coding\project\main\payload\payload.x86.pdb</p>
<p>Other tools we have identified have the following PDB paths and are likely from the same author(s):</p>
<p>Z:\coding\cryptor\Release\crypted.pdb</p>
<p>Z:\coding\malware\tests\Release\cryptoshit.pdb</p>
<p>Z:\coding\malware\RDP\output\Release\rdp_bot.pdb</p>
<p>Z:\coding\malware\ScanBot\Release\bot.pdb</p>
<p>The malware internally named "cryptor" contains an encrypted sample of <a href="https://securelist.com/blog/virus-watch/59901/lock-stock-and-two-smoking-trojans-2/2/">BifitAgent</a>, the first malware known to attack the financial software from BIFIT. While it's possible that BifitAgent is developed from the same person, we haven't found any indications for that. According to the compilation time stamps, most of the samples were created in October/November 2013.</p>
<p>The malware with the name "rdp_bot" is a small bot which uses the RDP protocol to gain full access to a computer. It uses the same modified RC4 encryption algorithm as the Shifu version discussed in this article. This tool was probably used along the Shiz banking Trojan, because the attacker is able to do his fraudulent activities directly from the victims computer. By doing so, one could fool bank antifraud systems which check for the IP address, browser footprints or keyboard layouts. The tool is based on the <a href="https://de.slideshare.net/alisaesage/hacking-microsoft-remote-desktop-services-for-fun-and-profit">research about RDP</a> performed by Alisa Esage. The samples date from June to November 2013.</p>
<p>The tool which is named "cryptoshit" contains an encrypted sample of rdp_bot and also uses the same modified RC4 algorithm as the Shifu version described here. The samples date September/October 2013 and January 2014 according to the compilation time stamp.</p>
<p>The malware with the internal name "ScanBot" is a small backdoor which uses the Super Light Regular Expression library (SRLE) for scanning a victims computer for files via commands from its operator. The samples date June 2013 according to the time stamp.</p>
<h3>Protection Against Shifu</h3>
<p>Palo Alto Networks customers are protected from Shifu in the following ways:</p>
<ul>
<li>Wildfire classifies Shifu files as malicious and signatures are loaded into Threat Prevention</li>
<li>AutoFocus customers can track malware using the <a href="https://autofocus.paloaltonetworks.com/">Shifu</a> tag</li>
<li>Command and Control domains used by Shifu are blocked through Threat Prevention</li>
</ul>
<p><strong>SHA256 Hashes of Samples Discussed</strong></p>
<p><strong>Initial obfuscated loader</strong></p>
<p>d3f9c4037f8b4d24f2baff1e0940d2bf238032f9343d06478b5034d0981b2cd9<br />
368b23e6d9ec7843e537e9d6547777088cf36581076599d04846287a9162652b<br />
e7e154c65417f5594a8b4602db601ac39156b5758889f708dac7258e415d4a18<br />
f63ec1e5752eb8b9a07104f42392eebf143617708bfdd0fe31cbf00ef12383f9</p>
<p><strong>Second stage injector</strong></p>
<p>003965bd25acb7e8c6e16de4f387ff9518db7bcca845502d23b6505d8d3cec01<br />
1188c5c9f04658bef20162f3001d9b89f69c93bf5343a1f849974daf6284a650</p>
<p><strong>Exploit injector</strong></p>
<p>e7c1523d93154462ed9e15e84d3af01abe827aa6dd0082bc90fc8b58989e9a9a</p>
<p><strong>CVE-2016-0167 exploit (x86)</strong></p>
<p>5124f4fec24acb2c83f26d1e70d7c525daac6c9fb6e2262ed1c1c52c88636bad</p>
<p><strong>CVE-2016-0167 exploit (x64)</strong></p>
<p>f3c2d4090f6f563928e9a9ec86bf0f1c6ee49cdc110b7368db8905781a9a966e</p>
<p><strong>Main payload</strong></p>
<p>e9bd4375f9b0b95f385191895edf81c8eadfb3964204bbbe48f7700fc746e4dc<br />
5ca2a9de65c998b0d0a0a01b4aa103a9410d76ab86c75d7b968984be53e279b6</p>
<h3>Appendix - Technical details</h3>
<h4>Second Stage Injector Analysis</h4>
<p>The second stage injector contains an exploit injector (x86 DLL) which in turn has two embedded exploits (x86/64 DLL) for CVE-2016-0167. The second stage injector also contains the encrypted and aPLib packed main payload module (x86 DLL) in its .tls section. For decryption, it uses a modified version of the RC4 encryption algorithm with a salt that is stored in the .rsrc section. Significant strings in the second stage injector's .data section were XORed with the key 0x8D and get decrypted on-the-fly. Decrypted strings:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a52c733806366" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
AddMandatoryAce
ADVAPI
Advapi32.dlladvapi32.dllws2_32.dll
WPUCloseEvent
WPUCloseSocketHandleWPUCreateEvent
WPUCreateSocketHandle
WPUFDIsSet
WPUGetProviderPath
WPUModifyIFSHandle
WPUPostMessage
WPUQueryBlockingCallbackWPUQuerySocketHandleContext
WPUQueueApc
WPUResetEvent
WPUSetEvent
WPUOpenCurrentThreadWPUCloseThread
WSPStartup
 &gt; %1\r\ndel %0
software\\microsoft\\windows\\currentversion\\run
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/echo 
rundll32.exe shell32.dll, ShellExec_RunDLL %s
Microsoft\\Microsoft AntimalwareSoftware\\Coranti
Software\\risingSoftware\\TrendMicroSoftware\\Symantec
Software\\ComodoGroup
Software\\Network Associates\\TVD
Software\\Data Fellows\\F-SecureSoftware\\Eset\\Nod
Software\\Softed\\ViGUARD
Software\\Zone Labs\\ZoneAlarm
Software\\Avg
Software\\VBA32
Software\\Doctor WebSoftware\\G DataSoftware\\Avira
Software\\AVAST Software\\Avast
Software\\KasperskyLab\\protected
Software\\Bitdefender
Software\\Panda SoftwareSoftware\\Sophos.bat\\\\.\\%C:
|$$$}rstuvwxyz{$$$$$$$&gt;?@ABCDEFGHIJKLMNOPQRSTUVW$$$$$$XYZ[\\]^_`abcdefghijklmnopq
conhost
CreateProcessInternalW
ConvertStringSecurityDescriptorToSecurityDescriptorWContent-Type: multipart/form-data; boundary=---------------------------%s\r\n
Content-Type: application/x-www-form-urlencoded\r\n
Host: %s\r\n%d.%d.%d.%d
%d.%d.%d.%d.%x
%temp%\\debug_file.txt
[%u][%s:%s:%u][0x%x;0x%x] %sDnsFlushResolverCache
\\*.*
dnsapi.dll
DnsGetCacheDataTable.dll.exedownload.windowsupdate.com
vk.com
yandex.ru
HTTP/1.1https://http://%s
IsWow64Process
kernel
kernel32.dllLdrGetProcedureAddress
Microsoft
NtAllocateVirtualMemory
CLOSED
LAST_ACKTIME_WAIT
DELETE_TCB
LISTEN
SYN_SENTSYN_RCVDESTAB
FIN_WAIT1
FIN_WAIT2
CLOSE_WAIT
CLOSING
TCP\t%s:%d\t%s:%d\t%s\n
netstat\nProto\tLocal address\tRemote address\tState\n
ntdll.dll
NtResumeProcess
NtSuspendProcess\\\\?\\globalroot\\systemroot\\system32\\drivers\\null.sys
NtWriteVirtualMemoryopenRegisterApplicationRestart
RtlCreateUserThread
ResetSR
RtlComputeCrc32
rundll32SeDebugPrivilegeSystemDrive
\\StringFileInfo\\%04x%04x\\ProductName
software\\microsoft\\windows nt\\currentversion\\winlogon
shell
Sleep
srclient.dllSeShutdownPrivilege
\"%s\"
%d\t%s\ntaskmgr\nPID\tProcess name\nnet user\n
the computer is joined to a domain\n..
\\VarFileInfo\\Translation
%windir%\\system32\\%windir%\\syswow64\\POST*.exe
%SystemDrive%\\
*SYSTEM*%02x%s:Zone.Identifier
GetProcessUserModeExceptionPolicy
SetProcessUserModeExceptionPolicy
%ws\\%ws\n
WORKGROUP
HOMESoftware\\Microsoft\\Windows\\CurrentVersion\\Policies\\ExplorerDisableCurrentUserRun
%s.dat
software\\microsoft\\windows%OS%_%NUMBER_OF_PROCESSORS%
S:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)
S:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)(A;;GA;;;AC)
\\\\.\\AVGIDSShim
FFD3\\\\.\\NPF_NdisWanIpc:\\sample\\pos.exe
ANALYSERS
SANDBOX
VIRUS
MALWARE
FORTINETMALNETVMc:\\analysis\\sandboxstarter.exec:\\analysisc:\\insidetmc:\\windows\\system32\\drivers\\vmmouse.sys
c:\\windows\\system32\\drivers\\vmhgfs.sys
c:\\windows\\system32\\drivers\\vboxmouse.sys
c:\\iDEFENSEc:\\popupkiller.exe
c:\\tools\\execute.exe
c:\\Perlc:\\Python27api_log.dll
dir_watch.dll
pstorec.dll
dbghelp.dll
Process32NextW
Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\3
1406.bitMiniDumpWriteDump
\r\nReferer: %s\r\n
\\Google\\Chrome\\User Data\\Default\\Cache
var %s = new ActiveXObject("WScript.Shell"); %s.Run("%s");
IntelPowerAgent32
%OS%_%NUMBER_OF_PROCESSORS%
%s\cmd.exe
ComSpec
ConsoleWindowClass
.exekernel32.dllntdll.dll
ZwQuerySystemInformationZwAllocateVirtualMemory
PsLookupProcessByProcessId
PsReferencePrimaryToken
Class
Window
open "%s" -q%windir%\\system32\\sdbinst.exe
 /c "start "" "%s" -d"
%windir%\\system32\\sndvol.exe
 "%s" -u /c "%s\\SysWOW64\\SysSndVol.exe /c "start "" "%s" -d""
%temp%\\%u
%u.tmp
Wow64DisableWow64FsRedirection
Wow64RevertWow64FsRedirection
runas.exe
%systemroot%\\system32\\svchost.exe
%systemroot%\\system32\\wscript.exe
snxhk.dll
sbiedll.dll
 /c start "" "%s" " "
cmd.exe
runas
 --crypt-test
It work's!
 --vm-test</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a52c733806366-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-2">2</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-4">4</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-6">6</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-8">8</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-10">10</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-12">12</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-14">14</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-16">16</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-18">18</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-20">20</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-22">22</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-24">24</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-26">26</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-28">28</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-30">30</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-32">32</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-34">34</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-36">36</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-38">38</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-40">40</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-42">42</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-44">44</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-46">46</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-48">48</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-50">50</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-52">52</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-54">54</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-56">56</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-58">58</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-60">60</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-62">62</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-64">64</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-66">66</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-68">68</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-70">70</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-72">72</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-74">74</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-76">76</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-78">78</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-80">80</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-82">82</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-84">84</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-86">86</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-88">88</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-90">90</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-92">92</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-94">94</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-96">96</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-98">98</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-100">100</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-102">102</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-104">104</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-106">106</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-108">108</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-110">110</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-112">112</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-114">114</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-116">116</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-118">118</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-120">120</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-122">122</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-124">124</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-126">126</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-128">128</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-130">130</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-132">132</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-134">134</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-136">136</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-138">138</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-140">140</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-142">142</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a52c733806366-144">144</div><div class="crayon-num" data-line="crayon-67df89286a52c733806366-145">145</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a52c733806366-1"><span class="crayon-e">AddMandatoryAce</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-2"><span class="crayon-e">ADVAPI</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-3"><span class="crayon-i">Advapi32</span><span class="crayon-sy">.</span><span class="crayon-i">dlladvapi32</span><span class="crayon-sy">.</span><span class="crayon-i">dllws2_32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-4"><span class="crayon-e">WPUCloseEvent</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-5"><span class="crayon-e">WPUCloseSocketHandleWPUCreateEvent</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-6"><span class="crayon-e">WPUCreateSocketHandle</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-7"><span class="crayon-e">WPUFDIsSet</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-8"><span class="crayon-e">WPUGetProviderPath</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-9"><span class="crayon-e">WPUModifyIFSHandle</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-10"><span class="crayon-e">WPUPostMessage</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-11"><span class="crayon-e">WPUQueryBlockingCallbackWPUQuerySocketHandleContext</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-12"><span class="crayon-e">WPUQueueApc</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-13"><span class="crayon-e">WPUResetEvent</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-14"><span class="crayon-e">WPUSetEvent</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-15"><span class="crayon-e">WPUOpenCurrentThreadWPUCloseThread</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-16"><span class="crayon-i">WSPStartup</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-17"><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-cn">1</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">ndel</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-18"><span class="crayon-i">software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">currentversion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">run</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-19"><span class="crayon-i">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</span>+/<span class="crayon-e">echo </span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-20"><span class="crayon-i">rundll32</span><span class="crayon-sy">.</span><span class="crayon-e">exe </span><span class="crayon-i">shell32</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ShellExec_RunDLL</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-21"><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft </span><span class="crayon-i">AntimalwareSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Coranti</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-22"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">risingSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">TrendMicroSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Symantec</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-23"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ComodoGroup</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-24"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Network </span><span class="crayon-i">Associates</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">TVD</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-25"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Data </span><span class="crayon-i">Fellows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">F</span>-<span class="crayon-i">SecureSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Eset</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Nod</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-26"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Softed</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ViGUARD</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-27"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Zone </span><span class="crayon-i">Labs</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ZoneAlarm</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-28"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Avg</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-29"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">VBA32</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-30"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Doctor </span><span class="crayon-i">WebSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">G</span><span class="crayon-h"> </span><span class="crayon-i">DataSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Avira</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-31"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">AVAST </span><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Avast</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-32"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">KasperskyLab</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-m">protected</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-33"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Bitdefender</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-34"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Panda </span><span class="crayon-i">SoftwareSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Sophos</span><span class="crayon-sy">.</span><span class="crayon-i">bat</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">C</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-35"><span class="crayon-sy">|</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">}</span><span class="crayon-e">rstuvwxyz</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-h">&gt;</span><span class="crayon-sy">?</span><span class="crayon-sy">@</span><span class="crayon-i">ABCDEFGHIJKLMNOPQRSTUVW</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-i">XYZ</span><span class="crayon-sy">[</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span>^<span class="crayon-i">_</span><span class="crayon-sy">`</span><span class="crayon-e">abcdefghijklmnopq</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-36"><span class="crayon-e">conhost</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-37"><span class="crayon-e">CreateProcessInternalW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-38"><span class="crayon-i">ConvertStringSecurityDescriptorToSecurityDescriptorWContent</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">multipart</span>/<span class="crayon-i">form</span>-<span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">boundary</span>=---------------------------<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-39"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-i">urlencoded</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-40"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-e">d</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-41"><span class="crayon-ta">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-42"><span class="crayon-ta">%</span><span class="crayon-i">temp</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">debug_file</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-43"><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">u</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">u</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">;</span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">sDnsFlushResolverCache</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-44"><span class="crayon-sy">\</span><span class="crayon-sy">\</span>*<span class="crayon-sy">.</span>*</div><div class="crayon-line" id="crayon-67df89286a52c733806366-45"><span class="crayon-i">dnsapi</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-46"><span class="crayon-i">DnsGetCacheDataTable</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-sy">.</span><span class="crayon-i">exedownload</span><span class="crayon-sy">.</span><span class="crayon-i">windowsupdate</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-47"><span class="crayon-i">vk</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-48"><span class="crayon-i">yandex</span><span class="crayon-sy">.</span><span class="crayon-e">ru</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-49"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1https</span><span class="crayon-sy">:</span><span class="crayon-c">//http://%s</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-50"><span class="crayon-e">IsWow64Process</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-51"><span class="crayon-e">kernel</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-52"><span class="crayon-i">kernel32</span><span class="crayon-sy">.</span><span class="crayon-e">dllLdrGetProcedureAddress</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-53"><span class="crayon-e">Microsoft</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-54"><span class="crayon-e">NtAllocateVirtualMemory</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-55"><span class="crayon-e">CLOSED</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-56"><span class="crayon-e">LAST_ACKTIME_WAIT</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-57"><span class="crayon-e">DELETE_TCB</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-58"><span class="crayon-e">LISTEN</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-59"><span class="crayon-e">SYN_SENTSYN_RCVDESTAB</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-60"><span class="crayon-e">FIN_WAIT1</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-61"><span class="crayon-e">FIN_WAIT2</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-62"><span class="crayon-e">CLOSE_WAIT</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-63"><span class="crayon-e">CLOSING</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-64"><span class="crayon-i">TCP</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-65"><span class="crayon-i">netstat</span><span class="crayon-sy">\</span><span class="crayon-i">nProto</span><span class="crayon-sy">\</span><span class="crayon-e">tLocal </span><span class="crayon-i">address</span><span class="crayon-sy">\</span><span class="crayon-e">tRemote </span><span class="crayon-i">address</span><span class="crayon-sy">\</span><span class="crayon-i">tState</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-66"><span class="crayon-i">ntdll</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-67"><span class="crayon-e">NtResumeProcess</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-68"><span class="crayon-i">NtSuspendProcess</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">?</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">globalroot</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">systemroot</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-t">null</span><span class="crayon-sy">.</span><span class="crayon-e">sys</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-69"><span class="crayon-e">NtWriteVirtualMemoryopenRegisterApplicationRestart</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-70"><span class="crayon-e">RtlCreateUserThread</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-71"><span class="crayon-e">ResetSR</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-72"><span class="crayon-e">RtlComputeCrc32</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-73"><span class="crayon-i">rundll32SeDebugPrivilegeSystemDrive</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-74"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">StringFileInfo</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-cn">04x</span><span class="crayon-sy">%</span><span class="crayon-cn">04x</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ProductName</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-75"><span class="crayon-i">software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">windows </span><span class="crayon-i">nt</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">currentversion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">winlogon</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-76"><span class="crayon-e">shell</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-77"><span class="crayon-e">Sleep</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-78"><span class="crayon-i">srclient</span><span class="crayon-sy">.</span><span class="crayon-i">dllSeShutdownPrivilege</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-79"><span class="crayon-sy">\</span>"<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span>"</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-80"><span class="crayon-ta">%</span><span class="crayon-i">d</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">ntaskmgr</span><span class="crayon-sy">\</span><span class="crayon-i">nPID</span><span class="crayon-sy">\</span><span class="crayon-i">tProcess</span><span class="crayon-h"> </span><span class="crayon-i">name</span><span class="crayon-sy">\</span><span class="crayon-i">nnet</span><span class="crayon-h"> </span><span class="crayon-i">user</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-81"><span class="crayon-e">the </span><span class="crayon-e">computer </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">joined </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-i">domain</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-82"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">VarFileInfo</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Translation</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-83"><span class="crayon-ta">%</span><span class="crayon-i">windir</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">windir</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">syswow64</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">POST</span>*<span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-84"><span class="crayon-ta">%</span><span class="crayon-i">SystemDrive</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-85">*<span class="crayon-e ">SYSTEM*</span><span class="crayon-sy">%</span><span class="crayon-cn">02x</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-i">Zone</span><span class="crayon-sy">.</span><span class="crayon-e">Identifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-86"><span class="crayon-e">GetProcessUserModeExceptionPolicy</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-87"><span class="crayon-e">SetProcessUserModeExceptionPolicy</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-88"><span class="crayon-ta">%</span><span class="crayon-i">ws</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">ws</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-89"><span class="crayon-e">WORKGROUP</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-90"><span class="crayon-e">HOMESoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Policies</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ExplorerDisableCurrentUserRun</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-91"><span class="crayon-ta">%</span><span class="crayon-i">s</span><span class="crayon-sy">.</span><span class="crayon-i">dat</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-92"><span class="crayon-i">software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">%</span><span class="crayon-i">OS</span><span class="crayon-sy">%</span><span class="crayon-i">_</span><span class="crayon-sy">%</span><span class="crayon-i">NUMBER_OF_PROCESSORS</span><span class="crayon-sy">%</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-93"><span class="crayon-i">S</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">ML</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">NRNWNX</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">LW</span><span class="crayon-sy">)</span><span class="crayon-i">D</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">A</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">GA</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">WD</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-94"><span class="crayon-i">S</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">ML</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">NRNWNX</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">LW</span><span class="crayon-sy">)</span><span class="crayon-i">D</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">A</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">GA</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">WD</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">A</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">GA</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">AC</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-95"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">AVGIDSShim</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-96"><span class="crayon-i">FFD3</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">NPF_NdisWanIpc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">sample</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">pos</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-97"><span class="crayon-e">ANALYSERS</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-98"><span class="crayon-e">SANDBOX</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-99"><span class="crayon-e">VIRUS</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-100"><span class="crayon-e">MALWARE</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-101"><span class="crayon-i">FORTINETMALNETVMc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">analysis</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">sandboxstarter</span><span class="crayon-sy">.</span><span class="crayon-i">exec</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">analysisc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">insidetmc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">vmmouse</span><span class="crayon-sy">.</span><span class="crayon-i">sys</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-102"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">vmhgfs</span><span class="crayon-sy">.</span><span class="crayon-i">sys</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-103"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">vboxmouse</span><span class="crayon-sy">.</span><span class="crayon-i">sys</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-104"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">iDEFENSEc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">popupkiller</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-105"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">tools</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">execute</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-106"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Perlc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Python27api_log</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-107"><span class="crayon-i">dir_watch</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-108"><span class="crayon-i">pstorec</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-109"><span class="crayon-i">dbghelp</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-110"><span class="crayon-e">Process32NextW</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-111"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Internet </span><span class="crayon-i">Settings</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Zones</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-112"><span class="crayon-cn">1406.bitMiniDumpWriteDump</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-113"><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">nReferer</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-114"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Google</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Chrome</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">User </span><span class="crayon-i">Data</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-st">Default</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Cache</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-115"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ActiveXObject</span><span class="crayon-sy">(</span><span class="crayon-s">"WScript.Shell"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">.</span><span class="crayon-e">Run</span><span class="crayon-sy">(</span><span class="crayon-s">"%s"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-116"><span class="crayon-e">IntelPowerAgent32</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-117"><span class="crayon-ta">%</span><span class="crayon-i">OS</span><span class="crayon-sy">%</span><span class="crayon-i">_</span><span class="crayon-sy">%</span><span class="crayon-i">NUMBER_OF_PROCESSORS</span><span class="crayon-sy">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-118"><span class="crayon-ta">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">cmd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-119"><span class="crayon-e">ComSpec</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-120"><span class="crayon-i">ConsoleWindowClass</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-121"><span class="crayon-sy">.</span><span class="crayon-i">exekernel32</span><span class="crayon-sy">.</span><span class="crayon-i">dllntdll</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-122"><span class="crayon-e">ZwQuerySystemInformationZwAllocateVirtualMemory</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-123"><span class="crayon-e">PsLookupProcessByProcessId</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-124"><span class="crayon-e">PsReferencePrimaryToken</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-125"><span class="crayon-t">Class</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-126"><span class="crayon-e">Window</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-127"><span class="crayon-i">open</span><span class="crayon-h"> </span><span class="crayon-s">"%s"</span><span class="crayon-h"> </span>-<span class="crayon-i">q</span><span class="crayon-sy">%</span><span class="crayon-i">windir</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">sdbinst</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-128"><span class="crayon-h"> </span>/<span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"start "</span><span class="crayon-s">" "</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-s">" -d"</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-129"><span class="crayon-ta">%</span><span class="crayon-i">windir</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">sndvol</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-130"><span class="crayon-h"> </span><span class="crayon-s">"%s"</span><span class="crayon-h"> </span>-<span class="crayon-i">u</span><span class="crayon-h"> </span>/<span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"%s\\SysWOW64\\SysSndVol.exe /c "</span><span class="crayon-i">start</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-s">"%s"</span><span class="crayon-h"> </span>-<span class="crayon-i">d</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-131"><span class="crayon-ta">%</span><span class="crayon-i">temp</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">u</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-132"><span class="crayon-ta">%</span><span class="crayon-i">u</span><span class="crayon-sy">.</span><span class="crayon-i">tmp</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-133"><span class="crayon-e">Wow64DisableWow64FsRedirection</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-134"><span class="crayon-e">Wow64RevertWow64FsRedirection</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-135"><span class="crayon-i">runas</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-136"><span class="crayon-ta">%</span><span class="crayon-i">systemroot</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">svchost</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-137"><span class="crayon-ta">%</span><span class="crayon-i">systemroot</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">wscript</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-138"><span class="crayon-i">snxhk</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-139"><span class="crayon-i">sbiedll</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-140"><span class="crayon-h"> </span>/<span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-i">start</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-s">"%s"</span><span class="crayon-h"> </span><span class="crayon-s">" "</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-141"><span class="crayon-i">cmd</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-142"><span class="crayon-i">runas</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-143"><span class="crayon-h"> </span>--<span class="crayon-i">crypt</span>-<span class="crayon-e">test</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a52c733806366-144"><span class="crayon-e">It </span><span class="crayon-i">work</span>'<span class="crayon-i">s</span><span class="crayon-sy">!</span></div><div class="crayon-line" id="crayon-67df89286a52c733806366-145"><span class="crayon-h"> </span>--<span class="crayon-i">vm</span>-<span class="crayon-i">test</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p></p>
<h4>Exploit Injector with Embedded CVE-2016-0167 Exploits</h4>
<p>The exploit injector is used to gain SYSTEM privileges on the infected host. The injector contains the actual exploits for both x86 and x64 systems. The magic PE bytes ("MZ") at the beginning of the files are patched will null bytes to prevent them from automatic extraction.</p>
<p>The second stage injector checks for the current process' integrity level and the OS version. If the integrity level of the process is low and the OS version is 6.1 (Windows 7 / Windows Server 2008 R2), the second stage injector writes the exploit injector file into memory. Then, it searches for the magic value 0x99999999 in the exploit injector which marks the beginning of the PE overlay. When the address was found, 12 bytes are added and the second stage injector jumps to this address which is in fact a custom PE loader shellcode. The call to the shellcode looks as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a535177883334" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
00401EF5   pusha
00401EF6   add esi, 0Ch
00401EF9   call esi   -&gt; PE loader shellcode in overlay
00401EFB   popa</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a535177883334-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a535177883334-2">2</div><div class="crayon-num" data-line="crayon-67df89286a535177883334-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a535177883334-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a535177883334-1"><span class="crayon-cn">00401EF5</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">pusha</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a535177883334-2"><span class="crayon-cn">00401EF6</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">add </span><span class="crayon-i">esi</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0Ch</span></div><div class="crayon-line" id="crayon-67df89286a535177883334-3"><span class="crayon-cn">00401EF9</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">call </span><span class="crayon-i">esi</span><span class="crayon-h">&nbsp;&nbsp; </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">PE </span><span class="crayon-e">loader </span><span class="crayon-e">shellcode </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">overlay</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a535177883334-4"><span class="crayon-cn">00401EFB</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">popa</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>Custom PE loader shellcode</strong></p>
<p>It first gets the end of the shellcode which is then used to scan the exploit injector file for the magic PE number ("MZ"). The code to get end of the shellcode looks as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a537367748641" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
00077174   jmp short 00077178
00077176   pop eax
00077177   retn
00077178   call 00077176</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a537367748641-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a537367748641-2">2</div><div class="crayon-num" data-line="crayon-67df89286a537367748641-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a537367748641-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a537367748641-1"><span class="crayon-cn">00077174</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">jmp </span><span class="crayon-t">short</span><span class="crayon-h"> </span><span class="crayon-cn">00077178</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a537367748641-2"><span class="crayon-cn">00077176</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">pop </span><span class="crayon-i">eax</span></div><div class="crayon-line" id="crayon-67df89286a537367748641-3"><span class="crayon-cn">00077177</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">retn</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a537367748641-4"><span class="crayon-cn">00077178</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-cn">00077176</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Next, a custom GetProcAddress() function is used together with a hashing function to find the address of VirtualAllocEx(). Then, VirtualAllocEx() is called to allocate a memory buffer of with full access rights into which the exploit injectors sections are written with the appropriate memory alignments. The necessary memory addresses are then adjusted with help of the relocation information, the API function addresses are resolved and the IAT is filled. Finally, the shellcode jumps to the DLL entry point of the freshly created exploit injector module.</p>
<p><strong>Exploit injector</strong></p>
<p>At first, the strings "kernel32.dll", "LoadLibrary" and "GetProcAddress" are created. Next, the image base address for kernel32.dll is searched and the addresses of LoadLibrary() and GetProcAddress() are obtained. With help of these API functions, the IAT addresses of the exploit injector get resolved and the IAT is filled. The purpose of this function is unclear, as it was already done by the second stage injector. Thereafter, a new thread gets created with API function CreateThread().</p>
<p>The thread first calls IsWow64Process() and according to the result either the embedded x86 or x64 version of the exploit file is written into a memory buffer. Next, the PE magic value ("MZ") is written to the beginning of the exploit file. Then, an event named "WaitEventX" is created which is later used by the exploit. Then, the main exploit loading function is called.</p>
<p>The exploit loading function searches for the following process names and if found also the module names for the following strings which are part of Trend Micro security software:</p>
<ul>
<li>"uiSeAgnt.exe"</li>
<li>"PtSessionAgent.exe"</li>
<li>"PwmSvc.exe"</li>
<li>"coreServiceShell.exe"</li>
</ul>
<p>If one of the processes is found, a suspended process of wuauclt.exe is created. Otherwise, a suspended process of svchost.exe is created. In both cases, the command line argument "-k netsvcs" is passed, but can be only used by svchost.exe. It should be noted that this functionality always fails if the x64 version of Trend Micro Internet Security is installed. The code (x86) calls CreateToolhelp32Snapshot() on a x64 process which results in an error (ERROR_PARTIAL_COPY). Moreover, it also fails because the code tries to access a protected Trend Micro process (ERROR_ACCESS_DENIED).</p>
<p>Next, it maps the x86 or x64 file of the exploit into memory with CreateFileMapping() and MapViewOfFile() and fills in the memory with the exploit bytes. Finally, the section gets mapped into the suspended process of svchost.exe or wuauclt.exe by using ZwMapViewOfSection(). It then checks the OS version if it is 5.2 (Windows Server 2003 / Windows XP 64-Bit Edition) and exits the function if so. Afterwards, two memory buffers are created and a shellcode is written to each of them. The first obfuscated shellcode calls the second shellcode, which is a stager for the mapped exploit file. Next, it calls ResumeThread() to execute the suspended process so the exploit is executed.</p>
<p>The second stage injector verifies that the exploit was successful by checking if the integrity level of itself is still SECURITY_MANDATORY_LOW_RID. If not, the exploit successfully elevated privileges to SECURITY_MANDATORY_SYSTEM_RID and continues with the injection of the main payload. If the exploit failed, it tries to execute itself under the SYSTEM user account with help of the Windows command line (cmd.exe) and runas.exe tool.</p>
<h4>Atom String Building</h4>
<p>Instead of using a mutex like most of todays malware, the second stage injector creates an atom and checks the global atom table to see if an instance of Shifu is already running.</p>
<p>At first, it uses the template string "%OS%_%NUMBER_OF_PROCESSORS%" for the API ExpandEnvironmentStrings() to get the Windows version and number of processors. For example, in Windows 7 with one processor the result would be "Windows_NT_1". This string is then used to calculate four CRC32 hashes with RtlComputeCrc32() and the following initial values:</p>
<ul>
<li>0xFFFFFFFF</li>
<li>0xEEEEEEEE</li>
<li>0xAAAAAAAA</li>
<li>0x77777777</li>
</ul>
<p>The resulting CRC hashes of the string "Windows_NT_1" are as follows:</p>
<ul>
<li>0x395693AE</li>
<li>0xB24495D2</li>
<li>0xF39F86E1</li>
<li>0xBAE0B5C8</li>
</ul>
<p>Next, the last byte of each CRC hash is stored as a DWORD value on the stack:</p>
<ul>
<li>0xAE000000 (from 0x395693AE)</li>
<li>0xD2000000 (from 0xB24495D2)</li>
<li>0xE1000000 (from 0xF39F86E1)</li>
<li>0xC8000000 (from 0xBAE0B5C8)</li>
</ul>
<p>The stack with the hash byte sequence looks as follows:</p>
<p style="padding-left: 30px;">AE 00 00 00 D2 00 00 00 E1 00 00 00 C8 00 00 00</p>
<p>The atom string is then created by converting first 8 bytes of the hash byte sequence to ASCII characters with snprintf() function. The result in this case would be:</p>
<p style="padding-left: 30px;">"ae000000d2000000"</p>
<p>At last, it calls GlobalFindAtom() API to check if the atom is present and calls GlobalAddAtom() if not.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_3.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23099 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_3.png" alt="shifu_3" width="742" height="438" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_3.png 742w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_3-300x177.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_3-370x218.png 370w" sizes="(max-width: 742px) 100vw, 742px" /></a></p>
<p><em>Figure 3. Shifu atom in the global atom table</em></p>
<h4>Command Line Arguments</h4>
<p>The second stage injector has two command line parameters of which only one has a functionality. They may be used for an upcoming feature or were just forgotten to be removed.</p>
<ul>
<li>--crypt-test</li>
</ul>
<p>Shows just a message box with the text "It work's!"</p>
<ul>
<li>--vm-test</li>
</ul>
<p>No functionality</p>
<h4>Anti-Analysis Tricks</h4>
<p><strong>Anti Sandboxie / Avast</strong></p>
<p>Shifu checks if the module snxhk.dll (Avast) or sbiedll.dll (Sandboxie) is present in its own process space by calling GetModuleHandleA() and runs an infinite Sleep() loop if a handle is returned.</p>
<p>All the following anti analysis tricks are only used if Shifu is executed on a 32-bit Windows machine (no Wow64 process).</p>
<p><strong>Process name detection</strong></p>
<p>It enumerates running process names, converts them to lowercase, calculates the CRC32 hashes of those names and compares to the following list:</p>
<ul>
<li>0x99DD4432 - ?</li>
<li>0x1F413C1F - vmwaretray.exe</li>
<li>0x6D3323D9 - vmusrvc.exe</li>
<li>0x3BFFF885 - vmsrvc.exe</li>
<li>0x64340DCE - ?</li>
<li>0x63C54474 - vboxtray.exe</li>
<li>0x2B05B17D - ?</li>
<li>0xF725433E - ?</li>
<li>0x77AE10F7 - ?</li>
<li>0xCE7D304E - dumpcap.exe</li>
<li>0xAF2015F2 - ollydbg.exe</li>
<li>0x31FD677C - importrec.exe</li>
<li>0x6E9AD238 - petools.exe</li>
<li>0xE90ACC42 - idag.exe</li>
<li>0x4231F0AD - sysanalyzer.exe</li>
<li>0xD20981E0 - sniff_hit.exe</li>
<li>0xCCEA165E - scktool.exe</li>
<li>0xFCA978AC - proc_analyzer.exe</li>
<li>0x46FA37FB - hookexplorer.exe</li>
<li>0xEEBF618A - multi_pot.exe</li>
<li>0x06AAAE60 - idaq.exe</li>
<li>0x5BA9B1FE - procmon.exe</li>
<li>0x3CE2BEF3 - regmon.exe</li>
<li>0xA945E459 - procexp.exe</li>
<li>0x877A154B - peid.exe</li>
<li>0x33495995 - autoruns.exe</li>
<li>0x68684B33 - autorunsc.exe</li>
<li>0xB4364A7A - ?</li>
<li>0x9305F80D - imul.exe</li>
<li>0xC4AAED42 - emul.exe</li>
<li>0x14078D5B - apispy.exe</li>
<li>0x7E3DF4F6 - ?</li>
<li>0xD3B48D5B - hookanaapp.exe</li>
<li>0x332FD095 - fortitracer.exe</li>
<li>0x2D6A6921 - ?</li>
<li>0x2AAA273B - joeboxserver.exe</li>
<li>0x777BE06C - joeboxcontrol.exe</li>
<li>0x954B35E8 - ?</li>
<li>0x870E13A2 - ?</li>
</ul>
<p><strong>File detection</strong></p>
<p>Shifu checks if the following files or folders exist on the system and runs an infinite Sleep() loop if so:</p>
<ul>
<li>c:\sample\pos.exe</li>
<li>c:\analysis\sandboxstarter.exe</li>
<li>c:\analysis</li>
<li>c:\insidetm</li>
<li>c:\windows\system32\drivers\vmmouse.sys</li>
<li>c:\windows\system32\drivers\vmhgfs.sys</li>
<li>c:\windows\system32\drivers\vboxmouse.sys</li>
<li>c:\iDEFENSE</li>
<li>c:\popupkiller.exe</li>
<li>c:\tools\execute.exe</li>
<li>c:\Perl</li>
<li>c:\Python27</li>
</ul>
<p><strong>Debugger detection</strong></p>
<p>It checks if its being debugged by calling IsDebuggerPresent(). Also, it calls ZwQueryInformationSystem() with ProcessDebugPort and ProcessDebugObjectHandle to check for a debugger presence. If a debugger is detected it runs an infinite Sleep() loop.</p>
<p><strong>Wireshark detection</strong></p>
<p>Shifu attempts to open \\.\NPF_NdisWanIp with CreateFile() and will enter an infinite Sleep() loop if it is successful.</p>
<p><strong>Self-sanity checks</strong></p>
<p>It checks its own file name length if it is longer than 30 characters and runs an infinite Sleep() loop if so. Also, it checks if its own process name CRC32 hash matches one of the following:</p>
<ul>
<li>0xE84126B8 - sample.exe</li>
<li>0x0A84E285 - ?</li>
<li>0x3C164BED - ?</li>
<li>0xC19DADCE - ?</li>
<li>0xA07ACEDD - ?</li>
<li>0xD254F323 - ?</li>
<li>0xF3C4E556 - ?</li>
<li>0xF8782263 - ?</li>
<li>0xCA96016D - ?</li>
</ul>
<p>Furthermore, it checks if one of the following modules from GFI Sandbox is present in its own process address space:</p>
<ul>
<li>api_log.dll</li>
<li>dir_watch.dll</li>
<li>pstorec.dll</li>
</ul>
<p><strong>Unknown anti-analysis trick</strong></p>
<p>Shifu uses an anti-analysis trick whose purpose is unknown to us. It retrieves the address of Process32NextW() and compares the first 5 bytes with the sequence 0x33C0C20800 which disassembles to:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a539755266304" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
33C0XOR EAX,EAX
C2 0800   RETN 8</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a539755266304-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a539755266304-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a539755266304-1"><span class="crayon-cn">33C0</span><span class="crayon-st">XOR</span><span class="crayon-h"> </span><span class="crayon-i">EAX</span><span class="crayon-sy">,</span><span class="crayon-e">EAX</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a539755266304-2"><span class="crayon-i">C2</span><span class="crayon-h"> </span><span class="crayon-cn">0800</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">RETN</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This code is only present in 32-bit Windows XP and not in later Windows versions, because the Unicode version of that function probably wasn't implemented yet. If the code sequence is found meaning that Shifu was executed on 32-bit Windows XP, it runs an infinite Sleep() loop.</p>
<p><strong>Windows domain name check</strong></p>
<p>It checks if the computer workgroup name is either "WORKGROUP" or "HOME" with API functions NetServerGetInfo() and NetWkstaGetInfo() and runs an infinite Sleep() loop otherwise. Next, it checks for the name "ANALYSERS" and runs the infinite loop if found.</p>
<p><strong>Computer and user name check</strong></p>
<p>Shifu gets the computer and user name with GetComputerName() and GetUserName() to check for the following strings:</p>
<ul>
<li>SANDBOX</li>
<li>FORTINET</li>
<li>VIRUS</li>
<li>MALWARE</li>
<li>MALNETVM</li>
</ul>
<p>If one is found it runs an infinite loop.</p>
<p><strong>Process termination feature</strong></p>
<p>Second stage injector of Shifu enumerates all running processes, converts every name to lower case, calculates the CRC32 hash of it and compares it to the following ones:</p>
<ul>
<li>0xD2EFC6C4 - python.exe</li>
<li>0xE185BD8C - pythonw.exe</li>
<li>0xDE1BACD2 - perl.exe</li>
<li>0xF2EAA55E - autoit3.exe</li>
<li>0xB8BED542 - ?</li>
</ul>
<p>If one matches, it first tries to terminate the process with OpenProcess() and TerminateProcess(). If that fails, it tries to close the main window handle of the process if it is flagged as HANDLE_FLAG_PROTECT_FROM_CLOSE with ZwClose(). Then, it opens the process with full access rights and unmaps it from memory with ZwUnmapViewOfSection(). At last, the main window handle of the unmapped process is closed.</p>
<h4>Main Payload Decryption, Unpacking and Injection</h4>
<p>To decrypt the main payload, the second stage injector retrieves a salt needed for the decryption algorithm from its .rsrc section. It uses a modified RC4 algorithm where the salt is used to XOR the array of 256 bytes byte after byte at the beginning. The encrypted array is then used to decrypt the main payload located in the .tls section. The decrypted main payload is additionally packed with the aPLib compression library.</p>
<p>If the initial loader runs as a medium or high integrity level process, the routine which calculates the atom string name is called again. This time, only the first 4 bytes are used to build a string, for example "ae000000". Next, the CRC32 hash of this string is calculated and used to XOR another array of 256 bytes starting from 0x0 to 0xFF. This encrypted array is then used to again encrypt the decrypted main payload. The resulting encrypted data are written to registry for persistence purposes under the key "HKCU\software\microsoft\windows" with a random CRC32 hash name, for example "f4e64d63". Also, a second value with the string "ae000000" as name is created and filled up with null bytes and the path of the initial loader, for example "C:\ProgramData\7d5d6044.exe". At last, the temporarily encrypted main payload gets decrypted again.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_4.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23096 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_4.png" alt="shifu_4" width="945" height="464" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_4.png 945w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_4-900x442.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_4-300x147.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_4-768x377.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_4-370x182.png 370w" sizes="(max-width: 945px) 100vw, 945px" /></a></p>
<p><em>Figure 4. Encrypted main payload and initial loader path stored in the Windows registry</em></p>
<p>Next, the main payload gets unpacked into memory. Thereafter, a suspended svchost.exe process (x86) is created with the same integrity level as the parent process. The main payload gets mapped into the process and the magic PE value (MZ) patched. The svchost process gets then resumed so the main payload is executed. At last, a batch file is created and executed in the %TEMP% folder. It overwrites the original executed initial loader with a random number of bytes to cover the tracks. The random bytes are always followed by a space character and the CR LF control characters.</p>
<h3>Main Payload Analysis</h3>
<p>The main payload module's IAT function names were XORed with the key 0xFF to make static analysis more difficult. Significant strings in the .data section are also XORed with the key 0x8D and get decrypted on-the-fly. Decrypted strings:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a53b437284447" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
AddMandatoryAce
ADVAPI
Advapi32.dlladvapi32.dllws2_32.dll
WPUCloseEvent
WPUCloseSocketHandleWPUCreateEvent
WPUCreateSocketHandle
WPUFDIsSet
WPUGetProviderPath
WPUModifyIFSHandle
WPUPostMessage
WPUQueryBlockingCallbackWPUQuerySocketHandleContext
WPUQueueApc
WPUResetEvent
WPUSetEvent
WPUOpenCurrentThreadWPUCloseThread
WSPStartup
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/echo 
 &gt; %1\r\ndel %0
rundll32.exe shell32.dll, ShellExec_RunDLL %s
software\\microsoft\\windows\\currentversion\\run
Microsoft\\Microsoft AntimalwareSoftware\\Coranti
Software\\risingSoftware\\TrendMicroSoftware\\Symantec
Software\\ComodoGroup
Software\\Network Associates\\TVD
Software\\Data Fellows\\F-SecureSoftware\\Eset\\Nod
Software\\Softed\\ViGUARD
Software\\Zone Labs\\ZoneAlarm
Software\\Avg
Software\\VBA32
Software\\Doctor WebSoftware\\G DataSoftware\\Avira
Software\\AVAST Software\\Avast
Software\\KasperskyLab\\protected
Software\\Bitdefender
Software\\Panda SoftwareSoftware\\Sophos.bat|$$$}rstuvwxyz{$$$$$$$&gt;?@ABCDEFGHIJKLMNOPQRSTUVW$$$$$$XYZ[\\]^_`abcdefghijklmnop
q
\\\\.\\%C:
conhost
CreateProcessInternalW
ConvertStringSecurityDescriptorToSecurityDescriptorWContent-Type: application/x-www-form-urlencoded\r\n
Content-Type: multipart/form-data; boundary=---------------------------%s\r\n
Host: %s\r\n%d.%d.%d.%d
%d.%d.%d.%d.%x
%temp%\\debug_file.txt
[%u][%s:%s:%u][0x%x;0x%x] %sDnsFlushResolverCache
\\*.*
dnsapi.dll
DnsGetCacheDataTable.dll.exedownload.windowsupdate.com
vk.com
yandex.ru
HTTP/1.1https://http://%s
IsWow64Process
kernel
kernel32.dllLdrGetProcedureAddress
Microsoft
NtAllocateVirtualMemory
CLOSED
LAST_ACKTIME_WAIT
DELETE_TCB
LISTEN
SYN_SENTSYN_RCVDESTAB
FIN_WAIT1
FIN_WAIT2
CLOSE_WAIT
CLOSING
TCP\t%s:%d\t%s:%d\t%s\n
netstat\nProto\tLocal address\tRemote address\tState\n
ntdll.dll
NtResumeProcess
NtSuspendProcess\\\\?\\globalroot\\systemroot\\system32\\drivers\\null.sys
NtWriteVirtualMemoryopenRegisterApplicationRestart
RtlCreateUserThread
ResetSR
RtlComputeCrc32
rundll32SeDebugPrivilegeSystemDrive
\\StringFileInfo\\%04x%04x\\ProductName
software\\microsoft\\windows nt\\currentversion\\winlogon
shell
Sleep
srclient.dllSeShutdownPrivilege
\"%s\"
%d\t%s\ntaskmgr\nPID\tProcess name\nnet user\n
the computer is joined to a domain\n..
\\VarFileInfo\\Translation
%windir%\\system32\\%windir%\\syswow64\\POST*.exe
%SystemDrive%\\
*SYSTEM*%02x%s:Zone.Identifier
GetProcessUserModeExceptionPolicy
SetProcessUserModeExceptionPolicy
%ws\\%ws\n
WORKGROUP
HOMEsoftware\\microsoft\\windowsSoftware\\Microsoft\\Windows\\CurrentVersion\\Policies\\ExplorerDisableCurrentUserRun
%s.dat
%OS%_%NUMBER_OF_PROCESSORS%
S:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)
S:(ML;;NRNWNX;;;LW)D:(A;;GA;;;WD)(A;;GA;;;AC)
\\\\.\\AVGIDSShim
FFD3\\\\.\\NPF_NdisWanIpc:\\sample\\pos.exe
ANALYSERS
SANDBOX
VIRUS
MALWARE
FORTINETMALNETVMc:\\analysis\\sandboxstarter.exec:\\analysisc:\\insidetmc:\\windows\\system32\\drivers\\vmmouse.sys
c:\\windows\\system32\\drivers\\vmhgfs.sys
c:\\windows\\system32\\drivers\\vboxmouse.sys
c:\\iDEFENSEc:\\popupkiller.exe
c:\\tools\\execute.exe
c:\\Perlc:\\Python27api_log.dll
dir_watch.dll
pstorec.dll
dbghelp.dll
Process32NextW
1406Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\3
.bitMiniDumpWriteDump
\r\nReferer: %s\r\n
\\Google\\Chrome\\User Data\\Default\\Cache
var %s = new ActiveXObject("WScript.Shell"); %s.Run("%s");
GenuineIntelAuthenticAMDCentaurHauls7z
fnbqooqdaixfueangywblgabirdgvkewdyqgfqaioluesyrpryfkjerfsouemaxnavrkguxmcmhckwprunurmhehclermtufwiyjbqhwlunbun
uumeowfjmerxppxrgaxukyx
PowerManager_M5VKII_%d
[type=ftp]\n[botid=%s]\n[proc=%s]\n[data=%s]\n
[type=pop3]\n[botid=%s]\n[proc=%s]\n[data=%s]\n
%OS%_%NUMBER_OF_PROCESSORS%
[type=post]\n[botid=%s]\n[url=%s]\n[ua=%s]\n[proc=%s]\n[ref=%s]\n[keys=%s]\n[data=%s]\n
name=%s&amp;ok=%s&amp;id=%d&amp;res_code=%d&amp;res_text=%s_%x
name=%s&amp;ok=%s&amp;id=%d&amp;res_code=%d&amp;res_text=%s
botid=%s&amp;ver=%s.%u&amp;up=%u&amp;os=%u&amp;ltime=%s%d&amp;token=%d&amp;cn=%s&amp;av=%s&amp;dmn=%s&amp;mitm=%u
java.exe|javaw.exe|plugin-container.exe|acrobat.exe|acrod32.exe
tellerplus|bancline|fidelity|micrsolv|bankman|vanity|episys|jack 
henry|cruisenet|gplusmain|silverlake|v48d0250s1Root|TrustedPeople|SMS|Remote Desktop|REQUEST
TREASURE|BUH|BANK|ACCOUNT|CASH|FINAN|MONEY|MANAGE|OPER|DIRECT|ROSPIL|CAPO|BOSS|TRADEactive_bc
-----------------------------%s\r\nContent-Disposition: form-data; name=\"pcname\"\r\n\r\n%s!%s\r\n-----------------------------
%s\r\nContent-Disposition: form-data; name=\"file\"; filename=\"report\"\r\nContent-Type: text/plain\r\n\r\n%s\r\n--------------
---------------%s--\r\n
%domain%deactivebc
inject
kill_os
loadactive_sk
deactive_sk
wipe_cookiesmitm_modmitm_script
mitm_geterr
get_keylog
get_sols!active_bc\[(\d+)\] (\S+) (\d+)
!deactive_bc\[(\d+)\]
!inject\[(\d+)\] (\S+)
!kill_os\[(\d+)\]
!get_keylog\[(\d+)\]!load\[(\d+)\] (\S+)!update\[(\d+)\] (\S+)
!wipe_cookies\[(\d+)\]
!active_sk\[(\d+)\] (\S+) (\d+)
!deactive_sk\[(\d+)\]
!mitm_mod\[(\d+)\] (\S+) (\d+) (\S+)!mitm_script\[(\d+)\] (\S+)
!mitm_geterr\[(\d+)\]
!get_sols\[(\d+)\]
ATCASH
ATLOCAL
CERTCERTX
COLVCRAIF
CRYPT
CTERM
SCREEN
INTER
ELBALOCAL
ELBAWEB
ELBAWEB
ELBAWEB
PUTTY
VNCVIEW
MCLOCAL
MCSIGN
OPENVPN
PIPEK
PIPEK
PIPEK
PIPEK
POSTSAP
chrome.dll
mxwebkit.dlldragon_s.dlliron.dllvivaldi.dll
nspr4.dll
nss3.dllbrowser.dll
Advapi32.dllrsaenh.dll
kernel32.dllIprivLibEx.dll
cryptui.dll
crypt32.dll
ntdll.dll
ssleay32.dllurlmon.dll
user32.dll
Wininet.dll
Ws2_32.dll
PSAPI.dll
NzBrco.dll
VirtualProtect
LoadLibraryExW
ZwQuerySystemInformationWSARecv
WSASend
ZwDeviceIoControlFile
URLDownloadToCacheFileW
URLDownloadToFileW
TranslateMessageSSL_get_fd
SSL_write
PFXImportCertStore
CryptEncryptCPExportKey
CreateProcessInternalW
CreateDialogParamW
GetClipboardDatagetaddrinfo
gethostbyname
GetAddrInfoExW
GetMessageA
GetMessageW
DeleteFileA
GetModuleBaseNameW
bad port value
can't find plug-in path
can't get bot path
can't download file
can't encrypt file
can't save inject config to filecan't get temp file
file is not valid PEcan't delete original file
can't replace original file
can't close handle
can't protect file
original file not found
can't execute file
can't create directory
can't unzip file #1
can't unzip file #2
mitm_mod is inactivehttpd.exe is anactive
microsoft.com
dropbox.com
KEYGRAB
PasswordTELEMACOScelta e Login dispositivo
TLQ Web
db Corporate Banking WebSecureStoreCSP - enter PIN
google.com
Software\\SimonTatham\\PuTTYreg.txt
Software\\Microsoft\\Internet Explorer\\MainTabProcGrowth
Temp\\Low
 crc32[%x]
ACCT 
AUTHINFO PASS 
AUTHINFO USER 
Authorization
:BA:[bks]
%X!%X!%08X
btc_path.txtbtc_wallet.dat
bitcoin\\wallet.dat
%s%s\\%u_cert.pfx
cmdline.txt
1.3.6.1.5.5.7.3.3
CodeSign\n
Software\\Microsoft\\Windows NT\\CurrentVersion
[del]
Default
.exeELBA5\\ELBA_dataftp://anonymous:ftp://%s:%s@%s:%d\n
HBPData\\hbp.profileHH:mm:ssdd:MMM:yyyy
I_CryptUIProtect\\exe\\
infected.exx%s%s\\%u_info.txt
[ins]
InstallDate
%02u.jpg%s\\%02d.jpgKEYLOG
%s\\keylog.txt
[TOKEN ON]
\n\n[%s (%s-%s) - %s (%s)]\n[pst]%s[/pst]
ltcd_path.txt
ltcd_wallet.dat
litecoind\\wallet.dat
ltc_path.txtltc_wallet.dat
litecoin\\wallet.dat\\MacromediaMultiCash@Sign
C:\\Omikron\\MCSign
[ML][MR]Global\\{4C470E-%08x-%08x-%08x}
Global\\{DAN6J0-%s}
noneopera.exe
PASS 
password.txt\\\\.\\pipe\\%s
pop3://%s:%s@%s:%d\n%PROCESSOR_ARCHITECTURE%Referer
[ret]
%08x\\system32\\rstrui.exe
\\scrs\\send%s%s%s%d%s:%s
sysinfo.txt
[tab]
data.txt&lt;unnamed&gt;
&lt;untitled&gt;
update
USER 
User-agent
vkeys
%x\r\n
\r\n%x%x%x.tmp
\\*.txt
%02x%2b
torrent
-config config.vnc
--config 
config.ovpn
data.txt[type=post]\n
CreateFileW
pos.exe
bank.exePOS
secure.
.mozgoogle.com
CertVerifyCertificateChainPolicyCertGetCertificateChain
SSL_AuthCertificateHook
USERNAMESoftware\\ESET\\ESET Security\\CurrentVersion\\Info
C8FFAD27AE1BBE28BE24DDF20AF36EF901C609968930ED82CEFBC64808BA34102C4FABA0560523FB4CCBF33684F77C8401DFB
3A7D2D598E872DD78033E7F900B78A0C710CDF0941662FF7745A435D4BC18D5661E0582B21B2DB8FCA1C0CA3401D0FC9F051
85A558AB6A76A010F606CD77B35A480B6B7176F0903299B91F1BBD141B4D33615849C35557357DAB819BC3D4A8722BB433DE
B66C7A326BE859BD94930331B37DEE6EF4C475EA4B33DE4699FFDBCD34E196E19FE630E631D2C612705048620183BCF56709B
484A4380C4B00D8D94D131C31DB53AE6BCDCCC14131BAC99A68C59A604D0AE9116E9196F7FA3EA5F86F67E9B175CC09D3E17
997728B7D
10001
get=1
COMPNAMEAppDataDir
updfiles\\upd.ver
updfiles\\lastupd.ver
SYSTEM\\CurrentControlSet\\services\\Avg\\SystemValues
Local AppData
Avg2015
Avg2014
Avg2013
Avg2012
Avg2011
update
Software\\Microsoft\\Windows\\CurrentVersion\\explorer\\Browser Helper Objects\\{8CA7E745-EF75-4E7B-BB86-
8065C0CE29CA}
Software\\Microsoft\\Windows\\CurrentVersion\\explorer\\Browser Helper Objects\\{BB62FFF4-41CB-4AFC-BB8C-
2A4D4B42BBDC}
Software\\Microsoft\\Internet Explorer\\MainEnable Browser Extensions
httpd.exe
%s\\httpd.exe
connect
data\\index.php
logs\\error.log
error.log
&lt;?\n';\n$bot_id = '
$bot_net = '$key_log_file = '
$process_file = '
127.0.0.1
Listen %s:%u\n
conf\\httpd.confSSL_PORT%u&gt;\n
[type=post]\n
[type=screen]\n
[type=knock]\n
74??834E0440B832FFFFFF
74??834E04405F5EB832FFFFFF
DEBUG
memory.dmp
config.xml
php5ts.dll
zend_stream_fixup
zend_compile_file
index.php
config.php
content.php
iexplore.exe|firefox.exe|chrome.exe|opera.exe|browser.exe|dragon.exe|epic.exe|sbrender.exe|vivaldi.exe|maxthon.exe|ybr
owser.exe|microsoftedgecp.exe
InternetQueryDataAvailable
InternetReadFileInternetReadFileExA
InternetReadFileExW
InternetSetStatusCallbackA
InternetSetStatusCallbackW
HttpSendRequestAHttpSendRequestExA
HttpSendRequestExW
HttpSendRequestW\r\n0\r\n\r\n
.rdata
\r\n\r\nHTTP/1.
Transfer-Encoding
chunked
Content-Length
close
Proxy-ConnectionHostAccept-Encoding
x-xss-protectionx-content-security-policy
x-frame-options
x-content-type-options
If-Modified-Since
If-None-Match
content-security-policy
x-webkit-cspConnection
http://
https://NSS layer
Content-TypeBasic 
PR_ClosePR_Connect
PR_GetNameForIdentity
PR_Read
PR_SetError
PR_WriteReferer: 
Accept-Encoding:\r\n1406SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3
data_after\ndata_before\n
data_enddata_inject\n
set_url %BOTID%
%BOTNET%InternetCloseHandle
HTMLc:\\inject.txt
Dalvik/1.6.0 (Linux; U; Android 4.1.2; GT-N7000 Build/JZO54K)
xxx_process_0x%08x
Common.js</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a53b437284447-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-2">2</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-4">4</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-6">6</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-8">8</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-10">10</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-12">12</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-14">14</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-16">16</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-18">18</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-20">20</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-22">22</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-24">24</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-26">26</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-28">28</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-30">30</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-32">32</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-34">34</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-36">36</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-38">38</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-40">40</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-42">42</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-44">44</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-46">46</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-48">48</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-50">50</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-52">52</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-54">54</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-56">56</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-58">58</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-60">60</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-62">62</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-64">64</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-66">66</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-68">68</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-70">70</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-72">72</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-74">74</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-76">76</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-78">78</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-80">80</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-82">82</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-84">84</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-86">86</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-88">88</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-90">90</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-92">92</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-94">94</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-96">96</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-98">98</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-100">100</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-102">102</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-104">104</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-106">106</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-108">108</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-110">110</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-112">112</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-114">114</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-116">116</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-118">118</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-120">120</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-122">122</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-124">124</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-126">126</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-128">128</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-130">130</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-132">132</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-134">134</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-136">136</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-138">138</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-140">140</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-142">142</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-144">144</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-146">146</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-148">148</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-150">150</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-152">152</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-154">154</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-156">156</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-158">158</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-160">160</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-162">162</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-164">164</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-166">166</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-168">168</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-170">170</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-172">172</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-174">174</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-176">176</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-178">178</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-180">180</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-182">182</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-184">184</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-186">186</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-188">188</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-190">190</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-192">192</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-194">194</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-196">196</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-198">198</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-200">200</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-202">202</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-204">204</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-206">206</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-208">208</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-210">210</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-212">212</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-214">214</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-215">215</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-216">216</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-217">217</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-218">218</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-219">219</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-220">220</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-221">221</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-222">222</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-223">223</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-224">224</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-225">225</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-226">226</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-227">227</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-228">228</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-229">229</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-230">230</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-231">231</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-232">232</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-233">233</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-234">234</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-235">235</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-236">236</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-237">237</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-238">238</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-239">239</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-240">240</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-241">241</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-242">242</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-243">243</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-244">244</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-245">245</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-246">246</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-247">247</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-248">248</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-249">249</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-250">250</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-251">251</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-252">252</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-253">253</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-254">254</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-255">255</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-256">256</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-257">257</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-258">258</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-259">259</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-260">260</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-261">261</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-262">262</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-263">263</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-264">264</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-265">265</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-266">266</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-267">267</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-268">268</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-269">269</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-270">270</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-271">271</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-272">272</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-273">273</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-274">274</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-275">275</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-276">276</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-277">277</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-278">278</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-279">279</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-280">280</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-281">281</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-282">282</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-283">283</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-284">284</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-285">285</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-286">286</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-287">287</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-288">288</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-289">289</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-290">290</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-291">291</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-292">292</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-293">293</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-294">294</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-295">295</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-296">296</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-297">297</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-298">298</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-299">299</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-300">300</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-301">301</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-302">302</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-303">303</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-304">304</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-305">305</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-306">306</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-307">307</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-308">308</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-309">309</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-310">310</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-311">311</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-312">312</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-313">313</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-314">314</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-315">315</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-316">316</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-317">317</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-318">318</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-319">319</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-320">320</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-321">321</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-322">322</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-323">323</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-324">324</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-325">325</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-326">326</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-327">327</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-328">328</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-329">329</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-330">330</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-331">331</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-332">332</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-333">333</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-334">334</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-335">335</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-336">336</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-337">337</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-338">338</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-339">339</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-340">340</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-341">341</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-342">342</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-343">343</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-344">344</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-345">345</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-346">346</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-347">347</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-348">348</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-349">349</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-350">350</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-351">351</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-352">352</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-353">353</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-354">354</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-355">355</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-356">356</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-357">357</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-358">358</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-359">359</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-360">360</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-361">361</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-362">362</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-363">363</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-364">364</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-365">365</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-366">366</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-367">367</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-368">368</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-369">369</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-370">370</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-371">371</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-372">372</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-373">373</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-374">374</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-375">375</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-376">376</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-377">377</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-378">378</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-379">379</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-380">380</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-381">381</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-382">382</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-383">383</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-384">384</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-385">385</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-386">386</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-387">387</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-388">388</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-389">389</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-390">390</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-391">391</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53b437284447-392">392</div><div class="crayon-num" data-line="crayon-67df89286a53b437284447-393">393</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a53b437284447-1"><span class="crayon-e">AddMandatoryAce</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-2"><span class="crayon-e">ADVAPI</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-3"><span class="crayon-i">Advapi32</span><span class="crayon-sy">.</span><span class="crayon-i">dlladvapi32</span><span class="crayon-sy">.</span><span class="crayon-i">dllws2_32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-4"><span class="crayon-e">WPUCloseEvent</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-5"><span class="crayon-e">WPUCloseSocketHandleWPUCreateEvent</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-6"><span class="crayon-e">WPUCreateSocketHandle</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-7"><span class="crayon-e">WPUFDIsSet</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-8"><span class="crayon-e">WPUGetProviderPath</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-9"><span class="crayon-e">WPUModifyIFSHandle</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-10"><span class="crayon-e">WPUPostMessage</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-11"><span class="crayon-e">WPUQueryBlockingCallbackWPUQuerySocketHandleContext</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-12"><span class="crayon-e">WPUQueueApc</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-13"><span class="crayon-e">WPUResetEvent</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-14"><span class="crayon-e">WPUSetEvent</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-15"><span class="crayon-e">WPUOpenCurrentThreadWPUCloseThread</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-16"><span class="crayon-e">WSPStartup</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-17"><span class="crayon-i">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</span>+/<span class="crayon-i">echo</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-18"><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-cn">1</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">ndel</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-19"><span class="crayon-i">rundll32</span><span class="crayon-sy">.</span><span class="crayon-e">exe </span><span class="crayon-i">shell32</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ShellExec_RunDLL</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-20"><span class="crayon-i">software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">currentversion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">run</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-21"><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft </span><span class="crayon-i">AntimalwareSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Coranti</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-22"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">risingSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">TrendMicroSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Symantec</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-23"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ComodoGroup</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-24"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Network </span><span class="crayon-i">Associates</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">TVD</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-25"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Data </span><span class="crayon-i">Fellows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">F</span>-<span class="crayon-i">SecureSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Eset</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Nod</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-26"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Softed</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ViGUARD</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-27"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Zone </span><span class="crayon-i">Labs</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ZoneAlarm</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-28"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Avg</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-29"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">VBA32</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-30"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Doctor </span><span class="crayon-i">WebSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">G</span><span class="crayon-h"> </span><span class="crayon-i">DataSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Avira</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-31"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">AVAST </span><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Avast</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-32"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">KasperskyLab</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-m">protected</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-33"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Bitdefender</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-34"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Panda </span><span class="crayon-i">SoftwareSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Sophos</span><span class="crayon-sy">.</span><span class="crayon-i">bat</span><span class="crayon-sy">|</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">}</span><span class="crayon-e">rstuvwxyz</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-h">&gt;</span><span class="crayon-sy">?</span><span class="crayon-sy">@</span><span class="crayon-i">ABCDEFGHIJKLMNOPQRSTUVW</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-sy">$</span><span class="crayon-i">XYZ</span><span class="crayon-sy">[</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span>^<span class="crayon-i">_</span><span class="crayon-sy">`</span><span class="crayon-i">abcdefghijklmnop</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-35"><span class="crayon-i">q</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-36"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">C</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-37"><span class="crayon-e">conhost</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-38"><span class="crayon-e">CreateProcessInternalW</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-39"><span class="crayon-i">ConvertStringSecurityDescriptorToSecurityDescriptorWContent</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-i">urlencoded</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-40"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">multipart</span>/<span class="crayon-i">form</span>-<span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">boundary</span>=---------------------------<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-41"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-e">d</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-42"><span class="crayon-ta">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">.</span><span class="crayon-sy">%</span><span class="crayon-i">x</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-43"><span class="crayon-ta">%</span><span class="crayon-i">temp</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">debug_file</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-44"><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">u</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">u</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">;</span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">sDnsFlushResolverCache</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-45"><span class="crayon-sy">\</span><span class="crayon-sy">\</span>*<span class="crayon-sy">.</span>*</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-46"><span class="crayon-i">dnsapi</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-47"><span class="crayon-i">DnsGetCacheDataTable</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-sy">.</span><span class="crayon-i">exedownload</span><span class="crayon-sy">.</span><span class="crayon-i">windowsupdate</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-48"><span class="crayon-i">vk</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-49"><span class="crayon-i">yandex</span><span class="crayon-sy">.</span><span class="crayon-e">ru</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-50"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1https</span><span class="crayon-sy">:</span><span class="crayon-c">//http://%s</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-51"><span class="crayon-e">IsWow64Process</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-52"><span class="crayon-e">kernel</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-53"><span class="crayon-i">kernel32</span><span class="crayon-sy">.</span><span class="crayon-e">dllLdrGetProcedureAddress</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-54"><span class="crayon-e">Microsoft</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-55"><span class="crayon-e">NtAllocateVirtualMemory</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-56"><span class="crayon-e">CLOSED</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-57"><span class="crayon-e">LAST_ACKTIME_WAIT</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-58"><span class="crayon-e">DELETE_TCB</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-59"><span class="crayon-e">LISTEN</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-60"><span class="crayon-e">SYN_SENTSYN_RCVDESTAB</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-61"><span class="crayon-e">FIN_WAIT1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-62"><span class="crayon-e">FIN_WAIT2</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-63"><span class="crayon-e">CLOSE_WAIT</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-64"><span class="crayon-e">CLOSING</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-65"><span class="crayon-i">TCP</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-66"><span class="crayon-i">netstat</span><span class="crayon-sy">\</span><span class="crayon-i">nProto</span><span class="crayon-sy">\</span><span class="crayon-e">tLocal </span><span class="crayon-i">address</span><span class="crayon-sy">\</span><span class="crayon-e">tRemote </span><span class="crayon-i">address</span><span class="crayon-sy">\</span><span class="crayon-i">tState</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-67"><span class="crayon-i">ntdll</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-68"><span class="crayon-e">NtResumeProcess</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-69"><span class="crayon-i">NtSuspendProcess</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">?</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">globalroot</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">systemroot</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-t">null</span><span class="crayon-sy">.</span><span class="crayon-e">sys</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-70"><span class="crayon-e">NtWriteVirtualMemoryopenRegisterApplicationRestart</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-71"><span class="crayon-e">RtlCreateUserThread</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-72"><span class="crayon-e">ResetSR</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-73"><span class="crayon-e">RtlComputeCrc32</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-74"><span class="crayon-i">rundll32SeDebugPrivilegeSystemDrive</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-75"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">StringFileInfo</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-cn">04x</span><span class="crayon-sy">%</span><span class="crayon-cn">04x</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ProductName</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-76"><span class="crayon-i">software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">windows </span><span class="crayon-i">nt</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">currentversion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">winlogon</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-77"><span class="crayon-e">shell</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-78"><span class="crayon-e">Sleep</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-79"><span class="crayon-i">srclient</span><span class="crayon-sy">.</span><span class="crayon-i">dllSeShutdownPrivilege</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-80"><span class="crayon-sy">\</span>"<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span>"</div><div class="crayon-line" id="crayon-67df89286a53b437284447-81"><span class="crayon-ta">%</span><span class="crayon-i">d</span><span class="crayon-sy">\</span><span class="crayon-i">t</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">ntaskmgr</span><span class="crayon-sy">\</span><span class="crayon-i">nPID</span><span class="crayon-sy">\</span><span class="crayon-i">tProcess</span><span class="crayon-h"> </span><span class="crayon-i">name</span><span class="crayon-sy">\</span><span class="crayon-i">nnet</span><span class="crayon-h"> </span><span class="crayon-i">user</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-82"><span class="crayon-e">the </span><span class="crayon-e">computer </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">joined </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-i">domain</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-83"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">VarFileInfo</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Translation</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-84"><span class="crayon-ta">%</span><span class="crayon-i">windir</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">windir</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">syswow64</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">POST</span>*<span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-85"><span class="crayon-ta">%</span><span class="crayon-i">SystemDrive</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-86">*<span class="crayon-e ">SYSTEM*</span><span class="crayon-sy">%</span><span class="crayon-cn">02x</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-i">Zone</span><span class="crayon-sy">.</span><span class="crayon-e">Identifier</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-87"><span class="crayon-e">GetProcessUserModeExceptionPolicy</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-88"><span class="crayon-e">SetProcessUserModeExceptionPolicy</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-89"><span class="crayon-ta">%</span><span class="crayon-i">ws</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">ws</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-90"><span class="crayon-e">WORKGROUP</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-91"><span class="crayon-e">HOMEsoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">windowsSoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Policies</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ExplorerDisableCurrentUserRun</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-92"><span class="crayon-ta">%</span><span class="crayon-i">s</span><span class="crayon-sy">.</span><span class="crayon-i">dat</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-93"><span class="crayon-ta">%</span><span class="crayon-i">OS</span><span class="crayon-sy">%</span><span class="crayon-i">_</span><span class="crayon-sy">%</span><span class="crayon-i">NUMBER_OF_PROCESSORS</span><span class="crayon-sy">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-94"><span class="crayon-i">S</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">ML</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">NRNWNX</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">LW</span><span class="crayon-sy">)</span><span class="crayon-i">D</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">A</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">GA</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">WD</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-95"><span class="crayon-i">S</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">ML</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">NRNWNX</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">LW</span><span class="crayon-sy">)</span><span class="crayon-i">D</span><span class="crayon-sy">:</span><span class="crayon-sy">(</span><span class="crayon-i">A</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">GA</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">WD</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">A</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">GA</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-i">AC</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-96"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">AVGIDSShim</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-97"><span class="crayon-i">FFD3</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">NPF_NdisWanIpc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">sample</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">pos</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-98"><span class="crayon-e">ANALYSERS</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-99"><span class="crayon-e">SANDBOX</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-100"><span class="crayon-e">VIRUS</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-101"><span class="crayon-e">MALWARE</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-102"><span class="crayon-i">FORTINETMALNETVMc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">analysis</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">sandboxstarter</span><span class="crayon-sy">.</span><span class="crayon-i">exec</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">analysisc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">insidetmc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">vmmouse</span><span class="crayon-sy">.</span><span class="crayon-i">sys</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-103"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">vmhgfs</span><span class="crayon-sy">.</span><span class="crayon-i">sys</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-104"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">drivers</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">vboxmouse</span><span class="crayon-sy">.</span><span class="crayon-i">sys</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-105"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">iDEFENSEc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">popupkiller</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-106"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">tools</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">execute</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-107"><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Perlc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Python27api_log</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-108"><span class="crayon-i">dir_watch</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-109"><span class="crayon-i">pstorec</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-110"><span class="crayon-i">dbghelp</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-111"><span class="crayon-i">Process32NextW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-112"><span class="crayon-cn">1406Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Internet </span><span class="crayon-i">Settings</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Zones</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-113"><span class="crayon-sy">.</span><span class="crayon-i">bitMiniDumpWriteDump</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-114"><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">nReferer</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-115"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Google</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Chrome</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">User </span><span class="crayon-i">Data</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-st">Default</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Cache</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-116"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ActiveXObject</span><span class="crayon-sy">(</span><span class="crayon-s">"WScript.Shell"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">.</span><span class="crayon-e">Run</span><span class="crayon-sy">(</span><span class="crayon-s">"%s"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-117"><span class="crayon-e">GenuineIntelAuthenticAMDCentaurHauls7z</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-118"><span class="crayon-e">fnbqooqdaixfueangywblgabirdgvkewdyqgfqaioluesyrpryfkjerfsouemaxnavrkguxmcmhckwprunurmhehclermtufwiyjbqhwlunbun</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-119"><span class="crayon-e">uumeowfjmerxppxrgaxukyx</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-120"><span class="crayon-i">PowerManager_M5VKII_</span><span class="crayon-sy">%</span><span class="crayon-i">d</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-121"><span class="crayon-sy">[</span><span class="crayon-i">type</span>=<span class="crayon-i">ftp</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">botid</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">proc</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">data</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-122"><span class="crayon-sy">[</span><span class="crayon-i">type</span>=<span class="crayon-i">pop3</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">botid</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">proc</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">data</span>=<span class="crayon-sy">%</span><span class="crayon-e">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-e">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-123"><span class="crayon-ta">%</span><span class="crayon-i">OS</span><span class="crayon-sy">%</span><span class="crayon-i">_</span><span class="crayon-sy">%</span><span class="crayon-i">NUMBER_OF_PROCESSORS</span><span class="crayon-sy">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-124"><span class="crayon-sy">[</span><span class="crayon-i">type</span>=<span class="crayon-i">post</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">botid</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">url</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">ua</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">proc</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">ref</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">keys</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">data</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-125"><span class="crayon-i">name</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">&amp;ok=%s&amp;id=%d&amp;res_code=%d&amp;res_text=%s_%x</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-126"><span class="crayon-sy">name=%s&amp;ok=%s&amp;id=%d&amp;res_code=%d&amp;res_text=%s</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-127"><span class="crayon-sy">botid=%s&amp;ver=%s.%u&amp;up=%u&amp;os=%u&amp;ltime=%s%d&amp;token=%d&amp;cn=%s&amp;av=%s&amp;dmn=%s&amp;mitm=%u</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-128"><span class="crayon-sy">java.exe|javaw.exe|plugin-container.exe|acrobat.exe|acrod32.exe</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-129"><span class="crayon-sy">tellerplus|bancline|fidelity|micrsolv|bankman|vanity|episys|jack </span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-130"><span class="crayon-sy">henry|cruisenet|gplusmain|silverlake|v48d0250s1Root|TrustedPeople|SMS|Remote Desktop|REQUEST</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-131"><span class="crayon-sy">TREASURE|BUH|BANK|ACCOUNT|CASH|FINAN|MONEY|MANAGE|OPER|DIRECT|ROSPIL|CAPO|BOSS|TRADEactive_bc</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-132"><span class="crayon-sy">-----------------------------%s\r\nContent-Disposition: form-data;</span><span class="crayon-h"> </span><span class="crayon-i">name</span>=<span class="crayon-sy">\</span>"<span class="crayon-i">pcname</span><span class="crayon-sy">\</span>"<span class="crayon-sy">\</span><span class="crayon-e">r</span><span class="crayon-sy">\</span><span class="crayon-e">n</span><span class="crayon-sy">\</span><span class="crayon-e">r</span><span class="crayon-sy">\</span><span class="crayon-e">n</span><span class="crayon-sy">%</span><span class="crayon-e">s</span><span class="crayon-sy">!</span><span class="crayon-sy">%</span><span class="crayon-e">s</span><span class="crayon-sy">\</span><span class="crayon-e">r</span><span class="crayon-sy">\</span><span class="crayon-e">n</span>-----------------------------</div><div class="crayon-line" id="crayon-67df89286a53b437284447-133"><span class="crayon-ta">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">nContent</span>-<span class="crayon-i">Disposition</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span>-<span class="crayon-t">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">name</span>=<span class="crayon-sy">\</span>"<span class="crayon-t">file</span><span class="crayon-sy">\</span>"<span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">filename</span>=<span class="crayon-sy">\</span>"<span class="crayon-i">report</span><span class="crayon-sy">\</span>"<span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">nContent</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">plain</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span>--------------</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-134">---------------<span class="crayon-sy">%</span><span class="crayon-e">s</span>--<span class="crayon-sy">\</span><span class="crayon-e">r</span><span class="crayon-sy">\</span><span class="crayon-e">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-135"><span class="crayon-ta">%</span><span class="crayon-i">domain</span><span class="crayon-sy">%</span><span class="crayon-i">deactivebc</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-136"><span class="crayon-e">inject</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-137"><span class="crayon-e">kill_os</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-138"><span class="crayon-e">loadactive_sk</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-139"><span class="crayon-e">deactive_sk</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-140"><span class="crayon-e">wipe_cookiesmitm_modmitm_script</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-141"><span class="crayon-e">mitm_geterr</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-142"><span class="crayon-e">get_keylog</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-143"><span class="crayon-i">get_sols</span><span class="crayon-sy">!</span><span class="crayon-i">active_bc</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-144"><span class="crayon-sy">!</span><span class="crayon-i">deactive_bc</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-145"><span class="crayon-sy">!</span><span class="crayon-i">inject</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-146"><span class="crayon-sy">!</span><span class="crayon-i">kill_os</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-147"><span class="crayon-sy">!</span><span class="crayon-i">get_keylog</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-sy">!</span><span class="crayon-i">load</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span><span class="crayon-sy">!</span><span class="crayon-i">update</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-148"><span class="crayon-sy">!</span><span class="crayon-i">wipe_cookies</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-149"><span class="crayon-sy">!</span><span class="crayon-i">active_sk</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-150"><span class="crayon-sy">!</span><span class="crayon-i">deactive_sk</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-151"><span class="crayon-sy">!</span><span class="crayon-i">mitm_mod</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span><span class="crayon-sy">!</span><span class="crayon-i">mitm_script</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">S</span>+<span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-152"><span class="crayon-sy">!</span><span class="crayon-i">mitm_geterr</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-153"><span class="crayon-sy">!</span><span class="crayon-i">get_sols</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">d</span>+<span class="crayon-sy">)</span><span class="crayon-sy">\</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-154"><span class="crayon-e">ATCASH</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-155"><span class="crayon-e">ATLOCAL</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-156"><span class="crayon-e">CERTCERTX</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-157"><span class="crayon-e">COLVCRAIF</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-158"><span class="crayon-e">CRYPT</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-159"><span class="crayon-e">CTERM</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-160"><span class="crayon-e">SCREEN</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-161"><span class="crayon-e">INTER</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-162"><span class="crayon-e">ELBALOCAL</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-163"><span class="crayon-e">ELBAWEB</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-164"><span class="crayon-e">ELBAWEB</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-165"><span class="crayon-e">ELBAWEB</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-166"><span class="crayon-e">PUTTY</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-167"><span class="crayon-e">VNCVIEW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-168"><span class="crayon-e">MCLOCAL</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-169"><span class="crayon-e">MCSIGN</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-170"><span class="crayon-e">OPENVPN</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-171"><span class="crayon-e">PIPEK</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-172"><span class="crayon-e">PIPEK</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-173"><span class="crayon-e">PIPEK</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-174"><span class="crayon-e">PIPEK</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-175"><span class="crayon-e">POSTSAP</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-176"><span class="crayon-i">chrome</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-177"><span class="crayon-i">mxwebkit</span><span class="crayon-sy">.</span><span class="crayon-i">dlldragon_s</span><span class="crayon-sy">.</span><span class="crayon-i">dlliron</span><span class="crayon-sy">.</span><span class="crayon-i">dllvivaldi</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-178"><span class="crayon-i">nspr4</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-179"><span class="crayon-i">nss3</span><span class="crayon-sy">.</span><span class="crayon-i">dllbrowser</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-180"><span class="crayon-i">Advapi32</span><span class="crayon-sy">.</span><span class="crayon-i">dllrsaenh</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-181"><span class="crayon-i">kernel32</span><span class="crayon-sy">.</span><span class="crayon-i">dllIprivLibEx</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-182"><span class="crayon-i">cryptui</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-183"><span class="crayon-i">crypt32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-184"><span class="crayon-i">ntdll</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-185"><span class="crayon-i">ssleay32</span><span class="crayon-sy">.</span><span class="crayon-i">dllurlmon</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-186"><span class="crayon-i">user32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-187"><span class="crayon-i">Wininet</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-188"><span class="crayon-i">Ws2_32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-189"><span class="crayon-i">PSAPI</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-190"><span class="crayon-i">NzBrco</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-191"><span class="crayon-e">VirtualProtect</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-192"><span class="crayon-e">LoadLibraryExW</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-193"><span class="crayon-e">ZwQuerySystemInformationWSARecv</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-194"><span class="crayon-e">WSASend</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-195"><span class="crayon-e">ZwDeviceIoControlFile</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-196"><span class="crayon-e">URLDownloadToCacheFileW</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-197"><span class="crayon-e">URLDownloadToFileW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-198"><span class="crayon-e">TranslateMessageSSL_get_fd</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-199"><span class="crayon-e">SSL_write</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-200"><span class="crayon-e">PFXImportCertStore</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-201"><span class="crayon-e">CryptEncryptCPExportKey</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-202"><span class="crayon-e">CreateProcessInternalW</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-203"><span class="crayon-e">CreateDialogParamW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-204"><span class="crayon-e">GetClipboardDatagetaddrinfo</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-205"><span class="crayon-e">gethostbyname</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-206"><span class="crayon-e">GetAddrInfoExW</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-207"><span class="crayon-e">GetMessageA</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-208"><span class="crayon-e">GetMessageW</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-209"><span class="crayon-e">DeleteFileA</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-210"><span class="crayon-e">GetModuleBaseNameW</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-211"><span class="crayon-e">bad </span><span class="crayon-e">port </span><span class="crayon-e">value</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-212"><span class="crayon-i">can</span><span class="crayon-s">'t find plug-in path</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-213"><span class="crayon-s">can'</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-e">get </span><span class="crayon-e">bot </span><span class="crayon-e">path</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-214"><span class="crayon-i">can</span><span class="crayon-s">'t download file</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-215"><span class="crayon-s">can'</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-e">encrypt </span><span class="crayon-e">file</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-216"><span class="crayon-i">can</span><span class="crayon-s">'t save inject config to filecan'</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-e">get </span><span class="crayon-e">temp </span><span class="crayon-e">file</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-217"><span class="crayon-e">file </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">valid </span><span class="crayon-i">PEcan</span><span class="crayon-s">'t delete original file</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-218"><span class="crayon-s">can'</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-e">replace </span><span class="crayon-e">original </span><span class="crayon-e">file</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-219"><span class="crayon-i">can</span><span class="crayon-s">'t close handle</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-220"><span class="crayon-s">can'</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-e">protect </span><span class="crayon-e">file</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-221"><span class="crayon-e">original </span><span class="crayon-e">file </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">found</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-222"><span class="crayon-i">can</span><span class="crayon-s">'t execute file</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-223"><span class="crayon-s">can'</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-e">create </span><span class="crayon-e">directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-224"><span class="crayon-i">can</span><span class="crayon-s">'t unzip file #1</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-225"><span class="crayon-s">can'</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-e">unzip </span><span class="crayon-i">file</span><span class="crayon-h"> </span><span class="crayon-p">#2</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-226"><span class="crayon-e">mitm_mod </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-i">inactivehttpd</span><span class="crayon-sy">.</span><span class="crayon-e">exe </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">anactive</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-227"><span class="crayon-i">microsoft</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-228"><span class="crayon-i">dropbox</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-229"><span class="crayon-e">KEYGRAB</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-230"><span class="crayon-i">PasswordTELEMACOScelta</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-e">Login </span><span class="crayon-e">dispositivo</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-231"><span class="crayon-e">TLQ </span><span class="crayon-e">Web</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-232"><span class="crayon-e">db </span><span class="crayon-e">Corporate </span><span class="crayon-e">Banking </span><span class="crayon-i">WebSecureStoreCSP</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">enter </span><span class="crayon-e">PIN</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-233"><span class="crayon-i">google</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-234"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">SimonTatham</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">PuTTYreg</span><span class="crayon-sy">.</span><span class="crayon-e">txt</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-235"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Internet </span><span class="crayon-i">Explorer</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">MainTabProcGrowth</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-236"><span class="crayon-i">Temp</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Low</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-237"><span class="crayon-e"> </span><span class="crayon-i">crc32</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-238"><span class="crayon-e">ACCT </span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-239"><span class="crayon-e">AUTHINFO </span><span class="crayon-e">PASS </span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-240"><span class="crayon-e">AUTHINFO </span><span class="crayon-e">USER </span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-241"><span class="crayon-i">Authorization</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-242"><span class="crayon-sy">:</span><span class="crayon-i">BA</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-e">bks</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-243"><span class="crayon-ta">%</span><span class="crayon-i">X</span><span class="crayon-sy">!</span><span class="crayon-sy">%</span><span class="crayon-i">X</span><span class="crayon-sy">!</span><span class="crayon-sy">%</span><span class="crayon-cn">08X</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-244"><span class="crayon-i">btc_path</span><span class="crayon-sy">.</span><span class="crayon-i">txtbtc_wallet</span><span class="crayon-sy">.</span><span class="crayon-e">dat</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-245"><span class="crayon-i">bitcoin</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">wallet</span><span class="crayon-sy">.</span><span class="crayon-i">dat</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-246"><span class="crayon-ta">%</span><span class="crayon-i">s</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">u_cert</span><span class="crayon-sy">.</span><span class="crayon-i">pfx</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-247"><span class="crayon-i">cmdline</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-248"><span class="crayon-cn">1.3.6.1.5.5.7.3.3</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-249"><span class="crayon-i">CodeSign</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-250"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-251"><span class="crayon-sy">[</span><span class="crayon-i">del</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-252"><span class="crayon-st">Default</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-253"><span class="crayon-sy">.</span><span class="crayon-i">exeELBA5</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">ELBA_dataftp</span><span class="crayon-sy">:</span><span class="crayon-c">//anonymous:ftp://%s:%s@%s:%d\n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-254"><span class="crayon-i">HBPData</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">hbp</span><span class="crayon-sy">.</span><span class="crayon-i">profileHH</span><span class="crayon-sy">:</span><span class="crayon-i">mm</span><span class="crayon-sy">:</span><span class="crayon-i">ssdd</span><span class="crayon-sy">:</span><span class="crayon-i">MMM</span><span class="crayon-sy">:</span><span class="crayon-e">yyyy</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-255"><span class="crayon-i">I_CryptUIProtect</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">exe</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-256"><span class="crayon-i">infected</span><span class="crayon-sy">.</span><span class="crayon-i">exx</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">u_info</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-257"><span class="crayon-sy">[</span><span class="crayon-e">ins</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-258"><span class="crayon-e">InstallDate</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-259"><span class="crayon-ta">%</span><span class="crayon-cn">02u.jpg</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-cn">02d.jpgKEYLOG</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-260"><span class="crayon-ta">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">keylog</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-261"><span class="crayon-sy">[</span><span class="crayon-e">TOKEN </span><span class="crayon-i">ON</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-262"><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-e">s</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">%</span><span class="crayon-i">s</span>-<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-e">s</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">[</span><span class="crayon-i">pst</span><span class="crayon-sy">]</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">[</span>/<span class="crayon-i">pst</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-263"><span class="crayon-i">ltcd_path</span><span class="crayon-sy">.</span><span class="crayon-e">txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-264"><span class="crayon-i">ltcd_wallet</span><span class="crayon-sy">.</span><span class="crayon-e">dat</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-265"><span class="crayon-i">litecoind</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">wallet</span><span class="crayon-sy">.</span><span class="crayon-e">dat</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-266"><span class="crayon-i">ltc_path</span><span class="crayon-sy">.</span><span class="crayon-i">txtltc_wallet</span><span class="crayon-sy">.</span><span class="crayon-e">dat</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-267"><span class="crayon-i">litecoin</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">wallet</span><span class="crayon-sy">.</span><span class="crayon-i">dat</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">MacromediaMultiCash</span><span class="crayon-sy">@</span><span class="crayon-i">Sign</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-268"><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Omikron</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">MCSign</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-269"><span class="crayon-sy">[</span><span class="crayon-e">ML</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-e">MR</span><span class="crayon-sy">]</span><span class="crayon-m">Global</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">{</span><span class="crayon-cn">4C470E</span>-<span class="crayon-sy">%</span><span class="crayon-cn">08x</span>-<span class="crayon-sy">%</span><span class="crayon-cn">08x</span>-<span class="crayon-sy">%</span><span class="crayon-cn">08x</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-270"><span class="crayon-m">Global</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">{</span><span class="crayon-i">DAN6J0</span>-<span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-271"><span class="crayon-i">noneopera</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-272"><span class="crayon-e">PASS </span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-273"><span class="crayon-i">password</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">pipe</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-274"><span class="crayon-i">pop3</span><span class="crayon-sy">:</span><span class="crayon-c">//%s:%s@%s:%d\n%PROCESSOR_ARCHITECTURE%Referer</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-275"><span class="crayon-sy">[</span><span class="crayon-e">ret</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-276"><span class="crayon-ta">%</span><span class="crayon-cn">08x</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">rstrui</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-277"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">scrs</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">send</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-278"><span class="crayon-i">sysinfo</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-279"><span class="crayon-sy">[</span><span class="crayon-i">tab</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-280"><span class="crayon-i">data</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span><span class="crayon-h">&lt;</span><span class="crayon-e">unnamed</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-281"><span class="crayon-h">&lt;</span><span class="crayon-e">untitled</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-282"><span class="crayon-e">update</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-283"><span class="crayon-e">USER</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-284"><span class="crayon-e">User</span>-<span class="crayon-e">agent</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-285"><span class="crayon-e">vkeys</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-286"><span class="crayon-ta">%</span><span class="crayon-i">x</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-287"><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">%</span><span class="crayon-i">x</span><span class="crayon-sy">.</span><span class="crayon-i">tmp</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-288"><span class="crayon-sy">\</span><span class="crayon-sy">\</span>*<span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-289"><span class="crayon-ta">%</span><span class="crayon-cn">02x</span><span class="crayon-sy">%</span><span class="crayon-cn">2b</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-290"><span class="crayon-i">torrent</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-291">-<span class="crayon-e">config </span><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">vnc</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-292">--<span class="crayon-e">config </span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-293"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-e">ovpn</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-294"><span class="crayon-i">data</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span><span class="crayon-sy">[</span><span class="crayon-i">type</span>=<span class="crayon-i">post</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-295"><span class="crayon-e">CreateFileW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-296"><span class="crayon-i">pos</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-297"><span class="crayon-i">bank</span><span class="crayon-sy">.</span><span class="crayon-e">exePOS</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-298"><span class="crayon-i">secure</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-299"><span class="crayon-sy">.</span><span class="crayon-i">mozgoogle</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-300"><span class="crayon-e">CertVerifyCertificateChainPolicyCertGetCertificateChain</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-301"><span class="crayon-e">SSL_AuthCertificateHook</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-302"><span class="crayon-i">USERNAMESoftware</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">ESET</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">ESET </span><span class="crayon-i">Security</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Info</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-303"><span class="crayon-i">C8FFAD27AE1BBE28BE24DDF20AF36EF901C609968930ED82CEFBC64808BA34102C4FABA0560523FB4CCBF33684F77C8401DFB</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-304"><span class="crayon-cn">3A7D2D598E872DD78033E7F900B78A0C710CDF0941662FF7745A435D4BC18D5661E0582B21B2DB8FCA1C0CA3401D0FC9F051</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-305"><span class="crayon-cn">85A558AB6A76A010F606CD77B35A480B6B7176F0903299B91F1BBD141B4D33615849C35557357DAB819BC3D4A8722BB433DE</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-306"><span class="crayon-i">B66C7A326BE859BD94930331B37DEE6EF4C475EA4B33DE4699FFDBCD34E196E19FE630E631D2C612705048620183BCF56709B</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-307"><span class="crayon-cn">484A4380C4B00D8D94D131C31DB53AE6BCDCCC14131BAC99A68C59A604D0AE9116E9196F7FA3EA5F86F67E9B175CC09D3E17</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-308"><span class="crayon-cn">997728B7D</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-309"><span class="crayon-cn">10001</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-310"><span class="crayon-i">get</span>=<span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-311"><span class="crayon-e">COMPNAMEAppDataDir</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-312"><span class="crayon-i">updfiles</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">upd</span><span class="crayon-sy">.</span><span class="crayon-e">ver</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-313"><span class="crayon-i">updfiles</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">lastupd</span><span class="crayon-sy">.</span><span class="crayon-e">ver</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-314"><span class="crayon-e">SYSTEM</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">CurrentControlSet</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">services</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Avg</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">SystemValues</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-315"><span class="crayon-e">Local</span><span class="crayon-h"> </span><span class="crayon-e">AppData</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-316"><span class="crayon-e">Avg2015</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-317"><span class="crayon-e">Avg2014</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-318"><span class="crayon-e">Avg2013</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-319"><span class="crayon-e">Avg2012</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-320"><span class="crayon-e">Avg2011</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-321"><span class="crayon-e">update</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-322"><span class="crayon-e">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">explorer</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Browser</span><span class="crayon-h"> </span><span class="crayon-e">Helper</span><span class="crayon-h"> </span><span class="crayon-e">Objects</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">{</span><span class="crayon-cn">8CA7E745</span>-<span class="crayon-i">EF75</span>-<span class="crayon-cn">4E7B</span>-<span class="crayon-i">BB86</span>-</div><div class="crayon-line" id="crayon-67df89286a53b437284447-323"><span class="crayon-cn">8065C0CE29CA</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-324"><span class="crayon-e">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Windows</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">explorer</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Browser</span><span class="crayon-h"> </span><span class="crayon-e">Helper</span><span class="crayon-h"> </span><span class="crayon-e">Objects</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-sy">{</span><span class="crayon-i">BB62FFF4</span>-<span class="crayon-cn">41CB</span>-<span class="crayon-cn">4AFC</span>-<span class="crayon-i">BB8C</span>-</div><div class="crayon-line" id="crayon-67df89286a53b437284447-325"><span class="crayon-cn">2A4D4B42BBDC</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-326"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">Internet </span><span class="crayon-i">Explorer</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-e">MainEnable </span><span class="crayon-e">Browser </span><span class="crayon-e">Extensions</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-327"><span class="crayon-i">httpd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-328"><span class="crayon-ta">%</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">httpd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-329"><span class="crayon-e">connect</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-330"><span class="crayon-i">data</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">index</span><span class="crayon-sy">.</span><span class="crayon-e">php</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-331"><span class="crayon-i">logs</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">error</span><span class="crayon-sy">.</span><span class="crayon-e">log</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-332"><span class="crayon-i">error</span><span class="crayon-sy">.</span><span class="crayon-i">log</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-333"><span class="crayon-h">&lt;</span><span class="crayon-sy">?</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-s">';\n$bot_id = '</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-334"><span class="crayon-sy">$</span><span class="crayon-i">bot_net</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'$key_log_file = '</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-335"><span class="crayon-sy">$</span><span class="crayon-i">process_file</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span>'</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-336"><span class="crayon-cn">127.0.0.1</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-337"><span class="crayon-i">Listen</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">u</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-338"><span class="crayon-i">conf</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">httpd</span><span class="crayon-sy">.</span><span class="crayon-i">confSSL_PORT</span><span class="crayon-sy">%</span><span class="crayon-i">u</span><span class="crayon-h">&gt;</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-339"><span class="crayon-sy">[</span><span class="crayon-i">type</span>=<span class="crayon-i">post</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-340"><span class="crayon-sy">[</span><span class="crayon-i">type</span>=<span class="crayon-i">screen</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-341"><span class="crayon-sy">[</span><span class="crayon-i">type</span>=<span class="crayon-i">knock</span><span class="crayon-sy">]</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-342"><span class="crayon-cn">74</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">834E0440B832FFFFFF</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-343"><span class="crayon-cn">74</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">834E04405F5EB832FFFFFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-344"><span class="crayon-e">DEBUG</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-345"><span class="crayon-i">memory</span><span class="crayon-sy">.</span><span class="crayon-e">dmp</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-346"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-e">xml</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-347"><span class="crayon-i">php5ts</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-348"><span class="crayon-e">zend_stream_fixup</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-349"><span class="crayon-e">zend_compile_file</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-350"><span class="crayon-i">index</span><span class="crayon-sy">.</span><span class="crayon-e">php</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-351"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-e">php</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-352"><span class="crayon-i">content</span><span class="crayon-sy">.</span><span class="crayon-e">php</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-353"><span class="crayon-i">iexplore</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">firefox</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">chrome</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">opera</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">browser</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">dragon</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">epic</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">sbrender</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">vivaldi</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">maxthon</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-e">ybr</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-354"><span class="crayon-i">owser</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">|</span><span class="crayon-i">microsoftedgecp</span><span class="crayon-sy">.</span><span class="crayon-e">exe</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-355"><span class="crayon-e">InternetQueryDataAvailable</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-356"><span class="crayon-e">InternetReadFileInternetReadFileExA</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-357"><span class="crayon-e">InternetReadFileExW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-358"><span class="crayon-e">InternetSetStatusCallbackA</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-359"><span class="crayon-e">InternetSetStatusCallbackW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-360"><span class="crayon-e">HttpSendRequestAHttpSendRequestExA</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-361"><span class="crayon-e">HttpSendRequestExW</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-362"><span class="crayon-i">HttpSendRequestW</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n0</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-363"><span class="crayon-sy">.</span><span class="crayon-i">rdata</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-364"><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">n</span><span class="crayon-sy">\</span><span class="crayon-i">r</span><span class="crayon-sy">\</span><span class="crayon-i">nHTTP</span>/<span class="crayon-cn">1.</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-365"><span class="crayon-i">Transfer</span>-<span class="crayon-e">Encoding</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-366"><span class="crayon-e">chunked</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-367"><span class="crayon-i">Content</span>-<span class="crayon-e">Length</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-368"><span class="crayon-e">close</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-369"><span class="crayon-i">Proxy</span>-<span class="crayon-i">ConnectionHostAccept</span>-<span class="crayon-i">Encoding</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-370"><span class="crayon-i">x</span>-<span class="crayon-i">xss</span>-<span class="crayon-i">protectionx</span>-<span class="crayon-i">content</span>-<span class="crayon-i">security</span>-<span class="crayon-i">policy</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-371"><span class="crayon-i">x</span>-<span class="crayon-i">frame</span>-<span class="crayon-i">options</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-372"><span class="crayon-i">x</span>-<span class="crayon-i">content</span>-<span class="crayon-i">type</span>-<span class="crayon-e">options</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-373"><span class="crayon-st">If</span>-<span class="crayon-i">Modified</span>-<span class="crayon-e">Since</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-374"><span class="crayon-st">If</span>-<span class="crayon-i">None</span>-<span class="crayon-e">Match</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-375"><span class="crayon-i">content</span>-<span class="crayon-i">security</span>-<span class="crayon-i">policy</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-376"><span class="crayon-i">x</span>-<span class="crayon-i">webkit</span>-<span class="crayon-e">cspConnection</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-377"><span class="crayon-i">http</span><span class="crayon-sy">:</span><span class="crayon-c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-378"><span class="crayon-i">https</span><span class="crayon-sy">:</span><span class="crayon-c">//NSS layer</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-379"><span class="crayon-i">Content</span>-<span class="crayon-e">TypeBasic </span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-380"><span class="crayon-e">PR_ClosePR_Connect</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-381"><span class="crayon-e">PR_GetNameForIdentity</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-382"><span class="crayon-e">PR_Read</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-383"><span class="crayon-e">PR_SetError</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-384"><span class="crayon-i">PR_WriteReferer</span><span class="crayon-sy">:</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-385"><span class="crayon-i">Accept</span>-<span class="crayon-i">Encoding</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-e">r</span><span class="crayon-sy">\</span><span class="crayon-e">n1406SOFTWARE</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-e">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-e">Internet</span><span class="crayon-h"> </span><span class="crayon-e">Settings</span><span class="crayon-sy">\</span><span class="crayon-e">Zones</span><span class="crayon-sy">\</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-386"><span class="crayon-e">data_after</span><span class="crayon-sy">\</span><span class="crayon-e">ndata_before</span><span class="crayon-sy">\</span><span class="crayon-e">n</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-387"><span class="crayon-e">data_enddata_inject</span><span class="crayon-sy">\</span><span class="crayon-e">n</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-388"><span class="crayon-e">set_url</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-e">BOTID</span><span class="crayon-sy">%</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-389"><span class="crayon-ta">%</span><span class="crayon-i">BOTNET</span><span class="crayon-sy">%</span><span class="crayon-i">InternetCloseHandle</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-390"><span class="crayon-i">HTMLc</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-i">inject</span><span class="crayon-sy">.</span><span class="crayon-e">txt</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-391"><span class="crayon-i">Dalvik</span>/<span class="crayon-cn">1.6.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">Linux</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">U</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">Android</span><span class="crayon-h"> </span><span class="crayon-cn">4.1.2</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">GT</span>-<span class="crayon-e">N7000 </span><span class="crayon-i">Build</span>/<span class="crayon-i">JZO54K</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53b437284447-392"><span class="crayon-i">xxx_process_0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line" id="crayon-67df89286a53b437284447-393"><span class="crayon-i">Common</span><span class="crayon-sy">.</span><span class="crayon-i">js</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0043 seconds] -->
<p></p>
<h3>API Obfuscation</h3>
<p>The main payload uses an API obfuscation technique known as <a href="https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/a_museum_of_api_obfuscation_on_win32.pdf">Push-Calc-Ret obfuscation</a>. The calls to the real API functions are patched by the second stage injector after the main payload gets injected into the svchost process. Whenever a Windows API function should have been called, instead the address of a trampoline function is called which calculates the actual function address. All the trampoline function addresses are stored in an array in memory.</p>
<p>For example, the main payload wants to call CreateFile(), but this call is patched. Now, it calls the trampoline function which could look as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a53f482170813" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
00846110   PUSH 2B464C25
00846115   PUSHFD
00846116   XOR DWORD PTR SS:[ESP+4], 5DB5E13F
0084611E   POPFD
0084611F   RETN</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a53f482170813-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53f482170813-2">2</div><div class="crayon-num" data-line="crayon-67df89286a53f482170813-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a53f482170813-4">4</div><div class="crayon-num" data-line="crayon-67df89286a53f482170813-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a53f482170813-1"><span class="crayon-cn">00846110</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">PUSH</span><span class="crayon-h"> </span><span class="crayon-cn">2B464C25</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53f482170813-2"><span class="crayon-cn">00846115</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">PUSHFD</span></div><div class="crayon-line" id="crayon-67df89286a53f482170813-3"><span class="crayon-cn">00846116</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">XOR</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-i">SS</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">ESP</span>+<span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5DB5E13F</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a53f482170813-4"><span class="crayon-cn">0084611E</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">POPFD</span></div><div class="crayon-line" id="crayon-67df89286a53f482170813-5"><span class="crayon-cn">0084611F</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">RETN</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>First, a value is pushed to the stack. Next, the EFLAGS register is saved to the stack, because it will be altered by the following XOR instruction (OF, CF flags are cleared and the SF, ZF, and PF flags are set according to the result). Then, the previously pushed value is XORed with another value to calculate the actual API function address. At last, the EFLAGS register gets restored and the real API function address is called via the RETN instruction.</p>
<h4>Persistence Method</h4>
<p>The main payload copies the initial obfuscated loader file to the %ProgramData% folder with a random file retrieved with GetTickCount(). Then, it creates a JScript file named "Common.js" in the Startup folder of the current user. The file contains the following code which runs the initial loader after the system was rebooted:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a541308995617" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var yqvltidpue = new ActiveXObject("WScript.Shell");
yqvltidpue.Run("C:\\PROGRA~3\\930d4a6d.exe")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a541308995617-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a541308995617-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a541308995617-1"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-i">yqvltidpue</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ActiveXObject</span><span class="crayon-sy">(</span><span class="crayon-s">"WScript.Shell"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a541308995617-2"><span class="crayon-i">yqvltidpue</span><span class="crayon-sy">.</span><span class="crayon-e">Run</span><span class="crayon-sy">(</span><span class="crayon-s">"C:\\PROGRA~3\\930d4a6d.exe"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4>Updates of the Main Payload compared to Previous Version</h4>
<p>Reports on previous versions of Shifu have been published by <a href="https://www.fireeye.com/blog/threat-research/2015/10/shifu-malware-analyzed-behavior-capabilities-and.html">FireEye</a> and <a href="https://www.virusbulletin.com/virusbulletin/2015/11/shifu-rise-self-destructive-banking-trojan/">Fortinet</a>.</p>
<p>In comparison to the previous version, the list of substrings to scan for in the string that gets created with the computer name, user name, install date and system drive volume serial number was expanded:</p>
<ul>
<li>TREASURE</li>
<li>BUH</li>
<li>BANK</li>
<li>ACCOUNT</li>
<li>CASH</li>
<li>FINAN</li>
<li>MONEY</li>
<li>MANAGE</li>
<li>OPER</li>
<li>DIRECT</li>
<li>ROSPIL</li>
<li>CAPO</li>
<li>BOSS</li>
<li>TRADE</li>
</ul>
<p>Updated command list:</p>
<ul>
<li>active_sk</li>
<li>deactive_sk</li>
<li>deactivebc</li>
<li>get_keylog</li>
<li>get_sols</li>
<li>inject</li>
<li>kill_os</li>
<li>load</li>
<li>mitm_geterr</li>
<li>mitm_mod</li>
<li>mitm_script</li>
<li>wipe_cookies</li>
</ul>
<p>Updated list of targeted browsers:</p>
<ul>
<li>iexplore.exe</li>
<li>firefox.exe</li>
<li>chrome.exe</li>
<li>opera.exe</li>
<li>browser.exe</li>
<li>dragon.exe</li>
<li>epic.exe</li>
<li>sbrender.exe</li>
<li>vivaldi.exe</li>
<li>maxthon.exe</li>
<li>ybrowser.exe</li>
<li>microsoftedgecp.exe</li>
</ul>
<p>The main payload will download the Apache httpd.exe server file from one of the C&amp;C servers to store it on disk for web injection purposes. Compared to the previous version, the main payload also contains two strings which indicate some functionality for the Zend PHP Framework:</p>
<ul>
<li>zend_stream_fixup</li>
<li>zend_compile_file</li>
</ul>
<h4>Function Hooking in Svchost</h4>
<p>Like in the previous version, the malware hooks some API functions to redirect URLs, capture network traffic, the clipboard and to log keystrokes. It uses a technique known as inline function hooking where the first 5 bytes of a function get patched with a jump to the malware's hook handlers. The following functions get hooked:</p>
<ul>
<li>NtDeviceIoControlFile (ntdll.dll)</li>
<li>ZwDeviceIoControlFile (ntdll.dll)</li>
<li>GetClipboardData (user32.dll)</li>
<li>GetMessageA (user32.dll)</li>
<li>GetMessageW (user32.dll)</li>
<li>TranslateMessage (user32.dll)</li>
<li>GetAddrInfoExW (ws2_32.dll)</li>
<li>gethostbyname (ws2_32.dll)</li>
<li>getaddrinfo (ws2_32.dll)</li>
</ul>
<h4>Network Functionality</h4>
<p>The main payload of Shifu uses .bit top-level domains which is a decentralized DNS system based on the Namecoin infrastructure. The malware requests the IP addresses of the domains by subsequently contacting the following hardcoded Namecoin DNS servers:</p>
<ul>
<li>92.222.80.28</li>
<li>78.138.97.93</li>
<li>77.66.108.93</li>
</ul>
<p>The C&amp;C domain names, the user-agent string and the URL parameters are encrypted with a modified RC4 encryption algorithm. Decrypted strings:</p>
<ul>
<li>klyatiemoskali.bit</li>
<li>slavaukraine.bit</li>
<li>Mozilla/5.0 (Windows; U; Windows NT 5.2 x64; en-US; rv:1.9a1) Gecko/20061007 Minefield/3.0a1</li>
<li>L9mS3THljZylEx46ymJ2eqIdsEguKC15KnyQdfx4RTcVu8gCT</li>
<li>https://www.bing.com</li>
<li>/english/imageupload.php</li>
<li>/english/userlogin.php</li>
<li>/english/userpanel.php</li>
<li>1brz</li>
</ul>
<p>The encrypted strings are stored in the following format inside the .data section:</p>
<p style="padding-left: 30px;">&lt;LengthOfString&gt;&lt;EncryptedString&gt;</p>
<p>The domain string klyatiemoskali means roughly translated to wish something bad to Muscovites. The second domain string slavaukraine means translated glory to the Ukraine. The included RC4 key "L9mS3THljZylEx46ymJ2eqIdsEguKC15KnyQdfx4RTcVu8gCT" is used to encrypt the network traffic.</p>
<p>At the time of analysis, only the following Namecoin DNS server was answering with the IP address of the actual C&amp;C server:</p>
<p style="padding-left: 30px;">77.66.108.93 (ns1.dk.dns.d0wn.biz)</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23093 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5.png" alt="shifu_5" width="945" height="691" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5.png 945w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5-590x430.png 590w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5-900x658.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5-300x219.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5-768x562.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_5-370x271.png 370w" sizes="(max-width: 945px) 100vw, 945px" /></a></p>
<p><em>Figure 5. Namecoin DNS server information of 77.66.108.93</em></p>
<p>The following screenshot shows the captured network traffic during the dynamic analysis of Shifu:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_6.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23090 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_6.png" alt="shifu_6" width="945" height="500" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_6.png 945w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_6-900x476.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_6-300x159.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_6-768x406.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_6-370x196.png 370w" sizes="(max-width: 945px) 100vw, 945px" /></a></p>
<p><em>Figure 6. Shifu network traffic captured with Wireshark</em></p>
<p>We can see that Shifu subsequently queries the Namecoin DNS servers with the domain name klyatiemoskali.bit to get the IP address. After one name server responds with the IP address of the C&amp;C server, it does a TLS handshake to open an encrypted network channel. Finally, it sends some encrypted data and gets an encrypted answer. However, no further network traffic could have been observed during the time of the analysis. Both domain names, klyatiemoskali.bit and slavaukraine.bit, resolved to the IP address 103.199.16.106 at the time of analysis.</p>
<p>As the .bit top-level domain relies on the Namecoin cryptocurrency which is based on the Bitcoin system, every transaction can be traced back. Thus, we can use a Namecoin block explorer to look when the .bit domains were registered and which IP addresses are connected to it. For example, if we use the web service namecha.in, we can get the following information for klyatiemaskali.bit:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_7.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23087 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_7.png" alt="shifu_7" width="945" height="383" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_7.png 945w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_7-900x365.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_7-300x122.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_7-768x311.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_7-370x150.png 370w" sizes="(max-width: 945px) 100vw, 945px" /></a></p>
<p>We can see the same information for slavaukraine.bit:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_8.png" rel="wpdevart_lightbox"><img  class="alignnone size-full wp-image-23084 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_8.png" alt="shifu_8" width="945" height="380" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_8.png 945w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_8-900x362.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_8-300x121.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_8-768x309.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/01/Shifu_8-370x149.png 370w" sizes="(max-width: 945px) 100vw, 945px" /></a></p>
<p>Both domains were registered on 2016-06-03 and only one IP address is assigned to them. This IP address coincides with the response of the Namecoin DNS server we have seen in the captured network traffic. Moreover, we can see the domain seems to be still active.</p>
<h4>URL Query String for C&amp;C Server</h4>
<p>The main payload contains a query string template used to send information of the victim to the C&amp;C server:</p>
<p>botid=%s&amp;ver=%s.%u&amp;up=%u&amp;os=%u&amp;ltime=%s%d&amp;token=%d&amp;cn=%s&amp;av=%s&amp;dmn=%s&amp;mitm=%u</p>
<p>We can see that some information is dynamically retrieved (<strong>bot id</strong>entifier, <strong>up</strong>time, <strong>o</strong>perating <strong>s</strong>ystem version, <strong>l</strong>ocal <strong>time</strong>stamp, <strong>token</strong>, <strong>a</strong>nti-<strong>v</strong>irus software, <strong>d</strong>o<strong>m</strong>ai<strong>n</strong> name of workstation, <strong>m</strong>an <strong>i</strong>n <strong>t</strong>he <strong>m</strong>iddle interception detected), while also static values like the bot <strong>ver</strong>sion and the <strong>c</strong>ampaign <strong>n</strong>ame are send. An example of the created query string could look as follows:</p>
<p>botid=26C47136!A5A4B18A!F2F924F2&amp;ver=1.759&amp;up=18294&amp;os=6110&amp;ltime=-8&amp;token=0&amp;cn=1brz&amp;av=&amp;dmn=&amp;mitm=0</p>
<p>We can see that the internal Shifu version is 1.759 and the campaign name is stated 1brz.</p>
<p>If we compare Shifu's query string with the one of the latest Shiz version we have tracked which dates February 2014 (internal version 5.6.25), we can see the similarity between those two malwares:</p>
<p>botid=%s&amp;ver=5.6.25&amp;up=%u&amp;os=%03u&amp;ltime=%s%d&amp;token=%d&amp;cn=sochi&amp;av=%s</p>
<h3>Modified RC4 Encryption Algorithm</h3>
<p>Shifu uses a modified version of the RC4 encryption algorithm. We have reconstructed the algorithm in Python and show how the domain name "klyatiemoskali.bit" present in the main payload will be encrypted as an example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67df89286a543062582085" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import os
import binascii

###initial values##########
string = "klyatiemoskali.bit"
seed = 
"fnbqooqdaixfueangywblgabirdgvkewdyqgfqaioluesyrpryfkjerfsouemaxnavrkguxmcmhckwprunurmhehclermtufwi
yjbqhwlunbunuumeowfjmerxppxrgaxukyx"
buffer = [0] * (len(string))
table_encr = [0] * 0x102
table_encr[0x100] = 1
table_encr[0x101] = 0
###########################

###string2buffer###########
i = 0
while (i&lt;len(string)):
    char_1 = string[i]
    int_1 = ord (char_1)
    buffer[i] = int_1
    i += 1
###string2buffer###########

###encryption table########
i = 0
while (i &lt; 0x100):
    table_encr[i] = 0x000000ff&amp;i
    i += 1

i = 0
j = 0
while (i &lt; 0x100):
    char_1 = seed[j]
    int_2 = ord (char_1)
    table_encr[i] ^= int_2
    i += 1
    j += 1
    if (j == len(seed)):
        j = 0
###########################

###encryption##############
size_1 = len(string)
i = 0
while (size_1 != 0):
    byte_buf = buffer[i]
    ind_1 = table_encr[0x100]
    ind_2 = table_encr[ind_1]
    ind_3 = 0x000000ff&amp;(ind_2 + table_encr[0x101])
    ind_4 = 0x000000ff&amp;(table_encr[ind_3])
    table_encr[ind_1] = ind_4
    table_encr[ind_3] = ind_2
    buffer[i] = 0x000000ff&amp;(table_encr[0x000000ff&amp;(ind_2 + ind_4)] ^ byte_buf)
    table_encr[0x100] = 0x000000ff&amp;(ind_1 + 1)
    table_encr[0x101] = ind_3
    i += 1
    size_1 -= 1

i = 0
str_1 = ""
while (i &lt; len(string)):
    str_1 = str_1 + chr(buffer[i])
    i += 1
###########################
    
###output##################
print ("Cleartext string: %s" % string)
print ("Encrypted: 0x%s" % binascii.hexlify(str_1)) 
###########################</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67df89286a543062582085-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-2">2</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-4">4</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-6">6</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-8">8</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-10">10</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-12">12</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-14">14</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-16">16</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-18">18</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-20">20</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-22">22</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-24">24</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-26">26</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-28">28</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-30">30</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-32">32</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-34">34</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-36">36</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-38">38</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-40">40</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-42">42</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-44">44</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-46">46</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-48">48</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-50">50</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-52">52</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-54">54</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-56">56</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-58">58</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-60">60</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-62">62</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-64">64</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-66">66</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-67df89286a543062582085-68">68</div><div class="crayon-num" data-line="crayon-67df89286a543062582085-69">69</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67df89286a543062582085-1"><span class="crayon-e">import </span><span class="crayon-e">os</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-2"><span class="crayon-e">import </span><span class="crayon-i">binascii</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-4"><span class="crayon-p">###initial values##########</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-5"><span class="crayon-t">string</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"klyatiemoskali.bit"</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-6"><span class="crayon-i">seed</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-67df89286a543062582085-7"><span class="crayon-s">"fnbqooqdaixfueangywblgabirdgvkewdyqgfqaioluesyrpryfkjerfsouemaxnavrkguxmcmhckwprunurmhehclermtufwi</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-8"><span class="crayon-s">yjbqhwlunbunuumeowfjmerxppxrgaxukyx"</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-9"><span class="crayon-i">buffer</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">string</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-10"><span class="crayon-i">table_encr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-cn">0x102</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-11"><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-cn">0x100</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-12"><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-cn">0x101</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-13"><span class="crayon-p">###########################</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-14">&nbsp;</div><div class="crayon-line" id="crayon-67df89286a543062582085-15"><span class="crayon-p">###string2buffer###########</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-16"><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-17"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h">&lt;</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">string</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">char_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">int_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">char_1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">buffer</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">int_1</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-22"><span class="crayon-p">###string2buffer###########</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-24"><span class="crayon-p">###encryption table########</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-25"><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-26"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x000000ff</span><span class="crayon-h">&amp;i</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-30"><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-31"><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-32"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">char_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">seed</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">int_2</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">char_1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>^=<span class="crayon-h"> </span><span class="crayon-i">int_2</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">j</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">j</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">seed</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-40"><span class="crayon-p">###########################</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-42"><span class="crayon-p">###encryption##############</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-43"><span class="crayon-i">size_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">string</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-44"><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-45"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">size_1</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">byte_buf</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">buffer</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">ind_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-cn">0x100</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">ind_2</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-i">ind_1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">ind_3</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x000000ff</span>&<span class="crayon-sy">(</span><span class="crayon-i">ind_2</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-cn">0x101</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">ind_4</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x000000ff</span>&<span class="crayon-sy">(</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-i">ind_3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-i">ind_1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">ind_4</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-52"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-i">ind_3</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">ind_2</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-53"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">buffer</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x000000ff</span>&<span class="crayon-sy">(</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-cn">0x000000ff</span>&<span class="crayon-sy">(</span><span class="crayon-i">ind_2</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">ind_4</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>^<span class="crayon-h"> </span><span class="crayon-i">byte_buf</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-cn">0x100</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x000000ff</span>&<span class="crayon-sy">(</span><span class="crayon-i">ind_1</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">table_encr</span><span class="crayon-sy">[</span><span class="crayon-cn">0x101</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">ind_3</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">size_1</span><span class="crayon-h"> </span>-=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-58">&nbsp;</div><div class="crayon-line" id="crayon-67df89286a543062582085-59"><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-60"><span class="crayon-i">str_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-61"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">string</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">str_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">str_1</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-i">buffer</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-64"><span class="crayon-p">###########################</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-66"><span class="crayon-p">###output##################</span></div><div class="crayon-line" id="crayon-67df89286a543062582085-67"><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"Cleartext string: %s"</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67df89286a543062582085-68"><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"Encrypted: 0x%s"</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-i">binascii</span><span class="crayon-sy">.</span><span class="crayon-e">hexlify</span><span class="crayon-sy">(</span><span class="crayon-i">str_1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-67df89286a543062582085-69"><span class="crayon-p">###########################</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>&nbsp;</p>
      
              </div>
              <!--<span class="post__date">Updated 6 January, 2017 at 12:00 PM PST</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/banking/" role="link" title="banking" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:tags:banking">Banking</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/shifu/" role="link" title="Shifu" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:tags:Shifu">Shifu</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/threat-research/" role="link" title="threat research" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:tags:threat research">Threat research</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/trojan/" role="link" title="Trojan" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:tags:Trojan">Trojan</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/unit42-dragonok-updates-toolset-targets-multiple-geographic-regions/" role="link" title="DragonOK Updates Toolset and Targets Multiple Geographic Regions" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:article-nav:DragonOK Updates Toolset and Targets Multiple Geographic Regions"> 
            <span>Next: DragonOK Updates Toolset and Targets Multiple Geographic Regions</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/unit42-threat-intelligence-roundup/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:sidebar:related-articles:From DarkGate to AsyncRAT: Malware Detected and Shared As Unit 42 Timely Threat Intelligence">
                      From DarkGate to AsyncRAT: Malware Detected and Shared As Unit 42 Timely Threat Intelligence                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/new-linux-xorddos-trojan-campaign-delivers-malware/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:sidebar:related-articles:Blocking Dedicated Attacking Hosts Is Not Enough: In-Depth Analysis of a Worldwide Linux XorDDoS Campaign">
                      Blocking Dedicated Attacking Hosts Is Not Enough: In-Depth Analysis of a Worldwide Linux XorDDoS Campaign                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:sidebar:related-articles:Targeted Attack Campaign Against ManageEngine ADSelfService Plus Delivers Godzilla Webshells, NGLite Trojan and KdcSponge Stealer">
                      Targeted Attack Campaign Against ManageEngine ADSelfService Plus Delivers Godzilla Webshells, NGLite Trojan and KdcSponge Stealer                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related  Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of unusual malware. A glowing pink warning triangle with an exclamation point on a screen with the word &quot;malware.&quot; There are other text elements on the screen suggesting a coding environment. The colors are neon blue and pink." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-14T10:00:04+00:00">March 14, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/unusual-malware/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware">
                    <h4 class="post-title">Off the Beaten Path: Recent Unusual Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/net/" title=".NET" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:.NET">.NET</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/c/" title="C++" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:C++">C++</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/unusual-malware/" title="Off the Beaten Path: Recent Unusual Malware" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of scam crypto investment platforms. A digital image featuring glowing numerical data and key cybersecurity terms like &quot;Crime,&quot; &quot;Hackers,&quot; and &quot;Security&quot; highlighted across a dark, abstract background." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-13T10:00:21+00:00">March 13, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/fraud-crypto-platforms-campaign/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims">
                    <h4 class="post-title">Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/scams/" title="Scams" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Scams">Scams</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/phishing/" title="phishing" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:phishing">Phishing</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Cryptocurrency">Cryptocurrency</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fraud-crypto-platforms-campaign/" title="Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of popular malware families like Agent Tesla, XWorm and FormBook/XLoader. A blurred image of a person in a dynamic coding environment, with visible code on screens and colorful lighting predominantly in blue and pink tones. The scene suggests an intense focus on technology and software development." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-03T11:00:19+00:00">March 3, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/malware-obfuscation-techniques/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization">
                    <h4 class="post-title">Uncovering .NET Malware Obfuscated by Encryption and Virtualization</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/net/" title=".NET" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:.NET">.NET</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/agenttesla/" title="AgentTesla" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:AgentTesla">AgentTesla</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/anti-analysis/" title="anti-analysis" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:anti-analysis">Anti-analysis</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/malware-obfuscation-techniques/" title="Uncovering .NET Malware Obfuscated by Encryption and Virtualization" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58AM-786x368.jpg" class="lozad" alt="A pictorial representation of Squidoor. A vivid display of multiple monitors showing graphics and text related to a cyber attack, featuring skull symbols and digital distortions." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58AM-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58AM-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58AM-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58AM-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58AM.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-27T11:00:15+00:00">February 27, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/advanced-backdoor-squidoor/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations">
                    <h4 class="post-title">Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/web-shells/" title="web shells" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations:web shells">Web shells</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/advanced-backdoor-squidoor/" title="Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Squidoor: Suspected Chinese Threat Actors Backdoor Targets Global Organizations:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of Koi Stealer and RustDoor. Digital code in various shades of blue on a black background in the shape of a skull." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-26T11:00:59+00:00">February 26, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/macos-malware-targets-crypto-sector/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector">
                    <h4 class="post-title">RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:macOS">MacOS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/infostealer/" title="Infostealer" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Infostealer">Infostealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/contagious-interview/" title="Contagious Interview" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Contagious Interview">Contagious Interview</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/macos-malware-targets-crypto-sector/" title="RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of new Linux malware Auto-color. Close-up view of a circuit board with illuminated red data streams and microchips, symbolizing advanced digital technology." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-24T23:00:52+00:00">February 24, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/new-linux-backdoor-auto-color/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor">
                    <h4 class="post-title">Auto-Color: An Emerging and Evasive Linux Backdoor</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/linux/" title="Linux" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:Linux">Linux</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:backdoor">Backdoor</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/new-linux-backdoor-auto-color/" title="Auto-Color: An Emerging and Evasive Linux Backdoor" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="292" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-786x292.png" class="lozad" alt="Pictorial representation of APT Stately Taurus. The silhouette of a bull and the Taurus constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-786x292.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-768x285.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-1536x570.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1.png 1616w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2025-02-20T11:00:23+00:00">February 20, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-uses-bookworm-malware/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware">
                    <h4 class="post-title">Stately Taurus Activity in Southeast Asia Links to Bookworm Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/stately-taurus/" title="Stately Taurus" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Stately Taurus">Stately Taurus</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/bookworm/" title="Bookworm" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Bookworm">Bookworm</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-uses-bookworm-malware/" title="Stately Taurus Activity in Southeast Asia Links to Bookworm Malware" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of macOS infostealers. Laptop on a desk displaying advanced cybersecurity software interface with vibrant red graphics, in a dimly lit room." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-04T11:00:12+00:00">February 4, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/macos-stealers-growing/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat">
                    <h4 class="post-title">Stealers on the Rise: A Closer Look at a Growing macOS Threat</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:macOS">MacOS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/infostealer/" title="Infostealer" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:Infostealer">Infostealer</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/macos-stealers-growing/" title="Stealers on the Rise: A Closer Look at a Growing macOS Threat" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-786x368.jpg" class="lozad" alt="Digital representation of jailbreaking DeepSeek. A dynamic, multicolored wave pattern with luminous particles, set against a dark background." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-01-30T21:30:36+00:00">January 30, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/jailbreaking-deepseek-three-techniques/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek">
                    <h4 class="post-title">Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/llm/" title="LLM" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:LLM">LLM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/jailbroken/" title="jailbroken" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:jailbroken">Jailbroken</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/genai/" title="GenAI" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:GenAI">GenAI</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/jailbreaking-deepseek-three-techniques/" title="Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of an espionage operation against high-value targets in South Asia. Digital artwork featuring an abstract blend of vibrant blue, pink, and black colors with fragments of HTML code visible, creating a dynamic and modern visual effect against a glitch effect photo of someone typing on a keyboard." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-01-29T23:00:17+00:00">January 29, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities/" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia">
                    <h4 class="post-title">CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:China">China</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cobalt-strike/" title="Cobalt Strike" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Cobalt Strike">Cobalt Strike</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mimikatz/" title="Mimikatz" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Mimikatz">Mimikatz</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities/" title="CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia" role="link" data-page-track="true" data-page-track-value="unit42-2016-updates-shifu-banking-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex/cloud"   role="link" title="Cloud Security" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security">Cloud Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cloud"   role="link" title="Cortex Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security:Cortex Cloud">Cortex Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security:Cortex Cloud:Prisma Cloud">Prisma Cloud</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item do-not-sell-link"> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright  2025 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/unit42-2016-updates-shifu-banking-trojan/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/unit42-2016-updates-shifu-banking-trojan/">JAPAN ()</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.7.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

function noSell(event) {
    event.preventDefault();
   if (( typeof OneTrust != 'undefined') &&  (!!OneTrust)) {
       OneTrust.ToggleInfoDisplay();
    }else{
      var href = event.target.getAttribute('href');
        window.open(href, '_blank'); 
    }
}

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "CloudCortex" || referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "CloudCortex" || referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
    
    $( ".do-not-sell-link a" ).on( "click", function( event ) {
        noSell(event);
      });
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
