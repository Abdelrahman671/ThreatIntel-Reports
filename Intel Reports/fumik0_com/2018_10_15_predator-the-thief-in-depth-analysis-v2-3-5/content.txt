<!doctype html>
<html lang=en class="no-js">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predator The Thief: In-depth analysis (v2.3.5) &#8211; Fumik0_&#039;s box</title>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//fonts-api.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//1.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='dns-prefetch' href='//jetpack.wordpress.com' />
<link rel='dns-prefetch' href='//public-api.wordpress.com' />
<link rel='preconnect' href='//i0.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Feed" href="https://fumik0.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Comments Feed" href="https://fumik0.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Predator The Thief: In-depth analysis (v2.3.5) Comments Feed" href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/fumik0.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.7.1/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='bootstrap-css' href='https://fumik0.com/wp-content/themes/mynote/assets/css/bootstrap.min.css?ver=4.1.0' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='https://fumik0.com/wp-content/themes/mynote/assets/css/fontawesome-all.min.css?ver=5.1.0' type='text/css' media='all' />
<link rel='stylesheet' id='mynote-font-roboto-css' href='https://fonts-api.wp.com/css?family=Roboto%3A300%2C400&#038;ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='mynote-css' href='https://fumik0.com/wp-content/themes/mynote/style.css?ver=1.3.6' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_likes-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/likes/style.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='subscription-modal-css-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/comments/subscription-modal-on-comment/subscription-modal.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='tablepress-default-css' href='https://fumik0.com/wp-content/plugins/tablepress/css/build/default.css?ver=2.4.3' type='text/css' media='all' />
<link rel='stylesheet' id='hcb-style-css' href='https://fumik0.com/wp-content/plugins/highlighting-code-block/build/css/hcb_style.css?ver=1.2.9' type='text/css' media='all' />
<style id='hcb-style-inline-css' type='text/css'>
.hcb_wrap pre.prism{font-size: 15px}@media screen and (max-width: 599px){.hcb_wrap pre.prism{font-size: 15px}}.hcb_wrap pre:not([data-file]):not([data-show-lang])::before{ content: none;}.hcb_wrap pre{-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;}.hcb_wrap pre{font-family:Menlo, Consolas, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;}
</style>
<link rel='stylesheet' id='hcb-coloring-css' href='https://fumik0.com/wp-content/plugins/highlighting-code-block/build/css/coloring_dark.css?ver=1.2.9' type='text/css' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css' type='text/css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='sharedaddy-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/sharedaddy/sharing.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://fumik0.com/wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css?ver=14.2-a.3' type='text/css' media='all' />
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/themes/mynote/assets/js/bootstrap.bundle.min.js?ver=4.1.0" id="bootstrap-js"></script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/fumik0.com\/wp-content\/mu-plugins\/wpcomsh\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<link rel="https://api.w.org/" href="https://fumik0.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://fumik0.com/wp-json/wp/v2/posts/282" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://fumik0.com/xmlrpc.php?rsd" />

<link rel="canonical" href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/" />
<link rel='shortlink' href='https://wp.me/p9vZjq-4y' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://fumik0.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ffumik0.com%2F2018%2F10%2F15%2Fpredator-the-thief-in-depth-analysis-v2-3-5%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://fumik0.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ffumik0.com%2F2018%2F10%2F15%2Fpredator-the-thief-in-depth-analysis-v2-3-5%2F&#038;format=xml" />
	<style>img#wpstats{display:none}</style>
		<style id="mynote-customizer">
@media (max-width: 768px) {
.footer-columns { text-align: center !important; }
.footer-columns .footer-column-left { text-align: center !important; }
}
.scroll-area { display: block !important; }
body.menu-is-collapsed .header { background: rgba(20, 25, 29, 1) !important; }

</style><meta name="description" content="Well, it&#039;s been a long time without some fresh new contents on my blog. I had some unexpected problems that kept me away from here and a lot of work (like my tracker) that explain this. But it&#039;s time to come back (slowly) with some stuff. So today, this is an In-Depth analysis of one&hellip;" />
<link rel="amphtml" href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Predator The Thief: In-depth analysis (v2.3.5)" />
<meta property="og:url" content="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/" />
<meta property="og:description" content="Well, it&#8217;s been a long time without some fresh new contents on my blog. I had some unexpected problems that kept me away from here and a lot of work (like my tracker) that explain this. But i…" />
<meta property="article:published_time" content="2018-10-15T13:46:24+00:00" />
<meta property="article:modified_time" content="2019-03-14T10:09:16+00:00" />
<meta property="og:site_name" content="Fumik0_&#039;s box" />
<meta property="og:image" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?fit=1062%2C746&#038;ssl=1" />
<meta property="og:image:width" content="1062" />
<meta property="og:image:height" content="746" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Predator The Thief: In-depth analysis (v2.3.5)" />
<meta name="twitter:image" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?fit=1062%2C746&#038;ssl=1&#038;w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=32%2C26&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=192%2C156&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=180%2C146&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=249%2C202&#038;ssl=1" />

</head>
<body class="post-template-default single single-post postid-282 single-format-standard has-site-icon predator-the-thief-in-depth-analysis-v2-3-5">
	<div class="wrapper">
		<header class="header clear" role="banner">
			<div class="container">
				<nav class="navbar navbar-expand-lg navbar-dark " role="navigation">
										<a class="navbar-brand" href="https://fumik0.com">
						<img src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=32%2C26&#038;ssl=1" alt="Logo" class="logo-img">
					</a>
					
											<div id="mynote-nav-bar" class="collapse navbar-collapse"><ul id="menu-primary" class="navbar-nav mr-auto"><li  id="menu-item-8"class="nav-item"><a href="/" class="nav-link">Home</a></li><li  id="menu-item-595"class="nav-item"><a href="http://tracker.fumik0.com" class="nav-link">Tracker</a></li><li  id="menu-item-786"class="nav-item"><a href="https://twitter.com/fumik0_" class="nav-link">Twitter</a></li><li  id="menu-item-9"class="nav-item"><a href="https://fumik0.com/about/" class="nav-link">About</a></li><li  id="menu-item-10"class="nav-item"><a href="https://fumik0.com/contact/" class="nav-link">Contact</a></li></ul></div>					
					<div class="search-bar">
						
<form id="search-form" class="search" method="get" action="https://fumik0.com" role="search" autocomplete="off">
	<input type="text" name="s" class="search-input" placeholder="To search, type and hit enter.">
	<span class="search-icon" onclick="document.getElementById('search-form').submit();"><i class="fas fa-search"></i></span>
</form>


					</div>
					
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mynote-nav-bar" aria-controls="mynote-nav-bar" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
				</nav>
			</div><!-- .container -->
		</header>


		

		<div class="single-post-title-bar clear" role="banner">
			<div class="container">
				<nav class="navbar navbar-expand-lg navbar-dark" role="navigation">
					<a class="navbar-brand" href="https://fumik0.com"></a>
					<div id="progress-title"></div>
				</nav>
			</div>
			<div class="progress-wrapper">
				<div class="progress-label"></div>
				<progress></progress>
			</div>
		</div>
	
<div class="data-schema is-single" itemscope itemtype="http://schema.org/Article">
											<nav class="breadcrumb">
			<div class="container">
				<ul class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
					<li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<a href="https://fumik0.com" itemprop="item">
							<span itemprop="name"><i class="fas fa-globe"></i><span class="sr-only">Home</span></span>
						</a>
						<meta itemprop="position" content="1">
					</li>
										<li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<a href="https://fumik0.com/category/reverse/" itemprop="item">
							<span itemprop="name">Reverse</span>
						</a>
						<meta itemprop="position" content="2">
					</li>
															<li class="breadcrumb-item active" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<span itemprop="name">Predator The Thief: In-depth analysis (v2.3.5)</span>
						<meta itemprop="item" content="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/">
						<meta itemprop="position" content="3">
					</li>
				</ul>
			</div>
		</nav>
		
			<div class="single-post-header">
				<div class="container">

					<h1 id="post-title" itemprop="headline">Predator The Thief: In-depth analysis (v2.3.5)</h1>
					<div class="post-mynote-buttons">

															<div class="btn-group column-control">
			<div class="btn-counter text-only active" data-target="#aside-container" role="button">		
				<div class="btn"><i class="fas fa-columns"></i></div>
			</div>
			<div class="btn-counter text-only" data-target="#sidebar" role="button">		
				<div class="btn"><i class="fas fa-list-ul"></i></div>
			</div> 
		</div>
							
												
		<a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/#comments" class="button-like-link">
			<div class="btn-counter">
				<div class="btn">
					<i class="fas fa-comment-dots"></i>
				</div>
				<div class="count-box">3</div>
			</div>
		</a>
						</div><!-- .post-mynote-buttons -->

											<div class="post-meta">
							<div class="author-posted-date"><img src="https://secure.gravatar.com/avatar/60460a1a0d00b32720a59ee2624bb4aa?s=40&#038;d=identicon&#038;r=g" class="rounded-circle poster-avatar" align="middle"> <a href="https://fumik0.com/author/fumko/" title="written October 15, 2018 @ 1:46 pm" class="author-link">fumko</a> <time itemprop="datePublished" datetime="2018-10-15T13:46:24+00:00">written 6 years ago</time></div>						</div>
					
				</div><!-- .container -->
			</div><!-- .single-post-header -->

			
	<div class="container">
		<div class="row row-layout-choice-post">
			<main id="main-container" class="col-lg-8 col-md-8 col-sm-12" role="main">

				
					
						
						<article id="post-282" class="markdown-body post-282 post type-post status-publish format-standard has-post-thumbnail hentry category-reverse tag-predator tag-reverse tag-stealer">

																	<figure>
			<img src="https://fumik0.com/wp-content/uploads/2018/10/EntryPoint.png" class="attachment- size- wp-post-image" alt="" itemprop="image" decoding="async" fetchpriority="high" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?w=1062&amp;ssl=1 1062w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?resize=300%2C211&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?resize=1024%2C719&amp;ssl=1 1024w" sizes="(max-width: 1062px) 100vw, 1062px" data-attachment-id="324" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/entrypoint/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?fit=1062%2C746&amp;ssl=1" data-orig-size="1062,746" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EntryPoint" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?fit=300%2C211&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint.png?fit=900%2C632&amp;ssl=1" />			<figcaption></figcaption>
		</figure>
								
							<div itemprop="articleBody">
								<p>Well, it&#8217;s been a long time without some fresh new contents on my blog. I had some unexpected problems that kept me away from here and a lot of work (like my tracker) that explain this. But it&#8217;s time to come back (slowly) with some stuff.</p>
<p style="text-align: justify;">So today, this is an In-Depth analysis of one stealer: &#8220;Predator the thief&#8221;, written in C/C++. Like dozen others malware, it&#8217;s a ready to sell malware delivered as a builder &amp; C2 panel package.</p>
<p style="text-align: justify;">The goal is to explain step by step how this malware is working with a lot of extra explanations for some parts. This post is mainly addressed for junior reverse engineers or malware analysts who want for future purposes to understand and defeat some techniques/tricks easily.</p>
<p>So here we go!</p>
<h2>Classical life cycle</h2>
<p>The execution order is almost the same, for most of the stealers nowadays. Changes are mostly varying between evading techniques and how they interact with the C2.  For example, with Predator, the set up is quite simple but could vary if the attacker set up a loader on his C2.</p>
<div id="attachment_375" style="width: 793px" class="wp-caption alignnone"><img data-recalc-dims="1" decoding="async" aria-describedby="caption-attachment-375" data-attachment-id="375" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/diagram/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Diagram.png?fit=783%2C783&amp;ssl=1" data-orig-size="783,783" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Diagram" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Diagram.png?fit=300%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Diagram.png?fit=783%2C783&amp;ssl=1" class="alignnone size-full wp-image-375" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Diagram.png?resize=783%2C783&#038;ssl=1" alt="Diagram" width="783" height="783" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Diagram.png?w=783&amp;ssl=1 783w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Diagram.png?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Diagram.png?resize=300%2C300&amp;ssl=1 300w" sizes="(max-width: 783px) 100vw, 783px" /><p id="caption-attachment-375" class="wp-caption-text">The life cycle of Predator the thief</p></div>
<h2>Preparing the field</h2>
<p>Before stealing sensitive data, Predator starts by setting up some basics stuff to be able to work correctly. Almost all the configuration is loaded into memory step by step.</p>
<p><img data-recalc-dims="1" decoding="async" data-attachment-id="383" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/entrypoint-2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint-1.png?fit=1056%2C737&amp;ssl=1" data-orig-size="1056,737" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EntryPoint" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint-1.png?fit=300%2C209&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint-1.png?fit=900%2C628&amp;ssl=1" class="alignnone size-full wp-image-383" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint-1.png?resize=900%2C628&#038;ssl=1" alt="EntryPoint" width="900" height="628" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint-1.png?w=1056&amp;ssl=1 1056w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint-1.png?resize=300%2C209&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/EntryPoint-1.png?resize=1024%2C715&amp;ssl=1 1024w" sizes="(max-width: 900px) 100vw, 900px" /></p>
<p>So let&#8217;s put a breakpoint at &#8220;0x00472866&#8221; and inspect the code&#8230;</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="325" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/call_setup/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Call_Setup.png?fit=355%2C745&amp;ssl=1" data-orig-size="355,745" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Call_Setup" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Call_Setup.png?fit=143%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Call_Setup.png?fit=355%2C745&amp;ssl=1" class=" size-full wp-image-325 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Call_Setup.png?resize=355%2C745&#038;ssl=1" alt="Call_Setup" width="355" height="745" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Call_Setup.png?w=355&amp;ssl=1 355w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Call_Setup.png?resize=143%2C300&amp;ssl=1 143w" sizes="auto, (max-width: 355px) 100vw, 355px" /></p>
<ol>
<li>EBX is set to be the length of our loop (in our case here, it will be 0x0F)</li>
<li>ESI have all functions addresses stored<img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="326" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/esi_addresses/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/ESI_Addresses.png?fit=545%2C107&amp;ssl=1" data-orig-size="545,107" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ESI_Addresses" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/ESI_Addresses.png?fit=300%2C59&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/ESI_Addresses.png?fit=545%2C107&amp;ssl=1" class=" size-full wp-image-326 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/ESI_Addresses.png?resize=545%2C107&#038;ssl=1" alt="ESI_Addresses" width="545" height="107" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/ESI_Addresses.png?w=545&amp;ssl=1 545w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/ESI_Addresses.png?resize=300%2C59&amp;ssl=1 300w" sizes="auto, (max-width: 545px) 100vw, 545px" /></li>
<li>EAX, will grab one address from ESI and moves it into EBP-8</li>
<li>EBP is called, so at this point, a config function will unpack some data and saved it into the stack)</li>
<li>ESI position is now advanced by 4</li>
<li>EDI is incremented until reaching the same value as stored EBX</li>
<li>When the EDI == EBX, it means that all required configuration values are stored into the stack. The main part of the malware could start</li>
</ol>
<p>So, for example, let&#8217;s see what we have  inside <em><strong>0040101D</strong></em> at 0x00488278</p>
<p>So with x32dbg, let&#8217;s see what we have&#8230; with a simple command</p>
<pre><strong>Command:</strong> <span style="color: #ff0000;">go</span> <span style="color: #ff6600;">0x0040101D</span></pre>
<p>As you can see, this is where the C2 is stored, uncovered and saved into the stack.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="323" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/c2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/C2.png?fit=777%2C256&amp;ssl=1" data-orig-size="777,256" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="C2" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/C2.png?fit=300%2C99&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/C2.png?fit=777%2C256&amp;ssl=1" class="alignnone size-full wp-image-323" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/C2.png?resize=777%2C256&#038;ssl=1" alt="C2" width="777" height="256" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/C2.png?w=777&amp;ssl=1 777w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/C2.png?resize=300%2C99&amp;ssl=1 300w" sizes="auto, (max-width: 777px) 100vw, 777px" /></p>
<p>So what values are stored with this technique?</p>
<ul>
<li>C2 Domain</li>
<li>%APPDATA% Folder</li>
<li>Predator Folder</li>
<li>temporary name of the archive predator file and position</li>
<li>also, the name of the archive when it will send to the C2</li>
<li>etc&#8230;</li>
</ul>
<p>With the help of the %APPDATA%/Roaming path, the Predator folder is created (\ptst). Something notable with this is that it&#8217;s hardcoded behind a Xor string and not generated randomly. By pure speculation, It could be a shortcut for &#8220;<strong>P</strong>redator <strong>T</strong>he <strong>ST</strong>ealer&#8221;.</p>
<p>This is also the same constatation for the name of the temporary archive file during the stealing process: <em><strong>&#8220;zpar.zip&#8221;</strong></em>.</p>
<h2><strong>The welcome message&#8230;</strong></h2>
<p>When you are positioned at the main module of the stealer, a lovely text looped over 0x06400000 times is addressed for people who want to reverse it.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="327" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/welcome/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/welcome.png?fit=900%2C575&amp;ssl=1" data-orig-size="900,575" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="welcome" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/welcome.png?fit=300%2C192&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/welcome.png?fit=900%2C575&amp;ssl=1" class="alignnone size-full wp-image-327" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/welcome.png?resize=900%2C575&#038;ssl=1" alt="welcome" width="900" height="575" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/welcome.png?w=900&amp;ssl=1 900w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/welcome.png?resize=300%2C192&amp;ssl=1 300w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h2><strong>Obfuscation Techniques</strong></h2>
<h3><strong>The thief who loves XOR (a little bit too much&#8230;)</strong></h3>
<p>Almost all the strings from this stealer sample are XORed, even if this obfuscation technique is really easy to understand and one of the easier to decrypt. Here, its used at multiple forms just to slow down the analysis.</p>
<div class="tiled-gallery type-rectangular tiled-gallery-unresized" data-original-width="900" data-carousel-extra='{&quot;blog_id&quot;:1,&quot;permalink&quot;:&quot;https:\/\/fumik0.com\/2018\/10\/15\/predator-the-thief-in-depth-analysis-v2-3-5\/&quot;,&quot;likes_blog_id&quot;:140610880}' itemscope itemtype="http://schema.org/ImageGallery" > <div class="gallery-row" style="width: 900px; height: 417px;" data-original-width="900" data-original-height="417" > <div class="gallery-group images-1" style="width: 559px; height: 417px;" data-original-width="559" data-original-height="417" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_variant_01/" border="0" itemprop="url"> <meta itemprop="width" content="555"> <meta itemprop="height" content="413"> <img decoding="async" class="" data-attachment-id="352" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/XOR_Variant_01.png" data-orig-size="339,252" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_Variant_01" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_01.png?fit=300%2C223&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_01.png?fit=339%2C252&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_01.png?w=555&#038;h=413&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_01.png?w=339&amp;ssl=1 339w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_01.png?resize=300%2C223&amp;ssl=1 300w" width="555" height="413" loading="lazy" data-original-width="555" data-original-height="413" itemprop="http://schema.org/image" title="XOR_Variant_01" alt="XOR_Variant_01" style="width: 555px; height: 413px;" /> </a> </div> </div> <!-- close group --> <div class="gallery-group images-2" style="width: 341px; height: 417px;" data-original-width="341" data-original-height="417" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_variant_02/" border="0" itemprop="url"> <meta itemprop="width" content="337"> <meta itemprop="height" content="170"> <img decoding="async" class="" data-attachment-id="353" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/XOR_Variant_02.png" data-orig-size="518,261" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_Variant_02" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_02.png?fit=300%2C151&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_02.png?fit=518%2C261&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_02.png?w=337&#038;h=170&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_02.png?w=518&amp;ssl=1 518w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_Variant_02.png?resize=300%2C151&amp;ssl=1 300w" width="337" height="170" loading="lazy" data-original-width="337" data-original-height="170" itemprop="http://schema.org/image" title="XOR_Variant_02" alt="XOR_Variant_02" style="width: 337px; height: 170px;" /> </a> </div> <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_case_01/" border="0" itemprop="url"> <meta itemprop="width" content="337"> <meta itemprop="height" content="239"> <img decoding="async" class="" data-attachment-id="283" data-orig-file="https://fumik0.com/wp-content/uploads/2018/09/XOR_Case_01.png" data-orig-size="480,341" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_Case_01" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/XOR_Case_01.png?fit=300%2C213&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/XOR_Case_01.png?fit=480%2C341&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/XOR_Case_01.png?w=337&#038;h=239&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/XOR_Case_01.png?w=480&amp;ssl=1 480w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/XOR_Case_01.png?resize=300%2C213&amp;ssl=1 300w" width="337" height="239" loading="lazy" data-original-width="337" data-original-height="239" itemprop="http://schema.org/image" title="XOR_Case_01" alt="XOR_Case_01" style="width: 337px; height: 239px;" /> </a> </div> </div> <!-- close group --> </div> <!-- close row --> </div>
<h3><strong>GetProcAddress Alternatives </strong></h3>
<p>For avoiding to call directly modules from different libraries, it uses some classic stuff to search step by step a specific API request and stores it into a register. It permits to hide the direct call of the module into a simple register call.</p>
<p>So firstly,  a XORed string (a DLL) is decrypted.  So for this case, the kernel32.dll is required for the specific module that the malware wants to call.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="302" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/step_1_api/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_1_API.png?fit=586%2C491&amp;ssl=1" data-orig-size="586,491" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Step_1_API" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_1_API.png?fit=300%2C251&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_1_API.png?fit=586%2C491&amp;ssl=1" class=" size-full wp-image-302 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_1_API.png?resize=586%2C491&#038;ssl=1" alt="Step_1_API" width="586" height="491" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_1_API.png?w=586&amp;ssl=1 586w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_1_API.png?resize=300%2C251&amp;ssl=1 300w" sizes="auto, (max-width: 586px) 100vw, 586px" /></p>
<p>When the decryption is done, this library is loaded with the help of &#8220;<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684175(v=vs.85).aspx">LoadLibraryA</a>&#8220;. Then, a clear text is pushed into EDX: &#8220;<a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createdirectorya">CreateDirectoryA</a>&#8220;&#8230; This will be the module that the stealer wants to use.</p>
<p>The only thing that it needs now, its to retrieve the address of an exported function &#8220;<a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createdirectorya">CreateDirectoryA</a>&#8221; from kernel32.dll. Usually, this is done with the help of <a href="https://msdn.microsoft.com/fr-fr/library/windows/desktop/ms683212(v=vs.85).aspx">GetProcAddress</a> but this function is in fact not called and another trick is used to get the right value.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="303" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/step_2_api/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_2_API.png?fit=466%2C271&amp;ssl=1" data-orig-size="466,271" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Step_2_API" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_2_API.png?fit=300%2C174&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_2_API.png?fit=466%2C271&amp;ssl=1" class=" size-full wp-image-303 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_2_API.png?resize=466%2C271&#038;ssl=1" alt="Step_2_API" width="466" height="271" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_2_API.png?w=466&amp;ssl=1 466w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_2_API.png?resize=300%2C174&amp;ssl=1 300w" sizes="auto, (max-width: 466px) 100vw, 466px" /></p>
<p>So this string and the <span class="n"><strong>IMAGE_DOS_HEADER</strong> </span>of kernel32.dll are sent into &#8220;func_GetProcesAddress_0&#8221;. The idea is to get manually the pointer of the function address that we want with the help of the Export Table. So let&#8217;s see what we have in the in it&#8230;</p>
<pre><strong><span class="k" style="color: #339966;">struct</span></strong> <span class="n">IMAGE_EXPORT_DIRECTORY</span> <span class="p">{</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="n">Characteristics</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="n">TimeDateStamp</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">short</span></strong></span> <span class="n">MajorVersion</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">short</span></strong></span> <span class="n">MinorVersion</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="n">Name</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="n">Base</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="n">NumberOfFunctions</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="n">NumberOfNames</span><span class="p">;</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="o">*</span><span class="n">AddressOfFunctions</span><span class="p">;    &lt;= This good boy</span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="o">*</span><span class="n">AddressOfNames</span><span class="p">;        &lt;= This good boy </span>
	<span style="color: #ff0000;"><strong><span class="kt">long</span></strong></span> <span class="o">*</span><span class="n">AddressOfNameOrdinals</span><span class="p">; &lt;= This good boy</span>
<span class="p">}</span></pre>
<p>After inspecting the structure de IMAGE_EXPORT_DIRECTORY, three fields are mandatory :</p>
<ul>
<li>AddressOfFunctions &#8211; An Array who contains the relative value address (RVA) of the functions of the module.</li>
<li>AddressOfNames &#8211; An array who stores with the ascending order of all functions from this module.</li>
<li>AddressOfNamesOrdinals &#8211; An 16 bits array who contains all the associated ordinals of functions names based on the AddressOfNames.</li>
</ul>
<p><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files">source</a></p>
<p>So after saving the absolute position of these 3 arrays, the loop is simple</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="335" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/function_get/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Function_Get.png?fit=540%2C323&amp;ssl=1" data-orig-size="540,323" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Function_Get" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Function_Get.png?fit=300%2C179&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Function_Get.png?fit=540%2C323&amp;ssl=1" class=" size-full wp-image-335 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Function_Get.png?resize=540%2C323&#038;ssl=1" alt="Function_Get" width="540" height="323" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Function_Get.png?w=540&amp;ssl=1 540w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Function_Get.png?resize=300%2C179&amp;ssl=1 300w" sizes="auto, (max-width: 540px) 100vw, 540px" /></p>
<ol>
<li>Grab the RVA of one function</li>
<li>Get the name of this function</li>
<li>Compare the string with the desired one.</li>
</ol>
<p>So let&#8217;s see in details to understand everything :</p>
<p><span class="p">If we dig into <strong>ds:<span style="color: #ff0000;">[</span><span style="color: #008080;">eax</span><span style="color: #ff6600;">+</span><span style="color: #0000ff;">edx</span><span style="color: #ff6600;">*</span><span style="color: #ff0000;">4]</span>,</strong> this where is stored all relative value address of the kernel32.dll export table functions.</span></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="331" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/rva/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/RVA.png?fit=537%2C277&amp;ssl=1" data-orig-size="537,277" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="RVA" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/RVA.png?fit=300%2C155&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/RVA.png?fit=537%2C277&amp;ssl=1" class=" size-full wp-image-331 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/RVA.png?resize=537%2C277&#038;ssl=1" alt="RVA" width="537" height="277" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/RVA.png?w=537&amp;ssl=1 537w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/RVA.png?resize=300%2C155&amp;ssl=1 300w" sizes="auto, (max-width: 537px) 100vw, 537px" /><br />
With the next instruction <strong><span style="color: #3366ff;">add</span> <span style="color: #008000;">eax</span><span style="color: #ff0000;">,</span><span style="color: #008000;">ecx</span></strong>. This remains to go at the exact position of the string value in the &#8220;AddressOfNames&#8221; array.</p>
<pre>DLLBaseAddress + AddressOfNameRVA[i] = Function Name 
   751F0000    +       0C41D4        = CreateDirectoryA</pre>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="334" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/address-of-names/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Address-of-names.png?fit=533%2C270&amp;ssl=1" data-orig-size="533,270" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Address of names" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Address-of-names.png?fit=300%2C152&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Address-of-names.png?fit=533%2C270&amp;ssl=1" class=" size-full wp-image-334 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Address-of-names.png?resize=533%2C270&#038;ssl=1" alt="Address of names" width="533" height="270" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Address-of-names.png?w=533&amp;ssl=1 533w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Address-of-names.png?resize=300%2C152&amp;ssl=1 300w" sizes="auto, (max-width: 533px) 100vw, 533px" /></p>
<p>The comparison is matching,  now it needs to store the &#8220;procAddress.  So First the Ordinal Number of the function is saved. Then with the help of this value, the Function Address position is grabbed and saved into ESI.</p>
<pre>ADD           ESI, ECX
ProcAddress = Function Address + DLLBaseAddress</pre>
<p>In disassembly, it looks like this :</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="339" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/getprocaddress/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GetProcAddress.png?fit=635%2C198&amp;ssl=1" data-orig-size="635,198" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="GetProcAddress" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GetProcAddress.png?fit=300%2C94&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GetProcAddress.png?fit=635%2C198&amp;ssl=1" class=" size-full wp-image-339 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GetProcAddress.png?resize=635%2C198&#038;ssl=1" alt="GetProcAddress" width="635" height="198" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GetProcAddress.png?w=635&amp;ssl=1 635w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GetProcAddress.png?resize=300%2C94&amp;ssl=1 300w" sizes="auto, (max-width: 635px) 100vw, 635px" /></p>
<p>Let&#8217;s inspect the code at the specific procAddress&#8230;</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="340" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/check_01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Check_01.png?fit=730%2C92&amp;ssl=1" data-orig-size="730,92" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Check_01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Check_01.png?fit=300%2C38&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Check_01.png?fit=730%2C92&amp;ssl=1" class="alignnone size-full wp-image-340" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Check_01.png?resize=730%2C92&#038;ssl=1" alt="Check_01" width="730" height="92" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Check_01.png?w=730&amp;ssl=1 730w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Check_01.png?resize=300%2C38&amp;ssl=1 300w" sizes="auto, (max-width: 730px) 100vw, 730px" /></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="304" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/step_end_api/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_END_API.png?fit=371%2C193&amp;ssl=1" data-orig-size="371,193" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Step_END_API" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_END_API.png?fit=300%2C156&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_END_API.png?fit=371%2C193&amp;ssl=1" class=" size-full wp-image-304 alignleft" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_END_API.png?resize=371%2C193&#038;ssl=1" alt="Step_END_API" width="371" height="193" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_END_API.png?w=371&amp;ssl=1 371w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Step_END_API.png?resize=300%2C156&amp;ssl=1 300w" sizes="auto, (max-width: 371px) 100vw, 371px" /></p>
<h2></h2>
<p>So everything is done, the address of the function is now stored into EAX and it only needs now to be called.</p>
<h2></h2>
<h2></h2>
<h2><strong>Anti-VM Technique</strong></h2>
<p>Here is used a simple Anti-VM Technique to check if this stealer is launched on a virtual machine. This is also the only Anti-Detection trick used on Predator.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="285" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/anti_vm_01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/Anti_VM_01.png?fit=725%2C540&amp;ssl=1" data-orig-size="725,540" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Anti_VM_01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/Anti_VM_01.png?fit=300%2C223&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/Anti_VM_01.png?fit=725%2C540&amp;ssl=1" class="alignnone size-full wp-image-285" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/Anti_VM_01.png?resize=725%2C540&#038;ssl=1" alt="Anti_VM_01" width="725" height="540" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/Anti_VM_01.png?w=725&amp;ssl=1 725w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/Anti_VM_01.png?resize=300%2C223&amp;ssl=1 300w" sizes="auto, (max-width: 725px) 100vw, 725px" /></p>
<p style="text-align: justify;">First, User32.dll (Xored) is dynamically loaded with the help of &#8220;<a href="https://docs.microsoft.com/fr-fr/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya">LoadLibraryA</a>&#8220;, Then &#8220;<a href="https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-enumdisplaydevicesa">EnumDisplayDevicesA</a>&#8221; module is requested with the help of User32.dll. The idea here is to get the value of the &#8220;Device Description&#8221; of the current display used.</p>
<p>When it&#8217;s done, the result is checked with some values (obviously xored too) :</p>
<ul>
<li>Hyper-V</li>
<li>VMware</li>
<li>VirtualBox</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="290" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/regedit_hyperv/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/regedit_hyperv.png?fit=653%2C556&amp;ssl=1" data-orig-size="653,556" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="regedit_hyperv" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/regedit_hyperv.png?fit=300%2C255&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/regedit_hyperv.png?fit=653%2C556&amp;ssl=1" class=" size-full wp-image-290 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/regedit_hyperv.png?resize=653%2C556&#038;ssl=1" alt="regedit_hyperv" width="653" height="556" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/regedit_hyperv.png?w=653&amp;ssl=1 653w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/09/regedit_hyperv.png?resize=300%2C255&amp;ssl=1 300w" sizes="auto, (max-width: 653px) 100vw, 653px" /></p>
<p>If the string matches, you are redirected to a function renamed here &#8220;func_VmDetectedGoodBye.</p>
<h4>How to By-Pass this Anti-VM technique?</h4>
<p>For avoiding this simple trick, the goal is to modify the REG_SZ value of &#8220;DriverDesc&#8221; into <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/system-defined-device-setup-classes-available-to-vendors">{4d36e968-e325-11ce-bfc1-08002be10318}</a> to something else.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="300" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/regedit_bypass-2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?fit=1102%2C463&amp;ssl=1" data-orig-size="1102,463" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="regedit_bypass" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?fit=300%2C126&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?fit=900%2C378&amp;ssl=1" class="alignnone size-full wp-image-300" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?resize=900%2C378&#038;ssl=1" alt="regedit_bypass" width="900" height="378" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?w=1102&amp;ssl=1 1102w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?resize=300%2C126&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?resize=1024%2C430&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/regedit_bypass.png?resize=1100%2C462&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>And voilà!</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="301" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/troll/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Troll.png?fit=956%2C335&amp;ssl=1" data-orig-size="956,335" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Troll" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Troll.png?fit=300%2C105&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Troll.png?fit=900%2C315&amp;ssl=1" class="alignnone size-full wp-image-301" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Troll.png?resize=900%2C315&#038;ssl=1" alt="Troll" width="900" height="315" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Troll.png?w=956&amp;ssl=1 956w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Troll.png?resize=300%2C105&amp;ssl=1 300w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h2>Stealing Part</h2>
<p>Let&#8217;s talk about the main subject&#8230; How this stealer is organized&#8230; As far I disassemble the code, this is all the folders that the malware is setting on the &#8220;ptst&#8221; repository before sending it as an archive on the C2.</p>
<ul>
<li>Folder
<ul>
<li><strong>Files</strong>: Contains all classical text/documents files at specifics paths</li>
<li><strong>FileZilla</strong>: Grab one or two files from this FTP</li>
<li><strong>WinFTP</strong>: Grab one file from this FTP</li>
<li><strong>Cookies</strong>: Saved stolen cookies from different browsers</li>
<li><strong>General</strong>: Generic Data</li>
<li><strong>Steam</strong>: Steal login account data</li>
<li><strong>Discord</strong>: Steal login account data</li>
</ul>
</li>
<li>Files
<ul>
<li>Information.log</li>
<li>Screenshot.jpeg &lt;= Screenshot of the current screen</li>
</ul>
</li>
</ul>
<h3>Telegram</h3>
<p>For checking if Telegram is installed on the machine, the malware is checking if the KeyPath &#8220;Software\Microsoft\Windows\CurrentVersion\Uninstall\{53F49750-6209-4FBF-9CA8-7A333C87D1ED}_is1&#8221; exists on the machine.</p>
<p>So let&#8217;s inspect what we have inside this &#8220;KeyPath&#8221;? After digging into the code, the stealer will request the value of &#8220;InstallLocation&#8221; because of this where Telegram is installed currently on the machine.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="312" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/install/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Install.png?fit=688%2C402&amp;ssl=1" data-orig-size="688,402" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Install" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Install.png?fit=300%2C175&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Install.png?fit=688%2C402&amp;ssl=1" class="alignnone size-full wp-image-312" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Install.png?resize=688%2C402&#038;ssl=1" alt="Install" width="688" height="402" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Install.png?w=688&amp;ssl=1 688w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Install.png?resize=300%2C175&amp;ssl=1 300w" sizes="auto, (max-width: 688px) 100vw, 688px" /></p>
<p>Step by step, the path is recreated (also always, all strings are xored) :</p>
<ul>
<li>%TELEGRAM_PATH%</li>
<li>\Telegram Desktop</li>
<li>\tdata</li>
<li>\D877F783D5D3EF8C</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="315" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/map-file/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/map-file.png?fit=630%2C663&amp;ssl=1" data-orig-size="630,663" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="map file" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/map-file.png?fit=285%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/map-file.png?fit=630%2C663&amp;ssl=1" class="alignnone  wp-image-315" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/map-file.png?resize=725%2C763&#038;ssl=1" alt="map file" width="725" height="763" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/map-file.png?w=630&amp;ssl=1 630w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/map-file.png?resize=285%2C300&amp;ssl=1 285w" sizes="auto, (max-width: 725px) 100vw, 725px" /></p>
<p>The folder &#8220;D877F783D5D3EF8C&#8221; is where all Telegram cache is stored. This is the sensitive data that the stealer wants to grab. Also during the process, the file map* (i.e: map1) is also checked and this file is, in fact, the encryption key. So if someone grabs everything for this folder, this leads the attacker to have an access (login without prompt) into the victim account.</p>
<h3>Steam</h3>
<p>The technique used by the stealer to get information for one software will remain the same for the next events (for most of the cases). This greatly facilitates the understanding of this malware.</p>
<p>So first, it&#8217;s checking the &#8220;SteamPath&#8221; key value at &#8220;HKCU\Software\Valve\Steam&#8221; to grab the correct Steam repository. This value is after concatenating with a bunch of files that are necessary to compromise a Steam Account.</p>
<div class="tiled-gallery type-rectangular tiled-gallery-unresized" data-original-width="900" data-carousel-extra='{&quot;blog_id&quot;:1,&quot;permalink&quot;:&quot;https:\/\/fumik0.com\/2018\/10\/15\/predator-the-thief-in-depth-analysis-v2-3-5\/&quot;,&quot;likes_blog_id&quot;:140610880}' itemscope itemtype="http://schema.org/ImageGallery" > <div class="gallery-row" style="width: 900px; height: 147px;" data-original-width="900" data-original-height="147" > <div class="gallery-group images-1" style="width: 495px; height: 147px;" data-original-width="495" data-original-height="147" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_1/" border="0" itemprop="url"> <meta itemprop="width" content="491"> <meta itemprop="height" content="143"> <img decoding="async" class="" data-attachment-id="316" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/XOR_1.png" data-orig-size="556,162" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_1" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_1.png?fit=300%2C87&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_1.png?fit=556%2C162&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_1.png?w=491&#038;h=143&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_1.png?w=556&amp;ssl=1 556w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_1.png?resize=300%2C87&amp;ssl=1 300w" width="491" height="143" loading="lazy" data-original-width="491" data-original-height="143" itemprop="http://schema.org/image" title="XOR_1" alt="XOR_1" style="width: 491px; height: 143px;" /> </a> </div> </div> <!-- close group --> <div class="gallery-group images-1" style="width: 405px; height: 147px;" data-original-width="405" data-original-height="147" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_2/" border="0" itemprop="url"> <meta itemprop="width" content="401"> <meta itemprop="height" content="143"> <img decoding="async" class="" data-attachment-id="317" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/XOR_2.png" data-orig-size="382,136" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_2" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_2.png?fit=300%2C107&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_2.png?fit=382%2C136&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_2.png?w=401&#038;h=143&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_2.png?w=382&amp;ssl=1 382w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_2.png?resize=300%2C107&amp;ssl=1 300w" width="401" height="143" loading="lazy" data-original-width="401" data-original-height="143" itemprop="http://schema.org/image" title="XOR_2" alt="XOR_2" style="width: 401px; height: 143px;" /> </a> </div> </div> <!-- close group --> </div> <!-- close row --> </div>
<p>So it will check first if ssfn files are present on the machine with the help of &#8220;func_FindFiles&#8221;, if it matches, they are duplicated into the temporary malware folder stored on %APPDATA%/XXXX. Then do the same things with config.vdf</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="318" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_3/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_3.png?fit=637%2C726&amp;ssl=1" data-orig-size="637,726" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_3" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_3.png?fit=263%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_3.png?fit=637%2C726&amp;ssl=1" class=" size-full wp-image-318 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_3.png?resize=637%2C726&#038;ssl=1" alt="XOR_3" width="637" height="726" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_3.png?w=637&amp;ssl=1 637w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_3.png?resize=263%2C300&amp;ssl=1 263w" sizes="auto, (max-width: 637px) 100vw, 637px" /></p>
<p>So what the point with these files? First, after some research, a post on Reddit was quite interesting. it explained that ssfn files permit to by-pass SteamGuard during the user log-on.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="311" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/steam/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Steam.png?fit=899%2C386&amp;ssl=1" data-orig-size="899,386" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Steam" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Steam.png?fit=300%2C129&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Steam.png?fit=899%2C386&amp;ssl=1" class="alignnone size-full wp-image-311" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Steam.png?resize=899%2C386&#038;ssl=1" alt="Steam" width="899" height="386" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Steam.png?w=899&amp;ssl=1 899w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Steam.png?resize=300%2C129&amp;ssl=1 300w" sizes="auto, (max-width: 899px) 100vw, 899px" /></p>
<p>Now what the point of the second file? this is where you could know some information about the user account and all the applications that are installed on the machine. Also, if the ConnectCache field is found on this one, it is possible to log into the stolen account without steam authentication prompt. if you are curious, this pattern is represented just like this :</p>
<pre>"ConnectCache"
{
       "STEAM_USERNAME_IN_CRC32_FORMAT" "SOME_HEX_STUFF"
}</pre>
<p>The last file, that the stealer wants to grab is &#8220;loginusers.vdf&#8221;. This one could be used for multiple purposes but mainly for setting the account in offline mode manually.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="319" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_4/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_4.png?fit=399%2C211&amp;ssl=1" data-orig-size="399,211" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_4" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_4.png?fit=300%2C159&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_4.png?fit=399%2C211&amp;ssl=1" class=" size-full wp-image-319 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_4.png?resize=399%2C211&#038;ssl=1" alt="XOR_4" width="399" height="211" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_4.png?w=399&amp;ssl=1 399w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_4.png?resize=300%2C159&amp;ssl=1 300w" sizes="auto, (max-width: 399px) 100vw, 399px" /></p>
<p>For more details on the subject there a nice report made by Kapersky for this:</p>
<ul>
<li><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07191212/Steam_Stealers_research_ENG.pdf">Steam Stealers</a></li>
</ul>
<h3>Wallets</h3>
<p>The stealer is supporting multiple digital wallets such as :</p>
<ul>
<li>Ethereum</li>
<li>Multibit</li>
<li>Electrum</li>
<li>Armory</li>
<li>Bytecoin</li>
<li>Bitcoin</li>
<li>Etc&#8230;</li>
</ul>
<p>The functionality is rudimentary but it&#8217;s enough to grab specific files such as :</p>
<ul>
<li>*.wallet</li>
<li>*.dat</li>
</ul>
<p>And as usual, all the strings are XORed.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="344" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/wallet/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Wallet.png?fit=595%2C232&amp;ssl=1" data-orig-size="595,232" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Wallet" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Wallet.png?fit=300%2C117&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Wallet.png?fit=595%2C232&amp;ssl=1" class=" size-full wp-image-344 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Wallet.png?resize=595%2C232&#038;ssl=1" alt="Wallet" width="595" height="232" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Wallet.png?w=595&amp;ssl=1 595w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Wallet.png?resize=300%2C117&amp;ssl=1 300w" sizes="auto, (max-width: 595px) 100vw, 595px" /></p>
<h3>FTP software</h3>
<p>The stealer supports two FTP software :</p>
<ul>
<li>Filezilla</li>
<li>WInFTP</li>
</ul>
<p>It&#8217;s really rudimentary because he only search for three files, and they are available a simple copy to the predator is done :</p>
<ul>
<li>%APPDATA%\Filezilla\sitemanager.xml</li>
<li>%APPDATA%\Filezilla\recentservers.xml</li>
<li>%PROGRAMFILES%\WinFtp Client\Favorites.dat</li>
</ul>
<div class="tiled-gallery type-rectangular tiled-gallery-unresized" data-original-width="900" data-carousel-extra='{&quot;blog_id&quot;:1,&quot;permalink&quot;:&quot;https:\/\/fumik0.com\/2018\/10\/15\/predator-the-thief-in-depth-analysis-v2-3-5\/&quot;,&quot;likes_blog_id&quot;:140610880}' itemscope itemtype="http://schema.org/ImageGallery" > <div class="gallery-row" style="width: 900px; height: 146px;" data-original-width="900" data-original-height="146" > <div class="gallery-group images-1" style="width: 502px; height: 146px;" data-original-width="502" data-original-height="146" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/filezilla/" border="0" itemprop="url"> <meta itemprop="width" content="498"> <meta itemprop="height" content="142"> <img decoding="async" class="" data-attachment-id="345" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/Filezilla.png" data-orig-size="517,147" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Filezilla" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Filezilla.png?fit=300%2C85&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Filezilla.png?fit=517%2C147&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Filezilla.png?w=498&#038;h=142&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Filezilla.png?w=517&amp;ssl=1 517w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Filezilla.png?resize=300%2C85&amp;ssl=1 300w" width="498" height="142" loading="lazy" data-original-width="498" data-original-height="142" itemprop="http://schema.org/image" title="Filezilla" alt="Filezilla" style="width: 498px; height: 142px;" /> </a> </div> </div> <!-- close group --> <div class="gallery-group images-1" style="width: 398px; height: 146px;" data-original-width="398" data-original-height="146" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/winftp/" border="0" itemprop="url"> <meta itemprop="width" content="394"> <meta itemprop="height" content="142"> <img decoding="async" class="" data-attachment-id="346" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/WinFTP.png" data-orig-size="520,187" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="WinFTP" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/WinFTP.png?fit=300%2C108&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/WinFTP.png?fit=520%2C187&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/WinFTP.png?w=394&#038;h=142&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/WinFTP.png?w=520&amp;ssl=1 520w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/WinFTP.png?resize=300%2C108&amp;ssl=1 300w" width="394" height="142" loading="lazy" data-original-width="394" data-original-height="142" itemprop="http://schema.org/image" title="WinFTP" alt="WinFTP" style="width: 394px; height: 142px;" /> </a> </div> </div> <!-- close group --> </div> <!-- close row --> </div>
<h3>Browsers</h3>
<p>It&#8217;s not necessary to have some deeper explanation about what kind of file the stealer will focus on browsers. There is currently a dozen articles that explain how this kind of malware manages to steal web data. I recommend you to read <a href="https://thisissecurity.stormshield.com/2018/08/28/acridrain-stealer/">this article</a> made by <a href="https://twitter.com/coldshell">@coldshell</a> about an example of overview and well detailed.</p>
<p>As usual, popular Chrome-based &amp; Firefox-based browsers and also Opera are mainly targeted by Predator.</p>
<p>This is the current official list supported by this stealer :</p>
<ul>
<li>Amigo</li>
<li>BlackHawk</li>
<li>Chromium</li>
<li>Comodo Dragon</li>
<li>Cyberfox</li>
<li>Epic Privacy Browser</li>
<li>Google Chrome</li>
<li>IceCat</li>
<li>K-Meleon</li>
<li>Kometa</li>
<li>Maxthon5</li>
<li>Mozilla Firefox</li>
<li>Nichrome</li>
<li>Opera</li>
<li>Orbitum</li>
<li>Pale Moon</li>
<li>Sputnik</li>
<li>Torch</li>
<li>Vivaldi</li>
<li>Waterfox</li>
<li>Etc&#8230;</li>
</ul>
<p>This one is also using SQLite for extracting data from browsers and using and saved them into a temporary file name &#8220;vlmi{lulz}yg.col&#8221;.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="370" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/sqlite/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/sqlite.png?fit=465%2C404&amp;ssl=1" data-orig-size="465,404" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="sqlite" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/sqlite.png?fit=300%2C261&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/sqlite.png?fit=465%2C404&amp;ssl=1" class=" size-full wp-image-370 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/sqlite.png?resize=465%2C404&#038;ssl=1" alt="sqlite" width="465" height="404" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/sqlite.png?w=465&amp;ssl=1 465w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/sqlite.png?resize=300%2C261&amp;ssl=1 300w" sizes="auto, (max-width: 465px) 100vw, 465px" /></p>
<p>So the task is simple :</p>
<ul>
<li>Stole SQL Browser file</li>
<li>Extract data with the help of SQLite and put into a temporary file</li>
<li>Then read and save it into a text file with a specific name (for each browser).</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="371" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/cookies/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/cookies.png?fit=596%2C132&amp;ssl=1" data-orig-size="596,132" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cookies" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/cookies.png?fit=300%2C66&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/cookies.png?fit=596%2C132&amp;ssl=1" class=" size-full wp-image-371 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/cookies.png?resize=596%2C132&#038;ssl=1" alt="cookies" width="596" height="132" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/cookies.png?w=596&amp;ssl=1 596w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/cookies.png?resize=300%2C66&amp;ssl=1 300w" sizes="auto, (max-width: 596px) 100vw, 596px" /></p>
<p>When forms data or credentials are found they&#8217;re saved into two files on the General repository :</p>
<ul>
<li>forms.log</li>
<li>password.log</li>
<li>cards.log</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="372" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/general/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/General.png?fit=594%2C127&amp;ssl=1" data-orig-size="594,127" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="General" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/General.png?fit=300%2C64&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/General.png?fit=594%2C127&amp;ssl=1" class=" size-full wp-image-372 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/General.png?resize=594%2C127&#038;ssl=1" alt="General" width="594" height="127" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/General.png?w=594&amp;ssl=1 594w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/General.png?resize=300%2C64&amp;ssl=1 300w" sizes="auto, (max-width: 594px) 100vw, 594px" /></p>
<h3>Discord</h3>
<p>If discord is detected on the machine, the stealer will search and copy the &#8220;https_discordapp_*localstorage&#8221; file into the &#8220;ptst&#8221; folder. This file contains all sensitive information about the account and could permit some authentication without a prompt login if this one is pushed into the correct directory of the attacker machine.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="341" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/discord_part1/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part1.png?fit=489%2C109&amp;ssl=1" data-orig-size="489,109" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Discord_Part1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part1.png?fit=300%2C67&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part1.png?fit=489%2C109&amp;ssl=1" class="alignnone size-full wp-image-341" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part1.png?resize=489%2C109&#038;ssl=1" alt="Discord_Part1" width="489" height="109" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part1.png?w=489&amp;ssl=1 489w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part1.png?resize=300%2C67&amp;ssl=1 300w" sizes="auto, (max-width: 489px) 100vw, 489px" /><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="342" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/discord_part2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part2.png?fit=569%2C128&amp;ssl=1" data-orig-size="569,128" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Discord_Part2" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part2.png?fit=300%2C67&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part2.png?fit=569%2C128&amp;ssl=1" class="alignnone size-full wp-image-342" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part2.png?resize=569%2C128&#038;ssl=1" alt="Discord_Part2" width="569" height="128" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part2.png?w=569&amp;ssl=1 569w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part2.png?resize=300%2C67&amp;ssl=1 300w" sizes="auto, (max-width: 569px) 100vw, 569px" /><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="343" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/discord_part3/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part3.png?fit=395%2C129&amp;ssl=1" data-orig-size="395,129" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Discord_Part3" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part3.png?fit=300%2C98&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part3.png?fit=395%2C129&amp;ssl=1" class="alignnone size-full wp-image-343" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part3.png?resize=395%2C129&#038;ssl=1" alt="Discord_Part3" width="395" height="129" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part3.png?w=395&amp;ssl=1 395w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Discord_Part3.png?resize=300%2C98&amp;ssl=1 300w" sizes="auto, (max-width: 395px) 100vw, 395px" /></p>
<h3>Predator is inspecting multiple places&#8230;</h3>
<p>This stealer is stealing data from 3 strategical folders :</p>
<ul>
<li>Desktop</li>
<li>Downloads</li>
<li>Documents</li>
</ul>
<p>Each time, the task will be the same, it will search 4 type of files with the help of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa">GetFileAttributesA</a> :</p>
<ul>
<li>*.doc</li>
<li>*.docx</li>
<li>*.txt</li>
<li>*.log</li>
</ul>

		<style type="text/css">
			#gallery-4 {
				margin: auto;
			}
			#gallery-4 .gallery-item {
				float: left;
				margin-top: 10px;
				text-align: center;
				width: 50%;
			}
			#gallery-4 img {
				border: 2px solid #cfcfcf;
			}
			#gallery-4 .gallery-caption {
				margin-left: 0;
			}
			/* see gallery_shortcode() in wp-includes/media.php */
		</style>
		<div data-carousel-extra='{"blog_id":1,"permalink":"https:\/\/fumik0.com\/2018\/10\/15\/predator-the-thief-in-depth-analysis-v2-3-5\/"}' id='gallery-4' class='gallery galleryid-282 gallery-columns-2 gallery-size-full'><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/doc/'><img loading="lazy" decoding="async" width="346" height="101" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/doc.png?fit=346%2C101&amp;ssl=1" class="attachment-full size-full" alt="" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/doc.png?w=346&amp;ssl=1 346w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/doc.png?resize=300%2C88&amp;ssl=1 300w" sizes="auto, (max-width: 346px) 100vw, 346px" data-attachment-id="355" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/doc/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/doc.png?fit=346%2C101&amp;ssl=1" data-orig-size="346,101" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="doc" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/doc.png?fit=300%2C88&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/doc.png?fit=346%2C101&amp;ssl=1" /></a>
			</dt></dl><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/docx/'><img loading="lazy" decoding="async" width="397" height="96" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/docx.png?fit=397%2C96&amp;ssl=1" class="attachment-full size-full" alt="" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/docx.png?w=397&amp;ssl=1 397w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/docx.png?resize=300%2C73&amp;ssl=1 300w" sizes="auto, (max-width: 397px) 100vw, 397px" data-attachment-id="356" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/docx/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/docx.png?fit=397%2C96&amp;ssl=1" data-orig-size="397,96" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="docx" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/docx.png?fit=300%2C73&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/docx.png?fit=397%2C96&amp;ssl=1" /></a>
			</dt></dl><br style="clear: both" /><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/log/'><img loading="lazy" decoding="async" width="326" height="104" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/log.png?fit=326%2C104&amp;ssl=1" class="attachment-full size-full" alt="" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/log.png?w=326&amp;ssl=1 326w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/log.png?resize=300%2C96&amp;ssl=1 300w" sizes="auto, (max-width: 326px) 100vw, 326px" data-attachment-id="357" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/log/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/log.png?fit=326%2C104&amp;ssl=1" data-orig-size="326,104" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="log" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/log.png?fit=300%2C96&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/log.png?fit=326%2C104&amp;ssl=1" /></a>
			</dt></dl><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/txt/'><img loading="lazy" decoding="async" width="335" height="105" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/txt.png?fit=335%2C105&amp;ssl=1" class="attachment-full size-full" alt="" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/txt.png?w=335&amp;ssl=1 335w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/txt.png?resize=300%2C94&amp;ssl=1 300w" sizes="auto, (max-width: 335px) 100vw, 335px" data-attachment-id="358" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/txt/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/txt.png?fit=335%2C105&amp;ssl=1" data-orig-size="335,105" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="txt" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/txt.png?fit=300%2C94&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/txt.png?fit=335%2C105&amp;ssl=1" /></a>
			</dt></dl><br style="clear: both" />
		</div>

<p>When it matches, they have copied into a folder named &#8220;Files&#8221;.</p>
<h3>Information.log</h3>
<p>When tasks are done, the malware starts generating a summarize file, who contains some specific and sensitive data from the machine victim beside the file &#8220;Information.log&#8221;. For DFIR, this file is the artifact to identify the name of the malware because it contains the name and the specific version.</p>
<p>So first, it writes the Username of the user that has executed the payload, the computer name, and the OS Version.</p>
<pre>User name: lolilol
Machine name: Computer 
OS version: Windoge 10</pre>
<p>Then copy the content of the clipboard with the help of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-getclipboarddata">GetClipBoardData</a></p>
<pre>Current clipboard: 
-------------- 
Omelette du fromage</pre>
<p>Let&#8217;s continue the process&#8230;</p>
<pre>Startup folder: C:\Users\lolilol\AppData\Local\Temp\predator.exe</pre>
<p>Some classic specification about the machine is requested and saved into the file.</p>
<pre>CPU info: Some bad CPU | Amount of kernels: 128 (Current CPU usage: 46.112917%) 
GPU info: Fumik0_ graphical display 
Amount of RAM: 12 GB (Current RAM usage: 240 MB) 
Screen resolution: 1900x1005</pre>
<p>Then, all the user accounts are indicated</p>
<pre>Computer users: 
lolilol 
Administrator 
All Users 
Default 
Default User 
Public</pre>
<p>The last part is about some exotics information that is quite awkward in fact&#8230; Firstly, for some reasons that I don&#8217;t want to understand, there is the compile time hardcoded on the payload.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="361" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/compile-time/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Compile-Time.png?fit=591%2C532&amp;ssl=1" data-orig-size="591,532" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Compile Time" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Compile-Time.png?fit=300%2C270&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Compile-Time.png?fit=591%2C532&amp;ssl=1" class=" size-full wp-image-361 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Compile-Time.png?resize=591%2C532&#038;ssl=1" alt="Compile Time" width="591" height="532" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Compile-Time.png?w=591&amp;ssl=1 591w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Compile-Time.png?resize=300%2C270&amp;ssl=1 300w" sizes="auto, (max-width: 591px) 100vw, 591px" /></p>
<p>Then the second exotic data saved into <em><strong>Information.log</strong></em> is the grabbing execution time for stealing contents from the machine&#8230; This information could be useful for debugging some tweaks with the features.</p>
<pre>Additional information:
Compile time: Aug 31 2018
Grabbing time: 0.359375 second(s)</pre>
<h3>C2 Communications</h3>
<p>For finishing the information.log, a GET request is made for getting some network data about the victim&#8230;</p>
<p>First, it set up the request by uncovered some Data like :</p>
<ul>
<li>A user-agent</li>
<li>The content-type</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="365" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/ua/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/UA.png?fit=780%2C286&amp;ssl=1" data-orig-size="780,286" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="UA" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/UA.png?fit=300%2C110&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/UA.png?fit=780%2C286&amp;ssl=1" class="alignnone size-full wp-image-365" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/UA.png?resize=780%2C286&#038;ssl=1" alt="UA" width="780" height="286" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/UA.png?w=780&amp;ssl=1 780w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/UA.png?resize=300%2C110&amp;ssl=1 300w" sizes="auto, (max-width: 780px) 100vw, 780px" /></p>
<ul>
<li>The API URL ( /api/info.get )</li>
</ul>
<p>We can have for example this result :</p>
<pre>Amsterdam;Netherlands;52.3702;4.89517;51.15.43.205;Europe/Amsterdam;1012;</pre>
<p>When the request is done, the data is consolidated step by step with the help of different loops and conditions.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="366" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/get01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?fit=1634%2C416&amp;ssl=1" data-orig-size="1634,416" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="GET01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?fit=300%2C76&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?fit=900%2C229&amp;ssl=1" class="alignnone size-full wp-image-366" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?resize=900%2C229&#038;ssl=1" alt="GET01" width="900" height="229" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?w=1634&amp;ssl=1 1634w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?resize=300%2C76&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?resize=1024%2C261&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/GET01.png?resize=1100%2C280&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>When the task is done, there are saved into Information.log</p>
<pre>City: Nopeland 
Country:  NopeCountry
Coordinates: XX.XXXX N, X.XXXX W 
IP: XXX.XXX.XXX.XXX 
Timezone: Nowhere 
Zip code: XXXXX</pre>
<p>The Archive is not complete, it only needs for the stealer to send it to the C2.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="354" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/zpar-zip/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/zpar.zip-164722963-1539373463821.png?fit=446%2C190&amp;ssl=1" data-orig-size="446,190" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="zpar.zip" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/zpar.zip-164722963-1539373463821.png?fit=300%2C128&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/zpar.zip-164722963-1539373463821.png?fit=446%2C190&amp;ssl=1" class="aligncenter size-full wp-image-354" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/zpar.zip-164722963-1539373463821.png?resize=446%2C190&#038;ssl=1" alt="zpar.zip" width="446" height="190" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/zpar.zip-164722963-1539373463821.png?w=446&amp;ssl=1 446w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/zpar.zip-164722963-1539373463821.png?resize=300%2C128&amp;ssl=1 300w" sizes="auto, (max-width: 446px) 100vw, 446px" /></p>
<p>So now it set up some pieces of information into the gate.get request with specifics arguments, from p1 to p7, for example :</p>
<ul>
<li>p1: Number of accounts stolen</li>
<li>p2: Number of cookies stolen</li>
<li>p4: Number of forms stolen</li>
<li>etc&#8230;</li>
</ul>
<p>results :</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="367" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/request-2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Request.png?fit=937%2C127&amp;ssl=1" data-orig-size="937,127" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Request" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Request.png?fit=300%2C41&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Request.png?fit=900%2C122&amp;ssl=1" class="alignnone size-full wp-image-367" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Request.png?resize=900%2C122&#038;ssl=1" alt="Request" width="900" height="122" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Request.png?w=937&amp;ssl=1 937w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Request.png?resize=300%2C41&amp;ssl=1 300w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>The POST request is now complete, the stealer will clean everything and quit.</p>
<div id="attachment_373" style="width: 840px" class="wp-caption alignnone"><img data-recalc-dims="1" loading="lazy" decoding="async" aria-describedby="caption-attachment-373" data-attachment-id="373" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/panel_c2_example/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Panel_C2_Example.png?fit=830%2C589&amp;ssl=1" data-orig-size="830,589" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Panel_C2_Example" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Panel_C2_Example.png?fit=300%2C213&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Panel_C2_Example.png?fit=830%2C589&amp;ssl=1" class="alignnone size-full wp-image-373" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Panel_C2_Example.png?resize=830%2C589&#038;ssl=1" alt="Panel_C2_Example" width="830" height="589" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Panel_C2_Example.png?w=830&amp;ssl=1 830w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Panel_C2_Example.png?resize=300%2C213&amp;ssl=1 300w" sizes="auto, (max-width: 830px) 100vw, 830px" /><p id="caption-attachment-373" class="wp-caption-text">Example of Predator C2 Panel with fancy background&#8230;</p></div>
<h2>Update &#8211; v2.3.7</h2>
<p>So during the analysis,  new versions were pushed&#8230; Currently (at the time where this post was redacted), the v3 has been released, but without possession of this specific version, I won&#8217;t talk anything about it and will me be focus only on the 2.3.7.</p>
<p>It&#8217;s useless to review from scratch, the mechanic of this stealer is still the same, just some tweak or other arrangements was done for multiple purposes&#8230; Without digging too much into it, let&#8217;s see some changes (not all) that I found interesting.</p>
<div id="attachment_377" style="width: 1291px" class="wp-caption alignnone"><img data-recalc-dims="1" loading="lazy" decoding="async" aria-describedby="caption-attachment-377" data-attachment-id="377" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/changelog/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?fit=1281%2C544&amp;ssl=1" data-orig-size="1281,544" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="changelog" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?fit=300%2C127&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?fit=900%2C382&amp;ssl=1" class="alignnone size-full wp-image-377" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?resize=900%2C382&#038;ssl=1" alt="changelog" width="900" height="382" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?w=1281&amp;ssl=1 1281w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?resize=300%2C127&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?resize=1024%2C435&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/changelog.png?resize=1100%2C467&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /><p id="caption-attachment-377" class="wp-caption-text">Changelog of v2.3.7 explained by the author</p></div>
<p>As usual, this is the same patterns :</p>
<ul>
<li>Code optimizations (Faster / Lightweight)</li>
<li>More features&#8230;</li>
</ul>
<p>As you can see v2.3.7 on the right is much longer than v2.3.5 (left), but the backbone is still the same.</p>
<div class="tiled-gallery type-rectangular tiled-gallery-unresized" data-original-width="900" data-carousel-extra='{&quot;blog_id&quot;:1,&quot;permalink&quot;:&quot;https:\/\/fumik0.com\/2018\/10\/15\/predator-the-thief-in-depth-analysis-v2-3-5\/&quot;,&quot;likes_blog_id&quot;:140610880}' itemscope itemtype="http://schema.org/ImageGallery" > <div class="gallery-row" style="width: 900px; height: 1254px;" data-original-width="900" data-original-height="1254" > <div class="gallery-group images-1" style="width: 476px; height: 1254px;" data-original-width="476" data-original-height="1254" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/old/" border="0" itemprop="url"> <meta itemprop="width" content="472"> <meta itemprop="height" content="1250"> <img decoding="async" class="" data-attachment-id="351" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/old.png" data-orig-size="228,604" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="old" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/old.png?fit=113%2C300&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/old.png?fit=228%2C604&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/old.png?w=472&#038;h=1250&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/old.png?w=228&amp;ssl=1 228w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/old.png?resize=113%2C300&amp;ssl=1 113w" width="472" height="1250" loading="lazy" data-original-width="472" data-original-height="1250" itemprop="http://schema.org/image" title="old" alt="old" style="width: 472px; height: 1250px;" /> </a> </div> </div> <!-- close group --> <div class="gallery-group images-1" style="width: 424px; height: 1254px;" data-original-width="424" data-original-height="1254" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/new/" border="0" itemprop="url"> <meta itemprop="width" content="420"> <meta itemprop="height" content="1250"> <img decoding="async" class="" data-attachment-id="350" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/new.png" data-orig-size="202,601" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="new" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/new.png?fit=101%2C300&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/new.png?fit=202%2C601&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/new.png?w=420&#038;h=1250&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/new.png?w=202&amp;ssl=1 202w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/new.png?resize=101%2C300&amp;ssl=1 101w" width="420" height="1250" loading="lazy" data-original-width="420" data-original-height="1250" itemprop="http://schema.org/image" title="new" alt="new" style="width: 420px; height: 1250px;" /> </a> </div> </div> <!-- close group --> </div> <!-- close row --> </div>
<h3>Mutex</h3>
<p>On 2.3.7,  A mutex is integrated with a specific string called &#8220;SyystemServs&#8221;</p>
<div class="tiled-gallery type-rectangular tiled-gallery-unresized" data-original-width="900" data-carousel-extra='{&quot;blog_id&quot;:1,&quot;permalink&quot;:&quot;https:\/\/fumik0.com\/2018\/10\/15\/predator-the-thief-in-depth-analysis-v2-3-5\/&quot;,&quot;likes_blog_id&quot;:140610880}' itemscope itemtype="http://schema.org/ImageGallery" > <div class="gallery-row" style="width: 900px; height: 158px;" data-original-width="900" data-original-height="158" > <div class="gallery-group images-1" style="width: 535px; height: 158px;" data-original-width="535" data-original-height="158" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/mutexcreation-2/" border="0" itemprop="url"> <meta itemprop="width" content="531"> <meta itemprop="height" content="154"> <img decoding="async" class="" data-attachment-id="368" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/MutexCreation-1.png" data-orig-size="428,124" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="MutexCreation" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexCreation-1.png?fit=300%2C87&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexCreation-1.png?fit=428%2C124&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexCreation-1.png?w=531&#038;h=154&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexCreation-1.png?w=428&amp;ssl=1 428w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexCreation-1.png?resize=300%2C87&amp;ssl=1 300w" width="531" height="154" loading="lazy" data-original-width="531" data-original-height="154" itemprop="http://schema.org/image" title="MutexCreation" alt="MutexCreation" style="width: 531px; height: 154px;" /> </a> </div> </div> <!-- close group --> <div class="gallery-group images-1" style="width: 365px; height: 158px;" data-original-width="365" data-original-height="158" > <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"> <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/mutexname-2/" border="0" itemprop="url"> <meta itemprop="width" content="361"> <meta itemprop="height" content="154"> <img decoding="async" class="" data-attachment-id="369" data-orig-file="https://fumik0.com/wp-content/uploads/2018/10/MutexName-1.png" data-orig-size="404,172" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="MutexName" data-image-description="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexName-1.png?fit=300%2C128&#038;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexName-1.png?fit=404%2C172&#038;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexName-1.png?w=361&#038;h=154&#038;ssl=1" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexName-1.png?w=404&amp;ssl=1 404w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/MutexName-1.png?resize=300%2C128&amp;ssl=1 300w" width="361" height="154" loading="lazy" data-original-width="361" data-original-height="154" itemprop="http://schema.org/image" title="MutexName" alt="MutexName" style="width: 361px; height: 154px;" /> </a> </div> </div> <!-- close group --> </div> <!-- close row --> </div>
<h3>Xor / Obfuscated Strings</h3>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="349" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/xor_v2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_v2.png?fit=162%2C632&amp;ssl=1" data-orig-size="162,632" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XOR_v2" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_v2.png?fit=77%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_v2.png?fit=162%2C632&amp;ssl=1" class=" size-full wp-image-349 alignleft" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_v2.png?resize=162%2C632&#038;ssl=1" alt="XOR_v2" width="162" height="632" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_v2.png?w=162&amp;ssl=1 162w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/XOR_v2.png?resize=77%2C300&amp;ssl=1 77w" sizes="auto, (max-width: 162px) 100vw, 162px" /></p>
<p>During the C2 requests, URL arguments are generated byte per byte and unXOR.</p>
<p>For example :</p>
<pre><strong><span style="color: #000080;">push</span> <span style="color: #ff6600;">04</span></strong>
...
<span style="color: #000080;"><strong>push</strong></span> <span style="color: #ff6600;"><strong>61</strong></span>
...
<strong><span style="color: #000080;">push</span></strong> <span style="color: #ff6600;"><strong>70</strong></span>
...</pre>
<pre><em>leads to this</em> <strong>
HEX</strong>    : 046170692F676174652E6765743F70313D
<strong>STRING</strong> : .api/gate.get?p1=</pre>
<p>This is basic and simple but enough to just slow down the review of the strings. but at least, it&#8217;s really easy to uncover it, so it doesn&#8217;t matter.</p>
<p>This tweak by far is why the code is much longer than v2.3.5.</p>
<h2></h2>
<h3>Loader</h3>
<p>Not seen before (as far I saw), it seems on 2.3.7, it integrates a loader feature to push another payload on the victim machine, easily recognizable with the adequate GET Request</p>
<pre>/api/download.get</pre>
<p>The API request permits to the malware to get an URL into text format. Then Download and saved it into disk and execute it with the help of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/nf-shellapi-shellexecutea">ShellExecuteA</a></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="362" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/loader/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?fit=1131%2C648&amp;ssl=1" data-orig-size="1131,648" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Loader" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?fit=300%2C172&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?fit=900%2C516&amp;ssl=1" class="alignnone size-full wp-image-362" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?resize=900%2C516&#038;ssl=1" alt="Loader" width="900" height="516" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?w=1131&amp;ssl=1 1131w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?resize=300%2C172&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?resize=1024%2C587&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Loader.png?resize=1100%2C630&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>There also some other tweaks, but it&#8217;s unnecessary to detail on this review, I let you this task by yourself if you are curious 🙂</p>
<h2>IoC</h2>
<p>v2.3.5</p>
<ul>
<li>299f83d5a35f17aa97d40db667a52dcc | Sample Packed</li>
<li>3cb386716d7b90b4dca1610afbd5b146 | Sample Unpacked</li>
<li>kent-adam.myjino.ru | C2 Domain</li>
</ul>
<p>v2.3.7</p>
<ul>
<li> cbcc48fe0fa0fd30cb4c088fae582118 | Sample Unpacked</li>
<li> denbaliberdin.myjino.ru | C2 Domain</li>
</ul>
<h2>HTTP Patterns</h2>
<ul>
<li>GET    &#8211;   /api/info.get</li>
<li>POST  &#8211;  /api//gate.get?p1=X&amp;p2=X&amp;p3=X&amp;p4=X&amp;p5=X&amp;p6=X&amp;p7=X</li>
<li>GET    &#8211;  /api/download.get</li>
</ul>
<h2>MITRE ATT&amp;CK</h2>
<h3>v2.3.5</h3>
<ul>
<li>Discovery &#8211; Peripheral Device Discovery</li>
<li>Discovery &#8211; System Information Discovery</li>
<li>Discovery &#8211; System Time Discovery</li>
<li>Discovery &#8211; Query Registry</li>
<li>Credential Access &#8211; Credentials in Files</li>
<li>Exfiltration &#8211; Data Compressed</li>
</ul>
<h3>v2.3.7</h3>
<ul>
<li>Discovery &#8211; Peripheral Device Discovery</li>
<li>Discovery &#8211; System Information Discovery</li>
<li>Discovery &#8211; System Time Discovery</li>
<li>Discovery &#8211; Query Registry</li>
<li>Credential Access &#8211; Credentials in Files</li>
<li>Exfiltration &#8211; Data Compressed</li>
<li><strong>Execution &#8211;  Execution through API</strong></li>
</ul>
<h2>Author / Threat Actor</h2>
<ul>
<li>
<div class="message-userDetails-top">
<h4 class="message-name">Alexuiop1337</h4>
</div>
</li>
</ul>
<h2>Yara Rule</h2>
<pre>rule Predator_The_Thief : Predator_The_Thief {
    meta:
        description = "Yara rule for Predator The Thief v2.3.5 &amp; +"
        author = "Fumik0_"
        date = "2018/10/12"
        update = "2018/12/19"

    strings:
        $mz = { 4D 5A }

        // V2
        $hex1 = { BF 00 00 40 06 } 
        $hex2 = { C6 04 31 6B }
        $hex3 = { C6 04 31 63 }
        $hex4 = { C6 04 31 75 }
        $hex5 = { C6 04 31 66 }
 
        $s1 = "sqlite_" ascii wide
 
        // V3
        $x1 = { C6 84 24 ?? ?? 00 00 8C } 
        $x2 = { C6 84 24 ?? ?? 00 00 1A }  
        $x3 = { C6 84 24 ?? ?? 00 00 D4 } 
        $x4 = { C6 84 24 ?? ?? 00 00 03 }  
        $x5 = { C6 84 24 ?? ?? 00 00 B4 } 
        $x6 = { C6 84 24 ?? ?? 00 00 80 }
 
    condition:
        $mz at 0 and 
        ( ( all of ($hex*) and all of ($s*) ) or (all of ($x*)))
}</pre>
<p>&nbsp;</p>
<h2>Recommendations</h2>
<ul>
<li style="text-align: justify;">Always running stuff inside a VM, be sure to install a lot of stuff linked to the hypervisor (like Guest Addons tools)  to trigger as much as possible all kind of possible Anti-VM detection and closing malware. When you have done with your activities stop the VM and restore it a Specific clean snapshot when it&#8217;s done.</li>
<li>Avoid storing files at a pre-destined path (Desktop, Documents, Downloads), put at a place that is not common.</li>
<li style="text-align: justify;">Avoiding Cracks and other stupid fake hacks, stealers are usually behind the current game trendings (especially in those times with Fortnite&#8230;).</li>
<li>Use containers for software that you are using, this will reduce the risk of stealing data.</li>
<li>Flush your browser after each visit, never saved your passwords directly on your browser or using auto-fill features.</li>
<li>Don&#8217;t use the same password for all your websites (use 2FA and it&#8217;s possible), we are in 2018, and this still sadly everywhere like this.</li>
<li>Make some noise with your data, that will permit to lose some attacker minds to find some accurate values into the junk information.</li>
<li>Use a Vault Password software.</li>
<li style="text-align: justify;"><strong>Troll/Not Troll:</strong> Learn Russian and put your keyboard in Cyrillic 🙂</li>
</ul>
<h2>Conclusion</h2>
<p>Stealers are not sophisticated malware, but they are enough effective to make some irreversible damage for victims. Email accounts and other credentials are more and more impactful and this <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/what-do-hackers-do-with-your-stolen-identity">will be worse with the years</a>. Behaviors must changes for the account management to limit this kind of scenario. Awareness and good practices are the keys and this will not be a simple security software solution that will solve everything.</p>
<p>Well for me I&#8217;ve enough work, it&#8217;s time to sleep a little&#8230;</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="305" data-permalink="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/himouto-habits/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?fit=1280%2C720&amp;ssl=1" data-orig-size="1280,720" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Himouto Habits" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?fit=300%2C169&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?fit=900%2C506&amp;ssl=1" class="  wp-image-305 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?resize=665%2C374&#038;ssl=1" alt="Himouto Habits" width="665" height="374" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?w=1280&amp;ssl=1 1280w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?resize=300%2C169&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?resize=1024%2C576&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/10/Himouto-Habits.jpg?resize=1100%2C619&amp;ssl=1 1100w" sizes="auto, (max-width: 665px) 100vw, 665px" /></p>
<p>#HappyHunting</p>
<p>Update 2018-10-23 : Yara Rules now working also for v3</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-282" class="share-twitter sd-button share-icon" href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-282" class="share-facebook sd-button share-icon" href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-140610880-282-67625520da065' data-src='https://widgets.wp.com/likes/?ver=14.2-a.3#blog_id=140610880&amp;post_id=282&amp;origin=fumik0.com&amp;obj_id=140610880-282-67625520da065&amp;n=1' data-name='like-post-frame-140610880-282-67625520da065' data-title='Like or Reblog'><h3 class="sd-title">Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
															</div>

						</article>

						<section class="modified-date" itemprop="dateModified" content="2019-03-14T10:09:16+00:00">
							Last modified: March 14, 2019						</section>

						<section class="tags">
							<a href="https://fumik0.com/tag/predator/" rel="tag">predator</a><a href="https://fumik0.com/tag/reverse/" rel="tag">reverse</a><a href="https://fumik0.com/tag/stealer/" rel="tag">stealer</a>						</section>

																<h3 class="section-title">Author</h3>
			<aside class="author-card" itemscope itemprop="author" itemtype="http://schema.org/Person">
				<div class="author-avatar">
					<img src="https://secure.gravatar.com/avatar/60460a1a0d00b32720a59ee2624bb4aa?s=96&#038;d=identicon&#038;r=g" class="rounded-circle" itemprop="image">
				</div>
				<div class="author-info">
					<div class="author-title">
						<a href="https://fumik0.com/author/fumko/" itemprop="name">
							fumko						</a>
					</div>
					<div class="author-description" itemprop="description">  
											</div>
				</div>
			</aside>
								
													
<div id="comments" class="discussion-wrapper">
	<h3 class="section-title">Comments</h3>
	<div class="discussion-timeline">
					
				<div class="comment even thread-even depth-1 comment-wrapper" id="comment-5">
					<div class="comment-avatar">
						<img alt='' src='https://secure.gravatar.com/avatar/3a5bd7c0cd790b32703b45e3234c3f8a?s=44&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/3a5bd7c0cd790b32703b45e3234c3f8a?s=88&#038;d=identicon&#038;r=g 2x' class='avatar avatar-44 photo' height='44' width='44' loading='lazy' decoding='async'/>					</div>
					<div class="comment-container"> 
						<div class="comment-header">
														<div class="comment-header-btn reply">
								<a rel="nofollow" class="comment-reply-link" href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/?replytocom=5#respond" data-commentid="5" data-postid="282" data-belowelement="comment-5" data-respondelement="respond" data-replyto="Reply to truong" aria-label="Reply to truong"><i class="fas fa-reply"></i></a>							</div>

							
							<div class="comment-header-text f-14">
								<cite class="reader">truong</cite>&nbsp;<a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/#comment-5" title="commented October 17, 2018 @ 4:50 pm" class="comment-link"><time itemprop="datePublished" datetime="2018-10-17T16:50:09+00:00">commented 6 years ago</time></a>							</div>
						</div>
						<div class="comment-body">
														<div class="comment-content comment">
								<p>this is so incredible work, keep going bro</p>
<div class='jetpack-comment-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-comment-wrapper-140610880-5-67625520e9102' data-src='https://widgets.wp.com/likes/#blog_id=140610880&amp;comment_id=5&amp;origin=fumik0.com&amp;obj_id=140610880-5-67625520e9102' data-name='like-comment-frame-140610880-5-67625520e9102'>
<div class='likes-widget-placeholder comment-likes-widget-placeholder comment-likes'><span class='loading'>Loading...</span></div>
<div class='comment-likes-widget jetpack-likes-widget comment-likes'><span class='comment-like-feedback'></span><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
</div>
	
							</div>
						</div>
					</div>
				</div>

				</li><!-- #comment-## -->

				<div class="comment odd alt thread-odd thread-alt depth-1 comment-wrapper" id="comment-18">
					<div class="comment-avatar">
						<img alt='' src='https://secure.gravatar.com/avatar/d85a8cd46f068f36bb89a4fcc89737e0?s=44&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d85a8cd46f068f36bb89a4fcc89737e0?s=88&#038;d=identicon&#038;r=g 2x' class='avatar avatar-44 photo' height='44' width='44' loading='lazy' decoding='async'/>					</div>
					<div class="comment-container"> 
						<div class="comment-header">
														<div class="comment-header-btn reply">
								<a rel="nofollow" class="comment-reply-link" href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/?replytocom=18#respond" data-commentid="18" data-postid="282" data-belowelement="comment-18" data-respondelement="respond" data-replyto="Reply to MaxPayne" aria-label="Reply to MaxPayne"><i class="fas fa-reply"></i></a>							</div>

							
							<div class="comment-header-text f-14">
								<cite class="reader">MaxPayne</cite>&nbsp;<a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/#comment-18" title="commented January 5, 2019 @ 10:54 am" class="comment-link"><time itemprop="datePublished" datetime="2019-01-05T10:54:20+00:00">commented 6 years ago</time></a>							</div>
						</div>
						<div class="comment-body">
														<div class="comment-content comment">
								<p>Great analysis. Thanks.</p>
<div class='jetpack-comment-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-comment-wrapper-140610880-18-67625520e9adf' data-src='https://widgets.wp.com/likes/#blog_id=140610880&amp;comment_id=18&amp;origin=fumik0.com&amp;obj_id=140610880-18-67625520e9adf' data-name='like-comment-frame-140610880-18-67625520e9adf'>
<div class='likes-widget-placeholder comment-likes-widget-placeholder comment-likes'><span class='loading'>Loading...</span></div>
<div class='comment-likes-widget jetpack-likes-widget comment-likes'><span class='comment-like-feedback'></span><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
</div>
	
							</div>
						</div>
					</div>
				</div>

				</li><!-- #comment-## -->
								
		<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply<small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/#respond" style="display:none;">Cancel reply</a></small></h3>			<form id="commentform" class="comment-form">
				<iframe
					title="Comment Form"
					src="https://jetpack.wordpress.com/jetpack-comment/?blogid=140610880&#038;postid=282&#038;comment_registration=0&#038;require_name_email=1&#038;stc_enabled=1&#038;stb_enabled=1&#038;show_avatars=1&#038;avatar_default=identicon&#038;greeting=Leave+a+Reply&#038;jetpack_comments_nonce=baa8493ca3&#038;greeting_reply=Leave+a+Reply+to+%25s&#038;color_scheme=light&#038;lang=en_US&#038;jetpack_version=14.2-a.3&#038;iframe_unique_id=1&#038;show_cookie_consent=10&#038;has_cookie_consent=0&#038;is_current_user_subscribed=0&#038;token_key=%3Bnormal%3B&#038;sig=a69ca8fe8f25eb7f5ca938c71642137b85e3503a#parent=https%3A%2F%2Ffumik0.com%2F2018%2F10%2F15%2Fpredator-the-thief-in-depth-analysis-v2-3-5%2F"
											name="jetpack_remote_comment"
						style="width:100%; height: 430px; border:0;"
										class="jetpack_remote_comment"
					id="jetpack_remote_comment"
					sandbox="allow-same-origin allow-top-navigation allow-scripts allow-forms allow-popups"
				>
									</iframe>
									<!--[if !IE]><!-->
					<script>
						document.addEventListener('DOMContentLoaded', function () {
							var commentForms = document.getElementsByClassName('jetpack_remote_comment');
							for (var i = 0; i < commentForms.length; i++) {
								commentForms[i].allowTransparency = false;
								commentForms[i].scrolling = 'no';
							}
						});
					</script>
					<!--<![endif]-->
							</form>
		</div>

		
		<input type="hidden" name="comment_parent" id="comment_parent" value="" />

			</div>
</div>

												
					
							</main>

							<aside id="aside-container" class="col-lg-4 col-md-4 col-sm-12" role="complementary">
					
	<div id="sidebar" class="sidebar">
		<section id="categories-3" class="widget widget_categories"><h2 class="widget-title">Categories</h2>
			<ul>
					<li class="cat-item cat-item-602944907"><a href="https://fumik0.com/category/botnet/">botnet</a> (2)
</li>
	<li class="cat-item cat-item-602944904"><a href="https://fumik0.com/category/projects/">Projects</a> (1)
</li>
	<li class="cat-item cat-item-602944906"><a href="https://fumik0.com/category/reverse/">Reverse</a> (7)
</li>
	<li class="cat-item cat-item-1"><a href="https://fumik0.com/category/uncategorized/">Uncategorized</a> (3)
</li>
			</ul>

			</section><section id="archives-3" class="widget widget_archive"><h2 class="widget-title">Archives</h2>
			<ul>
					<li><a href='https://fumik0.com/2021/06/'>June 2021</a></li>
	<li><a href='https://fumik0.com/2021/04/'>April 2021</a></li>
	<li><a href='https://fumik0.com/2019/12/'>December 2019</a></li>
	<li><a href='https://fumik0.com/2019/08/'>August 2019</a></li>
	<li><a href='https://fumik0.com/2019/05/'>May 2019</a></li>
	<li><a href='https://fumik0.com/2019/03/'>March 2019</a></li>
	<li><a href='https://fumik0.com/2019/02/'>February 2019</a></li>
	<li><a href='https://fumik0.com/2018/12/'>December 2018</a></li>
	<li><a href='https://fumik0.com/2018/10/'>October 2018</a></li>
	<li><a href='https://fumik0.com/2018/05/'>May 2018</a></li>
	<li><a href='https://fumik0.com/2018/01/'>January 2018</a></li>
			</ul>

			</section>	</div>

	<div id="sidebar-sticky" class="sidebar sticky-top">
		<nav id="toc" class="toc" role="navigation"></nav>
	</div>
				</aside>
			
		</div><!-- .row -->
		
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://fumik0.com/2018/05/21/some-fun-with-a-miner/" rel="prev"><i class="fas fa-angle-left"></i> <span class="screen-reader-text">Previous Post</span> Some fun with a miner</a></div><div class="nav-next"><a href="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/" rel="next"><i class="fas fa-angle-right"></i> <span class="screen-reader-text">Next Post</span> Let&#8217;s dig into Vidar &#8211; An Arkei Copycat/Forked Stealer (In-depth analysis)</a></div></div>
	</nav>	</div><!-- .container -->
</div><!-- .data-schema -->


			<footer class="footer" role="contentinfo">
								<section class="footer-sidebar">
					<div class="container px-responsive">
						<div class="row my-4">
							<section id="rss_links-5" class="widget widget_rss_links col-lg col-md-4 col-sm-12"><p><a target="_self" href="https://fumik0.com/feed/" title="Subscribe to posts"><img src="https://fumik0.com/wp-content/plugins/jetpack/images/rss/orange-small.png" alt="RSS feed" /></a></p>
</section>						</div>
					</div>
				</section>
				
				<div class="container footer-columns">
					<div class="footer-column-left">
						<div>Copyright &copy; 2024 <strong><a href="https://fumik0.com">Fumik0_&#039;s box</a></strong>. All rights reserved. Theme by <a href="https://terryl.in/" target="_blank">Mynote</a>. </div>
						<div></div>
					</div>
					<div class="footer-column-right">
						<nav class="footer-nav"><ul id="menu-social-media" class="social-icon-links"><li id="menu-item-273"><a href="http://tracker.fumik0.com"><i class="fas fa-link"></i></a></li>
<li id="menu-item-13"><a target="_blank" href="https://twitter.com/fumik0_"><span class="brand-sm"><i class="fab fa-twitter twitter brand-link"></i></span></a></li>
<li id="menu-item-424"><a href="https://github.com/Fmk0"><span class="brand-sm"><i class="fab fa-github-alt github brand-link"></i></span></a></li>
<li id="menu-item-426"><a href="https://www.youtube.com/channel/UClEmTjO2nLjbwGht-OckQhA"><span class="brand-sm"><i class="fab fa-youtube youtube brand-link"></i></span></a></li>
</ul></nav>					</div>
				</div>

			</footer>
		</div><!-- .wrapper -->
			<script>

	jQuery( document ).ready(function( $ ) {
		const win = $( window );
		const doc = $( document );
		const progressBar = $( 'progress' );
		const progressLabel = $( '.progress-label' );
		const setValue = () => win.scrollTop();
		const setMax = () => doc.height() - win.height();
		const setPercent = () => Math.round( win.scrollTop() / (doc.height() - win.height()) * 100 );
		const pageTitle = $( '#post-title' );
		const pageTitleTop = pageTitle.offset().top;
		const progressBarContainer = $( '.single-post-title-bar' );
		const headerNavBrand = $( '.header .navbar-brand' );
		const progressTitle = $( '#progress-title' );
		const headerBarContainer = $( '.header .container' );

		progressLabel.text( setPercent() + '%' );
		progressBar.attr(
			{
				value: setValue(),
				max: setMax() 
			}
		);

		doc.on( 'scroll', () => {
			progressLabel.text( setPercent() + '%' );
			progressBar.attr(
				{
					value: setValue()
				} 
			);

			if ( doc.scrollTop() > headerNavBrand.height() ) {
				//headerBarContainer.fadeOut( 800 );
				progressTitle.html( pageTitle.html() );
				progressBarContainer.find( '.navbar-brand' ).html( headerNavBrand.html() );
				progressBarContainer.fadeIn( 100 );
				progressBarContainer.addClass( 'fixed-top' );
				progressBarContainer.addClass( 'slide-down' );
			} else {
				//headerBarContainer.fadeIn( 800 );
				progressBarContainer.removeClass( 'slide-down' );
				progressBarContainer.fadeOut( 100 );

				if ( progressBarContainer.hasClass( 'fixed-top' ) ) {
					setTimeout(function() {
						progressBarContainer.removeClass( 'fixed-top' );
					}, 500);
				}
			}
		});

		win.on( 'resize', () => {
			progressLabel.text( setPercent() + '%' );
			progressBar.attr(
				{
					value: setValue(), 
					max: setMax()
				} 
			);
		});

		// Sidebar switcher
		$( '#main-container' ).attr( 'data-previous-class', $( '#main-container' ).attr( 'class' ) );

		$( '.column-control .btn-counter' ).click(function() {
			var target = $( this ).attr( 'data-target' );
			if ( $( this ).hasClass( 'active' ) ) {
				$( this ).removeClass( 'active' );

				if ( target == '#aside-container' ) {
					$( '#main-container' ).attr( 'data-previous-class', $( '#main-container' ).attr( 'class' ) );
					$( '#main-container' ).attr( 'class', 'col col-sm-12' );
					$( '#aside-container' ).hide();
				}
				if ( target == '#sidebar') {
					$( target ).show();
				}
			} else {
				$( this ).addClass( 'active' );

				if ( target == '#aside-container' ) {
					$( '#main-container' ).attr( 'class', $( '#main-container' ).attr( 'data-previous-class' ) );
					$( '#aside-container' ).show();
				}
				if ( target == '#sidebar') {
					$( target ).hide();
				}
			}

		});

		// For responsive.
		$( '.markdown-body img' ).attr('height', '');
	});

	</script>
	<script>

	jQuery( document ).ready(function( $ ) {

		$( '.scroll-area a' ).on( 'click', function(e) {
			e.preventDefault();
			var movingPosition = 0;

			if ( $( this.hash ).offset().top > $( document ).height() - $( window ).height() ) {
				movingPosition = $( document ).height() - $( window ).height();
			} else {
				movingPosition = $( this.hash ).offset().top;
			}

			$( 'html, body' ).animate({
				scrollTop: movingPosition
			}, 500, 'swing' );
		});

		$( 'a.go-top' ).on( 'click' ,function(e) {
			e.preventDefault();
			$( 'html, body' ).animate( { scrollTop: 0 }, 1000 );
		});

		$( window ).scroll( function() {      
			var windowTop =  $( window ).scrollTop();
			if ( windowTop > 100 ) {
				$( 'a.go-top' ).fadeIn( 300 );
			} else {
				$( 'a.go-top' ).fadeOut( 300 );
			}
		});

		$( '#mynote-nav-bar' ).on( 'show.bs.collapse' , function () {
			$( 'body' ).addClass( 'menu-is-collapsed' );
			$( '.main-header' ).css( { 'top': '-60px' } ).animate( { 'top': '0px' }, 500 );
			$( '.has-site-logo .search-bar' ).fadeOut( 500 );
		});

		$( '#mynote-nav-bar' ).on( 'hidden.bs.collapse' , function () {
			$( '.main-header' ).css( { 'top': '0px' } ).animate( { 'top': '-60px' }, 500 );
			$( '.has-site-logo .search-bar' ).fadeIn( 500 );
			setTimeout(function() {
				$( 'body' ).removeClass( 'menu-is-collapsed' );
			}, 500);
			
		});
	});

	</script>
	<!--  -->
<script defer id="bilmur" data-customproperties="{&quot;woo_active&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="atomic"  src="https://s0.wp.com/wp-content/js/bilmur.min.js?m=202451"></script>
					<div class="jetpack-subscription-modal">
						<div class="jetpack-subscription-modal__modal-content">
								
	<div class="wp-block-group has-border-color jetpack-subscription-modal__modal-content-form" style="border-color:#dddddd;border-width:1px;margin-top:0;margin-bottom:0;padding:32px"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">

		
		<h2 class="wp-block-heading has-text-align-center" style="margin-top:4px;margin-bottom:10px;font-size:26px;font-style:normal;font-weight:600">Discover more from Fumik0_&#039;s box</h2>
		

		
		<p class='has-text-align-center' style='margin-top:4px;margin-bottom:0px;font-size:15px'>Subscribe now to keep reading and get access to the full archive.</p>
		

			<div class="wp-block-jetpack-subscriptions__supports-newline is-style-compact wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="140610880"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 50px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="140610880"/>
							<input type="hidden" name="source" value="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value="atomic-subscription-modal-lo"/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="c43f937e1f" /><input type="hidden" name="_wp_http_referer" value="/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/" /><input type="hidden" name="post_id" value="282"/>							<button type="submit"
																	class="wp-block-button__link"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 50px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	

		
		<p class="has-text-align-center jetpack-subscription-modal__close" style="margin-top:20px;font-size:14px"><a href="#">Continue reading</a></p>
		
	</div></div>
							</div>
					</div>
				<div style="display:none">
			<div class="grofile-hash-map-3a5bd7c0cd790b32703b45e3234c3f8a">
		</div>
		<div class="grofile-hash-map-d85a8cd46f068f36bb89a4fcc89737e0">
		</div>
		</div>
				<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/fumik0.com\/2018\/10\/15\/predator-the-thief-in-depth-analysis-v2-3-5\/":282};
	</script>
				<link rel='stylesheet' id='jetpack-carousel-swiper-css-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/carousel/swiper-bundle.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-carousel-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='tiled-gallery-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/tiled-gallery/tiled-gallery/tiled-gallery.css?ver=2023-08-21' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-block-subscriptions-css' href='https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.css?minify=false&#038;ver=14.2-a.3' type='text/css' media='all' />
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/comment-reply.min.js" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="text/javascript" id="subscription-modal-js-js-extra">
/* <![CDATA[ */
var subscriptionData = {"homeUrl":"fumik0.com"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/modules/comments/subscription-modal-on-comment/subscription-modal.js?ver=14.2-a.3" id="subscription-modal-js-js"></script>
<script type="text/javascript" src="https://secure.gravatar.com/js/gprofiles.js?ver=202451" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=14.2-a.3" id="wpgroho-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/likes/queuehandler.min.js?ver=14.2-a.3" id="jetpack_likes_queuehandler-js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/clipboard.min.js" id="clipboard-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/highlighting-code-block/assets/js/prism.js?ver=1.2.9" id="hcb-prism-js"></script>
<script type="text/javascript" id="hcb-script-js-extra">
/* <![CDATA[ */
var hcbVars = {"showCopy":"on"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/highlighting-code-block/build/js/hcb_script.js?ver=1.2.9" id="hcb-script-js"></script>
<script type="text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"140610880\",\"post\":\"282\",\"tz\":\"0\",\"srv\":\"fumik0.com\",\"hp\":\"atomic\",\"ac\":\"2\",\"amp\":\"0\",\"j\":\"1:14.2-a.3\"}") ]);
_stq.push([ "clickTrackerInit", "140610880", "282" ]);
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/fumik0.com\/wp-content\/plugins\/jetpack\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/fumik0.com\/wp-admin\/admin-ajax.php","nonce":"acafc58171","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/fumik0.com\/wp-login.php?redirect_to=https%3A%2F%2Ffumik0.com%2F2018%2F10%2F15%2Fpredator-the-thief-in-depth-analysis-v2-3-5%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"]};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=14.2-a.3" id="jetpack-carousel-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/tiled-gallery/tiled-gallery/tiled-gallery.min.js?ver=14.2-a.3" id="tiled-gallery-js" defer="defer" data-wp-strategy="defer"></script>
<script defer type="text/javascript" src="https://fumik0.com/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1704837122" id="akismet-frontend-js"></script>
<script type="text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.2-a.3" id="jetpack-block-subscriptions-js"></script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=14.2-a.3" id="sharing-js-js"></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=20241218#ver=20241218&#038;n=1' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1"><div class="likes-text"><span>%d</span></div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
			<script type="text/javascript">
			(function () {
				const iframe = document.getElementById( 'jetpack_remote_comment' );
								const watchReply = function() {
					// Check addComment._Jetpack_moveForm to make sure we don't monkey-patch twice.
					if ( 'undefined' !== typeof addComment && ! addComment._Jetpack_moveForm ) {
						// Cache the Core function.
						addComment._Jetpack_moveForm = addComment.moveForm;
						const commentParent = document.getElementById( 'comment_parent' );
						const cancel = document.getElementById( 'cancel-comment-reply-link' );

						function tellFrameNewParent ( commentParentValue ) {
							const url = new URL( iframe.src );
							if ( commentParentValue ) {
								url.searchParams.set( 'replytocom', commentParentValue )
							} else {
								url.searchParams.delete( 'replytocom' );
							}
							if( iframe.src !== url.href ) {
								iframe.src = url.href;
							}
						};

						cancel.addEventListener( 'click', function () {
							tellFrameNewParent( false );
						} );

						addComment.moveForm = function ( _, parentId ) {
							tellFrameNewParent( parentId );
							return addComment._Jetpack_moveForm.apply( null, arguments );
						};
					}
				}
				document.addEventListener( 'DOMContentLoaded', watchReply );
				// In WP 6.4+, the script is loaded asynchronously, so we need to wait for it to load before we monkey-patch the functions it introduces.
				document.querySelector('#comment-reply-js')?.addEventListener( 'load', watchReply );

								
				const commentIframes = document.getElementsByClassName('jetpack_remote_comment');

				window.addEventListener('message', function(event) {
					if (event.origin !== 'https://jetpack.wordpress.com') {
						return;
					}

					if (!event?.data?.iframeUniqueId && !event?.data?.height) {
						return;
					}

					const eventDataUniqueId = event.data.iframeUniqueId;

					// Change height for the matching comment iframe
					for (let i = 0; i < commentIframes.length; i++) {
						const iframe = commentIframes[i];
						const url = new URL(iframe.src);
						const iframeUniqueIdParam = url.searchParams.get('iframe_unique_id');
						if (iframeUniqueIdParam == event.data.iframeUniqueId) {
							iframe.style.height = event.data.height + 'px';
							return;
						}
					}
				});
			})();
		</script>
		
		<a href="javascript:void(0);" class="go-top" style="display: none">
			<i class="fas fa-arrow-up"></i>
		</a>
	</body>
</html>
