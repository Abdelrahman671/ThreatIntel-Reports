<!DOCTYPE html>
<html lang="en" data-wf-page="612ee7c7ee4b4400abbacdf1" data-wf-site="612ee7c7ee4b44e7d5bacdf0">
<head>
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="High-end cybersecurity services"/>
    <meta name="language" content="en"/>
    <meta name="locale" content="en_US"/>
    <meta name="HandheldFriendly" content="True"/>
    <link rel="alternate home" type="application/rss+xml" href="https://skylightcyber.com/feed-v1.xml" title="Skylight Cyber Security Blog" />

    <meta name="twitter:site" content="@SkylightCyber" />
    <meta name="twitter:title" content="Skylight Cyber | Unleash The Hash" />
    <meta name="twitter:description" content="Get the [almost] full list of MAC addresses that were targeted in the ASUS breach, and share our pain in the short story of extracting them."/>
    <meta name="twitter:creator" content="@SkylightCyber" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/featured.jpg" />

    <meta property="og:url" content="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/">
    <meta property="og:title" content="Skylight Cyber | Unleash The Hash" />
    <meta property="og:description" content="Get the [almost] full list of MAC addresses that were targeted in the ASUS breach, and share our pain in the short story of extracting them." />
    <meta property="og:image" itemprop="image" content="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/featured-thumbnail.jpg" />
    <meta property="og:image:secure_url" itemprop="image" content="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/featured-thumbnail.jpg" />
    <meta property="og:type" content="article" />

    <link rel="canonical" href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/" />
    <link rel="icon" type="image/png" href="https://skylightcyber.com/favicon.ico"/>
    <link rel="shortcut icon" type="image/x-icon" href="https://skylightcyber.com/favicon.ico"/>
    <link href="https://skylightcyber.com/images/webclip.png" rel="apple-touch-icon">
    <title>Skylight Cyber | Unleash The Hash</title>

    <script>
        window.dataLayer = window.dataLayer || [];
    </script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-58K39C6');</script>
    <!-- End Google Tag Manager -->

    <style>
        .text-area {
            resize: vertical;
        }
        body {
            padding: 0px !important;
        }
        .pointer-events-none {
            pointer-events: none;
        }
    </style>
    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/skylight-cyber.css">
    <link rel="stylesheet" href="/css/skylight.css">
    
        <link rel="stylesheet" href="/css/simple-lightbox.min.css">
    
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">WebFont.load({  google: {    families: ["Manrope:regular,500,700"]  }});</script>
    <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->

    <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
	<script type='text/javascript'>
	  window.smartlook||(function(d) {
		var o=smartlook=function(){ o.api.push(arguments)},h=d.getElementsByTagName('head')[0];
		var c=d.createElement('script');o.api=new Array();c.async=true;c.type='text/javascript';
		c.charset='utf-8';c.src='https://web-sdk.smartlook.com/recorder.js';h.appendChild(c);
		})(document);
		smartlook('init', 'b531e44a7efedb7621da8482c570a19981444246', { region: 'eu' });
	</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://googletagmanager.com">
    <link rel="preconnect" href="https://www.google-analytics.com">
    <link rel="preconnect" href="https://px.ads.linkedin.com">
    <link rel="preconnect" href="https://connect.facebook.com">
    <link rel="preconnect" href="https://sjs.bizographics.com">
    <link rel="preconnect" href="https://www.facebook.com">
<meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
<body class="body">
    <div id="page-wrapper" class="page-wrapper">
        <!-- Scrollbar-line -->
        <div id="line-wrap" class="line-wrap">
    <div data-w-id="b7e39220-4c60-b9ff-2be6-a0b3218b5493" class="line line-2 gradient-bg"></div>
</div>
        <!-- END Scrollbar-line -->
        <!-- NAVBAR -->
        <div data-w-id="439ae697-a223-5305-164f-1eb38ba92182" class="nav-trigger"></div>
<div id="nav-wrapper" class="nav-wrapper">
    <div data-animation="default" class="nav w-nav" data-scroll-target="#nav-wrapper" data-collapse="medium" data-w-id="9a24535b-5f6f-0e8b-c322-f4cca7ff3176" role="banner" data-duration="400" id="nav" data-direction="down">
        <div id="nav-background" class="nav-background"></div>
        <div class="page-embed w-embed">
            <style>
                .pointer-events-none {
                    pointer-events: none;
                }
                .outline {
                    color: inherit;
                }
                .w-nav-overlay {
                    top: 0;
                }
                .overline-big, span {
                    display: block;
                }
                @media screen and (min-width: 992px) {
                    .text-link:hover {
                        background: -webkit-linear-gradient(20deg, #ff6635 0%, #ef1d43 100%);
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                    }
                }
                .gradient-text {
                    background: -webkit-linear-gradient(20deg, #FF7463 5.66%, #D53181 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                }
                .nav-link.w-nav-link.w--current+.gradient-line {
                    display: block!important;
                }
                .midnight-gradient {
                    background: -webkit-linear-gradient(140deg, #8e93fb 0%, #4f55c9 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                }
            </style>
        </div>
        <div class="container nav-container w-container">
            <div class="nav-wrap">
                <a href="/" aria-current="page" class="nav-logo w-nav-brand w--current"><img src="/images/logo.svg" loading="lazy" alt="" class="logo-image"></a>
                <nav role="navigation" class="nav-links w-nav-menu">
                    <div class="mob-links-wrap">
                        <div class="link-container desktop-hide">
                            <a href="/" data-w-id="9a24535b-5f6f-0e8b-c322-f4cca7ff3182" aria-current="page" class="nav-link w-nav-link w--current">Home</a>
                            <div class="gradient-line absolute"></div>
                            <div class="gradient-hover-line"></div>
                        </div>
                        
                            <div class="link-container">
                                <a href="/about-us/" title="About" class="nav-link w-nav-link">About</a>
                                <div class="gradient-line absolute"></div>
                                <div class="gradient-hover-line"></div>
                            </div>
                        
                            <div class="link-container">
                                <a href="/services/" title="Services" class="nav-link w-nav-link">Services</a>
                                <div class="gradient-line absolute"></div>
                                <div class="gradient-hover-line"></div>
                            </div>
                        
                            <div class="link-container">
                                <a href="/blog/" title="Blog" class="nav-link w-nav-link">Blog</a>
                                <div class="gradient-line absolute"></div>
                                <div class="gradient-hover-line"></div>
                            </div>
                        
                            <div class="link-container">
                                <a href="/careers/" title="Careers" class="nav-link w-nav-link">Careers</a>
                                <div class="gradient-line absolute"></div>
                                <div class="gradient-hover-line"></div>
                            </div>
                        
                            <div class="link-container">
                                <a href="/contact-us/" title="Contact Us" class="nav-link w-nav-link">Contact Us</a>
                                <div class="gradient-line absolute"></div>
                                <div class="gradient-hover-line"></div>
                            </div>
                        
                    </div>
                </nav>
                <div class="menu-button w-nav-button">
                    <div class="close-wrap">
                        <div class="close-div _1"></div>
                        <div class="close-div _2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        <!-- END NAVBAR -->
        <!-- BODY -->
        
<section class="section wf-section">
    <div class="container-996 hero-section left-50">
        <div class="article-hero-wrap">
            <h1 class="title-1 bold-text gradient-text article-title">Unleash The Hash</h1>
            <div class="article-information">
                <div class="overline-big right-32">28 March 2019</div>
                <div class="time-wrap"><img src="/images/clock-eight.svg" loading="lazy" alt="clock-image" class="clock-image">
                    <div id="result" class="overline-big right-12">20</div>
                    <div id="result" class="overline-big"> minute read</div>
                </div>
            </div>
            
            <div class="share-buttons-wrap">
                <div class="_w-inline-block w-embed">
                    <a class="w-inline-block social-share-btn1 lnk" href="#" target="_blank" title=" Share on LinkedIn" onclick=" window.open('http://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(document.URL) + '&title=' + encodeURIComponent(document.title)); return false;"></a>
                    <a class="w-inline-block social-share-btn1 tw" href="#" target="_blank" title=" Tweet" onclick=" window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(document.title) + ':%20 ' + encodeURIComponent(document.URL)); return false;"></a>
                    <a class="w-inline-block social-share-btn1 fb" href="#" title=" Share on Facebook" target="_blank" onclick=" window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(document.URL) + '&t=' + encodeURIComponent(document.URL)); return false;"></a>
                </div>
                <div class="_w-inline-block hide">
                    <a href="#" class="social-share-btn1 tw w-inline-block"></a>
                    <a href="#" class="social-share-btn1 lnk w-inline-block"></a>
                    <a href="#" class="social-share-btn1 fb w-inline-block"></a>
                </div>
            </div>
        </div>
        <div id="richtextfield" class="rich-text w-richtext"><p>TL;DR: The latest list of plain-text MAC addresses targeted in the ShadowHammer ASUS breach can be <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/list.txt" target="_blank" download>downloaded here</a>.<br>You can find the extended list containing more complete information <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/extended_list.txt" target="_blank" download>here</a>.<br>Last Updated: 30/Mar/2019</p>
<hr>
<p>You have probably heard of the <a target="_blank" rel="noopener" href="https://securelist.com/operation-shadowhammer/89992/">ShadowHammer</a> hack by now.<br>A truly disturbing case that shows yet again, that nothing can be 100% trusted, not even a formally signed update from a well known vendor.<br>According to available information, the threat actors have infected computers en-masse, but have targeted specific machines based on their MAC address.</p>
<p>The question of who did this and why is intriguing, but not one we were trying to answer in this case.<br>First thing’s first - if information regarding targets exists, it should be made publicly available to the security community so we can better protect ourselves.<br>Kaspersky have released an <a target="_blank" rel="noopener" href="https://shadowhammer.kaspersky.com/">online tool</a> that allows you to check your MAC address against a DB of victim MAC addresses (which is hidden).<br>Good on Kaspersky on one hand, but on the other hand, this is highly inefficient, and does not really serve the security community.</p>
<p>So, we thought it would be a good idea to extract the list and make it public so that every security practitioner would be able to bulk compare them to known machines in their domain.<br>If you are interested in the list it can be <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/list.txt" target="_blank" download>downloaded here</a> or <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/extended_list.txt" target="_blank" download>here</a> for the extended list.</p>
<p>If you are interested in learning how we extracted it, read on, it was a short yet sweet ride, kind of like the CTFs we love so much, and thank you Kaspersky for the challenge!</p>
<h2 id="Phase-I-getting-the-bulk-list-in-binary-format"><a href="#Phase-I-getting-the-bulk-list-in-binary-format" class="headerlink" title="Phase I - getting the bulk list in binary format"></a>Phase I - getting the bulk list in binary format</h2><p>In conjunction with the website, Kaspersky have released an executable that checks if your machine has been targeted. Naturally, since it is an offline tool, it means that the full list of MAC addresses has to be contained within that executable.<br>So, up goes IDA and we go hunting for the MAC list.</p>
<p>Before even taking a look at the disassembled code, we can hypothesize how such a tool might work: </p>
<ul>
<li>Extract local MAC addresses</li>
<li>Calculate hashes for those addresses</li>
<li>Compare the local list with addresses that are embedded in the executable</li>
</ul>
<p>A quick look at the disassembly shows that the entire logic of the program was written inside WinMain() (classic security researcher coding style…).<br>Sure enough, the program follows the expected steps.</p>
<p>We can see that the first thing the tool does is extract the local MAC addresses and hash them. </p>
<p>Following that, we can immediately recognize two sets of nested loops, and further analysis reveals that there are actually two different lists the tool compares the hashes of the local MAC addresses to.<br>Finding the two lists is straightforward, and the total weight of the hashes is 19936 bytes.</p>
<h2 id="Phase-II-what-the-hash"><a href="#Phase-II-what-the-hash" class="headerlink" title="Phase II - what the hash?!"></a>Phase II - what the hash?!</h2><p>So now that we have the list, and knowing that the threat actors used MD5 hashes, we have to brute force these MD5s, which should be pretty straightforward.<br>However, something doesn’t seem right from the get go. </p>
<p>MD5 hashes are 16 bytes (128 bit) long, but dividing the list of hashes by 16 yields 1246, which doesn’t make sense as we know from publications that there should be around 600 addresses.<br>Moreover, the hash comparison loops seems to work in 32 bytes increments, suggesting a different hashing algorithm than MD5.<br>We need to dig deeper…</p>
<p>Looking at the hashing routine, we find this:<br><figure>
                    <div class="hr"></div><br>
                    
                    <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/sha256-disassembly.png"><img src="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/sha256-disassembly.png" alt="hashing routine constants" title="hashing routine constants" data-toggle="lightbox" data-remote="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/sha256-disassembly.png" data-footer="hashing routine constants"></a>
                    <figcaption>hashing routine constants</figcaption>
                    
                    <div class="hr"></div>
                </figure></p>
<p>For people involved with cryptography, these constants are an instant tell-tale sign of SHA2-256. SHA256’s hash size is 32 bytes long, matching the comparison routine.  </p>
<p>We don’t consider disassembling crypto code as a fun afternoon activity, and so we’ve opted to try the short path first. Let’s hash one of the few known target MAC addresses with SHA2-256 and see if we get a hit. Nothing in life is easy, especially not crypto, so of course, the approach failed, and we did not get a hit.</p>
<p>Little did we know that these are not vanilla SHA256 hashes at all. </p>
<h2 id="Phase-III-Who-are-you-Mr-hash"><a href="#Phase-III-Who-are-you-Mr-hash" class="headerlink" title="Phase III - Who are you Mr. hash?"></a>Phase III - Who are you Mr. hash?</h2><p>Reluctantly, we had to dig deeper into the hashing routine.<br>Following a reference implementation of SHA256 and the disassembly, we’ve noticed that the code calls SHA256_Transform (the inner function that performs transformations on the inner algorithm state) with a constant that seems to be four bytes long.<br><figure>
                    <div class="hr"></div><br>
                    
                    <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/sha256-salt.png"><img src="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/sha256-salt.png" alt="Disassembly of hashing routine" title="Disassembly of hashing routine" data-toggle="lightbox" data-remote="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/sha256-salt.png" data-footer="Disassembly of hashing routine"></a>
                    <figcaption>Disassembly of hashing routine</figcaption>
                    
                    <div class="hr"></div>
                </figure> </p>
<p>Well, “That must be it!”, they’ve salted the hash, we figured. But why would they do that? Are they trying to hide those MAC addresses?</p>
<p>Anyway, we’ve tried the blackbox approach using known target MAC address hashed with the discovered salt (0xad, 0x12, 0xf4, 0x19) to see if we get a match, but it failed again.</p>
<p>Dynamically analyzing calls to the SHA256_Transform function demonstrated that the hash is actually calculated on repeated sequences of the salt + MAC address.<br><figure>
                    <div class="hr"></div><br>
                    
                    <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/dynamic-analysis.png"><img src="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/dynamic-analysis.png" alt="salt (0xad,0x12,0xf4,0x19) followed by 70:8B:CD:10:43:18" title="salt (0xad,0x12,0xf4,0x19) followed by 70:8B:CD:10:43:18" data-toggle="lightbox" data-remote="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/dynamic-analysis.png" data-footer="salt (0xad,0x12,0xf4,0x19) followed by 70:8B:CD:10:43:18"></a>
                    <figcaption>salt (0xad,0x12,0xf4,0x19) followed by 70:8B:CD:10:43:18</figcaption>
                    
                    <div class="hr"></div>
                </figure></p>
<p>Revisiting the disassembled code, we can spot a constant (10,000) being used to break a loop. Could they be running the hashing algorithm 10,000 times with the salt?<br>Let’s have a go with the following code and test it:<br><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$salt</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"\xad\x12\xf4\x19"</span><span class="token punctuation">;</span> 
<span class="token variable">$mac</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"\x70\x8b\xcd\x10\x43\x18"</span><span class="token punctuation">;</span> <span class="token comment">// 70:8B:CD:10:43:18 (one of the few MD5s that were published and we brute-forced)</span>

<span class="token variable">$ctx</span> <span class="token operator">=</span> <span class="token function">hash_init</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sha256"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token function">hash_update</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$salt</span></span><span class="token interpolation"><span class="token variable">$mac</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">print</span> <span class="token function">hash_final</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<p>Which yields <em>“cde5d9a781e56f37351be146a4389a975a9838f0fe13710f3501202e8ca2fb7a”</em>. This hash is part of the list of hashes embedded in Kaspersky’s executable. Yes! This is definitive proof!<br>Now that we have the hashing algorithm we can start brute-forcing.  </p>
<h2 id="Phase-IV-We’re-going-to-need-a-bigger-cat"><a href="#Phase-IV-We’re-going-to-need-a-bigger-cat" class="headerlink" title="Phase IV - We’re going to need a bigger cat"></a>Phase IV - We’re going to need a bigger cat</h2><p>You can write your own code to brute-force hashes, but there is a lot of know-how involved in making the most use out of your Hardware.<br>For us, <a target="_blank" rel="noopener" href="https://hashcat.net/hashcat/">Hashcat</a> was an obvious choice, given that it’s an open-source and flexible tool.<br>We tried stretching Hashcat’s features to their fullest, but couldn’t find a way to use the algorithm we saw in Kaspersky’s code ( If you know of a method, please share in the comments).</p>
<p>After a sigh that was heard throughout the continent, we set about to modify Hashcat to support the new scheme. Trying to compile &amp; build most open-source cross-platform projects on Windows is a pain and Hashcat is no different, so we’ve switched to our Linux box.</p>
<p>Actually, it was surprisingly easy to enhance Hashcat and all we had to do is add two lines of code inside the OpenCL implementation of SHA2-256 (Hashcat algorithm #01400), as follows:</p>
<figure>
                    <div class="hr"></div><br>
                    
                    <a href="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/hashcat-code-modifications.png"><img src="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/hashcat-code-modifications.png" alt="Hashcat code modification" title="Hashcat code modification" data-toggle="lightbox" data-remote="https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/hashcat-code-modifications.png" data-footer="Hashcat code modification"></a>
                    <figcaption>Hashcat code modification</figcaption>
                    
                    <div class="hr"></div>
                </figure>
<p>And with that we were good to go.</p>
<h2 id="Phase-V-She’s-not-gonna-hold-Captain"><a href="#Phase-V-She’s-not-gonna-hold-Captain" class="headerlink" title="Phase V - She’s not gonna hold, Captain!"></a>Phase V - She’s not gonna hold, Captain!</h2><p>Trying to brute-force the entire space of MAC addresses, hashed using SHA256 on the repeated salt+MAC is not feasible in a reasonable amount of time and resources.<br>Therefore, we had to reduce the address space.</p>
<p>A MAC address is comprised of the prefix (3 bytes) and a suffix (3 bytes). Prefixes are allocated to vendors.<br>We used a couple of different strategies to limit the prefixes we were targeting: </p>
<ul>
<li>Limit to only known, assigned MAC address prefixes.</li>
<li>Reduce further by following information released by other security vendors: 360 Threat Intelligence Center tweeted a nice <a target="_blank" rel="noopener" href="https://twitter.com/360TIC/status/1110797967621914625">infographic</a> detailing the distribution of vendors of targeted MAC addresses. We could use that list to limit the prefixes we were brute-forcing.</li>
<li>Limit to prefixes assigned to AsusTek.</li>
</ul>
<p>Even with all of those strategies in place, brute forcing a single prefix was going to take us ~3 hours on our modest hardware. With a narrowed down list of around 1300 prefixes, that meant 162.5 days, a tad bit more than we would have liked. </p>
<h2 id="Phase-VI-victory"><a href="#Phase-VI-victory" class="headerlink" title="Phase VI - victory"></a>Phase VI - victory</h2><p>With that in mind, we realized that to do brute-forcing you need a brute!</p>
<p>Enter Amazon’s  AWS p3.16xlarge instance.<br>These beasts carry eight (you read correctly) of NVIDIA’s V100 Tesla 16GB GPUs.<br>As Al Pacino once said - “Say hello to my little friend!” :)<br>The entire set of 1300 prefixes was brute-forced in less than an hour.</p>
<p>So far, we’ve managed to extract 583 out of 619 hashes, others probably have different vendors associated with them.</p>
<p>If you’ve found a MAC address that is not on our list, please contact us and we’ll update accordingly (or share in the comments section).</p>
<p>Thanks again Kaspersky for an enjoyable afternoon!</p>
</div>
        <div class="share-buttons-wrap">
            <p class="overline-big">share</p>
            <div class="_w-inline-block w-embed">
                <a class="w-inline-block social-share-btn1 lnk" href="#" target="_blank" title=" Share on LinkedIn" onclick=" window.open('http://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(document.URL) + '&title=' + encodeURIComponent(document.title)); return false;"></a>
                <a class="w-inline-block social-share-btn1 tw" href="#" target="_blank" title=" Tweet" onclick=" window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(document.title) + ':%20 ' + encodeURIComponent(document.URL)); return false;"></a>
                <a class="w-inline-block social-share-btn1 fb" href="#" title=" Share on Facebook" target="_blank" onclick=" window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(document.URL) + '&t=' + encodeURIComponent(document.URL)); return false;"></a>
            </div>
            <div class="_w-inline-block hide">
                <a href="#" class="social-share-btn1 tw w-inline-block"></a>
                <a href="#" class="social-share-btn1 lnk w-inline-block"></a>
                <a href="#" class="social-share-btn1 fb w-inline-block"></a>
            </div>
        </div>
    </div>
</section>

<div class="section wf-section">
    <div class="container">
        <div class="w-embed w-script">
            <div id="disqus_thread"></div>
            <script>
                var disqus_config = function () {
                    this.page.url = "https://skylightcyber.com/2019/03/28/unleash-the-hash-shadowhammer-mac-list/";
                    this.page.identifier = "Unleash The Hash";
                };
                (function() { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://skylight-cyber.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>
</div>


        <!-- END BODY -->
        <!-- START FOOTER -->
        <div class="footer-wrap">
    <footer class="section footer-section wf-section">
        <img src="/images/skylight-logo-big.svg" loading="lazy" alt="" class="footer-big-logo-img">
        <div class="container footer">
            <div class="footer-wrapper">
                <div class="footer-left-part-wrap">
                    <img src="/images/logomark.svg" loading="lazy" alt="" class="image logomark">
                    <div class="footer-left-wrap">
                        <div class="adress-wrap grey-5-text">
                            <p class="paragraph margins-4">Level 30, 201 Elizabeth St</p>
                            <p class="paragraph margins-4">Sydney</p>
                            <p class="paragraph margins-4">NSW 2000</p>
                            <p class="paragraph margins-4">Australia</p>
                        </div>
                    </div>
                </div>
                <div class="footer-right-wrap">
                    <div class="footer-flex">
                        <div class="footer-links-wrap">
                            <h2 class="overline-big gradient-text">SKYLIGHT CYBER</h2>
                            <div class="footer-links mob-flex">
                                
                                <a href="/" aria-current="page" class="link footer-link w-inline-block w--current">
                                    <div class="paragraph-medium footer-p">Home</div>
                                    <img src="/images/vector_7.svg" loading="lazy" alt="" class="link-arrow mob-hide">
                                </a>
                                
                                <a href="/about-us/" aria-current="page" class="link footer-link w-inline-block w--current">
                                    <div class="paragraph-medium footer-p">About</div>
                                    <img src="/images/vector_7.svg" loading="lazy" alt="" class="link-arrow mob-hide">
                                </a>
                                
                                <a href="/services/" aria-current="page" class="link footer-link w-inline-block w--current">
                                    <div class="paragraph-medium footer-p">Services</div>
                                    <img src="/images/vector_7.svg" loading="lazy" alt="" class="link-arrow mob-hide">
                                </a>
                                
                                <a href="/blog/" aria-current="page" class="link footer-link w-inline-block w--current">
                                    <div class="paragraph-medium footer-p">Blog</div>
                                    <img src="/images/vector_7.svg" loading="lazy" alt="" class="link-arrow mob-hide">
                                </a>
                                
                                <a href="/careers/" aria-current="page" class="link footer-link w-inline-block w--current">
                                    <div class="paragraph-medium footer-p">Careers</div>
                                    <img src="/images/vector_7.svg" loading="lazy" alt="" class="link-arrow mob-hide">
                                </a>
                                
                                <a href="/contact-us/" aria-current="page" class="link footer-link w-inline-block w--current">
                                    <div class="paragraph-medium footer-p">Contact Us</div>
                                    <img src="/images/vector_7.svg" loading="lazy" alt="" class="link-arrow mob-hide">
                                </a>
                                
                            </div>
                        </div>
                    </div>
                    <div class="footer-flex">
                        <div class="footer-links-wrap">
                            <h2 class="overline-big gradient-text">find us</h2>
                            <div class="footer-links-horizontal">
                                <a href="https://twitter.com/SkylightCyber" target="_blank" class="link social-link1 w-inline-block">
                                    <div class="w-embed"><svg width="24" height="24" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M7.94453 20.8706C16.1776 20.8706 20.6827 14.0431 20.6827 8.13237C20.6827 7.94029 20.6827 7.74822 20.674 7.55614C21.5471 6.92752 22.3066 6.13302 22.9091 5.23375C22.1058 5.59172 21.2415 5.82745 20.3335 5.94095C21.2589 5.39091 21.9661 4.5091 22.3066 3.46141C21.4423 3.97652 20.4819 4.34322 19.4604 4.54402C18.6397 3.67095 17.4785 3.12964 16.1951 3.12964C13.7243 3.12964 11.7162 5.13772 11.7162 7.60852C11.7162 7.95775 11.7599 8.29825 11.8297 8.63002C8.11042 8.44668 4.81019 6.65687 2.6013 3.95033C2.21715 4.61387 1.99888 5.38218 1.99888 6.20287C1.99888 7.75695 2.79338 9.12768 3.9895 9.93091C3.25611 9.90472 2.56638 9.70391 1.96396 9.37214C1.96396 9.3896 1.96396 9.40706 1.96396 9.43325C1.96396 11.5985 3.5093 13.4145 5.5523 13.8248C5.17688 13.9296 4.78399 13.982 4.37365 13.982C4.08553 13.982 3.80615 13.9558 3.5355 13.9034C4.10299 15.6845 5.76184 16.9766 7.71753 17.0116C6.18092 18.2164 4.25142 18.9323 2.15604 18.9323C1.79807 18.9323 1.44011 18.9149 1.09088 18.8712C3.06403 20.1284 5.42134 20.8706 7.94453 20.8706Z" fill="currentColor"></path>
                                        </svg>
                                    </div>
                                </a>
                                <a href="https://www.linkedin.com/company/skylight-cyber-security/" target="_blank" class="link social-link1 last w-inline-block">
                                    <div class="w-embed"><svg width="22" height="22" viewbox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M19.8711 0.5H2.07058C1.198 0.5 0.499939 1.2 0.499939 2.01667V19.9833C0.499939 20.8 1.198 21.5 2.07058 21.5H19.9293C20.8019 21.5 21.4999 20.8 21.4999 19.9833V2.01667C21.4418 1.2 20.7437 0.5 19.8711 0.5ZM3.58295 8.375H6.66606V18.4083H3.58295V8.375ZM5.15359 3.41667C6.14251 3.41667 6.95692 4.23333 6.95692 5.225C6.95692 6.21667 6.14251 7.03333 5.15359 7.03333C4.16467 7.03333 3.35027 6.21667 3.35027 5.225C3.35027 4.175 4.16467 3.41667 5.15359 3.41667ZM11.6109 8.375H8.6441V18.2917H11.7854V13.3333C11.7854 12.05 12.0181 10.7667 13.6469 10.7667C15.2757 10.7667 15.2757 12.2833 15.2757 13.45V18.35H18.3588V12.8667C18.3588 10.1833 17.7771 8.08333 14.6358 8.08333C13.1233 8.08333 12.0762 8.9 11.669 9.71667H11.6109V8.375Z" fill="currentColor"></path>
                                        </svg>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="footer-flex tablet-hide"></div>
                </div>
            </div>
        </div>
    </footer>
    <div class="section footer-bottom wf-section">
        <div class="container footer-bottom">
            <div class="footer-bottom-flex">
                <div class="paragraph-small grey-6-text">Copyright © 2024 Skylight Cyber All rights reserved.</div>
                <a data-w-id="54c8911f-4aa1-e630-5ddd-b08a629a0a98" href="/privacy-policy/" class="link left-4 w-inline-block">
                    <div class="paragraph-small">Privacy Policy</div>
                </a>
            </div>
        </div>
    </div>
</div>
        <!-- END FOOTER -->
        <div data-scroll="0" data-scroll-speed="1" class="background background-1"></div>
    </div>

    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=606311a2738dd6a51da3a5be" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    
    <script src="/js/simple-lightbox.jquery.js"></script>
    
    <script src="/js/skylight-cyber.js" type="text/javascript"></script>
    <script src="/js/skylight.js" type="text/javascript"></script>
    <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
    <script>
        /*  var ua = navigator.userAgent.toLowerCase();
          if (ua.indexOf('safari') != -1) {
            $(".button.primary").css("border-color","#FF7463");
          } */
    </script>
    <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="5f037e5d-578d-41ab-a197-c09b274ce760" type="text/javascript" async></script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-58K39C6"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

</body>
</html>