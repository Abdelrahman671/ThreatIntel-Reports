<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/t9-advanced-modular-backdoor-uses-complex-anti-analysis-techniques';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques</title>
	<meta name="description" content="Unit 42 found a backdoor, T9000, that allows the attacker to capture encrypted data, take screenshots of specific applications, and target Skype users." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques" />
	<meta property="og:description" content="Unit 42 found a backdoor, T9000, that allows the attacker to capture encrypted data, take screenshots of specific applications, and target Skype users." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2016-02-04T11:00:44+00:00" />
	<meta property="article:modified_time" content="2018-11-01T10:04:39+00:00" />
	<meta property="og:image" content="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-1-500x244.png" />
	<meta name="author" content="Josh Grunzweig, Jen Miller-Osborn" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques Comments Feed" href="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques";
webData.pageURL = "https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques";
webData.article_title = "T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques";
webData.author = "Josh Grunzweig,Jen Miller-Osborn";
webData.published_time = "2016-02-04T13:00:44-08:00";
webData.description = "Unit 42 found a backdoor, T9000, that allows the attacker to capture encrypted data, take screenshots of specific applications, and target Skype users.";
webData.keywords = "Malware,Threat Research,Skype,T5000,T9000,Trojans";
webData.resourceAssetID = "238364cc0b9ef7f8f56ab1d14ee5862f";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="8"/>
<meta property="og:readtime" content="14"/>
<meta property="og:views" content="63,969"/>
<meta property="og:date_created" content="February 4, 2016 at 1:00 PM"/>
<meta property="og:post_length" content="4579"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:author" content="Jen Miller-Osborn"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/joshgruznweig/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="Skype,T5000,T9000,Trojans"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques","name":"T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques","description":"Most custom backdoors used by advanced attackers have limited functionality. They evade detection by keeping their code simple and flying under the radar. But during a recent investigation we found a backdoor that takes a very different approach. We refer to this backdoor as T9000, which is a newer variant of the T5000 malware family,","url":"https:\/\/unit42.paloaltonetworks.com\/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques\/","datePublished":"February 4, 2016","articleBody":"Most custom backdoors used by advanced attackers have limited functionality. They evade detection by keeping their code simple and flying under the radar. But during a recent investigation we found a backdoor that takes a very different approach. We refer to this backdoor as T9000, which is a newer variant of the T5000 malware family, also known as Plat1.\n\nIn addition to the basic functionality all backdoors provide, T9000 allows the attacker to capture encrypted data, take screenshots of specific applications and specifically target Skype users. The malware goes to great lengths to identify a total of 24 potential security products that may be running on a system and customizes its installation mechanism to specifically evade those that are installed. It uses a multi-stage installation process with specific checks at each point to identify if it is undergoing analysis by a security researcher.\n\nThe primary functionality of this tool is to gather information about the victim. In fact, the author chose to store critical files dropped by the Trojan in a directory named \u201cIntel.\u201d T9000 is pre-configured to automatically capture data about the infected system and steal files of specific types stored on removable media.\n\nWe have observed T9000 used in multiple targeted attacks against organizations based in the United States. However, the malware\u2019s functionality indicates that the tool is intended for use against a broad range of users. In this report, we share an analysis of each stage in T9000\u2019s execution flow. Stay tuned for a future report in which we will provide more detail on how this tool has been used and the infrastructure we have identified as part of our analysis.\nT9000 Backdoor Analysis\nThe entire execution flow of the malware is represented in the following diagram:\n\n\n\nAs this malware uses a multistage execution flow, we\u2019ll discuss each stage individually.\nInitial Exploitation\nThe sample of T9000 used in this analysis was originally dropped via a RTF file that contained exploits for both CVE-2012-1856 and CVE-2015-1641. When triggered, an initial shellcode stage is run, which is responsible for locating and executing a secondary shellcode stub. The second stage shellcode reads the initial RTF document and seeks to the end of the file, using the last four bytes as the size of the embedded payload.\n\nWith the payload size confirmed, the shellcode will create a file in the %TEMP% folder using a temporary filename. The shellcode will decrypt and subsequently load the embedded payload in the RTF file. The decrypted payload is written to the temporary file and executed using WinExec. The shellcode then attempts to decrypt an embedded decoy document with the same algorithm used to decrypt the payload, which it will save to %TEMP%\\~tmp.doc path. This file is opened using the following command:\n\ncmd \/C %TEMP%\\~tmp.doc\n\nHowever, this particular sample did not contain a decoy document.\nStage 1\nWhen this temporary file is initially executed, it will begin by creating the following mutex to ensure only one instance of the malware is running at a given time:\n\n820C90CxxA1B084495866C6D95B2595xx1C3\n\nIt continues to perform a number of checks for installed security products on the victim machine. The following security platforms are queried by checking entries within the HKLM\\Software\\ registry path:\n\n\tSophos\n\tINCAInternet\n\tDoctorWeb\n\tBaidu\n\tComodo\n\tTrustPortAntivirus\n\tGData\n\tAVG\n\tBitDefender\n\tVirusChaser\n\tMcAfee\n\tPanda\n\tTrend Micro\n\tKingsoft\n\tNorton\n\tMicropoint\n\tFilseclab\n\tAhnLab\n\tJiangMin\n\tTencent\n\tAvira\n\tKaspersky\n\tRising\n\t360\n\nThese security products are represented by a value that is binary AND-ed with any other products found. The following numbers represent each respective security product.\n\n0x08000000 : Sophos\n0x02000000 : INCAInternet\n0x04000000 : DoctorWeb\n0x00200000 : Baidu\n0x00100000 : Comodo\n0x00080000 : TrustPortAntivirus\n0x00040000 : GData\n0x00020000 : AVG\n0x00010000 : BitDefender\n0x00008000 : VirusChaser\n0x00002000 : McAfee\n0x00001000 : Panda\n0x00000800 : Trend Micro\n0x00000400 : Kingsoft\n0x00000200 : Norton\n0x00000100 : Micropoint\n0x00000080 : Filseclab\n0x00000040 : AhnLab\n0x00000020 : JiangMin\n0x00000010 : Tencent\n0x00000004 : Avira\n0x00000008 : Kaspersky\n0x00000002 : Rising\n0x00000001 : 360\n\nSo, for example, if both Trend Micro and Sophos were discovered on a victim machine, the resulting value would be 0x08000800. This numerical value is written to the following file:\n\n%APPDATA%\\Intel\\avinfo\n\nThe malware proceeds to drop the following files to the %APPDATA%\\Intel directory:\n\n\n\nAdditionally, the following two files are written to the Data directory:\n\n\n\nThe following table provides a description of each file dropped:\n\n\n\nFile Name\nDescription\n\n\n~1\nDebug information about files used by malware.\n\n\navinfo\nInstalled security products on victim.\n\n\nhccutils.dll\nMalicious DLL. Loads ResN32.dll.\n\n\nhccutils.inf\nMalicious INF file. Points to hccutils.dll.\n\n\nhjwe.dat\nEncrypted core of malware family.\n\n\nigfxtray.exe\nLegitimate Microsoft executable. Loads hccutils.dll.\n\n\nqhnj.dat\nEncrypted plugin. Hooks a number of functions and logs results.\n\n\nQQMgr.dll\nMalicious DLL. Sets persistence via Run registry key.\n\n\nQQMgr.inf\nMalicious INF file. Points to QQMgr.dll\n\n\nResN32.dat\nString pointing to path of encrypted core of malware.\n\n\nResN32.dll\nMalicious DLL. Decrypts, decompresses, and loads core malware.\n\n\ntyeu.dat\nEncrypted plugin. Takes screenshots and collects Skype information.\n\n\nvnkd.dat\nEncrypted plugin. Finds files on removable drives on victim machine.\n\n\ndtl.dat\nEncrypted configuration information.\n\n\nglp.uin\nPlugin configuration information.\n\n\n\nYou\u2019ll notice that QQMgr* files are not listed in the original malware execution flow diagram. In the event the victim is running any of the following operating system versions, as well as either Kingsoft, Filseclab, or Tencent security products, the malware will be installed using an alternative method.\n\n\tWindows 2008 R2\n\tWindows 7\n\tWindows 2012\n\tWindows 8\n\nIn such a situation, the malware will find and run the built-in Microsoft Windows InfDefaultInstall.exe program, which will install a DLL via an INF file. Should Tencent be installed, the malware will execute the InfDefaultInstall.exe program with an argument of \u2018QQMgr.inf\u2019. Otherwise, it will use \u2018hccutils.inf\u2019 as an argument.\n\nQQMgr.inf will install the QQMgr.dll, while hccutils.inf will install the hccutils.dll library. QQMgr.dll will set the following registry key:\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Eupdate - %APPDATA%\\Intel\\ResN32.dll\n\nThe QQMgr.dll file has the following debug string found within it:\n\nH:\\WORK\\PROJECT\\InfInstallBypassUAC\\Release\\BypassUAC.pdb\n\nThe hccutils.dll file is described later within this post.\n\nAfter the malware drops the required files, by default the malware will spawn %APPDATA%\\Intel\\igfxtray.exe in a new process, which begins the second stage of the malware\u2019s execution.\nStage 2\nThe igfxtray.exe is a legitimate Microsoft Windows executable that sideloads the malicious hccutils.dll DLL file. This DLL has the following debug string embedded within it:\n\nD:\\WORK\\T9000\\hccutils_M4\\Release\\hccutils.pdb\n\nUpon loading this malicious DLL, the malware will initially perform the same queries for security products that were witnessed in stage 1.\n\nThree separate techniques for starting stage 3 are used depending on the properties of the victim.\n\nThe first technique is used if the victim meets the following criteria:\n\n\tMicrosoft Windows 8 \/ Windows Server 2012 R2\n\tDoctorWeb security product installed\n\nFor this situation, the following registry key is set:\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\update - %SYSTEM%\\rundll32.exe %APPDATA\\Intel\\ResN32.dll Run\n\nThis ensures that the ResN32.dll library will be run using the \u2018Run\u2019 exported function whenever the machine is rebooted.\n\nThe second technique is used if the victim meets any of the following sets of criteria:\n\n\tMicrosoft Windows 8 \/ Windows Server 2012 R2\n\tNot running Kingsoft, Tencent, or DoctorWeb security products\n\n\n\tMicrosoft Windows XP or lower\n\tNo security products installed, or running any of the following:\n\n\tSophos\n\tGData\n\tTrendMicro\n\tAhnLab\n\tKaspersky\n\n\n\nIn these situations, the following persistence technique is used.\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs - %APPDATA%\\Intel\\ResN32.dll\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\LoadAppInit_DLLs \u2013 0x1\n\nSetting these registry keys both enables the AppInit_DLL functionality, and ensures that every user mode process that is spawned will load the ResN32.dll library. More information about this can be found here.\n\nThe third technique is used in any other situation. When this occurs, the malware will first identify the explorer.exe process identifier. It proceeds to inject the ResN32.dll library into this process.\n\nAt this point, the third stage of the malware family is loaded.\nStage 3\nThe third stage begins when the ResN32.dll file begins operating. This file contains the following debug string:\n\nD:\\WORK\\T9000\\ResN_M2\\Release\\ResN32.pdb\n\nThe ResN32.dll library begins by spawning a new thread that is responsible for the majority of the capabilities built into this sample. This thread begins by checking the operating system version, and once again runs a query on the various security products installed on the victim machine.\n\nUnder certain conditions, the following registry key is set, ensuring persistence across reboots:\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\update \u2013 c:\\windows\\system32\\rundll32.exe %APPDATA\\Intel\\ResN32.dll Run\n\nFollowing this, a new thread is created that is responsible for deleting previously written files. This thread creates the following mutex:\n\nGlobal\\\\deletethread\n\nIt proceeds to attempt to delete the following files in an infinite loop until said files have been deleted:\n\n\t%STARTUP%\\hccutils.dll\n\t%STARTUP%\\hccutil.dll\n\t%STARTUP%\\igfxtray.exe\n\nThe ResN32.dll malware proceeds to read in the ResN32.dat file that was previously written to disk. This file contains a path to the hjwe.dat file, which is subsequently read in.\n\nThe data within the hjwe.dat file is decrypted using the RC4 algorithm, and subsequently decompressed using the LZMA algorithm. The following script can be used to decrypt the hjwe.dat file, along with the plugins that will be discussed later.\nimport sys, pylzma\nfrom base64 import *\nfrom binascii import *\nfrom struct import *\n\ndef rc4( data , key ):\n  S = range(256)\n  j = 0\n  out = []\n  for i in range(256):\n    j = (j + S[i] + ord( key[i % len(key)] )) % 256\n    S[i] , S[j] = S[j] , S[i]\n  i = j = 0\n  for char in data:\n    i = ( i + 1 ) % 256\n    j = ( j + S[i] ) % 256\n    S[i] , S[j] = S[j] , S[i]\n    out.append(chr(ord(char) ^ S[(S[i] + S[j]) % 256]))\n  return ''.join(out)\n\nf = open(sys.argv[1], 'rb')\nfd = f.read()\nf.close()\n\nbytes_0_4, bytes_4_8, bytes_8_12, bytes_12_16 = unpack(\"&lt;IIII\", fd[0:16])\nif bytes_0_4 == 0xf7e4aa65:\n  length = bytes_8_12\n  if len(fd)-16 != length:\n    print \"[*] Possible error reading in length of data.\"\n  key_size = 260\n  key = fd[16:16+key_size]\n  data = fd[16+key_size:]\n  decrypted = rc4(data, key)\n  decompressed = pylzma.decompress_compat(decrypted)\n  f1 = open(sys.argv[1]+\".decompressed\", 'wb')\n  f1.write(decompressed)\n  f1.close\n  print \"[+] Wrote %s\" % (sys.argv[1]+\".decompressed\")\n\nAfter this file has been decrypted and decompressed, it is written to a file in the %TEMP% directory with a file prefix of \u2018____RES\u2019. This file, which contains a Windows DLL, is then loaded into the current process. After the malicious library has been loaded, the previously written temporary file is deleted. This begins the last stage of the malware, which will load the core of the malware family.\nStage 4\nOnce the decrypted and decompressed hjwe.dat file is loaded, it begins by checking its parent process against the following list.\u00a0If the parent process matches the following blacklist, the malicious DLL will exit without performing any malicious activities.\n\n\twinlogon.exe\n\tcsrss.exe\n\tlogonui.exe\n\tctfmon.exe\n\tdrwtsn32.exe\n\tlogonui.exe\n\texplore.exe\n\tSystem\n\tDbgview.exe\n\tuserinit.exe\n\tlsass.exe\n\twmiprvse.exe\n\tservices.exe\n\tinetinfo.exe\n\tavp.exe\n\tRtvscan.exe\n\nThe malware proceeds to collect the username of the victim, as well as the operating system version. It then compares its parent process against the following list of executables:\n\n\twinlogon.exe\n\tcsrss.exe\n\tlogonui.exe\n\tctfmon.exe\n\tdrwtsn32.exe\n\tlogonui.exe\n\tSystem\n\tDwm.exe\n\tQQPCRTP.exe\n\tTasking.exe\n\tTaskhost.exe\n\tTaskmgr.exe\n\tDbgview.exe\n\tsuerinit.exe\n\tlsass.exe\n\twmiprvse.exe\n\tservices.exe\n\tinetinfo.exe\n\tavp.exe\n\tRtvscan.exe\n\nNotice the repeated check for the \u2018logonui.exe\u2019, as well as the overlap with the previous parent executable check, which implies sloppiness by the malware author.\n\nAfter these checks are performed, the following mutex is created.\n\nGlobal\\\\{A59CF429-D0DD-4207-88A1-04090680F714}\n\nThe following folders are then created:\n\n\tutd_CE31\n\tXOLOADER\n\tUpdate\n\nThe path of these folders is determined by the version of Microsoft Windows running. The following possibilities exist:\n\n\t%ALLUSERSPROFILE%\\Documents\\My Document\\\n\t%PUBLIC%\\Downloads\\Update\\\n\nAt this point, the malware will read in the dtl.dat file, which contains configuration data. Data contained with this file starting at offset 0x20 is xor-encrypted using a single-byte key of 0x5F. The following script can be used to extract the IP address and port for the C2 server from this file.\nfrom struct import *\nimport sys, socket\n\ndef int2ip(addr):                                                              \n  return socket.inet_ntoa(pack(\"!I\", addr))       \n\nconfig_file = sys.argv[1]\nf = open(config_file, 'rb')\nfd = f.read()\nf.close()\n\ndecrypted = \"\"\nfor x in fd[32:]:\n  decrypted += chr(ord(x) ^ 0x5f)\n\nport = unpack(\"&lt;I\", decrypted[4:8])[0]\nip = int2ip(unpack(\"&gt;I\", decrypted[8:12])[0])\n\nprint \"IP Address : %s\" % ip\nprint \"Port       : %d\" % port\n\nThe malware will then read in and parse the included plugin configuration information, which is found within the glp.uin file that was previously dropped. These included plugins are encrypted and compressed using the same method witnessed by the hjwe.dat file previously. The previously included script can be used to decrypt and decompress the following three plugin files:\n\n\ttyeu.dat\n\tvnkd.dat\n\tqhnj.dat\n\nThese three plugins are subsequently loaded after being decrypted and decompressed. An overview of these plugins can be found later in this post.\n\nThe malware proceeds to create the following event:\n\nGlobal\\\\{34748A26-4EAD-4331-B039-673612E8A5FC}\n\nAdditionally, the following three mutexes are created:\n\nGlobal\\\\{3C6FB3CA-69B1-454f-8B2F-BD157762810E}\nGlobal\\\\{43EE34A9-9063-4d2c-AACD-F5C62B849089}\nGlobal\\\\{A8859547-C62D-4e8b-A82D-BE1479C684C9}\n\nThe malware will spawn a new thread to handle network communication. The following event is created prior to this communication occurring:\n\nGlobal\\\\{EED5CA6C-9958-4611-B7A7-1238F2E1B17E}\n\nThe malware includes proxy support in the event that the victim is behind a web proxy. Network traffic occurs over a binary protocol on the port specified within the configuration. Traffic is xor-encrypted with a single-byte key of 0x55 in an attempt to bypass any network security products that may be in place. Once decrypted, the following traffic is sent by the malware.\n\n\nFigure 1: Decrypted data sent by malware\nAs we can see from the above image, the malware will send out an initial beacon, followed by various collected information from the victim machine. The following information is exfiltrated:\n\n\tInstalled security products\n\tSystem time\n\tBuild Number\n\tCPU Architecture (32-bit\/64-bit)\n\tMAC Address\n\tIP Address\n\tHostname\n\tUsername\n\tParent executable name\n\tPlugin configuration information\n\nThe malware is configured to receive a number of commands. The following command functionalities have been identified.\n\n\n\nCommand\nDescription\n\n\nDIR\nDirectory listing\n\n\nLIR\nDrive listing\n\n\nRUN\nExecute command (Either interactively or not)\n\n\nCIT\nSend command to interactively spawned command\n\n\nCFI\nKill interactively spawned process\n\n\nDOW\nDownload file\n\n\nUPL\nUpload file\n\n\nDEL\nDelete file\n\n\nDTK\nRetrieve statistics for file\n\n\nERR\nNull command\n\n\n\nAdditionally, the following commands have been identified, however, their functionalities have yet to be fully discovered.\n\n\tPNG\n\tPLI\n\tPLD\n\tFDL\n\tOSC\n\tOSF\n\tSDA\n\tQDA\n\tTFD\n\tSDS\n\tSCP\n\tFMT\n\tSTK\n\tCRP\n\nPlugin #1 \u2013 tyeu.dat\nWhen this plugin is called with the default exported function, it will create the following mutex:\n\n{CE2100CF-3418-4f9a-9D5D-CC7B58C5AC62}\n\nWhen called with the SetCallbackInterface function export, the malicious capabilities of the plugin begin. The plugin begins by collecting the username of the running process, and determining if it is running under the SYSTEM account. If running as SYSTEM, the plugin will associate the active desktop with the plugin\u2019s thread.\n\nThe plugin proceeds to create the following named event:\n\nGlobal\\\\{EED5CA6C-9958-4611-B7A7-1238F2E1B17E}\n\nMultiple threads are then spawned to handle various actions. The first thread is responsible for taking a screenshot of the desktop of the victim machine. This screenshot data is both compressed and encrypted using a single-byte xor key of 0x5F. This data is written to one of the following files:\n\n%PUBLIC%\\Downloads\\Update\\S[random].dat\n%ALLUSERSPROFILE%\\Documents\\My Document\\S[random].dat\n\nThe random data is generated via the current system time. Additionally, when a screenshot is written, one of the following log files has data appended to it:\n\n%PUBLIC%\\Downloads\\Update\\Log.txt\n%ALLUSERSPROFILE%\\Documents\\My Document\\Log.txt\n\n\nFigure 2: Example data found within Log.txt file\nA second thread is responsible for monitoring the foreground window every 20 seconds. The thread will target the window names set within the plugin configuration. In this particular instance, the malware will target the \u2018notepad\u2019 process.\n\nWhen this process is discovered to be running in the foreground window, the malware will take a screenshot of this window. The data is compressed and encrypted using a single-byte xor key of 0x5F. This data is written to one of the following files:\n\n%PUBLIC%\\Downloads\\Update\\W[random].dat\n%ALLUSERSPROFILE%\\Documents\\My Document\\W[random].dat\n\nLike the previous thread, this one attempts to write another log file to the disk. However, due to a bug within the code of this plugin, the malware author attempts to append the \u2018C:\\\\Windows\\\\Temp\\\\Log.txt\u2019 string to the path, resulting in an inaccessible file path. In the event this bug did not exist, the following example data would be written:\n\n08:37:49 2000 [4] PrintKeyTitleWnd: ===&gt;&gt; Process ID : 2000\n\nThe third and final thread spawned by this plugin is responsible for collecting information from the Skype program. The malware will use the built-in Skype API to accomplish this. This only takes places if both Skype is running and the victim is logged into Skype. It makes calls to the following functions:\n\n\tSkypeControlAPIDiscover\n\tSkypeControlAPIAttach\n\nWhen hooking into the Skype API, the victim is presented with the following dialog:\n\n\nFigure 3: Skype API access request\nThe victim must explicitly allow the malware to access Skype for this particular functionality to work. However, since a legitimate process is requesting access, the user may find him- or herself allowing this access without realizing what is actually happening.\n\nOnce enabled, the malware will record video calls, audio calls, and chat messages. Audio and video files are stored in the following folder:\n\n%APPDATA%\\Intel\\Skype\nTemporary audio and video files are stored within the audio and video sub-folders respectively. After a call is finished, this data is compressed and encrypted using the same techniques previously witnessed. These files are\u00a0stored in randomly named .dat files within the Skype folder.\n\nWhen decrypted, we can see that the malware periodically takes images of the video calls. Audio calls are stored as .wav files.\n\n\nFigure 4: A lonely malware reverser is captured on video by the malicious plugin\nThe original name for this plugin is \u2018CaptureDLL.dll\u2019. This is aptly named, as we see that this plugin has the following functionality:\n\n\tCapture full desktop screenshots\n\tCapture window screenshots of targeted processes\n\tCapture Skype audio, video, and chat messages\n\nPlugin #2 \u2013 vnkd.dat\nThe vnkd.dat plugin has the following debug path, leading us to believe that the original name for this plugin is \u2018FlashDiskThief\u2019:\n\ne:\\WORK\\Project\\T9000\\Windows\\Target\\FlashDiskThief.pdb\n\nWhen loaded with the default DllEntryPoint exported function, it will create the following mutex:\n\nGlobal\\\\{6BB1120C-16E9-4c91-96D5-04B42D1611B4}\n\nLike the other plugins associated with this malware, the majority of the functionality for this malware resides within the SetCallbackInterface exported function. This function spawns a new thread that begins by registering a new window with a class name and window name of \u2018xx\u2019.\n\nThe plugin proceeds to iterate through all connected drives on the system, looking for removable drives.\n\n\nFigure 5. Plugin check for removable drives\nShould a removable drive be discovered, the plugin will seek any files residing on this device based on the plugin\u2019s configured list. In this particular instance, the malware will seek out the following file types:\n\n\t*.doc\n\t*.ppt\n\t*.xls\n\t*.docx\n\t*.pptx\n\t*.xlsx\n\nIf one of these file types is found, the malware will create a copy of the file in one of the following paths:\n\n%PUBLIC%\\Downloads\\Update\\D[random].tmp\n%ALLUSERSPROFILE%\\Documents\\My Document\\D[random].tmp\n\nThe data found within this file is encrypted using a single-byte xor key of 0x41. The file header structure, with the underlying data still encrypted, can be seen below.\n\n\nFigure 6: File structure prior to decryption\n\nFigure 7: File structure post decryption\nThis concludes the functionality of the vnkd.dat plugin, or FlaskDiskThief as it\u2019s known by the malware\u2019s author. While specific in nature, this plugin allows attackers to collect files being passed around from one machine to another via removable drives.\nPlugin #3 \u2013 qhnj.dat\nThis particular plugin appears to have an original filename of \u2018kplugin.dll\u2019 due to debugging information found within the file. The qhnj.dat plugin is responsible for hooking a number of common Microsoft Windows API calls, and logging the results.\n\nThe following functions are hooked by this plugin:\n\n\tImmGetCompositionStringA\n\tImmGetCompositionStringW\n\tCreateFileW\n\tDeleteFileW\n\tCopyFileExW\n\tMoveFileWithProgressW\n\tCreateDirectoryW\n\tCreateDirectoryExW\n\tRemoveDirectoryW\n\tGetClipboardData\n\tCryptEncrypt\n\tCryptDecrypt\n\nThe plugin is most likely hooking the ImmGetCompositionString* functions in order to collect information about Unicode characters on the victim machine, such as Chinese, Japanese, and Korean.\n\nHooking the various file and directory operations allows the malware to log what file changes are occurring on the system. When a file is created, copied, moved, or deleted on the system, the malware will check the directory of said file against the following blacklist:\n\n\t\\\\\\\\.\\\\\n\t:\\\\program files\\\\\n\t\\\\AppData\\\\\n\t\\\\temporary internet files\\\\\n\t\\\\application data\\\\\n\t\\\\Local Settings\\\\\n\t\\\\cookies\\\\\n\t\\\\temp\\\\\n\t\\\\history\\\\\n\nAdditionally, the filename is compared against the \u2018.tmp\u2019 extension to ensure a temporary file is ignored.\n\nShould the file meet the required criteria, this data is logged. Additionally, all folder modifications and clipboard data are logged as well.\n\nThe Crypt* functions allow the malware to collect sensitive encrypted data sent to and from the victim machine. This is especially useful when viewing network traffic, allowing the attackers to potentially gain access to remote systems used by the victim.\n\nAll of the data logged by the qhnj.dat plugin file is stored in one of the following file paths. Data is encrypted using a single-byte XOR key of 0x79.\n\n%PUBLIC%\\Downloads\\Update\\uai[random].tmp\n%ALLUSERSPROFILE%\\Documents\\My Document\\uai[random].tmp\n\nThis last plugin allows the attackers to record important actions taken by the victim, which in turn may allow them to gain additional access as well as insight into the victim\u2019s actions.\nConclusion\nT9000 appears to be the latest version of this Trojan, which has been partially exposed in previous reports. In 2013, Cylance published a report on a group they named \u201cGrand Theft Auto Panda\u201d, which includes some details on the T5000 version of this Trojan. FireEye researchers also noted that the malware was used in an attack in 2014 using a lure related to the disappearance of Malaysian flight MH370.\n\nThe author of this backdoor has gone to great lengths to avoid being detected and to evade the scrutiny of the malware analysis community. We hope that sharing the details of how this tool works as well as the indicators in the section below will help others defend themselves against attacks using this tool.\n\nIn a future report, we will detail the infrastructure used by the variants of the malware we have identified and discuss the methods attackers use to infect systems with it.\n\nPalo Alto Networks customers are protected from T9000\/T5000 attacks through our next-generation security platform, including the following.\n\n\tThreat Prevention signatures for the software vulnerabilities listed in this report are available to detect the exploit files during delivery.\n\tTraps is capable of preventing exploitation of the vulnerabilities exploited to install T9000.\n\tWildFire classifies all of the malware described in this report as malicious.\n\tAnti-malware signatures for the files listed in this report.\n\tAutoFocus users can identify the malware discussed in this report with the T5000 tag\n\nIndicators of Compromise\nHashes\n\nRTF File, d5fa43be20aa94baf1737289c5034e2235f1393890fb6f4e8d4104565be52d8c\nQQMGr.dll, bf1b00b7430899d33795ef3405142e880ef8dcbda8aab0b19d80875a14ed852f\nQQMGR.inf, ace7e3535f2f1fe32e693920a9f411eea21682c87a8e6661d3b67330cd221a2a\nResN32.dat, aa28db689f73d77babd1c763c53b3e63950f6a15b7c1a974c7481a216dda9afd\nResN32.dll, 1cea4e49bd785378d8beb863bb8eb662042dffd18c85b8c14c74a0367071d9a7\nhqwe.dat, bb73261072d2ef220b8f87c6bb7488ad2da736790898d61f33a5fb7747abf48b\nhqwe.dat.decrypted, 7daf3c3dbecb60bee3d5eb3320b20f2648cf26bd9203564ce162c97dcb132569\nhccutils.dll, 3dfc94605daf51ebd7bbccbb3a9049999f8d555db0999a6a7e6265a7e458cab9\nhccutils.inf, f05cd0353817bf6c2cab396181464c31c352d6dea07e2d688def261dd6542b27\nigfxtray.exe, 21a5818822a0b2d52a068d1e3339ed4c767f4d83b081bf17b837e9b6e112ee61\nqhnj.dat, c61dbc7b51caab1d0353cbba9a8f51f65ef167459277c1c16f15eb6c7025cfe3\nqhnj.dat.decrypted, 2b973adbb2addf62cf36cef9975cb0193a7ff0b960e2cff2c80560126bee6f37\ntyeu.dat, e52b5ed63719a2798314a9c49c42c0ed4eb22a1ac4a2ad30e8bfc899edcea926\ntyeu.dat.decrypted, 5fc3dc25276b01d6cb2fb821b83aa596f1d64ae8430c5576b953e3220a01d9aa\nvnkd.dat, c22b40db7f9f8ebdbde4e5fc3a44e15449f75c40830c88932f9abd541cc78465\nvnkd.dat.decrypted, 157e0a9323eaaa911b3847d64ca0d08be8cd26b2573687be461627e410cb1b3f\ndtl.dat, 00add5c817f89b9ec490885be39398f878fa64a5c3564eaca679226cf73d929e\nglp.uin, 3fa05f2f73a0c44a5f51f28319c4dc5b8198fb25e1cfcbea5327c9f1b3a871d4\n\nMutexes\n\n820C90CxxA1B084495866C6D95B2595xx1C3\nGlobal\\\\deletethread\nGlobal\\\\{A59CF429-D0DD-4207-88A1-04090680F714}\nGlobal\\\\{3C6FB3CA-69B1-454f-8B2F-BD157762810E}\nGlobal\\\\{43EE34A9-9063-4d2c-AACD-F5C62B849089}\nGlobal\\\\{A8859547-C62D-4e8b-A82D-BE1479C684C9}\n{CE2100CF-3418-4f9a-9D5D-CC7B58C5AC62}\nGlobal\\\\{6BB1120C-16E9-4c91-96D5-04B42D1611B4}\n\nNamed Events\n\nGlobal\\\\{34748A26-4EAD-4331-B039-673612E8A5FC}\nGlobal\\\\{EED5CA6C-9958-4611-B7A7-1238F2E1B17E}\n\nFile Modifications\n\n%TEMP%\\~tmp.doc\n%APPDATA%\\Intel\\avinfo\n%APPDATA%\\Intel\\Data\\dtl.dat\n%APPDATA%\\Intel\\Data\\glp.uin\n%APPDATA%\\Intel\\Data\\\n%APPDATA%\\Intel\\~1\n%APPDATA%\\Intel\\hccutils.dll\n%APPDATA%\\Intel\\hccutils.inf\n%APPDATA%\\Intel\\hjwe.dat\n%APPDATA%\\Intel\\igfxtray.exe\n%APPDATA%\\Intel\\qhnj.dat\n%APPDATA%\\Intel\\QQMgr.dll\n%APPDATA%\\Intel\\QQMgr.inf\n%APPDATA%\\Intel\\ResN32.dll\n%APPDATA%\\Intel\\ResN32.dat\n%APPDATA%\\Intel\\tyeu.dat\n%APPDATA%\\Intel\\vnkd.dat\n%STARTUP%\\hccutils.dll\n%STARTUP%\\hccutil.dll\n%STARTUP%\\igfxtray.exe\n%ALLUSERSPROFILE%\\Documents\\My Document\\utd_CE31\n%ALLUSERSPROFILE%\\Documents\\My Document\\XOLOADER\n%ALLUSERSPROFILE%\\Documents\\My Document\\update\n%ALLUSERSPROFILE%\\Documents\\My Document\\Log.txt\n%PUBLIC%\\Downloads\\Update\\utd_CE31\n%PUBLIC%\\Downloads\\Update\\XOLOADER\n%PUBLIC%\\Downloads\\Update\\update\n%PUBLIC%\\Downloads\\Update\\Log.txt\n%APPDATA%\\Intel\\Skype\n\nRegistry Modifications\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Eupdate - %APPDATA%\\Intel\\ResN32.dll\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\update - %SYSTEM%\\rundll32.exe %APPDATA\\Intel\\ResN32.dll Run\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs - %APPDATA%\\Intel\\ResN32.dll\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\LoadAppInit_DLLs \u2013 0x1\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\update \u2013 c:\\windows\\system32\\rundll32.exe %APPDATA\\Intel\\ResN32.dll Run\n\nCommand and Control\n\n\u00a0198.55.120[.]143:8080","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Josh Grunzweig"},{"@type":"Person","name":"Jen Miller-Osborn"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":12051,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"19c0df3ad2","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"26f43eef0c"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/12051" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=12051' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="pingback" href="https://unit42.paloaltonetworks.com/xmlrpc.php"><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-12051 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/article-banner.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 14</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:Josh Grunzweig" href="https://unit42.paloaltonetworks.com/author/joshgruznweig/">Josh Grunzweig</a></li><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:Jen Miller-Osborn" href="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/">Jen Miller-Osborn</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>4 February, 2016 at 1:00 PM PST</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:Skype" href="https://unit42.paloaltonetworks.com/tag/skype/">Skype</a></li><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:T5000" href="https://unit42.paloaltonetworks.com/tag/t5000/">T5000</a></li><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:T9000" href="https://unit42.paloaltonetworks.com/tag/t9000/">T9000</a></li><li><a data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:Trojans" href="https://unit42.paloaltonetworks.com/tag/trojans/">Trojans</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/?pdf=download&#038;lg=en&#038;_wpnonce=fc7ec9367f" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/?pdf=print&#038;lg=en&#038;_wpnonce=fc7ec9367f" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/" role="link" title="Copy link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=T9000:%20Advanced%20Modular%20Backdoor%20Uses%20Complex%20Anti-Analysis%20Techniques&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F&#038;title=T9000:%20Advanced%20Modular%20Backdoor%20Uses%20Complex%20Anti-Analysis%20Techniques" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F&#038;text=T9000:%20Advanced%20Modular%20Backdoor%20Uses%20Complex%20Anti-Analysis%20Techniques" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=T9000:%20Advanced%20Modular%20Backdoor%20Uses%20Complex%20Anti-Analysis%20Techniques%20https%3A%2F%2Funit42.paloaltonetworks.com%2Ft9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p>Most custom backdoors used by advanced attackers have limited functionality. They evade detection by keeping their code simple and flying under the radar. But during a recent investigation we found a backdoor that takes a very different approach. We refer to this backdoor as T9000, which is a newer variant of the T5000 malware family, also known as Plat1.</p>
<p>In addition to the basic functionality all backdoors provide, T9000 allows the attacker to capture encrypted data, take screenshots of specific applications and specifically target Skype users. The malware goes to great lengths to identify a total of 24 potential security products that may be running on a system and customizes its installation mechanism to specifically evade those that are installed. It uses a multi-stage installation process with specific checks at each point to identify if it is undergoing analysis by a security researcher.<span id="more-12051"></span></p>
<p>The primary functionality of this tool is to gather information about the victim. In fact, the author chose to store critical files dropped by the Trojan in a directory named “Intel.” T9000 is pre-configured to automatically capture data about the infected system and steal files of specific types stored on removable media.</p>
<p>We have observed T9000 used in multiple targeted attacks against organizations based in the United States. However, the malware’s functionality indicates that the tool is intended for use against a broad range of users. In this report, we share an analysis of each stage in T9000’s execution flow. Stay tuned for a future report in which we will provide more detail on how this tool has been used and the infrastructure we have identified as part of our analysis.</p>
<h3>T9000 Backdoor Analysis</h3>
<p>The entire execution flow of the malware is represented in the following diagram:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-1.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12052" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-1-500x244.png" alt="T9000 1" width="500" height="244" /></a></p>
<p>As this malware uses a multistage execution flow, we’ll discuss each stage individually.</p>
<h4>Initial Exploitation</h4>
<p>The sample of T9000 used in this analysis was originally dropped via a RTF file that contained exploits for both <a href="https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1856" target="_blank">CVE-2012-1856</a> and <a href="https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1641" target="_blank">CVE-2015-1641</a>. When triggered, an initial shellcode stage is run, which is responsible for locating and executing a secondary shellcode stub. The second stage shellcode reads the initial RTF document and seeks to the end of the file, using the last four bytes as the size of the embedded payload.</p>
<p>With the payload size confirmed, the shellcode will create a file in the %TEMP% folder using a temporary filename. The shellcode will decrypt and subsequently load the embedded payload in the RTF file. The decrypted payload is written to the temporary file and executed using WinExec. The shellcode then attempts to decrypt an embedded decoy document with the same algorithm used to decrypt the payload, which it will save to %TEMP%\~tmp.doc path. This file is opened using the following command:</p>
<p><em>cmd /C %TEMP%\~tmp.doc</em></p>
<p>However, this particular sample did not contain a decoy document.</p>
<h4>Stage 1</h4>
<p>When this temporary file is initially executed, it will begin by creating the following mutex to ensure only one instance of the malware is running at a given time:</p>
<p><em>820C90CxxA1B084495866C6D95B2595xx1C3</em></p>
<p>It continues to perform a number of checks for installed security products on the victim machine. The following security platforms are queried by checking entries within the HKLM\Software\ registry path:</p>
<ul>
<li>Sophos</li>
<li>INCAInternet</li>
<li>DoctorWeb</li>
<li>Baidu</li>
<li>Comodo</li>
<li>TrustPortAntivirus</li>
<li>GData</li>
<li>AVG</li>
<li>BitDefender</li>
<li>VirusChaser</li>
<li>McAfee</li>
<li>Panda</li>
<li>Trend Micro</li>
<li>Kingsoft</li>
<li>Norton</li>
<li>Micropoint</li>
<li>Filseclab</li>
<li>AhnLab</li>
<li>JiangMin</li>
<li>Tencent</li>
<li>Avira</li>
<li>Kaspersky</li>
<li>Rising</li>
<li>360</li>
</ul>
<p>These security products are represented by a value that is binary AND-ed with any other products found. The following numbers represent each respective security product.</p>
<p><em>0x08000000 : Sophos<br />
</em><em>0x02000000 : INCAInternet<br />
</em><em>0x04000000 : DoctorWeb<br />
</em><em>0x00200000 : Baidu<br />
</em><em>0x00100000 : Comodo<br />
</em><em>0x00080000 : TrustPortAntivirus<br />
</em><em>0x00040000 : GData<br />
</em><em>0x00020000 : AVG<br />
</em><em>0x00010000 : BitDefender<br />
</em><em>0x00008000 : VirusChaser<br />
</em><em>0x00002000 : McAfee<br />
</em><em>0x00001000 : Panda<br />
</em><em>0x00000800 : Trend Micro<br />
</em><em>0x00000400 : Kingsoft<br />
</em><em>0x00000200 : Norton<br />
</em><em>0x00000100 : Micropoint<br />
</em><em>0x00000080 : Filseclab<br />
</em><em>0x00000040 : AhnLab<br />
</em><em>0x00000020 : JiangMin<br />
</em><em>0x00000010 : Tencent<br />
</em><em>0x00000004 : Avira<br />
</em><em>0x00000008 : Kaspersky<br />
</em><em>0x00000002 : Rising<br />
</em><em>0x00000001 : 360</em></p>
<p>So, for example, if both Trend Micro and Sophos were discovered on a victim machine, the resulting value would be 0x08000800. This numerical value is written to the following file:</p>
<p><em>%APPDATA%\Intel\avinfo</em></p>
<p>The malware proceeds to drop the following files to the %APPDATA%\Intel directory:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-2.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12054" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-2-500x540.png" alt="T9000 2" width="500" height="540" /></a></p>
<p>Additionally, the following two files are written to the Data directory:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-3.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12055" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-3-500x110.png" alt="T9000 3" width="500" height="110" /></a></p>
<p>The following table provides a description of each file dropped:</p>
<table style="height: 501px;" width="484">
<tbody>
<tr>
<td width="73"><strong>File Name</strong></td>
<td width="370"><strong>Description</strong></td>
</tr>
<tr>
<td width="73">~1</td>
<td width="370">Debug information about files used by malware.</td>
</tr>
<tr>
<td width="73">avinfo</td>
<td width="370">Installed security products on victim.</td>
</tr>
<tr>
<td width="73">hccutils.dll</td>
<td width="370">Malicious DLL. Loads ResN32.dll.</td>
</tr>
<tr>
<td width="73">hccutils.inf</td>
<td width="370">Malicious INF file. Points to hccutils.dll.</td>
</tr>
<tr>
<td width="73">hjwe.dat</td>
<td width="370">Encrypted core of malware family.</td>
</tr>
<tr>
<td width="73">igfxtray.exe</td>
<td width="370">Legitimate Microsoft executable. Loads hccutils.dll.</td>
</tr>
<tr>
<td width="73">qhnj.dat</td>
<td width="370">Encrypted plugin. Hooks a number of functions and logs results.</td>
</tr>
<tr>
<td width="73">QQMgr.dll</td>
<td width="370">Malicious DLL. Sets persistence via Run registry key.</td>
</tr>
<tr>
<td width="73">QQMgr.inf</td>
<td width="370">Malicious INF file. Points to QQMgr.dll</td>
</tr>
<tr>
<td width="73">ResN32.dat</td>
<td width="370">String pointing to path of encrypted core of malware.</td>
</tr>
<tr>
<td width="73">ResN32.dll</td>
<td width="370">Malicious DLL. Decrypts, decompresses, and loads core malware.</td>
</tr>
<tr>
<td width="73">tyeu.dat</td>
<td width="370">Encrypted plugin. Takes screenshots and collects Skype information.</td>
</tr>
<tr>
<td width="73">vnkd.dat</td>
<td width="370">Encrypted plugin. Finds files on removable drives on victim machine.</td>
</tr>
<tr>
<td width="73">dtl.dat</td>
<td width="370">Encrypted configuration information.</td>
</tr>
<tr>
<td width="73">glp.uin</td>
<td width="370">Plugin configuration information.</td>
</tr>
</tbody>
</table>
<p>You’ll notice that QQMgr* files are not listed in the original malware execution flow diagram. In the event the victim is running any of the following operating system versions, as well as either Kingsoft, Filseclab, or Tencent security products, the malware will be installed using an alternative method.</p>
<ul>
<li>Windows 2008 R2</li>
<li>Windows 7</li>
<li>Windows 2012</li>
<li>Windows 8</li>
</ul>
<p>In such a situation, the malware will find and run the built-in Microsoft Windows InfDefaultInstall.exe program, which will install a DLL via an INF file. Should Tencent be installed, the malware will execute the InfDefaultInstall.exe program with an argument of ‘QQMgr.inf’. Otherwise, it will use ‘hccutils.inf’ as an argument.</p>
<p>QQMgr.inf will install the QQMgr.dll, while hccutils.inf will install the hccutils.dll library. QQMgr.dll will set the following registry key:</p>
<p><em>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\Eupdate - %APPDATA%\Intel\ResN32.dll</em></p>
<p>The QQMgr.dll file has the following debug string found within it:</p>
<p><em>H:\WORK\PROJECT\InfInstallBypassUAC\Release\BypassUAC.pdb</em></p>
<p><span style="line-height: 1.5;">The hccutils.dll file is described later within this post.</span></p>
<p>After the malware drops the required files, by default the malware will spawn %APPDATA%\Intel\igfxtray.exe in a new process, which begins the second stage of the malware’s execution.</p>
<h4>Stage 2</h4>
<p>The igfxtray.exe is a legitimate Microsoft Windows executable that <a href="https://attack.mitre.org/wiki/DLL_side-loading" target="_blank">sideloads</a> the malicious hccutils.dll DLL file. This DLL has the following debug string embedded within it:</p>
<p><em>D:\WORK\T9000\hccutils_M4\Release\hccutils.pdb</em></p>
<p>Upon loading this malicious DLL, the malware will initially perform the same queries for security products that were witnessed in stage 1.</p>
<p>Three separate techniques for starting stage 3 are used depending on the properties of the victim.</p>
<p>The first technique is used if the victim meets the following criteria:</p>
<ul>
<li>Microsoft Windows 8 / Windows Server 2012 R2</li>
<li>DoctorWeb security product installed</li>
</ul>
<p>For this situation, the following registry key is set:</p>
<p><em>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\update - %SYSTEM%\rundll32.exe %APPDATA\Intel\ResN32.dll Run</em></p>
<p>This ensures that the ResN32.dll library will be run using the ‘Run’ exported function whenever the machine is rebooted.</p>
<p>The second technique is used if the victim meets any of the following sets of criteria:</p>
<ul>
<li>Microsoft Windows 8 / Windows Server 2012 R2</li>
<li>Not running Kingsoft, Tencent, or DoctorWeb security products</li>
</ul>
<ul>
<li>Microsoft Windows XP or lower</li>
<li>No security products installed, or running any of the following:
<ul>
<li>Sophos</li>
<li>GData</li>
<li>TrendMicro</li>
<li>AhnLab</li>
<li>Kaspersky</li>
</ul>
</li>
</ul>
<p>In these situations, the following persistence technique is used.</p>
<p><em>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs - %APPDATA%\Intel\ResN32.dll</em></p>
<p><em>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\LoadAppInit_DLLs – 0x1</em></p>
<p>Setting these registry keys both enables the AppInit_DLL functionality, and ensures that every user mode process that is spawned will load the ResN32.dll library. More information about this can be found <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd744762(v=vs.85).aspx" target="_blank">here</a>.</p>
<p>The third technique is used in any other situation. When this occurs, the malware will first identify the explorer.exe process identifier. It proceeds to inject the ResN32.dll library into this process.</p>
<p>At this point, the third stage of the malware family is loaded.</p>
<h4>Stage 3</h4>
<p>The third stage begins when the ResN32.dll file begins operating. This file contains the following debug string:</p>
<p><em>D:\WORK\T9000\ResN_M2\Release\ResN32.pdb</em></p>
<p>The ResN32.dll library begins by spawning a new thread that is responsible for the majority of the capabilities built into this sample. This thread begins by checking the operating system version, and once again runs a query on the various security products installed on the victim machine.</p>
<p>Under certain conditions, the following registry key is set, ensuring persistence across reboots:</p>
<p><em>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\update – c:\windows\system32\rundll32.exe %APPDATA\Intel\ResN32.dll Run</em></p>
<p>Following this, a new thread is created that is responsible for deleting previously written files. This thread creates the following mutex:</p>
<p><em>Global\\deletethread</em></p>
<p>It proceeds to attempt to delete the following files in an infinite loop until said files have been deleted:</p>
<ul>
<li>%STARTUP%\hccutils.dll</li>
<li>%STARTUP%\hccutil.dll</li>
<li>%STARTUP%\igfxtray.exe</li>
</ul>
<p>The ResN32.dll malware proceeds to read in the ResN32.dat file that was previously written to disk. This file contains a path to the hjwe.dat file, which is subsequently read in.</p>
<p>The data within the hjwe.dat file is decrypted using the RC4 algorithm, and subsequently decompressed using the LZMA algorithm. The following script can be used to decrypt the hjwe.dat file, along with the plugins that will be discussed later.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986b7cfbc7568916063" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import sys, pylzma
from base64 import *
from binascii import *
from struct import *

def rc4( data , key ):
  S = range(256)
  j = 0
  out = []
  for i in range(256):
    j = (j + S[i] + ord( key[i % len(key)] )) % 256
    S[i] , S[j] = S[j] , S[i]
  i = j = 0
  for char in data:
    i = ( i + 1 ) % 256
    j = ( j + S[i] ) % 256
    S[i] , S[j] = S[j] , S[i]
    out.append(chr(ord(char) ^ S[(S[i] + S[j]) % 256]))
  return ''.join(out)

f = open(sys.argv[1], 'rb')
fd = f.read()
f.close()

bytes_0_4, bytes_4_8, bytes_8_12, bytes_12_16 = unpack("&lt;IIII", fd[0:16])
if bytes_0_4 == 0xf7e4aa65:
  length = bytes_8_12
  if len(fd)-16 != length:
    print "[*] Possible error reading in length of data."
  key_size = 260
  key = fd[16:16+key_size]
  data = fd[16+key_size:]
  decrypted = rc4(data, key)
  decompressed = pylzma.decompress_compat(decrypted)
  f1 = open(sys.argv[1]+".decompressed", 'wb')
  f1.write(decompressed)
  f1.close
  print "[+] Wrote %s" % (sys.argv[1]+".decompressed")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-2">2</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-4">4</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-6">6</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-8">8</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-10">10</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-12">12</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-14">14</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-16">16</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-18">18</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-20">20</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-22">22</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-24">24</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-26">26</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-28">28</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-30">30</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-32">32</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-34">34</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-36">36</div><div class="crayon-num" data-line="crayon-671986b7cfbc7568916063-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbc7568916063-38">38</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986b7cfbc7568916063-1"><span class="crayon-e">import </span><span class="crayon-i">sys</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">pylzma</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-2"><span class="crayon-e">from </span><span class="crayon-e">base64 </span><span class="crayon-e ">import *</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-3"><span class="crayon-e">from </span><span class="crayon-e">binascii </span><span class="crayon-e ">import *</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-4"><span class="crayon-e">from </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e ">import *</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-6"><span class="crayon-e">def </span><span class="crayon-e">rc4</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">data</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">S</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">256</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">out</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">256</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">j</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">key</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">256</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">data</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">256</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">256</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">out</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-t">char</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>^<span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">S</span><span class="crayon-sy">[</span><span class="crayon-i">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-i">out</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-20">&nbsp;</div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-21"><span class="crayon-i">f</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-i">sys</span><span class="crayon-sy">.</span><span class="crayon-i">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-22"><span class="crayon-i">fd</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-23"><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-24">&nbsp;</div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-25"><span class="crayon-i">bytes_0_4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">bytes_4_8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">bytes_8_12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">bytes_12_16</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">"&lt;IIII"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">fd</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">:</span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-26"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">bytes_0_4</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-cn">0xf7e4aa65</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">length</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">bytes_8_12</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-28"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">fd</span><span class="crayon-sy">)</span>-<span class="crayon-cn">16</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-i">length</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"[*] Possible error reading in length of data."</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">key_size</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">260</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">key</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">fd</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">:</span><span class="crayon-cn">16</span>+<span class="crayon-i">key_size</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">data</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">fd</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span>+<span class="crayon-i">key_size</span><span class="crayon-sy">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-33"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">decrypted</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">rc4</span><span class="crayon-sy">(</span><span class="crayon-i">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">key</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">decompressed</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">pylzma</span><span class="crayon-sy">.</span><span class="crayon-e">decompress_compat</span><span class="crayon-sy">(</span><span class="crayon-i">decrypted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">f1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-i">sys</span><span class="crayon-sy">.</span><span class="crayon-i">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span>+<span class="crayon-s">".decompressed"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">f1</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-i">decompressed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986b7cfbc7568916063-37"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">f1</span><span class="crayon-sy">.</span><span class="crayon-e">close</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbc7568916063-38"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"[+] Wrote %s"</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">sys</span><span class="crayon-sy">.</span><span class="crayon-i">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span>+<span class="crayon-s">".decompressed"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>After this file has been decrypted and decompressed, it is written to a file in the %TEMP% directory with a file prefix of ‘____RES’. This file, which contains a Windows DLL, is then loaded into the current process. After the malicious library has been loaded, the previously written temporary file is deleted. This begins the last stage of the malware, which will load the core of the malware family.</p>
<h4>Stage 4</h4>
<p>Once the decrypted and decompressed hjwe.dat file is loaded, it begins by checking its parent process against the following list. If the parent process matches the following blacklist, the malicious DLL will exit without performing any malicious activities.</p>
<ul>
<li>winlogon.exe</li>
<li>csrss.exe</li>
<li>logonui.exe</li>
<li>ctfmon.exe</li>
<li>drwtsn32.exe</li>
<li>logonui.exe</li>
<li>explore.exe</li>
<li>System</li>
<li>Dbgview.exe</li>
<li>userinit.exe</li>
<li>lsass.exe</li>
<li>wmiprvse.exe</li>
<li>services.exe</li>
<li>inetinfo.exe</li>
<li>avp.exe</li>
<li>Rtvscan.exe</li>
</ul>
<p>The malware proceeds to collect the username of the victim, as well as the operating system version. It then compares its parent process against the following list of executables:</p>
<ul>
<li>winlogon.exe</li>
<li>csrss.exe</li>
<li>logonui.exe</li>
<li>ctfmon.exe</li>
<li>drwtsn32.exe</li>
<li>logonui.exe</li>
<li>System</li>
<li>Dwm.exe</li>
<li>QQPCRTP.exe</li>
<li>Tasking.exe</li>
<li>Taskhost.exe</li>
<li>Taskmgr.exe</li>
<li>Dbgview.exe</li>
<li>suerinit.exe</li>
<li>lsass.exe</li>
<li>wmiprvse.exe</li>
<li>services.exe</li>
<li>inetinfo.exe</li>
<li>avp.exe</li>
<li>Rtvscan.exe</li>
</ul>
<p>Notice the repeated check for the ‘logonui.exe’, as well as the overlap with the previous parent executable check, which implies sloppiness by the malware author.</p>
<p>After these checks are performed, the following mutex is created.</p>
<p><em>Global\\{A59CF429-D0DD-4207-88A1-04090680F714}</em></p>
<p>The following folders are then created:</p>
<ul>
<li>utd_CE31</li>
<li>XOLOADER</li>
<li>Update</li>
</ul>
<p>The path of these folders is determined by the version of Microsoft Windows running. The following possibilities exist:</p>
<ul>
<li>%ALLUSERSPROFILE%\Documents\My Document\</li>
<li>%PUBLIC%\Downloads\Update\</li>
</ul>
<p>At this point, the malware will read in the dtl.dat file, which contains configuration data. Data contained with this file starting at offset 0x20 is xor-encrypted using a single-byte key of 0x5F. The following script can be used to extract the IP address and port for the C2 server from this file.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986b7cfbcf346159338" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from struct import *
import sys, socket

def int2ip(addr):                                                              
  return socket.inet_ntoa(pack("!I", addr))       

config_file = sys.argv[1]
f = open(config_file, 'rb')
fd = f.read()
f.close()

decrypted = ""
for x in fd[32:]:
  decrypted += chr(ord(x) ^ 0x5f)

port = unpack("&lt;I", decrypted[4:8])[0]
ip = int2ip(unpack("&gt;I", decrypted[8:12])[0])

print "IP Address : %s" % ip
print "Port       : %d" % port</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-2">2</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-4">4</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-6">6</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-8">8</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-10">10</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-12">12</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-14">14</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-16">16</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-18">18</div><div class="crayon-num" data-line="crayon-671986b7cfbcf346159338-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986b7cfbcf346159338-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986b7cfbcf346159338-1"><span class="crayon-e">from </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e ">import *</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-2"><span class="crayon-e">import </span><span class="crayon-i">sys</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">socket</span></div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-4"><span class="crayon-e">def </span><span class="crayon-e">int2ip</span><span class="crayon-sy">(</span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">socket</span><span class="crayon-sy">.</span><span class="crayon-e">inet_ntoa</span><span class="crayon-sy">(</span><span class="crayon-e">pack</span><span class="crayon-sy">(</span><span class="crayon-s">"!I"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">addr</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-6">&nbsp;</div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-7"><span class="crayon-i">config_file</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">sys</span><span class="crayon-sy">.</span><span class="crayon-i">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-8"><span class="crayon-i">f</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-i">config_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-9"><span class="crayon-i">fd</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-10"><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-12"><span class="crayon-i">decrypted</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-13"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">fd</span><span class="crayon-sy">[</span><span class="crayon-cn">32</span><span class="crayon-sy">:</span><span class="crayon-sy">]</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">decrypted</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-i">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>^<span class="crayon-h"> </span><span class="crayon-cn">0x5f</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-16"><span class="crayon-i">port</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">"&lt;I"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">decrypted</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-17"><span class="crayon-i">ip</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">int2ip</span><span class="crayon-sy">(</span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt;I"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">decrypted</span><span class="crayon-sy">[</span><span class="crayon-cn">8</span><span class="crayon-sy">:</span><span class="crayon-cn">12</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-18">&nbsp;</div><div class="crayon-line" id="crayon-671986b7cfbcf346159338-19"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"IP Address : %s"</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-e">ip</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986b7cfbcf346159338-20"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : %d"</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-i">port</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The malware will then read in and parse the included plugin configuration information, which is found within the glp.uin file that was previously dropped. These included plugins are encrypted and compressed using the same method witnessed by the hjwe.dat file previously. The previously included script can be used to decrypt and decompress the following three plugin files:</p>
<ul>
<li>tyeu.dat</li>
<li>vnkd.dat</li>
<li>qhnj.dat</li>
</ul>
<p>These three plugins are subsequently loaded after being decrypted and decompressed. An overview of these plugins can be found later in this post.</p>
<p>The malware proceeds to create the following event:</p>
<p><em>Global\\{34748A26-4EAD-4331-B039-673612E8A5FC}</em></p>
<p>Additionally, the following three mutexes are created:</p>
<p><em>Global\\{3C6FB3CA-69B1-454f-8B2F-BD157762810E}<br />
</em><em>Global\\{43EE34A9-9063-4d2c-AACD-F5C62B849089}<br />
</em><em>Global\\{A8859547-C62D-4e8b-A82D-BE1479C684C9}</em></p>
<p>The malware will spawn a new thread to handle network communication. The following event is created prior to this communication occurring:</p>
<p><em>Global\\{EED5CA6C-9958-4611-B7A7-1238F2E1B17E}</em></p>
<p>The malware includes proxy support in the event that the victim is behind a web proxy. Network traffic occurs over a binary protocol on the port specified within the configuration. Traffic is xor-encrypted with a single-byte key of 0x55 in an attempt to bypass any network security products that may be in place. Once decrypted, the following traffic is sent by the malware.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-4.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12056" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-4-500x275.png" alt="T9000 4" width="500" height="275" /></a></p>
<p style="text-align: center;">Figure 1: Decrypted data sent by malware</p>
<p>As we can see from the above image, the malware will send out an initial beacon, followed by various collected information from the victim machine. The following information is exfiltrated:</p>
<ul>
<li>Installed security products</li>
<li>System time</li>
<li>Build Number</li>
<li>CPU Architecture (32-bit/64-bit)</li>
<li>MAC Address</li>
<li>IP Address</li>
<li>Hostname</li>
<li>Username</li>
<li>Parent executable name</li>
<li>Plugin configuration information</li>
</ul>
<p>The malware is configured to receive a number of commands. The following command functionalities have been identified.</p>
<table style="height: 232px;" width="491">
<tbody>
<tr>
<td width="77"><strong>Command</strong></td>
<td width="365"><strong>Description</strong></td>
</tr>
<tr>
<td width="77">DIR</td>
<td width="365">Directory listing</td>
</tr>
<tr>
<td width="77">LIR</td>
<td width="365">Drive listing</td>
</tr>
<tr>
<td width="77">RUN</td>
<td width="365">Execute command (Either interactively or not)</td>
</tr>
<tr>
<td width="77">CIT</td>
<td width="365">Send command to interactively spawned command</td>
</tr>
<tr>
<td width="77">CFI</td>
<td width="365">Kill interactively spawned process</td>
</tr>
<tr>
<td width="77">DOW</td>
<td width="365">Download file</td>
</tr>
<tr>
<td width="77">UPL</td>
<td width="365">Upload file</td>
</tr>
<tr>
<td width="77">DEL</td>
<td width="365">Delete file</td>
</tr>
<tr>
<td width="77">DTK</td>
<td width="365">Retrieve statistics for file</td>
</tr>
<tr>
<td width="77">ERR</td>
<td width="365">Null command</td>
</tr>
</tbody>
</table>
<p>Additionally, the following commands have been identified, however, their functionalities have yet to be fully discovered.</p>
<ul>
<li>PNG</li>
<li>PLI</li>
<li>PLD</li>
<li>FDL</li>
<li>OSC</li>
<li>OSF</li>
<li>SDA</li>
<li>QDA</li>
<li>TFD</li>
<li>SDS</li>
<li>SCP</li>
<li>FMT</li>
<li>STK</li>
<li>CRP</li>
</ul>
<h4>Plugin #1 – tyeu.dat</h4>
<p>When this plugin is called with the default exported function, it will create the following mutex:</p>
<p><em>{CE2100CF-3418-4f9a-9D5D-CC7B58C5AC62}</em></p>
<p>When called with the SetCallbackInterface function export, the malicious capabilities of the plugin begin. The plugin begins by collecting the username of the running process, and determining if it is running under the SYSTEM account. If running as SYSTEM, the plugin will associate the active desktop with the plugin’s thread.</p>
<p>The plugin proceeds to create the following named event:</p>
<p><em>Global\\{EED5CA6C-9958-4611-B7A7-1238F2E1B17E}</em></p>
<p>Multiple threads are then spawned to handle various actions. The first thread is responsible for taking a screenshot of the desktop of the victim machine. This screenshot data is both compressed and encrypted using a single-byte xor key of 0x5F. This data is written to one of the following files:</p>
<p><em>%PUBLIC%\Downloads\Update\S[random].dat<br />
</em><em>%ALLUSERSPROFILE%\Documents\My Document\S[random].dat</em></p>
<p>The random data is generated via the current system time. Additionally, when a screenshot is written, one of the following log files has data appended to it:</p>
<p><em>%PUBLIC%\Downloads\Update\Log.txt<br />
</em><em>%ALLUSERSPROFILE%\Documents\My Document\Log.txt</em></p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-5.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12057" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-5-500x148.png" alt="T9000 5" width="500" height="148" /></a></p>
<p style="text-align: center;">Figure 2: Example data found within Log.txt file</p>
<p>A second thread is responsible for monitoring the foreground window every 20 seconds. The thread will target the window names set within the plugin configuration. In this particular instance, the malware will target the ‘notepad’ process.</p>
<p>When this process is discovered to be running in the foreground window, the malware will take a screenshot of this window. The data is compressed and encrypted using a single-byte xor key of 0x5F. This data is written to one of the following files:</p>
<p><em>%PUBLIC%\Downloads\Update\W[random].dat<br />
</em><em>%ALLUSERSPROFILE%\Documents\My Document\W[random].dat</em></p>
<p>Like the previous thread, this one attempts to write another log file to the disk. However, due to a bug within the code of this plugin, the malware author attempts to append the ‘C:\\Windows\\Temp\\Log.txt’ string to the path, resulting in an inaccessible file path. In the event this bug did not exist, the following example data would be written:</p>
<p><em>08:37:49 2000 [4] PrintKeyTitleWnd: ===&gt;&gt; Process ID : 2000</em></p>
<p>The third and final thread spawned by this plugin is responsible for collecting information from the Skype program. The malware will use the built-in Skype API to accomplish this. This only takes places if both Skype is running and the victim is logged into Skype. It makes calls to the following functions:</p>
<ul>
<li>SkypeControlAPIDiscover</li>
<li>SkypeControlAPIAttach</li>
</ul>
<p>When hooking into the Skype API, the victim is presented with the following dialog:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-6.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12058" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-6-500x44.png" alt="T9000 6" width="500" height="44" /></a></p>
<p style="text-align: center;">Figure 3: Skype API access request</p>
<p>The victim must explicitly allow the malware to access Skype for this particular functionality to work. However, since a legitimate process is requesting access, the user may find him- or herself allowing this access without realizing what is actually happening.</p>
<p>Once enabled, the malware will record video calls, audio calls, and chat messages. Audio and video files are stored in the following folder:</p>
<p><em>%APPDATA%\Intel\Skype</em></p>
<p style="text-align: left;">Temporary audio and video files are stored within the audio and video sub-folders respectively. After a call is finished, this data is compressed and encrypted using the same techniques previously witnessed. These files are stored in randomly named .dat files within the Skype folder.</p>
<p style="text-align: left;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-7.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12059" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-7-500x223.png" alt="T9000 7" width="500" height="223" /></a></p>
<p>When decrypted, we can see that the malware periodically takes images of the video calls. Audio calls are stored as .wav files.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-8.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12060" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-8-500x319.png" alt="T9000 8" width="500" height="319" /></a></p>
<p style="text-align: center;">Figure 4: A lonely malware reverser is captured on video by the malicious plugin</p>
<p>The original name for this plugin is ‘CaptureDLL.dll’. This is aptly named, as we see that this plugin has the following functionality:</p>
<ul>
<li>Capture full desktop screenshots</li>
<li>Capture window screenshots of targeted processes</li>
<li>Capture Skype audio, video, and chat messages</li>
</ul>
<h4>Plugin #2 – vnkd.dat</h4>
<p>The vnkd.dat plugin has the following debug path, leading us to believe that the original name for this plugin is ‘FlashDiskThief’:</p>
<p><em>e:\WORK\Project\T9000\Windows\Target\FlashDiskThief.pdb</em></p>
<p>When loaded with the default DllEntryPoint exported function, it will create the following mutex:</p>
<p><em>Global\\{6BB1120C-16E9-4c91-96D5-04B42D1611B4}</em></p>
<p>Like the other plugins associated with this malware, the majority of the functionality for this malware resides within the SetCallbackInterface exported function. This function spawns a new thread that begins by registering a new window with a class name and window name of ‘xx’.</p>
<p>The plugin proceeds to iterate through all connected drives on the system, looking for removable drives.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-9.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12061" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-9-500x122.png" alt="T9000 9" width="500" height="122" /></a></p>
<p style="text-align: center;">Figure 5. Plugin check for removable drives</p>
<p>Should a removable drive be discovered, the plugin will seek any files residing on this device based on the plugin’s configured list. In this particular instance, the malware will seek out the following file types:</p>
<ul>
<li>*.doc</li>
<li>*.ppt</li>
<li>*.xls</li>
<li>*.docx</li>
<li>*.pptx</li>
<li>*.xlsx</li>
</ul>
<p>If one of these file types is found, the malware will create a copy of the file in one of the following paths:</p>
<p><em>%PUBLIC%\Downloads\Update\D[random].tmp<br />
%ALLUSERSPROFILE%\Documents\My Document\D[random].tmp</em></p>
<p>The data found within this file is encrypted using a single-byte xor key of 0x41. The file header structure, with the underlying data still encrypted, can be seen below.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-10.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12062" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-10-500x217.png" alt="T9000 10" width="500" height="217" /></a></p>
<p style="text-align: center;">Figure 6: File structure prior to decryption</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-11.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12063" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/T9000-11-500x186.png" alt="T9000 11" width="500" height="186" /></a></p>
<p style="text-align: center;">Figure 7: File structure post decryption</p>
<p>This concludes the functionality of the vnkd.dat plugin, or FlaskDiskThief as it’s known by the malware’s author. While specific in nature, this plugin allows attackers to collect files being passed around from one machine to another via removable drives.</p>
<h4>Plugin #3 – qhnj.dat</h4>
<p>This particular plugin appears to have an original filename of ‘kplugin.dll’ due to debugging information found within the file. The qhnj.dat plugin is responsible for hooking a number of common Microsoft Windows API calls, and logging the results.</p>
<p>The following functions are hooked by this plugin:</p>
<ul>
<li>ImmGetCompositionStringA</li>
<li>ImmGetCompositionStringW</li>
<li>CreateFileW</li>
<li>DeleteFileW</li>
<li>CopyFileExW</li>
<li>MoveFileWithProgressW</li>
<li>CreateDirectoryW</li>
<li>CreateDirectoryExW</li>
<li>RemoveDirectoryW</li>
<li>GetClipboardData</li>
<li>CryptEncrypt</li>
<li>CryptDecrypt</li>
</ul>
<p>The plugin is most likely hooking the ImmGetCompositionString* functions in order to collect information about Unicode characters on the victim machine, such as Chinese, Japanese, and Korean.</p>
<p>Hooking the various file and directory operations allows the malware to log what file changes are occurring on the system. When a file is created, copied, moved, or deleted on the system, the malware will check the directory of said file against the following blacklist:</p>
<ul>
<li>\\\\.\\</li>
<li>:\\program files\\</li>
<li>\\AppData\\</li>
<li>\\temporary internet files\\</li>
<li>\\application data\\</li>
<li>\\Local Settings\\</li>
<li>\\cookies\\</li>
<li>\\temp\\</li>
<li>\\history\\</li>
</ul>
<p>Additionally, the filename is compared against the ‘.tmp’ extension to ensure a temporary file is ignored.</p>
<p>Should the file meet the required criteria, this data is logged. Additionally, all folder modifications and clipboard data are logged as well.</p>
<p>The Crypt* functions allow the malware to collect sensitive encrypted data sent to and from the victim machine. This is especially useful when viewing network traffic, allowing the attackers to potentially gain access to remote systems used by the victim.</p>
<p>All of the data logged by the qhnj.dat plugin file is stored in one of the following file paths. Data is encrypted using a single-byte XOR key of 0x79.</p>
<p><em>%PUBLIC%\Downloads\Update\uai[random].tmp<br />
</em><em>%ALLUSERSPROFILE%\Documents\My Document\uai[random].tmp</em></p>
<p>This last plugin allows the attackers to record important actions taken by the victim, which in turn may allow them to gain additional access as well as insight into the victim’s actions.</p>
<h3>Conclusion</h3>
<p>T9000 appears to be the latest version of this Trojan, which has been partially exposed in previous reports. In 2013, Cylance published a report on a group they named “<a href="https://blog.cylance.com/grand-theft-auto-panda" target="_blank">Grand Theft Auto Panda</a>”, which includes some details on the T5000 version of this Trojan. <a href="https://www.fireeye.com/blog/threat-research/2014/03/spear-phishing-the-news-cycle-apt-actors-leverage-interest-in-the-disappearance-of-malaysian-flight-mh-370.html" target="_blank">FireEye researchers</a> also noted that the malware was used in an attack in 2014 using a lure related to the disappearance of Malaysian flight MH370.</p>
<p>The author of this backdoor has gone to great lengths to avoid being detected and to evade the scrutiny of the malware analysis community. We hope that sharing the details of how this tool works as well as the indicators in the section below will help others defend themselves against attacks using this tool.</p>
<p>In a future report, we will detail the infrastructure used by the variants of the malware we have identified and discuss the methods attackers use to infect systems with it.</p>
<p>Palo Alto Networks customers are protected from T9000/T5000 attacks through our next-generation security platform, including the following.</p>
<ul>
<li><strong>Threat Prevention</strong> signatures for the software vulnerabilities listed in this report are available to detect the exploit files during delivery.</li>
<li><strong>Traps</strong> is capable of preventing exploitation of the vulnerabilities exploited to install T9000.</li>
<li><strong>WildFire</strong> classifies all of the malware described in this report as malicious.</li>
<li><strong>Anti-malware signatures</strong> for the files listed in this report.</li>
<li><strong>AutoFocus</strong> users can identify the malware discussed in this report with the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.T5000" target="_blank">T5000 tag</a></li>
</ul>
<h3>Indicators of Compromise</h3>
<p><strong>Hashes</strong></p>
<p>RTF File, d5fa43be20aa94baf1737289c5034e2235f1393890fb6f4e8d4104565be52d8c<br />
QQMGr.dll, bf1b00b7430899d33795ef3405142e880ef8dcbda8aab0b19d80875a14ed852f<br />
QQMGR.inf, ace7e3535f2f1fe32e693920a9f411eea21682c87a8e6661d3b67330cd221a2a<br />
ResN32.dat, aa28db689f73d77babd1c763c53b3e63950f6a15b7c1a974c7481a216dda9afd<br />
ResN32.dll, 1cea4e49bd785378d8beb863bb8eb662042dffd18c85b8c14c74a0367071d9a7<br />
hqwe.dat, bb73261072d2ef220b8f87c6bb7488ad2da736790898d61f33a5fb7747abf48b<br />
hqwe.dat.decrypted, 7daf3c3dbecb60bee3d5eb3320b20f2648cf26bd9203564ce162c97dcb132569<br />
hccutils.dll, 3dfc94605daf51ebd7bbccbb3a9049999f8d555db0999a6a7e6265a7e458cab9<br />
hccutils.inf, f05cd0353817bf6c2cab396181464c31c352d6dea07e2d688def261dd6542b27<br />
igfxtray.exe, 21a5818822a0b2d52a068d1e3339ed4c767f4d83b081bf17b837e9b6e112ee61<br />
qhnj.dat, c61dbc7b51caab1d0353cbba9a8f51f65ef167459277c1c16f15eb6c7025cfe3<br />
qhnj.dat.decrypted, 2b973adbb2addf62cf36cef9975cb0193a7ff0b960e2cff2c80560126bee6f37<br />
tyeu.dat, e52b5ed63719a2798314a9c49c42c0ed4eb22a1ac4a2ad30e8bfc899edcea926<br />
tyeu.dat.decrypted, 5fc3dc25276b01d6cb2fb821b83aa596f1d64ae8430c5576b953e3220a01d9aa<br />
vnkd.dat, c22b40db7f9f8ebdbde4e5fc3a44e15449f75c40830c88932f9abd541cc78465<br />
vnkd.dat.decrypted, 157e0a9323eaaa911b3847d64ca0d08be8cd26b2573687be461627e410cb1b3f<br />
dtl.dat, 00add5c817f89b9ec490885be39398f878fa64a5c3564eaca679226cf73d929e<br />
glp.uin, 3fa05f2f73a0c44a5f51f28319c4dc5b8198fb25e1cfcbea5327c9f1b3a871d4</p>
<p><strong>Mutexes</strong></p>
<p>820C90CxxA1B084495866C6D95B2595xx1C3<br />
Global\\deletethread<br />
Global\\{A59CF429-D0DD-4207-88A1-04090680F714}<br />
Global\\{3C6FB3CA-69B1-454f-8B2F-BD157762810E}<br />
Global\\{43EE34A9-9063-4d2c-AACD-F5C62B849089}<br />
Global\\{A8859547-C62D-4e8b-A82D-BE1479C684C9}<br />
{CE2100CF-3418-4f9a-9D5D-CC7B58C5AC62}<br />
Global\\{6BB1120C-16E9-4c91-96D5-04B42D1611B4}</p>
<p><strong>Named Events</strong></p>
<p>Global\\{34748A26-4EAD-4331-B039-673612E8A5FC}<br />
Global\\{EED5CA6C-9958-4611-B7A7-1238F2E1B17E}</p>
<p><strong>File Modifications</strong></p>
<p>%TEMP%\~tmp.doc<br />
%APPDATA%\Intel\avinfo<br />
%APPDATA%\Intel\Data\dtl.dat<br />
%APPDATA%\Intel\Data\glp.uin<br />
%APPDATA%\Intel\Data\<br />
%APPDATA%\Intel\~1<br />
%APPDATA%\Intel\hccutils.dll<br />
%APPDATA%\Intel\hccutils.inf<br />
%APPDATA%\Intel\hjwe.dat<br />
%APPDATA%\Intel\igfxtray.exe<br />
%APPDATA%\Intel\qhnj.dat<br />
%APPDATA%\Intel\QQMgr.dll<br />
%APPDATA%\Intel\QQMgr.inf<br />
%APPDATA%\Intel\ResN32.dll<br />
%APPDATA%\Intel\ResN32.dat<br />
%APPDATA%\Intel\tyeu.dat<br />
%APPDATA%\Intel\vnkd.dat<br />
%STARTUP%\hccutils.dll<br />
%STARTUP%\hccutil.dll<br />
%STARTUP%\igfxtray.exe<br />
%ALLUSERSPROFILE%\Documents\My Document\utd_CE31<br />
%ALLUSERSPROFILE%\Documents\My Document\XOLOADER<br />
%ALLUSERSPROFILE%\Documents\My Document\update<br />
%ALLUSERSPROFILE%\Documents\My Document\Log.txt<br />
%PUBLIC%\Downloads\Update\utd_CE31<br />
%PUBLIC%\Downloads\Update\XOLOADER<br />
%PUBLIC%\Downloads\Update\update<br />
%PUBLIC%\Downloads\Update\Log.txt<br />
%APPDATA%\Intel\Skype</p>
<p><strong>Registry Modifications</strong></p>
<p>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\Eupdate - %APPDATA%\Intel\ResN32.dll<br />
HKLM\Software\Microsoft\Windows\CurrentVersion\Run\update - %SYSTEM%\rundll32.exe %APPDATA\Intel\ResN32.dll Run<br />
HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs - %APPDATA%\Intel\ResN32.dll<br />
HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\LoadAppInit_DLLs – 0x1<br />
HKLM\Software\Microsoft\Windows\CurrentVersion\Run\update – c:\windows\system32\rundll32.exe %APPDATA\Intel\ResN32.dll Run</p>
<p><strong>Command and Control</strong></p>
<p><strong> </strong>198.55.120[.]143:8080</p>
      
              </div>
              <!--<span class="post__date">Updated 1 November, 2018 at 12:04 PM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/skype/" role="link" title="Skype" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:tags:Skype">Skype</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/t5000/" role="link" title="T5000" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:tags:T5000">T5000</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/t9000/" role="link" title="T9000" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:tags:T9000">T9000</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/trojans/" role="link" title="Trojans" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:tags:Trojans">Trojans</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/" role="link" title="Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:article-nav:Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?"> 
            <span>Next: Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:sidebar:related-articles:Kazuar: Multiplatform Espionage Backdoor with API Access">
                      Kazuar: Multiplatform Espionage Backdoor with API Access                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:sidebar:related-articles:Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?">
                      Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/scarlet-mimic-years-long-espionage-targets-minority-activists/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:sidebar:related-articles:Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists">
                      Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Malware Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of a campaign like Contagious Interview. Digital graphic of a glowing globe with network connections and data streams, symbolizing global connectivity and technology advancements." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                    <h4 class="post-title">Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/social-engineering/" title="social engineering" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:social engineering">Social engineering</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Python">Python</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" title="Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider"  data-card-link="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-video-cta-tracking="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:card:video-modal:Read the article" data-video-title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
              <div class="card-media has-video" data-video="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg">
                              <figure>
                <img width="718" height="440" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg" class="attachment-medium size-medium" alt="A pictorial representation of machine learning detecting vulnerability scanning. A Black man using a tablet with a background of illuminated city buildings at night." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg 718w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-1143x700.jpg 1143w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-768x470.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg 1505w" sizes="(max-width: 718px) 100vw, 718px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
                    <h4 class="post-title">Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" title="Machine Learning" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Machine Learning">Machine Learning</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of keylogger malware like KLogEXE and FPSpy. Person working on a laptop with lines of code displayed on the screen, with a blurred effect indicating motion or activity, surrounded by a vivid blue and red lighting." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                    <h4 class="post-title">Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/keylogger/" title="Keylogger" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Keylogger">Keylogger</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" title="Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of SnipBot. Digital abstract background featuring binary code and technology symbols with a blue glow in the shape of a skull." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Inside SnipBot: The Latest RomCom Malware Variant">
                    <h4 class="post-title">Inside SnipBot: The Latest RomCom Malware Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/romcom/" title="RomCom" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:RomCom">RomCom</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" title="Inside SnipBot: The Latest RomCom Malware Variant" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of a red team tool like Splinter. A digital illustration showing a 3D brain model surrounded by rising data columns on a circuit board, representing advanced artificial intelligence technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool">
                    <h4 class="post-title">Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/red-teaming-tool/" title="red teaming tool" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:red teaming tool">Red teaming tool</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/pentest-tool/" title="pentest tool" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:pentest tool">Pentest tool</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" title="Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT groups from North Korea. The silhouette of two fish and the Pisces constellation inside an orange abstract planet, surrounded by two larger blue fish. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors">
                    <h4 class="post-title">Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Cryptocurrency">Cryptocurrency</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" title="Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Illustrative image featuring two fish and the Pisces constellation superimposed on a stylized, abstract background with flowing purple waves and a starry night sky." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Threat Assessment: North Korean Threat Groups:High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Threat Assessment: North Korean Threat Groups">
                    <h4 class="post-title">Threat Assessment: North Korean Threat Groups</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Threat Assessment: North Korean Threat Groups:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-access-trojan/" title="Remote Access Trojan" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Threat Assessment: North Korean Threat Groups:Remote Access Trojan">Remote Access Trojan</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/finance/" title="Finance" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Threat Assessment: North Korean Threat Groups:Finance">Finance</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" title="Threat Assessment: North Korean Threat Groups" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Threat Assessment: North Korean Threat Groups:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of Stately Taurus&#039; updated TTPs. Illustration of a bull&#039;s head and the Taurus constellation inside a stylized orange moon, set against the profile of a much larger bull&#039;s head. Shooting stars are on the dark background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Chinese APT Abuses VSCode to Target Government in Asia">
                    <h4 class="post-title">Chinese APT Abuses VSCode to Target Government in Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" title="Chinese APT Abuses VSCode to Target Government in Asia" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of malware such as WikiLoader. Red and blue digital data flowing from microchips on a circuit board, representing high-tech computing." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant">
                    <h4 class="post-title">Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/malvertising/" title="malvertising" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:malvertising">Malvertising</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:DLL Sideloading">DLL Sideloading</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" title="Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT Fighting Ursa. The silhouette of a bear and the Ursa constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple claw marks, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Fighting Ursa Luring Targets With Car for Sale:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Fighting Ursa Luring Targets With Car for Sale">
                    <h4 class="post-title">Fighting Ursa Luring Targets With Car for Sale</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Fighting Ursa Luring Targets With Car for Sale:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/apt28/" title="APT28" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Fighting Ursa Luring Targets With Car for Sale:APT28">APT28</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/fancy-bear/" title="Fancy Bear" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Fighting Ursa Luring Targets With Car for Sale:Fancy Bear">Fancy Bear</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" title="Fighting Ursa Luring Targets With Car for Sale" role="link" data-page-track="true" data-page-track-value="t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques:related-resources:Fighting Ursa Luring Targets With Car for Sale:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
