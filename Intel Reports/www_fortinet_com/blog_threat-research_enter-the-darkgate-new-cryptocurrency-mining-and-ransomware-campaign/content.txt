
    <!DOCTYPE HTML>
    <html lang="en" data-template="post-page teal-layer">
    <head>
        
        
        
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/visitorapi.min.js"/>
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/at.js"/>
            <script>

                   ;(function(win, doc, style, timeout) {
                   var STYLE_ID = 'at-body-style';
                   function getParent() {
                      return doc.getElementsByTagName('head')[0];
                   }
                   function addStyle(parent, id, def) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.createElement('style');
                      style.id = id;
                      style.innerHTML = def;
                      parent.appendChild(style);
                   }
                   function removeStyle(parent, id) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.getElementById(id);
                      if (!style) {
                      return;
                      }
                      parent.removeChild(style);
                   }
                   addStyle(getParent(), STYLE_ID, style);
                   setTimeout(function() {
                      removeStyle(getParent(), STYLE_ID);
                   }, timeout);
                   }(window, document, "body {opacity: 0 !important}", 3000));
                </script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/visitorapi.min.js"></script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/at.js"></script>
        
        
    <meta charset="UTF-8"/>
    <title>Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign</title>
    <meta name="keywords" content="ransomware,FortiGuard Labs Threat Research,Cybersecurity Architect,DarkGate"/>
    <meta name="description" content="Learn about an active and stealthy cryptocurrency mining and ransomware campaign infecting targets in Spain and France which leverages multiple bypass techniques to evade detection by traditional AV."/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign"/>
<meta property="og:url" content="https://www.fortinet.com/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Learn about an active and stealthy cryptocurrency mining and ransomware campaign infecting targets in Spain and France which leverages multiple bypass techniques to evade detection by traditional A…"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-images/dark-gate-ensilo-blog/Picture8.png"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Adi Zeligson and Rotem Kerner"/>

    <meta property="article:section" content="FortiGuard Labs Threat Research"/>


    <meta property="article:published_time" content="2018-11-13T08:00:00.000Z"/>


    <meta property="article:tag" content="ransomware"/>

    <meta property="article:tag" content="Cybersecurity Architect"/>

    <meta property="article:tag" content="DarkGate"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>

<link rel="canonical" href="https://www.fortinet.com/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign"/>










    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.900b148ab7b87024003111a1245cca9c.css" type="text/css">





<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    



        <!-- BE IXF: BE IXF: Place getHeadOpen just inside of the head tag -->
        
        
<!-- be_ixf, sdk, gho-->
<meta name="be:sdk" content="java_sdk_1.6.7" />
<meta name="be:timer" content="74ms" />
<meta name="be:norm_url" content="https://www.fortinet.com/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign" />
<meta name="be:capsule_url" content="https://ixfd1-api.bc0a.com/api/ixf/1.0.0/get_capsule/f00000000310757/048500955" />
<meta name="be:api_dt" content="pny_2024; pnm_10; pnd_22; pnh_11; pnmh_14; pn_epoch:1729620876275" />
<meta name="be:mod_dt" content="pny_1969; pnm_12; pnd_31; pnh_16; pnmh_00; pn_epoch:0" />
<meta name="be:orig_url" content="https://www.fortinet.com/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign" />
<meta name="be:messages" content="35720" /><script type='text/javascript'>
if (window.BEJSSDKObserver === undefined) {
  (function(BEJSSDKObserver, $, undefined) {
    var observer = void 0;
    var listeners = [];
    var readySet = [];
    var doc = window.document;
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;

    function checkSelector(selector, fn, indexList) {
      var elements = doc.querySelectorAll(selector);
  /**
    issues on IE @see https://www.codesd.com/item/javascript-es6-not-a-function-error.html
    elements = Array.from(elements);

    */
    for (var i = 0, len = elements.length; i < len; i++) {
      /* -1 means all instances */
      if (indexList != -1 && !(i in indexList)) {
        continue;
      }
      var element = elements[i];
      for (var j = 0; j < readySet.length; j++) {
        if (readySet[j] == element.className || readySet[j] == element.id) {
          return;
        }
      }
      if (element.className) {
        readySet.push(element.className);
      }
      if (element.id) {
        readySet.push(element.id);
      }

      if (!element.ready || MutationObserver==null) {
        element.ready = true;
        fn.call(element, element);
      }
    }
  }

  function checkListeners() {
    listeners.forEach(function (listener) {
      return checkSelector(listener.selector, listener.fn, listener.indexList);
    });
  }

  function removeListener(selector, fn) {
    var i = listeners.length;
    while (i--) {
      var listener = listeners[i];
      if (listener.selector === selector && listener.fn === fn) {
        listeners.splice(i, 1);
        if (!listeners.length && observer) {
          observer.disconnect();
          observer = null;
        }
      }
    }
  }

/**
 * Fire event on first js selector
 * @param selector string to watch on
 * @param fn       callback function
 * @param index_list can be undefined which means only first one
 *                   or -1 which means all
 *                   or a list of allowable indexes
 */
 BEJSSDKObserver.jsElementReady = function(selector, fn, index_list) {
  if (index_list === undefined) {
    index_list = [];
    index_list.push(0);
  }

  if (MutationObserver != null) {
    if (!observer) {
      observer = new MutationObserver(checkListeners);
      observer.observe(doc.documentElement, {
        childList: true,
        subtree: true
      });
    }
    listeners.push({ selector: selector, fn: fn, indexList: index_list });
  } else {
    /* <= IE8 */
    if (!document.addEventListener) {
      /* log("<=IE8 attachEvent assignment"); */
      document.addEventListener = document.attachEvent;
    }
    document.addEventListener("DOMContentLoaded", function(event) {
      var elements = doc.querySelectorAll(selector);
      for (var i = 0, len = elements.length; i < len; i++) {
        /* -1 means all instances */
        if (index_list != -1 && !(i in index_list)) {
          continue;
        }
        var element = elements[i];
        element.ready = true;
        fn.call(element, element);
      }
    });
  }

  checkSelector(selector, fn, index_list);
  return function () {
    return removeListener(selector, fn);
  };
};
}(window.BEJSSDKObserver = window.BEJSSDKObserver || {}));
}
var jsElementReady = window.BEJSSDKObserver.jsElementReady;

if (window.BELinkBlockGenerator === undefined) {
  (function(BELinkBlockGenerator, $, undefined) {
    BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = 100;
    BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = 200;

    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE = 0;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE = 1;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE = 2;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE = 3;

    BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE = 0;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_POST_APPEND_ELEMENT = 1;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT = 2;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT = 3;

    BELinkBlockGenerator.setMaximumHeadlineLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = length;
    };

    BELinkBlockGenerator.setMaximumDescriptionLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = length;
    };

    BELinkBlockGenerator.generateIndividualLinks = function(parentElement, linkStructure, link) {
      var link_level_element_tag = linkStructure[0];
      var link_level_element = document.createElement(link_level_element_tag);
      var link_attribute_dictionary = linkStructure[1];
      var allowable_elements = linkStructure[2];
      var children_link_structures = linkStructure[3];
      for (var link_attribute_key in link_attribute_dictionary) {
        link_level_element.setAttribute(link_attribute_key, link_attribute_dictionary[link_attribute_key]);
      }

      var added_something = false;
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE)>=0) {
        link_level_element.setAttribute('href', link.url);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE)>=0 && link.h1) {
        var headline_text = link.h1;
        if (headline_text.length > BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) {
          headline_text = headline_text.substring(0, BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) + '...';
        }
        var text_node = document.createTextNode(headline_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE)>=0 && link.desc) {
        var desc_text = link.desc;
        if (desc_text.length > BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) {
          desc_text = desc_text.substring(0, BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) + '...';
        }
        var text_node = document.createTextNode(desc_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE)>=0 && link.image) {
        link_level_element.setAttribute('src', link.image);
        added_something = true;
      }
/**
    don't emit for empty links, desc, headline, image
    except for parent structures where allowable_length=0
    */
    if (!added_something && allowable_elements.length != 0) {

      return;
    }
    /* go depth first */
    for (var childrenIndex=0; childrenIndex<children_link_structures.length; childrenIndex++) {
      var childLinkStructure = children_link_structures[childrenIndex];
      BELinkBlockGenerator.generateIndividualLinks(link_level_element, childLinkStructure, link);
    }
    parentElement.appendChild(link_level_element);
  };

  BELinkBlockGenerator.insertLinkBlocks = function(targetElement, replacementStrategy, overallStructure, linkStructure, links,
                                                   titleStructure) {
    if (targetElement == null) {
      return;
    }

    if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE) {
      while (targetElement.firstChild) {
        targetElement.removeChild(targetElement.firstChild);
      }
    }

    var previousElement = targetElement;
    for (var i=0;i<overallStructure.length;i++) {
      var level_definition = overallStructure[i];
      var level_element_tag = level_definition[0];
      var level_element = document.createElement(level_element_tag);
      var attribute_dictionary = level_definition[1];
      for (var attribute_key in attribute_dictionary) {
        level_element.setAttribute(attribute_key, attribute_dictionary[attribute_key]);
      }

      /* need to place title structure */
      if (titleStructure && titleStructure[0] == i) {
        var title_element_tag = titleStructure[1];
        var title_element = document.createElement(title_element_tag);
        var title_attribute_dictionary = titleStructure[2];
        var title_text_content = titleStructure[3];
        for (var title_attribute_key in title_attribute_dictionary) {
          title_element.setAttribute(title_attribute_key, title_attribute_dictionary[title_attribute_key]);
        }

        var title_text_node = document.createTextNode(title_text_content);
        title_element.appendChild(title_text_node);


        level_element.appendChild(title_element);
      }

      /* last level place links */
      if (i == overallStructure.length-1) {
        for (var link_i=0; link_i < links.length; link_i++) {
          var link = links[link_i];
          for (var linkStructureIndex=0;linkStructureIndex < linkStructure.length; linkStructureIndex++) {
            BELinkBlockGenerator.generateIndividualLinks(level_element, linkStructure[linkStructureIndex], link)
          }
        }
      }

      /* first level child we need to check placement */
      if (previousElement == targetElement) {
        if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT) {
          /* 2 means insert right before */
          previousElement.insertBefore(level_element, targetElement.firstChild);
        } else if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT) {
          /* 3 means insert right before at parent level */
          var parentElement = previousElement.parentElement;
          parentElement.insertBefore(level_element, previousElement);
        } else {
          previousElement.appendChild(level_element);
        }
      } else {
        previousElement.appendChild(level_element);
      }
      previousElement = level_element;
    }
  };
}(window.BELinkBlockGenerator = window.BELinkBlockGenerator || {}))
};
</script>


        <!--BE IXF: Header End -->


    </head>
    <body>
    



    
<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>FortiGuard Labs Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/life-at-fortinet">
                                <span>Life at Fortinet</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>FortiGuard Labs Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/life-at-fortinet">
                    <span>Life at Fortinet</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div id="blog-site-search" class="b1-header__search" aria-expanded="false"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <button class="b1-header__search-toggle" aria-controls="blog-site-search" aria-label="Search">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </button>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-images/dark-gate-ensilo-blog/Picture8.png);">
    <img class="ratio" alt="Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">FortiGuard Labs Threat Research</p>
        
        
        

        <h1 class="b4-hero__headline">Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign</h1>
        
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                          
                                              <a href="/blog/search?author=Adi+Zeligson">Adi Zeligson</a> and
                                          
                                           
                                      
                                  
                          

                                  
                                      
                                            
                                              <a href="/blog/search?author=Rotem+Kerner">Rotem Kerner</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | November 13, 2018</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h5><i>Threat Analysis: This blog originally appeared on the enSilo website and is republished here for threat research purposes. enSilo was <a href="https://www.fortinet.com/blog/business-and-technology/fortinet-acquires-endpoint-security-innovator-ensilo-.html">acquired</a> by Fortinet in October 2019.</i></h5>
<h2>Summary of the Malware Campaign<br />
</h2>
<p>Recently, enSilo researcher Adi Zeligson - now part of the FortiGuard Labs research team -  discovered a never-before-detected, highly sophisticated malware campaign named DarkGate. Targeting Windows workstations and supported by a reactive Command and Control system, DarkGate malware is spread through torrent files. When executed by the user, DarkGate malware is capable of avoiding detection by several AV products, and of executing multiple payloads including cryptocurrency mining, crypto stealing, <a href="https://web.archive.org/web/20191028183348/https:/www.ensilo.com/faq/ransomware-faq">ransomware</a>, and the ability to remotely take control of the endpoint. </p>
<p>The critical elements of the DarkGate malware are that it:</p>
<ul>
<li>Leverages a C&amp;C infrastructure cloaked in legitimate DNS records from legitimate services, including Akamai CDN and AWS, which helps it avoid reputation-based detection techniques</li>
<li>Uses multiple methods for avoiding detection by traditional AV using vendor-specific checks and actions, including the use of the process hollowing technique</li>
<li>Has the ability to evade the elimination of critical files by several known recovery tools</li>
<li>Uses two distinct User Account Control (UAC) bypass techniques to escalate privileges</li>
<li>Is capable of detonating multiple payloads with capabilities that include cryptocurrency mining, crypto stealing (theft of credentials associated with crypto wallets), ransomware, and remote control</li>
</ul>
<p>The technical analysis of the DarkGate malware that follows demonstrates how advanced malware can avoid detection by traditional AV products and highlights the importance of the post-infection protection capabilities of the <a href="https://web.archive.org/web/20191028183348/https:/www.ensilo.com/product/">enSilo Endpoint Security Platform</a><span>.</span><br />
</p>
<h2>Technical Analysis</h2>
<p>Named DarkGate by the author, the malware seeks to infect targets across Europe, particularly in Spain and France. DarkGate has several capabilities, including crypto mining, stealing credentials from crypto wallets (crypto stealing), ransomware, and remote access and control.<br />
</p>
<p>enSilo observed that the author behind this malware established a reactive Command and Control infrastructure that is staffed by human operators who act upon receiving notifications of new infections with crypto wallets. When the operator detects any interesting activity by one of the malware, they then proceed to install a custom remote access tool on the machine for manual operations.</p>
<p>As part of our normal research activities, we occasionally perform a controlled infection of what seems to be a legitimate user endpoint. The controlled infection is performed in order to investigate several aspects of the malware, as well as the reactivity of the malware operator. For example, in one of these encounters our research team was able to determine that the operator detected our activity and immediately responded to our activity by infecting the test machine with a customized piece of ransomware.</p>
<p>It appears that the author behind this malware invested significant time and effort into remaining undetected by leveraging multiple evasion techniques. One of the techniques used is a user-mode hooks bypass that enabled the malware to evade identification by various AV solutions for an extended period of time.</p>
<p>The enSilo research team tracked “DarkGate” and its variants, and discovered that most AV vendors failed to detect it. It was this discovery that led us to start investigating the unique characteristics of the malware, which are described in the Technical Analysis section. It is clear that DarkGate is under constant development as it is being improved with every new variant.</p>
<p>Further investigation is required to determine the ultimate motivations behind the malware. While cryptocurrency mining, crypto stealing, and ransomware capabilities suggest the goal is financial gain, it’s not clear if the author has another motive.</p>
<h2>Family Ties</h2>
<p>Within DarkGate, we were able to identify ties to a previously detected password stealer malware called <a href="https://web.archive.org/web/20191028183348/https:/www.bankinfosecurity.asia/cert-in-warns-info-stealing-trojan-a-8444">Golroted</a>. The Golroted malware is notable because of its use of the Nt* API calls for performing process hollowing. Additionally, Golroted used a second technique, UAC bypass, based on a schedule task called SilentCleanup. DarkGate utilizes both of these techniques.</p>
<p>After performing a binary diff between Golroted and DarkGate, we discovered a significant amount of overlapping code. As shown in Figure 1, both malware variants perform the process hollowing method on the process vbc.exe. However, DarkGate contains a slightly modified version of the process hollowing function.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image.img.png/1588973610533/picture1.png" alt="FIGURE 1: BINARY DIFF BETWEEN GOLRATED AND DARKGATE" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 1: BINARY DIFF BETWEEN GOLRATED AND DARKGATE</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Infection Tactics and Methods</h2>
<p>We identified two distinct infection methods employed by the author of DarkGate, as well as the author of Golroted. Both infection methods are spread through Torrent files posing as a popular movie and a television series that then execute VBscript on the victim. </p>
<p>The second file, the-walking-dead-9-5-hdtv-720p.torrent.vbe, uses a more trivial approach to infecting victims. It distributes emails containing malicious attachments from a spoofed address. An example of this is shown in Figure 3.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_1248099422.img.png/1588973639838/picture2.png" alt="FIGURE 2: SCREEN CAPTURE OF TORRENT FILES" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 2: SCREEN CAPTURE OF TORRENT FILES</span>


    
</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_1686241992.img.png/1588973659905/picture3.png" alt="FIGURE 3: EXAMPLE OF EMAIL DISTRIBUTED BY THE-WALKING-DEAD-9-5-HDTV-720P.TORRENT.VBE " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 3: EXAMPLE OF EMAIL DISTRIBUTED BY THE-WALKING-DEAD-9-5-HDTV-720P.TORRENT.VBE </span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Four Stages of Unpacking DarkGate Malware</h2>
<p>One of the unique techniques used by the DarkGate malware lies within its multi-stage unpacking method. The first file executed is an obfuscated VBScript file, which functions as a dropper and performs several actions. In the first stage, several files are dropped into a hidden folder <i>“C:\{computername}”</i>. The files are autoit3.exe, which in some versions is disguised with a random name: test.au3, pe.bin and shell.txt. Next, test.au3 AutoIt script is executed using the dropped instance of autoit3.exe.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_1569144934.img.png/1588973693713/picture4.png" alt="FIGURE 4: THE DE-OBFUSCATED VBS" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 4: THE DE-OBFUSCATED VBS</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>In the second phase, the AutoIt code creates a shortcut of itself with the name “bill.ink” under the startup folder. Once completed, it triggers a third stage in which the binary code stored in the file “C:\{computername}\shell.txt” is decrypted and then executed. The AutoIt script uses a rather unusual technique for executing the binary code. The steps involved in the technique are:</p>
<ul>
<li>Loads the binary code from shell.txt into the process memory</li>
<li>Copies the data into an executable memory space (DLLStructCreate and DllStructSetData)</li>
<li>Invokes CallWindowProc with reference to our binary code as the lpPrevWndFunc parameter</li>
</ul>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_79264447.img.png/1588973708072/picture5.png" alt="FIGURE 5: THE DE-OBFUSCATED AUTOIT SCRIPT" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 5: THE DE-OBFUSCATED AUTOIT SCRIPT</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Finally, in the fourth and final stage of the unpacking technique, the binary code originally loaded from shell.txt performs the followings actions:</p>
<ul>
<li>Searches for the executable file, which is also the name of an executable found in Kaspersky AV.</li>
<li>Reads the dropped file “pe.bin” and decrypts it.</li>
<li>Uses <a href="https://web.archive.org/web/20191028183348/https:/attack.mitre.org/techniques/T1093/" style="">process hollowing</a><span style=""> to inject the decrypted code from pe.bin into the process “vbc.exe”.</span></li>
</ul>
<p>We discovered that if DarkGate detects the presence of Kaspersky AV, it loads the malware as part of the shellcode rather than using the process hollowing method. The decrypted pe.bin file is the core of DarkGate. The core is responsible for its communication with the C&amp;C (Command and Control) server and for executing commands received from it.</p>
<p>Let’s summarize this four-stage unpacking technique </p>
<p>1. The initial dropper code is delivered using VBScript, which drops all the relevant files:</p>
<ul>
<li>autoit3.exe</li>
<li>test.au3</li>
<li>pe.bin</li>
<li>shell.txt</li>
<li>autoit3.exe</li>
<li>test.au3</li>
<li>pe.bin</li>
<li>shell.txt</li>
<li>autoit3.exe</li>
<li>autoit3.exe</li>
<li>autoit3.exe</li>
<li>test.au3</li>
<li>pe.bin</li>
<li>shell.txt </li>
<li>autoit3.exe</li>
<li>test.au3</li>
<li>pe.bin</li>
<li>shell.txt</li>
</ul>
<p>Once, delivered it then runs the AutoIt script. </p>
<p>2. The AutoIt script runs using the AutoIt interpreter, which decrypts the binary code and loads it into memory.</p>
<p>3. The binary code then executes and attempts to avoid detection by Kaspersky AV.</p>
<p>4. The final binary is decrypted and executed.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_954527940.img.png/1588973739497/picture6.png" alt="FIGURE 6: THE FOUR STAGES OF THE UNPACKING TECHNIQUE" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 6: THE FOUR STAGES OF THE UNPACKING TECHNIQUE</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h6><i> </i></h6>
<p>The final binary copies all files from “C:\{computer_name} “ to a new folder under “C:\Program data” with the name derived from the first eight digits of the user generated id (ID2 - explained later on).</p>
<p>The final binary installs a key in the registry designed to help it maintain persistency under the key: “\SOFTWARE\Microsoft\Windows\CurrentVersion\Run”.</p>
<p>The key name is the first eight digits of the user-generated id, and the value is the AutoIt script that was copied from C:\{computer_name} to the “program data” folder, as shown below in Figure 7:</p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_2137108656.img.png/1588973751744/picture7.png" alt="FIGURE 7: EXAMPLE OF REGISTRY KEY USED TO ESTABLISH PERSISTENCY " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 7: EXAMPLE OF REGISTRY KEY USED TO ESTABLISH PERSISTENCY </span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Cryptocurrency Mining</h2>
<p>The first connection the malware makes to the C&amp;C server is to get the file it needs to start the cryptocurrency mining process. <b></b></p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">


    
</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_904435754.img.png/1588973774964/picture8.png" alt="FIGURE 8: RETRIEVING THE FILE " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 8: RETRIEVING THE FILE </span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>As shown in Figure 9, the command “startminer” is sent as part of the response in order to tell the malware to start mining and to separate the different parts of the message. The first part is encrypted into config.bin - that is the miner command line. The second part is written in cpu.bin, and when decrypted is the miner executable. The mining itself is done through the process “systeminfo.exe” by using process hollowing.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_600776694.img.png/1588973789273/picture9.png" alt="FIGURE 9: RETRIEVING THE CRYPTO MINER PAYLOAD " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 9: RETRIEVING THE CRYPTO MINER PAYLOAD </span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Stealing Crypto Wallet Credentials</h2>
<p>Another capability of the malware is that it can search for, and steal, credentials for crypto wallets. The malware looks for specific strings in the names of windows in the foreground that are related to different kinds of crypto wallets, and if a matching string is found, sends the server an appropriate message.</p>
<p>The following table contains the list of targeted wallet website/applications:</p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p style="font-size: medium; font-family: 'Times New Roman', serif; color: #000000; font-style: normal; font-weight: normal;"><span style="font-family: Calibri, sans-serif;">&nbsp;</span></p> <table class="MsoNormalTable" style="color: #000000; font-style: normal; font-weight: normal; width: 100%; border-collapse: collapse;" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td style="border: 1pt solid black; background-color: #1aad8c; padding: 7.5pt; " valign="top"> <h6 style="font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; line-height: 11.5px;"><span style="font-size: 12pt; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">STING SEARCH&nbsp;</span></h6> </td> <td style="border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-style: solid solid solid none; border-top-color: black; border-right-color: black; border-bottom-color: black; background-color: #1aad8c; padding: 7.5pt; " valign="top"> <h6 style="font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; line-height: 11.5px;"><span style="font-size: 12pt; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">TARGET&nbsp;</span></h6> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">sign-in / hitbtc</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://hitbtc.com/</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">binance - log in</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.binance.com/login.html</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">litebit.eu - login</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.litebit.eu/en/login</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">binance - iniciar sesi</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.binance.com/login.html</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">cryptopia - login</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.cryptopia.co.nz/Login</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">user login - zb spot exchange</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">sign in | coinEx</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.coinex.com/account/signin?lang=en_US</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">electrum</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://electrum.org/#home</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">bittrex.com - input</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://international.bittrex.com/</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">exchange - balances</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">eth) - log in</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">blockchain wallet</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.blockchain.com/wallet</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">bitcoin core</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://bitcoincore.org/</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">kucoin</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.kucoin.com/#/</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">metamask</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://metamask.io/</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">factores-Binance</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">litecoin core</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; " valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://litecoin.org/</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif; text-align: justify;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">myether</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="font-size: 12pt; font-family: 'Times New Roman', serif;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">https://www.myetherwallet.com/</span></strong></p> </td> </tr> </tbody> </table> <h6 style="font-size: 7.5pt; font-family: 'Times New Roman', serif; color: #000000; font-style: normal; text-align: center; line-height: 11.5px;" align="center"><em><span style="font-size: 12pt; font-family: Calibri, sans-serif; color: #333333; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">TABLE 1: TARGET CRYPTO WALLETS AND STRING VALUES&nbsp;</span></em></h6></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Command and Control</h2>
<p>Judging from what we’ve seen so far, it seems like the author of DarkGate leveraged sophisticated techniques to avoid detection both by endpoint and network security products.</p>
<p>The malware contains six hard-coded domains, shown below, which it attempts to communicate with upon infection. It looks like the domains are chosen carefully to disguise the C&amp;C server as a known legitimate service, such as Akamai CDN or AWS, and avoids looking suspicious to anyone who may be monitoring the network traffic.</p>
<ul>
<li>akamai.la</li>
<li>hardwarenet.cc</li>
<li>ec2-14-122-45-127.compute-1.amazonaws.cdnprivate.tel</li>
<li>awsamazon.cc</li>
<li>battlenet.la</li>
<li>a40-77-229-13.deploy.static.akamaitechnologies.pw</li>
</ul>
<p>Additionally, it seems the author has employed another trick by using NS records that look like legitimate rDNS records from Akamai or Amazon. The idea behind using rDNS is that they’re overlooked and easily dismissed by anyone monitoring network traffic.</p>
<h2>Two Methods Used To Avoid Detection</h2>
<p>It appears what the author of DarkGate fears most is detection by AV software. They have invested significant effort in anti-VM and user validation techniques, rather than anti-debugging measures. </p>
<h2>ANTI-VM: Machine Resources Checkup</h2>
<p>The first method used by DarkGate to avoid detection by AV software is to determine if the malware has landed inside a sandbox/virtual machine. Based on the tactics used, we believe the author assumes sandbox/virtual machines (VMs) are generally low on resources, which is generally correct since sandboxes are optimized to contain the coexistence of as many VMs as possible.</p>
<p>In Figure 10, we can see the use of Delphi’s Sysutils::DiskSize and GlobalMemoryStatusEx for collecting both disk size and physical memory. If the machine contains less than 101GB of disk space, or has an amount of RAM less than or equal to 4GB, it will be considered as a VM and the malware will automatically terminate.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_135013813.img.png/1588973822375/picture10.png" alt="FIGURE 10: CHECKING THE MACHINE DISK AND RAM" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 10: CHECKING THE MACHINE DISK AND RAM</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>ANTI-AV</h2>
<p>DarkGate attempts to detect if any of the AV solutions listed in Table 2 are present on an infected machine. For most of the AV solutions, if the malware detects any of these AV solutions, it will just notify the server ­– with the exception of IOBit, TrendMicro, or Kaspersky .</p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><table class="MsoNormalTable" style="color: #000000; font-style: normal; font-weight: normal; text-align: start; width: 100%; border-collapse: collapse;" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td style="border: 1pt solid black; background-color: #1aad8c; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; line-height: 11.5px;"><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">PROCESS NAME</span></h6> </td> <td style="border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-style: solid solid solid none; border-top-color: black; border-right-color: black; border-bottom-color: black; background-color: #1aad8c; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; line-height: 11.5px;"><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">SOLUTION</span></h6> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">astui.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;Avast</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;avpui.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;Kaspersky</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">avgui.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">AVG</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;egui.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Nod32</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">bdagent</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;Bitdefender</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">avguard.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Avira</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">nis.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Norton</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">ns.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Norton</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">nortonsecurity.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Norton</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">uiseagnt.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;Trend Micro</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">bytefence.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;ByteFence</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">psuaconsole.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;Panda</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">sdscan.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Search &amp; Destroy</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">mcshield.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">McAfee</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">mcuicnt.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">McAfee</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">mpcmdrun.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Windows Defender</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">superantispyware.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">SUPER AntiSpyware</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">vkise.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Comodo</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">mbam.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">MalwareBytes</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">cis.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">&nbsp;Comodo</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">msascuil.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Windows Defender</span></strong></p> </td> </tr> </tbody> </table> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; color: #000000; font-style: normal; text-align: center; line-height: 11.5px;" align="center"><em><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: #333333; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">TABLE 2: AV EXECUTABLES SEARCHED FOR BY DARKGATE MALWARE</span></em></h6></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The existence of AV solutions from IOBit, TrendMicro, or Kaspersky trigger special conditions:</p>
<ul>
<li>IOBit: If the path “C:\\Program Files (x86)\\IObit” exists, the malware is going to try and tackle a process named “monitor.exe” by terminating it. Additionally, it will spawn a new thread that repeatedly looks for the process “smBootTime.exe” and terminate the process if it exists.</li>
<li>Trend Micro: If the Trend Micro AV process name is detected, the code will not execute the key logging thread.</li>
<li>Kaspersky: The malware checks multiple times during execution, both during the unpacking process and in the malware itself, for the presence of Kaspersky AV. If detected in the final executable, and less than 5 minutes have passed since the machine’s startup, then it won’t initiate the key logging thread and the update thread that is responsible for:</li>
<li>Copying all of the malware-related files to a folder under “C:\Program Data”.</li>
<li>Performing the recovery tools check described in the next section.</li>
<li>And finally, if detected in the shellcode and more than 4:10 minutes have passed since system startup, it will not use the process hollowing technique to execute the final executable, and will instead load and execute it directly.</li>
</ul>
<h2>Recovery Tools</h2>
<p>The malware also tries to detect several known recovery tools using the process names listed in Table 3:</p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><table class="MsoNormalTable" style="color: #000000; font-style: normal; font-weight: normal; text-align: start; width: 100%; border-collapse: collapse;" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td style="border: 1pt solid black; background-color: #1aad8c; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; line-height: 11.5px;"><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">PROCESS NAME</span></h6> </td> <td style="border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-style: solid solid solid none; border-top-color: black; border-right-color: black; border-bottom-color: black; background-color: #1aad8c; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; line-height: 11.5px;"><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">TARGET&nbsp;</span></h6> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">adwcleaner.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">MalwareBytes Adwcleaner</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">frst64.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Farbar Recovery Scan Tool</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">frst32.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Farbar Recovery Scan Tool</span></strong></p> </td> </tr> <tr> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">frst86.exe</span></strong></p> </td> <td style="border-style: none solid solid none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">Farbar Recovery Scan Tool</span></strong></p> </td> </tr> </tbody> </table> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; color: #000000; font-style: normal; text-align: center; line-height: 11.5px;" align="center"><em><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: #333333; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">TABLE 3: RECOVERY TOOLS PROCESS NAMES AND TARGETS</span></em></h6></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>If such a process is found, the malware will initiate a new thread that will reallocate the malware files every 20 seconds, making sure that if the files were deleted during the lifetime of a recovery tool they will be recreated and relocated somewhere else.</p>
<h2>Direct Syscall Invocation    </h2>
<p>In order to hide the use of the process hollowing technique, DarkGate uses a special capability that enables it to call kernel mode functions directly. This can potentially help the malware escape any breakpoints set by a debugger, as well as evade userland hooks set by the different security products.</p>
<h3><b>How Does it Work?</b></h3>
<p>When using functions from ntdll.dll, a system call is made to the kernel. The way the call is done is different between 32 and 64-bit systems, but they both eventually call the function “KiFastSystemCall”, which is different for each architecture. The “KiFastSystemCall” function is used to switch between ring 3 and ring 0. The Darkgate malware avoids loading the ntdll.dll functions the proper way, and instead creates its own “KiFastSystemCall” function that will make the syscall.</p>
<p>DarkGate is a 32-bit process that can become a challenge when running on a 64-bit system due to the differences between the systems when switching to the kernel. In order to use the right “KiFastSystemCall” function for the process, the Darkgate malware checks which architecture it’s running on by searching for the path “C:\Windows\SysWOW64\ntdll.dll”. If this path exists, it means the process is running on a 64-bit system.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_1532892949.img.png/1588973882045/picture11.png" alt="FIGURE 11: ASSIGN THE RIGHT FUNCTION BASED ON THE ARCHITECTURE" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 11: ASSIGN THE RIGHT FUNCTION BASED ON THE ARCHITECTURE</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>In a 32-bit system, the “KiFastSystemCall” function will look like this:</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_412829778.img.png/1588973898946/picture12.png" alt="FIGURE 12: 32-BIT SYSTEM KIFASTSYSTEMCALL FUNCTION" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 12: 32-BIT SYSTEM KIFASTSYSTEMCALL FUNCTION</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>In a 64-bit system, the following code is used to call the “KiFastSystemCall” 64-bit function from a 32-bit process:</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_1765812844.img.png/1588974346416/picture13.png" alt="FIGURE 13: 64-BIT SYSTEM KIFASTSYSTEMCALL FUNCTION" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 13: 64-BIT SYSTEM KIFASTSYSTEMCALL FUNCTION</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The offset “fs:0C0h” is a pointer in the TEB (Thread Information Block) to “FastSysCall” in wow64. This pointer points to an address in “wow64cpu.dll” that jumps to the 64-bit “KiFastSystemCall” function. The DarkGate malware will pass to the assigned function the ntdll requested function syscall number and the needed parameters. This way, a kernel function is called without the need to call the function from within ntdll.dll. To conclude, the DarkGate malware creates its own “KiFastSystemCall” to bypass ntdll.dll.</p>
<p>We found a similar <a href="https://web.archive.org/web/20191028183348/https:/cybercoding.wordpress.com/2012/12/01/union-api/">code </a>that might have been the source of the DarkGate code.</p>
<h2>UAC Bypass Capabilities</h2>
<p>DarkGate uses two distinct UAC bypass techniques that it uses to try and elevate privileges.</p>
<h3>Disk-Clean up Bypass</h3>
<p>The first UAC bypass technique exploits a scheduled task called DiskCleanup. This scheduled task uses the path <i>%windir%\system32\cleanmgr.exe</i> to execute the actual binary. Therefore, the malware overrides the <i>%windir% </i>environment variable with the registry key: <i>“HKEY_CURRENT_USER\Enviroment\windir”</i> with an alternative command, which will execute the AutoIt script. This bypass process was covered by <a href="https://web.archive.org/web/20191028183348/https:/tyranidslair.blogspot.com/2017/05/exploiting-environment-variables-in.html">Tyranid’s Lair</a>.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_1270051631.img.png/1588974357580/picture14.png" alt="FIGURE 14: DISK-CLEANUP UAC BYPASS " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 14: DISK-CLEANUP UAC BYPASS </span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h3>EVENTVWR UAC Bypass</h3>
<p>Another UAC bypass exploits the fact that eventvwr.exe, by default, runs in high integrity, and will execute the mmc.exe binary (Microsoft Management Console). The mmc.exe command is taken from the registry key “HKCU\Software\Classes\mscfile\shell\open\command”. This registry key is also writable from a lower integrity level, which enables it to execute an AutoIt script in a higher integrity.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_794029836.img.png/1588974498856/picture15.png" alt="FIGURE 15: EVENTVWR UAC BYPASS " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 15: EVENTVWR UAC BYPASS </span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Keylogging</h2>
<p>A thread is started that is responsible for capturing all keyboard events and then logging them to a predefined log file. Other than logging the key logs, it also logs the foreground windows and the clipboard. The log is saved with the name “current date.log” in the following directory listed below:</p>
<p>“C:\users\ {username}\appdata\roaming\{ID1}”.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_2050509534.img.png/1588974562851/picture16.png" alt="FIGURE 16: KEYLOG FILE" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 16: KEYLOG FILE</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Information Stealing</h2>
<p>DarkGate uses some of the NirSoft tools in order to steal credentials or information from infected machines. The toolset that is used enables it to steal user credentials, browser cookies, browser history, and Skype chats. All tools are executed using the process hollowing technique into a newly created instance of vbc.exe or regasm.exe.</p>
<p>DarkGate uses the following applications to steal credentials:</p>
<ul>
<li>Mail PassView</li>
<li>WebBrowserPassView</li>
<li>ChromeCookiesView</li>
<li>IECookiesView</li>
<li>MZCookiesView</li>
<li>BrowsingHistoryView</li>
<li>SkypeLogView</li>
</ul>
<p>The resulting data collected from the tools is extracted from the hosting process memory. DarkGate malware first looks for the tool’s window by using The FindWindow API function. It then uses the SysListView32 control and the sendMessage API function in order to retrieve the information needed from the tool. The retrieval works by first allocating a memory buffer in the hollowed process, as shown in Figure 17.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_35609174.img.png/1588974684526/picture17.png" alt="FIGURE 17: MEMORY ALLOCATION IN HOLLOWED PROCESS" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 17: MEMORY ALLOCATION IN HOLLOWED PROCESS</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>It will then use the “GetItem” function to make it write the item to the allocated buffer. The “GetItem” function is used by calling the API function “SendMessage” with the message “LVM_GETITEMA” and the allocated buffer as a parameter:</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign/_jcr_content/root/responsivegrid/image_1536265763.img.png/1588974703743/picture18.png" alt="FIGURE 18: GETITEM MESSAGE AND THE RETRIEVAL OF THE ITEM FROM THE HOLLOWED PROCESS" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">FIGURE 18: GETITEM MESSAGE AND THE RETRIEVAL OF THE ITEM FROM THE HOLLOWED PROCESS</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>After the item is written to the allocated buffer, it will then read this memory region to retreive stolen information.</p>
<h2>Deleting Restore Points</h2>
<p>The malware has the ability to delete all restore points, including “cmd.exe /c vssadmin delete shadows /for=c: /all /quiet”</p>
<p>RDP INSTALL</p>
<p>This command will decrypt and execute the received file, which is probably an rdp connection tool, using the process hollowing method. The hollowed process in this case is a copy of systeminfo.exe in the %temp% directory.</p>
<p>In addition, the following commands will be executed using cmd.exe:</p>
<ul>
<li>exe /c net user /add SafeMode Darkgate0!</li>
<li>exe /c net localgroup administrators SafeMode /add</li>
<li>exe /c net localgroup administradores SafeMode /add</li>
<li>exe /c net localgroup administrateurs SafeMode /add</li>
</ul>
<p>It is interesting to see that the newly created user is added to both the Spanish and French admin groups.</p>
<h2>Getbotdata</h2>
<p>The server can request the following details about the victim:</p>
<ul>
<li>Locale</li>
<li>User name</li>
<li>Computer name</li>
<li>Window name</li>
<li>Time, representing the period of time that passed since the last input on the host</li>
<li>Processor type</li>
<li>Display adapter description</li>
<li>RAM amount</li>
<li>OS type and version</li>
<li>Is user admin</li>
<li>The encrypted content of config.bin</li>
<li>Epoch time</li>
<li>AV type – search by process name. If not found, this field will contain the text “Unknown”.</li>
</ul>
<p>In some versions it will also look for the folder “c:\Program Files\e-Carte Bleue” (we think that might be the folder where DarkGate saves its screenshots). The data is then encrypted and sent to the server. In addition, it creates the file Install.txt under the %appdata% path and writes the Epoch time in it.</p>
<ul>
<li>Malware version</li>
<li>The port used by the connection </li>
</ul>
<h2>Solutions </h2>
<p>The <a href="https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&amp;utm_campaign=2020-q1-fortiedr"><b>FortiEDR</b></a> platform is capable of blocking the threat.</p>
<h2>IOCS</h2>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container">
<table class="MsoNormalTable" style="color: #000000; font-style: normal; font-weight: normal; text-align: start; width: 100%; border-collapse: collapse; margin-left: 6.75pt; margin-right: 6.75pt;" border="0" cellspacing="0" cellpadding="0" align="left"> <tbody> <tr style="height: 48.55pt;"> <td style="border: 1pt solid black; background-color: #1aad8c; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; text-align: center; line-height: 11.5px;" align="center"><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">DOMAINS&nbsp;</span></h6> </td> </tr> <tr style="height: 31.9pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">akamai.la</span></strong></p> </td> </tr> <tr style="height: 31.9pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">hardwarenet.cc</span></strong></p> </td> </tr> <tr style="height: 31.9pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">ec2-14-122-45-127.compute-1.amazonaws.cdnprivate.tel</span></strong></p> </td> </tr> <tr style="height: 31.9pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">awsamazon.cc</span></strong></p> </td> </tr> <tr style="height: 31.9pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">battlenet.la</span></strong></p> </td> </tr> <tr style="height: 31.9pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">a40-77-229-13.deploy.static.akamaitechnologies.pw</span></strong></p> </td> </tr> </tbody> </table> <p class="MsoNormal" style="margin: 0in 0in 12pt; font-size: medium; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start; line-height: 18.399999618530273px;"><span style="color: #333333;">&nbsp;</span></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; font-size: medium; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start; line-height: 18.399999618530273px;">&nbsp;</p> <p class="MsoNormal" style="margin: 0in 0in 12pt; font-size: medium; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start; line-height: 18.399999618530273px;">&nbsp;</p> <table class="MsoNormalTable" style="color: #000000; font-style: normal; font-weight: normal; text-align: start; width: 100%; border-collapse: collapse; margin-left: 6.75pt; margin-right: 6.75pt;" border="0" cellspacing="0" cellpadding="0" align="left"> <tbody> <tr style="height: 0.2in;"> <td style="border: 1pt solid black; background-color: #1aad8c; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <h6 style="margin: 0in 0in 12pt; font-size: 7.5pt; font-family: 'Times New Roman', serif; font-weight: bold; text-align: center; line-height: 11.5px;" align="center"><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: Calibri, sans-serif; color: white; text-transform: uppercase; border: 1pt none windowtext; padding: 0in; font-weight: normal;">SAMPLE HASHES&nbsp;</span></h6> </td> </tr> <tr style="height: 16.45pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b</span></strong></p> </td> </tr> <tr style="height: 15.75pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5</span></strong></p> </td> </tr> <tr style="height: 16.45pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b</span></strong></p> </td> </tr> <tr style="height: 15.75pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5</span></strong></p> </td> </tr> <tr style="height: 15.75pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">52c47a529e4ddd0778dde84b7f54e1aea326d9f8eeb4ba4961a87835a3d29866</span></strong></p> </td> </tr> <tr style="height: 16.45pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">b0542a719c6b2fc575915e9e4c58920cf999ba5c3f5345617818a9dc14a378b4</span></strong></p> </td> </tr> <tr style="height: 15.75pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">dadd0ec8806d506137889d7f1595b3b5447c1ea30159432b1952fa9551ecfba5</span></strong></p> </td> </tr> <tr style="height: 16.45pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">c88eab30fa03c44b567bcb4e659a60ee0fe5d98664816c70e3b6e8d79169cbea</span></strong></p> </td> </tr> <tr style="height: 15.75pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">2264c2f2c2d5a0d6d62c33cadb848305a8fff81cdd79c4d7560021cfb304a121</span></strong></p> </td> </tr> <tr style="height: 16.45pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">3c68facf01aede7bcd8c2aea853324a2e6a0ec8b026d95c7f50a46d77334c2d2</span></strong></p> </td> </tr> <tr style="height: 15.75pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">a146f84a0179124d96a707f192f4c06c07690e745cffaef521fcda9633766a44</span></strong></p> </td> </tr> <tr style="height: 16.45pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">abc35bb943462312437f0c4275b012e8ec03899ab86d353143d92cbefedd7f9d</span></strong></p> </td> </tr> <tr style="height: 15.75pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; background-color: #d4e7cd; padding: 7.5pt; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">908f2dfed6c122b46e946fe8839feb9218cb095f180f86c43659448e2f709fc7</span></strong></p> </td> </tr> <tr style="height: 16.45pt;"> <td style="border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-style: none solid solid; border-right-color: black; border-bottom-color: black; border-left-color: black; padding: 7.5pt;" valign="top"> <p style="margin: 0in 0in 12pt; font-size: 12pt; font-family: 'Times New Roman', serif; line-height: 18.399999618530273px;"><strong><span style="font-family: Calibri, sans-serif; color: #231f20; border: 1pt none windowtext; padding: 0in;">3491bc6df27858257db26b913da8c35c83a0e48cf80de701a45a30a30544706d</span></strong></p> </td> </tr> </tbody> </table></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p><i>Find out about the FortiGuard Security Services </i><a href="https://www.fortinet.com/content/dam/fortinet/assets/data-sheets/FortiGuard_Security_Services.pdf"><i>portfolio</i></a><i> and </i><a href="https://secure.fortinet.com/FortiGuard"><i>sign up</i></a><i> for our weekly FortiGuard Threat Brief.</i></p>
<p><i>Discover how the FortiGuard </i><a href="https://fortiguard.com/security-best-practices"><i>Security Rating Service</i></a><i> provides security audits and best practices to guide customers in designing, implementing, and maintaining the security posture best suited for their organization.</i></p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><div id="om-qbkzwxxbiv83f0ol5a2d-holder"></div>
</div>
</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container" style="display:none">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=ransomeware">ransomware</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=cybersecurity-architect">Cybersecurity Architect</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=darkgate">DarkGate</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/threat-research/fortinet-q2-2019-threat-landscape-report" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/tlr-q2-2019-blog/tlr-takeaways-blog-img.png.thumb.319.319.png);">
                <img class="ratio" alt="Fortinet Reports Increased YoY Threat Activity for Q2 2019" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Fortinet Reports Increased YoY Threat Activity for Q2 2019</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/lockergoga-ransomeware-targeting-critical-infrastructure" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/lockergoga-blog/lockergoga.png.thumb.319.319.png);">
                <img class="ratio" alt="LockerGoga: Ransomware Targeting Critical Infrastructure" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">LockerGoga: Ransomware Targeting Critical Infrastructure</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/looking-into-anatova-ransomware" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/anatova-ransomware/anatova-blog-two.png.thumb.319.319.png);">
                <img class="ratio" alt="Looking Into Anatova Ransomware" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Looking Into Anatova Ransomware</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  
  
 </div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.x.com/Fortinet" target="_blank">
                
    <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"/>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/channel/UCJHo4AuVomwMRzgkA5DQEOA?sub_confirmation=1" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/fortinet/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware Prevention</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="https://community.fortinet.com/" target="_blank">Fortinet Community</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/partners/partner-program/become-a-fortinet-partner" target="_blank">Partner Portal</a>
              </li>
            
              <li>
                <a href="https://investor.fortinet.com/" target="_blank">Investor Relations</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications" target="_blank">Product Certifications</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/nse-training" target="_self">Training</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards" target="_self">Industry Awards</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/corporate-social-responsibility" target="_self">Social Responsibility</a>
              </li>
            
              <li>
                <a href="/resources/cyberglossary" target="_self">CyberGlossary</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/sitemap" target="_self">Sitemap</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/blog/blog-sitemap" target="_self">Blog Sitemap</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2024 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>


    
    
    
    
    
<script src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.ba4f082a77dabb2c6baf715d9eb61c22.js"></script>





    


    

    <!-- BE IXF: The following <div> block needs to be placed in the location where the link block will be displayed
    BE IXF: For your website, the location is above/below ...-->
    <div class="be-ix-link-block">
        <!--
   be_sdkms_pub:bec-built-in; bec-built-in_1.0.0; bodystr;
   be_sdkms_date_modified:pn_tstr:Wed Oct 23 21:39:44 UTC 2024; pn_epoch:1729719584359;
   be_sdkms_timer: 0;
-->

        
    </div>
    <!-- BE IXF: Footer End -->
    </body>
    </html>
