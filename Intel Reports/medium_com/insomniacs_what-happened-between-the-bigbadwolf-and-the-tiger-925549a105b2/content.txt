<!doctype html><html lang="en"><head><title data-rh="true">What happened between the BigBadWolf and the Tiger? | by asuna amawaka | insomniacs | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-05-20T18:16:03.178Z"/><meta data-rh="true" name="title" content="What happened between the BigBadWolf and the Tiger? | by asuna amawaka | insomniacs | Medium"/><meta data-rh="true" property="og:title" content="What happened between the BigBadWolf and the Tiger?"/><meta data-rh="true" property="al:android:url" content="medium://p/925549a105b2"/><meta data-rh="true" property="al:ios:url" content="medium://p/925549a105b2"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="While I was doing research for my previous posts, I came across mentions of a trending Chinese-language-based C2-side controller called 大灰狼 (pronounced as Da Hui Lang, which translates literally to…"/><meta data-rh="true" property="og:description" content="Looking into a Gh0stRAT variant controller/builder called 大灰狼 (BigBadWolf) and a YARA rule on “s.exe variant seen in Op Iron Tiger”."/><meta data-rh="true" property="og:url" content="https://medium.com/insomniacs/what-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2"/><meta data-rh="true" property="al:web:url" content="https://medium.com/insomniacs/what-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:602/1*8e6vxKBYB1Y6qRGeWOSF6Q.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@asuna.amawaka"/><meta data-rh="true" name="author" content="asuna amawaka"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="What happened between the BigBadWolf and the Tiger?"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/925549a105b2"/><meta data-rh="true" property="twitter:description" content="Looking into a Gh0stRAT variant controller/builder called 大灰狼 (BigBadWolf) and a YARA rule on “s.exe variant seen in Op Iron Tiger”."/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:602/1*8e6vxKBYB1Y6qRGeWOSF6Q.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="10 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@asuna.amawaka"/><link data-rh="true" rel="canonical" href="https://medium.com/insomniacs/what-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/925549a105b2"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*8e6vxKBYB1Y6qRGeWOSF6Q.png"],"url":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2","dateCreated":"2020-05-20T18:13:23.669Z","datePublished":"2020-05-20T18:13:23.669Z","dateModified":"2021-12-14T14:39:40.701Z","headline":"What happened between the BigBadWolf and the Tiger?","name":"What happened between the BigBadWolf and the Tiger?","description":"While I was doing research for my previous posts, I came across mentions of a trending Chinese-language-based C2-side controller called 大灰狼 (pronounced as Da Hui Lang, which translates literally to…","identifier":"925549a105b2","author":{"@type":"Person","name":"asuna amawaka","url":"https:\u002F\u002Fmedium.com\u002F@asuna.amawaka"},"creator":["asuna amawaka"],"publisher":{"@type":"Organization","name":"insomniacs","url":"https:\u002F\u002Fmedium.com\u002Finsomniacs","logo":{"@type":"ImageObject","width":60,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:120\u002F1*IvMGfHVzEtZei5I-JouCvw.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2"}</script><style type="text/css" data-fela-rehydration="561" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="561" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{box-shadow:inset 3px 0 0 0 #242424}.nv{padding-left:23px}.nw{margin-left:-20px}.nx{font-style:italic}.ny{margin-left:auto}.nz{margin-right:auto}.oa{max-width:586px}.og{clear:both}.oh{height:auto}.oi{list-style-type:disc}.oj{margin-left:30px}.ok{padding-left:0px}.oq{max-width:602px}.or{max-width:684px}.os{max-width:518px}.ot{max-width:1056px}.ov{cursor:zoom-in}.ow{z-index:auto}.oy{max-width:878px}.oz{max-width:944px}.pa{max-width:825px}.pb{margin-top:10px}.pc{max-width:728px}.pf{max-width:895px}.pg{max-width:786px}.ph{max-width:810px}.pi{max-width:1304px}.pj{text-decoration:underline}.pp{box-shadow:inset 0 0 0 1px #F2F2F2}.pq{padding:0px}.pr{padding:16px 20px}.ps{flex:1 1 auto}.pu{max-height:40px}.pv{-webkit-line-clamp:2}.pw{margin-top:8px}.px{margin-top:12px}.py{width:160px}.pz{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*bkqTFhfA3fy7aTku)}.qa{background-origin:border-box}.qb{background-size:cover}.qc{height:167px}.qd{background-position:50% 50%}.qe{margin-bottom:26px}.qf{margin-top:6px}.qg{margin-right:8px}.qh{padding:8px 16px}.qi{border-radius:100px}.qj{transition:background 300ms ease}.ql{white-space:nowrap}.qm{border-top:none}.qn{margin-bottom:14px}.qo{height:52px}.qp{max-height:52px}.qq{box-sizing:content-box}.qr{position:static}.qt{max-width:155px}.qz{margin-right:20px}.rf{height:0px}.rg{margin-bottom:40px}.rh{margin-bottom:48px}.rv{border-radius:2px}.rx{height:64px}.ry{width:64px}.rz{align-self:flex-end}.sf{padding-right:4px}.sg{font-weight:500}.st{margin-top:16px}.su{color:rgba(255, 255, 255, 1)}.sv{fill:rgba(255, 255, 255, 1)}.sw{background:rgba(25, 25, 25, 1)}.sx{border-color:rgba(25, 25, 25, 1)}.ta:disabled{opacity:0.1}.tb:disabled:hover{background:rgba(25, 25, 25, 1)}.tc:disabled:hover{border-color:rgba(25, 25, 25, 1)}.td{margin-bottom:54px}.ty{gap:18px}.tz{fill:rgba(61, 61, 61, 1)}.ul{border-bottom:solid 1px #E5E5E5}.um{margin-top:72px}.un{padding:24px 0}.uo{margin-bottom:0px}.up{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.qk:hover{background-color:#F2F2F2}.rw:hover{background-color:none}.sy:hover{background:#000000}.sz:hover{border-color:#242424}.ua:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.ox:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.of{margin-top:56px}.op{margin-top:1.14em}.po{margin-top:32px}.qy{display:inline-block}.re{margin-bottom:104px}.ri{flex-direction:row}.rl{margin-bottom:0}.rm{margin-right:20px}.sa{max-width:500px}.sr{line-height:24px}.ss{letter-spacing:0}.ti{margin-bottom:72px}.tv{font-size:24px}.tw{line-height:30px}.tx{letter-spacing:-0.016em}.uf{margin:40px 0 0}.uk{padding-top:72px}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.pd{margin-left:auto}.pe{text-align:center}.qx{display:inline-block}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.qw{display:inline-block}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.pt{padding:10px 12px 10px}.qv{display:inline-block}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.ob{margin-top:40px}.ol{margin-top:1.34em}.pk{margin-top:24px}.qu{display:inline-block}.ra{margin-bottom:96px}.rt{margin-bottom:20px}.ru{margin-right:0}.se{max-width:100%}.sh{font-size:24px}.si{line-height:30px}.sj{letter-spacing:-0.016em}.te{margin-bottom:64px}.tj{font-size:20px}.tk{line-height:24px}.tl{letter-spacing:0}.ub{margin:32px 0 0}.ug{padding-top:48px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.oe{margin-top:56px}.oo{margin-top:1.14em}.pn{margin-top:32px}.rd{margin-bottom:104px}.rj{flex-direction:row}.rn{margin-bottom:0}.ro{margin-right:20px}.sb{max-width:500px}.sp{line-height:24px}.sq{letter-spacing:0}.th{margin-bottom:72px}.ts{font-size:24px}.tt{line-height:30px}.tu{letter-spacing:-0.016em}.ue{margin:40px 0 0}.uj{padding-top:72px}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.od{margin-top:56px}.on{margin-top:1.14em}.pm{margin-top:32px}.rc{margin-bottom:104px}.rk{flex-direction:row}.rp{margin-bottom:0}.rq{margin-right:20px}.sc{max-width:500px}.sn{line-height:24px}.so{letter-spacing:0}.tg{margin-bottom:72px}.tp{font-size:24px}.tq{line-height:30px}.tr{letter-spacing:-0.016em}.ud{margin:40px 0 0}.ui{padding-top:72px}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.oc{margin-top:40px}.om{margin-top:1.34em}.pl{margin-top:24px}.rb{margin-bottom:96px}.rr{margin-bottom:20px}.rs{margin-right:0}.sd{max-width:100%}.sk{font-size:24px}.sl{line-height:30px}.sm{letter-spacing:-0.016em}.tf{margin-bottom:64px}.tm{font-size:20px}.tn{line-height:24px}.to{letter-spacing:0}.uc{margin:32px 0 0}.uh{padding-top:48px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="print">.qs{display:none}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="561" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ou{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F925549a105b2&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="fed1" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle"><strong class="al">What happened between the BigBadWolf and the Tiger?</strong></h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@asuna.amawaka?source=post_page---byline--925549a105b2--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="asuna amawaka" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*La4u414Rn4EMK1D8bYBRag.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/insomniacs?source=post_page---byline--925549a105b2--------------------------------" rel="noopener follow"><div class="l ii ij by id ik"><div class="l fj"><img alt="insomniacs" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@asuna.amawaka?source=post_page---byline--925549a105b2--------------------------------">asuna amawaka</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddd44ddb6480&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=post_page-ddd44ddb6480--byline--925549a105b2---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/insomniacs?source=post_page---byline--925549a105b2--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">insomniacs</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">May 20, 2020</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2F925549a105b2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---header_actions--925549a105b2---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F925549a105b2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;source=---header_actions--925549a105b2---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="8e9a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">While I was doing research for my previous posts, I came across mentions of a trending Chinese-language-based C2-side controller called 大灰狼 (pronounced as Da Hui Lang, which translates literally to Big Gray Wolf). I’m just going to call it BigBadWolf here :) Simply because the name is cute, I picked it up and took a closer look. Turns out, it is modelled after (or should I say, it’s an edit of) the infamous Gh0stRAT, and samples that are built from the BigBadWolf matches Gh0stRAT signatures, as well as this YARA rule [1]:</p><blockquote class="nu nv nw"><p id="4934" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">rule IronTiger_Gh0stRAT_variant<br/>{<br/> meta:<br/> author=”Cyber Safety Solutions, Trend Micro”<br/> comment=”This is a detection for a s.exe variant seen in Op. Iron Tiger”</p><p id="1dff" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">strings:<br/> $mz=”MZ”<br/> $str1=”Game Over Good Luck By Wind” nocase wide ascii<br/> $str2=”ReleiceName” nocase wide ascii<br/> $str3=”jingtisanmenxiachuanxiao.vbs” nocase wide ascii<br/> $str4=”Winds Update” nocase wide ascii</p><p id="b597" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">condition:<br/> $mz at 0 and (any of ($str*))<br/>}</p></blockquote><p id="8018" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">There are plenty of articles and analysis walkthroughs out there on Gh0stRATs, given its very long history. However, I decided to go ahead to further this exploration because I’ve seen this YARA rule hit often enough to wonder about whether the samples are really related to Iron Tiger, or could it be the case that the strings are no longer unique enough to identify any particular variant.</p><p id="8c49" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I’m sure that in your lifetime browsing VirusTotal, you would have come across community comments like this:</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9w40wiqRpF8GwtKV1wjyIw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9w40wiqRpF8GwtKV1wjyIw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9w40wiqRpF8GwtKV1wjyIw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9w40wiqRpF8GwtKV1wjyIw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9w40wiqRpF8GwtKV1wjyIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9w40wiqRpF8GwtKV1wjyIw.png 1100w, https://miro.medium.com/v2/resize:fit:1172/format:webp/1*9w40wiqRpF8GwtKV1wjyIw.png 1172w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 586px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9w40wiqRpF8GwtKV1wjyIw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9w40wiqRpF8GwtKV1wjyIw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9w40wiqRpF8GwtKV1wjyIw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9w40wiqRpF8GwtKV1wjyIw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9w40wiqRpF8GwtKV1wjyIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9w40wiqRpF8GwtKV1wjyIw.png 1100w, https://miro.medium.com/v2/resize:fit:1172/1*9w40wiqRpF8GwtKV1wjyIw.png 1172w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 586px"/><img alt="" class="bh md oh c" width="586" height="260" loading="lazy" role="presentation"/></picture></div></figure><p id="f17c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I was not able to get my hands on the exact sample that this rule was based on but I did find a few other samples that contains those strings, and I picked 3 to do comparisons with binaries generated from the BigBadWolf builder:</p><ul class=""><li id="5ba1" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt oi oj ok bk">BBE7D708310EC7E5F981CE4BA9928A19C4D2169B5520FFA573085F9698F90C25</li><li id="afb0" class="mw mx gu my b mz ol nb nc nd om nf ng nh on nj nk nl oo nn no np op nr ns nt oi oj ok bk">C02A360C6F64609403B4E4D4FC130014C40EBB77F71DF816C6408851C7C9ED54</li><li id="df41" class="mw mx gu my b mz ol nb nc nd om nf ng nh on nj nk nl oo nn no np op nr ns nt oi oj ok bk">9DCDDC7FFCE78526057888B43B57E76BA7F3FED0C13FB4FA4214DCB08412C447</li></ul><p id="a8fd" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">While I was preparing this post, I came across a tweet[2] from malwaremustd1e that mentioned a “KuGou” backdoor along with screenshots that looked somewhat like what I observed while exploring BigBadWolf. I added these files as part of my comparison attempts, later in this post.</p><ul class=""><li id="f0f0" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt oi oj ok bk">852FA14860260023289EE6577DBD5E0193DF31DAE5F3C078142D3CAC030C7462 (EXE dropper)</li><li id="ff45" class="mw mx gu my b mz ol nb nc nd om nf ng nh on nj nk nl oo nn no np op nr ns nt oi oj ok bk">7BAEE22C9834BEF64F0C1B7F5988D9717855942D87C82F019606D07589BC51A9 (DLL RAT)</li></ul><p id="d1c7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s get started!</p><p id="a412" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">The Misunderstood Wolf?</strong></p><p id="8ef4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Maybe it all started as a tool for education. Really. It even came with a warning against doing evil with this toolkit. Although ticking that checkbox at the bottom of the disclaimer does felt a little like “I solemnly swear I am up to no good”.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qX4fZ1bJD8l0x649A_IgJw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qX4fZ1bJD8l0x649A_IgJw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qX4fZ1bJD8l0x649A_IgJw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qX4fZ1bJD8l0x649A_IgJw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qX4fZ1bJD8l0x649A_IgJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qX4fZ1bJD8l0x649A_IgJw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*qX4fZ1bJD8l0x649A_IgJw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qX4fZ1bJD8l0x649A_IgJw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qX4fZ1bJD8l0x649A_IgJw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qX4fZ1bJD8l0x649A_IgJw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qX4fZ1bJD8l0x649A_IgJw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qX4fZ1bJD8l0x649A_IgJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qX4fZ1bJD8l0x649A_IgJw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*qX4fZ1bJD8l0x649A_IgJw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="420" loading="lazy" role="presentation"/></picture></div></figure><p id="2ff8" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The builder component comes with the standard set of features e.g. specify the C2 IP address, mutex, name of the service to create for persistency, location to store the malicious binary on disk, options to delete the binary upon single run. There seems to be another binary (“1.dll” shown in the screen capture) that needs to be downloaded by the generated binary. Leaving this field blank causes the build to fail. This is quite typical of a Gh0stRAT deployment — a simple dropper/loader and a DLL that contains the main logic of the RAT.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*8e6vxKBYB1Y6qRGeWOSF6Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="316" loading="lazy" role="presentation"/></picture></div></figure><p id="5642" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I found a copy of the required DLL file that came within the bundle of C2-side binaries, and it looks to be encoded/encrypted. The last 32 bytes of the file looks like a marker of sorts. Make a mental note of this, we’ll see how this is used later.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz or"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Bcw_-ATx-EdlOyJZ1oifBg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Bcw_-ATx-EdlOyJZ1oifBg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Bcw_-ATx-EdlOyJZ1oifBg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Bcw_-ATx-EdlOyJZ1oifBg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Bcw_-ATx-EdlOyJZ1oifBg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Bcw_-ATx-EdlOyJZ1oifBg.png 1100w, https://miro.medium.com/v2/resize:fit:1368/format:webp/1*Bcw_-ATx-EdlOyJZ1oifBg.png 1368w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 684px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Bcw_-ATx-EdlOyJZ1oifBg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Bcw_-ATx-EdlOyJZ1oifBg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Bcw_-ATx-EdlOyJZ1oifBg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Bcw_-ATx-EdlOyJZ1oifBg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Bcw_-ATx-EdlOyJZ1oifBg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Bcw_-ATx-EdlOyJZ1oifBg.png 1100w, https://miro.medium.com/v2/resize:fit:1368/1*Bcw_-ATx-EdlOyJZ1oifBg.png 1368w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 684px"/><img alt="" class="bh md oh c" width="684" height="82" loading="lazy" role="presentation"/></picture></div></figure><p id="b8b1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The output of the builder is a rather lightweight (9.5KB) EXE file, with almost no strings to analyze. Thankfully, there is still something to hint of “evilness” within this executable — two sets of base64 encoded strings.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*olN3UWyLzu0GNhUTE-Z4XQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*olN3UWyLzu0GNhUTE-Z4XQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*olN3UWyLzu0GNhUTE-Z4XQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*olN3UWyLzu0GNhUTE-Z4XQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*olN3UWyLzu0GNhUTE-Z4XQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*olN3UWyLzu0GNhUTE-Z4XQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*olN3UWyLzu0GNhUTE-Z4XQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*olN3UWyLzu0GNhUTE-Z4XQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*olN3UWyLzu0GNhUTE-Z4XQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*olN3UWyLzu0GNhUTE-Z4XQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*olN3UWyLzu0GNhUTE-Z4XQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*olN3UWyLzu0GNhUTE-Z4XQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*olN3UWyLzu0GNhUTE-Z4XQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*olN3UWyLzu0GNhUTE-Z4XQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="326" loading="lazy" role="presentation"/></picture></div></figure><p id="c06e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The use of these strings are very quickly found within the binary.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*a8yOOPjac3YKUAgjINnNsg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*a8yOOPjac3YKUAgjINnNsg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*a8yOOPjac3YKUAgjINnNsg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*a8yOOPjac3YKUAgjINnNsg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*a8yOOPjac3YKUAgjINnNsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*a8yOOPjac3YKUAgjINnNsg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*a8yOOPjac3YKUAgjINnNsg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*a8yOOPjac3YKUAgjINnNsg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*a8yOOPjac3YKUAgjINnNsg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*a8yOOPjac3YKUAgjINnNsg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*a8yOOPjac3YKUAgjINnNsg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*a8yOOPjac3YKUAgjINnNsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*a8yOOPjac3YKUAgjINnNsg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*a8yOOPjac3YKUAgjINnNsg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="531" loading="lazy" role="presentation"/></picture></div></figure><p id="9c39" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The first set of string can be decoded with base64, ADD 0x7a and finally a XOR 0x59. This gives us the address to fetch the DLL that we specified in the builder. ADD and XOR operations are typical encoding seen in Gh0stRAT variants.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz os"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1J70RGBTZ8BJambjC8yRsg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1J70RGBTZ8BJambjC8yRsg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1J70RGBTZ8BJambjC8yRsg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1J70RGBTZ8BJambjC8yRsg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1J70RGBTZ8BJambjC8yRsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1J70RGBTZ8BJambjC8yRsg.png 1100w, https://miro.medium.com/v2/resize:fit:1036/format:webp/1*1J70RGBTZ8BJambjC8yRsg.png 1036w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 518px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*1J70RGBTZ8BJambjC8yRsg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1J70RGBTZ8BJambjC8yRsg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1J70RGBTZ8BJambjC8yRsg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1J70RGBTZ8BJambjC8yRsg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1J70RGBTZ8BJambjC8yRsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1J70RGBTZ8BJambjC8yRsg.png 1100w, https://miro.medium.com/v2/resize:fit:1036/1*1J70RGBTZ8BJambjC8yRsg.png 1036w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 518px"/><img alt="" class="bh md oh c" width="518" height="434" loading="lazy" role="presentation"/></picture></div></figure><p id="cd1e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The binary then proceeds to download this DLL and store it in C:\Program Files\AppPatch. This path is not configurable within the builder. As said earlier, the DLL is the meat of the RAT — all the EXE does is to download it, decrypt it, execute it and load the configuration data into its memory. Speaking of configuration data, that happens to be the second set of encoded strings we saw. The decoding of that set of string is the responsibility of the DLL. We’ll look at that in awhile.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qP9qRSkcqR6MlOQ0bHb7eA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qP9qRSkcqR6MlOQ0bHb7eA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qP9qRSkcqR6MlOQ0bHb7eA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qP9qRSkcqR6MlOQ0bHb7eA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qP9qRSkcqR6MlOQ0bHb7eA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qP9qRSkcqR6MlOQ0bHb7eA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*qP9qRSkcqR6MlOQ0bHb7eA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qP9qRSkcqR6MlOQ0bHb7eA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qP9qRSkcqR6MlOQ0bHb7eA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qP9qRSkcqR6MlOQ0bHb7eA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qP9qRSkcqR6MlOQ0bHb7eA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qP9qRSkcqR6MlOQ0bHb7eA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qP9qRSkcqR6MlOQ0bHb7eA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*qP9qRSkcqR6MlOQ0bHb7eA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="334" loading="lazy" role="presentation"/></picture></div></figure><p id="cdc1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s talk about the DLL. After receiving the DLL, the loader checks for the magic footer before proceeding to decrypt it.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iKJtohQb0mH7fp9j6LYeJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iKJtohQb0mH7fp9j6LYeJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iKJtohQb0mH7fp9j6LYeJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iKJtohQb0mH7fp9j6LYeJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iKJtohQb0mH7fp9j6LYeJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iKJtohQb0mH7fp9j6LYeJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*iKJtohQb0mH7fp9j6LYeJQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iKJtohQb0mH7fp9j6LYeJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iKJtohQb0mH7fp9j6LYeJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iKJtohQb0mH7fp9j6LYeJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iKJtohQb0mH7fp9j6LYeJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iKJtohQb0mH7fp9j6LYeJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iKJtohQb0mH7fp9j6LYeJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*iKJtohQb0mH7fp9j6LYeJQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="548" loading="lazy" role="presentation"/></picture></div></figure><p id="1001" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The decryption algorithm is nothing fanciful, just RC4, where the key is “Kother599”. One more thing that we have to do before we can analyze this DLL with a disassembler: unpack it with ‘upx -d’.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*G2z9IN0zBEBK9PGo6Hbs2A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*G2z9IN0zBEBK9PGo6Hbs2A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*G2z9IN0zBEBK9PGo6Hbs2A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*G2z9IN0zBEBK9PGo6Hbs2A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*G2z9IN0zBEBK9PGo6Hbs2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*G2z9IN0zBEBK9PGo6Hbs2A.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*G2z9IN0zBEBK9PGo6Hbs2A.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*G2z9IN0zBEBK9PGo6Hbs2A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*G2z9IN0zBEBK9PGo6Hbs2A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*G2z9IN0zBEBK9PGo6Hbs2A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*G2z9IN0zBEBK9PGo6Hbs2A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*G2z9IN0zBEBK9PGo6Hbs2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*G2z9IN0zBEBK9PGo6Hbs2A.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*G2z9IN0zBEBK9PGo6Hbs2A.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="485" loading="lazy" role="presentation"/></picture></div></figure><p id="5683" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Your big ears are showing, grandma…</strong></p><p id="b01b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The first thing that the DLL is tasked to do is to decode the configuration data. Most of this configuration data is set in the builder, while some appears to be hardcoded.</p><p id="3534" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The decoding of the configuration is the same sequence (but using different hex values) seen above: base64, ADD 0x77, XOR 0x56.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*aNHaExa1-wXHEvMtROtfQA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*aNHaExa1-wXHEvMtROtfQA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*aNHaExa1-wXHEvMtROtfQA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*aNHaExa1-wXHEvMtROtfQA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*aNHaExa1-wXHEvMtROtfQA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*aNHaExa1-wXHEvMtROtfQA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*aNHaExa1-wXHEvMtROtfQA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*aNHaExa1-wXHEvMtROtfQA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*aNHaExa1-wXHEvMtROtfQA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*aNHaExa1-wXHEvMtROtfQA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*aNHaExa1-wXHEvMtROtfQA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*aNHaExa1-wXHEvMtROtfQA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*aNHaExa1-wXHEvMtROtfQA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*aNHaExa1-wXHEvMtROtfQA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="323" loading="lazy" role="presentation"/></picture></div></figure><p id="792a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The structure is as such:</p><p id="654c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">[C2 Address][QQ User ID][C2 Port 1][C2 Port 2][RC4 Password][Version][Service Name][Service Display Name][Service Description][Installation Path][Filename][Mutex][Group Option][Additional Download][Installation Type, Logging Options][IP address tool][placeholder string][reverse DNS tool][placeholder strings][QQ profile URL]</p><p id="7cc7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now we come to the interesting part — the callbacks. As we know, Gh0stRATs have their signature 5-byte magic headers (the length varies in some cases, I know), followed by some size information, and finally the Zlib compressed data. However, I don’t see this structure in the traffic. What I do see is a Zlib header magic 0x78 9C. Let’s see what happened to the first few bytes prior to this Zlib header.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0Nfh1xq7FpMRjitcoYOiQg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0Nfh1xq7FpMRjitcoYOiQg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0Nfh1xq7FpMRjitcoYOiQg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0Nfh1xq7FpMRjitcoYOiQg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0Nfh1xq7FpMRjitcoYOiQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0Nfh1xq7FpMRjitcoYOiQg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*0Nfh1xq7FpMRjitcoYOiQg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0Nfh1xq7FpMRjitcoYOiQg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0Nfh1xq7FpMRjitcoYOiQg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0Nfh1xq7FpMRjitcoYOiQg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0Nfh1xq7FpMRjitcoYOiQg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0Nfh1xq7FpMRjitcoYOiQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0Nfh1xq7FpMRjitcoYOiQg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*0Nfh1xq7FpMRjitcoYOiQg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="368" loading="lazy" role="presentation"/></picture></div></figure><p id="4f92" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">It’s not hard to identify the part that performs the encryption (RC4 again) of the communicated data. However, the author made a choice not to encrypt the entire data, but only the header portion, consisting of the 5byte magic, size of entire data, size of uncompressed payload, a total of 0xD bytes. This is done perhaps in a (futile) attempt to evade standard network signatures used to identify Gh0stRAT communications. However, since the length of the header remains the same after encryption, a slight tweak to such network signatures should suffice to work. The key used in the encryption is found within the configuration data earlier read by the binary. This key is made up of &lt;user defined password within builder&gt; appended with &lt;username used to login to the C2&gt;.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fXDUmw2DqPqfpO9tU024-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fXDUmw2DqPqfpO9tU024-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fXDUmw2DqPqfpO9tU024-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fXDUmw2DqPqfpO9tU024-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fXDUmw2DqPqfpO9tU024-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fXDUmw2DqPqfpO9tU024-Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*fXDUmw2DqPqfpO9tU024-Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fXDUmw2DqPqfpO9tU024-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fXDUmw2DqPqfpO9tU024-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fXDUmw2DqPqfpO9tU024-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fXDUmw2DqPqfpO9tU024-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fXDUmw2DqPqfpO9tU024-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fXDUmw2DqPqfpO9tU024-Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*fXDUmw2DqPqfpO9tU024-Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="434" loading="lazy" role="presentation"/></picture></div></figure><p id="7841" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">And I huff and I puff, to clear the mysterious fog surrounding these samples!</strong></p><p id="ebbd" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">So what made these samples get flagged with that YARA rule I mentioned in the beginning of this post?</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz ot"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*klIpwtaTB-KJBxHju6nZJA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*klIpwtaTB-KJBxHju6nZJA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*klIpwtaTB-KJBxHju6nZJA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*klIpwtaTB-KJBxHju6nZJA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*klIpwtaTB-KJBxHju6nZJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*klIpwtaTB-KJBxHju6nZJA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*klIpwtaTB-KJBxHju6nZJA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*klIpwtaTB-KJBxHju6nZJA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*klIpwtaTB-KJBxHju6nZJA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*klIpwtaTB-KJBxHju6nZJA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*klIpwtaTB-KJBxHju6nZJA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*klIpwtaTB-KJBxHju6nZJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*klIpwtaTB-KJBxHju6nZJA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*klIpwtaTB-KJBxHju6nZJA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="88" loading="lazy" role="presentation"/></picture></div></div></figure><p id="6893" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The presence of this strange VBS name:</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz oy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-Z9KPfJEXZ607dxAEFa6og.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-Z9KPfJEXZ607dxAEFa6og.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-Z9KPfJEXZ607dxAEFa6og.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-Z9KPfJEXZ607dxAEFa6og.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-Z9KPfJEXZ607dxAEFa6og.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-Z9KPfJEXZ607dxAEFa6og.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Z9KPfJEXZ607dxAEFa6og.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-Z9KPfJEXZ607dxAEFa6og.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-Z9KPfJEXZ607dxAEFa6og.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-Z9KPfJEXZ607dxAEFa6og.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-Z9KPfJEXZ607dxAEFa6og.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-Z9KPfJEXZ607dxAEFa6og.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-Z9KPfJEXZ607dxAEFa6og.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-Z9KPfJEXZ607dxAEFa6og.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="378" loading="lazy" role="presentation"/></picture></div></div></figure><p id="cd83" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">What does this VBS do? I gave the function some mock data as arguments, and the contents of the VBS is formed as follows. Looks like it is just for creating or manipulating a user account with “net user”. The name of the VBS is not related to its contents. Just for fun, I’m guessing “jingtisanmenxiachuanxiao” is written as 警惕三门峡传销 in Chinese, which literally translate to “Be wary of Sanmenxia MLM”. Strange name to give to a script in any case.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz oz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tmbiOVEb3KSVNJTAtOO50Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tmbiOVEb3KSVNJTAtOO50Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tmbiOVEb3KSVNJTAtOO50Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tmbiOVEb3KSVNJTAtOO50Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tmbiOVEb3KSVNJTAtOO50Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tmbiOVEb3KSVNJTAtOO50Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tmbiOVEb3KSVNJTAtOO50Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*tmbiOVEb3KSVNJTAtOO50Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tmbiOVEb3KSVNJTAtOO50Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tmbiOVEb3KSVNJTAtOO50Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tmbiOVEb3KSVNJTAtOO50Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tmbiOVEb3KSVNJTAtOO50Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tmbiOVEb3KSVNJTAtOO50Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tmbiOVEb3KSVNJTAtOO50Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="391" loading="lazy" role="presentation"/></picture></div></div></figure><p id="c92c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The exact same function is found in all 4 files I cross-examined.</p><p id="d9cc" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now, let’s find out if they are all BigBadWolf related.</p><p id="4ff5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The laziest way to start is to do BinDiff on the 3 files in relation to the DLL related to BigBadWolf. Results from BinDiff, pretty high scores. Not surprising, since they all stemmed from Gh0st code.</p><ul class=""><li id="f873" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt oi oj ok bk">Similarity with C02A360C6F64609403B4E4D4FC130014C40EBB77F71DF816C6408851C7C9ED54<br/>Confidence 0.988735 | Similarity 0.886978</li><li id="918f" class="mw mx gu my b mz ol nb nc nd om nf ng nh on nj nk nl oo nn no np op nr ns nt oi oj ok bk">Similarity with BBE7D708310EC7E5F981CE4BA9928A19C4D2169B5520FFA573085F9698F90C25<br/>Confidence 0.984084 | Similarity 0.767249</li><li id="616d" class="mw mx gu my b mz ol nb nc nd om nf ng nh on nj nk nl oo nn no np op nr ns nt oi oj ok bk">Similarity with 9DCDDC7FFCE78526057888B43B57E76BA7F3FED0C13FB4FA4214DCB08412C447<br/>Confidence 0.988665 | Similarity 0.879644</li></ul><p id="dff5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">What are the differences then? Looks like all of the 3 has a different magic header — “KuGou”, while the binary from BigBadWolf has “DHLAQ” as the magic (if you didn’t notice, DHL is the acronym of its Chinese name Da Hui Lang). The size of the RC4 encrypted header also differs.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz pa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FrN4r3XCClnASh9wK14MZA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FrN4r3XCClnASh9wK14MZA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FrN4r3XCClnASh9wK14MZA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FrN4r3XCClnASh9wK14MZA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FrN4r3XCClnASh9wK14MZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FrN4r3XCClnASh9wK14MZA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrN4r3XCClnASh9wK14MZA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FrN4r3XCClnASh9wK14MZA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FrN4r3XCClnASh9wK14MZA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FrN4r3XCClnASh9wK14MZA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FrN4r3XCClnASh9wK14MZA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FrN4r3XCClnASh9wK14MZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FrN4r3XCClnASh9wK14MZA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FrN4r3XCClnASh9wK14MZA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="297" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pb ff pc ny nz pd pe bf b bg z du">Left: from BigBadWolf; Right: from BBE7D708310EC7E5F981CE4BA9928A19C4D2169B5520FFA573085F9698F90C25</figcaption></figure><p id="0795" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Another obvious difference is that the configuration data is not given as an encoded input, but instead found as plaintext strings handled directly within the functions.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*Z6lz5HqBsKYQu_6z3Y2xwQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="547" loading="lazy" role="presentation"/></picture></div></figure><p id="d110" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">So, there is another Gh0st variant out there similar to BigBadWolf but yet implemented differently in some ways, let’s call this set “KuGou”.</p><p id="b920" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Remember at the start of this post, I mentioned some KuGou malware tweeted by malwaremustd1e? Let’s see if they are the same as the 3 KuGou binaries we saw above.</p><p id="1363" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The dropper EXE (SHA256: 852FA14860260023289EE6577DBD5E0193DF31DAE5F3C078142D3CAC030C7462) contains encoded string that points the binary to download its DLL payload. Familiar yes?</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz pf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ETvWvDNplHnRjC888dzEaA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ETvWvDNplHnRjC888dzEaA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ETvWvDNplHnRjC888dzEaA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ETvWvDNplHnRjC888dzEaA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ETvWvDNplHnRjC888dzEaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ETvWvDNplHnRjC888dzEaA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ETvWvDNplHnRjC888dzEaA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ETvWvDNplHnRjC888dzEaA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ETvWvDNplHnRjC888dzEaA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ETvWvDNplHnRjC888dzEaA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ETvWvDNplHnRjC888dzEaA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ETvWvDNplHnRjC888dzEaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ETvWvDNplHnRjC888dzEaA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ETvWvDNplHnRjC888dzEaA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="294" loading="lazy" role="presentation"/></picture></div></div></figure><p id="20b2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The downloaded DLL (SHA256: 7BAEE22C9834BEF64F0C1B7F5988D9717855942D87C82F019606D07589BC51A9) is RC4-decrypted with key “Kother599”. Again, familiar! There’s a slight difference here, the EXE did not verify that the file has a footer signature e.g. “SSSSSSVID:2014-SV8”, and the DLL does not contain such a footer.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz pg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*te_0lZ0O3O1JtaGcTTKdIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*te_0lZ0O3O1JtaGcTTKdIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*te_0lZ0O3O1JtaGcTTKdIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*te_0lZ0O3O1JtaGcTTKdIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*te_0lZ0O3O1JtaGcTTKdIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*te_0lZ0O3O1JtaGcTTKdIQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*te_0lZ0O3O1JtaGcTTKdIQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*te_0lZ0O3O1JtaGcTTKdIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*te_0lZ0O3O1JtaGcTTKdIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*te_0lZ0O3O1JtaGcTTKdIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*te_0lZ0O3O1JtaGcTTKdIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*te_0lZ0O3O1JtaGcTTKdIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*te_0lZ0O3O1JtaGcTTKdIQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*te_0lZ0O3O1JtaGcTTKdIQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="540" loading="lazy" role="presentation"/></picture></div></div></figure><p id="1d75" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The next difference lies in the configuration data passed to be decrypted by the DLL. In this binary, the configuration is encrypted with RC4, and not just Base64/ADD/XOR encoded as seen from the BigBadWolf’s DLL. RC4 key used here is “Strong798”. Notice how the structure of the configuration after decryption is identical to what we saw in BigBadWolf. And even that string of Chinese (监测和监视新硬件设备并自动更新设备驱动) used as Service Description is identical.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz ph"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9L3HTrTYBKobJUbQqexNag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9L3HTrTYBKobJUbQqexNag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9L3HTrTYBKobJUbQqexNag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9L3HTrTYBKobJUbQqexNag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9L3HTrTYBKobJUbQqexNag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9L3HTrTYBKobJUbQqexNag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9L3HTrTYBKobJUbQqexNag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9L3HTrTYBKobJUbQqexNag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9L3HTrTYBKobJUbQqexNag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9L3HTrTYBKobJUbQqexNag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9L3HTrTYBKobJUbQqexNag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9L3HTrTYBKobJUbQqexNag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9L3HTrTYBKobJUbQqexNag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9L3HTrTYBKobJUbQqexNag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="316" loading="lazy" role="presentation"/></picture></div></div></figure><p id="0da2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Since the configuration data is encrypted in a different manner, there must be another server-side binary responsible for building this sample. To my surprise, the 5-byte magic used in the communications is “DHLAR”. Perhaps this explains the similarities shared with our BigBadWolf sample. Another thing is for sure, this file does not belong to the same set as the 3 “KuGou” binaries we just looked at. If I had to pin a family name to this file, it would be BigBadWolf.</p><figure class="ob oc od oe of og ny nz paragraph-image"><div class="ny nz oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yLoc9NQkQG_OLqHorVhyaA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yLoc9NQkQG_OLqHorVhyaA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yLoc9NQkQG_OLqHorVhyaA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yLoc9NQkQG_OLqHorVhyaA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yLoc9NQkQG_OLqHorVhyaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yLoc9NQkQG_OLqHorVhyaA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*yLoc9NQkQG_OLqHorVhyaA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*yLoc9NQkQG_OLqHorVhyaA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yLoc9NQkQG_OLqHorVhyaA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yLoc9NQkQG_OLqHorVhyaA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yLoc9NQkQG_OLqHorVhyaA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yLoc9NQkQG_OLqHorVhyaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yLoc9NQkQG_OLqHorVhyaA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*yLoc9NQkQG_OLqHorVhyaA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oh c" width="602" height="795" loading="lazy" role="presentation"/></picture></div></figure><p id="718c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">A search on Google pointed me to a Operation PZCHAO report by BitDefender[3], in which a jingtisanmenxiachuanxiao.vbs of a different content is documented. The samples that were described in this report somewhat bear resemblance to what we are seeing in BigBadWolf’s DLL, yet there are differences.</p><p id="d991" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">For example,</p><blockquote class="nu nv nw"><p id="8cba" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">“the malware then searches inside its own binary for a string delimiter SSSSSSS, returning a string pointer to the beginning of the encrypted configuration string”</p></blockquote><p id="5191" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">This is similar to how our sample looks for the marker SSSSSS (note the length here is only 6) to verify that the DLL downloaded is correct before proceeding to decrypt.</p><p id="4de7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">As another example,</p><blockquote class="nu nv nw"><p id="71fb" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">“Until it checks in with its C2 controller, the RAT server searches for the encrypted configuration buffer containing the C&amp;Cs that will get decrypted using an AES key derived from a hardcoded string “Mother360””</p></blockquote><p id="b945" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The configuration is encoded with base64/ADD/XOR in BigBadWolf sample instead. Even when encryption is used, the algorithm in place is RC4.</p><p id="4015" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Yet, this sample documented by Bitdefender will also match the Yara rule on “s.exe variant”, based on the presence of the strings within the file. And we now know that it is a different variant from BigBadWolf, and even KuGou.</p><p id="6940" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">What a dreadful night!</strong></p><p id="3f6b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I think you’re lost. Let’s try to summarise all of these information:</p><figure class="ob oc od oe of og ny nz paragraph-image"><div role="button" tabindex="0" class="ou ov fj ow bh ox"><div class="ny nz pi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VlJqTV8gatMMaIQohJwMEA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VlJqTV8gatMMaIQohJwMEA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VlJqTV8gatMMaIQohJwMEA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VlJqTV8gatMMaIQohJwMEA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VlJqTV8gatMMaIQohJwMEA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VlJqTV8gatMMaIQohJwMEA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VlJqTV8gatMMaIQohJwMEA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VlJqTV8gatMMaIQohJwMEA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VlJqTV8gatMMaIQohJwMEA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VlJqTV8gatMMaIQohJwMEA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VlJqTV8gatMMaIQohJwMEA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VlJqTV8gatMMaIQohJwMEA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VlJqTV8gatMMaIQohJwMEA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*VlJqTV8gatMMaIQohJwMEA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oh c" width="700" height="413" loading="lazy" role="presentation"/></picture></div></div></figure><p id="d9ac" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">At the end of the day, I think I’ve established (further) that Gh0stRATs has too many variants. The builder that was behind that particular s.exe seen in Operation Iron Tiger has perhaps been referenced/ modified/ improved, causing other binaries to contain similar keywords but belong to different subvariants of Gh0stRAT that probably has nothing to do with the s.exe and its user (adversary group).</p><p id="8fa0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Phew, glad I’ve got all of that information sorted out :)</p><p id="dc4c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">That’s it for today!</p><p id="108f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">[1]: Operation Iron Tiger Appendix, TrendLabs Security Intelligence Blog, 2015<br/>[2]: <a class="af pj" href="https://twitter.com/malwaremustd1e/status/1262274362872229888" rel="noopener ugc nofollow" target="_blank">https://twitter.com/malwaremustd1e/status/1262274362872229888</a><br/>[3]: Operation PZCHAO, Bitdefender, 2017</p><p id="9152" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">~~</p><div class="pk pl pm pn po pp"><a href="https://twitter.com/AsunaAmawaka?source=post_page-----925549a105b2--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pq ab ix"><div class="pr ab co cb ps pt"><h2 class="bf gv io z jf pu jh ji pv jk jm gt bk">Asuna</h2><div class="pw l"><h3 class="bf b io z jf pu jh ji pv jk jm du">The latest Tweets from Asuna (@AsunaAmawaka). [Malware Analyst]. Binary World</h3></div><div class="px l"><p class="bf b dv z jf pu jh ji pv jk jm du">twitter.com</p></div></div><div class="py l"><div class="pz l qa qb qc py qd md pp"></div></div></div></a></div><p id="ff7f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Drop me a DM if you would like to share findings or samples ;)</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qe qf ab ja"><div class="pw ab"><a class="qg ay am ao" rel="noopener follow" href="/tag/reverse-engineering?source=post_page-----925549a105b2--------------------------------"><div class="qh fj cx qi ge qj qk bf b bg z bk ql">Reverse Engineering</div></a></div><div class="pw ab"><a class="qg ay am ao" rel="noopener follow" href="/tag/malware-analysis?source=post_page-----925549a105b2--------------------------------"><div class="qh fj cx qi ge qj qk bf b bg z bk ql">Malware Analysis</div></a></div><div class="pw ab"><a class="qg ay am ao" rel="noopener follow" href="/tag/gh0strat?source=post_page-----925549a105b2--------------------------------"><div class="qh fj cx qi ge qj qk bf b bg z bk ql">Gh0strat</div></a></div><div class="pw ab"><a class="qg ay am ao" rel="noopener follow" href="/tag/bigbadwolf?source=post_page-----925549a105b2--------------------------------"><div class="qh fj cx qi ge qj qk bf b bg z bk ql">Bigbadwolf</div></a></div><div class="pw ab"><a class="qg ay am ao" rel="noopener follow" href="/tag/大灰狼?source=post_page-----925549a105b2--------------------------------"><div class="qh fj cx qi ge qj qk bf b bg z bk ql">大灰狼</div></a></div></div></div></div><div class="l"></div><footer class="qm qn qo qp qq ab q qr ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp qs"><div class="ab q kv"><div class="qt l"><span class="l qu qv qw e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2F925549a105b2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---footer_actions--925549a105b2---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f qx qy"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2F925549a105b2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---footer_actions--925549a105b2---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qz l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F925549a105b2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2&amp;source=---footer_actions--925549a105b2---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qz l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="ra rb rc rd re l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rf bh r rg"></div><div class="rh l"><div class="ab ri rj rk iz iy"><div class="rl rm rn ro rp rq rr rs rt ru ab cp"><div class="h k"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--925549a105b2--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="rv ib ic cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="48" height="48" loading="lazy"/><div class="rv l ic ib fs n fr rw"></div></div></a></div><div class="j i d"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--925549a105b2--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="rv ry rx cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="64" height="64" loading="lazy"/><div class="rv l rx ry fs n fr rw"></div></div></a></div><div class="j i d rz ix"><div class="ab"></div></div></div><div class="ab co ps"><div class="sa sb sc sd se l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/insomniacs?source=post_page---post_publication_info--925549a105b2--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf sg sh si sj sk sl sm nh sn so nl sp sq np sr ss bk"><span class="gn sf">Published in <!-- -->insomniacs</span></h2></a><div class="pw ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/followers?source=post_page---post_publication_info--925549a105b2--------------------------------">60 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0?source=post_page---post_publication_info--925549a105b2--------------------------------">Last published <span>Jun 23, 2022</span></a></div></div><div class="st l"><p class="bf b bg z bk"><span class="gn">reverse engineering away those sleepless nights</span></p></div></div></div><div class="h k"><div class="ab"></div></div></div></div><div class="ab ri rj rk iz iy"><div class="rl rm rn ro rp rq rr rs rt ru ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--925549a105b2--------------------------------"><div class="l fj"><img alt="asuna amawaka" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/2*La4u414Rn4EMK1D8bYBRag.png" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay rw"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--925549a105b2--------------------------------"><div class="l fj"><img alt="asuna amawaka" class="l fd by rx ry cx" src="https://miro.medium.com/v2/resize:fill:128:128/2*La4u414Rn4EMK1D8bYBRag.png" width="64" height="64" loading="lazy"/><div class="fr by l rx ry fs n ay rw"></div></div></a></div><div class="j i d rz ix"><div class="ab"><span><button class="bf b bg z su qh sv sw sx sy sz ev ew ta tb tc fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co ps"><div class="sa sb sc sd se l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--925549a105b2--------------------------------"><h2 class="pw-author-name bf sg sh si sj sk sl sm nh sn so nl sp sq np sr ss bk"><span class="gn sf">Written by <!-- -->asuna amawaka</span></h2></a><div class="pw ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@asuna.amawaka/followers?source=post_page---post_author_info--925549a105b2--------------------------------">28 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@asuna.amawaka/following?source=post_page---post_author_info--925549a105b2--------------------------------">1 Following</a></div></div><div class="st l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z su qh sv sw sx sy sz ev ew ta tb tc fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="td l"><div class="rf bh r te tf tg th ti"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf sg tj tk tl tm tn to tp tq tr ts tt tu tv tw tx bk">No responses yet</h2><div class="ab ty"><div><div class="bm" aria-hidden="false"><a class="tz ua" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--925549a105b2--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="ub uc ud ue uf l"></div></div></div></div><div class="ug uh ui uj uk l bx"><div class="h k j"><div class="rf bh ul um"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="un ab kv ja"><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----925549a105b2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----925549a105b2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----925549a105b2--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----925549a105b2--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----925549a105b2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----925549a105b2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----925549a105b2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----925549a105b2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uo up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----925549a105b2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----925549a105b2--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-925549a105b2","user-ddd44ddb6480","collection-8dea5b1882ca"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"31a991de-bf21-4fbf-bcb6-c9c2cca75e41","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-398b2a628d3540b9d90e789e987127ca-d2664e3d2d9b2a0e-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"insomniacs\"})":{"__ref":"Collection:8dea5b1882ca"},"postResult({\"id\":\"925549a105b2\"})":{"__ref":"Post:925549a105b2"}},"Collection:8dea5b1882ca":{"__typename":"Collection","id":"8dea5b1882ca","customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"favicon":{"__ref":"ImageMetadata:"},"domain":null,"slug":"insomniacs","googleAnalyticsId":null,"name":"insomniacs","subscriberCount":60,"description":"reverse engineering away those sleepless nights","avatar":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"},"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:32da9d336ca0"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_ed3c9bd45d12"},"twitterUsername":null,"facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg":{"__typename":"ImageMetadata","id":"1*IvMGfHVzEtZei5I-JouCvw.jpeg","originalWidth":1200,"originalHeight":1200},"User:ddd44ddb6480":{"__typename":"User","id":"ddd44ddb6480","customDomainState":null,"hasSubdomain":false,"username":"asuna.amawaka","linkedAccounts":{"__ref":"LinkedAccounts:ddd44ddb6480"},"isSuspended":false,"name":"asuna amawaka","imageId":"2*La4u414Rn4EMK1D8bYBRag.png","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":28,"followingCount":0,"collectionFollowingCount":1},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:ddd44ddb6480-viewerId:lo_ed3c9bd45d12"},"twitterScreenName":""},"Post:32da9d336ca0":{"__typename":"Post","id":"32da9d336ca0","firstPublishedAt":1656002664270,"creator":{"__ref":"User:ddd44ddb6480"},"collection":{"__ref":"Collection:8dea5b1882ca"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fanalysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0","sequence":null,"uniqueSlug":"analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0"},"LinkedAccounts:ddd44ddb6480":{"__typename":"LinkedAccounts","mastodon":null,"id":"ddd44ddb6480"},"Paragraph:5512206727fc_0":{"__typename":"Paragraph","id":"5512206727fc_0","name":"fed1","type":"H3","href":null,"layout":null,"metadata":null,"text":"What happened between the BigBadWolf and the Tiger?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_1":{"__typename":"Paragraph","id":"5512206727fc_1","name":"8e9a","type":"P","href":null,"layout":null,"metadata":null,"text":"While I was doing research for my previous posts, I came across mentions of a trending Chinese-language-based C2-side controller called 大灰狼 (pronounced as Da Hui Lang, which translates literally to Big Gray Wolf). I’m just going to call it BigBadWolf here :) Simply because the name is cute, I picked it up and took a closer look. Turns out, it is modelled after (or should I say, it’s an edit of) the infamous Gh0stRAT, and samples that are built from the BigBadWolf matches Gh0stRAT signatures, as well as this YARA rule [1]:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_2":{"__typename":"Paragraph","id":"5512206727fc_2","name":"4934","type":"BQ","href":null,"layout":null,"metadata":null,"text":"rule IronTiger_Gh0stRAT_variant\n{\n meta:\n author=”Cyber Safety Solutions, Trend Micro”\n comment=”This is a detection for a s.exe variant seen in Op. Iron Tiger”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_3":{"__typename":"Paragraph","id":"5512206727fc_3","name":"1dff","type":"BQ","href":null,"layout":null,"metadata":null,"text":"strings:\n $mz=”MZ”\n $str1=”Game Over Good Luck By Wind” nocase wide ascii\n $str2=”ReleiceName” nocase wide ascii\n $str3=”jingtisanmenxiachuanxiao.vbs” nocase wide ascii\n $str4=”Winds Update” nocase wide ascii","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_4":{"__typename":"Paragraph","id":"5512206727fc_4","name":"b597","type":"BQ","href":null,"layout":null,"metadata":null,"text":"condition:\n $mz at 0 and (any of ($str*))\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_5":{"__typename":"Paragraph","id":"5512206727fc_5","name":"8018","type":"P","href":null,"layout":null,"metadata":null,"text":"There are plenty of articles and analysis walkthroughs out there on Gh0stRATs, given its very long history. However, I decided to go ahead to further this exploration because I’ve seen this YARA rule hit often enough to wonder about whether the samples are really related to Iron Tiger, or could it be the case that the strings are no longer unique enough to identify any particular variant.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_6":{"__typename":"Paragraph","id":"5512206727fc_6","name":"8c49","type":"P","href":null,"layout":null,"metadata":null,"text":"I’m sure that in your lifetime browsing VirusTotal, you would have come across community comments like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9w40wiqRpF8GwtKV1wjyIw.png":{"__typename":"ImageMetadata","id":"1*9w40wiqRpF8GwtKV1wjyIw.png","originalHeight":260,"originalWidth":586,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_7":{"__typename":"Paragraph","id":"5512206727fc_7","name":"7332","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9w40wiqRpF8GwtKV1wjyIw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_8":{"__typename":"Paragraph","id":"5512206727fc_8","name":"f17c","type":"P","href":null,"layout":null,"metadata":null,"text":"I was not able to get my hands on the exact sample that this rule was based on but I did find a few other samples that contains those strings, and I picked 3 to do comparisons with binaries generated from the BigBadWolf builder:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_9":{"__typename":"Paragraph","id":"5512206727fc_9","name":"5ba1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"BBE7D708310EC7E5F981CE4BA9928A19C4D2169B5520FFA573085F9698F90C25","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_10":{"__typename":"Paragraph","id":"5512206727fc_10","name":"afb0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"C02A360C6F64609403B4E4D4FC130014C40EBB77F71DF816C6408851C7C9ED54","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_11":{"__typename":"Paragraph","id":"5512206727fc_11","name":"df41","type":"ULI","href":null,"layout":null,"metadata":null,"text":"9DCDDC7FFCE78526057888B43B57E76BA7F3FED0C13FB4FA4214DCB08412C447","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_12":{"__typename":"Paragraph","id":"5512206727fc_12","name":"a8fd","type":"P","href":null,"layout":null,"metadata":null,"text":"While I was preparing this post, I came across a tweet[2] from malwaremustd1e that mentioned a “KuGou” backdoor along with screenshots that looked somewhat like what I observed while exploring BigBadWolf. I added these files as part of my comparison attempts, later in this post.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_13":{"__typename":"Paragraph","id":"5512206727fc_13","name":"f0f0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"852FA14860260023289EE6577DBD5E0193DF31DAE5F3C078142D3CAC030C7462 (EXE dropper)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_14":{"__typename":"Paragraph","id":"5512206727fc_14","name":"ff45","type":"ULI","href":null,"layout":null,"metadata":null,"text":"7BAEE22C9834BEF64F0C1B7F5988D9717855942D87C82F019606D07589BC51A9 (DLL RAT)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_15":{"__typename":"Paragraph","id":"5512206727fc_15","name":"d1c7","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s get started!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_16":{"__typename":"Paragraph","id":"5512206727fc_16","name":"a412","type":"P","href":null,"layout":null,"metadata":null,"text":"The Misunderstood Wolf?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_17":{"__typename":"Paragraph","id":"5512206727fc_17","name":"8ef4","type":"P","href":null,"layout":null,"metadata":null,"text":"Maybe it all started as a tool for education. Really. It even came with a warning against doing evil with this toolkit. Although ticking that checkbox at the bottom of the disclaimer does felt a little like “I solemnly swear I am up to no good”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qX4fZ1bJD8l0x649A_IgJw.png":{"__typename":"ImageMetadata","id":"1*qX4fZ1bJD8l0x649A_IgJw.png","originalHeight":420,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_18":{"__typename":"Paragraph","id":"5512206727fc_18","name":"3132","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qX4fZ1bJD8l0x649A_IgJw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_19":{"__typename":"Paragraph","id":"5512206727fc_19","name":"2ff8","type":"P","href":null,"layout":null,"metadata":null,"text":"The builder component comes with the standard set of features e.g. specify the C2 IP address, mutex, name of the service to create for persistency, location to store the malicious binary on disk, options to delete the binary upon single run. There seems to be another binary (“1.dll” shown in the screen capture) that needs to be downloaded by the generated binary. Leaving this field blank causes the build to fail. This is quite typical of a Gh0stRAT deployment — a simple dropper\u002Floader and a DLL that contains the main logic of the RAT.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8e6vxKBYB1Y6qRGeWOSF6Q.png":{"__typename":"ImageMetadata","id":"1*8e6vxKBYB1Y6qRGeWOSF6Q.png","originalHeight":316,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_20":{"__typename":"Paragraph","id":"5512206727fc_20","name":"005d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8e6vxKBYB1Y6qRGeWOSF6Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_21":{"__typename":"Paragraph","id":"5512206727fc_21","name":"5642","type":"P","href":null,"layout":null,"metadata":null,"text":"I found a copy of the required DLL file that came within the bundle of C2-side binaries, and it looks to be encoded\u002Fencrypted. The last 32 bytes of the file looks like a marker of sorts. Make a mental note of this, we’ll see how this is used later.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Bcw_-ATx-EdlOyJZ1oifBg.png":{"__typename":"ImageMetadata","id":"1*Bcw_-ATx-EdlOyJZ1oifBg.png","originalHeight":82,"originalWidth":684,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_22":{"__typename":"Paragraph","id":"5512206727fc_22","name":"6996","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Bcw_-ATx-EdlOyJZ1oifBg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_23":{"__typename":"Paragraph","id":"5512206727fc_23","name":"b8b1","type":"P","href":null,"layout":null,"metadata":null,"text":"The output of the builder is a rather lightweight (9.5KB) EXE file, with almost no strings to analyze. Thankfully, there is still something to hint of “evilness” within this executable — two sets of base64 encoded strings.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*olN3UWyLzu0GNhUTE-Z4XQ.png":{"__typename":"ImageMetadata","id":"1*olN3UWyLzu0GNhUTE-Z4XQ.png","originalHeight":326,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_24":{"__typename":"Paragraph","id":"5512206727fc_24","name":"e87a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*olN3UWyLzu0GNhUTE-Z4XQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_25":{"__typename":"Paragraph","id":"5512206727fc_25","name":"c06e","type":"P","href":null,"layout":null,"metadata":null,"text":"The use of these strings are very quickly found within the binary.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*a8yOOPjac3YKUAgjINnNsg.png":{"__typename":"ImageMetadata","id":"1*a8yOOPjac3YKUAgjINnNsg.png","originalHeight":531,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_26":{"__typename":"Paragraph","id":"5512206727fc_26","name":"c8e8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*a8yOOPjac3YKUAgjINnNsg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_27":{"__typename":"Paragraph","id":"5512206727fc_27","name":"9c39","type":"P","href":null,"layout":null,"metadata":null,"text":"The first set of string can be decoded with base64, ADD 0x7a and finally a XOR 0x59. This gives us the address to fetch the DLL that we specified in the builder. ADD and XOR operations are typical encoding seen in Gh0stRAT variants.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*1J70RGBTZ8BJambjC8yRsg.png":{"__typename":"ImageMetadata","id":"1*1J70RGBTZ8BJambjC8yRsg.png","originalHeight":434,"originalWidth":518,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_28":{"__typename":"Paragraph","id":"5512206727fc_28","name":"0aad","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1J70RGBTZ8BJambjC8yRsg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_29":{"__typename":"Paragraph","id":"5512206727fc_29","name":"cd1e","type":"P","href":null,"layout":null,"metadata":null,"text":"The binary then proceeds to download this DLL and store it in C:\\Program Files\\AppPatch. This path is not configurable within the builder. As said earlier, the DLL is the meat of the RAT — all the EXE does is to download it, decrypt it, execute it and load the configuration data into its memory. Speaking of configuration data, that happens to be the second set of encoded strings we saw. The decoding of that set of string is the responsibility of the DLL. We’ll look at that in awhile.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qP9qRSkcqR6MlOQ0bHb7eA.png":{"__typename":"ImageMetadata","id":"1*qP9qRSkcqR6MlOQ0bHb7eA.png","originalHeight":334,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_30":{"__typename":"Paragraph","id":"5512206727fc_30","name":"8f70","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qP9qRSkcqR6MlOQ0bHb7eA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_31":{"__typename":"Paragraph","id":"5512206727fc_31","name":"cdc1","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s talk about the DLL. After receiving the DLL, the loader checks for the magic footer before proceeding to decrypt it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iKJtohQb0mH7fp9j6LYeJQ.png":{"__typename":"ImageMetadata","id":"1*iKJtohQb0mH7fp9j6LYeJQ.png","originalHeight":548,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_32":{"__typename":"Paragraph","id":"5512206727fc_32","name":"689b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iKJtohQb0mH7fp9j6LYeJQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_33":{"__typename":"Paragraph","id":"5512206727fc_33","name":"1001","type":"P","href":null,"layout":null,"metadata":null,"text":"The decryption algorithm is nothing fanciful, just RC4, where the key is “Kother599”. One more thing that we have to do before we can analyze this DLL with a disassembler: unpack it with ‘upx -d’.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*G2z9IN0zBEBK9PGo6Hbs2A.png":{"__typename":"ImageMetadata","id":"1*G2z9IN0zBEBK9PGo6Hbs2A.png","originalHeight":485,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_34":{"__typename":"Paragraph","id":"5512206727fc_34","name":"163f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*G2z9IN0zBEBK9PGo6Hbs2A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_35":{"__typename":"Paragraph","id":"5512206727fc_35","name":"5683","type":"P","href":null,"layout":null,"metadata":null,"text":"Your big ears are showing, grandma…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_36":{"__typename":"Paragraph","id":"5512206727fc_36","name":"b01b","type":"P","href":null,"layout":null,"metadata":null,"text":"The first thing that the DLL is tasked to do is to decode the configuration data. Most of this configuration data is set in the builder, while some appears to be hardcoded.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_37":{"__typename":"Paragraph","id":"5512206727fc_37","name":"3534","type":"P","href":null,"layout":null,"metadata":null,"text":"The decoding of the configuration is the same sequence (but using different hex values) seen above: base64, ADD 0x77, XOR 0x56.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*aNHaExa1-wXHEvMtROtfQA.png":{"__typename":"ImageMetadata","id":"1*aNHaExa1-wXHEvMtROtfQA.png","originalHeight":323,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_38":{"__typename":"Paragraph","id":"5512206727fc_38","name":"7833","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*aNHaExa1-wXHEvMtROtfQA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_39":{"__typename":"Paragraph","id":"5512206727fc_39","name":"792a","type":"P","href":null,"layout":null,"metadata":null,"text":"The structure is as such:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_40":{"__typename":"Paragraph","id":"5512206727fc_40","name":"654c","type":"P","href":null,"layout":null,"metadata":null,"text":"[C2 Address][QQ User ID][C2 Port 1][C2 Port 2][RC4 Password][Version][Service Name][Service Display Name][Service Description][Installation Path][Filename][Mutex][Group Option][Additional Download][Installation Type, Logging Options][IP address tool][placeholder string][reverse DNS tool][placeholder strings][QQ profile URL]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_41":{"__typename":"Paragraph","id":"5512206727fc_41","name":"7cc7","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we come to the interesting part — the callbacks. As we know, Gh0stRATs have their signature 5-byte magic headers (the length varies in some cases, I know), followed by some size information, and finally the Zlib compressed data. However, I don’t see this structure in the traffic. What I do see is a Zlib header magic 0x78 9C. Let’s see what happened to the first few bytes prior to this Zlib header.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0Nfh1xq7FpMRjitcoYOiQg.png":{"__typename":"ImageMetadata","id":"1*0Nfh1xq7FpMRjitcoYOiQg.png","originalHeight":368,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_42":{"__typename":"Paragraph","id":"5512206727fc_42","name":"f735","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0Nfh1xq7FpMRjitcoYOiQg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_43":{"__typename":"Paragraph","id":"5512206727fc_43","name":"4f92","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s not hard to identify the part that performs the encryption (RC4 again) of the communicated data. However, the author made a choice not to encrypt the entire data, but only the header portion, consisting of the 5byte magic, size of entire data, size of uncompressed payload, a total of 0xD bytes. This is done perhaps in a (futile) attempt to evade standard network signatures used to identify Gh0stRAT communications. However, since the length of the header remains the same after encryption, a slight tweak to such network signatures should suffice to work. The key used in the encryption is found within the configuration data earlier read by the binary. This key is made up of \u003Cuser defined password within builder\u003E appended with \u003Cusername used to login to the C2\u003E.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fXDUmw2DqPqfpO9tU024-Q.png":{"__typename":"ImageMetadata","id":"1*fXDUmw2DqPqfpO9tU024-Q.png","originalHeight":434,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_44":{"__typename":"Paragraph","id":"5512206727fc_44","name":"9470","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fXDUmw2DqPqfpO9tU024-Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_45":{"__typename":"Paragraph","id":"5512206727fc_45","name":"7841","type":"P","href":null,"layout":null,"metadata":null,"text":"And I huff and I puff, to clear the mysterious fog surrounding these samples!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_46":{"__typename":"Paragraph","id":"5512206727fc_46","name":"ebbd","type":"P","href":null,"layout":null,"metadata":null,"text":"So what made these samples get flagged with that YARA rule I mentioned in the beginning of this post?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*klIpwtaTB-KJBxHju6nZJA.png":{"__typename":"ImageMetadata","id":"1*klIpwtaTB-KJBxHju6nZJA.png","originalHeight":132,"originalWidth":1056,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_47":{"__typename":"Paragraph","id":"5512206727fc_47","name":"0236","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*klIpwtaTB-KJBxHju6nZJA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_48":{"__typename":"Paragraph","id":"5512206727fc_48","name":"6893","type":"P","href":null,"layout":null,"metadata":null,"text":"The presence of this strange VBS name:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-Z9KPfJEXZ607dxAEFa6og.png":{"__typename":"ImageMetadata","id":"1*-Z9KPfJEXZ607dxAEFa6og.png","originalHeight":473,"originalWidth":878,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_49":{"__typename":"Paragraph","id":"5512206727fc_49","name":"40ee","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-Z9KPfJEXZ607dxAEFa6og.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_50":{"__typename":"Paragraph","id":"5512206727fc_50","name":"cd83","type":"P","href":null,"layout":null,"metadata":null,"text":"What does this VBS do? I gave the function some mock data as arguments, and the contents of the VBS is formed as follows. Looks like it is just for creating or manipulating a user account with “net user”. The name of the VBS is not related to its contents. Just for fun, I’m guessing “jingtisanmenxiachuanxiao” is written as 警惕三门峡传销 in Chinese, which literally translate to “Be wary of Sanmenxia MLM”. Strange name to give to a script in any case.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*tmbiOVEb3KSVNJTAtOO50Q.png":{"__typename":"ImageMetadata","id":"1*tmbiOVEb3KSVNJTAtOO50Q.png","originalHeight":527,"originalWidth":944,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_51":{"__typename":"Paragraph","id":"5512206727fc_51","name":"e065","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*tmbiOVEb3KSVNJTAtOO50Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_52":{"__typename":"Paragraph","id":"5512206727fc_52","name":"c92c","type":"P","href":null,"layout":null,"metadata":null,"text":"The exact same function is found in all 4 files I cross-examined.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_53":{"__typename":"Paragraph","id":"5512206727fc_53","name":"d9cc","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let’s find out if they are all BigBadWolf related.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_54":{"__typename":"Paragraph","id":"5512206727fc_54","name":"4ff5","type":"P","href":null,"layout":null,"metadata":null,"text":"The laziest way to start is to do BinDiff on the 3 files in relation to the DLL related to BigBadWolf. Results from BinDiff, pretty high scores. Not surprising, since they all stemmed from Gh0st code.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_55":{"__typename":"Paragraph","id":"5512206727fc_55","name":"f873","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Similarity with C02A360C6F64609403B4E4D4FC130014C40EBB77F71DF816C6408851C7C9ED54\nConfidence 0.988735 | Similarity 0.886978","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_56":{"__typename":"Paragraph","id":"5512206727fc_56","name":"918f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Similarity with BBE7D708310EC7E5F981CE4BA9928A19C4D2169B5520FFA573085F9698F90C25\nConfidence 0.984084 | Similarity 0.767249","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_57":{"__typename":"Paragraph","id":"5512206727fc_57","name":"616d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Similarity with 9DCDDC7FFCE78526057888B43B57E76BA7F3FED0C13FB4FA4214DCB08412C447\nConfidence 0.988665 | Similarity 0.879644","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_58":{"__typename":"Paragraph","id":"5512206727fc_58","name":"dff5","type":"P","href":null,"layout":null,"metadata":null,"text":"What are the differences then? Looks like all of the 3 has a different magic header — “KuGou”, while the binary from BigBadWolf has “DHLAQ” as the magic (if you didn’t notice, DHL is the acronym of its Chinese name Da Hui Lang). The size of the RC4 encrypted header also differs.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FrN4r3XCClnASh9wK14MZA.png":{"__typename":"ImageMetadata","id":"1*FrN4r3XCClnASh9wK14MZA.png","originalHeight":350,"originalWidth":825,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_59":{"__typename":"Paragraph","id":"5512206727fc_59","name":"c1d8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FrN4r3XCClnASh9wK14MZA.png"},"text":"Left: from BigBadWolf; Right: from BBE7D708310EC7E5F981CE4BA9928A19C4D2169B5520FFA573085F9698F90C25","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_60":{"__typename":"Paragraph","id":"5512206727fc_60","name":"0795","type":"P","href":null,"layout":null,"metadata":null,"text":"Another obvious difference is that the configuration data is not given as an encoded input, but instead found as plaintext strings handled directly within the functions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Z6lz5HqBsKYQu_6z3Y2xwQ.png":{"__typename":"ImageMetadata","id":"1*Z6lz5HqBsKYQu_6z3Y2xwQ.png","originalHeight":547,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_61":{"__typename":"Paragraph","id":"5512206727fc_61","name":"49d6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Z6lz5HqBsKYQu_6z3Y2xwQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_62":{"__typename":"Paragraph","id":"5512206727fc_62","name":"d110","type":"P","href":null,"layout":null,"metadata":null,"text":"So, there is another Gh0st variant out there similar to BigBadWolf but yet implemented differently in some ways, let’s call this set “KuGou”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_63":{"__typename":"Paragraph","id":"5512206727fc_63","name":"b920","type":"P","href":null,"layout":null,"metadata":null,"text":"Remember at the start of this post, I mentioned some KuGou malware tweeted by malwaremustd1e? Let’s see if they are the same as the 3 KuGou binaries we saw above.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_64":{"__typename":"Paragraph","id":"5512206727fc_64","name":"1363","type":"P","href":null,"layout":null,"metadata":null,"text":"The dropper EXE (SHA256: 852FA14860260023289EE6577DBD5E0193DF31DAE5F3C078142D3CAC030C7462) contains encoded string that points the binary to download its DLL payload. Familiar yes?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ETvWvDNplHnRjC888dzEaA.png":{"__typename":"ImageMetadata","id":"1*ETvWvDNplHnRjC888dzEaA.png","originalHeight":375,"originalWidth":895,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_65":{"__typename":"Paragraph","id":"5512206727fc_65","name":"1161","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ETvWvDNplHnRjC888dzEaA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_66":{"__typename":"Paragraph","id":"5512206727fc_66","name":"20b2","type":"P","href":null,"layout":null,"metadata":null,"text":"The downloaded DLL (SHA256: 7BAEE22C9834BEF64F0C1B7F5988D9717855942D87C82F019606D07589BC51A9) is RC4-decrypted with key “Kother599”. Again, familiar! There’s a slight difference here, the EXE did not verify that the file has a footer signature e.g. “SSSSSSVID:2014-SV8”, and the DLL does not contain such a footer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*te_0lZ0O3O1JtaGcTTKdIQ.png":{"__typename":"ImageMetadata","id":"1*te_0lZ0O3O1JtaGcTTKdIQ.png","originalHeight":606,"originalWidth":786,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_67":{"__typename":"Paragraph","id":"5512206727fc_67","name":"028e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*te_0lZ0O3O1JtaGcTTKdIQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_68":{"__typename":"Paragraph","id":"5512206727fc_68","name":"1d75","type":"P","href":null,"layout":null,"metadata":null,"text":"The next difference lies in the configuration data passed to be decrypted by the DLL. In this binary, the configuration is encrypted with RC4, and not just Base64\u002FADD\u002FXOR encoded as seen from the BigBadWolf’s DLL. RC4 key used here is “Strong798”. Notice how the structure of the configuration after decryption is identical to what we saw in BigBadWolf. And even that string of Chinese (监测和监视新硬件设备并自动更新设备驱动) used as Service Description is identical.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9L3HTrTYBKobJUbQqexNag.png":{"__typename":"ImageMetadata","id":"1*9L3HTrTYBKobJUbQqexNag.png","originalHeight":365,"originalWidth":810,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_69":{"__typename":"Paragraph","id":"5512206727fc_69","name":"3511","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9L3HTrTYBKobJUbQqexNag.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_70":{"__typename":"Paragraph","id":"5512206727fc_70","name":"0da2","type":"P","href":null,"layout":null,"metadata":null,"text":"Since the configuration data is encrypted in a different manner, there must be another server-side binary responsible for building this sample. To my surprise, the 5-byte magic used in the communications is “DHLAR”. Perhaps this explains the similarities shared with our BigBadWolf sample. Another thing is for sure, this file does not belong to the same set as the 3 “KuGou” binaries we just looked at. If I had to pin a family name to this file, it would be BigBadWolf.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yLoc9NQkQG_OLqHorVhyaA.png":{"__typename":"ImageMetadata","id":"1*yLoc9NQkQG_OLqHorVhyaA.png","originalHeight":795,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_71":{"__typename":"Paragraph","id":"5512206727fc_71","name":"9cad","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*yLoc9NQkQG_OLqHorVhyaA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_72":{"__typename":"Paragraph","id":"5512206727fc_72","name":"718c","type":"P","href":null,"layout":null,"metadata":null,"text":"A search on Google pointed me to a Operation PZCHAO report by BitDefender[3], in which a jingtisanmenxiachuanxiao.vbs of a different content is documented. The samples that were described in this report somewhat bear resemblance to what we are seeing in BigBadWolf’s DLL, yet there are differences.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_73":{"__typename":"Paragraph","id":"5512206727fc_73","name":"d991","type":"P","href":null,"layout":null,"metadata":null,"text":"For example,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_74":{"__typename":"Paragraph","id":"5512206727fc_74","name":"8cba","type":"BQ","href":null,"layout":null,"metadata":null,"text":"“the malware then searches inside its own binary for a string delimiter SSSSSSS, returning a string pointer to the beginning of the encrypted configuration string”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_75":{"__typename":"Paragraph","id":"5512206727fc_75","name":"5191","type":"P","href":null,"layout":null,"metadata":null,"text":"This is similar to how our sample looks for the marker SSSSSS (note the length here is only 6) to verify that the DLL downloaded is correct before proceeding to decrypt.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_76":{"__typename":"Paragraph","id":"5512206727fc_76","name":"4de7","type":"P","href":null,"layout":null,"metadata":null,"text":"As another example,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_77":{"__typename":"Paragraph","id":"5512206727fc_77","name":"71fb","type":"BQ","href":null,"layout":null,"metadata":null,"text":"“Until it checks in with its C2 controller, the RAT server searches for the encrypted configuration buffer containing the C&Cs that will get decrypted using an AES key derived from a hardcoded string “Mother360””","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_78":{"__typename":"Paragraph","id":"5512206727fc_78","name":"b945","type":"P","href":null,"layout":null,"metadata":null,"text":"The configuration is encoded with base64\u002FADD\u002FXOR in BigBadWolf sample instead. Even when encryption is used, the algorithm in place is RC4.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_79":{"__typename":"Paragraph","id":"5512206727fc_79","name":"4015","type":"P","href":null,"layout":null,"metadata":null,"text":"Yet, this sample documented by Bitdefender will also match the Yara rule on “s.exe variant”, based on the presence of the strings within the file. And we now know that it is a different variant from BigBadWolf, and even KuGou.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_80":{"__typename":"Paragraph","id":"5512206727fc_80","name":"6940","type":"P","href":null,"layout":null,"metadata":null,"text":"What a dreadful night!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_81":{"__typename":"Paragraph","id":"5512206727fc_81","name":"3f6b","type":"P","href":null,"layout":null,"metadata":null,"text":"I think you’re lost. Let’s try to summarise all of these information:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VlJqTV8gatMMaIQohJwMEA.png":{"__typename":"ImageMetadata","id":"1*VlJqTV8gatMMaIQohJwMEA.png","originalHeight":769,"originalWidth":1304,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5512206727fc_82":{"__typename":"Paragraph","id":"5512206727fc_82","name":"8a59","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VlJqTV8gatMMaIQohJwMEA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_83":{"__typename":"Paragraph","id":"5512206727fc_83","name":"d9ac","type":"P","href":null,"layout":null,"metadata":null,"text":"At the end of the day, I think I’ve established (further) that Gh0stRATs has too many variants. The builder that was behind that particular s.exe seen in Operation Iron Tiger has perhaps been referenced\u002F modified\u002F improved, causing other binaries to contain similar keywords but belong to different subvariants of Gh0stRAT that probably has nothing to do with the s.exe and its user (adversary group).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_84":{"__typename":"Paragraph","id":"5512206727fc_84","name":"8fa0","type":"P","href":null,"layout":null,"metadata":null,"text":"Phew, glad I’ve got all of that information sorted out :)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_85":{"__typename":"Paragraph","id":"5512206727fc_85","name":"dc4c","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s it for today!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_86":{"__typename":"Paragraph","id":"5512206727fc_86","name":"108f","type":"P","href":null,"layout":null,"metadata":null,"text":"[1]: Operation Iron Tiger Appendix, TrendLabs Security Intelligence Blog, 2015\n[2]: https:\u002F\u002Ftwitter.com\u002Fmalwaremustd1e\u002Fstatus\u002F1262274362872229888\n[3]: Operation PZCHAO, Bitdefender, 2017","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":84,"end":145,"href":"https:\u002F\u002Ftwitter.com\u002Fmalwaremustd1e\u002Fstatus\u002F1262274362872229888","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_87":{"__typename":"Paragraph","id":"5512206727fc_87","name":"9152","type":"P","href":null,"layout":null,"metadata":null,"text":"~~","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5512206727fc_88":{"__typename":"Paragraph","id":"5512206727fc_88","name":"fdab","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Asuna\nThe latest Tweets from Asuna (@AsunaAmawaka). [Malware Analyst]. Binary Worldtwitter.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":94,"href":"https:\u002F\u002Ftwitter.com\u002FAsunaAmawaka","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":6,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Ftwitter.com\u002FAsunaAmawaka","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*bkqTFhfA3fy7aTku"}},"Paragraph:5512206727fc_89":{"__typename":"Paragraph","id":"5512206727fc_89","name":"ff7f","type":"P","href":null,"layout":null,"metadata":null,"text":"Drop me a DM if you would like to share findings or samples ;)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_ed3c9bd45d12":{"__typename":"CollectionViewerEdge","id":"collectionId:8dea5b1882ca-viewerId:lo_ed3c9bd45d12","isEditor":false,"isMuting":false},"UserViewerEdge:userId:ddd44ddb6480-viewerId:lo_ed3c9bd45d12":{"__typename":"UserViewerEdge","id":"userId:ddd44ddb6480-viewerId:lo_ed3c9bd45d12","isMuting":false},"PostViewerEdge:postId:925549a105b2-viewerId:lo_ed3c9bd45d12":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:925549a105b2-viewerId:lo_ed3c9bd45d12"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:gh0strat":{"__typename":"Tag","id":"gh0strat","displayTitle":"Gh0strat","normalizedTagSlug":"gh0strat"},"Tag:bigbadwolf":{"__typename":"Tag","id":"bigbadwolf","displayTitle":"Bigbadwolf","normalizedTagSlug":"bigbadwolf"},"Tag:大灰狼":{"__typename":"Tag","id":"大灰狼","displayTitle":"大灰狼","normalizedTagSlug":"大灰狼"},"Post:925549a105b2":{"__typename":"Post","id":"925549a105b2","collection":{"__ref":"Collection:8dea5b1882ca"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"47cd","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:5512206727fc_0"},{"__ref":"Paragraph:5512206727fc_1"},{"__ref":"Paragraph:5512206727fc_2"},{"__ref":"Paragraph:5512206727fc_3"},{"__ref":"Paragraph:5512206727fc_4"},{"__ref":"Paragraph:5512206727fc_5"},{"__ref":"Paragraph:5512206727fc_6"},{"__ref":"Paragraph:5512206727fc_7"},{"__ref":"Paragraph:5512206727fc_8"},{"__ref":"Paragraph:5512206727fc_9"},{"__ref":"Paragraph:5512206727fc_10"},{"__ref":"Paragraph:5512206727fc_11"},{"__ref":"Paragraph:5512206727fc_12"},{"__ref":"Paragraph:5512206727fc_13"},{"__ref":"Paragraph:5512206727fc_14"},{"__ref":"Paragraph:5512206727fc_15"},{"__ref":"Paragraph:5512206727fc_16"},{"__ref":"Paragraph:5512206727fc_17"},{"__ref":"Paragraph:5512206727fc_18"},{"__ref":"Paragraph:5512206727fc_19"},{"__ref":"Paragraph:5512206727fc_20"},{"__ref":"Paragraph:5512206727fc_21"},{"__ref":"Paragraph:5512206727fc_22"},{"__ref":"Paragraph:5512206727fc_23"},{"__ref":"Paragraph:5512206727fc_24"},{"__ref":"Paragraph:5512206727fc_25"},{"__ref":"Paragraph:5512206727fc_26"},{"__ref":"Paragraph:5512206727fc_27"},{"__ref":"Paragraph:5512206727fc_28"},{"__ref":"Paragraph:5512206727fc_29"},{"__ref":"Paragraph:5512206727fc_30"},{"__ref":"Paragraph:5512206727fc_31"},{"__ref":"Paragraph:5512206727fc_32"},{"__ref":"Paragraph:5512206727fc_33"},{"__ref":"Paragraph:5512206727fc_34"},{"__ref":"Paragraph:5512206727fc_35"},{"__ref":"Paragraph:5512206727fc_36"},{"__ref":"Paragraph:5512206727fc_37"},{"__ref":"Paragraph:5512206727fc_38"},{"__ref":"Paragraph:5512206727fc_39"},{"__ref":"Paragraph:5512206727fc_40"},{"__ref":"Paragraph:5512206727fc_41"},{"__ref":"Paragraph:5512206727fc_42"},{"__ref":"Paragraph:5512206727fc_43"},{"__ref":"Paragraph:5512206727fc_44"},{"__ref":"Paragraph:5512206727fc_45"},{"__ref":"Paragraph:5512206727fc_46"},{"__ref":"Paragraph:5512206727fc_47"},{"__ref":"Paragraph:5512206727fc_48"},{"__ref":"Paragraph:5512206727fc_49"},{"__ref":"Paragraph:5512206727fc_50"},{"__ref":"Paragraph:5512206727fc_51"},{"__ref":"Paragraph:5512206727fc_52"},{"__ref":"Paragraph:5512206727fc_53"},{"__ref":"Paragraph:5512206727fc_54"},{"__ref":"Paragraph:5512206727fc_55"},{"__ref":"Paragraph:5512206727fc_56"},{"__ref":"Paragraph:5512206727fc_57"},{"__ref":"Paragraph:5512206727fc_58"},{"__ref":"Paragraph:5512206727fc_59"},{"__ref":"Paragraph:5512206727fc_60"},{"__ref":"Paragraph:5512206727fc_61"},{"__ref":"Paragraph:5512206727fc_62"},{"__ref":"Paragraph:5512206727fc_63"},{"__ref":"Paragraph:5512206727fc_64"},{"__ref":"Paragraph:5512206727fc_65"},{"__ref":"Paragraph:5512206727fc_66"},{"__ref":"Paragraph:5512206727fc_67"},{"__ref":"Paragraph:5512206727fc_68"},{"__ref":"Paragraph:5512206727fc_69"},{"__ref":"Paragraph:5512206727fc_70"},{"__ref":"Paragraph:5512206727fc_71"},{"__ref":"Paragraph:5512206727fc_72"},{"__ref":"Paragraph:5512206727fc_73"},{"__ref":"Paragraph:5512206727fc_74"},{"__ref":"Paragraph:5512206727fc_75"},{"__ref":"Paragraph:5512206727fc_76"},{"__ref":"Paragraph:5512206727fc_77"},{"__ref":"Paragraph:5512206727fc_78"},{"__ref":"Paragraph:5512206727fc_79"},{"__ref":"Paragraph:5512206727fc_80"},{"__ref":"Paragraph:5512206727fc_81"},{"__ref":"Paragraph:5512206727fc_82"},{"__ref":"Paragraph:5512206727fc_83"},{"__ref":"Paragraph:5512206727fc_84"},{"__ref":"Paragraph:5512206727fc_85"},{"__ref":"Paragraph:5512206727fc_86"},{"__ref":"Paragraph:5512206727fc_87"},{"__ref":"Paragraph:5512206727fc_88"},{"__ref":"Paragraph:5512206727fc_89"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:ddd44ddb6480"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fwhat-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2","primaryTopic":null,"topics":[],"isPublished":true,"latestPublishedVersion":"5512206727fc","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":0,"allowResponses":true,"isLimitedState":false,"title":"What happened between the BigBadWolf and the Tiger?","isSeries":false,"sequence":null,"uniqueSlug":"what-happened-between-the-bigbadwolf-and-the-tiger-925549a105b2","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1589998563178,"readingTime":9.288679245283019,"previewContent":{"__typename":"PreviewContent","subtitle":"Looking into a Gh0stRAT variant controller\u002Fbuilder called 大灰狼 (BigBadWolf) and a YARA rule on “s.exe variant seen in Op Iron Tiger”."},"previewImage":{"__ref":"ImageMetadata:1*8e6vxKBYB1Y6qRGeWOSF6Q.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1589998403669,"updatedAt":1639492780701,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:925549a105b2-viewerId:lo_ed3c9bd45d12"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:reverse-engineering"},{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:gh0strat"},{"__ref":"Tag:bigbadwolf"},{"__ref":"Tag:大灰狼"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1958,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3dcca59f1bcab7',t:'MTczNDUxMDcxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3dcca59f1bcab7","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>