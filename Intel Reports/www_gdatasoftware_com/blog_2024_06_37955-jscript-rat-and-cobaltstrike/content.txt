<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8">  <title>JScript RAT and CobaltStrike</title> <meta http-equiv="x-ua-compatible" content="IE=edge" /> <meta name="generator" content="TYPO3 CMS" /> <meta name="description" content="Threat actors, specifically those who dabble in phishing campaigns, like to use Script-based malware. Here is an analysis of a recent example. " /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="application-name" content="G DATA | Trust in German Sicherheit" /> <meta http-equiv="content-language" content="en" /> <meta property="og:title" content="In Bad Company: JScript RAT and CobaltStrike" /> <meta property="og:description" content="Remote Access Trojans (RATs) that are based on JScript are popular among threat actors that specialize in phishing campaigns. We have looked at a recent example that emerged in mid-May. After some digging, it turns out that this RAT has some companions on the way that we are familiar with. " /> <meta property="og:image" content="https://www.gdatasoftware.com/fileadmin/web/general/images/blog/2024/06/G_DATA_Blog_JScripRAT_OGTag.jpg" /> <meta property="og:image:url" content="https://www.gdatasoftware.com/fileadmin/web/general/images/blog/2024/06/G_DATA_Blog_JScripRAT_OGTag.jpg" /> <meta property="og:image:width" content="1200" /> <meta property="og:image:height" content="630" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="In Bad Company: JScript RAT and CobaltStrike" /> <meta name="twitter:description" content="Remote Access Trojans (RATs) that are based on JScript are popular among threat actors that specialize in phishing campaigns. We have looked at a recent example that emerged in mid-May. After some digging, it turns out that this RAT has some companions on the way that we are familiar with. " /> <meta name="twitter:image" content="https://www.gdatasoftware.com/fileadmin/web/general/images/blog/2024/06/G_DATA_Blog_JScripRAT_OGTag.jpg" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="msapplication-navbutton-color" content="#1e1e1e" /> <meta name="yandex-verification" content="4cf0234eb3af74fb" /> <meta name="dc.title" content="JScript RAT and CobaltStrike" /> <meta name="date" content="2024-06-07T09:18:54" /> <meta name="dc.date" content="2024-06-07T09:18:54" /> <meta name="copyright" content="G DATA CyberDefense AG, 2024. All rights reserved." /> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/basic-styles.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/font/gcon.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/font/source-sans-pro.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/assets/prism.css?1729663114" media="all"> <link href="/typo3conf/ext/gd_sites/Resources/Public/Styles/elements/menu-2019.css?1729663114" rel="stylesheet" > <link href="/typo3conf/ext/gd_sites/Resources/Public/Styles/assets/blogpage.css?1729663114" rel="stylesheet" > <script type="text/javascript" data-cmp-ab="1" src="https://cdn.consentmanager.net/delivery/autoblocking/fe6daaf9c1a67.js" data-cmp-host="b.delivery.consentmanager.net" data-cmp-cdn="cdn.consentmanager.net" data-cmp-codesrc="0"></script> <script>
    function setOffline(e,o) {o.dontshow = 1;}
    if (window.location.href.indexOf('gd-ncb=2') !== -1 || window.sessionStorage.getItem('gd_no-tracking') === 'true') {
        __cmp("addEventListener",["init",setOffline,false],null);
        __cmp("addEventListener",["settings",setOffline,false],null);
        window.sessionStorage.setItem('gd_no-tracking', 'true');
    }
  </script> <link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="alternate" type="application/atom+xml" title="G DATA SecurityBlog (deutsch)" href="https://feeds.feedblitz.com/GDataSecurityBlog-DE&x=1" /> <link rel="alternate" type="application/atom+xml" title="G DATA SecurityBlog (english)" href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&x=1" /><meta name="author" content="Banu Ramakrishnan"><meta name="DC.author" content="Banu Ramakrishnan"> <link rel="dns-prefetch" href="//file.gdatasoftware.com"> <link rel="dns-prefetch" href="//static.gdatasoftware.com"> <link rel="dns-prefetch" href="//www.google-analytics.com"> <link rel="dns-prefetch" href="//www.googletagmanager.com"> <link rel="canonical" href="https://www.gdatasoftware.com/blog/2024/06/37955-jscript-rat-and-cobaltstrike"/>  <script type="application/ld+json">[{"@context":"https:\/\/www.schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/www.gdatasoftware.com\/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/www.gdatasoftware.com\/blog","name":"Blog (EN)"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/www.gdatasoftware.com\/blog\/2024\/06\/37955-jscript-rat-and-cobaltstrike","name":"JScript RAT and CobaltStrike"}}]}]</script> </head> <body id="page-37955" class="fe-0 be-"> <div id="outer-wrap"> <header id="site-header" class="height-auto"> <div class="menu-overlay" data-menu-close></div> <div id="mobile-head" data-menu-website="blog" class="clearfix hide-for-large"> <a href="/blog" id="mobile-logo"> <div class="logo"> <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-dark.svg" alt="G DATA Logo" height="40""/> </div> </a> <a id="service-nav-trigger"><span>MENU</span> <div id="hamburger" class="hamburger-icon-container"> <span class="hamburger-icon"></span> </div> </a> </div> <div id="main-navi" data-menu-website="blog" class="logged-in main-navi-before"> <div class="level-1 flex-container"> <div class="logo show-for-large"> <a href="/blog" > <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-dark.svg" alt="G DATA Logo" height="40"/> </a> </div> <nav role="navigation"> <ul class="menu"> <li> <a class="effect-underline" href="/blog/awareness">Awareness</a> </li> <li> <a class="effect-underline" href="/blog/g-data-campues">G DATA Campus</a> </li> <li> <a class="effect-underline" href="/blog/smb-secuerity">SMB Security</a> </li> <li> <a class="effect-underline" href="/blog/tips-and-tricks">Tips and tricks</a> </li> <li> <a class="effect-underline" href="/blog/techblog">Techblog</a> </li> <li class="ar pop-up choose-language"> <a href="https://www.gdata.de/blog"> <img src="/typo3conf/ext/gd_sites/Resources/Public/Images/Flags/DE.svg" style="height:20px" alt="Switch to german version" /> </a> </li> <li class="ar pop-up rss"> <a href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&amp;x=1" target="_blank" rel="noreferrer"> <i class="icon-rss"></i><span class="title"></span> </a> </li> </ul> </nav> <div class="blog-subwrap"> <ul class="blog-subnavi"> <li> <a class="nav-link" href="/blog/ransomware">Ransomware</a> </li> <li> <a class="nav-link" href="/blog/warning">Warning</a> </li> <li> <a class="nav-link" href="/blog/malware">Malware</a> </li> <li> <a class="nav-link" href="/blog/cybercrime">CyberCrime</a> </li> <li> <a class="nav-link" href="/blog/exploits">Exploits</a> </li> <li> <a class="nav-link" href="/blog/phishing">Phishing</a> </li> <li> <a class="nav-link" href="/blog/bots-botnets">Bots &amp; Botnets</a> </li> </ul> <div class="searchbox"> <form action="/blog/search" method="GET"> <input type="text" name="tx_kesearch_pi1[sword]" placeholder="search phrase" /> <button data-trigger-searchinput type="button"><i class="icon-search"></i></button> </form> </div> </div> </div> </div> </header> <div id="inner-wrap"> <div id="main" role="main"> <div class="row expanded blog-head-container"> <div class="pagenews-header blogpage-header text-white bg-right bgm-left"> <div class="outer"> <div class="inner v-middle"> <header> <h1><span>In Bad Company: </span>JScript RAT and CobaltStrike</h1> <span itemprop="dateCreated">06/06/2024 </span> </header> </div> </div> <span class="cat-title">G DATA <strong>Blog</strong></span> <span class="cat-icon"><i class="icon-blog has-top top"></i></span> </div> <style> .blogpage-header { background-image:url(/fileadmin/web/general/images/blog/2024/06/G_DATA_Blog_JScripRAT_Header.jpg); } @media only screen and (max-width: 767px) { .blogpage-header { background-image:url(/fileadmin/_processed_/f/8/G_DATA_Blog_JScripRAT_Header_71560e56fc.jpg); }} </style> </div> <div class="row"> <div class="column small-12 medium-12 large-9" id="blogpage-content-container"> <div class="row"> <div class="column fce small-12"> <p class="intro-text">Remote Access Trojans (RATs) that are based in JScript are gaining traction. We have looked at a recent example that emerged in mid-May. It turns out that this RAT has some companions on the way that we are familiar with. </p> </div> </div> <div class="row hide-for-large"> <div class="column small-12"> <div class="pagenews-progress"> <div class="reading-time"> <span class="eta"></span> <span class="word-count"></span> </div> <div data-sticky-container id="mobile-progress-container" class="hide-on-large"> <progress value="0" class="sticky" data-sticky data-margin-top="0" data-sticky-on="small" data-margin-bottom="0" data-top-anchor="mobile-progress-container" data-btm-anchor="site-footer:top"></progress> </div> </div> <nav class="mobile-menu"> <ul class="pagenews-menu"> <li> <a href="#c233436" data-scroll-link> <span>Attack overview </span> </a> </li> <li> <a href="#c233438" data-scroll-link> <span>The initial loader </span> </a> </li> <li> <a href="#c233439" data-scroll-link> <span>The second stage </span> </a> </li> <li> <a href="#c233440" data-scroll-link> <span>The RAT component </span> </a> </li> <li> <a href="#c233442" data-scroll-link> <span>What is known - and what is not</span> </a> </li> <li> <a href="#c233443" data-scroll-link> <span>Sample used in this analysis </span> </a> </li> <li> <a href="#c233444" data-scroll-link> <span>Other, similar samples</span> </a> </li> </ul> </nav> </div> </div> <div class="row"> <div id="c233434" class="fce column large-12 small-12 frame-layout-0 " ><p>A few weeks ago, <a href="https://x.com/naumovax/status/1790298161178714149">Ksenia posted on Twitter</a> about a potential new JScript based RAT. We delved deeper into the case and offer our analysis in this article.&nbsp;</p></div> <div data-magellan-target="c233436" class="small-12 column"><div class="row"> <div id="c233436" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-intext-right"><header class=" "><h2 class=" "> Attack overview </h2></header><div class="image-gallery-wrap"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/web/general/images/blog/2024/06/GDATA_JSRAT_Attack_pattern.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/7/1/GDATA_JSRAT_Attack_pattern_2f18dc8a71.png" width="400" height="126" loading="lazy" alt="" /></a><figcaption class="image-caption"> Overview of a JScript RAT attack chain </figcaption></figure></div></div></div><p>The attack pattern is illustrated below. Over the past years, it has been noted that JScript based RATs have often been distributed via phishing campaigns. We suspect that this attack uses the same technique. Once the initial loader script is executed, it contacts a command and control (C&amp;C) server, which responds with a new malicious script. This is the second stage loader and is executed on the fly. The second stage loader communicates with the C&amp;C server to get the RAT component, once again scripted with JScript. The RAT component has the capability to continue running until directed to stop, and execute additional commands received from the C&amp;C server.&nbsp;</p></div></div> </div></div> <div data-magellan-target="c233438" class="small-12 column"><div class="row"> <div id="c233438" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-intext-right"><header class=" "><h2 class=" "> The initial loader </h2></header><div class="image-gallery-wrap"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/web/general/images/blog/2024/06/G_DATA_Blog_JScriptRAT_Comparison1.jpg" class="fancybox"><img class="image-embed-item thumbnail" alt="Code listing that shows a comparison between the obfuscated and deobfuscated script. The former is spanning the entire page, the latter only four lines. " src="/fileadmin/_processed_/7/f/G_DATA_Blog_JScriptRAT_Comparison1_9db9d679b8.jpg" width="400" height="199" loading="lazy" /></a><figcaption class="image-caption"> Comparison of Obfuscated (left) vs Deobfuscated (right) script </figcaption></figure></div></div></div><p>The initial loader is obfuscated. The obfuscation and execution flow are rudimentary.&nbsp;</p><ul class="csc-bulletlist-3"><li>Initially, a blob of obfuscated code is deobfuscated. It contains a function object for the eval&nbsp;function.&nbsp;</li><li data-aria-level="1" data-aria-posinset="2" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="1"><p>&nbsp;Then the obfuscation proceeds to decrypt a string with XOR key.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="3" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="1"><p>&nbsp;The decrypted string is indeed another piece of JScript which would then be executed via the previously obtained eval function.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="4" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="1"><p>It then sends a XMLHttpRequest to the C&amp;C server and executes the received response as a script.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="5" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="1"><p>The URL path for C&amp;C ends with ‘/stage’, suggesting that this could be a preliminary step before the actual deployment of the malware.&nbsp;</p></li></ul></div></div> </div></div> <div data-magellan-target="c233439" class="small-12 column"><div class="row"> <div id="c233439" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><header class=" "><h2 class=" "> The second stage </h2></header><p>&nbsp;The second stage loader can be described as follows:&nbsp;</p><ul class="csc-bulletlist-3"><li data-aria-level="1" data-aria-posinset="1" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="2"><p>Obfuscated in the same manner as the initial loader&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="2" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="2"><p>While the initial loader makes a XMLHttpRequest to receive a response, the second stage loader employs a WinHttpRequest to contact the C&amp;C server to determine the next course of action.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="3" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="2"><p>This time around the response is a binary stream which turns out to be RC4 encrypted.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="4" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="2"><p>The reason behind using WinHttpRequest might simply be because of the ease of using it to deal with the binary response.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="5" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="2"><p>The script decrypts the content with a hardcoded key and the resulting JScript is then once again executed on the fly.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="6" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="2"><p>The next stage URL ends with ‘/rat/’ hinting at the fact that the decrypted script is indeed the main Remote Administration Tool (RAT) component.&nbsp;</p></li></ul></div><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/_processed_/b/9/G_DATA_Blog_JScriptRAT_Comparison_Stage2_6612a405f0.jpg" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/b/9/G_DATA_Blog_JScriptRAT_Comparison_Stage2_c37a8b5f16.jpg" width="500" height="161" loading="lazy" alt="" /></a><figcaption class="image-caption"> Comparison of Obfuscated (left) vs Deobfuscated (right) script </figcaption></figure></div></div></div></div> </div></div> <div data-magellan-target="c233440" class="small-12 column"><div class="row"> <div id="c233440" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><header class=" "><h2 class=" "> The RAT component </h2></header><p>The main body of the RAT can be seen in the image below.&nbsp;</p></div><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/web/general/images/blog/2024/06/GDATA_JSRAT_Body_of_the_RAT.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/web/general/images/blog/2024/06/GDATA_JSRAT_Body_of_the_RAT.png" width="416" height="342" loading="lazy" alt="" /></a></figure></div></div></div></div> <div id="c233441" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-intext-right"><div class="image-gallery-wrap"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/web/general/images/blog/2024/06/GDATA_JSRAT_Sleep_functionality.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/web/general/images/blog/2024/06/GDATA_JSRAT_Sleep_functionality.png" width="493" height="72" loading="lazy" alt="" /></a></figure></div></div></div><ul class="csc-bulletlist-3"><li data-aria-level="1" data-aria-posinset="1" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="3"><p>The main body implements an infinite loop to keep polling the C&amp;C server for further commands.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="2" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="3"><p>The body ensures a random amount of pause between polling by implementing a simple ‘Sleep’ functionality (See image)</p></li><li data-aria-level="1" data-aria-posinset="3" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="4"><p>The script contacts the C&amp;C server to obtain a session identifier and uses it for further communications with the server.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="4" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="4"><p>Requests are RC4 encrypted and then base64 encoded before being sent to the C&amp;C server.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="5" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="4"><p>Responses are RC4 encrypted as well.&nbsp;They are then decrypted by the script and executed&nbsp;as script entities.&nbsp;</p></li></ul></div></div> </div></div> <div data-magellan-target="c233442" class="small-12 column"><div class="row"> <div id="c233442" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h2 class=" "> What is known - and what is not </h2></header><ul class="gcon-list-plus-green"><li data-aria-level="1" data-aria-posinset="6" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p>The C&amp;C server was not active at the time of this research. Therefore, further command capabilities could not be documented in this article.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="7" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p><a href="https://x.com/naumovax/status/1790298161178714149" target="_blank" rel="noreferrer noopener">Ksenia</a> reported about this case in May 2024. We investigated further using the “RetroHunt” tool on Virustotal and found similar cases starting from February 2024. Following the trail of other servers proved unsuccessful.&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="8" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p>Incidentally, the C&amp;C server we found appeared to be operating a CobaltStrike server&nbsp;</p></li><li data-aria-level="1" data-aria-posinset="9" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p>While the C&amp;C server in this case was in the public IP range, a few other cases that we discovered on Virustotal appeared to have a local IP range (192.168.XXX.XXX).&nbsp;We can offer two potential reasons for this: There could be instances of simulated attacks as part of red team exercises in the sample set. Alternatively, the presence of private IPs in earlier cases might stem from internal tests of the malware that were performed by the threat actors.&nbsp;</p></li></ul></div> </div></div> <div data-magellan-target="c233443" class="small-12 column"><div class="row"> <div id="c233443" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h3 class=" "> Sample used in this analysis </h3></header><p>B3c38e68a626f8f1e5893cd157b697a4b871153230f6658f0d34a8eba929cdbf&nbsp;</p></div> </div></div> <div data-magellan-target="c233444" class="small-12 column"><div class="row"> <div id="c233444" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h3 class=" "> Other, similar samples </h3></header><p>&nbsp;c1f3e0ac0304f947fdd617c3972f4388c13cd23639f486d530ab1b3a5d5f971f&nbsp;<br> 76aa4f684481d2072ce85d80b14a2660bc912dcc47c787faad44cc21f01d7b9a&nbsp;<br> 87852d6fdfe29086212810bf0f8e769bac46ad462cab145bf5543eab988c7d3b&nbsp;</p></div> </div></div> </div> </div> <div class="column small-12 medium-12 large-3" id="blogpage-sidebar-container"> <div class="row"> <div class="column small-12 fce"> <div class="pagenews-authorbox"> <div class="media-object"> <div class="media-object-section middle"> <img src="/fileadmin/_processed_/7/7/banu_ramakrishnan_ee8046fd25.jpg" srcset="/fileadmin/_processed_/7/7/banu_ramakrishnan_ee8046fd25.jpg 1x, /fileadmin/_processed_/7/7/banu_ramakrishnan_2612cc8c31.jpg 2x" width="100" height="100"> </div> <div class="media-object-section middle"> <p><strong>from Banu Ramakrishnan</strong><br/>Malware Analyst</p> </div> </div> </div> </div> </div> <div class="row"> <div id="pagenews-sticky-sidebar-container" class="column small-12" data-sticky-container> <div class="sticky" id="pagenews-sticky-sidebar" data-sticky data-margin-top="0" style="width:100%;" data-deep-linking data-sticky-on="large" data-margin-bottom="0" data-top-anchor="pagenews-sticky-sidebar-container" data-btm-anchor="blogpage-content-container:bottom"> <div class="show-for-large"> <div class="sidebar-socialshare margin-bottom"> <div class="shariff" data-button-style="icon" data-twitter-via="GDATA" data-orientation="horizontal" data-lang="en" data-services="[&quot;twitter&quot;,&quot;xing&quot;,&quot;linkedin&quot;,&quot;facebook&quot;,&quot;reddit&quot]"></div> </div> <div class="pagenews-progress"> <div class="reading-time"> <span class="eta"></span> <span class="word-count"></span> </div> <progress value="0"></progress> </div> <nav data-magellan> <ul class="pagenews-menu"> <li> <a href="#c233436"> <span>Attack overview </span> </a> </li> <li> <a href="#c233438"> <span>The initial loader </span> </a> </li> <li> <a href="#c233439"> <span>The second stage </span> </a> </li> <li> <a href="#c233440"> <span>The RAT component </span> </a> </li> <li> <a href="#c233442"> <span>What is known - and what is not</span> </a> </li> <li> <a href="#c233443"> <span>Sample used in this analysis </span> </a> </li> <li> <a href="#c233444"> <span>Other, similar samples</span> </a> </li> </ul> </nav> </div> <div class="row"> <div class="fce column small-12 blog-categories"> <ul> <li><a href="/blog/malware"><span class="label label-default">Malware</span></a></li> <li><a href="/blog/techblog"><span class="label label-default">Techblog</span></a></li> </ul> </div> </div> <div class="row"> </div> </div> </div> </div> </div> </div> <div class="row expanded pagenews-footer" id="blogpage-footer"> <div class="small-12 column"> <div class="row" > <div class="small-12 medium-6 large-3 column fce"> <a class="button expanded no-margin" href="/blog">back to list</a> </div> <div class="small-12 medium-6 large-3 column fce"> <div class="sidebar-socialshare"> <div class="shariff" data-button-style="icon" data-twitter-via="GDATA" data-orientation="horizontal" data-lang="en" data-services="[&quot;twitter&quot;,&quot;xing&quot;,&quot;linkedin&quot;,&quot;facebook&quot;,&quot;reddit&quot]"></div> </div> </div> <div class="small-12 medium-12 large-3 column fce last-update"> </div> </div> </div> </div> <div class="row"> </div> </div> <div class="row"><nav id="breadcrumb" class="small-12 columns"><ul class="breadcrumbs"><li class="info-text">You are here:</li><li><a href="/blog"><span>Blog (EN)</span></a></li><li><span>JScript RAT and CobaltStrike</span></li></ul></nav></div> <footer id="site-footer"> <div class="row flexcontainer"> <div class="logo"> <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-light.svg" alt="G DATA Logo" height="50" style="height: 50px; margin:16px;"/> </div> <div class="socialbar"> <div class="social text-center"> <a href="https://de.linkedin.com/company/g-data-cyberdefense" title="G DATA CyberDefense AG on Linked-In" target="_blank" rel="noreferrer"><i class="icon-linkedin"></i></a><a href="https://www.facebook.com/gdatasoftwareag" title="G DATA CyberDefense AG on Facebook" target="_blank" rel="noreferrer"><i class="icon-facebook"></i></a><a href="https://www.threads.net/@gdatacyberdefense" title="G DATA CyberDefense AG on Threads" target="_blank" rel="noreferrer"><i class="icon-threads"></i></a><a href="https://www.instagram.com/gdatacyberdefense" title="G DATA CyberDefense AG on Instagram" target="_blank" rel="noreferrer"><i class="icon-instagram"></i></a><a href="https://www.youtube.com/user/GDataSoftwareAG" title="G DATA CyberDefense AG on Youtube" target="_blank" rel="noreferrer"><i class="icon-youtube"></i></a><a href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&amp;x=1" target="_blank" rel="noreferrer"><i class="icon-rss"></i></a> </div> </div> </div> <div class="sitemap row small-up-1 medium-up-2 large-up-4"> <div class="column"> <h5>G DATA</h5> <ul> <li> <a href="/about-g-data" data-event-action="click" data-event-category="Menu-Footer" data-event-label="About G DATA">About G DATA</a> </li> <li> <a href="/g-data/newsroom" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Newsroom">Newsroom</a> </li> <li> <a href="/about-g-data/jobs" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Jobs &amp; Career">Jobs &amp; Career</a> </li> <li> <a href="/about-g-data/awards" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Awards">Awards</a> </li> </ul> </div> <div class="column"> <h5>Services</h5> <ul> <li> <a href="/pc/free-trial" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Free Trial">Free Trial</a> </li> <li> <a href="https://www.gdata.de/help/en/business/HowToArtikel/Virenanalyse/DateiURLAppEinsenden/" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Submit a suspicious file, app or URL">Submit a suspicious file, app or URL</a> </li> </ul> </div> <div class="column"> <h5>G DATA Solutions</h5> <ul> <li> <a href="/pc" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Consumer">Consumer</a> </li> <li> <a href="/business" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Business">Business</a> </li> </ul> </div> </div> <div class="row"> <hr/> </div> <div class="footnav row"> <div class="large-7 medium-6 small-12 column imprint"> <a href="/privacy">Data Protection </a><a href="/support/contact">Contact </a><a href="/imprint">Imprint </a><a href="/">gdatasoftware.com </a> </div> <div class="large-5 medium-6 small-12 column copyright"> <span>&copy;&nbsp;2024&nbsp;G DATA CyberDefense AG. All rights reserved.</span> </div> </div> </footer> <a href="#" class="go-top"><i class="icon-angle-up-regular"></i></a> </div> </div> <script src="/typo3temp/assets/compressed/merged-f081765a3ed763d7fe90ca1c11ab5a25.js?1729664179"></script> <script src="/typo3conf/ext/gd_sites/Resources/Public/JavaScript/gd-mainmenu-2019.js?1729663114"></script> <script src="/typo3conf/ext/gd_pagenews/Resources/Public/JavaScript/gd-guidebook.js?1729663114"></script> <script>
            $(document).ready(function() {
				GdScrollIndicator.init('#blogpage-content-container','','');
				GdScrollIndicator.calculateReadingTime([$('#blogpage-content-container'),$('.pagenews-teaser')],{readingTimeTarget:'.eta',wordCountTarget:'.word-count', prependTimeString:'Reading time: ', lessThanAMinuteString:'less then a minute', prependWordString:'(',apendWordString:' words)'});
			});
		</script> <script>
    document.addEventListener( 'DOMContentLoaded', function(e) {
        window.GdTracking = new GdTrackingModule();
        GdTracking.initialize();
    });
</script> <script data-cmp-vendor="s905" type="text/plain" class="cmplazyload">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'analytics_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'wait_for_update': 500
        });

        dataLayer.push({
            'event': 'default_consent'
        });
    </script> <script data-cmp-vendor="s905" type="text/plain" class="cmplazyload">
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-NQG4RJ');
    </script> </body> </html>