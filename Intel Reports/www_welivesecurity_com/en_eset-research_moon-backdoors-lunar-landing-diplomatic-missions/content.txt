<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="canonical" href="https://www.welivesecurity.com/en/eset-research/moon-backdoors-lunar-landing-diplomatic-missions/"><title>To the Moon and back(doors): Lunar landing in diplomatic missions</title><meta content="article" property="og:type"><meta content="https://web-assets.esetstatic.com/wls/2024/5-2024/eset-research-lunar-toolset-turla-apt-lunarweb-lunarmail.jpeg" property="og:image"><meta property="og:title" content="To the Moon and back(doors): Lunar landing in diplomatic missions"><meta property="og:description" content="ESET researchers provide technical analysis of the Lunar toolset, likely used by the Turla APT group, that infiltrated a European ministry of foreign affairs"><meta name="robots" content="index, follow, max-image-preview:large, max-video-preview:-1"><meta name="description" content="ESET researchers provide technical analysis of the Lunar toolset, likely used by the Turla APT group, that infiltrated a European ministry of foreign affairs"><meta name="twitter:title" content="To the Moon and back(doors): Lunar landing in diplomatic missions">
    
    <!-- Preloading resources -->
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BookLF-405f3258.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BoldLF-31f4bc72.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-DemiLF-8885b886.woff" as="font" type="font/woff" crossorigin>
            <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x266/wls/2024/5-2024/eset-research-lunar-toolset-turla-apt-lunarweb-lunarmail.jpeg" as="image" media="(max-width: 768px)">
        <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x425/wls/2024/5-2024/eset-research-lunar-toolset-turla-apt-lunarweb-lunarmail.jpeg" as="image" media="(min-width: 768.1px)">
                <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-header-995fa639.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-header-995fa639.js"></script>
    <script>
    window.addEventListener('pageLoaded', () => {
        window.dispatchEvent(new CustomEvent('postPageViewed', {
            detail: {
                'id': 17853,
                'publicationId': 30424,
                'name': 'To the Moon and back(doors): Lunar landing in diplomatic missions',
                'author': 'Filip Jurƒçacko',
                'category': 'ESET Research',
                'section': null,
                'branch': 'en',
                'date': '2024/05/15'
            }
        }));
    });
    </script>

    <!-- Google Tag Manager -->
    <script type="module">
    window.addEventListener("pageLoaded", () => {
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-PMDGSM');
    });
    </script>
    <!-- End Google Tag Manager -->

    <script type="module">
    window.dispatchEvent(new CustomEvent("pageLoaded"));
    </script>

    <!-- Styles -->
    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/app-22f82615.css" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/app-22f82615.css" />
    <!-- Others -->
            <script>
            window.$current_language = JSON.parse('{"id":1,"code":"en","name":"English","is_pblic":true,"is_active":true,"is_default":true,"is_rtl":false}');
        </script>
    
<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch","rua.ceh":"false","rua.ueh":"false","rua.ieh.st":"0"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="zck3q6gi3aebwzy5up4q-f-f8d2eb5e2-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"39","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":5,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"37fa95ee","ak.r":45328,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"200.149.184.0","ak.cport":60427,"ak.gh":"200.216.8.23","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.0rtt.ed":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1729995769","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==FJEXqykyz6RWiHqGRBvgjb93qiutkhSBfd2DWPkgglbAaABDo9+uhdh+UuIxo2HHkRfJGlaQbHhMoXVE1yugVSqxhy56hITsbRSZDfhX0ycAHqQl4VYwE5LB4BHFdE61EKiXaNH1YWu+RAbnsKTecprIitgq98P6RE5Fc1zUvyu8CwFXCHCrFs8daqGhPEAPSQO4kRx96380CLrPhnnPygm6971N3Txo+xYOuPG2iPoG7n4hjzSlMTWnUrip7WScfNVLDpY4lU0f2hCfgxSoyoSF7ZgBAv7h+llLRkRRKL90+eCPyI++62hQXe/ktvpH9bG48eGlsdSpSswn747aPTKAhykT9aLo442KPfSiw6Eo28Q70w4tvjjN1rd5NBKOHa7oMfua/1zcZz82JT9lH65h3ZaS/AJrNNTSRpFwUis=","ak.pv":"20","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.0rtt.ed","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src=https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="app" >
        <!-- navbar -->
        <header id="wls-nav-header" class="wls-header navbar sticky-top navbar-expand-lg has-shadow">
  <div class="container first-line">
    <a class="header-brand" href="/en/" title="WeLiveSecurity">
      <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>    </a>
    <p>
      Award-winning news, views, and insight from the ESET security community
    </p>
    <div class="ms-auto">
      <div class="language-picker dropdown"><div class="language-picker-wrapper"><button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"aria-expanded="false">English</button><ul class="dropdown-menu dropdown-menu-center"><a class="dropdown-item" href="/es/" title="Espa√±ol">Espa√±ol</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Portugu√™s">Portugu√™s</a><a class="dropdown-item" href="/fr/" title="Fran√ßais">Fran√ßais</a></ul></div></div>    </div>
  </div>
  <div class="second-line">
    <div class="container">
      <div class="navbar-header">
        <a class="header-brand" href="/en/" title="WeLiveSecurity">
          <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>        </a>
        <div class="me-2">
          <button class=" navbar-toggler button-hamburger collapsed d-flex d-lg-none flex-column justify-content-around" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="This is toggle button"><span class="toggler-icon top-bar"></span><span class="toggler-icon middle-bar"></span><span class="toggler-icon bottom-bar"></span></button>        </div>
      </div>

      <nav id="navbarNavDropdown" class="collapse navbar-collapse page-navbar"><ul class="navbar-nav"><li class="nav-item d-lg-none"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component></div></li><li class="nav-item"><a class="nav-link" href="/en/tips-advice/" title="TIPS &amp; ADVICE"><span class="">TIPS &amp; ADVICE</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/business-security/" title="BUSINESS SECURITY"><span class="">BUSINESS SECURITY</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ESET RESEARCH" role="button" data-bs-toggle="dropdown"aria-expanded="false">ESET RESEARCH</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/about-eset-research/" title="About ESET Research"><span class="">About ESET Research</span></a><a class="dropdown-item" href="/en/eset-research/" title="Blogposts"><span class="">Blogposts</span></a><a class="dropdown-item" href="/en/podcasts/" title="Podcasts"><span class="">Podcasts</span></a><a class="dropdown-item" href="/en/white-papers/" title="White papers"><span class="">White papers</span></a><a class="dropdown-item" href="/en/threat-reports/" title="Threat reports"><span class="">Threat reports</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/we-live-science/" title="WeLiveScience"><span class="button-link">WeLiveScience</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="FEATURED" role="button" data-bs-toggle="dropdown"aria-expanded="false">FEATURED</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/ukraine-crisis-digital-security-resource-center/" title="Ukraine crisis ‚Äì Digital security resource center"><span class="">Ukraine crisis ‚Äì Digital security resource center</span></a><a class="dropdown-item" href="/en/we-live-progress/" title="WeLiveProgress"><span class="">WeLiveProgress</span></a><a class="dropdown-item" href="/en/covid-19/" title="COVID-19"><span class="">COVID-19</span></a><a class="dropdown-item" href="/en/resources/" title="Resources"><span class="">Resources</span></a><a class="dropdown-item" href="/en/videos/" title="Videos"><span class="">Videos</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="TOPICS" role="button" data-bs-toggle="dropdown"aria-expanded="false">TOPICS</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/cybersecurity/" title="Digital Security"><span class="">Digital Security</span></a><a class="dropdown-item" href="/en/scams/" title="Scams"><span class="">Scams</span></a><a class="dropdown-item" href="/en/how-to/" title="How to"><span class="">How to</span></a><a class="dropdown-item" href="/en/privacy/" title="Privacy"><span class="">Privacy</span></a><a class="dropdown-item" href="/en/cybercrime/" title="Cybercrime"><span class="">Cybercrime</span></a><a class="dropdown-item" href="/en/kids-online/" title="Kids online"><span class="">Kids online</span></a><a class="dropdown-item" href="/en/social-media/" title="Social media"><span class="">Social media</span></a><a class="dropdown-item" href="/en/internet-of-things/" title="Internet of Things"><span class="">Internet of Things</span></a><a class="dropdown-item" href="/en/malware/" title="Malware"><span class="">Malware</span></a><a class="dropdown-item" href="/en/ransomware/" title="Ransomware"><span class="">Ransomware</span></a><a class="dropdown-item" href="/en/secure-coding/" title="Secure coding"><span class="">Secure coding</span></a><a class="dropdown-item" href="/en/mobile-security/" title="Mobile security"><span class="">Mobile security</span></a><a class="dropdown-item" href="/en/critical-infrastructure/" title="Critical infrastructure"><span class="">Critical infrastructure</span></a><a class="dropdown-item" href="/en/about-eset-research/" title="Threat research"><span class="">Threat research</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ABOUT US" role="button" data-bs-toggle="dropdown"aria-expanded="false">ABOUT US</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/company/about-us/" title="About WeLiveSecurity"><span class="">About WeLiveSecurity</span></a><a class="dropdown-item" href="/en/our-experts/" title="Our Experts"><span class="">Our Experts</span></a><a class="dropdown-item" href="/en/company/contact-us/" title="Contact Us"><span class="">Contact Us</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown d-lg-none"><a class="nav-link dropdown-toggle languages" href="/en/" title="English" role="button"data-bs-toggle="dropdown" aria-expanded="false">English</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/es/" title="Espa√±ol">Espa√±ol</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Portugu√™s">Portugu√™s</a><a class="dropdown-item" href="/fr/" title="Fran√ßais">Fran√ßais</a></div></div></li><li class="nav-item ms-auto d-none d-lg-block"><button class="nav-link ms-auto search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9485 19.9001" fill="#424D56"><path d="m19.5429,17.9473l-4.86-4.852c2.7034-3.5802,1.9927-8.674-1.5874-11.3774C9.5153-.9856,4.4214-.2749,1.718,3.3053-.9854,6.8854-.2747,11.9793,3.3055,14.6827c1.4094,1.0643,3.1273,1.6402,4.8934,1.6406,1.7749.0083,3.5023-.5739,4.91-1.655l4.883,4.829c.207.2113.4912.329.787.326.2948-.0022.5771-.1191.787-.326.4163-.4365.406-1.126-.023-1.55Zm-11.316-3.821c-3.2811-.0017-5.9396-2.663-5.9378-5.9442.0017-3.2811,2.663-5.9396,5.9442-5.9378,1.5726.0008,3.0806.6251,4.1937,1.736,1.1259,1.1056,1.7528,2.6221,1.736,4.2-.0007,1.5744-.6249,3.0845-1.736,4.2-1.1067,1.1254-2.6216,1.7552-4.2,1.746Z" /></svg></button></li></ul><div class="search-bar"><div class="collapse search-bar-wrapper"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component><button class="nav-link search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.1065 18.0626"><polygon points="10.6883 9.0363 17.4683 15.8163 15.8383 17.4463 9.0583 10.6663 2.2683 17.4463 .6383 15.8163 7.4283 9.0363 .6383 2.2463 2.2683 .6163 9.0583 7.4063 15.8383 .6163 17.4683 2.2463 10.6883 9.0363" /></svg></button></div></div></div></nav>    </div>
  </div>
  <div class="additional-info d-none">
    <div class="container">
      <p>
        Award-winning news, views, and insight from the ESET security community
      </p>
    </div>
  </div>
</header>
        <!-- main content -->
        <div id="main">
                
    <div class="container article-page py-5">
        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                                    <div class="article-header">
    <p class="category text-uppercase">ESET Research</p>
    <h1 class="page-headline">To the Moon and back(doors): Lunar landing in diplomatic missions</h1>    <p class="sub-title">ESET researchers provide technical analysis of the Lunar toolset, likely used by the Turla APT group, that infiltrated a European ministry of foreign affairs</p>
    
    <div class="article-authors d-flex flex-wrap"><div class="article-author d-flex"><a href="/en/our-experts/filip-jurcacko/" title="Filip Jurƒçacko"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2021/04/filip_jurcacko.jpg" media="(max-width: 768px)" /><img class="author-image me-3"  src="https://web-assets.esetstatic.com/tn/-x45/wls/2021/04/filip_jurcacko.jpg" alt="Filip Jurƒçacko"  /></picture></a><div class="author-text"><p><a href="/en/our-experts/filip-jurcacko/" title="Filip Jurƒçacko"><b>Filip Jurƒçacko</b></a></p></div></div></div>
    <p class="article-info mb-5">
        <span>15 May 2024</span>
        <span class="d-none d-lg-inline">&nbsp;&bull;&nbsp;</span>
        <span class="d-inline d-lg-none">, </span>
        <span>30 min. read</span>
    </p>

    <div class="hero-image-container">
        <picture><source srcset="https://web-assets.esetstatic.com/tn/-x266/wls/2024/5-2024/eset-research-lunar-toolset-turla-apt-lunarweb-lunarmail.jpeg" media="(max-width: 768px)" /><source srcset="https://web-assets.esetstatic.com/tn/-x425/wls/2024/5-2024/eset-research-lunar-toolset-turla-apt-lunarweb-lunarmail.jpeg" media="(max-width: 1120px)" /><img class="hero-image"  src="https://web-assets.esetstatic.com/tn/-x700/wls/2024/5-2024/eset-research-lunar-toolset-turla-apt-lunarweb-lunarmail.jpeg" alt="To the Moon and back(doors): Lunar landing in diplomatic missions"  /></picture>    </div>
</div>
                    <div class="article-body">
    <p>ESET researchers discovered two previously unknown backdoors &ndash; which we named LunarWeb and LunarMail &ndash; compromising a European ministry of foreign affairs (MFA) and its diplomatic missions abroad. We believe that the Lunar toolset has been used since at least 2020 and, given the similarities between the tools&rsquo; tactics, techniques, and procedures (TTPs) and past activities, we attribute these compromises to the infamous Russia-aligned cyberespionage group Turla, with medium confidence. We recently presented our insights from this research at this year&rsquo;s ESET World conference and provide more details about our findings in this blogpost.</p>
<blockquote>
<div><strong>Key points of the blogpost:</strong></div>
<ul>
<li>ESET Research discovered two previously unknown backdoors &ndash; LunarWeb and LunarMail &ndash; used in the compromise of a European MFA and its diplomatic missions.</li>
<li>LunarWeb, deployed on servers, uses HTTP(S) for its C&amp;C communications and mimics legitimate requests, while LunarMail, deployed on workstations, is persisted as an Outlook add-in and uses email messages for its C&amp;C communications.</li>
<li>Both backdoors employ the technique of steganography, hiding commands in images to avoid detection.</li>
<li>Both backdoors utilize a loader that uses the DNS domain name for decryption of the payload, share portions of their codebases, and have the unusual capability of being able to execute Lua scripts.</li>
<li>The loader can have various forms, including trojanized open-source software, demonstrating the advanced techniques used by the attackers.</li>
</ul>
</blockquote>
<p>Turla, also known as Snake, has been active since at least 2004, possibly even dating back to the late 1990s. Believed to be part of the Russian <a href="https://interaktiv.br.de/elite-hacker-fsb/en/index.html" target="_blank" rel="noopener">FSB</a>, Turla mainly targets high-profile entities such as governments and diplomatic organizations in Europe, Central Asia, and the Middle East. The group is notorious for breaching major organizations, including the US Department of Defense in 2008 and the Swiss defense company RUAG in 2014. Over the past few years, we <a href="https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf">have</a><a href="https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/" target="_blank" rel="noopener"> documented</a> a <a href="https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf" target="_blank" rel="noopener">large </a><a href="https://www.welivesecurity.com/wp-content/uploads/2018/08/Eset-Turla-Outlook-Backdoor.pdf">part</a> of <a href="https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf" target="_blank" rel="noopener">Turla&rsquo;s </a><a href="https://www.welivesecurity.com/2020/12/02/turla-crutch-keeping-back-door-open/" target="_blank" rel="noopener">arsenal</a> on WeLiveSecurity.</p>
<p>Our current investigation began with the detection of a loader decrypting and running a payload, from an external file, on an unidentified server. This led us to the discovery of a previously unknown backdoor, which we named LunarWeb. Subsequently, we detected a similar chain with LunarWeb deployed at a diplomatic institution of a European MFA. Notably, the attacker also included a second backdoor &ndash; which we named LunarMail &ndash; that uses a different method for command and control (C&amp;C) communications.</p>
<p>During another attack, we observed simultaneous deployments of a chain with LunarWeb at three diplomatic institutions of this MFA in the Middle East, occurring within minutes of each other. The attacker probably had prior access to the domain controller of the MFA and utilized it for lateral movement to machines of related institutions in the same network.</p>
<p>Further examination uncovered additional pieces of the puzzle, including components utilized in the initial stage of the compromise and a limited number of commands issued by the attacker. The timestamps in the oldest samples and the versions of the libraries used suggest that this toolset has been operational since at least 2020, possibly earlier. Our technical analysis focuses on the techniques these backdoors employ, such as steganography, and communication methods.</p>
<h2>Victimology</h2>
<p>According to ESET telemetry, the compromised machines that we managed to identify belong to a European MFA and are primarily related to its diplomatic missions in the Middle East.</p>
<h2>Technical analysis</h2>
<h3>Initial access</h3>
<p>We don&rsquo;t know exactly how initial access was gained in any of the compromises. However, recovered installation-related components and attacker activity suggest possible spearphishing and abuse of misconfigured network and application monitoring software <a href="https://www.zabbix.com/" target="_blank" rel="noopener">Zabbix</a>. Potential Zabbix abuse is suggested by a LunarWeb installation component imitating Zabbix logs, and a recovered backdoor command used to get the Zabbix agent configuration. Additionally, evidence of spearphishing includes a Word document installing a LunarMail backdoor via a malicious macro.</p>
<p>Below, we provide details of the installation-related components and initial attacker activity.</p>
<h4>Stage 0 &ndash; LunarWeb initial server compromise</h4>
<p>While we don&rsquo;t have the full picture of the initial compromise, we found an installation-related component in one of the server compromises &ndash; a compiled version of an ASP.NET web page originating from following source files:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">&lt;IIS_web_root&gt;\aspnet_client\system_web.aspx</span></li>
<li><span style="font-family: courier new, courier, monospace;">&lt;IIS_web_root&gt;\aspnet_client\system_web.cs</span></li>
</ul>
<p>The <span style="font-family: courier new, courier, monospace;">system_web.aspx</span> filename is a <a href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/" target="_blank" rel="noopener">known IoC</a> of Hafnium, a China-aligned APT known for <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/" target="_blank" rel="noopener">exploiting vulnerabilities</a> in Microsoft Exchange Server software. However, we believe this is either a coincidence or a false flag.</p>
<p>When the <span style="font-family: courier new, courier, monospace;">system_web.aspx</span> page is requested, it responds with a benign-looking Zabbix agent log. However, the page covertly expects a password in a cookie named <span style="font-family: courier new, courier, monospace;">SMSKey</span>. If provided, the password (combined with the salt <span style="font-family: courier new, courier, monospace;">Microsoft.SCCM.Update.Manager</span>) is used to derive an AES-256 key and IV for decrypting two embedded blobs, which are then dropped to two temporary files in a directory excluded from scanning.</p>
<p>While we don&rsquo;t know the password, the file sizes match further stages in the compromise chain &ndash; the Stage 1 loader and Stage 2 blob &ndash; containing the LunarWeb backdoor. Lastly, either the attacker or an unknown component renames and moves the two temporary files to their final destinations, and sets up persistence.</p>
<p>During our investigation, we found that the attacker already had network access, used stolen credentials for lateral movement, and took careful steps to compromise the server without raising suspicion. The attacker&rsquo;s steps included copying two log files over the network; these files were deliberately named to mimic Zabbix agent logs. The attacker moved them to the IIS web directory as the <span style="font-family: courier new, courier, monospace;">system_web</span> page, and sent a HEAD request to the page with a password, which resulted in the creation of two files with <span style="font-family: courier new, courier, monospace;">.tmp</span> filename extensions. The <span style="font-family: courier new, courier, monospace;">system_web</span> page files were then deleted, and the dropped <span style="font-family: courier new, courier, monospace;">.tmp</span> files containing Stages 1 and 2 were moved to the following locations:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\en-US\winnet.dll.mui</span></li>
<li><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\DynamicAuth.bin</span></li>
</ul>
<p>Finally, to maintain access and execute their code, the attacker set up a Group Policy extension in the registry using the Remote Registry service.</p>
<h4>Stage 0 &ndash; LunarMail initial user compromise</h4>
<p>In another compromise, we found an older malicious Word document, likely from a spearphishing email. Despite being a DOC file, it&rsquo;s actually in DOCX format, which is a ZIP archive that can hold extra content. This document has unusual components: 32- and 64-bit versions of a Stage 1 loader, and a Stage 2 blob containing the LunarMail backdoor.</p>
<p>They are installed using a VBA macro, executed on document opening, that does the following:</p>
<ol>
<li>Calculates a victim ID from the computer name and informs its C&amp;C server by pinging a specific URL with the ID in its subdomain.</li>
<li>Creates the directory <span style="font-family: courier new, courier, monospace;">%USERPROFILE%\Gpg4win</span> and extracts the appropriate files from the extra content in the ZIP/DOCX &ndash; Stage 1 loader to <span style="font-family: courier new, courier, monospace;">gpgol.dll</span> and Stage 2 blob to <span style="font-family: courier new, courier, monospace;">tempkeys.dat</span>.</li>
<li>Sets up persistence via Outlook add-in registry settings and pings another URL containing the ID.</li>
</ol>
<p>We did not obtain the whole document, but it probably contains a lure that is enticing enough, since it can't be accessed otherwise, to convince the victim to enable macros.</p>
<p>The paths and names used mimic <a href="https://gpg4win.org/">Gpg4win&rsquo;s</a> Outlook add-in, GpgOL. Once deployed, the Stage 1 loader appears in Outlook Add-Ins, as shown in Figure 1.</p>
<figure class="image"><img title="Figure 1. Malicious Outlook add-in" src="https://web-assets.esetstatic.com/wls/2024/5-2024/lunar-toolset/figure-1-malicious-outlook-add-in.png" alt="Figure 1. Malicious Outlook add-in" width="" height="" />
<figcaption><em>Figure 1. Malicious Outlook add-in</em></figcaption>
</figure>
<h3>Lunar toolset</h3>
<p>Following our analysis of the installers introduced in the previous section, we examine the loaders and finish with analysis of their payloads &ndash; two previously unknown backdoors. Figure 2 outlines the components in the two observed compromise chains.</p>
<figure class="image"><img title="Figure 2. The two observed Lunar toolset compromise chains" src="https://web-assets.esetstatic.com/wls/2024/5-2024/lunar-toolset/figure-2-the-two-observed-lunar-toolset-compromise-chains.png" alt="Figure 2. The two observed Lunar toolset compromise chains" width="" height="" />
<figcaption><em>Figure 2. The two observed Lunar toolset compromise chains</em></figcaption>
</figure>
<h4>Stage 1 &ndash; LunarLoader</h4>
<p>The execution chain begins with a loader that we have named LunarLoader. It uses RC4, a symmetric key cipher, to decrypt the path to the Stage 2 blob and reads an encrypted payload from it. To ensure that only one loader instance is active, it attempts to open and then create a <a href="https://learn.microsoft.com/en-us/windows/win32/ipc/about-mailslots">mailslot</a> with a unique name, instead of a common synchronization object such as mutex or event. It also creates a decryption key, derived from the MD5 hash of the computer&rsquo;s DNS domain name, which it verifies. The payload is then decrypted using AES-256, resulting in a PE file. LunarLoader allocates memory for the PE image and decrypts the name of an exported function in the PE file, which is then run in a new thread. This function contains a <a href="https://attack.mitre.org/techniques/T1620/" target="_blank" rel="noopener">reflective loader</a>.</p>
<p>Using the DNS domain name for payload decryption serves as an execution guardrail. The loader correctly executes only in the targeted organization, which may hinder analysis if the domain name is not known.</p>
<p>LunarLoader can have a standalone form or be a part of trojanized open-source software. We observed one case of the latter, with a trojanized <a href="https://github.com/GreyCorbel/admpwd" target="_blank" rel="noopener">AdmPwd</a>, which is a part of Windows Local Administrator Password Solution (LAPS).</p>
<p>We observed that LunarLoader uses three different persistence methods and several file paths, as shown in Table 1.</p>
<p style="text-align: center;"><em>Table 1. Variants of LunarLoader</em></p>
<p><table style="width: 79.1984%;">
<thead>
<tr>
<td style="width: 13%;">
<p><strong>Persistence method</strong></p>
</td>
<td style="width: 32%;">
<p><strong>Loader path(s)</strong></p>
</td>
<td style="width: 21%;">
<p><strong>Host&nbsp;process</strong></p>
</td>
<td style="width: 11.36%;">
<p><strong>Note</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 13%;">
<p>Group policy extension</p>
</td>
<td style="width: 32%;">
<p><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\en-US\winnet.dll.mui</span></p>
<p><span style="font-family: courier new, courier, monospace;">C:\Program Files\LAPS\CSE\AdmPwd.dll*</span></p>
</td>
<td style="width: 21%;">
<p><span style="font-family: courier new, courier, monospace;">svchost.exe&nbsp;-k&nbsp;GPSvcGroup</span></p>
</td>
<td style="width: 11.36%;">
<p>The&nbsp;<span style="font-family: courier new, courier, monospace;">AdmPwd&nbsp;dll</span>&nbsp;is&nbsp;a&nbsp;known legitimate&nbsp;file&nbsp;path of Microsoft&nbsp;LAPS.</p>
</td>
</tr>
<tr>
<td style="width: 13%;">
<p>System DLL replacement</p>
</td>
<td style="width: 32%;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\tapiperf.dll</span></p>
</td>
<td style="width: 21%;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">wmiprvse.exe</span></p>
</td>
<td style="width: 11.36%;" nowrap="nowrap">
<p>Replacing a legitimate<br />Windows DLL.</p>
</td>
</tr>
<tr>
<td style="width: 13%;" nowrap="nowrap">
<p>Outlook add‚Äëin</p>
</td>
<td style="width: 32%;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">%USERPROFILE%\Gpg4win\gpgol.dll</span></p>
</td>
<td style="width: 21%;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">outlook.exe</span></p>
</td>
<td style="width: 11.36%;" nowrap="nowrap">
<p>N/A</p>
</td>
</tr>
</tbody>
</table></p>
<h4>Stage 2 blob &ndash; payload container</h4>
<p>The blob used in Stage 2 consists of four entries &ndash; including two unused strings, where the value of one is the base64-encoded version of the string <span style="font-family: courier new, courier, monospace;">freedom or death</span> or <span style="font-family: courier new, courier, monospace;">freedom or death (yeah,we are alive)</span>, as shown in Figure 3, and 32-bit and 64-bit versions of the payload.</p>
<figure class="image"><img style="width: 25%; margin: 0 auto; display: block;" title="" src="https://web-assets.esetstatic.com/wls/2024/5-2024/lunar-toolset/figure-3-decoded-version-of-the-string-which-contains-a-message.png" alt="Figure 3. Decoded version of the string, which contains a message" width="" height="" />
<figcaption><em>Figure 3. Decoded version of the string, which contains a message</em></figcaption>
</figure>
<p>While the purpose of the f<span style="font-family: courier new, courier, monospace;">reedom or death</span> string in the given context isn&rsquo;t explicitly explained, it&rsquo;s common for malware authors to include such strings for a variety of possible reasons, such as tracking different versions of their malware, to serve as a distraction or false lead for analysts, or simply as a form of signature or calling card. In some cases, we found strings instead of a 32-bit payload &ndash; such as the string <span style="font-family: courier new, courier, monospace;">shit happens</span>.</p>
<p>We observed two different backdoors used as payloads. The backdoors seem to use the following DLL names in the export directory, with these suspected meanings:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">ms<span style="background-color: #0096a1;">wt</span>[e].dll </span>&ndash; <span style="background-color: #0096a1;">w</span>eb <span style="background-color: #0096a1;">t</span>ransport (LunarWeb)</li>
<li><span style="font-family: courier new, courier, monospace;">ms<span style="background-color: #0096a1;">mt</span>[e].dll</span> &ndash; <span style="background-color: #0096a1;">m</span>ail <span style="background-color: #0096a1;">t</span>ransport (LunarMail)</li>
</ul>
<p>The <span style="font-family: courier new, courier, monospace;">e</span> suffix is used for the 64-bit versions. The observed file paths for the blob are listed in the <a href="#IoCs">IoCs</a> section.</p>
<h4>Stage 2 payload #1 &ndash; LunarWeb backdoor</h4>
<p>LunarWeb, the first payload we discovered, is a backdoor that communicates with its C&amp;C server using HTTP(S) and executes commands it receives. We observed that LunarWeb was deployed only on servers, not user workstations.</p>
<p>During its initialization, LunarWeb attempts to locate or create its state file, which contains entries related to its execution. Then it decrypts strings, mostly related to communication, using RC4 with the static key <span style="font-family: courier new, courier, monospace;">C1 82 A7 04 21 B6 40 C8 9A C3 79 AD F5 5F 72 86</span>. It also collects victim identification data and uses it to calculate a victim ID, which is used in communications with the C&amp;C server.</p>
<p>After conducting safety checks, the backdoor waits for a few hours before entering its communication loop. This delay is skipped on the backdoor&rsquo;s first run. The security checks include a limit of initial contact attempts with the C&amp;C server, assessing the backdoor&rsquo;s lifespan, and checking C&amp;C server accessibility. If any of the safety conditions fail, LunarWeb self-removes, deleting its files, including the Stage 1 loader and Stage 2 blob. However, the persistence method for the Stage 1 loader is left, potentially leaving detectable traces.</p>
<h5>Configuration and state</h5>
<p>LunarWeb&rsquo;s configuration is hardcoded into the binary, likely from manual source code changes. The configuration varies between samples, including the C&amp;C servers, their unreachability threshold, the communication format, and the backdoor lifespan.</p>
<p>The backdoor maintains a 512-byte state structure, updated during execution and stored in a file. This file contains three state slots, accessed by index <span style="font-family: courier new, courier, monospace;">0</span>, <span style="font-family: courier new, courier, monospace;">1</span>, or <span style="font-family: courier new, courier, monospace;">2</span> as shown in Figure 4. The first two slots are modifiable, but unused by this backdoor; only the third slot is used. State slots are encrypted using RC4 with key <span style="font-family: courier new, courier, monospace;">99 53 EA 6A AB 29 44 EF BE 36 12 9E F2 3B 5E C9</span>.</p>
<figure class="image"><img title="Figure 4. Hex-Rays decompilation showing state retrieval" src="https://web-assets.esetstatic.com/wls/2024/5-2024/lunar-toolset/figure-4-hex-rays-decompilation-showing-state-retrieval.png" alt="Figure 4. Hex-Rays decompilation showing state retrieval" width="" height="" />
<figcaption><em>Figure 4. Hex-Rays decompilation showing state retrieval</em></figcaption>
</figure>
<p>The observed locations of the state files are listed in the <a href="#IoCs">IoCs</a> section.</p>
<h5>Information collection</h5>
<p>LunarWeb collects the following information about its host computer:</p>
<ul>
<li>unique victim identification obtained via WMI queries:
<ul>
<li>operating system version with serial number,</li>
<li>BIOS version with serial number, and</li>
<li>domain name.</li>
</ul>
</li>
<li>further system information obtained via shell commands:
<ul>
<li>computer and operating system information (output of <span style="font-family: courier new, courier, monospace;">systeminfo.exe</span>),</li>
<li>environment variables,</li>
<li>network adapters,</li>
<li>list of running processes,</li>
<li>list of services, and</li>
<li>list of installed security products.</li>
</ul>
</li>
</ul>
<p>The information is sent to the C&amp;C server on first contact.</p>
<h4>Communication</h4>
<p>After initialization, LunarWeb communicates with its C&amp;C server using HTTP(S), underneath which is a custom binary protocol with encrypted content.</p>
<p>LunarWeb employs three URLs (containing IP addresses instead of domains) for different purposes. One URL is used for first contact, uploading information about the host computer as described in the previous section. The two remaining URLs are used for getting commands, each being on a different server. We refer to these URLs below as command URLs.</p>
<p>To hide its C&amp;C communications, LunarWeb impersonates legitimate-looking traffic, spoofing HTTP headers with genuine domains and commonly used attributes. It can also receive commands hidden in images. Impersonated attributes from each observed LunarWeb sample are shown in Table 2.</p>
<p style="text-align: center;"><em>Table 2. Impersonated attributes</em></p>
<p><table style="width: 100%; height: 635px;">
<thead>
<tr style="height: 50px;">
<td style="width: 13.2159%; height: 50px;" nowrap="nowrap">
<p><strong>Host</strong></p>
</td>
<td style="width: 53.1904%; height: 50px;" nowrap="nowrap">
<p><strong>User-Agent</strong></p>
</td>
<td style="width: 32.4683%; height: 50px;" nowrap="nowrap">
<p><strong>Request-URI / Filename</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr style="height: 70px;">
<td style="width: 13.2159%; height: 70px;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">win8.ipv6.microsoft.com</span></p>
</td>
<td style="width: 53.1904%; height: 70px;">
<p><span style="font-family: courier new, courier, monospace;">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko/20100101 Firefox/80.0</span></p>
</td>
<td style="width: 32.4683%; height: 70px;" nowrap="nowrap">
<p>(Non-impersonating URIs)</p>
</td>
</tr>
<tr style="height: 238px;">
<td style="width: 13.2159%; height: 238px;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">i1.c1.eset.com</span></p>
</td>
<td style="width: 53.1904%; height: 238px;">
<p><span style="font-family: courier new, courier, monospace;">Host:&nbsp;EES&nbsp;Update&nbsp;(Windows;&nbsp;U;&nbsp;64bit; BPC 9.0.2047.0; OS: 10.0.16299 SP 0.0 NT; TDB 57524; TPCAT 0; CL 1.0.0; x64c; APP ees; ASP 0.0; FW 32.0; PX 1; CD 1; RA 1; UBR 2166; HVCI 0; SHA256 1; WU 3; HWF: DA7506AC-AB57-4C28-BC32-E6D90B48B66F; PLOC en_us; PCODE 111.0.0; PAR 0; ATH -1; DC 0; PLID 375-GTM-VO6; SEAT 62f587f1; RET 5004)</span></p>
<p><span style="font-family: courier new, courier, monospace;">[<em>sic</em>]</span></p>
</td>
<td style="width: 32.4683%; height: 238px;">
<p><span style="font-family: courier new, courier, monospace;">update.ver.signed</span></p>
<p><span style="font-family: courier new, courier, monospace;">livegrid</span></p>
</td>
</tr>
<tr style="height: 70px;">
<td style="width: 13.2159%; height: 70px;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">&lt;MFA_country_news_site&gt;</span></p>
</td>
<td style="width: 53.1904%; height: 70px;">
<p><span style="font-family: courier new, courier, monospace;">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0</span></p>
</td>
<td style="width: 32.4683%; height: 70px;" nowrap="nowrap">
<p>(Non-impersonating URIs)</p>
</td>
</tr>
<tr style="height: 121px;">
<td style="width: 13.2159%; height: 121px;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">ctldl.windowsupdate.com</span></p>
</td>
<td style="width: 53.1904%; height: 121px;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">Microsoft-CryptoAPI/6.1</span></p>
</td>
<td style="width: 32.4683%; height: 121px;">
<p><span style="font-family: courier new, courier, monospace;">/msdownload/update/v3/static/trustedr/en/authrootstl.cab</span></p>
<p><span style="font-family: courier new, courier, monospace;">/msdownload/update/v3/static/trustedr/en/disallowedcertstl.cab</span></p>
<p><span style="font-family: courier new, courier, monospace;">/msupload/update/v3/static/trustedr/stats</span></p>
</td>
</tr>
<tr style="height: 86px;">
<td style="width: 13.2159%; height: 86px;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">ctldl.windowsupdate.com</span></p>
</td>
<td style="width: 53.1904%; height: 86px;" nowrap="nowrap">
<p><span style="font-family: courier new, courier, monospace;">Microsoft-CryptoAPI/6.1</span></p>
</td>
<td style="width: 32.4683%; height: 86px;">
<p><span style="font-family: courier new, courier, monospace;">/msdownload/update/v3/static/trustedr/en/authrootstl.cab</span></p>
<p><span style="font-family: courier new, courier, monospace;">/msdownload/update/v3/static/trustedr/stats</span></p>
</td>
</tr>
</tbody>
</table></p>
<p>Notable examples of impersonation include Windows services (Teredo, Windows Update) and updates of ESET products. In cases of ESET impersonation, the attackers copied the User-Agent (where they slipped in a Host header) and other headers used by updates of our product. Strangely, they spoofed a nonexistent domain in the Host header.</p>
<p>Victim identification is included in HTTP requests, either in a cookie or a URL query parameter. The first method uses randomly generated cookies with a 16-byte identifier (possibly a campaign ID) and a victim ID. The second method appends the victim ID twice to the URL. The suspected campaign ID is present in samples using the second method but is not used. LunarWeb can also use an HTTP proxy server for C&amp;C communications, if needed.</p>
<h6>Receiving commands</h6>
<p>LunarWeb collects commands from the C&amp;C server via a GET request to the command URL. The request and response format vary across five supported formats, with a hardcoded value determining which to use. Table 3 provides an overview of these formats. We observed usage of formats <span style="font-family: courier new, courier, monospace;">2</span>, <span style="font-family: courier new, courier, monospace;">3</span>, and <span style="font-family: courier new, courier, monospace;">4</span>.</p>
<p style="text-align: center;"><em>Table 3. Communication formats for getting commands</em></p>
<p><table>
<thead>
<tr>
<td width="8%">
<p><strong>Format</strong></p>
</td>
<td width="25%">
<p><strong>Command request filename example</strong></p>
</td>
<td width="16%">
<p><strong>Response, extraction, decoding</strong></p>
</td>
<td width="16%">
<p><strong>Response decryption, decompression</strong></p>
</td>
<td width="33%">
<p><strong>Note</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td width="8%">
<p><span style="font-family: courier new, courier, monospace;">0</span></p>
</td>
<td width="25%">
<p>N/A</p>
</td>
<td nowrap="nowrap" width="16%">
<p>Base64</p>
</td>
<td nowrap="nowrap" width="16%">
<p>RSA</p>
</td>
<td width="33%">
<p>Short commands only (RSA-4096 512‚Äëbyte limit).</p>
</td>
</tr>
<tr>
<td width="8%">
<p><span style="font-family: courier new, courier, monospace;">1</span></p>
</td>
<td width="25%">
<p>N/A</p>
</td>
<td nowrap="nowrap" width="16%">
<p>None</p>
</td>
<td nowrap="nowrap" width="16%">
<p>RSA</p>
</td>
<td width="33%">
<p>Short commands only (RSA-4096 512‚Äëbyte limit).</p>
</td>
</tr>
<tr>
<td width="8%">
<p><span style="font-family: courier new, courier, monospace;">2</span></p>
</td>
<td width="25%">
<p><span style="font-family: courier new, courier, monospace;">update.ver.signed</span></p>
<p><span style="font-family: courier new, courier, monospace;">disallowedcertstl.cab </span>(impersonation specific)</p>
</td>
<td nowrap="nowrap" width="16%">
<p>Base64 or none</p>
</td>
<td nowrap="nowrap" width="16%">
<p>RSA, AES, zlib</p>
</td>
<td width="33%">
<p>Decoding is skipped in instances where this format is actually used.</p>
</td>
</tr>
<tr>
<td width="8%">
<p><span style="font-family: courier new, courier, monospace;">3</span></p>
</td>
<td width="25%">
<p><span style="font-family: courier new, courier, monospace;">&lt;random_5_alnum&gt;.jpg</span></p>
</td>
<td nowrap="nowrap" width="16%">
<p>JPG</p>
</td>
<td nowrap="nowrap" width="16%">
<p>RSA, AES, zlib</p>
</td>
<td width="33%">
<p>The data is inside a JPG comment.</p>
</td>
</tr>
<tr>
<td width="8%">
<p><span style="font-family: courier new, courier, monospace;">4</span></p>
</td>
<td width="25%">
<p><span style="font-family: courier new, courier, monospace;">&lt;random_5_alnum&gt;.gif</span></p>
</td>
<td nowrap="nowrap" width="16%">
<p>GIF</p>
</td>
<td nowrap="nowrap" width="16%">
<p>RSA, AES, zlib</p>
</td>
<td width="33%">
<p>The data is inside GIF data blocks.</p>
</td>
</tr>
</tbody>
</table></p>
<p>Depending on the communication format, the data received from the C&amp;C server might need decoding using the base64 algorithm or extraction from an image. JPGs are scanned for the comment marker <span style="font-family: courier new, courier, monospace;">FF FE</span>, while GIFs are parsed using the <a href="https://giflib.sourceforge.net/" target="_blank" rel="noopener">giflib</a> library. In both cases, the interesting data is embedded in the structures of the image format and not hidden in individual pixels of an image, as in <a href="https://ctf101.org/forensics/what-is-stegonagraphy/#lsb-steganography" target="_blank" rel="noopener">LSB steganography</a> for example.</p>
<p>Communication formats <span style="font-family: courier new, courier, monospace;">0</span> and <span style="font-family: courier new, courier, monospace;">1</span>, though not observed, simply decrypt resulting data using RSA-4096. Formats <span style="font-family: courier new, courier, monospace;">2</span>, <span style="font-family: courier new, courier, monospace;">3</span>, and <span style="font-family: courier new, courier, monospace;">4</span> are more complex. The resulting data starts with an encrypted AES seed, decrypted with RSA-4096 and used to derive a session key. This session key is then used to decrypt the rest of the data using AES-256, followed by zlib decompression.</p>
<p>After decryption and, if needed, decompression, the received data results in a command package. This package, possessing a unique ID, is compared to the last processed ID, stored in the backdoor&rsquo;s state. If they are different, the backdoor processes the package and updates the last ID. The package may hold multiple commands. Each command is executed, and its output sent to the C&amp;C server in a single format, with no steganography, as described in the ensuing Exfiltrating data section.</p>
<p>To perform cryptographic operations, LunarWeb utilizes a statically linked <a href="https://github.com/Mbed-TLS/mbedtls" target="_blank" rel="noopener">Mbed TLS</a> library. It has two embedded RSA-4096 keys: one for decrypting incoming data and one for encrypting outgoing data. Both use standard parameters and are outlined in our <a href="https://github.com/eset/malware-ioc/tree/master/turla#to-the-moon-and-back-doors-lunar-landing-in-diplomatic-missions-indicators-of-compromise" target="_blank" rel="noopener">GitHub repository</a>.</p>
<h6>Exfiltrating data</h6>
<p>First, data is zlib-compressed and encrypted using AES-256, with a session key and IV derived from the data&rsquo;s size, also producing a hash-based message authentication code (<a href="https://en.wikipedia.org/wiki/HMAC" target="_blank" rel="noopener">HMAC</a>).</p>
<p>For AES encryption, a random 32-byte AES seed is generated and encrypted using RSA-4096. The seed is used to derive a session key in a <a href="https://en.wikipedia.org/wiki/PBKDF2" target="_blank" rel="noopener">PBKDF</a>-like manner, SHA-256 hashing the seed and an IV 8,192 times. The same key derivation happens when decrypting received data. The derivation algorithm and encryption code was copied from an older Mbed TLS <a href="https://github.com/Mbed-TLS/mbedtls/blob/995c66f702db3a004be1e3d822ffad64b2ad125f/programs/aes/aescrypt2.c" target="_blank" rel="noopener">sample program</a> that was removed from the library in 2021.</p>
<p>Finally, the encrypted data, along with decryption and integrity metadata, is sent. If output data exceeds <span style="font-family: courier new, courier, monospace;">1.33 MB</span> after compression, it is split into multiple parts of random size (<span style="font-family: courier new, courier, monospace;">384&ndash;512&nbsp;KB</span>).</p>
<p>POST requests to the C&amp;C server include impersonation headers and victim identification, and their sending is delayed by a sleep of 34 to 40 seconds. Interestingly, each command package received contains an output URL, which is where to send the result. This could be a different URI on the same C&amp;C server, or a completely different server. In the limited number of command packages that we observed, the output URL was the same as the command URL.</p>
<h5>Commands</h5>
<p>LunarWeb supports common backdoor capabilities, including file and process operations, and running shell commands, including ones via PowerShell. One of the commands stands out, with the rather uncommon capability of being able to run <a href="https://www.lua.org/" target="_blank" rel="noopener">Lua</a> code.</p>
<p>The full list of supported commands, with additional details, is shown in Table 4.</p>
<p style="text-align: center;"><em>Table 4. Overview of LunarWeb commands</em></p>
<p><table style="width: 781.234px; height: 1034px;">
<thead>
<tr style="height: 50px;">
<td style="width: 32px; height: 50px;">
<p><strong>Type</strong></p>
</td>
<td style="width: 195px; height: 50px;">
<p><strong>Command</strong></p>
</td>
<td style="width: 552.234px; height: 50px;">
<p><strong>Details</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr style="height: 86px;">
<td style="width: 32px; height: 86px;">
<p><span style="font-family: courier new, courier, monospace;">0</span></p>
</td>
<td style="width: 195px; height: 86px;">
<p>Run&nbsp;shell&nbsp;commands&nbsp;via&nbsp;a&nbsp;BAT file and get outpu<a>t</a>&nbsp;</p>
</td>
<td style="width: 552.234px; height: 86px;">
<p>Runs specified shell commands via a temporary BAT file <span style="font-family: courier new, courier, monospace;">%TEMP%\&lt;‚Å†random_9_alnum_chars&gt;.bat</span>. The output is retrieved via a pipe (also applies to the next four commands).</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">1</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Run shell commands and get Unicode output</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Runs the shell commands on the command line via <span style="font-family: courier new, courier, monospace;">cmd.exe /c</span> and <span style="font-family: courier new, courier, monospace;">/U</span> option for Unicode output.</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">2</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Run shell commands and get output</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Runs the shell commands on the command line via <span style="font-family: courier new, courier, monospace;">cmd.exe /c</span>.</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">3</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Run PowerShell commands via a PS1 file and get output</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Runs specified PowerShell commands via a temporary script file <span style="font-family: courier new, courier, monospace;">%TEMP%\&lt;random_12_alnum_chars&gt;.ps1</span>.</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">4</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Run PowerShell commands and get output</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Runs specified PowerShell commands via <span style="font-family: courier new, courier, monospace;">powershell.exe -command</span>.</p>
</td>
</tr>
<tr style="height: 86px;">
<td style="width: 32px; height: 86px;">
<p><span style="font-family: courier new, courier, monospace;">5</span></p>
</td>
<td style="width: 195px; height: 86px;">
<p>Run Lua code</p>
</td>
<td style="width: 552.234px; height: 86px;">
<p>Lua code is executed using the statically linked <a href="https://github.com/davidm/luacom">LuaCOM</a> library and the Lua library, version <span style="font-family: courier new, courier, monospace;">5.1.5</span>. These libraries, along with the command, were not present in the single 32-bit version of the LunarWeb backdoor that we observed.</p>
</td>
</tr>
<tr style="height: 50px;">
<td style="width: 32px; height: 50px;">
<p><span style="font-family: courier new, courier, monospace;">6</span></p>
</td>
<td style="width: 195px; height: 50px;">
<p>Write file</p>
</td>
<td style="width: 552.234px; height: 50px;">
<p>Specifies the file path and content to write.</p>
</td>
</tr>
<tr style="height: 50px;">
<td style="width: 32px; height: 50px;">
<p><span style="font-family: courier new, courier, monospace;">7</span></p>
</td>
<td style="width: 195px; height: 50px;">
<p>Read file</p>
</td>
<td style="width: 552.234px; height: 50px;">
<p>Uses file mapping to access content instead of the regular <span style="font-family: courier new, courier, monospace;">ReadFile </span>API.</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">8</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Get victim identification via WMI</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Obtains victim identification information using WMI queries, the same <a>information</a>&nbsp;as described in the <em>Information collection</em> section.</p>
</td>
</tr>
<tr style="height: 50px;">
<td style="width: 32px; height: 50px;">
<p><span style="font-family: courier new, courier, monospace;">9</span></p>
</td>
<td style="width: 195px; height: 50px;">
<p>No operation</p>
</td>
<td style="width: 552.234px; height: 50px;">
<p>N/A</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">10</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Update state entry in third slot</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Updates an entry in the state used by the backdoor (index <span style="font-family: courier new, courier, monospace;">2</span>), adjusting break duration before communication loop and after C&amp;C contact failure..</p>
</td>
</tr>
<tr style="height: 50px;">
<td style="width: 32px; height: 50px;">
<p><span style="font-family: courier new, courier, monospace;">11</span></p>
</td>
<td style="width: 195px; height: 50px;">
<p>Set state content in first slot</p>
</td>
<td style="width: 552.234px; height: 50px;">
<p>Sets the content of the state in the first slot (index <span style="font-family: courier new, courier, monospace;">0</span>), but its purpose is unknown.</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">12</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Set state content in second slot</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Sets the content of the state in the second slot (index <span style="font-family: courier new, courier, monospace;">1</span>), but its purpose is unknown.</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">13</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Create process and get output</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Creates an arbitrary process with a specified command line and retrieves its output via a pipe.</p>
</td>
</tr>
<tr style="height: 68px;">
<td style="width: 32px; height: 68px;">
<p><span style="font-family: courier new, courier, monospace;">14</span></p>
</td>
<td style="width: 195px; height: 68px;">
<p>Zip specified path(s)</p>
</td>
<td style="width: 552.234px; height: 68px;">
<p>Creates a ZIP archive with specified files and directories, via the statically linked <a href="https://github.com/sebastiandev/zipper">Zipper</a> library.</p>
</td>
</tr>
</tbody>
</table></p>
<p>Some of the commands can output an error message referring to the commands as tasks &ndash; <span style="font-family: courier new, courier, monospace;">Format of the task is incorrect</span>.</p>
<p>We were able to recover a command package that contained multiple shell commands used for reconnaissance executed via command <span style="font-family: courier new, courier, monospace;">1</span>, collecting the following: system and OS Information, user information, network configuration and connections, environment variables, scheduled tasks, installed programs and security products, firewall settings, directory listings, Kerberos tickets and sessions, shared resources, Group Policy, and local group memberships. Additionally, a read file command (<span style="font-family: courier new, courier, monospace;">7</span>) was used to retrieve Zabbix configuration from a specified file path.</p>
<h4>Stage 2 payload #2 &ndash; LunarMail backdoor</h4>
<p>The second backdoor, which we call LunarMail, shares many similarities with LunarWeb. The main difference is the communication method &ndash; LunarMail uses email for communication with its C&amp;C server.</p>
<p>This backdoor is designed to be deployed on user workstations, not servers &ndash; because it is persisted and intended to run as an Outlook add-in. A high-level overview of how LunarMail operates is shown in Figure 5.</p>
<figure class="image"><img title="Figure 5. LunarMail operation" src="https://web-assets.esetstatic.com/wls/2024/5-2024/lunar-toolset/figure-5-lunarmail-operation.png" alt="Figure 5. LunarMail operation" width="" height="" />
<figcaption><em>Figure 5. LunarMail operation</em></figcaption>
</figure>
<p>LunarMail shares ideas of its operation with <a href="https://web-assets.esetstatic.com/wls/2019/05/ESET-LightNeuron.pdf">LightNeuron</a>, another Turla backdoor that uses email messages for C&amp;C purposes. Although both use a similar exfiltration method, we did not find any code similarities between the two backdoors. Other Turla backdoors with similar operation include <a href="https://web-assets.esetstatic.com/wls/2018/08/Eset-Turla-Outlook-Backdoor.pdf">Outlook backdoor</a>.</p>
<h5>Initialization</h5>
<p>During its initialization, the backdoor decrypts a string used to initialize a regex object that is used as a filter to search for the email profile to use for C&amp;C purposes, which we describe later. The regex expression, and other strings in the backdoor, are encrypted using RC4 with the static key <span style="font-family: courier new, courier, monospace;">E3&nbsp;7C 9E B0 DF D1 46 48 B4 AE 8A 5F 2A A1 78 7B</span>.</p>
<p>To interact with Outlook, the backdoor dynamically resolves the necessary <a href="https://learn.microsoft.com/en-us/office/client-developer/outlook/mapi/outlook-mapi-reference">Outlook Messaging API (MAPI)</a> functions.</p>
<p>On each run, the backdoor creates a directory in the path <span style="font-family: courier new, courier, monospace;">%TEMP%\{&lt;random_guid&gt;},</span> used as a staging directory for data exfiltration.</p>
<h5>Configuration and state</h5>
<p>Similar to LunarWeb, LunarMail&rsquo;s configuration entries are hardcoded in the binary. It also maintains a state file, with a single state (unlike LunarWeb, which has multiple state slots).</p>
<p>The configuration likely consists of conditions to find an Outlook profile for C&amp;C communications, default exfiltration configuration, and the backdoor&rsquo;s lifespan limit.</p>
<p>The state is persisted in the file <span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Microsoft\Outlook\outlk.share</span> with a 668-byte structure, updated during execution. It stores, among others, a timestamp of the last executed command and current staging directory. On subsequent runs, the previous staging directory is deleted and replaced with a new one.</p>
<h5>Information collection</h5>
<p>On first run, the LunarMail backdoor collects the following information:</p>
<ul>
<li>environment variables, and</li>
<li>recipients of all sent email messages (email addresses).</li>
</ul>
<p>Additionally, a batch file with shell commands to obtain further system information is decrypted but never executed.</p>
<p>In certain error cases, such as failure to collect the aforementioned information, the email addresses of available Outlook profiles are collected.</p>
<h5>Communication and commands</h5>
<p>Running inside Outlook, the LunarMail backdoor communicates with its C&amp;C server &ndash; receiving commands and exfiltrating data &ndash; using email messages, via the <a href="https://learn.microsoft.com/en-us/office/client-developer/outlook/mapi/outlook-mapi-reference" target="_blank" rel="noopener">Outlook Messaging API (MAPI)</a>.</p>
<h6>Profile search</h6>
<p>To communicate, LunarMail first searches for suitable Outlook profiles provided by Microsoft Exchange. The profile conditions include having only four default folders (Inbox, Sent, Deleted, and Outbox), containing the domain of the targeted institution in the email address, and not matching a regex pattern for various legitimate institutional emails.</p>
<p>The first matching profile sends initial information. For further communication, the inboxes of profile candidates are searched for command-containing emails. This approach avoids hardcoding profiles and makes identification harder. Additionally, commands can set a specific profile to use, which is persisted in the backdoor&rsquo;s state.</p>
<h6>Receiving commands</h6>
<p>LunarMail identifies a profile with commands by searching email messages and attempting to parse their attachments. The attachment must be a single PNG image with the <span style="font-family: courier new, courier, monospace;">.png</span> extension, with the size of less than or equal to 10 MB. It then attempts to parse <span style="font-family: courier new, courier, monospace;">IDAT</span> chunks of the PNG file, looking for an AES seed, an exfiltration configuration, and commands chunks. All these components are zlib-compressed and encrypted, the first using RSA-4096 and the latter two using AES.</p>
<p>Interestingly, the chunks must adhere to the PNG format with verified CRCs, resulting in a valid, but noisy-looking image due to encrypted, compressed content.</p>
<p>LunarMail uses the same cryptography as LunarWeb, including the Mbed TLS library, two RSA-4096 keys (listed in our <a href="https://github.com/eset/malware-ioc/tree/master/turla#to-the-moon-and-back-doors-lunar-landing-in-diplomatic-missions-indicators-of-compromise">GitHub repository</a>), and usage of AES-256 with the same key derivation algorithm. The decompressed chunk with AES-encrypted content has a similar structure to that seen in LunarWeb.</p>
<p>The decrypted, decompressed exfiltration configuration has a specific structure including configuration ID, email address, subject, body, and attachment name and extension.</p>
<p>The exfiltration configuration structure mirrors LunarWeb&rsquo;s command package metadata, specifying the command outputs&rsquo; destination and an ID to avoid duplicate commands, stored in state. Once decrypted and decompressed, LunarMail commands have a structure identical to LunarWeb&rsquo;s. Each parsed command is executed, storing output in the staging directory for exfiltration.</p>
<p>Notably, email messages that fail parsing for commands have their IDs cached to avoid repeated parsing, although the cache is not persisted and it is recreated on each backdoor execution. Emails successfully parsed for commands are deleted after processing.</p>
<h6>Commands</h6>
<p>In terms of command capabilities, LunarMail is simpler and features a subset of the commands found in LunarWeb. It can write a file, create a new process, and uniquely, take a screenshot and modify the C&amp;C communication email address. While LunarMail lacks separate commands for running shell or PowerShell commands, it does support Lua scripts. When executed, commands write their output to files in the staging directory.</p>
<p>The full list of supported commands is shown in Table 5.</p>
<p style="text-align: center;"><em>Table 5. Overview of LunarMail commands</em></p>
<p><table border="1" width="100%" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td width="71">
<p><strong>Type</strong></p>
</td>
<td width="153">
<p><strong>Command</strong></p>
</td>
<td width="397">
<p><strong>Details</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td width="71">
<p><span style="font-family: courier new, courier, monospace;">0</span></p>
</td>
<td width="153">
<p>No operation</p>
</td>
<td width="397">
<p>N/A</p>
</td>
</tr>
<tr>
<td width="71">
<p><span style="font-family: courier new, courier, monospace;">1</span></p>
</td>
<td width="153">
<p>Write file</p>
</td>
<td width="397">
<p>Specifies the file path and content to write.</p>
</td>
</tr>
<tr>
<td width="71">
<p><span style="font-family: courier new, courier, monospace;">2</span></p>
</td>
<td width="153">
<p>Set the email address used for C&amp;C communications</p>
</td>
<td width="397">
<p>Sets a specific Outlook profile to use for C&amp;C communications. The profile is specified by an email address, which is then persisted in the backdoor&rsquo;s state.</p>
</td>
</tr>
<tr>
<td width="71">
<p><span style="font-family: courier new, courier, monospace;">3</span></p>
</td>
<td width="153">
<p>Create process and get output</p>
</td>
<td width="397">
<p>Creates an arbitrary process with a specified command line, redirecting its output to the staging directory.</p>
</td>
</tr>
<tr>
<td width="71">
<p><span style="font-family: courier new, courier, monospace;">4</span></p>
</td>
<td width="153">
<p>Take a screenshot</p>
</td>
<td width="397">
<p>Utilizes <a href="https://learn.microsoft.com/en-us/windows/win32/gdiplus/-gdiplus-gdi-start">GDI+ API</a> to capture the entire screen and produce a JPG file.</p>
</td>
</tr>
<tr>
<td width="71">
<p><span style="font-family: courier new, courier, monospace;">5</span></p>
</td>
<td width="153">
<p>Run Lua code</p>
</td>
<td width="397">
<p>Just as in LunarWeb, Lua code is executed using the statically linked libraries LuaCOM and Lua.</p>
</td>
</tr>
</tbody>
</table></p>
<h6>Exfiltrating data &ndash; preparation</h6>
<p>LunarMail searches its staging directory for output files produced by the backdoor, preparing them for exfiltration by embedding them in a PNG image or PDF document (depending on the attachment extension in the exfiltration configuration). Both PNG and PDF files are created using a valid content template.</p>
<p>For PNG files, a template matching the compromised institution&rsquo;s logo is used, indicating prior knowledge and preparation of the backdoor. To create a PNG that contains output files, LunarMail first generates a random 32-byte AES seed, used for encryption. Then it creates <span style="font-family: courier new, courier, monospace;">IDAT </span>chunks with data and appends them to the PNG template. The chunks are similar to received commands, containing the following:</p>
<ul>
<li>Chunk with AES seed &ndash; RSA-4096 encrypted, zlib compressed.</li>
<li>Chunk(s) with filename and content &ndash; AES-256 encrypted, zlib compressed.</li>
</ul>
<p>Before compression and encryption, the output file name and content are wrapped into a structure that also contains a magic string <span style="font-family: courier new, courier, monospace;">001035 </span>that could be the backdoor version. Just like in received command PNGs, the created chunks follow the PNG specification and have their CRC checksum calculated, ensuring a valid image. To finalize the image, the <span style="font-family: courier new, courier, monospace;">IEND </span>footer chunk is appended.</p>
<p>The second method, producing a PDF file, uses an encrypted template from the file <span style="font-family: courier new, courier, monospace;">%TEMP%\l4_mgrT.tmp</span>. We have not observed this data file and the template&rsquo;s content is unknown, but probably it is a benign, unsuspicious document.</p>
<p>The output files with metadata are inserted at the end of the last stream in the PDF template, before the terminating <span style="font-family: courier new, courier, monospace;">endstream </span>keyword. They are inserted in the following format and order:</p>
<ol>
<li>Output files &ndash; variable sized, zlib compressed, AES-256 encrypted.</li>
<li>Metadata &ndash; fixed size (512 bytes), RSA-4096 encrypted.</li>
</ol>
<p>The output filename and content are wrapped into the same structure as with the PNG, including the magic string, which is then compressed and encrypted.</p>
<p>The metadata contains information necessary for parsing and decrypting the structures of output files, including AES seed and output file positions in the PDF file.</p>
<p>After processing and embedding in the PNG or PDF file, files staged for exfiltration are deleted. The created file temporarily resides in the staging directory until exfiltration.</p>
<h6>Exfiltrating data &ndash; transmission</h6>
<p>Prepared PNG images or PDF documents containing output files are transmitted as attachments in emails to an attacker-controlled inbox, as per the exfiltration configuration. The default LunarMail setup includes a specific recipient email, subject header, message body, and attachment filename. The email content, although in the language of the compromised European MFA, appears machine translated due to its unnatural phrasing.</p>
<p>An exfiltration configuration from a received command overrides the default one. We have not recovered any commands so don&rsquo;t know if different email recipients, subjects, bodies, or attachment name or types are used across multiple commands.</p>
<p>If supported, the email body uses HTML format. The PNG is embedded as an image in the body, unlike the PDF. Figure 6 shows an illustration of an exfiltration email based on the default configuration. The email was translated, redacted, and the logo was changed by ESET Research, to not reveal the compromised institution.</p>
<figure class="image"><img title="Figure 6. Illustration of an exfiltration email with data hidden in the image" src="https://web-assets.esetstatic.com/wls/2024/5-2024/lunar-toolset/figure-6-example-of-a-redacted-and-translated-exfiltration-email-with-data-hidden-in-image.jpeg" alt="Figure 6. Example of a redacted and translated exfiltration email with data hidden in image" width="" height="" />
<figcaption><em>Figure 6. Illustration of an exfiltration email with data hidden in the image</em></figcaption>
</figure>
<p>Exfiltration email messages are sent with the <a href="https://learn.microsoft.com/en-us/office/client-developer/outlook/mapi/processing-a-sent-message" target="_blank" rel="noopener">PR_DELETE_AFTER_SUBMIT</a> flag. In addition, any sent messages to the exfiltration address are deleted.</p>
<h2>Conclusion</h2>
<p>We have described two previously unknown backdoors used in compromises of a European government&rsquo;s institutions, which we attribute with medium confidence to the Russia-aligned APT group Turla.</p>
<p>The backdoors share a loader, bear code overlaps, and support similar commands, but they adopt different C&amp;C communication methods. The first backdoor &ndash; LunarWeb &ndash; uses HTTP(S) and attempts to blend in by mimicking the traffic of legitimate services such as Windows Update. The second backdoor &ndash; LunarMail &ndash; piggybacks on Outlook and communicates via email messages, using either PNG images or PDF documents to exfiltrate data.</p>
<p>We observed varying degrees of sophistication in the compromises; for example, the careful installation on the compromised server to avoid scanning by security software contrasted with coding errors and different coding styles (which are not the scope of this blogpost) in the backdoors. This suggests multiple individuals were likely involved in the development and operation of these tools.</p>
<p>Although the described compromises are more recent, our findings show that these backdoors evaded detection for a more extended period and have been in use since at least 2020, based on artifacts found in the Lunar toolset.</p>
<h2 id="IoCs">IoCs</h2>
<p>A comprehensive list of IoCs and samples can be found in our <a href="https://github.com/eset/malware-ioc/tree/master/turla#to-the-moon-and-backdoors-lunar-landing-in-diplomatic-missionsindicators-of-compromise" target="_blank" rel="noopener">GitHub repository</a>.</p>
<h3>Files</h3>
<p><table style="width: 99.3337%;">
<thead>
<tr>
<td style="width: 25%;">
<p><strong>SHA-1</strong></p>
</td>
<td style="width: 13%;">
<p><strong>Filename</strong></p>
</td>
<td style="width: 15%;">
<p><strong>Detection</strong></p>
</td>
<td style="width: 46.6215%;">
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">DE83C2C3FE68CB1BF961<br />73E9EE3EA6161DCFB24A</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">App_Web_0bm4blbr.dll</span></p>
</td>
<td style="width: 15%;">
<p>MSIL/Agent.ERT</p>
</td>
<td style="width: 46.6215%;">
<p>Compiled version of ASP.NET web page that installs LunarWeb.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">9CEC3972FA35C88DE87B<br />D66950E18B3E0A6DF77C</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">N/A</span></p>
</td>
<td style="width: 15%;">
<p>VBA/TrojanDownloader.<br />Agent.ZJC</p>
</td>
<td style="width: 46.6215%;">
<p>Malicious Word macro that installs LunarMail.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">2ED792E39F7D56DE52BD<br />F4AED96AFC898478BFDF</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">gpgol.dll</span></p>
</td>
<td style="width: 15%;">
<p>Win64/LunarLoader.B</p>
</td>
<td style="width: 46.6215%;">
<p>LunarLoader (x64) used to load LunarMail.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">F09E36553E48EBD42E60<br />D9B25A390C0F57FF8DE0</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">gpgol.dll</span></p>
</td>
<td style="width: 15%;">
<p>Win32/LunarLoader.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarLoader (x86) used to load LunarMail.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">94A4CE9C75BC847E7BE5<br />9B96C4133D677D909414</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">tapiperf.dll</span></p>
</td>
<td style="width: 15%;">
<p>Win64/LunarLoader.C</p>
</td>
<td style="width: 46.6215%;">
<p>LunarLoader (x64) used to load LunarWeb.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">00006B30806F91591134<br />9D82BEEB1AEB9025ADB4</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">admpwd.dll</span></p>
</td>
<td style="width: 15%;">
<p>Win64/LunarLoader.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarLoader (x64); a trojanized AdmPwd, used to load LunarWeb.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">19D86CF2ED82EAE23E01<br />9706FAE8DAFC60552E85</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">AdmPwd.dll</span></p>
</td>
<td style="width: 15%;">
<p>Win64/LunarLoader.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarLoader (x64); a trojanized AdmPwd, used to load LunarWeb.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">795C4127D42FE8DFAF45<br />10B406B52BA5BEDE8D3A</span></p>
</td>
<td style="width: 13%;">
<p><span style="font-family: courier new, courier, monospace;">winnet.dll.mui</span></p>
</td>
<td style="width: 15%;">
<p>Win64/LunarLoader.B</p>
</td>
<td style="width: 46.6215%;">
<p>LunarLoader (x64) used to load LunarWeb.</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">754FB657156643FD09A6<br />8EC9FC124528578CAB0C</span></p>
</td>
<td style="width: 13%;">
<p>N/A</p>
</td>
<td style="width: 15%;">
<p>Win32/LunarWeb.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarWeb backdoor (x86).</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">FCAE66F6D95C78DC8296<br />88CC0F4C39BB5A57828B</span></p>
</td>
<td style="width: 13%;">
<p>N/A</p>
</td>
<td style="width: 15%;">
<p>Win64/LunarMail.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarMail backdoor (x64).</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">67C6AEC8D129E610378E<br />F52F8BF934886587932F</span></p>
</td>
<td style="width: 13%;">
<p>N/A</p>
</td>
<td style="width: 15%;">
<p>Win32/LunarMail.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarMail backdoor (x86).</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">4C84110F1B10DF5FDD61<br />2759E210E44B0F0505EF</span></p>
</td>
<td style="width: 13%;">
<p>N/A</p>
</td>
<td style="width: 15%;">
<p>Win64/LunarWeb.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarWeb backdoor (x64).</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">5D3975E57BDCB630A00F<br />EBE5D405EEFB6D119D86</span></p>
</td>
<td style="width: 13%;">
<p>N/A</p>
</td>
<td style="width: 15%;">
<p>Win64/LunarWeb.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarWeb backdoor (x64).</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">5EF771AFC96C24371D36<br />7448627609CFACB34A57</span></p>
</td>
<td style="width: 13%;">
<p>N/A</p>
</td>
<td style="width: 15%;">
<p>Win64/LunarWeb.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarWeb backdoor (x64).</p>
</td>
</tr>
<tr>
<td style="width: 25%;">
<p><span style="font-family: courier new, courier, monospace;">512E4FA7D6119270FF44<br />A3B2A2359EE8825392EF</span></p>
</td>
<td style="width: 13%;">
<p>N/A</p>
</td>
<td style="width: 15%;">
<p>Win64/LunarWeb.A</p>
</td>
<td style="width: 46.6215%;">
<p>LunarWeb backdoor (x64).</p>
</td>
</tr>
</tbody>
</table></p>
<h3>File paths</h3>
<h4>Stage 2 blob</h4>
<p><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\DynamicAuth.bin</span></p>
<p><span style="font-family: courier new, courier, monospace;">C:\Program Files\LAPS\CSE\admpwd.cache</span></p>
<p><span style="font-family: courier new, courier, monospace;">C:\ProgramData\Microsoft\WinThumb\adcache.clb</span></p>
<p><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\perfcache.dat</span></p>
<p><span style="font-family: courier new, courier, monospace;">%USERPROFILE%\Gpg4win\tempkeys.dat</span></p>
<h4>LunarWeb state file</h4>
<p><span style="font-family: courier new, courier, monospace;">C:\ProgramData\Microsoft\Windows\Templates\content.tpl</span></p>
<p><span style="font-family: courier new, courier, monospace;">C:\ProgramData\Microsoft\WinThumb\thumb.clb</span></p>
<p><span style="font-family: courier new, courier, monospace;">C:\ProgramData\Microsoft\WinThumb\cfcache.clb</span></p>
<p><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\perfconfm.dat</span></p>
<h4>LunarMail state file</h4>
<p><span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Microsoft\Outlook\outlk.share</span></p>
<h3>Network</h3>
<p><table border="1" width="642" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td width="151">
<p><strong>IP</strong></p>
</td>
<td width="113">
<p><strong>Domain</strong></p>
</td>
<td width="123">
<p><strong>Hosting provider</strong></p>
</td>
<td width="85">
<p><strong>First&nbsp;seen</strong></p>
</td>
<td width="170">
<p><strong>Details</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td width="151">
<p>N/A</p>
</td>
<td width="113">
<p><span style="font-family: courier new, courier, monospace;">thedarktower.av.<br />master.dns-cloud[.]net</span></p>
</td>
<td width="123">
<p>N/A</p>
</td>
<td width="85">
<p>2020‚Äë02‚Äë01</p>
</td>
<td width="170">
<p>Domain (Free DNS) pinged by malicious Word macro.</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">45.33.24[.]145</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Akamai Connected Cloud</p>
</td>
<td width="85">
<p>2020‚Äë05‚Äë20</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">45.79.93[.]87</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Akamai Connected Cloud</p>
</td>
<td width="85">
<p>2020‚Äë05‚Äë20</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">65.109.179[.]67</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Hetzner Online GmbH</p>
</td>
<td width="85">
<p>2023‚Äë10‚Äë29</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">74.50.80[.]35</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Host Department NJ, LLC</p>
</td>
<td width="85">
<p>2023‚Äë10‚Äë29</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb.</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">82.165.158[.]86</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>IONOS SE</p>
</td>
<td width="85">
<p>2022‚Äë08‚Äë03</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">82.223.55[.]220</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>IONOS SE</p>
</td>
<td width="85">
<p>2022‚Äë08‚Äë03</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">139.162.23[.]113</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Akamai Connected Cloud</p>
</td>
<td width="85">
<p>2023‚Äë06‚Äë15</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">158.220.102[.]80</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Contabo GmbH</p>
</td>
<td width="85">
<p>2023‚Äë10‚Äë29</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb.</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">161.97.74[.]237</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Contabo GmbH</p>
</td>
<td width="85">
<p>2023‚Äë06‚Äë15</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb.</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">176.57.150[.]252</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Contabo GmbH</p>
</td>
<td width="85">
<p>2023‚Äë06‚Äë15</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb.</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">212.57.35[.]174</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Webglobe, a.s.</p>
</td>
<td width="85">
<p>2023‚Äë06‚Äë02</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
<tr>
<td width="151">
<p><span style="font-family: courier new, courier, monospace;">212.57.35[.]176</span></p>
</td>
<td width="113">
<p>N/A</p>
</td>
<td width="123">
<p>Webglobe, a.s.</p>
</td>
<td width="85">
<p>2023‚Äë06‚Äë02</p>
</td>
<td width="170">
<p>C&amp;C server of LunarWeb (compromised VPS).</p>
</td>
</tr>
</tbody>
</table></p>
<h3>Registry keys</h3>
<p><span style="font-family: courier new, courier, monospace;">HKCU\SOFTWARE\Classes\CLSID\{3115036B-547E-4673-8479-EE54CD001B9D}\</span></p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener">version 15</a> of the MITRE ATT&amp;CK framework<strong>.</strong></p>
<p><table border="1" width="642" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td width="113">
<p><strong>Tactic</strong></p>
</td>
<td width="113">
<p><strong>ID</strong></p>
</td>
<td width="151">
<p><strong>Name</strong></p>
</td>
<td width="265">
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td width="113">
<p><strong>Reconnaissance</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1591">T1591</a></p>
</td>
<td width="151">
<p>Gather Victim Org Information</p>
</td>
<td width="265">
<p>LunarMail&rsquo;s communication method indicates prior knowledge about compromised institutions.</p>
</td>
</tr>
<tr>
<td rowspan="5" width="113">
<p><strong>Resource Development</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1583/002">T1583.002</a></p>
</td>
<td width="151">
<p>Acquire Infrastructure: DNS Server</p>
</td>
<td width="265">
<p>Stage 0 macro pings a domain from free DNS hosting provided by ClouDNS.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1583/003">T1583.003</a></p>
</td>
<td width="151">
<p>Acquire Infrastructure: Virtual Private Server</p>
</td>
<td width="265">
<p>Turla has used VPS hosting providers for C&amp;C servers.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1584/003">T1584.003</a></p>
</td>
<td width="151">
<p>Compromise Infrastructure: Virtual Private Server</p>
</td>
<td width="265">
<p>Turla has used compromised VPSes for C&amp;C purposes.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1586/002">T1586.002</a></p>
</td>
<td width="151">
<p>Compromise Accounts: Email Accounts</p>
</td>
<td width="265">
<p>Turla has used likely compromised email accounts for communication with the LunarMail backdoor.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1587/001">T1587.001</a></p>
</td>
<td width="151">
<p>Develop Capabilities: Malware</p>
</td>
<td width="265">
<p>Turla has developed custom malware, including loaders and backdoors.</p>
</td>
</tr>
<tr>
<td rowspan="7" width="113">
<p><strong>Execution</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1047">T1047</a></p>
</td>
<td width="151">
<p>Windows Management Instrumentation</p>
</td>
<td width="265">
<p>LunarWeb obtains system information by using WMI queries.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1059">T1059</a></p>
</td>
<td width="151">
<p>Command and Scripting Interpreter</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail can execute Lua scripts.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1059/001">T1059.001</a></p>
</td>
<td width="151">
<p>Command and Scripting Interpreter: PowerShell</p>
</td>
<td width="265">
<p>LunarWeb can execute PowerShell commands.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1059/003">T1059.003</a></p>
</td>
<td width="151">
<p>Command and Scripting Interpreter: Windows Command Shell</p>
</td>
<td width="265">
<p>LunarWeb can execute shell commands via <span style="font-family: courier new, courier, monospace;">cmd.exe</span>.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1059/005">T1059.005</a></p>
</td>
<td width="151">
<p>Command and Scripting Interpreter: Visual Basic</p>
</td>
<td width="265">
<p>Stage 0 Word document contains a VBA macro.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1106">T1106</a></p>
</td>
<td width="151">
<p>Native API</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail use various Windows APIs.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1204/002">T1204.002</a></p>
</td>
<td width="151">
<p>User Execution: Malicious File</p>
</td>
<td width="265">
<p>Stage 0 Word document with malicious macro must be opened by victim.</p>
</td>
</tr>
<tr>
<td rowspan="3" width="113">
<p><strong>Persistence</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1137/006">T1137.006</a></p>
</td>
<td width="151">
<p>Office Application Startup: Add-ins</p>
</td>
<td width="265">
<p>LunarMail loader is persisted as an Outlook add-in.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1547">T1547</a></p>
</td>
<td width="151">
<p>Boot or Logon Autostart Execution</p>
</td>
<td width="265">
<p>A LunarWeb loader is persisted as a Group Policy extension.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1574">T1574</a></p>
</td>
<td width="151">
<p>Hijack Execution Flow</p>
</td>
<td width="265">
<p>A LunarWeb loader is persisted by replacing the system DLL <span style="font-family: courier new, courier, monospace;">tapiperf.dll</span>.</p>
</td>
</tr>
<tr>
<td rowspan="10" width="113">
<p><strong>Defense Evasion</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1027">T1027</a></p>
</td>
<td width="151">
<p>Obfuscated Files or Information</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail are AES-256 encrypted on disk.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1027/003">T1027.003</a></p>
</td>
<td width="151">
<p>Obfuscated Files or Information: Steganography</p>
</td>
<td width="265">
<p>LunarMail stages exfiltration data into a PNG image or PDF document.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1027/007">T1027.007</a></p>
</td>
<td width="151">
<p>Obfuscated Files or Information: Dynamic API Resolution</p>
</td>
<td width="265">
<p>LunarMail dynamically resolves MAPI functions.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1027/009">T1027.009</a></p>
</td>
<td width="151">
<p>Obfuscated Files or Information: Embedded Payloads</p>
</td>
<td width="265">
<p>LunarMail installer has payloads embedded in a DOCX format document.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1036/005">T1036.005</a></p>
</td>
<td width="151">
<p>Masquerading: Match Legitimate Name or Location</p>
</td>
<td width="265">
<p>Filenames used by LunarWeb and LunarMail loading chains mimic legitimate files.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1070/004">T1070.004</a></p>
</td>
<td width="151">
<p>Indicator Removal: File Deletion</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail can uninstall themselves by deleting their loading chain.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1070/008">T1070.008</a></p>
</td>
<td width="151">
<p>Indicator Removal: Clear Mailbox Data</p>
</td>
<td width="265">
<p>LunarMail deletes email messages used for C&amp;C communications.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1140">T1140</a></p>
</td>
<td width="151">
<p>Deobfuscate/Decode Files or Information</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail decrypt their strings using RC4.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1480/001">T1480.001</a></p>
</td>
<td width="151">
<p>Execution Guardrails: Environmental Keying</p>
</td>
<td width="265">
<p>LunarLoader decrypts its payload using a key derived from the DNS domain name.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1620">T1620</a></p>
</td>
<td width="151">
<p>Reflective Code Loading</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail are executed using a reflective loader.</p>
</td>
</tr>
<tr>
<td rowspan="5" width="113">
<p><strong>Discovery</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1007">T1007</a></p>
</td>
<td width="151">
<p>System Service Discovery</p>
</td>
<td width="265">
<p>LunarWeb retrieves a list of services.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1016">T1016</a></p>
</td>
<td width="151">
<p>System Network Configuration Discovery</p>
</td>
<td width="265">
<p>LunarWeb retrieves network adapter information.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1057">T1057</a></p>
</td>
<td width="151">
<p>Process Discovery</p>
</td>
<td width="265">
<p>LunarWeb retrieves a list of running processes.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1082">T1082</a></p>
</td>
<td width="151">
<p>System Information Discovery</p>
</td>
<td width="265">
<p>LunarWeb retrieves system information such as OS version, BIOS version, domain name, and environment variables.</p>
<p>LunarMail retrieves environment variables.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1518/001">T1518.001</a></p>
</td>
<td width="151">
<p>Software Discovery: Security Software Discovery</p>
</td>
<td width="265">
<p>LunarWeb discovers installed security solutions via the WMI query <span style="font-family: courier new, courier, monospace;">wmic /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get *</span>.</p>
</td>
</tr>
<tr>
<td rowspan="5" width="113">
<p><strong>Collection</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1005">T1005</a></p>
</td>
<td width="151">
<p>Data from Local System</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail can upload files from the compromised machine.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1074/001">T1074.001</a></p>
</td>
<td width="151">
<p>Data Staged: Local Data Staging</p>
</td>
<td width="265">
<p>LunarMail stages data in a directory in <span style="font-family: courier new, courier, monospace;">%TEMP%</span>.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1113">T1113</a></p>
</td>
<td width="151">
<p>Screen Capture</p>
</td>
<td width="265">
<p>LunarMail can capture screenshots.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1114/001">T1114.001</a></p>
</td>
<td width="151">
<p>Email Collection: Local Email Collection</p>
</td>
<td width="265">
<p>LunarMail collects recipients of sent email messages and can collect email addresses of Outlook profiles.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1560/002">T1560.002</a></p>
</td>
<td width="151">
<p>Archive Collected Data: Archive via Library</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail use a statically linked zlib library for compression of collected data.</p>
</td>
</tr>
<tr>
<td rowspan="9" width="113">
<p><strong>Command and Control</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1001/002">T1001.002</a></p>
</td>
<td width="151">
<p>Data Obfuscation: Steganography</p>
</td>
<td width="265">
<p>LunarWeb can receive commands hidden in JPG or GIF images.</p>
<p>LunarMail receives commands hidden in PNG images and exfiltrates data hidden in PNG images or PDF documents.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1001/003">T1001.003</a></p>
</td>
<td width="151">
<p>Data Obfuscation: Protocol Impersonation</p>
</td>
<td width="265">
<p>LunarWeb impersonates legitimate domains in C&amp;C communications by using a fake <span style="font-family: courier new, courier, monospace;">Host header</span> and known URIs.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1071/001">T1071.001</a></p>
</td>
<td width="151">
<p>Application Layer Protocol: Web Protocols</p>
</td>
<td width="265">
<p>LunarWeb uses HTTP for C&amp;C communications.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1071/003">T1071.003</a></p>
</td>
<td width="151">
<p>Application Layer Protocol: Mail Protocols</p>
</td>
<td width="265">
<p>LunarMail uses email messages for C&amp;C communications.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1090/001">T1090.001</a></p>
</td>
<td width="151">
<p>Proxy: Internal Proxy</p>
</td>
<td width="265">
<p>LunarWeb can use an HTTP proxy for C&amp;C communications.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1095">T1095</a></p>
</td>
<td width="151">
<p>Non-Application Layer Protocol</p>
</td>
<td width="265">
<p>Stage 0 macro pings the C&amp;C server, utilizing ICMP protocol.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1132/001">T1132.001</a></p>
</td>
<td width="151">
<p>Data Encoding: Standard Encoding</p>
</td>
<td width="265">
<p>LunarWeb may receive base64-encoded data from the C&amp;C server.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1573/001">T1573.001</a></p>
</td>
<td width="151">
<p>Encrypted Channel: Symmetric Cryptography</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail encrypt C&amp;C communications using AES-256.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1573/002">T1573.002</a></p>
</td>
<td width="151">
<p>Encrypted Channel: Asymmetric Cryptography</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail encrypt the AES key used in C&amp;C communications using RSA-4096.</p>
</td>
</tr>
<tr>
<td rowspan="3" width="113">
<p><strong>Exfiltration</strong></p>
</td>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1020">T1020</a></p>
</td>
<td width="151">
<p>Automated Exfiltration</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail automatically exfiltrate collected data to the C&amp;C server.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1030">T1030</a></p>
</td>
<td width="151">
<p>Data Transfer Size Limits</p>
</td>
<td width="265">
<p>LunarWeb splits exfiltrated data above 1.33&nbsp;MB into multiple smaller chunks.</p>
<p>LunarMail limits the size of email attachments containing exfiltrated data.</p>
</td>
</tr>
<tr>
<td width="113">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1041">T1041</a></p>
</td>
<td width="151">
<p>Exfiltration Over C2 Channel</p>
</td>
<td width="265">
<p>LunarWeb and LunarMail exfiltrate data over the C&amp;C channel.</p>
</td>
</tr>
</tbody>
</table></p>
<p><a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=moon-backdoors-lunar-landing-diplomatic-missions&amp;sfdccampaignid=7011n0000017htTAAQ" target="_blank" rel="noopener"><img src="https://web-assets.esetstatic.com/wls/2023/2023-12/welivesecurity-eset-threat-intelligence.jpeg" alt="" width="915" height="296" /></a></p>
</div>                
                <div class="article-subscribe-form mb-4">
                    <hr />
                    <div class="form-wrapper">
  <div class="overlay">
    <h2 class="title">
      Let us keep you <br class='d-md-none'>up to date
    </h2>
    <p class="subtitle">
      Sign up for our newsletters
    </p>
    <div class="form">
        <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter px-0" target="_blank" method="post" role="search">
            <div class="search-input clearfix">
                <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Your Email Address" required>
                    <input type="checkbox" id="TOPIC" name="TOPIC" value="We Live Security Ukraine Newsletter">
                    <label for="TOPIC">Ukraine Crisis newsletter</label>
                    <input type="checkbox" id="NEWSLETTER" name="NEWSLETTER" value="We Live Security">
                    <label for="NEWSLETTER">Regular weekly newsletter</label>
                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="0">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                <button type="submit" class="redirect-button primary">Subscribe</button>
            </div>
        </form>
    </div>
  </div>
  <svg class="wave-overlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 201.7451"><g><path class="cls-1" d="m600,0v176.576c0,13.8934-11.2757,25.1691-25.1691,25.1691H25.1691c-13.9034,0-25.1691-11.2757-25.1691-25.1691v-110.6331c36.0722,38.8207,82.2223,71.8325,145.2255,88.6052.0402,0,.0805.0101.1107.0301,0,0,.0906,0,.1107.0302,108.7605,28.9444,198.3321-8.95,271.9366-49.865l29.5585-16.9537L600,0Z" /></g></svg></div>                </div>

                                    <div class="d-block">
                        <div class="post-related-articles">
        <h4 class="articles-title-divider py-4 my-2">
            Related Articles
        </h4>
            <div class="articles-card-grid row g-0 pb-2 pb-md-3"><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/podcasts/eset-research-podcast-cosmicbeetle/" title="ESET Research Podcast: CosmicBeetle"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">ESET Research Podcast: CosmicBeetle</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2024/10-2024/eset-research-podcast-cosmicbeetle.png" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2024/10-2024/eset-research-podcast-cosmicbeetle.png" alt="ESET Research Podcast: CosmicBeetle" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">ESET Research Podcast: CosmicBeetle</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/embargo-ransomware-rocknrust/" title="Embargo ransomware: Rock‚Äôn‚ÄôRust"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Embargo ransomware: Rock‚Äôn‚ÄôRust</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2024/10-2024/embargo-ransomware-rust.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2024/10-2024/embargo-ransomware-rust.jpeg" alt="Embargo ransomware: Rock‚Äôn‚ÄôRust" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Embargo ransomware: Rock‚Äôn‚ÄôRust</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/telekopye-hits-new-hunting-ground-hotel-booking-scams/" title="Telekopye transitions to targeting tourists via hotel booking scam"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Telekopye transitions to targeting tourists via hotel booking scam</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2024/10-2024/telekopye/telekopye-booking-sites-fraud.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2024/10-2024/telekopye/telekopye-booking-sites-fraud.jpeg" alt="Telekopye transitions to targeting tourists via hotel booking scam" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Telekopye transitions to targeting tourists via hotel booking scam</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div></div></div>                    </div>
                            </div>
            <div class="sidebar col col-lg-4 ps-5 d-none d-lg-block position-sticky">
                <div class="sticky-top sticky-top--container">

                                        <div class="short-articles-section">
    <h3 class="articles-title-divider short-aticles-title pb-4">
        Similar Articles
    </h3>
    <div class="articles">
            <div class="article-list-card"><a href="/2019/05/07/turla-lightneuron-email-too-far/" title="Turla LightNeuron: An email too far"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">Turla LightNeuron: An email too far</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2019/05/shutterstock_1254740023-1920-resized.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2019/05/shutterstock_1254740023-1920-resized.jpg" alt="Turla LightNeuron: An email too far"  /></picture></div></div></div></div></a></div>            <hr>
            <div class="article-list-card"><a href="/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/" title="Tracking Turla: New backdoor delivered via Armenian watering holes"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">Tracking Turla: New backdoor delivered via Armenian watering holes</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2020/03/turla-armenian-websites-watering-holes.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2020/03/turla-armenian-websites-watering-holes.jpg" alt="Tracking Turla: New backdoor delivered via Armenian watering holes"  /></picture></div></div></div></div></a></div>            <hr>
            <div class="article-list-card"><a href="/2019/05/29/turla-powershell-usage/" title="A dive into Turla PowerShell usage"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">A dive into Turla PowerShell usage</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2019/05/shutterstock_154547867-1.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2019/05/shutterstock_154547867-1.jpg" alt="A dive into Turla PowerShell usage"  /></picture></div></div></div></div></a></div>            <hr>
            <div class="article-list-card"><a href="/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/" title="Turla‚Äôs watering hole campaign: An updated Firefox extension abusing Instagram"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">Turla‚Äôs watering hole campaign: An updated Firefox extension abusing Instagram</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2022/01/dazzlespy-macos-malware.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2022/01/dazzlespy-macos-malware.jpg" alt="Turla‚Äôs watering hole campaign: An updated Firefox extension abusing Instagram"  /></picture></div></div></div></div></a></div>            <hr>
            <div class="article-list-card"><a href="/2020/12/02/turla-crutch-keeping-back-door-open/" title="Turla Crutch: Keeping the ‚Äúback door‚Äù open"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">Turla Crutch: Keeping the ‚Äúback door‚Äù open</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2020/12/turla-crutch-apt-backdoor.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2020/12/turla-crutch-apt-backdoor.jpg" alt="Turla Crutch: Keeping the ‚Äúback door‚Äù open"  /></picture></div></div></div></div></a></div>            <hr>
    </div>
</div>
                                        <div class="pb-4">
                        <div class="share-article-card">
                            <div class="sidebar-card-media">
    <div class="mb-3">
        <h3 class="articles-title-divider">Share Article</h3>    </div>
    <div class="medias">
        <a href="https://www.facebook.com/sharer/sharer.php?u&#x3D;https://www.welivesecurity.com/en/eset-research/moon-backdoors-lunar-landing-diplomatic-missions/" title="Facebook" >
            <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://www.linkedin.com/shareArticle?mini&#x3D;true&amp;url&#x3D;https://www.welivesecurity.com/en/eset-research/moon-backdoors-lunar-landing-diplomatic-missions/" title="LinkedIn" >
            <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://twitter.com/intent/tweet?url&#x3D;https://www.welivesecurity.com/en/eset-research/moon-backdoors-lunar-landing-diplomatic-missions/" title="Twitter" >
            <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="twitter"><g id="Layer_2-3"><g id="Research_icons"><path id="twitter-2" fill="white"d="m36.0847,16.9564c1.1786-.1395,2.3298-.4543,3.4153-.934-.7998,1.1935-1.8049,2.2357-2.9686,3.0783v.7675c0,7.8581-5.9779,16.9184-16.9184,16.9184-3.2314.004-6.3954-.9238-9.113-2.6722.4703.0571.9436.0856,1.4173.0853,2.6784.0044,5.2803-.8925,7.3871-2.5463-2.5446-.0467-4.7777-1.7068-5.5555-4.1301.3681.0703.742.1056,1.1168.1056.5293,0,1.0564-.0696,1.5676-.2071-2.775-.5608-4.7696-3.0006-4.7677-5.8317v-.0731c.826.4573,1.7488.712,2.6925.7432-2.6116-1.7476-3.4122-5.2258-1.8275-7.9394,3.0149,3.7157,7.4653,5.9771,12.2441,6.2215-.7617-3.1963,1.2119-6.4049,4.4082-7.1666,2.0894-.4979,4.285.1691,5.7444,1.7451,1.3319-.2639,2.6091-.7528,3.7768-1.4457-.4477,1.3745-1.3782,2.5402-2.6194,3.2813Z" /></g></g></g></g></svg>        </a>
        <a href="mailto:?&amp;subject&#x3D;I wanted you to see this site&amp;body&#x3D;https://www.welivesecurity.com/en/eset-research/moon-backdoors-lunar-landing-diplomatic-missions/" title="mail" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path id="Path_7761" fill="white"d="m13.1593,14.9378c-.2808,0-.5616.0936-.8424.1872l11.8875,11.5131c.3744.468,1.0296.468,1.404.0936.0936,0,.0936-.0936.0936-.0936l12.0747-11.5131c-.2808-.0936-.5616-.1872-.7488-.1872H13.1593Zm-2.1529,1.9656v15.8188c-.0936,1.2168.8424,2.2465,2.0593,2.3401h23.8686c1.2168-.0936,2.1529-1.1232,2.0593-2.3401v-15.7252l-11.7939,11.3259c-1.2168,1.2168-3.1825,1.2168-4.3057,0l-11.8875-11.4195Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/en/eset-research/moon-backdoors-lunar-landing-diplomatic-missions/" title="copy" class="copy-link" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m32.2813,27.4375l3.7-3.7c2.7-2.7,2.7-7,0-9.7-2.7-2.7-7-2.7-9.7,0h0l-5.3,5.3c-2.7,2.7-2.7,7,0,9.7.4.4.8.7,1.3,1l2.8-2.8c-.6-.1-1.1-.4-1.5-.8-1.2-1.2-1.2-3.2,0-4.4l5.3-5.3c1.3-1.2,3.2-1.1,4.4.1,1.1,1.2,1.1,3.1,0,4.3l-1.6,1.6c.7,1.4.9,3.1.6,4.7h0Zm-14.7-4.7l-3.6,3.6c-2.7,2.7-2.6,7,0,9.7,2.7,2.6,6.9,2.6,9.6,0l5.3-5.3c2.7-2.7,2.7-7,0-9.7-.4-.4-.8-.7-1.3-1l-2.8,2.8c1.7.4,2.7,2.1,2.3,3.7-.1.6-.4,1.1-.8,1.5l-5.3,5.4c-1.2,1.3-3.1,1.3-4.4.1-1.3-1.2-1.3-3.1-.1-4.4,0-.1.1-.1.1-.1l1.6-1.5c-.7-1.6-.9-3.2-.6-4.8h0Z" /></g></svg>        </a>
    </div>
</div>                        </div>
                    </div>
                    <div class="pb-4">
                        <a class="d-block sidebar-card-banner" href="https://www.welivesecurity.com/en/eset-research/eset-apt-activity-report-q4-2023-q1-2024/" title="Apt Activity Report" target="_blank">
    <img src="https://www.welivesecurity.com/build/assets/apt-activity-report-4523d00f.webp" alt="Apt Activity Report" class="w-100" >
</a>                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                <div class="my-4">
                    <h3 class="articles-title-divider">Discussion</h3>
                </div>

                <div id="disqus_thread"></div>

            </div>
        </div>
    </div>
        </div>

        <!-- footer -->
        <footer class="page-footer">
  <div class="container">
    <div class="row g-0">
      <div class="col page-info-wrapper">
        <div class="logo-wrapper">
          <div class="logo">
            <a href="/en/" title="Welivesecurity">
              <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>            </a>
          </div>
        </div>
        <div class="page-info">
          <p>
            Award-winning news, views, and insight from the ESET security community
          </p>
        </div>
      </div>
      <div class="col footer-links">
        <a href="/en/company/about-us/" title="About us" 
         >About us</a>
        <a href="https://www.eset.com" title="ESET" 
         >ESET</a>
        <a href="/en/company/contact-us/" title="Contact us" 
         >Contact us</a>
        <a href="/en/company/privacy/" title="Privacy Policy" 
         >Privacy Policy</a>
        <a href="/en/company/legal-information/" title="Legal Information" 
         >Legal Information</a>
        <a href="/en/#" title="Manage Cookies" id="manage-cookies" 
         onclick="event.preventDefault()" >Manage Cookies</a>
        <a href="/en/rss/feed/" title="RSS Feed" 
         >RSS Feed</a>
      </div>
      <div class="col social-networks">
        <a href="https://www.facebook.com/eset/" title="Join our facebook fan site!">
          <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://youtube.com/esetglobal" title="Watch our videos at YouTube Channel.">
          <svg id="Layer_2" fill="#949ca1" class="youtube" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="youtube"><g id="SOCIAL_MEDIA"><path id="youtube-2" fill="white"d="m39.3741,17.7792c-.3492-1.2938-1.3598-2.3044-2.6536-2.6536-2.3399-.625-11.7206-.625-11.7206-.625,0,0-9.3745,0-11.7206.625-1.2941.3485-2.305,1.3594-2.6536,2.6536-.4319,2.3823-.6412,4.7997-.6249,7.2208-.0162,2.4211.193,4.8385.625,7.2208.3478,1.2946,1.359,2.3058,2.6536,2.6536,2.3399.625,11.7206.625,11.7206.625,0,0,9.3807,0,11.7206-.625,1.2942-.3485,2.3051-1.3594,2.6536-2.6536.4315-2.3824.6408-4.7997.625-7.2208.0158-2.4211-.1934-4.8384-.625-7.2208h0Zm-17.374,11.7205v-8.9994l7.7933,4.4997-7.7933,4.4997Z" /></g></g></g></g></svg>        </a>
        <a href="https://twitter.com/ESET" title="Visit the official WLS Twitter page.">
          <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="twitter"><g id="Layer_2-3"><g id="Research_icons"><path id="twitter-2" fill="white"d="m36.0847,16.9564c1.1786-.1395,2.3298-.4543,3.4153-.934-.7998,1.1935-1.8049,2.2357-2.9686,3.0783v.7675c0,7.8581-5.9779,16.9184-16.9184,16.9184-3.2314.004-6.3954-.9238-9.113-2.6722.4703.0571.9436.0856,1.4173.0853,2.6784.0044,5.2803-.8925,7.3871-2.5463-2.5446-.0467-4.7777-1.7068-5.5555-4.1301.3681.0703.742.1056,1.1168.1056.5293,0,1.0564-.0696,1.5676-.2071-2.775-.5608-4.7696-3.0006-4.7677-5.8317v-.0731c.826.4573,1.7488.712,2.6925.7432-2.6116-1.7476-3.4122-5.2258-1.8275-7.9394,3.0149,3.7157,7.4653,5.9771,12.2441,6.2215-.7617-3.1963,1.2119-6.4049,4.4082-7.1666,2.0894-.4979,4.285.1691,5.7444,1.7451,1.3319-.2639,2.6091-.7528,3.7768-1.4457-.4477,1.3745-1.3782,2.5402-2.6194,3.2813Z" /></g></g></g></g></svg>        </a>
        <a href="https://www.linkedin.com/company/eset" title="Follow us on LinkedIn.">
          <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/rss-configurator/" title="Don¬¥t miss a single post!">
          <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="rss"><g id="SOCIAL_MEDIA"><path id="rss-2" fill="white"d="m16.9299,36.9089c-1.8039-.0139-3.255-1.4876-3.2411-3.2915.0139-1.8039,1.4876-3.255,3.2915-3.2411,1.7931.0138,3.2398,1.4706,3.2412,3.2638-.006,1.8113-1.4791,3.2748-3.2904,3.2688-.0004,0-.0008,0-.0012,0Zm12.6168,0c-.0331-8.7521-7.1549-15.8203-15.907-15.7872h-.0014v4.6272c6.1869-.0232,11.2214,4.9731,11.2452,11.16h4.6632Zm8.0916,0c-.0503-13.2044-10.7953-23.8679-23.9997-23.8176-.0001,0-.0002,0-.0003,0v4.7628c10.5637-.0398,19.1597,8.4911,19.2,19.0548h4.8Z" /></g></g></g></svg>        </a>
      </div>
    </div>
    <div class="row g-0">
      <div class="col copyright">
        Copyright ¬© ESET, All Rights Reserved
      </div>
    </div>
  </div>
</footer>    </div>

    <!-- scripts -->
    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js"></script>    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/search-7d9f58b7.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/search-7d9f58b7.js"></script>        
<script>

    var disqus_config = function () {
        this.page.url = "https://www.welivesecurity.com/en/eset-research/moon-backdoors-lunar-landing-diplomatic-missions/";
        this.page.identifier = "To the Moon and back(doors): Lunar landing in diplomatic missions";
        this.page.title = "30424";
        this.language = "en";
    };
   
    (function() {
        var d = document, s = d.createElement('script');

        s.src = 'https://welivesecurity.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();

</script>

    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js"></script>    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-98874652.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/table-wrapper-135558d1.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-98874652.js"></script></body>
</html>
