<!DOCTYPE html><html
	class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light"
	lang="en-us"
	dir="ltr"
	data-authenticated="false"
	data-auth-status-determined="false"
	data-target="docs"
	x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Attack surface reduction rules reference - Microsoft Defender for Endpoint" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-reference" /><meta property="og:description" content="Lists details about Microsoft Defender for Endpoint attack surface reduction rules on a per-rule basis." /><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />

	<meta property="og:image:alt" content="Microsoft Learn" />

	<meta name="twitter:card" content="summary_large_image" />

	<meta name="twitter:site" content="@MicrosoftLearn" />

	<meta name="color-scheme" content="light dark"><meta name="audience" content="ITPro" />
<meta name="author" content="denisebmsft" />
<meta name="breadcrumb_path" content="/defender-endpoint/breadcrumb/toc.json" />
<meta name="depot_name" content="Learn.defender-endpoint" />
<meta name="description" content="Lists details about Microsoft Defender for Endpoint attack surface reduction rules on a per-rule basis." />
<meta name="document_id" content="340a0f8c-90ef-f5e9-a860-48c1651c86bf" />
<meta name="document_version_independent_id" content="340a0f8c-90ef-f5e9-a860-48c1651c86bf" />
<meta name="feedback_help_link_type" content="" />
<meta name="feedback_help_link_url" content="" />
<meta name="feedback_product_url" content="https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance" />
<meta name="feedback_system" content="Standard" />
<meta name="git_commit_id" content="bb9134f773383f1ec31edf52904a6a996d40f169" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/defender-docs-pr/blob/bb9134f773383f1ec31edf52904a6a996d40f169/defender-endpoint/attack-surface-reduction-rules-reference.md" />
<meta name="locale" content="en-us" />
<meta name="manager" content="deniseb" />
<meta name="ms.author" content="deniseb" />
<meta name="ms.collection" content="m365-security" />
<meta name="ms.collection" content="tier2" />
<meta name="ms.collection" content="mde-asr" />
<meta name="ms.custom" content="asr" />
<meta name="ms.date" content="10/07/2024" />
<meta name="ms.localizationpriority" content="medium" />
<meta name="ms.reviewer" content="sugamar, yongrhee" />
<meta name="ms.service" content="defender-endpoint" />
<meta name="ms.subservice" content="asr" />
<meta name="ms.topic" content="reference" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-endpoint/attack-surface-reduction-rules-reference.md" />
<meta name="page_type" content="conceptual" />
<meta name="permissioned-type" content="public" />
<meta name="schema" content="Conceptual" />
<meta name="search.appverid" content="met150" />
<meta name="site_name" content="Docs" />
<meta name="toc_rel" content="toc.json" />
<meta name="uhfHeaderId" content="MSDocsHeader-MicrosoftDefender" />
<meta name="updated_at" content="2024-10-07 05:43 PM" />
<meta name="word_count" content="4848" />
<meta name="persistent_id" content="7453c068-8bed-0e9b-ebd7-8984f96a4144" />
	
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/bba62c59-6b53-4be4-8b9d-6624f9184c22" data-source="generated" />
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/e1d61e2b-ff2d-4d2c-8dae-6cda8a241aba" data-source="generated" />
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/bcbcbad5-4208-4783-8035-8481272c98b8" data-source="generated" />
	
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/f3a81ffb-ee36-4ec7-b54a-01b6681aff65" data-source="generated" />
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/17d3b3f6-a66e-4c69-9774-14a73c38e669" data-source="generated" />
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/43b2e5aa-8a6d-4de2-a252-692232e5edc8" data-source="generated" />
	<meta name="scope" content="Microsoft Defender Endpoint" /><meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-endpoint/attack-surface-reduction-rules-reference.md" /><link href="https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-reference" rel="canonical"><title>Attack surface reduction rules reference - Microsoft Defender for Endpoint | Microsoft Learn</title><link rel="stylesheet" href="/static/assets/0.4.028516059/styles/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: true,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: true,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'Standard',
			feedbackGitHubRepo: '',
			feedbackProductUrl: 'https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance',extendBreadcrumb: false,isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,contributors: [{ name: "denisebmsft", url: "https://github.com/denisebmsft" },{ name: "YongRhee-MSFT", url: "https://github.com/YongRhee-MSFT" },{ name: "v-mathavale", url: "https://github.com/v-mathavale" },{ name: "chrisda", url: "https://github.com/chrisda" },{ name: "siosulli", url: "https://github.com/siosulli" },{ name: "v-suhoward", url: "https://github.com/v-suhoward" }],},
		functions:{}
	};
	</script><script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script><script src="/static/assets/0.4.028516059/global/deprecation.js"></script><script src="/static/assets/0.4.028516059/scripts/en-us/index-docs.js"></script></head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a><div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">Download Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">More info about Internet Explorer and Microsoft Edge</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
			<div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button>
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none">

										</div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs><div id="article-header-page-actions"  class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
											id="lang-link-tablet"
											class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
											title="Read in English" data-bi-name="language-toggle"
											data-read-in-link
											hidden>
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon>
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text>Read in English</span>
										</a><button
												type="button"
												class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet"
												data-list-type="collection"
												data-bi-name="collection"
												title="Add to collection">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Save</span>
											</button><a	data-contenteditbtn
												class="button button-clear button-sm text-decoration-none button-primary display-none display-inline-flex-tablet"
												aria-label="Edit"
												title="Edit This Document"
												data-bi-name="edit"
														href="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-endpoint/attack-surface-reduction-rules-reference.md"
														data-original_content_git_url="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-endpoint/attack-surface-reduction-rules-reference.md"
														data-original_content_git_url_template="{repo}/blob/{branch}/defender-endpoint/attack-surface-reduction-rules-reference.md"
														data-pr_repo=""
														data-pr_branch="">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-edit-outline"></span>
												</span>
											</a>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button
														data-page-action-item="overflow-mobile"
														type="button"
														class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
														data-bi-name="contents-expand"
														data-contents-button
														data-popover-close>
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span></button><a
													id="lang-link-overflow"
													class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
													title="Read in English" data-bi-name="language-toggle"
													data-page-action-item="overflow-mobile"
													data-check-hidden="true"
													data-read-in-link
													hidden
													>
													<span class="icon" aria-hidden="true" data-read-in-link-icon>
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text>Read in English</span>
												</a><button
														type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="collection"
														data-bi-name="collection"
														title="Save"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Save</span>
													</button>

			 										
													<button
													 	type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="plan"
														data-bi-name="plan"
														title="Add to Plan"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close
														hidden>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">Add to Plan</span>
													</button><a	data-contenteditbtn
														class="button button-clear button-block button-sm has-inner-focus justify-content-flex-start text-decoration-none display-none-tablet"
														aria-label="Edit"
														title="Edit This Document"
														data-bi-name="edit"
																href="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-endpoint/attack-surface-reduction-rules-reference.md"
																data-original_content_git_url="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-endpoint/attack-surface-reduction-rules-reference.md"
																data-original_content_git_url_template="{repo}/blob/{branch}/defender-endpoint/attack-surface-reduction-rules-reference.md"
																data-pr_repo=""
																data-pr_branch="">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-edit-outline"></span>
														</span>
														<span>Edit</span>
													</a><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs" />
														<h4 class="font-size-sm padding-left-xxs">Share via</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">Email</span>
														</a><hr />
													<button
														class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
														title="Print"
														type="button"
														aria-label="Print"
														data-bi-name="print"
														data-page-action-item="overflow-all"
														data-popover-close
														data-print-page
														data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">Print</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button hidden>
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="attack-surface-reduction-rules-reference">Attack surface reduction rules reference</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr"><li>Article</li><li class="visibility-hidden-visual-diff"><time class="is-invisible" data-article-date aria-label="Article review date" datetime="2024-10-07T08:00:00Z" data-article-date-source="calculated">10/07/2024</time>
															</li><li class="contributors-holder display-none-print">
															<button aria-label="View all contributors" class="contributors-button link-button" data-bi-name="contributors" title="View all contributors">6 contributors</button>
														</li></ul>
										</div>
<div id="user-feedback" class="margin-block-xxs display-none-print" data-hide-on-archived>
	<button
		id="user-feedback-button"
		data-test-id="conceptual-feedback-button"
		class="button button-sm button-clear button-primary"
		type="button"
		data-bi-name="user-feedback-button"
		data-user-feedback-button
	>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-like"></span>
		</span>
		<span>Feedback</span>
	</button>
</div></div><nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav><!-- <content> --><p><strong>Applies to:</strong></p>
<ul>
<li><a href="microsoft-defender-endpoint" data-linktype="relative-path">Microsoft Microsoft Defender XDR for Endpoint Plan 1</a></li>
<li><a href="microsoft-defender-endpoint" data-linktype="relative-path">Microsoft Defender for Endpoint Plan 2</a></li>
<li><a href="/en-us/defender-xdr" data-linktype="absolute-path">Microsoft Defender XDR</a></li>
<li>Microsoft Defender Antivirus</li>
</ul>
<p><strong>Platforms:</strong></p>
<ul>
<li>Windows</li>
</ul>
<p>This article provides information about Microsoft Defender for Endpoint attack surface reduction rules (ASR rules):</p>
<ul>
<li><a href="#asr-rules-supported-operating-systems" data-linktype="self-bookmark">ASR rules supported operating system versions</a></li>
<li><a href="#asr-rules-supported-configuration-management-systems" data-linktype="self-bookmark">ASR rules supported configuration management systems</a></li>
<li><a href="#per-asr-rule-alert-and-notification-details" data-linktype="self-bookmark">Per ASR rule alert and notification details</a></li>
<li><a href="#asr-rule-to-guid-matrix" data-linktype="self-bookmark">ASR rule to GUID matrix</a></li>
<li><a href="#asr-rule-modes" data-linktype="self-bookmark">ASR rule modes</a></li>
<li><a href="#per-rule-descriptions" data-linktype="self-bookmark">Per-rule-descriptions</a></li>
</ul>
<div class="IMPORTANT">
<p>Important</p>
<p>Some information in this article relates to a prereleased product which may be substantially modified before it's commercially released. Microsoft makes no warranties, expressed or implied, with respect to the information provided here.</p>
</div>
<div class="TIP">
<p>Tip</p>
<p>As a companion to this article, see our <a href="https://go.microsoft.com/fwlink/p/?linkid=2268087" data-linktype="external">Microsoft Defender for Endpoint setup guide</a> to review best practices and learn about essential tools such as attack surface reduction and next-generation protection. For a customized experience based on your environment, you can access the Defender for <a href="https://go.microsoft.com/fwlink/p/?linkid=2268088" data-linktype="external">Endpoint automated setup guide</a> in the Microsoft 365 admin center.</p>
</div>
<h2 id="attack-surface-reduction-rules-by-type">Attack surface reduction rules by type</h2>
<p>Attack surface reduction rules are categorized as one of two types:</p>
<ul>
<li><p><strong>Standard protection rules</strong>: Are the minimum set of rules which Microsoft recommends you always enable, while you're evaluating the effect and configuration needs of the other ASR rules. These rules typically have minimal-to-no noticeable impact on the end user.</p>
</li>
<li><p><strong>Other rules</strong>: Rules that require some measure of following the documented deployment steps [Plan &gt; Test (audit) &gt; Enable (block/warn modes)], as documented in the <a href="attack-surface-reduction-rules-deployment" data-linktype="relative-path">Attack surface reduction rules deployment guide</a></p>
</li>
</ul>
<p>For the easiest method to enable the standard protection rules, see: <a href="attack-surface-reduction-rules-report#simplified-standard-protection-option" data-linktype="relative-path">Simplified standard protection option</a>.</p>
<table>
<thead>
<tr>
<th>ASR rule name:</th>
<th>Standard protection rule?</th>
<th>Other rule?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Block abuse of exploited vulnerable signed drivers</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>Block Adobe Reader from creating child processes</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block all Office applications from creating child processes</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block credential stealing from the Windows local security authority subsystem (lsass.exe)</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>Block executable content from email client and webmail</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block executable files from running unless they meet a prevalence, age, or trusted list criterion</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block execution of potentially obfuscated scripts</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block JavaScript or VBScript from launching downloaded executable content</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block Office applications from creating executable content</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block Office applications from injecting code into other processes</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block Office communication application from creating child processes</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block persistence through WMI event subscription</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>Block process creations originating from PSExec and WMI commands</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block rebooting machine in Safe Mode (preview)</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block untrusted and unsigned processes that run from USB</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block use of copied or impersonated system tools (preview)</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block Webshell creation for Servers</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Block Win32 API calls from Office macros</td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>Use advanced protection against ransomware</td>
<td></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<h2 id="microsoft-defender-antivirus-exclusions-and-asr-rules">Microsoft Defender Antivirus exclusions and ASR rules</h2>
<p>Microsoft Defender Antivirus exclusions apply to some Microsoft Defender for Endpoint capabilities, such as some of the attack surface reduction rules.</p>
<p>The following ASR rules DO NOT honor Microsoft Defender Antivirus exclusions:</p>
<table>
<thead>
<tr>
<th>ASR rules name:</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#block-adobe-reader-from-creating-child-processes" data-linktype="self-bookmark">Block Adobe Reader from creating child processes</a></td>
</tr>
<tr>
<td><a href="#block-process-creations-originating-from-psexec-and-wmi-commands" data-linktype="self-bookmark">Block process creations originating from PSExec and WMI commands</a></td>
</tr>
<tr>
<td><a href="#block-credential-stealing-from-the-windows-local-security-authority-subsystem" data-linktype="self-bookmark">Block credential stealing from the Windows local security authority subsystem (lsass.exe)</a></td>
</tr>
<tr>
<td><a href="#block-office-applications-from-creating-executable-content" data-linktype="self-bookmark">Block Office applications from creating executable content</a></td>
</tr>
<tr>
<td><a href="#block-office-applications-from-injecting-code-into-other-processes" data-linktype="self-bookmark">Block Office applications from injecting code into other processes</a></td>
</tr>
<tr>
<td><a href="#block-office-communication-application-from-creating-child-processes" data-linktype="self-bookmark">Block Office communication application from creating child processes</a></td>
</tr>
</tbody>
</table>
<div class="NOTE">
<p>Note</p>
<p>For information about configuring per-rule exclusions, see the section titled <strong>Configure ASR rules per-rule exclusions</strong> in the topic <a href="attack-surface-reduction-rules-deployment-test" data-linktype="relative-path">Test attack surface reduction rules</a>.</p>
</div>
<h2 id="asr-rules-and-defender-for-endpoint-indicators-of-compromise-ioc">ASR rules and Defender for Endpoint Indicators of Compromise (IOC)</h2>
<p>The following ASR rules DO NOT honor Microsoft Defender for Endpoint Indicators of Compromise (IOC):</p>
<table>
<thead>
<tr>
<th>ASR rule name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Block credential stealing from the Windows local security authority subsystem (lsass.exe)</td>
<td>Doesn't honor indicators of compromise for files or certificates.</td>
</tr>
<tr>
<td>Block Office applications from injecting code into other processes</td>
<td>Doesn't honor indicators of compromise for files or certificates.</td>
</tr>
<tr>
<td>Block Win32 API calls from Office macros</td>
<td>Doesn't honor indicators of compromise for certificates.</td>
</tr>
</tbody>
</table>
<h2 id="asr-rules-supported-operating-systems">ASR rules supported operating systems</h2>
<p>The following table lists the supported operating systems for rules that are currently released to general availability. The rules are listed alphabetical order in this table.</p>
<div class="NOTE">
<p>Note</p>
<p>Unless otherwise indicated, the minimum Windows10 build is version 1709 (RS3, build 16299) or later; the minimum WindowsServer build is version 1809 or later.</p>
<p>Attack surface reduction rules in WindowsServer2012R2 and WindowsServer2016 are available for devices onboarded using the modern unified solution package. For more information, see <a href="configure-server-endpoints#functionality-in-the-modern-unified-solution" data-linktype="relative-path">New Windows Server 2012 R2 and 2016 functionality in the modern unified solution</a>.</p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Rule name</th>
<th style="text-align: center;">Windows11 <br>and<br> Windows10</th>
<th style="text-align: center;">WindowsServer <br> 2022 <br>and<br>  WindowsServer <br> 2019</th>
<th style="text-align: center;">Windows Server</th>
<th style="text-align: center;">WindowsServer <br> 2016 <sup>[<a href="#fn1" data-linktype="self-bookmark">1, 2</a>]</sup></th>
<th style="text-align: center;">WindowsServer <br> 2012R2 <sup>[<a href="#fn1" data-linktype="self-bookmark">1, 2</a>]</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><a href="#block-abuse-of-exploited-vulnerable-signed-drivers" data-linktype="self-bookmark">Block abuse of exploited vulnerable signed drivers</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br> version 1803 (Semi-Annual Enterprise Channel) or later</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-adobe-reader-from-creating-child-processes" data-linktype="self-bookmark">Block Adobe Reader from creating child processes</a></td>
<td style="text-align: center;">Y <br> version 1809 or later <sup>[<a href="#fn1" data-linktype="self-bookmark">3</a>]</sup></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-all-office-applications-from-creating-child-processes" data-linktype="self-bookmark">Block all Office applications from creating child processes</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-credential-stealing-from-the-windows-local-security-authority-subsystem" data-linktype="self-bookmark">Block credential stealing from the Windows local security authority subsystem (lsass.exe)</a></td>
<td style="text-align: center;">Y <br> version 1803 or later <sup>[<a href="#fn1" data-linktype="self-bookmark">3</a>]</sup></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-executable-content-from-email-client-and-webmail" data-linktype="self-bookmark">Block executable content from email client and webmail</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-executable-files-from-running-unless-they-meet-a-prevalence-age-or-trusted-list-criterion" data-linktype="self-bookmark">Block executable files from running unless they meet a prevalence, age, or trusted list criterion</a></td>
<td style="text-align: center;">Y <br> version 1803 or later <sup>[<a href="#fn1" data-linktype="self-bookmark">3</a>]</sup></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-execution-of-potentially-obfuscated-scripts" data-linktype="self-bookmark">Block execution of potentially obfuscated scripts</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-javascript-or-vbscript-from-launching-downloaded-executable-content" data-linktype="self-bookmark">Block JavaScript or VBScript from launching downloaded executable content</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">N</td>
<td style="text-align: center;">N</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-office-applications-from-creating-executable-content" data-linktype="self-bookmark">Block Office applications from creating executable content</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-office-applications-from-injecting-code-into-other-processes" data-linktype="self-bookmark">Block Office applications from injecting code into other processes</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-office-communication-application-from-creating-child-processes" data-linktype="self-bookmark">Block Office communication application from creating child processes</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-persistence-through-wmi-event-subscription" data-linktype="self-bookmark">Block persistence through Windows Management Instrumentation (WMI) event subscription</a></td>
<td style="text-align: center;">Y <br> version 1903 (build 18362) or later <sup>[<a href="#fn1" data-linktype="self-bookmark">3</a>]</sup></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br> version 1903 (build 18362) or later</td>
<td style="text-align: center;">N</td>
<td style="text-align: center;">N</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-process-creations-originating-from-psexec-and-wmi-commands" data-linktype="self-bookmark">Block process creations originating from PSExec and WMI commands</a></td>
<td style="text-align: center;">Y <br> version 1803 or later <sup>[<a href="#fn1" data-linktype="self-bookmark">3</a>]</sup></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-rebooting-machine-in-safe-mode-preview" data-linktype="self-bookmark">Block rebooting machine in Safe Mode (preview)</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-untrusted-and-unsigned-processes-that-run-from-usb" data-linktype="self-bookmark">Block untrusted and unsigned processes that run from USB</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-use-of-copied-or-impersonated-system-tools-preview" data-linktype="self-bookmark">Block use of copied or impersonated system tools (preview)</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-webshell-creation-for-servers" data-linktype="self-bookmark">Block Webshell creation for Servers</a></td>
<td style="text-align: center;">N</td>
<td style="text-align: center;">Y <br>Exchange Role Only</td>
<td style="text-align: center;">Y <br>Exchange Role Only</td>
<td style="text-align: center;">Y <br>Exchange Role Only</td>
<td style="text-align: center;">Y <br>Exchange Role Only</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#block-win32-api-calls-from-office-macros" data-linktype="self-bookmark">Block Win32 API calls from Office macros</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">N</td>
<td style="text-align: center;">N</td>
<td style="text-align: center;">N</td>
<td style="text-align: center;">N</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#use-advanced-protection-against-ransomware" data-linktype="self-bookmark">Use advanced protection against ransomware</a></td>
<td style="text-align: center;">Y <br> version 1803 or later <sup>[<a href="#fn1" data-linktype="self-bookmark">3</a>]</sup></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
</tbody>
</table>
<p>(<a id="fn1">1</a>) Refers to the modern unified solution for Windows Server 2012 and 2016. For more information, see <a href="configure-server-endpoints" data-linktype="relative-path">Onboard Windows Servers to the Defender for Endpoint service</a>.</p>
<p>(<a id="fn1">2</a>) For WindowsServer 2016 and WindowsServer 2012R2, the minimum required version of Microsoft Endpoint Configuration Manager is version 2111.</p>
<p>(<a id="fn1">3</a>) Version and build number apply only to Windows10.</p>
<h2 id="asr-rules-supported-configuration-management-systems">ASR rules supported configuration management systems</h2>
<p>Links to information about configuration management system versions referenced in this table are listed below this table.</p>
<table>
<thead>
<tr>
<th>Rule name</th>
<th style="text-align: center;">Microsoft Intune</th>
<th style="text-align: center;">Microsoft Endpoint Configuration Manager</th>
<th style="text-align: center;">Group Policy<sup>[<a href="#fn1" data-linktype="self-bookmark">1</a>]</sup></th>
<th style="text-align: center;">PowerShell<sup>[<a href="#fn1" data-linktype="self-bookmark">1</a>]</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#block-abuse-of-exploited-vulnerable-signed-drivers" data-linktype="self-bookmark">Block abuse of exploited vulnerable signed drivers</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-adobe-reader-from-creating-child-processes" data-linktype="self-bookmark">Block Adobe Reader from creating child processes</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-all-office-applications-from-creating-child-processes" data-linktype="self-bookmark">Block all Office applications from creating child processes</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-credential-stealing-from-the-windows-local-security-authority-subsystem" data-linktype="self-bookmark">Block credential stealing from the Windows local security authority subsystem (lsass.exe)</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br>CB 1802</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-executable-content-from-email-client-and-webmail" data-linktype="self-bookmark">Block executable content from email client and webmail</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-executable-files-from-running-unless-they-meet-a-prevalence-age-or-trusted-list-criterion" data-linktype="self-bookmark">Block executable files from running unless they meet a prevalence, age, or trusted list criterion</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1802</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-execution-of-potentially-obfuscated-scripts" data-linktype="self-bookmark">Block execution of potentially obfuscated scripts</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y  <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-javascript-or-vbscript-from-launching-downloaded-executable-content" data-linktype="self-bookmark">Block JavaScript or VBScript from launching downloaded executable content</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-office-applications-from-creating-executable-content" data-linktype="self-bookmark">Block Office applications from creating executable content</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-office-applications-from-injecting-code-into-other-processes" data-linktype="self-bookmark">Block Office applications from injecting code into other processes</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-office-communication-application-from-creating-child-processes" data-linktype="self-bookmark">Block Office communication application from creating child processes</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-persistence-through-wmi-event-subscription" data-linktype="self-bookmark">Block persistence through WMI event subscription</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-process-creations-originating-from-psexec-and-wmi-commands" data-linktype="self-bookmark">Block process creations originating from PSExec and WMI commands</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-rebooting-machine-in-safe-mode-preview" data-linktype="self-bookmark">Block rebooting machine in Safe Mode (preview)</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-untrusted-and-unsigned-processes-that-run-from-usb" data-linktype="self-bookmark">Block untrusted and unsigned processes that run from USB</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1802</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-use-of-copied-or-impersonated-system-tools-preview" data-linktype="self-bookmark">Block use of copied or impersonated system tools (preview)</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-webshell-creation-for-servers" data-linktype="self-bookmark">Block Webshell creation for Servers</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#block-win32-api-calls-from-office-macros" data-linktype="self-bookmark">Block Win32 API calls from Office macros</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1710</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
<tr>
<td><a href="#use-advanced-protection-against-ransomware" data-linktype="self-bookmark">Use advanced protection against ransomware</a></td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y <br><br> CB 1802</td>
<td style="text-align: center;">Y</td>
<td style="text-align: center;">Y</td>
</tr>
</tbody>
</table>
<p>(<a id="fn1">1</a>) You can configure attack surface reduction rules on a per-rule basis by using any rule's GUID.</p>
<ul>
<li><a href="/en-us/configmgr/core/servers/manage/updates" data-linktype="absolute-path">Configuration Manager CB 1710</a></li>
<li><a href="/en-us/configmgr/core/servers/manage/updates" data-linktype="absolute-path">Configuration Manager CB 1802</a></li>
<li><a href="/en-us/configmgr/core/servers/manage/updates" data-linktype="absolute-path">Microsoft Configuration Manager CB 1710</a></li>
<li><a href="/en-us/configmgr/core/servers/manage/updates" data-linktype="absolute-path">System Center Configuration Manager (SCCM) CB 1710</a> <br><em>SCCM is now Microsoft Configuration Manager.</em></li>
</ul>
<h2 id="per-asr-rule-alert-and-notification-details">Per ASR rule alert and notification details</h2>
<p>Toast notifications are generated for all rules in Block mode. Rules in any other mode don't generate toast notifications.</p>
<p>For rules with the "Rule State" specified:</p>
<ul>
<li>ASR rules with <code>\ASR Rule, Rule State\</code> combinations are used to surface alerts (toast notifications) on Microsoft Defender for Endpoint only for devices at cloud block level "High".</li>
<li>Devices that not at the high cloud block level don't generate alerts for any <code>ASR Rule, Rule State</code> combinations</li>
<li>EDR alerts are generated for ASR rules in the specified states, for devices at cloud block level "High+"</li>
<li>Toast notifications occur in block mode only and for devices at cloud block level "High"</li>
</ul>
<table>
<thead>
<tr>
<th>Rule name</th>
<th>Rule state</th>
<th>EDR alerts</th>
<th>Toast notifications</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#block-abuse-of-exploited-vulnerable-signed-drivers" data-linktype="self-bookmark">Block abuse of exploited vulnerable signed drivers</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-adobe-reader-from-creating-child-processes" data-linktype="self-bookmark">Block Adobe Reader from creating child processes</a></td>
<td>Block</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-all-office-applications-from-creating-child-processes" data-linktype="self-bookmark">Block all Office applications from creating child processes</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-credential-stealing-from-the-windows-local-security-authority-subsystem" data-linktype="self-bookmark">Block credential stealing from the Windows local security authority subsystem (lsass.exe)</a></td>
<td></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td><a href="#block-executable-content-from-email-client-and-webmail" data-linktype="self-bookmark">Block executable content from email client and webmail</a></td>
<td></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-executable-files-from-running-unless-they-meet-a-prevalence-age-or-trusted-list-criterion" data-linktype="self-bookmark">Block executable files from running unless they meet a prevalence, age, or trusted list criterion</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-execution-of-potentially-obfuscated-scripts" data-linktype="self-bookmark">Block execution of potentially obfuscated scripts</a></td>
<td>Audit or Block</td>
<td>Y (in block mode) <br>N (in audit mode)</td>
<td>Y (in block mode)</td>
</tr>
<tr>
<td><a href="#block-javascript-or-vbscript-from-launching-downloaded-executable-content" data-linktype="self-bookmark">Block JavaScript or VBScript from launching downloaded executable content</a></td>
<td>Block</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-office-applications-from-creating-executable-content" data-linktype="self-bookmark">Block Office applications from creating executable content</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-office-applications-from-injecting-code-into-other-processes" data-linktype="self-bookmark">Block Office applications from injecting code into other processes</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-office-communication-application-from-creating-child-processes" data-linktype="self-bookmark">Block Office communication application from creating child processes</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-persistence-through-wmi-event-subscription" data-linktype="self-bookmark">Block persistence through WMI event subscription</a></td>
<td>Audit or Block</td>
<td>Y (in block mode) <br> N (in audit mode)</td>
<td>Y (in block mode)</td>
</tr>
<tr>
<td><a href="#block-process-creations-originating-from-psexec-and-wmi-commands" data-linktype="self-bookmark">Block process creations originating from PSExec and WMI commands</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#block-rebooting-machine-in-safe-mode-preview" data-linktype="self-bookmark">Block rebooting machine in Safe Mode (preview)</a></td>
<td></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td><a href="#block-untrusted-and-unsigned-processes-that-run-from-usb" data-linktype="self-bookmark">Block untrusted and unsigned processes that run from USB</a></td>
<td>Audit or Block</td>
<td>Y (in block mode) <br> N (in audit mode)</td>
<td>Y (in block mode)</td>
</tr>
<tr>
<td><a href="#block-use-of-copied-or-impersonated-system-tools-preview" data-linktype="self-bookmark">Block use of copied or impersonated system tools (preview)</a></td>
<td></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td><a href="#block-webshell-creation-for-servers" data-linktype="self-bookmark">Block Webshell creation for Servers</a></td>
<td></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td><a href="#block-win32-api-calls-from-office-macros" data-linktype="self-bookmark">Block Win32 API calls from Office macros</a></td>
<td></td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td><a href="#use-advanced-protection-against-ransomware" data-linktype="self-bookmark">Use advanced protection against ransomware</a></td>
<td>Audit or Block</td>
<td>Y (in block mode) <br> N (in audit mode)</td>
<td>Y (in block mode)</td>
</tr>
</tbody>
</table>
<h2 id="asr-rule-to-guid-matrix">ASR rule to GUID matrix</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Rule Name</th>
<th style="text-align: left;">Rule GUID</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Block abuse of exploited vulnerable signed drivers</td>
<td style="text-align: left;">56a863a9-875e-4185-98a7-b882c64b5ce5</td>
</tr>
<tr>
<td style="text-align: left;">Block Adobe Reader from creating child processes</td>
<td style="text-align: left;">7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c</td>
</tr>
<tr>
<td style="text-align: left;">Block all Office applications from creating child processes</td>
<td style="text-align: left;">d4f940ab-401b-4efc-aadc-ad5f3c50688a</td>
</tr>
<tr>
<td style="text-align: left;">Block credential stealing from the Windows local security authority subsystem (lsass.exe)</td>
<td style="text-align: left;">9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2</td>
</tr>
<tr>
<td style="text-align: left;">Block executable content from email client and webmail</td>
<td style="text-align: left;">be9ba2d9-53ea-4cdc-84e5-9b1eeee46550</td>
</tr>
<tr>
<td style="text-align: left;">Block executable files from running unless they meet a prevalence, age, or trusted list criterion</td>
<td style="text-align: left;">01443614-cd74-433a-b99e-2ecdc07bfc25</td>
</tr>
<tr>
<td style="text-align: left;">Block execution of potentially obfuscated scripts</td>
<td style="text-align: left;">5beb7efe-fd9a-4556-801d-275e5ffc04cc</td>
</tr>
<tr>
<td style="text-align: left;">Block JavaScript or VBScript from launching downloaded executable content</td>
<td style="text-align: left;">d3e037e1-3eb8-44c8-a917-57927947596d</td>
</tr>
<tr>
<td style="text-align: left;">Block Office applications from creating executable content</td>
<td style="text-align: left;">3b576869-a4ec-4529-8536-b80a7769e899</td>
</tr>
<tr>
<td style="text-align: left;">Block Office applications from injecting code into other processes</td>
<td style="text-align: left;">75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84</td>
</tr>
<tr>
<td style="text-align: left;">Block Office communication application from creating child processes</td>
<td style="text-align: left;">26190899-1602-49e8-8b27-eb1d0a1ce869</td>
</tr>
<tr>
<td style="text-align: left;">Block persistence through WMI event subscription <br>* File and folder exclusions not supported.</td>
<td style="text-align: left;">e6db77e5-3df2-4cf1-b95a-636979351e5b</td>
</tr>
<tr>
<td style="text-align: left;">Block process creations originating from PSExec and WMI commands</td>
<td style="text-align: left;">d1e49aac-8f56-4280-b9ba-993a6d77406c</td>
</tr>
<tr>
<td style="text-align: left;">Block rebooting machine in Safe Mode (preview)</td>
<td style="text-align: left;">33ddedf1-c6e0-47cb-833e-de6133960387</td>
</tr>
<tr>
<td style="text-align: left;">Block untrusted and unsigned processes that run from USB</td>
<td style="text-align: left;">b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4</td>
</tr>
<tr>
<td style="text-align: left;">Block use of copied or impersonated system tools (preview)</td>
<td style="text-align: left;">c0033c00-d16d-4114-a5a0-dc9b3a7d2ceb</td>
</tr>
<tr>
<td style="text-align: left;">Block Webshell creation for Servers</td>
<td style="text-align: left;">a8f5898e-1dc8-49a9-9878-85004b8a61e6</td>
</tr>
<tr>
<td style="text-align: left;">Block Win32 API calls from Office macros</td>
<td style="text-align: left;">92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b</td>
</tr>
<tr>
<td style="text-align: left;">Use advanced protection against ransomware</td>
<td style="text-align: left;">c1db55ab-c21a-4637-bb3f-a12568109d35</td>
</tr>
</tbody>
</table>
<h2 id="asr-rule-modes">ASR rule modes</h2>
<ul>
<li><strong>Not configured</strong> or <strong>Disable</strong>: The state in which the ASR rule isn't enabled or is disabled. The code for this state = 0.</li>
<li><strong>Block</strong>: The state in which the ASR rule is enabled. The code for this state is 1.</li>
<li><strong>Audit</strong>: The state in which the ASR rule is evaluated for the effect it would have on the organization or environment if enabled (set to block or warn). The code for this state is 2.</li>
<li><strong>Warn</strong> The state in which the ASR rule is enabled and presents a notification to the end-user, but permits the end-user to bypass the block. The code for this state is 6.</li>
</ul>
<p><em>Warn mode</em> is a block-mode type that alerts users about potentially risky actions. Users can choose to bypass the block warning message and allow the underlying action. Users can select <strong>OK</strong> to enforce the block, or select the bypass option - <strong>Unblock</strong> - through the end-user pop-up toast notification that is generated at the time of the block. After the warning is unblocked, the operation is allowed until the next time the warning message occurs, at which time the end-user will need to reperform the action.</p>
<p>When the allow button is clicked, the block is suppressed for 24 hours. After 24 hours, the end-user will need to allow the block again. The warn mode for ASR rules is only supported for RS5+ (1809+) devices. If bypass is assigned to ASR rules on devices with older versions, the rule is in blocked mode.</p>
<p>You can also set a rule in warn mode via PowerShell by specifying the <code>AttackSurfaceReductionRules_Actions</code> as "Warn". For example:</p>
<pre><code class="lang-powershell">Add-MpPreference -AttackSurfaceReductionRules_Ids 56a863a9-875e-4185-98a7-b882c64b5ce5 -AttackSurfaceReductionRules_Actions Warn
</code></pre>
<h2 id="per-rule-descriptions">Per rule descriptions</h2>
<h3 id="block-abuse-of-exploited-vulnerable-signed-drivers">Block abuse of exploited vulnerable signed drivers</h3>
<p>This rule prevents an application from writing a vulnerable signed driver to disk. In-the-wild, vulnerable signed drivers can be exploited by local applications - <em>that have sufficient privileges</em> - to gain access to the kernel. Vulnerable signed drivers enable attackers to disable or circumvent security solutions, eventually leading to system compromise.</p>
<p>The <strong>Block abuse of exploited vulnerable signed drivers</strong> rule doesn't block a driver already existing on the system from being loaded.</p>
<div class="NOTE">
<p>Note</p>
<p>You can configure this rule using Intune OMA-URI. See <a href="enable-attack-surface-reduction#custom-profile-in-intune" data-linktype="relative-path">Intune OMA-URI</a> for configuring custom rules.</p>
<p>You can also configure this rule using <a href="enable-attack-surface-reduction#powershell" data-linktype="relative-path">PowerShell</a>.</p>
<p>To have a driver examined, use this Web site to <a href="https://www.microsoft.com/en-us/wdsi/driversubmission" data-linktype="external">Submit a driver for analysis</a>.</p>
</div>
<!--The above link is the 'only link' that exists for having drivers examined. The 'en-us' component is required to make the link work. Any alterations to this link will result in a 404.
-->
<p>Intune Name: <code>Block abuse of exploited vulnerable signed drivers</code></p>
<p>Configuration Manager name: Not yet available</p>
<p>GUID: <code>56a863a9-875e-4185-98a7-b882c64b5ce5</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrVulnerableSignedDriverAudited</code></li>
<li><code>AsrVulnerableSignedDriverBlocked</code></li>
</ul>
<!-- 
Dependencies: none provided by engineering
-->
<h3 id="block-adobe-reader-from-creating-child-processes">Block Adobe Reader from creating child processes</h3>
<p>This rule prevents attacks by blocking Adobe Reader from creating processes.</p>
<p>Malware can download and launch payloads and break out of Adobe Reader through social engineering or exploits. By blocking child processes from being generated by Adobe Reader, malware attempting to use Adobe Reader as an attack vector are prevented from spreading.</p>
<p>Intune name: <code>Process creation from Adobe Reader (beta)</code></p>
<p>Configuration Manager name: Not yet available</p>
<p>GUID: <code>7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrAdobeReaderChildProcessAudited</code></li>
<li><code>AsrAdobeReaderChildProcessBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-all-office-applications-from-creating-child-processes">Block all Office applications from creating child processes</h3>
<p>This rule blocks Office apps from creating child processes. Office apps include Word, Excel, PowerPoint, OneNote, and Access.</p>
<p>Creating malicious child processes is a common malware strategy. Malware that abuses Office as a vector often runs VBA macros and exploit code to download and attempt to run more payloads. However, some legitimate line-of-business applications might also generate child processes for benign purposes; such as spawning a command prompt or using PowerShell to configure registry settings.</p>
<p>Intune name: <code>Office apps launching child processes</code></p>
<p>Configuration Manager name: <code>Block Office application from creating child processes</code></p>
<p>GUID: <code>d4f940ab-401b-4efc-aadc-ad5f3c50688a</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrOfficeChildProcessAudited</code></li>
<li><code>AsrOfficeChildProcessBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-credential-stealing-from-the-windows-local-security-authority-subsystem">Block credential stealing from the Windows local security authority subsystem</h3>
<div class="NOTE">
<p>Note</p>
<p>If you have <a href="/en-us/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection" data-linktype="absolute-path">LSA protection</a> enabled and <a href="/en-us/windows/security/identity-protection/credential-guard" data-linktype="absolute-path">Credential Guard</a> enabled, this attack surface reduction rule is not required.</p>
</div>
<p>This rule helps prevent credential stealing by locking down Local Security Authority Subsystem Service (LSASS).</p>
<p>LSASS authenticates users who sign in on a Windows computer. Microsoft Defender Credential Guard in Windows normally prevents attempts to extract credentials from LSASS. Some organizations can't enable Credential Guard on all of their computers because of compatibility issues with custom smartcard drivers or other programs that load into the Local Security Authority (LSA). In these cases, attackers can use tools like Mimikatz to scrape cleartext passwords and NTLM hashes from LSASS.</p>
<p>By default the state of this rule is set to block. In most cases, many processes make calls to LSASS for access rights that are not needed. For example, such as when the initial block from the ASR rule results in a subsequent call for a lesser privilege which subsequently succeeds. For information about the types of rights that are typically requested in process calls to LSASS, see: <a href="/en-us/windows/win32/procthread/process-security-and-access-rights" data-linktype="absolute-path">Process Security and Access Rights</a>.</p>
<p>Enabling this rule doesn't provide additional protection if you have LSA protection enabled since the ASR rule and LSA protection work similarly. However, when LSA protection cannot be enabled, this rule can be configured to provide equivalent protection against malware that target <code>lsass.exe</code>.</p>
<div class="NOTE">
<p>Note</p>
<p>In this scenario, the ASR rule is classified as "not applicable" in Defender for Endpoint settings in the Microsoft Defender portal.</p>
<p>The <em>Block credential stealing from the Windows local security authority subsystem</em> ASR rule doesn't support WARN mode.</p>
<p>In some apps, the code enumerates all running processes and attempts to open them with exhaustive permissions. This rule denies the app's process open action and logs the details to the security event log. This rule can generate a lot of noise. If you have an app that simply enumerates LSASS, but has no real impact in functionality, there is no need to add it to the exclusion list. By itself, this event log entry doesn't necessarily indicate a malicious threat.</p>
</div>
<p>Intune name: <code>Flag credential stealing from the Windows local security authority subsystem</code></p>
<p>Configuration Manager name: <code>Block credential stealing from the Windows local security authority subsystem</code></p>
<p>GUID: <code>9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrLsassCredentialTheftAudited</code></li>
<li><code>AsrLsassCredentialTheftBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-executable-content-from-email-client-and-webmail">Block executable content from email client and webmail</h3>
<p>This rule blocks email opened within the Microsoft Outlook application, or Outlook.com and other popular webmail providers from propagating the following file types:</p>
<ul>
<li>Executable files (such as .exe, .dll, or .scr)</li>
<li>Script files (such as a PowerShell .ps1, Visual Basic .vbs, or JavaScript .js file)</li>
</ul>
<p>Intune name: <code>Execution of executable content (exe, dll, ps, js, vbs, etc.) dropped from email (webmail/mail client) (no exceptions)</code></p>
<p>Microsoft Configuration Manager name: <code>Block executable content from email client and webmail</code></p>
<p>GUID: <code>be9ba2d9-53ea-4cdc-84e5-9b1eeee46550</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrExecutableEmailContentAudited</code></li>
<li><code>AsrExecutableEmailContentBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<div class="NOTE">
<p>Note</p>
<p>The rule <strong>Block executable content from email client and webmail</strong> has the following alternative descriptions, depending on which application you use:</p>
<ul>
<li>Intune (Configuration Profiles): Execution of executable content (exe, dll, ps, js, vbs, etc.) dropped from email (webmail/mail client) (no exceptions).</li>
<li>Configuration Manager: Block executable content download from email and webmail clients.</li>
<li>Group Policy: Block executable content from email client and webmail.</li>
</ul>
</div>
<h3 id="block-executable-files-from-running-unless-they-meet-a-prevalence-age-or-trusted-list-criterion">Block executable files from running unless they meet a prevalence, age, or trusted list criterion</h3>
<p>This rule blocks executable files, such as .exe, .dll, or .scr, from launching. Thus, launching untrusted or unknown executable files can be risky, as it might not be initially clear if the files are malicious.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>You must <a href="/en-us/windows/security/threat-protection/microsoft-defender-antivirus/enable-cloud-protection-microsoft-defender-antivirus" data-linktype="absolute-path">enable cloud-delivered protection</a> to use this rule.</p>
<p>The rule <strong>Block executable files from running unless they meet a prevalence, age, or trusted list criterion</strong> with GUID <code>01443614-cd74-433a-b99e-2ecdc07bfc25</code> is owned by Microsoft and is not specified by admins. This rule uses cloud-delivered protection to update its trusted list regularly.</p>
<p>You can specify individual files or folders (using folder paths or fully qualified resource names) but you can't specify which rules or exclusions apply to.</p>
</div>
<p>Intune name: <code>Executables that don't meet a prevalence, age, or trusted list criteria</code></p>
<p>Configuration Manager name: <code>Block executable files from running unless they meet a prevalence, age, or trusted list criteria</code></p>
<p>GUID: <code>01443614-cd74-433a-b99e-2ecdc07bfc25</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrUntrustedExecutableAudited</code></li>
<li><code>AsrUntrustedExecutableBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus, Cloud Protection</p>
<h3 id="block-execution-of-potentially-obfuscated-scripts">Block execution of potentially obfuscated scripts</h3>
<p>This rule detects suspicious properties within an obfuscated script.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>PowerShell scripts are now supported for the "Block execution of potentially obfuscated scripts" rule.</p>
</div>
<p>Script obfuscation is a common technique that both malware authors and legitimate applications use to hide intellectual property or decrease script loading times. Malware authors also use obfuscation to make malicious code harder to read, which hampers close scrutiny by humans and security software.</p>
<p>Intune name: <code>Obfuscated js/vbs/ps/macro code</code></p>
<p>Configuration Manager name: <code>Block execution of potentially obfuscated scripts</code></p>
<p>GUID: <code>5beb7efe-fd9a-4556-801d-275e5ffc04cc</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrObfuscatedScriptAudited</code></li>
<li><code>AsrObfuscatedScriptBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus, AntiMalware Scan Interface (AMSI)</p>
<h3 id="block-javascript-or-vbscript-from-launching-downloaded-executable-content">Block JavaScript or VBScript from launching downloaded executable content</h3>
<p>This rule prevents scripts from launching potentially malicious downloaded content. Malware written in JavaScript or VBScript often acts as a downloader to fetch and launch other malware from the Internet.</p>
<p>Although not common, line-of-business applications sometimes use scripts to download and launch installers.</p>
<p>Intune name: <code>js/vbs executing payload downloaded from Internet (no exceptions)</code></p>
<p>Configuration Manager name: <code>Block JavaScript or VBScript from launching downloaded executable content</code></p>
<p>GUID: <code>d3e037e1-3eb8-44c8-a917-57927947596d</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrScriptExecutableDownloadAudited</code></li>
<li><code>AsrScriptExecutableDownloadBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus, AMSI</p>
<h3 id="block-office-applications-from-creating-executable-content">Block Office applications from creating executable content</h3>
<p>This rule prevents Office apps, including Word, Excel, and PowerPoint, from creating potentially malicious executable content, by blocking malicious code from being written to disk.</p>
<p>Malware that abuses Office as a vector might attempt to break out of Office and save malicious components to disk. These malicious components would survive a computer reboot and persist on the system. Therefore, this rule defends against a common persistence technique. This rule also blocks execution of untrusted files that may have been saved by Office macros that are allowed to run in Office files.</p>
<p>Intune name: <code>Office apps/macros creating executable content</code></p>
<p>Configuration Manager name: <code>Block Office applications from creating executable content</code></p>
<p>GUID: <code>3b576869-a4ec-4529-8536-b80a7769e899</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrExecutableOfficeContentAudited</code></li>
<li><code>AsrExecutableOfficeContentBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus, RPC</p>
<h3 id="block-office-applications-from-injecting-code-into-other-processes">Block Office applications from injecting code into other processes</h3>
<p>This rule blocks code injection attempts from Office apps into other processes.</p>
<div class="NOTE">
<p>Note</p>
<p>The Block applications from injecting code into other processes ASR rule does not support WARN mode.</p>
</div>
<div class="IMPORTANT">
<p>Important</p>
<p>This rule requires restarting Microsoft 365 Apps (Office applications) for the configuration changes to take effect.</p>
</div>
<p>Attackers might attempt to use Office apps to migrate malicious code into other processes through code injection, so the code can masquerade as a clean process.</p>
<p>There are no known legitimate business purposes for using code injection.</p>
<p>This rule applies to Word, Excel, OneNote, and PowerPoint.</p>
<p>Intune name: <code>Office apps injecting code into other processes (no exceptions)</code></p>
<p>Configuration Manager name: <code>Block Office applications from injecting code into other processes</code></p>
<p>GUID: <code>75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrOfficeProcessInjectionAudited</code></li>
<li><code>AsrOfficeProcessInjectionBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-office-communication-application-from-creating-child-processes">Block Office communication application from creating child processes</h3>
<p>This rule prevents Outlook from creating child processes, while still allowing legitimate Outlook functions.</p>
<p>This rule protects against social engineering attacks and prevents exploiting code from abusing vulnerabilities in Outlook. It also protects against <a href="https://blogs.technet.microsoft.com/office365security/defending-against-rules-and-forms-injection/" data-linktype="external">Outlook rules and forms exploits</a> that attackers can use when a user's credentials are compromised.</p>
<div class="NOTE">
<p>Note</p>
<p>This rule blocks DLP policy tips and ToolTips in Outlook. This rule applies to Outlook and Outlook.com only.</p>
</div>
<p>Intune name: <code>Process creation from Office communication products (beta)</code></p>
<p>Configuration Manager name: Not available</p>
<p>GUID: <code>26190899-1602-49e8-8b27-eb1d0a1ce869</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrOfficeCommAppChildProcessAudited</code></li>
<li><code>AsrOfficeCommAppChildProcessBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-persistence-through-wmi-event-subscription">Block persistence through WMI event subscription</h3>
<p>This rule prevents malware from abusing WMI to attain persistence on a device.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>File and folder exclusions don't apply to this attack surface reduction rule.</p>
</div>
<p>Fileless threats employ various tactics to stay hidden, to avoid being seen in the file system, and to gain periodic execution control. Some threats can abuse the WMI repository and event model to stay hidden.</p>
<div class="NOTE">
<p>Note</p>
<p>If <code>CcmExec.exe</code> (SCCM Agent) is detected on the device, the ASR rule is classified as "not applicable" in Defender for Endpoint settings in the Microsoft Defender portal.</p>
</div>
<p>Intune name: <code>Persistence through WMI event subscription</code></p>
<p>Configuration Manager name: Not available</p>
<p>GUID: <code>e6db77e5-3df2-4cf1-b95a-636979351e5b</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrPersistenceThroughWmiAudited</code></li>
<li><code>AsrPersistenceThroughWmiBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus, RPC</p>
<h3 id="block-process-creations-originating-from-psexec-and-wmi-commands">Block process creations originating from PSExec and WMI commands</h3>
<p>This rule blocks processes created through <a href="/en-us/sysinternals/downloads/psexec" data-linktype="absolute-path">PsExec</a> and <a href="/en-us/windows/win32/wmisdk/about-wmi" data-linktype="absolute-path">WMI</a> from running. Both PsExec and WMI can remotely execute code. There's a risk of malware abusing functionality of PsExec and WMI for command and control purposes, or to spread an infection throughout an organization's network.</p>
<div class="WARNING">
<p>Warning</p>
<p>Only use this rule if you're managing your devices with <a href="/en-us/mem/intune" data-linktype="absolute-path">Intune</a> or another MDM solution. This rule is incompatible with management through <a href="/en-us/configmgr" data-linktype="absolute-path">Microsoft Endpoint Configuration Manager</a> because this rule blocks WMI commands the Configuration Manager client uses to function correctly.</p>
</div>
<p>Intune name: <code>Process creation from PSExec and WMI commands</code></p>
<p>Configuration Manager name: Not applicable</p>
<p>GUID: <code>d1e49aac-8f56-4280-b9ba-993a6d77406c</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrPsexecWmiChildProcessAudited</code></li>
<li><code>AsrPsexecWmiChildProcessBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-rebooting-machine-in-safe-mode-preview">Block rebooting machine in Safe Mode (preview)</h3>
<p>This rule prevents the execution of commands to restart machines in Safe Mode.</p>
<p>Safe Mode is a diagnostic mode that only loads the essential files and drivers needed for Windows to run. However, in Safe Mode, many security products are either disabled or operate in a limited capacity, which allows attackers to further launch tampering commands, or simply execute and encrypt all files on the machine. This rule blocks such attacks by preventing processes from restarting machines in Safe Mode.</p>
<div class="NOTE">
<p>Note</p>
<p>This capability is currently in preview. Additional upgrades to improve efficacy are under development.</p>
</div>
<p>Intune Name: <code>[PREVIEW] Block rebooting machine in Safe Mode</code></p>
<p>Configuration Manager name: Not yet available</p>
<p>GUID: <code>33ddedf1-c6e0-47cb-833e-de6133960387</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><p><code>AsrSafeModeRebootedAudited</code></p>
</li>
<li><p><code>AsrSafeModeRebootBlocked</code></p>
</li>
<li><p><code>AsrSafeModeRebootWarnBypassed</code></p>
</li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-untrusted-and-unsigned-processes-that-run-from-usb">Block untrusted and unsigned processes that run from USB</h3>
<p>With this rule, admins can prevent unsigned or untrusted executable files from running from USB removable drives, including SD cards. Blocked file types include executable files (such as .exe, .dll, or .scr)</p>
<div class="IMPORTANT">
<p>Important</p>
<p>Files copied from the USB to the disk drive will be blocked by this rule if and when it's about to be executed on the disk drive.</p>
</div>
<p>Intune name: <code>Untrusted and unsigned processes that run from USB</code></p>
<p>Configuration Manager name: <code>Block untrusted and unsigned processes that run from USB</code></p>
<p>GUID: <code>b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrUntrustedUsbProcessAudited</code></li>
<li><code>AsrUntrustedUsbProcessBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-use-of-copied-or-impersonated-system-tools-preview">Block use of copied or impersonated system tools (preview)</h3>
<p>This rule blocks the use of executable files that are identified as copies of Windows system tools. These files are either duplicates or impostors of the original system tools.</p>
<p>Some malicious programs may try to copy or impersonate Windows system tools to avoid detection or gain privileges. Allowing such executable files can lead to potential attacks. This rule prevents propagation and execution of such duplicates and impostors of the system tools on Windows machines.</p>
<div class="NOTE">
<p>Note</p>
<p>This capability is currently in preview. Additional upgrades to improve efficacy are under development.</p>
</div>
<p>Intune Name: <code>[PREVIEW] Block use of copied or impersonated system tools</code></p>
<p>Configuration Manager name: Not yet available</p>
<p>GUID: <code>c0033c00-d16d-4114-a5a0-dc9b3a7d2ceb</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><p><code>AsrAbusedSystemToolAudited</code></p>
</li>
<li><p><code>AsrAbusedSystemToolBlocked</code></p>
</li>
<li><p><code>AsrAbusedSystemToolWarnBypassed</code></p>
</li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-webshell-creation-for-servers">Block Webshell creation for Servers</h3>
<p>This rule blocks web shell script creation on Microsoft Server, Exchange Role.</p>
<p>A web shell script is a specifically crafted script that allows an attacker to control the compromised server. A web shell may include functionalities such as receiving and executing malicious commands, downloading and executing malicious files, stealing and exfiltrating credentials and sensitive information, identifying potential targets etc.</p>
<p>Intune name: <code>Block Webshell creation for Servers</code></p>
<p>GUID: <code>a8f5898e-1dc8-49a9-9878-85004b8a61e6</code></p>
<p>Dependencies: Microsoft Defender Antivirus</p>
<h3 id="block-win32-api-calls-from-office-macros">Block Win32 API calls from Office macros</h3>
<p>This rule prevents VBA macros from calling Win32 APIs.</p>
<p>Office VBA enables Win32 API calls. Malware can abuse this capability, such as <a href="https://www.microsoft.com/security/blog/2018/09/12/office-vba-amsi-parting-the-veil-on-malicious-macros/" data-linktype="external">calling Win32 APIs to launch malicious shellcode</a> without writing anything directly to disk. Most organizations don't rely on the ability to call Win32 APIs in their day-to-day functioning, even if they use macros in other ways.</p>
<p>Intune name: <code>Win32 imports from Office macro code</code></p>
<p>Configuration Manager name: <code>Block Win32 API calls from Office macros</code></p>
<p>GUID: <code>92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrOfficeMacroWin32ApiCallsAudited</code></li>
<li><code>AsrOfficeMacroWin32ApiCallsBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus, AMSI</p>
<h3 id="use-advanced-protection-against-ransomware">Use advanced protection against ransomware</h3>
<p>This rule provides an extra layer of protection against ransomware. It uses both client and cloud heuristics to determine whether a file resembles ransomware. This rule doesn't block files that have one or more of the following characteristics:</p>
<ul>
<li>The file has already been found to be unharmful in the Microsoft cloud.</li>
<li>The file is a valid signed file.</li>
<li>The file is prevalent enough to not be considered as ransomware.</li>
</ul>
<p>The rule tends to err on the side of caution to prevent ransomware.</p>
<div class="NOTE">
<p>Note</p>
<p>You must <a href="enable-cloud-protection-microsoft-defender-antivirus" data-linktype="relative-path">enable cloud-delivered protection</a> to use this rule.</p>
</div>
<p>Intune name: <code>Advanced ransomware protection</code></p>
<p>Configuration Manager name: <code>Use advanced protection against ransomware</code></p>
<p>GUID: <code>c1db55ab-c21a-4637-bb3f-a12568109d35</code></p>
<p>Advanced hunting action type:</p>
<ul>
<li><code>AsrRansomwareAudited</code></li>
<li><code>AsrRansomwareBlocked</code></li>
</ul>
<p>Dependencies: Microsoft Defender Antivirus, Cloud Protection</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="attack-surface-reduction-rules-deployment" data-linktype="relative-path">Attack surface reduction rules deployment overview</a></li>
<li><a href="attack-surface-reduction-rules-deployment-plan" data-linktype="relative-path">Plan attack surface reduction rules deployment</a></li>
<li><a href="attack-surface-reduction-rules-deployment-test" data-linktype="relative-path">Test attack surface reduction rules</a></li>
<li><a href="attack-surface-reduction-rules-deployment-implement" data-linktype="relative-path">Enable attack surface reduction rules</a></li>
<li><a href="attack-surface-reduction-rules-deployment-operationalize" data-linktype="relative-path">Operationalize attack surface reduction rules</a></li>
<li><a href="attack-surface-reduction-rules-report" data-linktype="relative-path">Attack surface reduction rules report</a></li>
<li><a href="attack-surface-reduction-rules-reference" data-linktype="relative-path">Attack surface reduction rules reference</a></li>
<li><a href="defender-endpoint-antivirus-exclusions" data-linktype="relative-path">Exclusions for Microsoft Defender for Endpoint and Microsoft Defender Antivirus</a></li>
</ul>
<div class="TIP">
<p>Tip</p>
<p>Do you want to learn more? Engage with the Microsoft Security community in our Tech Community:  <a href="https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/bd-p/MicrosoftDefenderATP" data-linktype="external">Microsoft Defender for Endpoint Tech Community</a>.</p>
</div>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><section id="site-user-feedback-footer" class="font-size-sm margin-top-md" data-test-id="site-user-feedback-footer" data-bi-name="site-feedback-section">
	<hr class="hr" />
	<h2 id="feedback" class="title is-3">Feedback</h2>
	<div class="display-flex flex-wrap-wrap align-items-center">
		<p class="font-weight-semibold margin-xxs margin-left-none">Was this page helpful?</p>
		<div class="buttons">
			<button
				class="thumb-rating-button like button button-primary button-sm"
				data-test-id="footer-rating-yes"
				data-binary-rating-response="rating-yes"
				type="button"
				title="This article is helpful"
				data-bi-name="button-rating-yes"
				aria-pressed="false"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-like"></span>
				</span>
				<span>Yes</span>
			</button>
			<button
				class="thumb-rating-button dislike button button-primary button-sm"
				data-test-id="footer-rating-no"
				data-binary-rating-response="rating-no"
				type="button"
				title="This article is not helpful"
				data-bi-name="button-rating-no"
				aria-pressed="false"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-dislike"></span>
				</span>
				<span>No</span>
			</button>
		</div>
	</div><div class="display-flex flex-wrap-wrap margin-top-xxs"><div>
			<a
				data-bi-name="provide-feedback-cta"
				class="has-external-link-indicator"
				href="https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance"
				data-bi-name="product-feedback"
			>
				<span>Provide product feedback</span>
			</a></div></div>

</section><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside
								id="ms--additional-resources-mobile"
								aria-label="Additional resources"
								class="display-none-desktop display-none-print"
							>
								<hr class="hr" hidden />
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer></div></div><div
							id="ms--additional-resources"
							class="right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Additional resources"
						>
							<div id="affixed-right-container" class="margin-top-sm-tablet" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden>Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer>

	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>