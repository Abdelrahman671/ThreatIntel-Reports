<!doctype html><html lang="en"><head><title data-rh="true">A long way to SectopRat. Investigating a highly obfuscated… | by Gi7w0rm | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2023-02-05T17:01:19.676Z"/><meta data-rh="true" name="title" content="A long way to SectopRat. Investigating a highly obfuscated… | by Gi7w0rm | Medium"/><meta data-rh="true" property="og:title" content="A long way to SectopRat"/><meta data-rh="true" property="al:android:url" content="medium://p/eb2f0aad6ec8"/><meta data-rh="true" property="al:ios:url" content="medium://p/eb2f0aad6ec8"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Hello there, welcome back to another block post. To my disappointment, it has been a while. Life can be very busy. But I am happy to be back. This time, with a rather “small” story about a malware…"/><meta data-rh="true" property="og:description" content="Investigating a highly obfuscated stealer sample"/><meta data-rh="true" property="og:url" content="https://gi7w0rm.medium.com/a-long-way-to-sectoprat-eb2f0aad6ec8"/><meta data-rh="true" property="al:web:url" content="https://gi7w0rm.medium.com/a-long-way-to-sectoprat-eb2f0aad6ec8"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:397/1*qoV_U7s79X-b3PfWC6AnXg.png"/><meta data-rh="true" property="article:author" content="https://gi7w0rm.medium.com"/><meta data-rh="true" name="author" content="Gi7w0rm"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="nofollow:test" content="true"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="A long way to SectopRat"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/eb2f0aad6ec8"/><meta data-rh="true" property="twitter:description" content="Investigating a highly obfuscated stealer sample"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:397/1*qoV_U7s79X-b3PfWC6AnXg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@Gi7w0rm"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://gi7w0rm.medium.com"/><link data-rh="true" rel="canonical" href="https://gi7w0rm.medium.com/a-long-way-to-sectoprat-eb2f0aad6ec8"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/eb2f0aad6ec8"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*qoV_U7s79X-b3PfWC6AnXg.png"],"url":"https:\u002F\u002Fgi7w0rm.medium.com\u002Fa-long-way-to-sectoprat-eb2f0aad6ec8","dateCreated":"2023-01-18T02:56:03.797Z","datePublished":"2023-01-18T02:56:03.797Z","dateModified":"2023-02-05T17:01:20.758Z","headline":"A long way to SectopRat - Gi7w0rm - Medium","name":"A long way to SectopRat - Gi7w0rm - Medium","description":"Hello there, welcome back to another block post. To my disappointment, it has been a while. Life can be very busy. But I am happy to be back. This time, with a rather “small” story about a malware…","identifier":"eb2f0aad6ec8","author":{"@type":"Person","name":"Gi7w0rm","url":"https:\u002F\u002Fgi7w0rm.medium.com"},"creator":["Gi7w0rm"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fgi7w0rm.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fgi7w0rm.medium.com\u002Fa-long-way-to-sectoprat-eb2f0aad6ec8"}</script><style type="text/css" data-fela-rehydration="580" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="580" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{gap:16px}.ag{color:inherit}.ah{fill:inherit}.ai{font-size:inherit}.aj{border:inherit}.ak{font-family:inherit}.al{letter-spacing:inherit}.am{font-weight:inherit}.an{padding:0}.ao{margin:0}.ap{cursor:pointer}.aq:disabled{cursor:not-allowed}.ar:disabled{color:#6B6B6B}.as:disabled{fill:#6B6B6B}.av{width:auto}.aw path{fill:#242424}.ax{height:25px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{width:0}.cc{border-right:none}.cd{transition:width 300ms}.ce{flex:0 0 auto}.cf{padding:24px 0}.cg{flex-direction:column}.ch{gap:8px}.ci{transform:translateX(-240px)}.cj{transition:transform 300ms}.ck{text-align:left}.cl{color:#6B6B6B}.cm{padding:8px 24px}.cp{margin-left:16px}.cq{overflow:hidden}.cr{max-height:20px}.cs{text-overflow:ellipsis}.ct{display:-webkit-box}.cu{-webkit-line-clamp:1}.cv{-webkit-box-orient:vertical}.cw{word-break:break-all}.cy{border-bottom:1px solid #E5E5E5}.cz{margin:8px 24px}.da{width:24px}.db{width:calc(100% - 240px)}.dc{flex:1 1 auto}.dd{justify-content:center}.dj{max-width:680px}.dk{min-width:0}.dl{animation:k1 1.2s ease-in-out infinite}.dm{height:100vh}.dn{margin-bottom:16px}.do{margin-top:48px}.dp{align-items:flex-start}.dq{justify-content:space-between}.dr{margin-bottom:24px}.dx{width:80%}.dy{background-color:#F2F2F2}.ee{height:44px}.ef{width:44px}.eg{margin:auto 0}.eh{margin-bottom:4px}.ei{height:16px}.ej{width:120px}.ek{width:80px}.er{margin-bottom:8px}.es{width:96%}.et{width:98%}.eu{width:81%}.ev{margin-left:8px}.ew{font-size:13px}.ex{height:100%}.fp{color:#FFFFFF}.fq{fill:#FFFFFF}.fr{background:#1A8917}.fs{border-color:#1A8917}.fw:disabled{cursor:inherit !important}.fx:disabled{opacity:0.3}.fy:disabled:hover{background:#1A8917}.fz:disabled:hover{border-color:#1A8917}.ga{border-radius:99em}.gb{border-width:1px}.gc{border-style:solid}.gd{box-sizing:border-box}.ge{text-decoration:none}.gf{text-align:center}.gi{margin-right:32px}.gj{position:relative}.gk{fill:#6B6B6B}.gm{background:transparent}.gn svg{margin-left:4px}.go svg{fill:#6B6B6B}.gq{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.gr{position:absolute}.gy{margin:0 24px}.hc{background:rgba(255, 255, 255, 1)}.hd{border:1px solid #F2F2F2}.he{box-shadow:0 1px 4px #F2F2F2}.hf{max-height:100vh}.hg{overflow-y:auto}.hh{left:0}.hi{top:calc(100vh + 100px)}.hj{bottom:calc(100vh + 100px)}.hk{width:10px}.hl{pointer-events:none}.hm{word-break:break-word}.hn{word-wrap:break-word}.ho:after{display:block}.hp:after{content:""}.hq:after{clear:both}.hr{line-height:1.23}.hs{letter-spacing:0}.ht{font-style:normal}.hu{font-weight:700}.ip{margin-bottom:-0.27em}.iq{line-height:1.394}.jl{align-items:baseline}.jm{width:48px}.jn{height:48px}.jo{border:2px solid rgba(255, 255, 255, 1)}.jp{z-index:0}.jq{box-shadow:none}.jr{border:1px solid rgba(0, 0, 0, 0.05)}.js{margin-bottom:2px}.jt{flex-wrap:nowrap}.ju{font-size:16px}.jv{line-height:24px}.jx{margin:0 8px}.jy{display:inline}.jz{text-decoration:underline}.kc{flex-wrap:wrap}.kd{padding-left:8px}.ke{padding-right:8px}.lf> *{flex-shrink:0}.lg{overflow-x:scroll}.lh::-webkit-scrollbar{display:none}.li{scrollbar-width:none}.lj{-ms-overflow-style:none}.lk{width:74px}.ll{flex-direction:row}.lm{z-index:2}.ln{margin-right:4px}.lq{-webkit-user-select:none}.lr{border:0}.ls{fill:rgba(117, 117, 117, 1)}.lv{outline:0}.lw{user-select:none}.lx> svg{pointer-events:none}.mg{cursor:progress}.mh{margin-left:4px}.mi{margin-top:0px}.mj{opacity:1}.mk{padding:4px 0}.mn{width:16px}.mp{display:inline-flex}.mv{max-width:100%}.mw{padding:8px 2px}.mx svg{color:#6B6B6B}.no{line-height:1.58}.np{letter-spacing:-0.004em}.nq{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.oj{margin-bottom:-0.46em}.ok{margin-top:32px}.ol{margin-bottom:14px}.om{padding-top:24px}.on{padding-bottom:10px}.oo{background-color:#000000}.op{height:3px}.oq{width:3px}.or{margin-right:20px}.os{margin-left:auto}.ot{margin-right:auto}.ou{max-width:397px}.pa{clear:both}.pb{height:auto}.pc{margin-top:10px}.pd{max-width:728px}.pg{max-width:1008px}.pi{cursor:zoom-in}.pj{z-index:auto}.pl{max-width:2140px}.pm{max-width:1848px}.ps{box-shadow:inset 0 0 0 1px #F2F2F2}.pt{padding:0px}.pu{padding:16px 20px}.pw{max-height:40px}.px{-webkit-line-clamp:2}.py{margin-top:8px}.pz{margin-top:12px}.qa{max-width:2492px}.qb{max-width:3116px}.qc{max-width:859px}.qd{max-width:1325px}.qe{max-width:1090px}.qf{max-width:3382px}.qg{max-width:2679px}.qh{margin:auto}.qi{padding-bottom:56.199999999999996%}.qj{height:0}.qk{box-shadow:inset 3px 0 0 0 #242424}.ql{padding-left:23px}.qm{margin-left:-20px}.qn{font-style:italic}.qo{max-width:3134px}.qp{max-width:651px}.qq{max-width:1117px}.qr{max-width:803px}.qs{max-width:914px}.qt{max-width:1890px}.qu{margin-bottom:26px}.qv{margin-top:6px}.qw{margin-right:8px}.qx{padding:8px 16px}.qy{border-radius:100px}.qz{transition:background 300ms ease}.rb{white-space:nowrap}.rc{border-top:none}.rd{margin-bottom:50px}.re{height:52px}.rf{max-height:52px}.rg{box-sizing:content-box}.rh{position:static}.ri{z-index:1}.rk{max-width:155px}.rq{margin-bottom:64px}.sf{height:64px}.sg{width:64px}.sh{align-self:flex-end}.si{color:rgba(255, 255, 255, 1)}.sj{fill:rgba(255, 255, 255, 1)}.sk{background:rgba(25, 25, 25, 1)}.sl{border-color:rgba(25, 25, 25, 1)}.so:disabled{opacity:0.1}.sp:disabled:hover{background:rgba(25, 25, 25, 1)}.sq:disabled:hover{border-color:rgba(25, 25, 25, 1)}.sw{padding-right:4px}.sx{font-weight:500}.tk{white-space:pre-wrap}.tl{margin-top:16px}.tr{height:0px}.uf{gap:18px}.ug{fill:rgba(61, 61, 61, 1)}.ui{padding-bottom:20px}.uj{border-bottom:1px solid #F2F2F2}.up{fill:#242424}.uq{background:0}.ur{border-color:#242424}.us:disabled:hover{color:#242424}.ut:disabled:hover{fill:#242424}.uu:disabled:hover{border-color:#242424}.vf{border-bottom:solid 1px #E5E5E5}.vg{margin-top:72px}.vh{margin-bottom:0px}.vi{margin-right:16px}.at:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.au:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.cn:hover{color:#242424}.co:hover p{color:#242424}.ft:hover{background:#156D12}.fu:hover{border-color:#156D12}.fv:hover{cursor:pointer}.gl:hover{fill:#242424}.gp:hover svg{fill:#242424}.gs:hover{background-color:rgba(0, 0, 0, 0.1)}.jw:hover{text-decoration:underline}.lu:hover{fill:rgba(8, 8, 8, 1)}.ml:hover{fill:#000000}.mm:hover p{color:#000000}.mo:hover{color:#000000}.my:hover svg{color:#000000}.ra:hover{background-color:#F2F2F2}.se:hover{background-color:none}.sm:hover{background:#000000}.sn:hover{border-color:#242424}.uh:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lt:focus{fill:rgba(8, 8, 8, 1)}.mz:focus svg{color:#000000}.pk:focus{transform:scale(1.01)}.ly:active{border-style:none}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.di{margin:0 64px}.dw{height:48px}.ed{margin-bottom:52px}.eq{margin-bottom:48px}.fg{font-size:14px}.fh{line-height:20px}.fn{font-size:13px}.fo{padding:5px 12px}.gh{display:flex}.gx{margin-bottom:50px}.hb{max-width:680px}.il{font-size:42px}.im{margin-top:1.19em}.in{line-height:52px}.io{letter-spacing:-0.011em}.jd{font-size:22px}.je{margin-top:0.92em}.jf{line-height:28px}.jk{align-items:center}.kr{border-top:solid 1px #F2F2F2}.ks{border-bottom:solid 1px #F2F2F2}.kt{margin:32px 0 0}.ku{padding:3px 8px}.ld> *{margin-right:24px}.le> :last-child{margin-right:0}.mf{margin-top:0px}.mu{margin:0}.of{font-size:20px}.og{margin-top:2.14em}.oh{line-height:32px}.oi{letter-spacing:-0.003em}.oz{margin-top:56px}.pr{margin-top:32px}.rp{display:inline-block}.rr{flex-direction:row}.ru{margin-bottom:0}.rv{margin-right:20px}.sr{max-width:500px}.ti{line-height:24px}.tj{letter-spacing:0}.tq{margin-bottom:88px}.uc{font-size:24px}.ud{line-height:30px}.ue{letter-spacing:-0.016em}.uo{margin:40px 0 16px}.uz{width:min-width}.ve{padding-top:72px}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.me{margin-top:0px}.pe{margin-left:auto}.pf{text-align:center}.ro{display:inline-block}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.md{margin-top:0px}.rn{display:inline-block}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.mb{margin-top:0px}.mc{margin-right:0px}.pv{padding:10px 12px 10px}.rm{display:inline-block}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.de{margin:0 24px}.ds{height:40px}.dz{margin-bottom:44px}.el{margin-bottom:32px}.ey{font-size:13px}.ez{line-height:20px}.fi{padding:0px 8px 1px}.gt{margin-bottom:2px}.hv{font-size:32px}.hw{margin-top:1.01em}.hx{line-height:38px}.hy{letter-spacing:-0.014em}.ir{font-size:18px}.is{margin-top:0.79em}.it{line-height:24px}.jg{align-items:flex-start}.ka{flex-direction:column}.kf{margin:24px -24px 0}.kg{padding:0}.kv> *{margin-right:8px}.kw> :last-child{margin-right:24px}.lo{margin-left:0px}.lz{margin-top:0px}.ma{margin-right:0px}.mq{margin:0}.na{border:1px solid #F2F2F2}.nb{border-radius:99em}.nc{padding:0px 16px 0px 12px}.nd{height:38px}.ne{align-items:center}.ng svg{margin-right:8px}.nr{margin-top:1.56em}.ns{line-height:28px}.nt{letter-spacing:-0.003em}.ov{margin-top:40px}.pn{margin-top:24px}.rl{display:inline-block}.sc{margin-bottom:20px}.sd{margin-right:0}.sv{max-width:100%}.sy{font-size:24px}.sz{line-height:30px}.ta{letter-spacing:-0.016em}.tm{margin-bottom:64px}.ts{font-size:20px}.tt{letter-spacing:0}.uk{margin:32px 0 16px}.uv{width:100%}.va{padding-top:48px}.nf:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.dh{margin:0 64px}.dv{height:48px}.ec{margin-bottom:52px}.ep{margin-bottom:48px}.fe{font-size:14px}.ff{line-height:20px}.fl{font-size:13px}.fm{padding:5px 12px}.gg{display:flex}.gw{margin-bottom:50px}.ha{max-width:680px}.ih{font-size:42px}.ii{margin-top:1.19em}.ij{line-height:52px}.ik{letter-spacing:-0.011em}.ja{font-size:22px}.jb{margin-top:0.92em}.jc{line-height:28px}.jj{align-items:center}.kn{border-top:solid 1px #F2F2F2}.ko{border-bottom:solid 1px #F2F2F2}.kp{margin:32px 0 0}.kq{padding:3px 8px}.lb> *{margin-right:24px}.lc> :last-child{margin-right:0}.mt{margin:0}.ob{font-size:20px}.oc{margin-top:2.14em}.od{line-height:32px}.oe{letter-spacing:-0.003em}.oy{margin-top:56px}.pq{margin-top:32px}.rs{flex-direction:row}.rw{margin-bottom:0}.rx{margin-right:20px}.ss{max-width:500px}.tg{line-height:24px}.th{letter-spacing:0}.tp{margin-bottom:88px}.tz{font-size:24px}.ua{line-height:30px}.ub{letter-spacing:-0.016em}.un{margin:40px 0 16px}.uy{width:min-width}.vd{padding-top:72px}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.dg{margin:0 48px}.du{height:48px}.eb{margin-bottom:52px}.eo{margin-bottom:48px}.fc{font-size:13px}.fd{line-height:20px}.fk{padding:0px 8px 1px}.gv{margin-bottom:50px}.gz{max-width:680px}.id{font-size:42px}.ie{margin-top:1.19em}.if{line-height:52px}.ig{letter-spacing:-0.011em}.ix{font-size:22px}.iy{margin-top:0.92em}.iz{line-height:28px}.ji{align-items:center}.kj{border-top:solid 1px #F2F2F2}.kk{border-bottom:solid 1px #F2F2F2}.kl{margin:32px 0 0}.km{padding:3px 8px}.kz> *{margin-right:24px}.la> :last-child{margin-right:0}.ms{margin:0}.nx{font-size:20px}.ny{margin-top:2.14em}.nz{line-height:32px}.oa{letter-spacing:-0.003em}.ox{margin-top:56px}.pp{margin-top:32px}.rt{flex-direction:row}.ry{margin-bottom:0}.rz{margin-right:20px}.st{max-width:500px}.te{line-height:24px}.tf{letter-spacing:0}.to{margin-bottom:88px}.tw{font-size:24px}.tx{line-height:30px}.ty{letter-spacing:-0.016em}.um{margin:40px 0 16px}.ux{width:min-width}.vc{padding-top:72px}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.df{margin:0 24px}.dt{height:40px}.ea{margin-bottom:44px}.em{margin-bottom:32px}.fa{font-size:13px}.fb{line-height:20px}.fj{padding:0px 8px 1px}.gu{margin-bottom:2px}.hz{font-size:32px}.ia{margin-top:1.01em}.ib{line-height:38px}.ic{letter-spacing:-0.014em}.iu{font-size:18px}.iv{margin-top:0.79em}.iw{line-height:24px}.jh{align-items:flex-start}.kb{flex-direction:column}.kh{margin:24px 0 0}.ki{padding:0}.kx> *{margin-right:8px}.ky> :last-child{margin-right:8px}.lp{margin-left:0px}.mr{margin:0}.nh{border:1px solid #F2F2F2}.ni{border-radius:99em}.nj{padding:0px 16px 0px 12px}.nk{height:38px}.nl{align-items:center}.nn svg{margin-right:8px}.nu{margin-top:1.56em}.nv{line-height:28px}.nw{letter-spacing:-0.003em}.ow{margin-top:40px}.po{margin-top:24px}.sa{margin-bottom:20px}.sb{margin-right:0}.su{max-width:100%}.tb{font-size:24px}.tc{line-height:30px}.td{letter-spacing:-0.016em}.tn{margin-bottom:64px}.tu{font-size:20px}.tv{letter-spacing:0}.ul{margin:32px 0 16px}.uw{width:100%}.vb{padding-top:48px}.nm:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="print">.rj{display:none}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.cx{max-height:none}</style><style type="text/css" data-fela-rehydration="580" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ph{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="cl ah ew bf al b an ao ap aq ar as at au s u w i d q ex z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feb2f0aad6ec8&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ev"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b ey ez fa fb fc fd fe ff fg fh cl"><span><button class="bf b ey ez fi fa fb fj fc fd fk fl ff fm fn fh fo fp fq fr fs ft fu fv fw fx fy fz ga gb gc gd bm ge gf" data-testid="headerSignUpButton">Sign up</button></span></p><div class="cp l"><p class="bf b ey ez fa fb fc fd fe ff fg fh cl"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae af"><a class="ag ah ai aj ak al am an ao ap aq ar as at au ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="av aw ax"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w gg gh"><div class="gi ab"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bf b bg z cl gj gk ab q cn gl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="ev l">Write</div></div></a></span></div></div><div class="k j i d"><div class="gi ab"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSearchButton" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bf b bg z cl gj gk ab q cn gl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="gi h k j"><div class="ab q"><p class="bf b ey ez fa fb fc fd fe ff fg fh cl"><span><button class="bf b ey ez fi fa fb fj fc fd fk fl ff fm fn fh fo fp fq fr fs ft fu fv fw fx fy fz ga gb gc gd bm ge gf" data-testid="headerSignUpButton">Sign up</button></span></p><div class="cp l"><p class="bf b ey ez fa fb fc fd fe ff fg fh cl"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay gm an ab q ap gn go gp" aria-label="user options menu" data-testid="headerUserIcon"><div class="l gj"><img alt="" class="l gd by bz ca dy" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="gq by l bz ca gr n ay gs"></div></div></button></div></div></div><div class="ab"><div class="cb cc cd ce"><div class="ba cf ab cg ch ci cj"><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh ck" href="https://medium.com/?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cl cm cn co"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Home"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.75v10.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v5.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-10.5M22 9l-9.1-6.825a1.5 1.5 0 0 0-1.8 0L2 9"></path></svg><div class="cp l"><p class="bf b bg z cq cr cs ct cu cv cw cx cl">Home</p></div></div></div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh ck" href="https://medium.com/me/lists?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cl cm cn co"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Lists"><path stroke="currentColor" d="M6.44 6.69a1.5 1.5 0 0 1 1.06-.44h9a1.5 1.5 0 0 1 1.06.44l.354-.354-.353.353A1.5 1.5 0 0 1 18 7.75v14l-5.694-4.396-.306-.236-.306.236L6 21.75v-14c0-.398.158-.78.44-1.06Z"></path><path stroke="currentColor" stroke-linecap="round" d="M12.5 2.75h-8a2 2 0 0 0-2 2v11.5"></path></svg><div class="cp l"><p class="bf b bg z cq cr cs ct cu cv cw cx cl">Library</p></div></div></div></a><div class="cy cz da l"></div><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh ck" href="https://medium.com/me/stories/drafts?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cl cm cn co"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stories"><path stroke="currentColor" d="M4.75 21.5h14.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25H4.75a.25.25 0 0 0-.25.25v18.5c0 .138.112.25.25.25Z"></path><path stroke="currentColor" stroke-linecap="round" d="M8 8.5h8M8 15.5h5M8 12h8"></path></svg><div class="cp l"><p class="bf b bg z cq cr cs ct cu cv cw cx cl">Stories</p></div></div></div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh ck" href="https://medium.com/me/stats?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cl cm cn co"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stats"><path stroke="currentColor" d="M2.75 19h4.5a.25.25 0 0 0 .25-.25v-6.5a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25ZM9.75 19h4.5a.25.25 0 0 0 .25-.25V8.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25ZM16.75 19h4.5a.25.25 0 0 0 .25-.25V4.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v14.5c0 .138.112.25.25.25Z"></path></svg><div class="cp l"><p class="bf b bg z cq cr cs ct cu cv cw cx cl">Stats</p></div></div></div></a></div></div><div class="db l dc"><div class="l"><div class="gt gu gv gw gx l"><div class="ab dd"><div class="dk bh gy gz ha hb"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="gr hh hi hj hk hl"></div><div class="hm hn ho hp hq"><div class="ab dd"><div class="dk bh gy gz ha hb"><div><h1 id="e588" class="pw-post-title hr hs ht bf hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip bk" data-testid="storyTitle">A long way to SectopRat</h1></div><div><h2 id="2e5a" class="pw-subtitle-paragraph iq hs ht bf b ir is it iu iv iw ix iy iz ja jb jc jd je jf dr cl">Investigating a highly obfuscated stealer sample</h2><div><div class="speechify-ignore ab dq"><div class="speechify-ignore bh l"><div class="jg jh ji jj jk ab"><div><div class="ab jl"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--eb2f0aad6ec8---------------------------------------"><div class="l jm jn by jo jp"><div class="l gj"><img alt="Gi7w0rm" class="l gd by ee ef dy" src="https://miro.medium.com/v2/resize:fill:88:88/1*XNZYIunppMSwHbb0Dxx3cA.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="jq by l ee ef gr n jr gs"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="js ab q"><div class="ab q jt"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ju jv bk"><a class="ag ah ai aj ak al am an ao ap aq ar as jw" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--eb2f0aad6ec8---------------------------------------">Gi7w0rm</a></p></div></div></div><span class="jx jy" aria-hidden="true"><span class="bf b bg z bk">·</span></span><p class="bf b ju jv bk"><span><a class="ag ah ai aj ak al am an ao ap aq ar as jz" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa7639fc99f0&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=post_page-fa7639fc99f0--byline--eb2f0aad6ec8---------------------post_header------------------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ce"><span class="bf b bg z cl"><div class="ab dp ka kb kc"><span class="bf b bg z cl"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="kd ke l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z cl">·</span></span></div><span data-testid="storyPublishDate">Jan 18, 2023</span></div></span></div></span></div></div></div><div class="ab dq kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku"><div class="h k w gg gh q"><div class="lk l"><div class="ab q ll lm"><div class="pw-multi-vote-icon gj ln lo lp lq"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Feb2f0aad6ec8&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---header_actions--eb2f0aad6ec8---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lr ap ls lt lu lv an lw lx ly lq"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lz ma mb mc md me mf"><p class="bf b ew z cl"><span class="mg">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ap lr mj mk ab q gk ml mm" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mi"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b ew z cl"><span class="pw-responses-count mh mi">1</span></p></button></div></div></div><div class="ab q kv kw kx ky kz la lb lc ld le lf lg lh li lj"><div class="mn k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb2f0aad6ec8&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;source=---header_actions--eb2f0aad6ec8---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cl mo" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="gd mp dp"><div class="l ae"><div class="ab dd"><div class="mq mr ms mt mu mv dk bh"><div class="ab"><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="ag gk ai aj ak al am mw ao ap aq fx mx my mm mz na nb nc nd s ne nf ng nh ni nj nk u nl nm nn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cl">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ag gk ai aj ak al am mw ao ap aq fx mx my mm mz na nb nc nd s ne nf ng nh ni nj nk u nl nm nn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cl">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="f289" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Hello there, welcome back to another block post. To my disappointment, it has been a while. Life can be very busy. But I am happy to be back. This time, with a rather “small” story about a malware reverse engineering safari, which started around 4 days ago and got so interesting, that I thought I should share it.</p></div></div></div><div class="ab dd ok ol om on" role="separator"><span class="oo by bm op oq or"></span><span class="oo by bm op oq or"></span><span class="oo by bm op oq"></span></div><div class="hm hn ho hp hq"><div class="ab dd"><div class="dk bh gy gz ha hb"><p id="ee0b" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">It all started back on Saturday, 14 January 2023 on Twitter, where I received a direct message from a fellow security researcher <a class="ag jz" href="https://twitter.com/grep_security" rel="noopener ugc nofollow" target="_blank">grep_security</a>.</p><p id="0a11" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">He had seen my post about the <a class="ag jz" href="https://github.com/Gi7w0rm/MalwareConfigLists/tree/main/Raccoon_v2" rel="noopener ugc nofollow" target="_blank">Raccoonv2 C2 list</a> which I had shared the day before and observed an IP in the list, which was right in the neighborhood of an IP he had observed for some time.</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div class="os ot ou"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qoV_U7s79X-b3PfWC6AnXg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qoV_U7s79X-b3PfWC6AnXg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qoV_U7s79X-b3PfWC6AnXg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qoV_U7s79X-b3PfWC6AnXg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qoV_U7s79X-b3PfWC6AnXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qoV_U7s79X-b3PfWC6AnXg.png 1100w, https://miro.medium.com/v2/resize:fit:794/format:webp/1*qoV_U7s79X-b3PfWC6AnXg.png 794w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 397px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qoV_U7s79X-b3PfWC6AnXg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qoV_U7s79X-b3PfWC6AnXg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qoV_U7s79X-b3PfWC6AnXg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qoV_U7s79X-b3PfWC6AnXg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qoV_U7s79X-b3PfWC6AnXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qoV_U7s79X-b3PfWC6AnXg.png 1100w, https://miro.medium.com/v2/resize:fit:794/1*qoV_U7s79X-b3PfWC6AnXg.png 794w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 397px"/><img alt="" class="bh mv pb c" width="397" height="319" loading="eager" role="presentation"/></picture></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 1 - The message that got it all started</figcaption></figure><p id="9640" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Curious, I took a look at the IP he shared. The Url led to the following Directory Listing, which at the time of writing is still up and running:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot pg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*N7pDV_ToU5af1ycLbK3uIg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*N7pDV_ToU5af1ycLbK3uIg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*N7pDV_ToU5af1ycLbK3uIg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*N7pDV_ToU5af1ycLbK3uIg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*N7pDV_ToU5af1ycLbK3uIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*N7pDV_ToU5af1ycLbK3uIg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N7pDV_ToU5af1ycLbK3uIg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*N7pDV_ToU5af1ycLbK3uIg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*N7pDV_ToU5af1ycLbK3uIg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*N7pDV_ToU5af1ycLbK3uIg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*N7pDV_ToU5af1ycLbK3uIg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*N7pDV_ToU5af1ycLbK3uIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*N7pDV_ToU5af1ycLbK3uIg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*N7pDV_ToU5af1ycLbK3uIg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="560" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 2 — OpenDir with “log_data”</figcaption></figure><p id="1b84" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Well, it was not Raccoon_v2. But I was immediately convinced it was something bad. I had seen such folders before with so-called <a class="ag jz" href="https://medium.com/@gi7w0rm/what-is-stealer-malware-65fd7c29516a" rel="noopener">stealer malware</a>. The likes of <a class="ag jz" href="https://malpedia.caad.fkie.fraunhofer.de/details/win.mars_stealer" rel="noopener ugc nofollow" target="_blank">Mars Stealer</a> and <a class="ag jz" href="https://malpedia.caad.fkie.fraunhofer.de/details/win.agent_tesla" rel="noopener ugc nofollow" target="_blank">AgentTesla</a> are often found to have logs stored similarly. My interest was sparked and so I decided to take a deeper dig.</p><p id="c8b8" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">First some reconnaissance about the IP:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot pl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ICqXq34TbXq-TTkn5qxxwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ICqXq34TbXq-TTkn5qxxwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ICqXq34TbXq-TTkn5qxxwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ICqXq34TbXq-TTkn5qxxwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ICqXq34TbXq-TTkn5qxxwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ICqXq34TbXq-TTkn5qxxwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ICqXq34TbXq-TTkn5qxxwQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ICqXq34TbXq-TTkn5qxxwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ICqXq34TbXq-TTkn5qxxwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ICqXq34TbXq-TTkn5qxxwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ICqXq34TbXq-TTkn5qxxwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ICqXq34TbXq-TTkn5qxxwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ICqXq34TbXq-TTkn5qxxwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ICqXq34TbXq-TTkn5qxxwQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="566" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 3 — OTX results for IP</figcaption></figure><p id="3e26" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">As you can see the IP in question seems to be from a hosting network in Kazakhstan. And if you look at the domain associated, you will see there are quite a lot of words and patterns belonging to cryptocurrencies and the crypto ökosystem. “.exchange” domains, “/airdrop/” as path names, “layer zero” and “network” in one domain, etc. All with some sort of Typosquatting. This smelled phishy.</p><p id="d809" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">And indeed, grep_security noticed that the whole /24 Subnet seems to be related to this kind of suspicious activity. Besides, there are several reported C2s for Infostealer malware in this Subnet. Among them RedLine, Raccoon, and others.</p><p id="b534" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">But neither RedLine nor Raccoon has the kind of OpenDir pattern we observed above. So let&#x27;s find out if there is malware related to our IP:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot pm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Kt4gsULAihFmT-avWuxhFw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Kt4gsULAihFmT-avWuxhFw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Kt4gsULAihFmT-avWuxhFw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Kt4gsULAihFmT-avWuxhFw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Kt4gsULAihFmT-avWuxhFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Kt4gsULAihFmT-avWuxhFw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kt4gsULAihFmT-avWuxhFw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Kt4gsULAihFmT-avWuxhFw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Kt4gsULAihFmT-avWuxhFw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Kt4gsULAihFmT-avWuxhFw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Kt4gsULAihFmT-avWuxhFw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Kt4gsULAihFmT-avWuxhFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Kt4gsULAihFmT-avWuxhFw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Kt4gsULAihFmT-avWuxhFw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="656" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 4 — VirusTotal result (3rd sample was uploaded after initial analysis)</figcaption></figure><p id="cbcd" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">As you can see, 2 samples were observed reaching out to this IP:</p><p id="c5be" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Sample1: <a class="ag jz" href="https://www.virustotal.com/gui/file/88b426437c97301982bf096306af1bde70caa0a9a99a60514b31d0fa0ea64afd" rel="noopener ugc nofollow" target="_blank">https://www.virustotal.com/gui/file/88b426437c97301982bf096306af1bde70caa0a9a99a60514b31d0fa0ea64afd</a><br/>Sample2: <a class="ag jz" href="https://www.virustotal.com/gui/file/8a94861424eac30e36085d408100510a9af570f6dd61a4c633d7e918e4317548" rel="noopener ugc nofollow" target="_blank">https://www.virustotal.com/gui/file/8a94861424eac30e36085d408100510a9af570f6dd61a4c633d7e918e4317548</a></p><p id="8948" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">For the remaining article, we will be looking at Sample 1.</p><p id="c1d3" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">First thing I always do: Detonate it in Trai.ge!</p><div class="pn po pp pq pr ps"><a href="https://tria.ge/230114-vst3maah74/behavioral2?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pt ab ce"><div class="pu ab cg dd dc pv"><h2 class="bf hu ju z cq pw cs ct px cv cx hs bk">Behavioral Report</h2><div class="py l"><h3 class="bf b ju z cq pw cs ct px cv cx cl">Have a look at the Hatching Triage automated malware analysis report for this sample, with a score of 10 out of 10.</h3></div><div class="pz l"><p class="bf b ew z cq pw cs ct px cv cx cl">tria.ge</p></div></div></div></a></div><p id="1ce4" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">As you can see, it lights up like a Christmas tree. A collection of interesting artifacts can be observed in the following image. Note that the Pastebin link shows a single IP which is called via TCP after resolution. Also, note the TCP Port 15647 and the “PowerShell get-process” calls for “avastui” and “avgui”. It will help to do attribution later on.</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FFO-DwRXCa4VTFqOdEpv0A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FFO-DwRXCa4VTFqOdEpv0A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FFO-DwRXCa4VTFqOdEpv0A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FFO-DwRXCa4VTFqOdEpv0A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FFO-DwRXCa4VTFqOdEpv0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FFO-DwRXCa4VTFqOdEpv0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FFO-DwRXCa4VTFqOdEpv0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FFO-DwRXCa4VTFqOdEpv0A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FFO-DwRXCa4VTFqOdEpv0A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FFO-DwRXCa4VTFqOdEpv0A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FFO-DwRXCa4VTFqOdEpv0A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FFO-DwRXCa4VTFqOdEpv0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FFO-DwRXCa4VTFqOdEpv0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FFO-DwRXCa4VTFqOdEpv0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="469" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 6 — IoC Collection — Interesting artifacts marked in Red Circles</figcaption></figure><p id="0e70" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Another interesting thing is the legitimate jsc.exe which is part of the .Net Framework behaves very strangely here, calling out to Pastebin, as well as to the 2 possible C2 Servers.</p><p id="5baa" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">At this point, I decided to take a closer look at Sample 1. And before anything else, I uploaded it to<a class="ag jz" href="https://www.unpac.me/results/8b910cb5-0dce-4110-a15b-a193d92be576#/" rel="noopener ugc nofollow" target="_blank"> unpac.me</a> in the hopes of some easy unpacking. And indeed, there were 3 samples unpacked:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rjDs9Nels9WiNcIoG2pC_g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rjDs9Nels9WiNcIoG2pC_g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rjDs9Nels9WiNcIoG2pC_g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rjDs9Nels9WiNcIoG2pC_g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rjDs9Nels9WiNcIoG2pC_g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rjDs9Nels9WiNcIoG2pC_g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjDs9Nels9WiNcIoG2pC_g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*rjDs9Nels9WiNcIoG2pC_g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rjDs9Nels9WiNcIoG2pC_g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rjDs9Nels9WiNcIoG2pC_g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rjDs9Nels9WiNcIoG2pC_g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rjDs9Nels9WiNcIoG2pC_g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rjDs9Nels9WiNcIoG2pC_g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*rjDs9Nels9WiNcIoG2pC_g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="375" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 7 — 3 Binaries extracted from Sample1</figcaption></figure><p id="5ec1" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">As you can see, we are looking at 1 unknown PE file and 2 legitimate Microsoft-signed binaries. One is psapi.dll and the other cachmgr.exe</p><p id="b73a" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Sadly, my reversing capabilities do not include Assembly yet, so this is where I ran into a dilemma. I had no idea what the unknown binary was doing and therefore I was at a dead end.</p><p id="39e5" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">But there was more to this attack. So I just jumped this step and decided to look at the next step. As you can see in Figure 6, after our malicious Sample gets executed, a folder named “SETUP_37419&quot; is created in the Users Temp folder. From there, Engine.exe gets executed, and shortly after we see a command-line task started with “cmd.exe /c cmd &lt; 4”. Well, time to take a look at that folder and its contents:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eO-KZYH5cGYcsdts7K2pLw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eO-KZYH5cGYcsdts7K2pLw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eO-KZYH5cGYcsdts7K2pLw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eO-KZYH5cGYcsdts7K2pLw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eO-KZYH5cGYcsdts7K2pLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eO-KZYH5cGYcsdts7K2pLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eO-KZYH5cGYcsdts7K2pLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*eO-KZYH5cGYcsdts7K2pLw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eO-KZYH5cGYcsdts7K2pLw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eO-KZYH5cGYcsdts7K2pLw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eO-KZYH5cGYcsdts7K2pLw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eO-KZYH5cGYcsdts7K2pLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eO-KZYH5cGYcsdts7K2pLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*eO-KZYH5cGYcsdts7K2pLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="204" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 8 — Setup Folder Content</figcaption></figure><p id="9291" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">This is where things start to get more interesting because I can understand what I am seeing. 2 Images, 1 Executable, a .qsp file, and a Setup.txt file. At this time I didn’t know what a .qsp file is, so let&#x27;s take a look at it with a text editor:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ISKaY0B_tuaDRudrzAHjlA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ISKaY0B_tuaDRudrzAHjlA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ISKaY0B_tuaDRudrzAHjlA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ISKaY0B_tuaDRudrzAHjlA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ISKaY0B_tuaDRudrzAHjlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ISKaY0B_tuaDRudrzAHjlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ISKaY0B_tuaDRudrzAHjlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ISKaY0B_tuaDRudrzAHjlA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ISKaY0B_tuaDRudrzAHjlA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ISKaY0B_tuaDRudrzAHjlA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ISKaY0B_tuaDRudrzAHjlA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ISKaY0B_tuaDRudrzAHjlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ISKaY0B_tuaDRudrzAHjlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ISKaY0B_tuaDRudrzAHjlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="750" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 9 — .qsp content</figcaption></figure><p id="691f" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">That&#x27;s a lucky hit. What we can learn from here is that the file seems associated with <a class="ag jz" href="https://www.pantaray.com/qsetup.html" rel="noopener ugc nofollow" target="_blank">QSetup</a>. The qsp file contains all instructions needed so that Engine.exe knows what it should execute on the System. It&#x27;s even mentioned on the bottom of their webpage as the software used to execute on the Customers device. Uploading <a class="ag jz" href="https://www.virustotal.com/gui/file/e6e73497e85e9ece4c92ac7d49e07b9d55e932ba2d9e5789b94b95a9841ee524/details" rel="noopener ugc nofollow" target="_blank">Engine.exe to VirusTotal</a> also further confirms this theory. Furthermore, we see that the Directory “Temp/5col3ccv. tda/” is referenced. Also, a list of Items is given: “.\45”,”.\4”, and “.\7”. This also explains what our cmd command means:</p><p id="81a9" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">“cmd /c cmd &lt; 4&quot; will probably execute whatever is contained in the file named 4.</p><p id="05d2" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">The other 3 files, the 2 .bmp files, and the Setup.txt file are not very interesting. Both images are resources of the installer and the Setup.txt has the same content as the .qsp but in a different format.</p><p id="7750" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">So next, let&#x27;s take a look at the folder mentioned in the .qsp file:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*OzAIqCKUMfPu_QOR3A2pcw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*OzAIqCKUMfPu_QOR3A2pcw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*OzAIqCKUMfPu_QOR3A2pcw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*OzAIqCKUMfPu_QOR3A2pcw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*OzAIqCKUMfPu_QOR3A2pcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OzAIqCKUMfPu_QOR3A2pcw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzAIqCKUMfPu_QOR3A2pcw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*OzAIqCKUMfPu_QOR3A2pcw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*OzAIqCKUMfPu_QOR3A2pcw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*OzAIqCKUMfPu_QOR3A2pcw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*OzAIqCKUMfPu_QOR3A2pcw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*OzAIqCKUMfPu_QOR3A2pcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*OzAIqCKUMfPu_QOR3A2pcw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*OzAIqCKUMfPu_QOR3A2pcw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="194" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 10–5col3ccv.tda Folder Content after Execution</figcaption></figure><p id="c1f0" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">If you are wondering where “.\7&quot; is, we will get there. It gets changed during the Install process. But let&#x27;s look at “./4” which is executed by cmd.</p><p id="f400" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Upon opening it, we are greeted by tons of gibberish:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BHoUz_0wJ9jwYhNMs9yePA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BHoUz_0wJ9jwYhNMs9yePA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BHoUz_0wJ9jwYhNMs9yePA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BHoUz_0wJ9jwYhNMs9yePA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BHoUz_0wJ9jwYhNMs9yePA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BHoUz_0wJ9jwYhNMs9yePA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHoUz_0wJ9jwYhNMs9yePA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BHoUz_0wJ9jwYhNMs9yePA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BHoUz_0wJ9jwYhNMs9yePA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BHoUz_0wJ9jwYhNMs9yePA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BHoUz_0wJ9jwYhNMs9yePA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BHoUz_0wJ9jwYhNMs9yePA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BHoUz_0wJ9jwYhNMs9yePA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*BHoUz_0wJ9jwYhNMs9yePA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="264" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 11 — Obfuscated CMD commands</figcaption></figure><p id="f2ee" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">But if you look at it closer you will notice that most of it is trash code, which is included to confuse and only some of the Lines contain valid code. Basically, a String replacement where Set &lt;very_long_random_string&gt; = Char.</p><p id="2b75" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">After deobfuscating this, we get the following lines of cmd commands:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*83EE9QyHXJtjLoPlJXOnaA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*83EE9QyHXJtjLoPlJXOnaA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*83EE9QyHXJtjLoPlJXOnaA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*83EE9QyHXJtjLoPlJXOnaA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*83EE9QyHXJtjLoPlJXOnaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*83EE9QyHXJtjLoPlJXOnaA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*83EE9QyHXJtjLoPlJXOnaA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*83EE9QyHXJtjLoPlJXOnaA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*83EE9QyHXJtjLoPlJXOnaA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*83EE9QyHXJtjLoPlJXOnaA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*83EE9QyHXJtjLoPlJXOnaA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*83EE9QyHXJtjLoPlJXOnaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*83EE9QyHXJtjLoPlJXOnaA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*83EE9QyHXJtjLoPlJXOnaA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="113" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 12 — Deobfuscated CMD commands</figcaption></figure><p id="212d" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Let&#x27;s try to understand the above script. The first thing that comes to the eye is the search for processes called “avastui” and “avgui” using the PowerShell get-process scriptlet. Both processes belong to the Avast AntiVirus Suite. If the Processes should be running, the script sets the Variable Champion.exe.pif to AutoIT3.exe, and the file ending of the file named “S” to “S.a3x”. This already foreshadows the next stage of this attack. Then, the Script creates a randomly named directory (in Figure 10 you see it as 17473). It creates a file called Champion.exe.pif (Or AutoIt3, if Avast was found) in this random folder and pipes MZ into it. Then it searches a certain String in the file named “45”. If we look at “45&quot; in a HexEditor, we see a bunch of binary data, where the string that is searched via findstr is appended to the beginning. The flags /V and /R let findstr ignore the string and pipe everything except it into the newly created file. Note the “&gt;&gt;” which will append the content rather than overwriting it. The outcome? A perfectly valid PE file, which after some <a class="ag jz" href="https://www.virustotal.com/gui/file/237d1bca6e056df5bb16a1216a434634109478f882d3b1d58344c801d184f95d/detection" rel="noopener ugc nofollow" target="_blank">investigation</a> proves to be a legitimate AutoIT3 executable.<br/>The script then moves the file “7” into the same random directory where the AutoIT3 executable called Champion.exe.pif is. Thereby it gets renamed to “S” or “S.a3x” depending on the AvastDetection. After that, “Champion.exe.pif” executes “S”. A ping to localhost is executed, probably to give the execution some time before the PowerShell script dies.</p><p id="efef" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">So our next goal is obvious: What exactly is “S” or “S.a3x”? And what does it do?</p><p id="d5f0" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Well, we know already it&#x27;s probably an AutoIT Script. We also know there will be an execution of “jsc.exe” next. But at the time I had no idea of the AutoIT file format. So after looking at the “S” file and realizing I could not read anything in it because of the obfuscation, I decided to call for help via Twitter:</p><figure class="ov ow ox oy oz pa"><div class="qh cq l gj"><div class="qi qj l"></div></div></figure><p id="10b0" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">At that time I thought I was facing a “.a3x” file, so I thought it had been compiled in some way. Even after looking at “S” in a Text Editor, I had just understood gibberish and therefore I saw my fears come true. However, some hours after this tweet I realized, that I was looking at a highly obfuscated “.au3&quot; file. Other than “.a3x”, “.au3” is not compiled but a readable script. Still, the obfuscation was so strong that I wasn’t mad when some people started reacting to my post, telling me they would like to take a look at it.</p><blockquote class="qk ql qm"><p id="4ab6" class="no np qn nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">At this point, I would like to give a huge thanks and shoutout to <a class="ag jz" href="https://twitter.com/Hexacorn" rel="noopener ugc nofollow" target="_blank">Hexacorn</a>, <a class="ag jz" href="https://twitter.com/_EthicalChaos_" rel="noopener ugc nofollow" target="_blank">_EthicalChaos_</a>, <a class="ag jz" href="https://twitter.com/_theVIVI" rel="noopener ugc nofollow" target="_blank">_theVIVI</a>, <a class="ag jz" href="https://twitter.com/DidierStevens/" rel="noopener ugc nofollow" target="_blank">DidierStevens</a>, <a class="ag jz" href="https://twitter.com/richeyward" rel="noopener ugc nofollow" target="_blank">richeyward</a>, <a class="ag jz" href="https://twitter.com/luc4m" rel="noopener ugc nofollow" target="_blank">luc4m</a>, and especially <a class="ag jz" href="https://twitter.com/dr4k0nia" rel="noopener ugc nofollow" target="_blank">dr4k0nia</a> (who solved the riddle), because all stepped forward voluntarily in the last days, to help with this ! I really appreciate seeing so many researchers who are willing to help and I am honored to have such a nice community on Twitter!</p></blockquote><p id="7f46" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">So what did I look at? Here is a little extract.</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Gp1Gt92PuWf_UQkKGtkz1g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Gp1Gt92PuWf_UQkKGtkz1g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Gp1Gt92PuWf_UQkKGtkz1g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Gp1Gt92PuWf_UQkKGtkz1g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Gp1Gt92PuWf_UQkKGtkz1g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Gp1Gt92PuWf_UQkKGtkz1g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gp1Gt92PuWf_UQkKGtkz1g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Gp1Gt92PuWf_UQkKGtkz1g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Gp1Gt92PuWf_UQkKGtkz1g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Gp1Gt92PuWf_UQkKGtkz1g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Gp1Gt92PuWf_UQkKGtkz1g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Gp1Gt92PuWf_UQkKGtkz1g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Gp1Gt92PuWf_UQkKGtkz1g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Gp1Gt92PuWf_UQkKGtkz1g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="294" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 13 — Obfuscated AutoIT Script</figcaption></figure><p id="b696" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">The script had 10255 lines in this style, the only thing sticking out was a blog of Hex data. It has to be noted that the script had 0/64 detections at the time of submitting it to VT.</p><p id="b603" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">I tried to extract the Hex Block and convert it to a binary, as this would be a common way of embedding a binary into a script file. However, I had no success.</p><p id="d72c" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Luckily, others had more luck:</p><p id="bde5" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Both dr4konia and _EthicalChaos_ came up with a <a class="ag jz" href="https://twitter.com/dr4k0nia/status/1614691627376730112" rel="noopener ugc nofollow" target="_blank">decryption method </a>working the same as the “DoctrineDrama” in Figure13 which spans through the whole script:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div class="os ot qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BMM1VTVQmLowitDaKSAmFg.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BMM1VTVQmLowitDaKSAmFg.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BMM1VTVQmLowitDaKSAmFg.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BMM1VTVQmLowitDaKSAmFg.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BMM1VTVQmLowitDaKSAmFg.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BMM1VTVQmLowitDaKSAmFg.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1302/format:webp/1*BMM1VTVQmLowitDaKSAmFg.jpeg 1302w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 651px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BMM1VTVQmLowitDaKSAmFg.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*BMM1VTVQmLowitDaKSAmFg.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*BMM1VTVQmLowitDaKSAmFg.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*BMM1VTVQmLowitDaKSAmFg.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*BMM1VTVQmLowitDaKSAmFg.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*BMM1VTVQmLowitDaKSAmFg.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1302/1*BMM1VTVQmLowitDaKSAmFg.jpeg 1302w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 651px"/><img alt="" class="bh mv pb c" width="651" height="242" loading="lazy" role="presentation"/></picture></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 14 — Decryption Funktion</figcaption></figure><p id="3779" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">With the help of this function, Hexacorn was able to produce the first script which was slightly less obfuscated. However, it was still full of string replacements, which made it nearly unreadable. If you want to look at this and would like a little headstart, check out his version <a class="ag jz" href="https://tria.ge/230115-zbheqafh3x" rel="noopener ugc nofollow" target="_blank">here</a>. I uploaded it to Triage as means of a file transfer.</p><p id="5f37" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">As you can see, the parts deobfuscated are function calls and imported libraries. This did give further proof of a possible process injection through Process Hollowing:</p><figure class="ov ow ox oy oz pa"><div class="qh cq l gj"><div class="qi qj l"></div></div></figure><p id="134d" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">As initially expected, the AutoIT script injected some code into the legitimate “jsc.exe”. This code was then responsible to conduct the malicious activity. Besides, the script was also responsible for the initial DNS Query that was observed.</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Ug8mjvuQGiN1vR-EwcWk9w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ug8mjvuQGiN1vR-EwcWk9w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Ug8mjvuQGiN1vR-EwcWk9w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ug8mjvuQGiN1vR-EwcWk9w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Ug8mjvuQGiN1vR-EwcWk9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ug8mjvuQGiN1vR-EwcWk9w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ug8mjvuQGiN1vR-EwcWk9w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Ug8mjvuQGiN1vR-EwcWk9w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Ug8mjvuQGiN1vR-EwcWk9w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Ug8mjvuQGiN1vR-EwcWk9w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Ug8mjvuQGiN1vR-EwcWk9w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Ug8mjvuQGiN1vR-EwcWk9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Ug8mjvuQGiN1vR-EwcWk9w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Ug8mjvuQGiN1vR-EwcWk9w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="16" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 15 — Weird Ping</figcaption></figure><p id="8bd5" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">It was probably implemented for execution control.</p><p id="b41c" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Sadly, the AutoIT script proved to be too bulletproof to fully reverse it. Until now, none of the researchers that took a look at it were able to archive full deobfuscation. (Please notify me if you should manage to do it, and I will gladly add an Update to this post.)</p><p id="0cba" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">However, after a while, <a class="ag jz" href="https://twitter.com/dr4k0nia" rel="noopener ugc nofollow" target="_blank">dr4k0nia</a> was able to dump the final payload!</p><p id="7c51" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">I saw this as a big breakthrough, as we were able to dump the final stage of this attack, a .Net binary with the Sha-256 Hash: “<a class="ag jz" href="https://bazaar.abuse.ch/sample/a835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910/" rel="noopener ugc nofollow" target="_blank">a835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910</a>&quot;</p><p id="c02a" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">However, we soon learned that the binary was strongly obfuscated using flow-dependent mutations and flow-dependent variables which made the important parts nearly unreadable. However, upon opening the file in DNSpy, some important functions could be recovered, which made it possible to determine the nature of the file:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*98jNxblgHpg4rf7PkcfFnA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*98jNxblgHpg4rf7PkcfFnA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*98jNxblgHpg4rf7PkcfFnA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*98jNxblgHpg4rf7PkcfFnA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*98jNxblgHpg4rf7PkcfFnA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*98jNxblgHpg4rf7PkcfFnA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*98jNxblgHpg4rf7PkcfFnA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*98jNxblgHpg4rf7PkcfFnA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*98jNxblgHpg4rf7PkcfFnA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*98jNxblgHpg4rf7PkcfFnA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*98jNxblgHpg4rf7PkcfFnA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*98jNxblgHpg4rf7PkcfFnA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*98jNxblgHpg4rf7PkcfFnA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*98jNxblgHpg4rf7PkcfFnA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="1122" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 16 — Stealer == True</figcaption></figure><p id="921b" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">From the function names and some other artifacts, it&#x27;s clear that we are looking at a Credential Stealer. It fingerprints the system and then steals as much sensitive data as possible. Just as we expected.</p><p id="63fe" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">We also see the creation of a TCP Client, which is used for C2 Communication:</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vnbhKmbHJeh6ds8I2LCkHg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vnbhKmbHJeh6ds8I2LCkHg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vnbhKmbHJeh6ds8I2LCkHg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vnbhKmbHJeh6ds8I2LCkHg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vnbhKmbHJeh6ds8I2LCkHg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vnbhKmbHJeh6ds8I2LCkHg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vnbhKmbHJeh6ds8I2LCkHg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vnbhKmbHJeh6ds8I2LCkHg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vnbhKmbHJeh6ds8I2LCkHg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vnbhKmbHJeh6ds8I2LCkHg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vnbhKmbHJeh6ds8I2LCkHg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vnbhKmbHJeh6ds8I2LCkHg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vnbhKmbHJeh6ds8I2LCkHg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*vnbhKmbHJeh6ds8I2LCkHg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="675" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 17 — TCP Client</figcaption></figure><p id="9196" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">A <a class="ag jz" href="https://pastebin.com/raw/pjBNEQDw" rel="noopener ugc nofollow" target="_blank">string dump</a> was released by dr4konia. A slightly cleaned-up version by me can be found <a class="ag jz" href="https://github.com/Gi7w0rm/MalwareConfigLists/blob/main/strings_dump/Arechclient2.txt" rel="noopener ugc nofollow" target="_blank">here</a>. It further proves the malicious nature of this binary.</p><p id="751e" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">As we can’t fully deobfuscate the binary, we can not fully prove what Stealer this is. However, based on several artifacts, I do believe we are dealing with a highly obfuscated Version of Arechclient2/Sectop_Rat.</p><p id="b495" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">First, ArechClient2 Detections which are based on the TCP Connection Init by ArechClient2 did hit on <a class="ag jz" href="https://www.virustotal.com/gui/file/a835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910/behavior" rel="noopener ugc nofollow" target="_blank">VirusTotal</a>. Second, <a class="ag jz" href="https://bazaar.abuse.ch/sample/a835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910/#intel" rel="noopener ugc nofollow" target="_blank">MalwareBazaar</a> also identifies it as ArechClient2. <a class="ag jz" href="https://vxhive.blogspot.com/2021/01/deep-dive-into-sectoprat.html" rel="noopener ugc nofollow" target="_blank">Prior Analysis</a> of this threat has shown very similar TTP: A connection via TCP/IP, a Connection to Port 15647, JSON-based communication, a connection attempt to eth0[.]me, even the Strings observed in the string dump by dr4konia, all align with this threat.</p><figure class="ov ow ox oy oz pa os ot paragraph-image"><div role="button" tabindex="0" class="ph pi gj pj bh pk"><div class="os ot qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZDsGXzXHAX5BUcUHq0n2hg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZDsGXzXHAX5BUcUHq0n2hg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZDsGXzXHAX5BUcUHq0n2hg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZDsGXzXHAX5BUcUHq0n2hg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZDsGXzXHAX5BUcUHq0n2hg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZDsGXzXHAX5BUcUHq0n2hg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDsGXzXHAX5BUcUHq0n2hg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZDsGXzXHAX5BUcUHq0n2hg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZDsGXzXHAX5BUcUHq0n2hg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZDsGXzXHAX5BUcUHq0n2hg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZDsGXzXHAX5BUcUHq0n2hg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZDsGXzXHAX5BUcUHq0n2hg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZDsGXzXHAX5BUcUHq0n2hg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZDsGXzXHAX5BUcUHq0n2hg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mv pb c" width="700" height="169" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pc gf pd os ot pe pf bf b bg z cl">Figure 18 — Old analysis left, our analysis string dump right</figcaption></figure><p id="14d3" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">So, the reversing is done, the Threat is identified, and we are done, right?</p><p id="0119" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Well, not fully, there is some more info I would like to add.</p><p id="4955" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">First of all, my initial goal in this analysis besides the identification of the threat was to decrypt the log data accessible in the Open Directory mentioned in Figure 2. However, while dr4konia was able to uncover the AES Key used by our sample, it appears that the IV used is randomly generated and attached to the extracted data. This makes decryption of the data impossible.</p><p id="539a" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Secondly, I initially thought this threat was shared via a crypto scam attack, based on the URLs associated with our initial IP address (77.73.133.81). However, after further research, I discovered that the Execution Parent of our Sample is actually a file called “<a class="ag jz" href="https://www.virustotal.com/gui/file/0f83091af8806a425ef68a3db6373d48800066e59abec2545fffe3d9f2fac988/detection" rel="noopener ugc nofollow" target="_blank">obs-installer-setupx64–29.685.zip</a>”.</p><p id="447c" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">This shows that the sample is probably shared through one of the many Google Ads Campaigns which are currently ongoing, where threat actors register malicious websites, make them appear like official software pages, and then lure victims into downloading malicious software. These pages are often advertised through Google Ad Campaigns, allowing the Threat Actors to place their malicious sites right at the top of Google Searches for the Software Product in question. And these campaigns prove to be successful. The OpenDirectory with the alleged LogData contained 18.158 individual files, meaning this actor alone has likely hacked more than 18000 victims.<br/>IT Security Researcher <a class="ag jz" href="https://twitter.com/1ZRR4H" rel="noopener ugc nofollow" target="_blank">Germán Fernández</a> also noticed this connection and found <a class="ag jz" href="https://twitter.com/1ZRR4H/status/1615231876817362944" rel="noopener ugc nofollow" target="_blank">70 domains associated with this threat</a>.</p></div></div></div><div class="ab dd ok ol om on" role="separator"><span class="oo by bm op oq or"></span><span class="oo by bm op oq or"></span><span class="oo by bm op oq"></span></div><div class="hm hn ho hp hq"><div class="ab dd"><div class="dk bh gy gz ha hb"><p id="e50f" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Well, I will leave it here for today. If you have read until here, I am glad you made it. I want to take this opportunity to thank grep_security for reaching out with his question. It was a nice hunt and I am happy we made it. Thanks again to all the people who helped during this investigation.</p><p id="675a" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">If you haven&#x27;t, please follow <a class="ag jz" href="https://twitter.com/Gi7w0rm" rel="noopener ugc nofollow" target="_blank">my Twitter</a> for more awesome IT-Security content. Also follow <a class="ag jz" href="https://twitter.com/dr4k0nia" rel="noopener ugc nofollow" target="_blank">dr4k0nia</a>, <a class="ag jz" href="https://twitter.com/grep_security" rel="noopener ugc nofollow" target="_blank">grep_security</a>, and all the others mentioned above, they deserve it :)</p><p id="204d" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">For a list of IoC, please see <a class="ag jz" href="https://github.com/Gi7w0rm/MalwareConfigLists/blob/main/ArechClient2_SectopRat/TTPs.md" rel="noopener ugc nofollow" target="_blank">this file on Github</a>.</p><p id="7169" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Until next time!</p><p id="d005" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Cheers</p><p id="ebeb" class="pw-post-body-paragraph no np ht nq b ir nr ns nt iu nu nv nw nx ny nz oa ob oc od oe of og oh oi oj hm bk">Update (05.02.2023):<br/><a class="ag jz" href="https://twitter.com/dr4k0nia/status/1622263504144142341" rel="noopener ugc nofollow" target="_blank">@dr4k0nia</a> followed up with her own blog on this topic. <br/>If you want to get more insights on how to reverse the AutoIt Script and the final .Net payload, check out: <a class="ag jz" href="https://dr4k0nia.github.io/posts/Analysing-a-sample-of-ArechClient2/" rel="noopener ugc nofollow" target="_blank">https://dr4k0nia.github.io/posts/Analysing-a-sample-of-ArechClient2/</a>.</p></div></div></div></div></section></div></div></article></div><div class="ab dd"><div class="dk bh gy gz ha hb"><div class="qu qv ab kc"><div class="py ab"><a class="qw ay an ap" href="https://medium.com/tag/infosec?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><div class="qx gj dy qy hd qz ra bf b bg z bk rb">Infosec</div></a></div><div class="py ab"><a class="qw ay an ap" href="https://medium.com/tag/reverse-engineering?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><div class="qx gj dy qy hd qz ra bf b bg z bk rb">Reverse Engineering</div></a></div><div class="py ab"><a class="qw ay an ap" href="https://medium.com/tag/ioc?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><div class="qx gj dy qy hd qz ra bf b bg z bk rb">Ioc</div></a></div><div class="py ab"><a class="qw ay an ap" href="https://medium.com/tag/malware?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><div class="qx gj dy qy hd qz ra bf b bg z bk rb">Malware</div></a></div><div class="py ab"><a class="qw ay an ap" href="https://medium.com/tag/stealer?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><div class="qx gj dy qy hd qz ra bf b bg z bk rb">Stealer</div></a></div></div></div></div><div class="l"></div><footer class="rc rd re rf rg ab q rh ri c"><div class="l ae"><div class="ab dd"><div class="dk bh gy gz ha hb"><div class="ab dq rj"><div class="ab q ll"><div class="rk l"><span class="l rl rm rn e d"><div class="ab q ll lm"><div class="pw-multi-vote-icon gj ln lo lp lq"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Feb2f0aad6ec8&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---footer_actions--eb2f0aad6ec8---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lr ap ls lt lu lv an lw lx ly lq"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lz ma mb mc md me mf"><p class="bf b ew z cl"><span class="mg">--</span></p></div></div></span><span class="l h g f ro rp"><div class="ab q ll lm"><div class="pw-multi-vote-icon gj ln lo lp lq"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Feb2f0aad6ec8&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---footer_actions--eb2f0aad6ec8---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lr ap ls lt lu lv an lw lx ly lq"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lz ma mb mc md me mf"><p class="bf b ew z cl"><span class="mg">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ap lr mj mk ab q gk ml mm" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mi"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z cl"><span class="pw-responses-count mh mi">1</span></p></button></div></div></div></div><div class="ab q"><div class="or l ce"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb2f0aad6ec8&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Fa-long-way-to-sectoprat-eb2f0aad6ec8&amp;source=---footer_actions--eb2f0aad6ec8---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cl mo" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="or l ce"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ag gk ai aj ak al am mw ao ap aq fx mx my mm mz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rq l"><div class="ab dd"><div class="dk bh gy gz ha hb"><div class="ab rr rs rt kb ka"><div class="ru rv rw rx ry rz sa sb sc sd ab dq"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--eb2f0aad6ec8---------------------------------------"><div class="l gj"><img alt="Gi7w0rm" class="l gd by jn jm dy" src="https://miro.medium.com/v2/resize:fill:96:96/1*XNZYIunppMSwHbb0Dxx3cA.png" width="48" height="48" loading="lazy"/><div class="gq by l jn jm gr n ay se"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--eb2f0aad6ec8---------------------------------------"><div class="l gj"><img alt="Gi7w0rm" class="l gd by sf sg dy" src="https://miro.medium.com/v2/resize:fill:128:128/1*XNZYIunppMSwHbb0Dxx3cA.png" width="64" height="64" loading="lazy"/><div class="gq by l sf sg gr n ay se"></div></div></a></div><div class="j i d sh ce"><div class="ab"><span><button class="bf b bg z si qx sj sk sl sm sn fv fw so sp sq ga gb gc gd bm ge gf">Follow</button></span></div></div></div><div class="ab cg dc"><div class="sr ss st su sv l"><a class="ag ah ai ak al am an ao ap aq ar as at au ab q" rel="noopener follow" href="/?source=post_page---post_author_info--eb2f0aad6ec8---------------------------------------"><h2 class="pw-author-name bf sx sy sz ta tb tc td nx te tf ob tg th of ti tj bk"><span class="hm sw">Written by <!-- -->Gi7w0rm</span></h2></a><div class="py ab jl"><div class="l ce"><span class="pw-follower-count bf b bg z cl"><a class="ag ah ai aj ak al am an ao ap aq ar as jw" rel="noopener follow" href="/followers?source=post_page---post_author_info--eb2f0aad6ec8---------------------------------------">222 Followers</a></span></div><div class="bf b bg z cl ab tk"><span class="jx l" aria-hidden="true"><span class="bf b bg z cl">·</span></span><a class="ag ah ai aj ak al am an ao ap aq ar as jw" rel="noopener follow" href="/following?source=post_page---post_author_info--eb2f0aad6ec8---------------------------------------">15 Following</a></div></div><div class="tl l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z si qx sj sk sl sm sn fv fw so sp sq ga gb gc gd bm ge gf">Follow</button></span></div></div></div></div></div></div><div class="tm tn to tp tq l"><div class="tr bh r rq"></div><div class="ab dd"><div class="dk bh gy gz ha hb"><div class="ab q dq"><h2 class="bf sx ts it tt tu iw tv tw tx ty tz ua ub uc ud ue bk">Responses (<!-- -->1<!-- -->)</h2><div class="ab uf"><div><div class="bm" aria-hidden="false"><a class="ug uh" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--eb2f0aad6ec8---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="ui uj uk ul um un uo l"></div><div class="ok l"><button class="bf b bg z bk qx up uq ur mo ml sn fv fw fx us ut uu ga uv uw ux uy uz gb gc gd bm ge gf">See all responses</button></div></div></div></div><div class="va vb vc vd ve l bx"><div class="h k j"><div class="tr bh vf vg"></div><div class="ab dd"><div class="dk bh gy gz ha hb"><div class="cf ab ll kc"><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://help.medium.com/hc/en-us?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Help</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.statuspage.io/?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Status</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/about?autoplay=1&amp;source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">About</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Careers</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b ew z cl">Press</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://blog.medium.com/?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Blog</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Privacy</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Terms</p></a></div><div class="vh vi l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://speechify.com/medium?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Text to speech</p></a></div><div class="vh l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/business?source=post_page-----eb2f0aad6ec8---------------------------------------" rel="noopener follow"><p class="bf b ew z cl">Teams</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250321-185756-9fdacb4792"</script><script>window.__GRAPHQL_URI__ = "https://gi7w0rm.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-eb2f0aad6ec8","user-fa7639fc99f0"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"fa7639fc99f0","explicit":true},"viewerIsBot":false},"debug":{"requestId":"80e3ea2b-746f-43bd-9c3d-a7e832b30b2b","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-902f1079f8dd6b425b05a977007487b9-d958579295cc57b1-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fgi7w0rm.medium.com\u002Fa-long-way-to-sectoprat-eb2f0aad6ec8","host":"gi7w0rm.medium.com","hostname":"gi7w0rm.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250321-185756-9fdacb4792","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250321-185756-9fdacb4792","commit":"9fdacb479277063c0b49fecbf56184af2ff2f6d0"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"gi7w0rm.medium.com\"})":null,"postResult({\"id\":\"eb2f0aad6ec8\"})":{"__ref":"Post:eb2f0aad6ec8"}},"LinkedAccounts:fa7639fc99f0":{"__typename":"LinkedAccounts","mastodon":null,"id":"fa7639fc99f0"},"User:fa7639fc99f0":{"__typename":"User","id":"fa7639fc99f0","linkedAccounts":{"__ref":"LinkedAccounts:fa7639fc99f0"},"isSuspended":false,"name":"Gi7w0rm","imageId":"1*XNZYIunppMSwHbb0Dxx3cA.png","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"gi7w0rm.medium.com"}},"hasSubdomain":true,"username":"gi7w0rm","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":222,"followingCount":14,"collectionFollowingCount":1},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:fa7639fc99f0-viewerId:lo_310b51045dbd"},"twitterScreenName":"Gi7w0rm"},"Paragraph:e72c9d069a20_0":{"__typename":"Paragraph","id":"e72c9d069a20_0","name":"e588","type":"H3","href":null,"layout":null,"metadata":null,"text":"A long way to SectopRat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_1":{"__typename":"Paragraph","id":"e72c9d069a20_1","name":"2e5a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Investigating a highly obfuscated stealer sample","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_2":{"__typename":"Paragraph","id":"e72c9d069a20_2","name":"f289","type":"P","href":null,"layout":null,"metadata":null,"text":"Hello there, welcome back to another block post. To my disappointment, it has been a while. Life can be very busy. But I am happy to be back. This time, with a rather “small” story about a malware reverse engineering safari, which started around 4 days ago and got so interesting, that I thought I should share it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_3":{"__typename":"Paragraph","id":"e72c9d069a20_3","name":"ee0b","type":"P","href":null,"layout":null,"metadata":null,"text":"It all started back on Saturday, 14 January 2023 on Twitter, where I received a direct message from a fellow security researcher grep_security.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":129,"end":142,"href":"https:\u002F\u002Ftwitter.com\u002Fgrep_security","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_4":{"__typename":"Paragraph","id":"e72c9d069a20_4","name":"0a11","type":"P","href":null,"layout":null,"metadata":null,"text":"He had seen my post about the Raccoonv2 C2 list which I had shared the day before and observed an IP in the list, which was right in the neighborhood of an IP he had observed for some time.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":30,"end":47,"href":"https:\u002F\u002Fgithub.com\u002FGi7w0rm\u002FMalwareConfigLists\u002Ftree\u002Fmain\u002FRaccoon_v2","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qoV_U7s79X-b3PfWC6AnXg.png":{"__typename":"ImageMetadata","id":"1*qoV_U7s79X-b3PfWC6AnXg.png","originalHeight":319,"originalWidth":397,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_5":{"__typename":"Paragraph","id":"e72c9d069a20_5","name":"a499","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qoV_U7s79X-b3PfWC6AnXg.png"},"text":"Figure 1 - The message that got it all started","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_6":{"__typename":"Paragraph","id":"e72c9d069a20_6","name":"9640","type":"P","href":null,"layout":null,"metadata":null,"text":"Curious, I took a look at the IP he shared. The Url led to the following Directory Listing, which at the time of writing is still up and running:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*N7pDV_ToU5af1ycLbK3uIg.png":{"__typename":"ImageMetadata","id":"1*N7pDV_ToU5af1ycLbK3uIg.png","originalHeight":806,"originalWidth":1008,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_7":{"__typename":"Paragraph","id":"e72c9d069a20_7","name":"a82f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*N7pDV_ToU5af1ycLbK3uIg.png"},"text":"Figure 2 — OpenDir with “log_data”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_8":{"__typename":"Paragraph","id":"e72c9d069a20_8","name":"1b84","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, it was not Raccoon_v2. But I was immediately convinced it was something bad. I had seen such folders before with so-called stealer malware. The likes of Mars Stealer and AgentTesla are often found to have logs stored similarly. My interest was sparked and so I decided to take a deeper dig.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":129,"end":144,"href":"https:\u002F\u002Fmedium.com\u002F@gi7w0rm\u002Fwhat-is-stealer-malware-65fd7c29516a","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":159,"end":171,"href":"https:\u002F\u002Fmalpedia.caad.fkie.fraunhofer.de\u002Fdetails\u002Fwin.mars_stealer","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":176,"end":186,"href":"https:\u002F\u002Fmalpedia.caad.fkie.fraunhofer.de\u002Fdetails\u002Fwin.agent_tesla","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_9":{"__typename":"Paragraph","id":"e72c9d069a20_9","name":"c8b8","type":"P","href":null,"layout":null,"metadata":null,"text":"First some reconnaissance about the IP:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ICqXq34TbXq-TTkn5qxxwQ.png":{"__typename":"ImageMetadata","id":"1*ICqXq34TbXq-TTkn5qxxwQ.png","originalHeight":1730,"originalWidth":2140,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_10":{"__typename":"Paragraph","id":"e72c9d069a20_10","name":"a7aa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ICqXq34TbXq-TTkn5qxxwQ.png"},"text":"Figure 3 — OTX results for IP","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_11":{"__typename":"Paragraph","id":"e72c9d069a20_11","name":"3e26","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see the IP in question seems to be from a hosting network in Kazakhstan. And if you look at the domain associated, you will see there are quite a lot of words and patterns belonging to cryptocurrencies and the crypto ökosystem. “.exchange” domains, “\u002Fairdrop\u002F” as path names, “layer zero” and “network” in one domain, etc. All with some sort of Typosquatting. This smelled phishy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_12":{"__typename":"Paragraph","id":"e72c9d069a20_12","name":"d809","type":"P","href":null,"layout":null,"metadata":null,"text":"And indeed, grep_security noticed that the whole \u002F24 Subnet seems to be related to this kind of suspicious activity. Besides, there are several reported C2s for Infostealer malware in this Subnet. Among them RedLine, Raccoon, and others.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_13":{"__typename":"Paragraph","id":"e72c9d069a20_13","name":"b534","type":"P","href":null,"layout":null,"metadata":null,"text":"But neither RedLine nor Raccoon has the kind of OpenDir pattern we observed above. So let's find out if there is malware related to our IP:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Kt4gsULAihFmT-avWuxhFw.png":{"__typename":"ImageMetadata","id":"1*Kt4gsULAihFmT-avWuxhFw.png","originalHeight":1731,"originalWidth":1848,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_14":{"__typename":"Paragraph","id":"e72c9d069a20_14","name":"0cff","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Kt4gsULAihFmT-avWuxhFw.png"},"text":"Figure 4 — VirusTotal result (3rd sample was uploaded after initial analysis)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_15":{"__typename":"Paragraph","id":"e72c9d069a20_15","name":"cbcd","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, 2 samples were observed reaching out to this IP:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_16":{"__typename":"Paragraph","id":"e72c9d069a20_16","name":"c5be","type":"P","href":null,"layout":null,"metadata":null,"text":"Sample1: https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002F88b426437c97301982bf096306af1bde70caa0a9a99a60514b31d0fa0ea64afd\nSample2: https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002F8a94861424eac30e36085d408100510a9af570f6dd61a4c633d7e918e4317548","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":109,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002F88b426437c97301982bf096306af1bde70caa0a9a99a60514b31d0fa0ea64afd","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":119,"end":219,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002F8a94861424eac30e36085d408100510a9af570f6dd61a4c633d7e918e4317548","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_17":{"__typename":"Paragraph","id":"e72c9d069a20_17","name":"8948","type":"P","href":null,"layout":null,"metadata":null,"text":"For the remaining article, we will be looking at Sample 1.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_18":{"__typename":"Paragraph","id":"e72c9d069a20_18","name":"c1d3","type":"P","href":null,"layout":null,"metadata":null,"text":"First thing I always do: Detonate it in Trai.ge!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_19":{"__typename":"Paragraph","id":"e72c9d069a20_19","name":"b986","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Behavioral Report\nHave a look at the Hatching Triage automated malware analysis report for this sample, with a score of 10 out of 10.tria.ge","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":140,"href":"https:\u002F\u002Ftria.ge\u002F230114-vst3maah74\u002Fbehavioral2","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":18,"end":133,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Ftria.ge\u002F230114-vst3maah74\u002Fbehavioral2","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":""}},"Paragraph:e72c9d069a20_20":{"__typename":"Paragraph","id":"e72c9d069a20_20","name":"1ce4","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, it lights up like a Christmas tree. A collection of interesting artifacts can be observed in the following image. Note that the Pastebin link shows a single IP which is called via TCP after resolution. Also, note the TCP Port 15647 and the “PowerShell get-process” calls for “avastui” and “avgui”. It will help to do attribution later on.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FFO-DwRXCa4VTFqOdEpv0A.png":{"__typename":"ImageMetadata","id":"1*FFO-DwRXCa4VTFqOdEpv0A.png","originalHeight":1668,"originalWidth":2492,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_21":{"__typename":"Paragraph","id":"e72c9d069a20_21","name":"7041","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FFO-DwRXCa4VTFqOdEpv0A.png"},"text":"Figure 6 — IoC Collection — Interesting artifacts marked in Red Circles","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_22":{"__typename":"Paragraph","id":"e72c9d069a20_22","name":"0e70","type":"P","href":null,"layout":null,"metadata":null,"text":"Another interesting thing is the legitimate jsc.exe which is part of the .Net Framework behaves very strangely here, calling out to Pastebin, as well as to the 2 possible C2 Servers.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_23":{"__typename":"Paragraph","id":"e72c9d069a20_23","name":"5baa","type":"P","href":null,"layout":null,"metadata":null,"text":"At this point, I decided to take a closer look at Sample 1. And before anything else, I uploaded it to unpac.me in the hopes of some easy unpacking. And indeed, there were 3 samples unpacked:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":102,"end":111,"href":"https:\u002F\u002Fwww.unpac.me\u002Fresults\u002F8b910cb5-0dce-4110-a15b-a193d92be576#\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rjDs9Nels9WiNcIoG2pC_g.png":{"__typename":"ImageMetadata","id":"1*rjDs9Nels9WiNcIoG2pC_g.png","originalHeight":1668,"originalWidth":3116,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_24":{"__typename":"Paragraph","id":"e72c9d069a20_24","name":"18d7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*rjDs9Nels9WiNcIoG2pC_g.png"},"text":"Figure 7 — 3 Binaries extracted from Sample1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_25":{"__typename":"Paragraph","id":"e72c9d069a20_25","name":"5ec1","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, we are looking at 1 unknown PE file and 2 legitimate Microsoft-signed binaries. One is psapi.dll and the other cachmgr.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_26":{"__typename":"Paragraph","id":"e72c9d069a20_26","name":"b73a","type":"P","href":null,"layout":null,"metadata":null,"text":"Sadly, my reversing capabilities do not include Assembly yet, so this is where I ran into a dilemma. I had no idea what the unknown binary was doing and therefore I was at a dead end.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_27":{"__typename":"Paragraph","id":"e72c9d069a20_27","name":"39e5","type":"P","href":null,"layout":null,"metadata":null,"text":"But there was more to this attack. So I just jumped this step and decided to look at the next step. As you can see in Figure 6, after our malicious Sample gets executed, a folder named “SETUP_37419\" is created in the Users Temp folder. From there, Engine.exe gets executed, and shortly after we see a command-line task started with “cmd.exe \u002Fc cmd \u003C 4”. Well, time to take a look at that folder and its contents:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*eO-KZYH5cGYcsdts7K2pLw.png":{"__typename":"ImageMetadata","id":"1*eO-KZYH5cGYcsdts7K2pLw.png","originalHeight":250,"originalWidth":859,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_28":{"__typename":"Paragraph","id":"e72c9d069a20_28","name":"7ef9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*eO-KZYH5cGYcsdts7K2pLw.png"},"text":"Figure 8 — Setup Folder Content","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_29":{"__typename":"Paragraph","id":"e72c9d069a20_29","name":"9291","type":"P","href":null,"layout":null,"metadata":null,"text":"This is where things start to get more interesting because I can understand what I am seeing. 2 Images, 1 Executable, a .qsp file, and a Setup.txt file. At this time I didn’t know what a .qsp file is, so let's take a look at it with a text editor:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ISKaY0B_tuaDRudrzAHjlA.png":{"__typename":"ImageMetadata","id":"1*ISKaY0B_tuaDRudrzAHjlA.png","originalHeight":1419,"originalWidth":1325,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_30":{"__typename":"Paragraph","id":"e72c9d069a20_30","name":"751f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ISKaY0B_tuaDRudrzAHjlA.png"},"text":"Figure 9 — .qsp content","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_31":{"__typename":"Paragraph","id":"e72c9d069a20_31","name":"691f","type":"P","href":null,"layout":null,"metadata":null,"text":"That's a lucky hit. What we can learn from here is that the file seems associated with QSetup. The qsp file contains all instructions needed so that Engine.exe knows what it should execute on the System. It's even mentioned on the bottom of their webpage as the software used to execute on the Customers device. Uploading Engine.exe to VirusTotal also further confirms this theory. Furthermore, we see that the Directory “Temp\u002F5col3ccv. tda\u002F” is referenced. Also, a list of Items is given: “.\\45”,”.\\4”, and “.\\7”. This also explains what our cmd command means:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":87,"end":93,"href":"https:\u002F\u002Fwww.pantaray.com\u002Fqsetup.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":322,"end":346,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002Fe6e73497e85e9ece4c92ac7d49e07b9d55e932ba2d9e5789b94b95a9841ee524\u002Fdetails","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_32":{"__typename":"Paragraph","id":"e72c9d069a20_32","name":"81a9","type":"P","href":null,"layout":null,"metadata":null,"text":"“cmd \u002Fc cmd \u003C 4\" will probably execute whatever is contained in the file named 4.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_33":{"__typename":"Paragraph","id":"e72c9d069a20_33","name":"05d2","type":"P","href":null,"layout":null,"metadata":null,"text":"The other 3 files, the 2 .bmp files, and the Setup.txt file are not very interesting. Both images are resources of the installer and the Setup.txt has the same content as the .qsp but in a different format.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_34":{"__typename":"Paragraph","id":"e72c9d069a20_34","name":"7750","type":"P","href":null,"layout":null,"metadata":null,"text":"So next, let's take a look at the folder mentioned in the .qsp file:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*OzAIqCKUMfPu_QOR3A2pcw.png":{"__typename":"ImageMetadata","id":"1*OzAIqCKUMfPu_QOR3A2pcw.png","originalHeight":302,"originalWidth":1090,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_35":{"__typename":"Paragraph","id":"e72c9d069a20_35","name":"6a9f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*OzAIqCKUMfPu_QOR3A2pcw.png"},"text":"Figure 10–5col3ccv.tda Folder Content after Execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_36":{"__typename":"Paragraph","id":"e72c9d069a20_36","name":"c1f0","type":"P","href":null,"layout":null,"metadata":null,"text":"If you are wondering where “.\\7\" is, we will get there. It gets changed during the Install process. But let's look at “.\u002F4” which is executed by cmd.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_37":{"__typename":"Paragraph","id":"e72c9d069a20_37","name":"f400","type":"P","href":null,"layout":null,"metadata":null,"text":"Upon opening it, we are greeted by tons of gibberish:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BHoUz_0wJ9jwYhNMs9yePA.png":{"__typename":"ImageMetadata","id":"1*BHoUz_0wJ9jwYhNMs9yePA.png","originalHeight":1275,"originalWidth":3382,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_38":{"__typename":"Paragraph","id":"e72c9d069a20_38","name":"bfe1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BHoUz_0wJ9jwYhNMs9yePA.png"},"text":"Figure 11 — Obfuscated CMD commands","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_39":{"__typename":"Paragraph","id":"e72c9d069a20_39","name":"f2ee","type":"P","href":null,"layout":null,"metadata":null,"text":"But if you look at it closer you will notice that most of it is trash code, which is included to confuse and only some of the Lines contain valid code. Basically, a String replacement where Set \u003Cvery_long_random_string\u003E = Char.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_40":{"__typename":"Paragraph","id":"e72c9d069a20_40","name":"2b75","type":"P","href":null,"layout":null,"metadata":null,"text":"After deobfuscating this, we get the following lines of cmd commands:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*83EE9QyHXJtjLoPlJXOnaA.png":{"__typename":"ImageMetadata","id":"1*83EE9QyHXJtjLoPlJXOnaA.png","originalHeight":429,"originalWidth":2679,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_41":{"__typename":"Paragraph","id":"e72c9d069a20_41","name":"b399","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*83EE9QyHXJtjLoPlJXOnaA.png"},"text":"Figure 12 — Deobfuscated CMD commands","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_42":{"__typename":"Paragraph","id":"e72c9d069a20_42","name":"212d","type":"P","href":null,"layout":null,"metadata":null,"text":"Let's try to understand the above script. The first thing that comes to the eye is the search for processes called “avastui” and “avgui” using the PowerShell get-process scriptlet. Both processes belong to the Avast AntiVirus Suite. If the Processes should be running, the script sets the Variable Champion.exe.pif to AutoIT3.exe, and the file ending of the file named “S” to “S.a3x”. This already foreshadows the next stage of this attack. Then, the Script creates a randomly named directory (in Figure 10 you see it as 17473). It creates a file called Champion.exe.pif (Or AutoIt3, if Avast was found) in this random folder and pipes MZ into it. Then it searches a certain String in the file named “45”. If we look at “45\" in a HexEditor, we see a bunch of binary data, where the string that is searched via findstr is appended to the beginning. The flags \u002FV and \u002FR let findstr ignore the string and pipe everything except it into the newly created file. Note the “\u003E\u003E” which will append the content rather than overwriting it. The outcome? A perfectly valid PE file, which after some investigation proves to be a legitimate AutoIT3 executable.\nThe script then moves the file “7” into the same random directory where the AutoIT3 executable called Champion.exe.pif is. Thereby it gets renamed to “S” or “S.a3x” depending on the AvastDetection. After that, “Champion.exe.pif” executes “S”. A ping to localhost is executed, probably to give the execution some time before the PowerShell script dies.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":1086,"end":1099,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002F237d1bca6e056df5bb16a1216a434634109478f882d3b1d58344c801d184f95d\u002Fdetection","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_43":{"__typename":"Paragraph","id":"e72c9d069a20_43","name":"efef","type":"P","href":null,"layout":null,"metadata":null,"text":"So our next goal is obvious: What exactly is “S” or “S.a3x”? And what does it do?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_44":{"__typename":"Paragraph","id":"e72c9d069a20_44","name":"d5f0","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, we know already it's probably an AutoIT Script. We also know there will be an execution of “jsc.exe” next. But at the time I had no idea of the AutoIT file format. So after looking at the “S” file and realizing I could not read anything in it because of the obfuscation, I decided to call for help via Twitter:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:509bfccc39affdde02b56a12c2bc4dfb":{"__typename":"MediaResource","id":"509bfccc39affdde02b56a12c2bc4dfb","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A\u002F\u002Ftwitter.com\u002Fgi7w0rm\u002Fstatus\u002F1614440406405496836&image=https%3A\u002F\u002Fi.embed.ly\u002F1\u002Fimage%3Furl%3Dhttps%253A%252F%252Fabs.twimg.com%252Ferrors%252Flogo46x38.png%26key%3Da19fcc184b9711e1b4764040d3dc5c07","iframeHeight":281,"iframeWidth":500,"title":"Gi7w0rm on Twitter: \"Is there anyone in my community who can help me to #reverse a .a3x #AutoIt Script.Thing is either a Packer or a new unknown Version of a known #Stealer. Would be awesome to know.@James_inthe_box @UK_Daniel_Card @aaqeel87 @c3rb3ru5d3d53c @dr4k0nia @JRoosen pic.twitter.com\u002FxYPrLwnDug \u002F Twitter\""},"Paragraph:e72c9d069a20_45":{"__typename":"Paragraph","id":"e72c9d069a20_45","name":"f287","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:509bfccc39affdde02b56a12c2bc4dfb"}},"mixtapeMetadata":null},"Paragraph:e72c9d069a20_46":{"__typename":"Paragraph","id":"e72c9d069a20_46","name":"10b0","type":"P","href":null,"layout":null,"metadata":null,"text":"At that time I thought I was facing a “.a3x” file, so I thought it had been compiled in some way. Even after looking at “S” in a Text Editor, I had just understood gibberish and therefore I saw my fears come true. However, some hours after this tweet I realized, that I was looking at a highly obfuscated “.au3\" file. Other than “.a3x”, “.au3” is not compiled but a readable script. Still, the obfuscation was so strong that I wasn’t mad when some people started reacting to my post, telling me they would like to take a look at it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_47":{"__typename":"Paragraph","id":"e72c9d069a20_47","name":"4ab6","type":"BQ","href":null,"layout":null,"metadata":null,"text":"At this point, I would like to give a huge thanks and shoutout to Hexacorn, _EthicalChaos_, _theVIVI, DidierStevens, richeyward, luc4m, and especially dr4k0nia (who solved the riddle), because all stepped forward voluntarily in the last days, to help with this ! I really appreciate seeing so many researchers who are willing to help and I am honored to have such a nice community on Twitter!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":66,"end":74,"href":"https:\u002F\u002Ftwitter.com\u002FHexacorn","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":76,"end":90,"href":"https:\u002F\u002Ftwitter.com\u002F_EthicalChaos_","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":92,"end":100,"href":"https:\u002F\u002Ftwitter.com\u002F_theVIVI","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":102,"end":115,"href":"https:\u002F\u002Ftwitter.com\u002FDidierStevens\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":117,"end":127,"href":"https:\u002F\u002Ftwitter.com\u002Fricheyward","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":129,"end":134,"href":"https:\u002F\u002Ftwitter.com\u002Fluc4m","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":151,"end":159,"href":"https:\u002F\u002Ftwitter.com\u002Fdr4k0nia","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_48":{"__typename":"Paragraph","id":"e72c9d069a20_48","name":"7f46","type":"P","href":null,"layout":null,"metadata":null,"text":"So what did I look at? Here is a little extract.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Gp1Gt92PuWf_UQkKGtkz1g.png":{"__typename":"ImageMetadata","id":"1*Gp1Gt92PuWf_UQkKGtkz1g.png","originalHeight":1312,"originalWidth":3134,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_49":{"__typename":"Paragraph","id":"e72c9d069a20_49","name":"e129","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Gp1Gt92PuWf_UQkKGtkz1g.png"},"text":"Figure 13 — Obfuscated AutoIT Script","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_50":{"__typename":"Paragraph","id":"e72c9d069a20_50","name":"b696","type":"P","href":null,"layout":null,"metadata":null,"text":"The script had 10255 lines in this style, the only thing sticking out was a blog of Hex data. It has to be noted that the script had 0\u002F64 detections at the time of submitting it to VT.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_51":{"__typename":"Paragraph","id":"e72c9d069a20_51","name":"b603","type":"P","href":null,"layout":null,"metadata":null,"text":"I tried to extract the Hex Block and convert it to a binary, as this would be a common way of embedding a binary into a script file. However, I had no success.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_52":{"__typename":"Paragraph","id":"e72c9d069a20_52","name":"d72c","type":"P","href":null,"layout":null,"metadata":null,"text":"Luckily, others had more luck:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_53":{"__typename":"Paragraph","id":"e72c9d069a20_53","name":"bde5","type":"P","href":null,"layout":null,"metadata":null,"text":"Both dr4konia and _EthicalChaos_ came up with a decryption method working the same as the “DoctrineDrama” in Figure13 which spans through the whole script:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":48,"end":66,"href":"https:\u002F\u002Ftwitter.com\u002Fdr4k0nia\u002Fstatus\u002F1614691627376730112","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BMM1VTVQmLowitDaKSAmFg.jpeg":{"__typename":"ImageMetadata","id":"1*BMM1VTVQmLowitDaKSAmFg.jpeg","originalHeight":242,"originalWidth":651,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_54":{"__typename":"Paragraph","id":"e72c9d069a20_54","name":"91e9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BMM1VTVQmLowitDaKSAmFg.jpeg"},"text":"Figure 14 — Decryption Funktion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_55":{"__typename":"Paragraph","id":"e72c9d069a20_55","name":"3779","type":"P","href":null,"layout":null,"metadata":null,"text":"With the help of this function, Hexacorn was able to produce the first script which was slightly less obfuscated. However, it was still full of string replacements, which made it nearly unreadable. If you want to look at this and would like a little headstart, check out his version here. I uploaded it to Triage as means of a file transfer.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":283,"end":287,"href":"https:\u002F\u002Ftria.ge\u002F230115-zbheqafh3x","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_56":{"__typename":"Paragraph","id":"e72c9d069a20_56","name":"5f37","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, the parts deobfuscated are function calls and imported libraries. This did give further proof of a possible process injection through Process Hollowing:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:03b2a68bbe5990c3773547b8c39f8b41":{"__typename":"MediaResource","id":"03b2a68bbe5990c3773547b8c39f8b41","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A\u002F\u002Ftwitter.com\u002Fdr4k0nia\u002Fstatus\u002F1614726967080943617%3Fs%3D20%26t%3D7Rygo3S6h45rBtSjqpxoVQ&image=","iframeHeight":281,"iframeWidth":500,"title":"dr4k0nia on Twitter: \"\"C:\\\\Windows\\\\https:\u002F\u002Ft.co\u002FHdg9XYUuD5\\\\Framework\\\\v4.0.30319\\\\jsc.exe \" seems to be injecting into this Process, at least it starts this with CreateProcessW, however I could not get a successful dump from the Process \u002F Twitter\""},"Paragraph:e72c9d069a20_57":{"__typename":"Paragraph","id":"e72c9d069a20_57","name":"81bb","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:03b2a68bbe5990c3773547b8c39f8b41"}},"mixtapeMetadata":null},"Paragraph:e72c9d069a20_58":{"__typename":"Paragraph","id":"e72c9d069a20_58","name":"134d","type":"P","href":null,"layout":null,"metadata":null,"text":"As initially expected, the AutoIT script injected some code into the legitimate “jsc.exe”. This code was then responsible to conduct the malicious activity. Besides, the script was also responsible for the initial DNS Query that was observed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Ug8mjvuQGiN1vR-EwcWk9w.png":{"__typename":"ImageMetadata","id":"1*Ug8mjvuQGiN1vR-EwcWk9w.png","originalHeight":25,"originalWidth":1117,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_59":{"__typename":"Paragraph","id":"e72c9d069a20_59","name":"63a5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Ug8mjvuQGiN1vR-EwcWk9w.png"},"text":"Figure 15 — Weird Ping","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_60":{"__typename":"Paragraph","id":"e72c9d069a20_60","name":"8bd5","type":"P","href":null,"layout":null,"metadata":null,"text":"It was probably implemented for execution control.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_61":{"__typename":"Paragraph","id":"e72c9d069a20_61","name":"b41c","type":"P","href":null,"layout":null,"metadata":null,"text":"Sadly, the AutoIT script proved to be too bulletproof to fully reverse it. Until now, none of the researchers that took a look at it were able to archive full deobfuscation. (Please notify me if you should manage to do it, and I will gladly add an Update to this post.)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_62":{"__typename":"Paragraph","id":"e72c9d069a20_62","name":"0cba","type":"P","href":null,"layout":null,"metadata":null,"text":"However, after a while, dr4k0nia was able to dump the final payload!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":24,"end":32,"href":"https:\u002F\u002Ftwitter.com\u002Fdr4k0nia","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_63":{"__typename":"Paragraph","id":"e72c9d069a20_63","name":"7c51","type":"P","href":null,"layout":null,"metadata":null,"text":"I saw this as a big breakthrough, as we were able to dump the final stage of this attack, a .Net binary with the Sha-256 Hash: “a835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910\"","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":128,"end":192,"href":"https:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002Fa835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_64":{"__typename":"Paragraph","id":"e72c9d069a20_64","name":"c02a","type":"P","href":null,"layout":null,"metadata":null,"text":"However, we soon learned that the binary was strongly obfuscated using flow-dependent mutations and flow-dependent variables which made the important parts nearly unreadable. However, upon opening the file in DNSpy, some important functions could be recovered, which made it possible to determine the nature of the file:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*98jNxblgHpg4rf7PkcfFnA.png":{"__typename":"ImageMetadata","id":"1*98jNxblgHpg4rf7PkcfFnA.png","originalHeight":1287,"originalWidth":803,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_65":{"__typename":"Paragraph","id":"e72c9d069a20_65","name":"e36f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*98jNxblgHpg4rf7PkcfFnA.png"},"text":"Figure 16 — Stealer == True","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_66":{"__typename":"Paragraph","id":"e72c9d069a20_66","name":"921b","type":"P","href":null,"layout":null,"metadata":null,"text":"From the function names and some other artifacts, it's clear that we are looking at a Credential Stealer. It fingerprints the system and then steals as much sensitive data as possible. Just as we expected.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_67":{"__typename":"Paragraph","id":"e72c9d069a20_67","name":"63fe","type":"P","href":null,"layout":null,"metadata":null,"text":"We also see the creation of a TCP Client, which is used for C2 Communication:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vnbhKmbHJeh6ds8I2LCkHg.png":{"__typename":"ImageMetadata","id":"1*vnbhKmbHJeh6ds8I2LCkHg.png","originalHeight":881,"originalWidth":914,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_68":{"__typename":"Paragraph","id":"e72c9d069a20_68","name":"8ce8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vnbhKmbHJeh6ds8I2LCkHg.png"},"text":"Figure 17 — TCP Client","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_69":{"__typename":"Paragraph","id":"e72c9d069a20_69","name":"9196","type":"P","href":null,"layout":null,"metadata":null,"text":"A string dump was released by dr4konia. A slightly cleaned-up version by me can be found here. It further proves the malicious nature of this binary.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":2,"end":13,"href":"https:\u002F\u002Fpastebin.com\u002Fraw\u002FpjBNEQDw","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":89,"end":93,"href":"https:\u002F\u002Fgithub.com\u002FGi7w0rm\u002FMalwareConfigLists\u002Fblob\u002Fmain\u002Fstrings_dump\u002FArechclient2.txt","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_70":{"__typename":"Paragraph","id":"e72c9d069a20_70","name":"751e","type":"P","href":null,"layout":null,"metadata":null,"text":"As we can’t fully deobfuscate the binary, we can not fully prove what Stealer this is. However, based on several artifacts, I do believe we are dealing with a highly obfuscated Version of Arechclient2\u002FSectop_Rat.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_71":{"__typename":"Paragraph","id":"e72c9d069a20_71","name":"b495","type":"P","href":null,"layout":null,"metadata":null,"text":"First, ArechClient2 Detections which are based on the TCP Connection Init by ArechClient2 did hit on VirusTotal. Second, MalwareBazaar also identifies it as ArechClient2. Prior Analysis of this threat has shown very similar TTP: A connection via TCP\u002FIP, a Connection to Port 15647, JSON-based communication, a connection attempt to eth0[.]me, even the Strings observed in the string dump by dr4konia, all align with this threat.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":101,"end":111,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002Fa835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910\u002Fbehavior","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":121,"end":134,"href":"https:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002Fa835602db71a42876d0a88cc452cb60001de4875a5e91316da9a74363f481910\u002F#intel","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":171,"end":185,"href":"https:\u002F\u002Fvxhive.blogspot.com\u002F2021\u002F01\u002Fdeep-dive-into-sectoprat.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZDsGXzXHAX5BUcUHq0n2hg.png":{"__typename":"ImageMetadata","id":"1*ZDsGXzXHAX5BUcUHq0n2hg.png","originalHeight":456,"originalWidth":1890,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e72c9d069a20_72":{"__typename":"Paragraph","id":"e72c9d069a20_72","name":"e0f8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZDsGXzXHAX5BUcUHq0n2hg.png"},"text":"Figure 18 — Old analysis left, our analysis string dump right","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_73":{"__typename":"Paragraph","id":"e72c9d069a20_73","name":"14d3","type":"P","href":null,"layout":null,"metadata":null,"text":"So, the reversing is done, the Threat is identified, and we are done, right?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_74":{"__typename":"Paragraph","id":"e72c9d069a20_74","name":"0119","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, not fully, there is some more info I would like to add.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_75":{"__typename":"Paragraph","id":"e72c9d069a20_75","name":"4955","type":"P","href":null,"layout":null,"metadata":null,"text":"First of all, my initial goal in this analysis besides the identification of the threat was to decrypt the log data accessible in the Open Directory mentioned in Figure 2. However, while dr4konia was able to uncover the AES Key used by our sample, it appears that the IV used is randomly generated and attached to the extracted data. This makes decryption of the data impossible.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_76":{"__typename":"Paragraph","id":"e72c9d069a20_76","name":"539a","type":"P","href":null,"layout":null,"metadata":null,"text":"Secondly, I initially thought this threat was shared via a crypto scam attack, based on the URLs associated with our initial IP address (77.73.133.81). However, after further research, I discovered that the Execution Parent of our Sample is actually a file called “obs-installer-setupx64–29.685.zip”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":265,"end":298,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002F0f83091af8806a425ef68a3db6373d48800066e59abec2545fffe3d9f2fac988\u002Fdetection","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_77":{"__typename":"Paragraph","id":"e72c9d069a20_77","name":"447c","type":"P","href":null,"layout":null,"metadata":null,"text":"This shows that the sample is probably shared through one of the many Google Ads Campaigns which are currently ongoing, where threat actors register malicious websites, make them appear like official software pages, and then lure victims into downloading malicious software. These pages are often advertised through Google Ad Campaigns, allowing the Threat Actors to place their malicious sites right at the top of Google Searches for the Software Product in question. And these campaigns prove to be successful. The OpenDirectory with the alleged LogData contained 18.158 individual files, meaning this actor alone has likely hacked more than 18000 victims.\nIT Security Researcher Germán Fernández also noticed this connection and found 70 domains associated with this threat.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":682,"end":698,"href":"https:\u002F\u002Ftwitter.com\u002F1ZRR4H","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":738,"end":776,"href":"https:\u002F\u002Ftwitter.com\u002F1ZRR4H\u002Fstatus\u002F1615231876817362944","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_78":{"__typename":"Paragraph","id":"e72c9d069a20_78","name":"e50f","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, I will leave it here for today. If you have read until here, I am glad you made it. I want to take this opportunity to thank grep_security for reaching out with his question. It was a nice hunt and I am happy we made it. Thanks again to all the people who helped during this investigation.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_79":{"__typename":"Paragraph","id":"e72c9d069a20_79","name":"675a","type":"P","href":null,"layout":null,"metadata":null,"text":"If you haven't, please follow my Twitter for more awesome IT-Security content. Also follow dr4k0nia, grep_security, and all the others mentioned above, they deserve it :)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":30,"end":40,"href":"https:\u002F\u002Ftwitter.com\u002FGi7w0rm","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":91,"end":99,"href":"https:\u002F\u002Ftwitter.com\u002Fdr4k0nia","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":101,"end":114,"href":"https:\u002F\u002Ftwitter.com\u002Fgrep_security","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_80":{"__typename":"Paragraph","id":"e72c9d069a20_80","name":"204d","type":"P","href":null,"layout":null,"metadata":null,"text":"For a list of IoC, please see this file on Github.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":30,"end":49,"href":"https:\u002F\u002Fgithub.com\u002FGi7w0rm\u002FMalwareConfigLists\u002Fblob\u002Fmain\u002FArechClient2_SectopRat\u002FTTPs.md","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_81":{"__typename":"Paragraph","id":"e72c9d069a20_81","name":"7169","type":"P","href":null,"layout":null,"metadata":null,"text":"Until next time!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_82":{"__typename":"Paragraph","id":"e72c9d069a20_82","name":"d005","type":"P","href":null,"layout":null,"metadata":null,"text":"Cheers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e72c9d069a20_83":{"__typename":"Paragraph","id":"e72c9d069a20_83","name":"ebeb","type":"P","href":null,"layout":null,"metadata":null,"text":"Update (05.02.2023):\n@dr4k0nia followed up with her own blog on this topic. \nIf you want to get more insights on how to reverse the AutoIt Script and the final .Net payload, check out: https:\u002F\u002Fdr4k0nia.github.io\u002Fposts\u002FAnalysing-a-sample-of-ArechClient2\u002F.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":21,"end":30,"href":"https:\u002F\u002Ftwitter.com\u002Fdr4k0nia\u002Fstatus\u002F1622263504144142341","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":185,"end":253,"href":"https:\u002F\u002Fdr4k0nia.github.io\u002Fposts\u002FAnalysing-a-sample-of-ArechClient2\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:fa7639fc99f0-viewerId:lo_310b51045dbd":{"__typename":"UserViewerEdge","id":"userId:fa7639fc99f0-viewerId:lo_310b51045dbd","isMuting":false},"PostViewerEdge:postId:eb2f0aad6ec8-viewerId:lo_310b51045dbd":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:eb2f0aad6ec8-viewerId:lo_310b51045dbd","shouldFollowPostForExternalSearch":true},"Tag:infosec":{"__typename":"Tag","id":"infosec","displayTitle":"Infosec","normalizedTagSlug":"infosec"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Tag:ioc":{"__typename":"Tag","id":"ioc","displayTitle":"Ioc","normalizedTagSlug":"ioc"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Tag:stealer":{"__typename":"Tag","id":"stealer","displayTitle":"Stealer","normalizedTagSlug":"stealer"},"Post:eb2f0aad6ec8":{"__typename":"Post","id":"eb2f0aad6ec8","collection":null,"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"e005","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"c73a","startIndex":3,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"6eec","startIndex":78,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:e72c9d069a20_0"},{"__ref":"Paragraph:e72c9d069a20_1"},{"__ref":"Paragraph:e72c9d069a20_2"},{"__ref":"Paragraph:e72c9d069a20_3"},{"__ref":"Paragraph:e72c9d069a20_4"},{"__ref":"Paragraph:e72c9d069a20_5"},{"__ref":"Paragraph:e72c9d069a20_6"},{"__ref":"Paragraph:e72c9d069a20_7"},{"__ref":"Paragraph:e72c9d069a20_8"},{"__ref":"Paragraph:e72c9d069a20_9"},{"__ref":"Paragraph:e72c9d069a20_10"},{"__ref":"Paragraph:e72c9d069a20_11"},{"__ref":"Paragraph:e72c9d069a20_12"},{"__ref":"Paragraph:e72c9d069a20_13"},{"__ref":"Paragraph:e72c9d069a20_14"},{"__ref":"Paragraph:e72c9d069a20_15"},{"__ref":"Paragraph:e72c9d069a20_16"},{"__ref":"Paragraph:e72c9d069a20_17"},{"__ref":"Paragraph:e72c9d069a20_18"},{"__ref":"Paragraph:e72c9d069a20_19"},{"__ref":"Paragraph:e72c9d069a20_20"},{"__ref":"Paragraph:e72c9d069a20_21"},{"__ref":"Paragraph:e72c9d069a20_22"},{"__ref":"Paragraph:e72c9d069a20_23"},{"__ref":"Paragraph:e72c9d069a20_24"},{"__ref":"Paragraph:e72c9d069a20_25"},{"__ref":"Paragraph:e72c9d069a20_26"},{"__ref":"Paragraph:e72c9d069a20_27"},{"__ref":"Paragraph:e72c9d069a20_28"},{"__ref":"Paragraph:e72c9d069a20_29"},{"__ref":"Paragraph:e72c9d069a20_30"},{"__ref":"Paragraph:e72c9d069a20_31"},{"__ref":"Paragraph:e72c9d069a20_32"},{"__ref":"Paragraph:e72c9d069a20_33"},{"__ref":"Paragraph:e72c9d069a20_34"},{"__ref":"Paragraph:e72c9d069a20_35"},{"__ref":"Paragraph:e72c9d069a20_36"},{"__ref":"Paragraph:e72c9d069a20_37"},{"__ref":"Paragraph:e72c9d069a20_38"},{"__ref":"Paragraph:e72c9d069a20_39"},{"__ref":"Paragraph:e72c9d069a20_40"},{"__ref":"Paragraph:e72c9d069a20_41"},{"__ref":"Paragraph:e72c9d069a20_42"},{"__ref":"Paragraph:e72c9d069a20_43"},{"__ref":"Paragraph:e72c9d069a20_44"},{"__ref":"Paragraph:e72c9d069a20_45"},{"__ref":"Paragraph:e72c9d069a20_46"},{"__ref":"Paragraph:e72c9d069a20_47"},{"__ref":"Paragraph:e72c9d069a20_48"},{"__ref":"Paragraph:e72c9d069a20_49"},{"__ref":"Paragraph:e72c9d069a20_50"},{"__ref":"Paragraph:e72c9d069a20_51"},{"__ref":"Paragraph:e72c9d069a20_52"},{"__ref":"Paragraph:e72c9d069a20_53"},{"__ref":"Paragraph:e72c9d069a20_54"},{"__ref":"Paragraph:e72c9d069a20_55"},{"__ref":"Paragraph:e72c9d069a20_56"},{"__ref":"Paragraph:e72c9d069a20_57"},{"__ref":"Paragraph:e72c9d069a20_58"},{"__ref":"Paragraph:e72c9d069a20_59"},{"__ref":"Paragraph:e72c9d069a20_60"},{"__ref":"Paragraph:e72c9d069a20_61"},{"__ref":"Paragraph:e72c9d069a20_62"},{"__ref":"Paragraph:e72c9d069a20_63"},{"__ref":"Paragraph:e72c9d069a20_64"},{"__ref":"Paragraph:e72c9d069a20_65"},{"__ref":"Paragraph:e72c9d069a20_66"},{"__ref":"Paragraph:e72c9d069a20_67"},{"__ref":"Paragraph:e72c9d069a20_68"},{"__ref":"Paragraph:e72c9d069a20_69"},{"__ref":"Paragraph:e72c9d069a20_70"},{"__ref":"Paragraph:e72c9d069a20_71"},{"__ref":"Paragraph:e72c9d069a20_72"},{"__ref":"Paragraph:e72c9d069a20_73"},{"__ref":"Paragraph:e72c9d069a20_74"},{"__ref":"Paragraph:e72c9d069a20_75"},{"__ref":"Paragraph:e72c9d069a20_76"},{"__ref":"Paragraph:e72c9d069a20_77"},{"__ref":"Paragraph:e72c9d069a20_78"},{"__ref":"Paragraph:e72c9d069a20_79"},{"__ref":"Paragraph:e72c9d069a20_80"},{"__ref":"Paragraph:e72c9d069a20_81"},{"__ref":"Paragraph:e72c9d069a20_82"},{"__ref":"Paragraph:e72c9d069a20_83"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:fa7639fc99f0"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fgi7w0rm.medium.com\u002Fa-long-way-to-sectoprat-eb2f0aad6ec8","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"e72c9d069a20","postResponses":{"__typename":"PostResponses","count":1},"responseDistribution":"NOT_DISTRIBUTED","clapCount":27,"title":"A long way to SectopRat","isSeries":false,"sequence":null,"uniqueSlug":"a-long-way-to-sectoprat-eb2f0aad6ec8","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1675616479676,"readingTime":10.754716981132075,"previewContent":{"__typename":"PreviewContent","subtitle":"Investigating a highly obfuscated stealer sample"},"previewImage":{"__ref":"ImageMetadata:1*qoV_U7s79X-b3PfWC6AnXg.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1674010563797,"updatedAt":1675616480758,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:eb2f0aad6ec8-viewerId:lo_310b51045dbd"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:infosec"},{"__ref":"Tag:reverse-engineering"},{"__ref":"Tag:ioc"},{"__ref":"Tag:malware"},{"__ref":"Tag:stealer"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":2426,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.66c5a560.js"></script><script src="https://cdn-client.medium.com/lite/static/js/1205.1777a8fc.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.da483d6c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.5bef8967.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4505.6dfaf853.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9380.fb176dee.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.14632006.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.2791b202.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.e7627065.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4737.f07510eb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.f09fa09c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6372.2eeebbff.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7938.607ab959.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6240.ce1d8647.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6199.a99e1025.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.8d409b94.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3623.683f4e5b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.ba40f706.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.15bcd496.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.5b5a8ee0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8664.b06e2cc0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4378.14d600be.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.a14bc52a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.cdb15b43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8768.c294838b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.499eaa23.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3523.a6edc225.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3515.502362cb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.4dad20c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.0d800846.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.1770f8f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.9a5e00e7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.55ad176a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.00cf71c8.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'92429e96df16eaf8',t:'MTc0MjYxNDMyMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"92429e96df16eaf8","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>