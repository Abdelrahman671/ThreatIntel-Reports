<!DOCTYPE html>
<html lang="en-US" >
<head>
		<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="profile" href="http://gmpg.org/xfn/11" />
			<link rel="pingback" href="https://blag.nullteilerfrei.de/xmlrpc.php">
		<title>Programmatically NOP the Current Selection in Ghidra &#8211; nullteilerfrei</title>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="nullteilerfrei &raquo; Feed" href="https://blag.nullteilerfrei.de/feed/" />
<link rel="alternate" type="application/rss+xml" title="nullteilerfrei &raquo; Comments Feed" href="https://blag.nullteilerfrei.de/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="nullteilerfrei &raquo; Programmatically NOP the Current Selection in Ghidra Comments Feed" href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blag.nullteilerfrei.de\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://blag.nullteilerfrei.de/wp-includes/css/dist/block-library/style.min.css?ver=6.7.1' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='parent-style-css' href='https://blag.nullteilerfrei.de/wp-content/themes/switty/style.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='katex-style-css' href='https://blag.nullteilerfrei.de/wp-content/themes/ntf_new/katex/katex.min.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css' href='https://blag.nullteilerfrei.de/wp-content/themes/switty/css/bootstrap.css?ver=3.3.7' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css' href='https://blag.nullteilerfrei.de/wp-content/themes/switty/css/font-awesome.css?ver=4.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='switty-style-default-css' href='https://blag.nullteilerfrei.de/wp-content/themes/ntf_new/style.css?ver=1.1.5' type='text/css' media='all' />
<link rel='stylesheet' id='switty-style-core-css' href='https://blag.nullteilerfrei.de/wp-content/themes/switty/css/style.css?ver=1.1.5' type='text/css' media='all' />
<style id='switty-style-core-inline-css' type='text/css'>

			.gridpostloop {
			  width: 100%;
			}
		
			@media (min-width: 768px) {
				.woocommerce ul.products li.product, .woocommerce-page ul.products li.product {
					width: 22%;
				}
			}
			
</style>
<link rel='stylesheet' id='switty-style-woo-css' href='https://blag.nullteilerfrei.de/wp-content/themes/switty/css/style-woo.css?ver=1.1.5' type='text/css' media='all' />
<link rel='stylesheet' id='kirki_google_fonts-css' href='https://fonts.googleapis.com/css?family=Libre+Baskerville%3Aregular%7CArvo%3Aregular%7CRajdhani%3A500%7CRoboto%3Aregular&#038;subset' type='text/css' media='all' />
<link rel='stylesheet' id='kirki-styles-switty_config-css' href='https://blag.nullteilerfrei.de/wp-content/themes/switty/inc/frameworks/kirki/assets/css/kirki-styles.css' type='text/css' media='all' />
<style id='kirki-styles-switty_config-inline-css' type='text/css'>
body{font-family:"Libre Baskerville", Georgia, serif;font-weight:400;font-style:normal;text-align:inherit;color:#ffffff;}body h1, .h1{font-family:Arvo, Georgia, serif;font-size:22px;font-weight:400;font-style:normal;line-height:1.1;text-align:inherit;text-transform:uppercase;color:#ffffff;}body h2, .h2{font-family:Arvo, Georgia, serif;font-size:22px;font-weight:400;font-style:normal;line-height:1.1;text-align:inherit;text-transform:uppercase;color:#ffffff;}body h3, .h3{font-family:Arvo, Georgia, serif;font-size:22px;font-weight:400;font-style:normal;line-height:1.1;text-align:inherit;text-transform:uppercase;color:#ffffff;}body h4, .h4{font-family:Arvo, Georgia, serif;font-size:20px;font-weight:400;font-style:normal;line-height:1.1;text-align:inherit;text-transform:inherit;color:#ffffff;}body h5, .h5{font-family:Arvo, Georgia, serif;font-size:20px;font-weight:400;font-style:normal;line-height:1.1;text-align:inherit;text-transform:inherit;color:#ffffff;}body h6, .h6{font-family:Arvo, Georgia, serif;font-size:20px;font-weight:400;font-style:normal;line-height:1.1;text-align:inherit;text-transform:inherit;color:#ffffff;}#maincontainer p{font-family:"Libre Baskerville", Georgia, serif;font-size:16px;font-weight:400;font-style:normal;letter-spacing:0.1px;line-height:25px;text-align:inherit;text-transform:inherit;color:#ffffff;}#navbar ul.navbar-nav li a{font-family:Rajdhani, Helvetica, Arial, sans-serif;font-size:18px;font-weight:500;font-style:normal;text-align:inherit;color:#ffffff;}.side-menu-menu-wrap ul li a{font-family:Rajdhani, Helvetica, Arial, sans-serif;font-size:18px;font-weight:500;font-style:normal;letter-spacing:0.1px;line-height:25px;text-align:inherit;text-transform:inherit;color:#ffffff;}.widget_sidebar_main ul li, .widget_sidebar_main ol li{font-family:Roboto, Helvetica, Arial, sans-serif;font-size:15px;font-weight:400;font-style:normal;letter-spacing:0.1px;line-height:1.7;text-align:inherit;text-transform:inherit;color:#ffffff;}.footer{font-family:Roboto, Helvetica, Arial, sans-serif;font-size:15px;font-weight:400;font-style:normal;line-height:1.7;text-align:inherit;text-transform:inherit;color:#ffffff;}.footer-copyright{font-family:Roboto, Helvetica, Arial, sans-serif;font-size:15px;font-weight:400;font-style:normal;line-height:1.7;text-align:inherit;text-transform:inherit;color:#BCBCBC;background-color:#111111;}body a, .woocommerce .star-rating span{color:#358247;}.widget_sidebar_main .right-widget-title-spn{border-bottom-color:#358247;}.navigation.pagination .nav-links .page-numbers, .navigation.pagination .nav-links .page-numbers:last-child{border-color:#358247;}.woocommerce .widget_price_filter .ui-slider .ui-slider-handle, .woocommerce .widget_price_filter .ui-slider .ui-slider-range{background-color:#358247;}body a:hover{color:#000000;}.spclbtn, #back-to-top{color:#ffffff;background-color:#358247;}.woocommerce #respond input#submit, .woocommerce a.button, .woocommerce button.button, .woocommerce input.button{color:#ffffff;background-color:#358247;}.woocommerce #respond input#submit:hover, .woocommerce a.button:hover, .woocommerce button.button:hover, .woocommerce input.button:hover{color:#ffffff;background-color:#000000;}.woocommerce #respond input#submit.alt, .woocommerce a.button.alt, .woocommerce button.button.alt, .woocommerce input.button.alt{color:#ffffff;background-color:#358247;}.woocommerce #respond input#submit.alt:hover, .woocommerce a.button.alt:hover, .woocommerce button.button.alt:hover, .woocommerce input.button.alt:hover{color:#ffffff;background-color:#000000;}.woocommerce-product-search input[type="submit"]{color:#ffffff;background-color:#358247;}.wpcf7-form .wpcf7-form-control.wpcf7-submit{color:#ffffff;background-color:#358247;}.spclbtn:hover, #back-to-top:hover{background-color:#000000;}.woocommerce-product-search input[type="submit"]:hover{background-color:#000000;}.wpcf7-form .wpcf7-form-control.wpcf7-submit:hover{background-color:#000000;}#navbar .navbar-brand{color:#E2E2E2;}.navbar-default .navbar-nav > li > a{color:#E2E2E2;}.navbar-default .navbar-nav > li > a:hover, .navbar-default .navbar-nav > li > a:focus{color:#ffffff;}.navbar-default .navbar-nav > .active > a, .navbar-default .navbar-nav > .active > a:hover, .navbar-default .navbar-nav > .active > a:focus{color:#ffffff;}.navbar-default .navbar-nav > li.current-menu-parent > a{color:#ffffff;}#navbar{background-color:rgba(1, 9, 3, 0.50);}.afterscroolnav{background-color:rgba(1, 9, 3, 0.30)!important;}#navbar .dropdown-menu a{color:#6b6b6b;background-color:#f4f4f4;}#navbar .dropdown-menu > .active > a, #navbar .dropdown-menu > .active > a:hover, #navbar .dropdown-menu > .active > a:focus{color:#000000;}#navbar .dropdown-menu a:hover{color:#000000;}#navbar .dropdown-menu > .active > a, #navbar .dropdown-menu a:hover, #navbar .dropdown-menu > a:focus{background-color:#358247;}.postsloop{background-color:#ffffff;}.sticky{background-color:#d3d3d3;}#comments .comment.even{color:#000000;background-color:#f8f8f8;}#comments .pingback.even{color:#000000;background-color:#f8f8f8;}#comments .comment.odd{color:#000000;background-color:#eeeeee;}#comments .pingback.odd{color:#000000;background-color:#eeeeee;}.footer-copyright a{color:#395132;}.footer-copyright a:hover{color:#44C47E;}#logoasimg .custom-logo{width:200px;}
</style>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/plugins/en-spam/en-spam.js?ver=6.7.1" id="en-spam-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/ntf_new/showdown.min.js?ver=6.7.1" id="showdown-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<!--[if lt IE 9]>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/switty/js/html5shiv.js?ver=3.7.3" id="html5shiv-js"></script>
<![endif]-->
<!--[if lt IE 9]>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/switty/js/respond.js?ver=1.1.5" id="respond-js"></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blag.nullteilerfrei.de/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://blag.nullteilerfrei.de/wp-json/wp/v2/posts/5433" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blag.nullteilerfrei.de/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel="canonical" href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/" />
<link rel='shortlink' href='https://blag.nullteilerfrei.de/?p=5433' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://blag.nullteilerfrei.de/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblag.nullteilerfrei.de%2F2020%2F08%2F23%2Fprogrammatically-nop-the-current-selection-in-ghidra%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://blag.nullteilerfrei.de/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblag.nullteilerfrei.de%2F2020%2F08%2F23%2Fprogrammatically-nop-the-current-selection-in-ghidra%2F&#038;format=xml" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-image: url("https://blag.nullteilerfrei.de/wp-content/uploads/2017/06/bg_bw.jpg"); background-position: center center; background-size: cover; background-repeat: no-repeat; background-attachment: fixed; }
</style>
	</head>

<body class="post-template-default single single-post postid-5433 single-format-standard custom-background" >

<nav id="navbar" class="navbar navbar-default navbar-fixed-top" >
<div class="container">
	<div class="navbar-header">
		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
			<span class="sr-only">Toggle navigation</span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>
					<a class="navbar-brand" href="https://blag.nullteilerfrei.de/"> nullteilerfrei</a>
				
	</div>
						
	<div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse"><ul id="primary-menu" class="nav navbar-nav navbar-right"><li id="menu-item-3880" class="bop-nav-search menu-item menu-item-type-search menu-item-object- menu-item-3880">			<form  class="bop-nav-search menu-item menu-item-type-search menu-item-object- menu-item-3880" role="search" method="get" action="https://blag.nullteilerfrei.de/">
								<div>
					<label class="screen-reader-text" for="s">Search</label>					<input type="text" value="" name="s" id="s" />
											<input type="submit" id="searchsubmit" value="search" />
									</div>
			</form>
		</li>
<li id="menu-item-272" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-272"><a title="about" href="https://blag.nullteilerfrei.de/about/"><span class="glyphicon The who, the what, the why."></span>&nbsp;about</a></li>
<li id="menu-item-3858" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3858"><a title="admin" href="https://blag.nullteilerfrei.de/wp-admin/">admin</a></li>
</ul></div></div>
</nav>




<div id="maincontainer" class="container-fluid mrt50 mrb35">
	<div class="container">
		<div class="row">

<div class="col-md-12">
	<div id="post-5433" class="clearfix postsloop mrt50 post-5433 post type-post status-publish format-standard hentry category-malware category-tech">
	<div class="content-first pdb20" itemscope itemtype="http://schema.org/CreativeWork">

					
		<div class="content-second pdl20 pdr20">
			<h1 class="the-title entry-title" itemprop="headline">Programmatically NOP the Current Selection in Ghidra</h1>
		</div>
					
		<div class="content-third pdl20 pdr20">
			
			
	<hr class="mrt10 mrb10" />
	
	<span class="switty-entry-meta">
		
		<span class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="fn"> <a class="url authorurl" rel="author" itemprop="url" href="https://blag.nullteilerfrei.de/author/born/" ><span itemprop="name">born</span></a></span></span>
						
					<span class="categoryurl"><a href="https://blag.nullteilerfrei.de/category/tech/malware/" rel="category tag">malware-analysis</a>, <a href="https://blag.nullteilerfrei.de/category/tech/" rel="category tag">technology</a></span>
								
		<a href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/" ><span class="post-date updated" itemprop="dateModified">2020-08-23</span></a>
						
	</span>
			
	<hr class="mrt10 mrb10" />

				
			<div class="entry-content" itemprop="text">
					
				<div class='showdown'>The Zlob malware contains lots of bogus API calls to hinder analysis. This blag post describes how to use a script in Ghidra to automate the process of patching out those calls with <code>NOP</code> instructions.

<span id="more-5433"></span>

The malware employs some basic obfuscation techniques, one of which is performing lots of API calls without side effects. This makes both the disassembly as well as the decompile view hard to read. The following excerpts where take from a random sample belonging to this family (SHA256 hash <code>0b38ca277bbb042d43bd1f17c4e424e167020883526eb2527ba929b2f0990a8f</code>):

<pre><code>ff d5 | CALL EBP=&gt;KERNEL32.DLL::GetCurrentThreadId
ff d5 | CALL EBP=&gt;KERNEL32.DLL::GetCurrentThreadId
ff d6 | CALL ESI=&gt;KERNEL32.DLL::GetLastError      
ff d7 | CALL EDI=&gt;KERNEL32.DLL::GetConsoleCP      
ff d6 | CALL ESI=&gt;KERNEL32.DLL::GetLastError      
ff d6 | CALL ESI=&gt;KERNEL32.DLL::GetLastError      
ff d6 | CALL ESI=&gt;KERNEL32.DLL::GetLastError      
ff d7 | CALL EDI=&gt;KERNEL32.DLL::GetConsoleCP      
ff d6 | CALL ESI=&gt;KERNEL32.DLL::GetLastError      
ff d7 | CALL EDI=&gt;KERNEL32.DLL::GetConsoleCP      
ff d6 | CALL ESI=&gt;KERNEL32.DLL::GetLastError      </code></pre>
And the corresponding decompile view:

<pre><code class="c">GetCurrentThreadId();
GetCurrentThreadId();
GetLastError();
GetConsoleCP();
GetLastError();
GetLastError();
GetLastError();
GetConsoleCP();
GetLastError();
GetConsoleCP();
GetLastError();
[...]</code></pre>
You can "just" hit Ctrlf+Shift+G after selecting every call (and the following byte) to replace it with the <code>NOP</code> instruction (<code>0x90</code>) but this is a more than tedious process (it would be even more tedious to right click into the Listing view and select "Patch Instruction"). Let's write a handy script to automate this:

<pre><code class="java">public void run() throws Exception {
    if (currentSelection != null) {
        AddressRangeIterator addressRanges = currentSelection.getAddressRanges(true);
        for (AddressRange addressRange : addressRanges) {
            nopOut(addressRange.getMinAddress(), addressRange.getLength());
        }
    }
}

private void nopOut(Address addressStart, long length) throws CancelledException, MemoryAccessException {
    clearListing(addressStart, addressStart.add(length));
    for (int i = 0; i &lt; length; i++) {
        Address address = addressStart.add(i);
        setByte(address, (byte) 0x90);
    }

    disassemble(addressStart);
}</code></pre>
If you assign this script to the keyboard shortcut Ctrl-Alt-Shift-N for example, you can just select regions of disassembly and hit that combination to replace everything with <code>NOP</code>.

## A tiny plot-twist

Since selecting calls in the decompile view will also highlight disassembly, one might think that you can as easily select region of the decompile view, execute the same script and come to the same result. Sadly this is not the case: If you select a line in the decompile view, the corresponding selection in the disassembly will always only have length 1. 

<img fetchpriority="high" decoding="async" src="https://blag.nullteilerfrei.de/wp-content/uploads/2020/08/disassembly-selection-1024x212.png" alt="" width="1024" height="212" class="aligncenter size-large wp-image-5434 size-full" style="border:4px solid #ddd;" srcset="https://blag.nullteilerfrei.de/wp-content/uploads/2020/08/disassembly-selection-1024x212.png 1024w, https://blag.nullteilerfrei.de/wp-content/uploads/2020/08/disassembly-selection-300x62.png 300w, https://blag.nullteilerfrei.de/wp-content/uploads/2020/08/disassembly-selection-768x159.png 768w, https://blag.nullteilerfrei.de/wp-content/uploads/2020/08/disassembly-selection.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" />

While one might think that in the screenshot above, the selection in the disassembly has a lenght of 6 and ranges from 0x10003a34 to 0x10003a3a (exclusively) it is in fact three selections, each of length 1 starting at <code>0x10003a34</code>, <code>0x10003a36</code> and, <code>0x10003a38</code>. Executing the above script will hence result in the byte sequence <code>90 d3 90 d3 90 d3</code> which cannot even be disassembled.

So let's not pass in <code>addressRange.getLength()</code> into the <code>nopOut</code> function but instead extend the length such that the last instruction is always included completely:

<pre><code class="java">/**
 * Searchers backwards for the last assembly instruction and returns the length
 * of the address range, potentially extended to fully include this last
 * instruction.
 */
private long assemblyAlignedLength(AddressRange addressRange) {
	long length = addressRange.getLength();
	for (int i = 1; i &lt;= MAX_ASSEMBLY_INSTRUCTION_LENGTH; i++) {
		Instruction instruction = getInstructionAt(addressRange.getMinAddress().add(length - i));
		if (instruction != null) {
			return length + (instruction.getLength() - i);
		}
	}

	return length;
}</code></pre>
<a href="https://github.com/nullteilerfrei/reversing-class/blob/master/scripts/java/NopThisShit.java">You can find the complete <code>nts.java</code> script on github!</a>

Edit (2023-10-01): F2 is not correct, Ctrl-Shift-G it is.
</div>						
				<div class="clearfix pdt20"></div>
						
										
										
			</div>

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			3 Replies to &ldquo;Programmatically NOP the Current Selection in Ghidra&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-31460" class="comment even thread-even depth-1 parent">
			<article id="div-comment-31460" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9e263681488308e5e5d5e548b2f9bc99?s=42&#038;r=g' srcset='https://secure.gravatar.com/avatar/9e263681488308e5e5d5e548b2f9bc99?s=84&#038;r=g 2x' class='avatar avatar-42 photo' height='42' width='42' decoding='async'/>						<b class="fn">cweiske</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/#comment-31460"><time datetime="2023-10-01T07:51:44+01:00">2023-10-01 at 7:51 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<div class='showdown'>Vanilla Ghidra 10.4 does not have a keybinding of F2 to NOP instructions. Was that already another plugin? Which?
</div>				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/?replytocom=31460#respond" data-commentid="31460" data-postid="5433" data-belowelement="div-comment-31460" data-respondelement="respond" data-replyto="Reply to cweiske" aria-label="Reply to cweiske">Reply</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-31461" class="comment odd alt depth-2">
			<article id="div-comment-31461" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4949f5a9b72917f8ae6635a34aea9fb0?s=42&#038;r=g' srcset='https://secure.gravatar.com/avatar/4949f5a9b72917f8ae6635a34aea9fb0?s=84&#038;r=g 2x' class='avatar avatar-42 photo' height='42' width='42' decoding='async'/>						<b class="fn"><a href="https://www.wallenborn.net/" class="url" rel="ugc external nofollow">larsborn</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/#comment-31461"><time datetime="2023-10-01T17:54:00+01:00">2023-10-01 at 5:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<div class='showdown'>Hey Christian, no idea where the F2 came from :-) what I meant (and I'll actually edit the blag post in a second) seems to be Ctrlf+Shift+G to assemble a new instruction. This is also available through right clicking in the Listing view and selecting "Patch Instruction".
</div>				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/?replytocom=31461#respond" data-commentid="31461" data-postid="5433" data-belowelement="div-comment-31461" data-respondelement="respond" data-replyto="Reply to larsborn" aria-label="Reply to larsborn">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-31512" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-31512" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b57d0490fbc725eee7e703453c2dede7?s=42&#038;r=g' srcset='https://secure.gravatar.com/avatar/b57d0490fbc725eee7e703453c2dede7?s=84&#038;r=g 2x' class='avatar avatar-42 photo' height='42' width='42' loading='lazy' decoding='async'/>						<b class="fn"><a href="http://qh6.de" class="url" rel="ugc external nofollow">Hudson Hyam</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/#comment-31512"><time datetime="2024-10-16T18:19:03+01:00">2024-10-16 at 6:19 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<div class='showdown'>Great job site admin! You have made it look so easy talking about that topic, providing your readers some vital information. I would love to see more helpful articles like this, so please keep posting! I also have great posts about Car Purchase, check out my weblog at <a href="https://shop.mediaport.cz/redirect.php?action=url&amp;goto=qh6.de/autoprofi-24/autoankauf-darmstadt" rel="nofollow ugc">QH6</a>
</div>				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://blag.nullteilerfrei.de/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/?replytocom=31512#respond" data-commentid="31512" data-postid="5433" data-belowelement="div-comment-31512" data-respondelement="respond" data-replyto="Reply to Hudson Hyam" aria-label="Reply to Hudson Hyam">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="clearfix"></div>
		
		
		<div class="clearfix"></div>

	
	
		<div id="respond" class="comment-respond">
		<h2 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2020/08/23/programmatically-nop-the-current-selection-in-ghidra/#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://blag.nullteilerfrei.de/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><div class="form-group comment-form-comment">
		<label for="comment">Comment<span class="required"> *</span></label> 
		<textarea class="form-control" placeholder="Your comment" id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea>
		</div><div class="form-group comment-form-author"><label for="author">Name <span class="required">*</span></label> <input class="form-control" placeholder="Your name" id="author" name="author" type="text" value="" size="30" aria-required='true' /></div>
<div class="form-group comment-form-email"><label for="email">Email <span class="required">*</span></label> <input class="form-control" placeholder="Your email" id="email" name="email" type="text" value="" size="30" aria-required='true' /></div>
<div class="form-group comment-form-url"><label for="url">Website</label> <input class="form-control" placeholder="Your website" id="url" name="url" type="text" value="" size="30" /></div>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="spclbtn" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='5433' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
</div><!-- .comments-area -->
				
		</div>
			
	</div>
</div>

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://blag.nullteilerfrei.de/2020/07/11/custom-jsonencoder-and-jsondecoder-to-handle-datetime-in-pythons-json-library/" rel="prev">&larr; Custom JSONEncoder and JSONDecoder to handle datetime in Python&#8217;s json library</a></div><div class="nav-next"><a href="https://blag.nullteilerfrei.de/2020/09/19/vmware-for-homelab/" rel="next">VMware for Homelab &rarr;</a></div></div>
	</nav></div>
		</div>
	</div>
</div>


<div class="container-fluid footer-copyright">
	<div class="container">
		<div class="row">

			<div class="col-md-6">
				<div class="cprtlft_ctmzr">
					Authors have copyrights. People say these things in footers.				</div>
			</div>

			<div class="col-md-6">
				<div class="cprtrgt_ctmzr fr spclfl">
					All Hail the Great Yawgmoth, Father of Machines.				</div>
			</div>

		</div>
	</div>
</div>


<link rel='stylesheet' id='hljstheme-css' href='https://blag.nullteilerfrei.de/wp-content/plugins/wp-code-highlightjs/styles/default.css?ver=0.6.2' type='text/css' media='all' />
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/ntf_new/katex/katex.min.js?ver=6.7.1" id="katex-main-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/ntf_new/auto-render.min.js?ver=6.7.1" id="katex-auto-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/ntf_new/default.js?ver=6.7.1" id="configure-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/switty/js/bootstrap.js?ver=3.3.7" id="bootstrap-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-includes/js/imagesloaded.min.js?ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-includes/js/masonry.min.js?ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/themes/switty/js/script.js?ver=1.1.5" id="switty-script-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-includes/js/comment-reply.min.js?ver=6.7.1" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/plugins/wp-code-highlightjs/highlight.common.pack.js?ver=0.6.2" id="hljs_preload-js"></script>
<script type="text/javascript" src="https://blag.nullteilerfrei.de/wp-content/plugins/wp-code-highlightjs/highlight.custom.pack.js?ver=0.6.2" id="hljs-js"></script>
    <style>pre.hljs {padding: 5px;}
pre.hljs code {}</style>
    <script type="text/javascript">
    (function($, window) {
        var init_fn_flag = false;
        var init_fn = (function() {
            if (init_fn_flag)
                return;
            init_fn_flag = true;
             hljs.configure({"tabReplace":"    "});
            $('pre code').each(function(i, block) {
                hljs.highlightBlock(block);
            });
        });
        $(document).ready(init_fn);
        $(window).on("load", init_fn);
    })(jQuery, window);
    </script>
<img src="https://vg09.met.vgwort.de/na/a44643b1efbb40b69043917e23afb744" width="1" height="1" alt="" class="wpvgw-marker-image" loading="eager" data-no-lazy="1" referrerpolicy="no-referrer-when-downgrade" style="display:none;" /></body>
</html>
