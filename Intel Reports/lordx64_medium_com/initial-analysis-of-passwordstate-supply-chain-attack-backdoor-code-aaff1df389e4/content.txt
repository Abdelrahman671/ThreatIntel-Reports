<!doctype html><html lang="en"><head><title data-rh="true">Initial analysis of PasswordState supply chain attack backdoor code | by taha aka &quot;lordx64&quot; | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2021-04-24T18:51:04.842Z"/><meta data-rh="true" name="title" content="Initial analysis of PasswordState supply chain attack backdoor code | by taha aka &quot;lordx64&quot; | Medium"/><meta data-rh="true" property="og:title" content="Initial  analysis of PasswordState supply chain attack backdoor code"/><meta data-rh="true" property="al:android:url" content="medium://p/aaff1df389e4"/><meta data-rh="true" property="al:ios:url" content="medium://p/aaff1df389e4"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="UPDATE — 24 April 2021: The second stage payload was shared with me by Peter Kruse (@PeterKruse) thanks to him. Please find the second stage payload analysis at the end of this document. One hour…"/><meta data-rh="true" property="og:description" content="One hour ago, I became aware of this supply chain attack from tweet by Kim Zetter. If you don’t follow her please do and subscribe to her…"/><meta data-rh="true" property="og:url" content="https://lordx64.medium.com/initial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4"/><meta data-rh="true" property="al:web:url" content="https://lordx64.medium.com/initial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*rnNDVgt04qrqCAsZ"/><meta data-rh="true" property="article:author" content="https://lordx64.medium.com"/><meta data-rh="true" name="author" content="taha aka &quot;lordx64&quot;"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Initial  analysis of PasswordState supply chain attack backdoor code"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/aaff1df389e4"/><meta data-rh="true" property="twitter:description" content="One hour ago, I became aware of this supply chain attack from tweet by Kim Zetter. If you don’t follow her please do and subscribe to her…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*rnNDVgt04qrqCAsZ"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@lordx64"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="7 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://lordx64.medium.com"/><link data-rh="true" rel="canonical" href="https://lordx64.medium.com/initial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/aaff1df389e4"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*rnNDVgt04qrqCAsZ"],"url":"https:\u002F\u002Flordx64.medium.com\u002Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4","dateCreated":"2021-04-23T22:47:51.342Z","datePublished":"2021-04-23T22:47:51.342Z","dateModified":"2022-01-07T00:42:04.543Z","headline":"Initial analysis of PasswordState supply chain attack backdoor code","name":"Initial analysis of PasswordState supply chain attack backdoor code","description":"UPDATE — 24 April 2021: The second stage payload was shared with me by Peter Kruse (@PeterKruse) thanks to him. Please find the second stage payload analysis at the end of this document. One hour…","identifier":"aaff1df389e4","author":{"@type":"Person","name":"taha aka \"lordx64\"","url":"https:\u002F\u002Flordx64.medium.com"},"creator":["taha aka \"lordx64\""],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Flordx64.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Flordx64.medium.com\u002Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4"}</script><style type="text/css" data-fela-rehydration="583" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="583" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{margin-left:auto}.mh{margin-right:auto}.mi{max-width:7952px}.mo{clear:both}.mq{cursor:zoom-in}.mr{z-index:auto}.mt{height:auto}.mu{margin-top:10px}.mv{max-width:728px}.my{text-decoration:underline}.mz{line-height:1.58}.na{letter-spacing:-0.004em}.nb{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nw{margin-bottom:-0.46em}.oc{margin:auto}.od{overflow:hidden}.oe{padding-bottom:56.199999999999996%}.of{height:0}.og{box-shadow:inset 3px 0 0 0 #242424}.oh{padding-left:23px}.oi{margin-left:-20px}.oj{font-style:italic}.ok{max-width:2350px}.oq{width:52.63%}.or{margin-right:10px}.os{padding-top:5px}.ot{padding-bottom:5px}.ou:last-of-type{margin-right:0}.ov{width:47.37%}.ow{width:211%}.ox{left:calc(-5.5% - 8px)}.oy{transform:translateX(-50%)}.oz{width:45.4%}.pa{width:54.6%}.pb{width:183%}.pc{left:calc(8.5% - 8px)}.pd{max-width:1180px}.pe{max-width:1306px}.pf{max-width:2068px}.pg{max-width:1652px}.ph{max-width:2048px}.pi{max-width:2104px}.pj{max-width:2326px}.pk{max-width:1744px}.pl{max-width:1064px}.pm{overflow-x:auto}.pn{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.po{padding:20px}.pp{border-radius:0}.pq{background:#F2F2F2}.pr{line-height:1.18}.ps{letter-spacing:-0.022em}.pt{margin-top:-0.09em}.pu{margin-bottom:-0.09em}.pv{white-space:pre-wrap}.pw{min-width:fit-content}.px{margin-top:0.91em}.py{max-width:1034px}.pz{max-width:1856px}.qa{list-style-type:disc}.qb{margin-left:30px}.qc{padding-left:0px}.qi{max-width:2178px}.qj{max-width:2172px}.qk{max-width:1136px}.ql{max-width:2066px}.qm{max-width:1904px}.qn{max-width:1824px}.qo{font-weight:600}.qp{line-height:1.12}.rk{margin-bottom:-0.28em}.rq{margin-bottom:26px}.rr{margin-top:6px}.rs{margin-top:8px}.rt{margin-right:8px}.ru{padding:8px 16px}.rv{border-radius:100px}.rw{transition:background 300ms ease}.ry{white-space:nowrap}.rz{border-top:none}.sa{margin-bottom:14px}.sb{height:52px}.sc{max-height:52px}.sd{box-sizing:content-box}.se{position:static}.sf{z-index:1}.sh{max-width:155px}.sn{margin-right:20px}.st{height:0px}.su{margin-bottom:40px}.tj{height:64px}.tk{width:64px}.tl{align-self:flex-end}.tm{color:rgba(255, 255, 255, 1)}.tn{fill:rgba(255, 255, 255, 1)}.to{background:rgba(25, 25, 25, 1)}.tp{border-color:rgba(25, 25, 25, 1)}.ts:disabled{opacity:0.1}.tt:disabled:hover{background:rgba(25, 25, 25, 1)}.tu:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tv{flex:1 1 auto}.tz{padding-right:4px}.ua{font-weight:500}.un{margin-top:16px}.uo{margin-bottom:54px}.uu{gap:18px}.uv{fill:rgba(61, 61, 61, 1)}.vh{border-bottom:solid 1px #E5E5E5}.vi{margin-top:72px}.vj{padding:24px 0}.vk{margin-bottom:0px}.vl{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.rx:hover{background-color:#F2F2F2}.ti:hover{background-color:none}.tq:hover{background:#000000}.tr:hover{border-color:#242424}.uw:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.ms:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mn{margin-top:40px}.ns{font-size:20px}.nt{margin-top:2.14em}.nu{line-height:32px}.nv{letter-spacing:-0.003em}.ob{margin-top:56px}.op{max-width:1192px}.qh{margin-top:1.14em}.rg{font-size:24px}.rh{margin-top:1.95em}.ri{line-height:30px}.rj{letter-spacing:-0.016em}.rp{margin-top:0.94em}.sm{display:inline-block}.ss{margin-bottom:104px}.sv{flex-direction:row}.sy{margin-bottom:0}.sz{margin-right:20px}.tw{max-width:500px}.ul{line-height:24px}.um{letter-spacing:0}.ut{margin-bottom:72px}.vb{margin:40px 0 0}.vg{padding-top:72px}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.mw{margin-left:auto}.mx{text-align:center}.sl{display:inline-block}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.sk{display:inline-block}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.sj{display:inline-block}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{margin-top:32px}.nc{font-size:18px}.nd{margin-top:1.56em}.ne{line-height:28px}.nf{letter-spacing:-0.003em}.nx{margin-top:40px}.ol{max-width:100%}.qd{margin-top:1.34em}.qq{font-size:20px}.qr{margin-top:1.2em}.qs{line-height:24px}.qt{letter-spacing:0}.rl{margin-top:0.67em}.si{display:inline-block}.so{margin-bottom:96px}.tg{margin-bottom:20px}.th{margin-right:0}.ub{font-size:24px}.uc{line-height:30px}.ud{letter-spacing:-0.016em}.up{margin-bottom:64px}.ux{margin:32px 0 0}.vc{padding-top:48px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mm{margin-top:40px}.no{font-size:20px}.np{margin-top:2.14em}.nq{line-height:32px}.nr{letter-spacing:-0.003em}.oa{margin-top:56px}.oo{max-width:1192px}.qg{margin-top:1.14em}.rc{font-size:24px}.rd{margin-top:1.95em}.re{line-height:30px}.rf{letter-spacing:-0.016em}.ro{margin-top:0.94em}.sr{margin-bottom:104px}.sw{flex-direction:row}.ta{margin-bottom:0}.tb{margin-right:20px}.tx{max-width:500px}.uj{line-height:24px}.uk{letter-spacing:0}.us{margin-bottom:72px}.va{margin:40px 0 0}.vf{padding-top:72px}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.ml{margin-top:40px}.nk{font-size:20px}.nl{margin-top:2.14em}.nm{line-height:32px}.nn{letter-spacing:-0.003em}.nz{margin-top:56px}.on{max-width:100%}.qf{margin-top:1.14em}.qy{font-size:24px}.qz{margin-top:1.95em}.ra{line-height:30px}.rb{letter-spacing:-0.016em}.rn{margin-top:0.94em}.sq{margin-bottom:104px}.sx{flex-direction:row}.tc{margin-bottom:0}.td{margin-right:20px}.ty{max-width:500px}.uh{line-height:24px}.ui{letter-spacing:0}.ur{margin-bottom:72px}.uz{margin:40px 0 0}.ve{padding-top:72px}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mk{margin-top:32px}.ng{font-size:18px}.nh{margin-top:1.56em}.ni{line-height:28px}.nj{letter-spacing:-0.003em}.ny{margin-top:40px}.om{max-width:100%}.qe{margin-top:1.34em}.qu{font-size:20px}.qv{margin-top:1.2em}.qw{line-height:24px}.qx{letter-spacing:0}.rm{margin-top:0.67em}.sp{margin-bottom:96px}.te{margin-bottom:20px}.tf{margin-right:0}.ue{font-size:24px}.uf{line-height:30px}.ug{letter-spacing:-0.016em}.uq{margin-bottom:64px}.uy{margin:32px 0 0}.vd{padding-top:48px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="print">.sg{display:none}</style><style type="text/css" data-fela-rehydration="583" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.mp{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faaff1df389e4&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="faa9" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Initial analysis of PasswordState supply chain attack backdoor code</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--aaff1df389e4--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="taha aka &quot;lordx64&quot;" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*CeV88vA72XwNGRvC79wSOg.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--aaff1df389e4--------------------------------">taha aka &quot;lordx64&quot;</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F74f7de1013c&amp;operation=register&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;user=taha+aka+%22lordx64%22&amp;userId=74f7de1013c&amp;source=post_page-74f7de1013c--byline--aaff1df389e4---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Apr 23, 2021</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Faaff1df389e4&amp;operation=register&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;user=taha+aka+%22lordx64%22&amp;userId=74f7de1013c&amp;source=---header_actions--aaff1df389e4---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaff1df389e4&amp;operation=register&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;source=---header_actions--aaff1df389e4---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mj mk ml mm mn mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh mi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*rnNDVgt04qrqCAsZ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*rnNDVgt04qrqCAsZ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*rnNDVgt04qrqCAsZ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*rnNDVgt04qrqCAsZ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*rnNDVgt04qrqCAsZ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*rnNDVgt04qrqCAsZ 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rnNDVgt04qrqCAsZ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*rnNDVgt04qrqCAsZ 640w, https://miro.medium.com/v2/resize:fit:720/0*rnNDVgt04qrqCAsZ 720w, https://miro.medium.com/v2/resize:fit:750/0*rnNDVgt04qrqCAsZ 750w, https://miro.medium.com/v2/resize:fit:786/0*rnNDVgt04qrqCAsZ 786w, https://miro.medium.com/v2/resize:fit:828/0*rnNDVgt04qrqCAsZ 828w, https://miro.medium.com/v2/resize:fit:1100/0*rnNDVgt04qrqCAsZ 1100w, https://miro.medium.com/v2/resize:fit:1400/0*rnNDVgt04qrqCAsZ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="467" loading="eager" role="presentation"/></picture></div></div><figcaption class="mu ff mv mg mh mw mx bf b bg z du">Photo by <a class="af my" href="https://unsplash.com/@purzlbaum?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Claudio Schwarz | @purzlbaum</a> on <a class="af my" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7e00" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk"><strong class="nb gv">UPDATE</strong> — 24 April 2021: The second stage payload was shared with me by Peter Kruse (@<a class="af my" href="https://twitter.com/peterkruse" rel="noopener ugc nofollow" target="_blank">PeterKruse</a>) thanks to him. Please find the second stage payload analysis at the end of this document.</p><p id="4a83" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">One hour ago, I became aware of this supply chain attack from a tweet by Kim Zetter. If you don’t follow her please do and subscribe to her blog for amazing cyber espionage related content : <a class="af my" href="mailto:zetter@substack.com" rel="noopener ugc nofollow" target="_blank">zetter@substack.com</a></p><figure class="nx ny nz oa ob mo"><div class="oc od l fj"><div class="oe of l"></div></div></figure><p id="f6ec" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Why this quick analysis? well it’s Friday, and this news will worry a lot of people, and many would want to know what is this about and fast.</p><blockquote class="og oh oi"><p id="befc" class="mz na oj nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Note: Based on ClickStudios customers, this attack might be impacting 29 000 enterprise customers including many Fortune 500 clients.</p></blockquote><p id="e6fe" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Based on the initial information we have, I will explain in details how this legitimate software: PasswordState from ClickStudios, was backdoored, as well as how to detect this backdoor.</p><p id="dd30" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">There was an official statement from CSIS group on their website, saying that ClickStudios recently notified their customers about a breach resulting in a supply chain attack conducted via an update of the password manager PASSWORDSTATE. the attack was noticed between 20th of April 2021 8:33 PM UTC and 22nd of April 2021 00.30am UTC</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh ok"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8edWR4HHiPRU_Tt-IdfWDw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8edWR4HHiPRU_Tt-IdfWDw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8edWR4HHiPRU_Tt-IdfWDw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8edWR4HHiPRU_Tt-IdfWDw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8edWR4HHiPRU_Tt-IdfWDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8edWR4HHiPRU_Tt-IdfWDw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8edWR4HHiPRU_Tt-IdfWDw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8edWR4HHiPRU_Tt-IdfWDw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8edWR4HHiPRU_Tt-IdfWDw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8edWR4HHiPRU_Tt-IdfWDw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8edWR4HHiPRU_Tt-IdfWDw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8edWR4HHiPRU_Tt-IdfWDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8edWR4HHiPRU_Tt-IdfWDw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8edWR4HHiPRU_Tt-IdfWDw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="118" loading="lazy" role="presentation"/></picture></div></div><figcaption class="mu ff mv mg mh mw mx bf b bg z du">source: <a class="af my" href="https://www.csis.dk/newsroom-blog-overview/2021/moserpass-supply-chain/" rel="noopener ugc nofollow" target="_blank">https://www.csis.dk/newsroom-blog-overview/2021/moserpass-supply-chain/</a></figcaption></figure><p id="5aa3" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">CSIS group shared IOC’s, I confirmed them and below is the analysis of the backdoor code.</p><p id="c4cc" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Sample in question is a rogue DLL file, downloaded during an update of PasswordState ( I am not sure yet which version of PasswordState exactly): f23f9c2aaf94147b2c5d4b39b56514cd67102d3293bdef85101e2c05ee1c3bf9 Moserware.SecretSplitter.dll</p><p id="a921" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">The backdoor code was inserted in the assembly, via a Loader method see below :</p></div></div><div class="mo"><div class="ab cb"><div class="li ol lj om lk on cf oo cg op ci bh"><div class="nx ny nz oa ob ab ke"><figure class="le mo oq or os ot ou paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-mbV4nRKv5y3EMbUoEQHzg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-mbV4nRKv5y3EMbUoEQHzg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-mbV4nRKv5y3EMbUoEQHzg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-mbV4nRKv5y3EMbUoEQHzg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-mbV4nRKv5y3EMbUoEQHzg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-mbV4nRKv5y3EMbUoEQHzg.png 1100w, https://miro.medium.com/v2/resize:fit:1054/format:webp/1*-mbV4nRKv5y3EMbUoEQHzg.png 1054w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 527px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-mbV4nRKv5y3EMbUoEQHzg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-mbV4nRKv5y3EMbUoEQHzg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-mbV4nRKv5y3EMbUoEQHzg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-mbV4nRKv5y3EMbUoEQHzg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-mbV4nRKv5y3EMbUoEQHzg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-mbV4nRKv5y3EMbUoEQHzg.png 1100w, https://miro.medium.com/v2/resize:fit:1054/1*-mbV4nRKv5y3EMbUoEQHzg.png 1054w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 527px"/><img alt="" class="bh ln mt c" width="527" height="376" loading="eager" role="presentation"/></picture></div></figure><figure class="le mo ov or os ot ou paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JVyT8W6e0TdbN-S0G71bTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JVyT8W6e0TdbN-S0G71bTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JVyT8W6e0TdbN-S0G71bTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JVyT8W6e0TdbN-S0G71bTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JVyT8W6e0TdbN-S0G71bTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JVyT8W6e0TdbN-S0G71bTQ.png 1100w, https://miro.medium.com/v2/resize:fit:948/format:webp/1*JVyT8W6e0TdbN-S0G71bTQ.png 948w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 474px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JVyT8W6e0TdbN-S0G71bTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JVyT8W6e0TdbN-S0G71bTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JVyT8W6e0TdbN-S0G71bTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JVyT8W6e0TdbN-S0G71bTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JVyT8W6e0TdbN-S0G71bTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JVyT8W6e0TdbN-S0G71bTQ.png 1100w, https://miro.medium.com/v2/resize:fit:948/1*JVyT8W6e0TdbN-S0G71bTQ.png 948w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 474px"/><img alt="" class="bh ln mt c" width="474" height="414" loading="eager" role="presentation"/></picture></div><figcaption class="mu ff mv mg mh mw mx bf b bg z du ow fj ox oy">clean vs backdoored</figcaption></figure></div></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="9166" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">(compared it with a clean version of this dll: 1ee0f14c44058e3d0d1c19b4713d573c81b49c28ed58bd41c72832c78f7d1464)</p><p id="5ed6" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Next let’s jump into the backdoor code and how it’s been called from the legitimate code:</p><p id="2186" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Inside the namespace Moserware.Security.Cryptography, there’s class named Diffuser, containing a protected method called Diffuse() which is the constructor of this virtual class:</p></div></div><div class="mo"><div class="ab cb"><div class="li ol lj om lk on cf oo cg op ci bh"><div class="nx ny nz oa ob ab ke"><figure class="le mo oz or os ot ou paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*N_T_YuwnQo4IWGixRJtoNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*N_T_YuwnQo4IWGixRJtoNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*N_T_YuwnQo4IWGixRJtoNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*N_T_YuwnQo4IWGixRJtoNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*N_T_YuwnQo4IWGixRJtoNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*N_T_YuwnQo4IWGixRJtoNQ.png 1100w, https://miro.medium.com/v2/resize:fit:908/format:webp/1*N_T_YuwnQo4IWGixRJtoNQ.png 908w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 454px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*N_T_YuwnQo4IWGixRJtoNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*N_T_YuwnQo4IWGixRJtoNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*N_T_YuwnQo4IWGixRJtoNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*N_T_YuwnQo4IWGixRJtoNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*N_T_YuwnQo4IWGixRJtoNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*N_T_YuwnQo4IWGixRJtoNQ.png 1100w, https://miro.medium.com/v2/resize:fit:908/1*N_T_YuwnQo4IWGixRJtoNQ.png 908w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 454px"/><img alt="" class="bh ln mt c" width="454" height="902" loading="eager" role="presentation"/></picture></div></figure><figure class="le mo pa or os ot ou paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1100w, https://miro.medium.com/v2/resize:fit:1094/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1094w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 547px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*gcEY81L5OJVQ-s0UyP0Hhw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gcEY81L5OJVQ-s0UyP0Hhw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gcEY81L5OJVQ-s0UyP0Hhw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gcEY81L5OJVQ-s0UyP0Hhw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gcEY81L5OJVQ-s0UyP0Hhw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1100w, https://miro.medium.com/v2/resize:fit:1094/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1094w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 547px"/><img alt="" class="bh ln mt c" width="547" height="1142" loading="eager" role="presentation"/></picture></div><figcaption class="mu ff mv mg mh mw mx bf b bg z du pb fj pc oy">clean vs backdoored version</figcaption></figure></div></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="a12e" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">I checked how this class Diffuser() was called, it is indeed used by 3 other classes, amongst them XteaDiffuser that <strong class="nb gv">inherit</strong> from Diffuser.</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*U2ZSzsqh9kj43SyIxw7ewg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*U2ZSzsqh9kj43SyIxw7ewg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*U2ZSzsqh9kj43SyIxw7ewg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*U2ZSzsqh9kj43SyIxw7ewg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*U2ZSzsqh9kj43SyIxw7ewg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*U2ZSzsqh9kj43SyIxw7ewg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2ZSzsqh9kj43SyIxw7ewg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*U2ZSzsqh9kj43SyIxw7ewg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*U2ZSzsqh9kj43SyIxw7ewg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*U2ZSzsqh9kj43SyIxw7ewg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*U2ZSzsqh9kj43SyIxw7ewg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*U2ZSzsqh9kj43SyIxw7ewg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*U2ZSzsqh9kj43SyIxw7ewg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*U2ZSzsqh9kj43SyIxw7ewg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="98" loading="eager" role="presentation"/></picture></div></div></figure><p id="b8df" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Which means every time a object XteaDiffuser is instantiated the constructor Diffuser() will be called and the backdoor code will run. XteaDiffuser object is used by SsssDiffuser() Class as an attribute and used for every Xtea encryption/decryption operations (kinda like a wrapper). which in turn called by SecretSplitter as the default diffuser. It seems PasswordState uses Xtea for splitting the secret password (based on SecretSplitter class name, didn’t look in the code in details):</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mM4DWRnC8TbmlnE-yI_eBA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mM4DWRnC8TbmlnE-yI_eBA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mM4DWRnC8TbmlnE-yI_eBA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mM4DWRnC8TbmlnE-yI_eBA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mM4DWRnC8TbmlnE-yI_eBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mM4DWRnC8TbmlnE-yI_eBA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mM4DWRnC8TbmlnE-yI_eBA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mM4DWRnC8TbmlnE-yI_eBA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mM4DWRnC8TbmlnE-yI_eBA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mM4DWRnC8TbmlnE-yI_eBA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mM4DWRnC8TbmlnE-yI_eBA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mM4DWRnC8TbmlnE-yI_eBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mM4DWRnC8TbmlnE-yI_eBA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mM4DWRnC8TbmlnE-yI_eBA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="296" loading="lazy" role="presentation"/></picture></div></div></figure><p id="53c8" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Back to the diffuser() constructor:</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*gcEY81L5OJVQ-s0UyP0Hhw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gcEY81L5OJVQ-s0UyP0Hhw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gcEY81L5OJVQ-s0UyP0Hhw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gcEY81L5OJVQ-s0UyP0Hhw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gcEY81L5OJVQ-s0UyP0Hhw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*gcEY81L5OJVQ-s0UyP0Hhw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="387" loading="lazy" role="presentation"/></picture></div></div></figure><p id="66e4" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">We have a method Container.Running(), taking 5 arguments. amongst them a URL that points to a zip file? to be downloaded from <strong class="nb gv">passwordstate-18ed2[.]kxcdn.com</strong> , and a sort of hash, which is as we will see later, is the AES password to decrypt the downloaded file.</p><p id="8d2f" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">let’s look at the Container.Running() function:</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7yxUs6dF47NcR3Qop6fr7g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7yxUs6dF47NcR3Qop6fr7g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7yxUs6dF47NcR3Qop6fr7g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7yxUs6dF47NcR3Qop6fr7g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7yxUs6dF47NcR3Qop6fr7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7yxUs6dF47NcR3Qop6fr7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yxUs6dF47NcR3Qop6fr7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7yxUs6dF47NcR3Qop6fr7g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7yxUs6dF47NcR3Qop6fr7g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7yxUs6dF47NcR3Qop6fr7g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7yxUs6dF47NcR3Qop6fr7g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7yxUs6dF47NcR3Qop6fr7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7yxUs6dF47NcR3Qop6fr7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*7yxUs6dF47NcR3Qop6fr7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="305" loading="lazy" role="presentation"/></picture></div></div></figure><p id="d30c" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">This function checks if the current process name is “Passwordstate” then Container class attributes are set (url, decryption key, interval, assemblyType (set to “Agent.Agent”), assemblyMethod (set to “Invoke”)) and the method Container.ThreadFunc() is run in a Thread in the backgroud.</p><p id="8e19" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Let’s look at Container.ThreadFunc()</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh ph"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9B8Bp4CSXKRqlB7Em6X8mw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9B8Bp4CSXKRqlB7Em6X8mw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9B8Bp4CSXKRqlB7Em6X8mw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9B8Bp4CSXKRqlB7Em6X8mw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9B8Bp4CSXKRqlB7Em6X8mw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9B8Bp4CSXKRqlB7Em6X8mw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9B8Bp4CSXKRqlB7Em6X8mw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9B8Bp4CSXKRqlB7Em6X8mw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9B8Bp4CSXKRqlB7Em6X8mw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9B8Bp4CSXKRqlB7Em6X8mw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9B8Bp4CSXKRqlB7Em6X8mw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9B8Bp4CSXKRqlB7Em6X8mw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9B8Bp4CSXKRqlB7Em6X8mw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9B8Bp4CSXKRqlB7Em6X8mw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="393" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5389" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">This function will download a file, via the method Container.Get(), will AES decrypt it using the password: <strong class="nb gv">f4f15dddc3ba10dd443493a2a8a526b0</strong> and pass it to the Loader Class(), we will describe what this class does later, then the method Loader.Process() is called.</p><p id="2cb7" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Container.Get() will set the correct User-Agent, will activate Certificate pining checks, and download a file and store it in memory:</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9hoN-u3v-QdgrA-ZHf4SxQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="414" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5564" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Note of the User-Agent used by this backdoor is the following:</p><p id="530b" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">“Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36”;</p><p id="31b7" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Notice that it is a GET request, and the url is appended with a param “<strong class="nb gv">?id=” </strong>containing the Datetime.UtcNow.ToFileTime().ToString() this returns a string representing value of the current DateTime object expressed as a Windows file time.</p><p id="a98a" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">A Windows file time is a 64-bit value that represents the number of 100-nanosecond intervals that have elapsed since 12:00 midnight, January 1, 1601 A.D. (C.E.) Coordinated Universal Time (UTC).</p><p id="0c36" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">And If we convert the value given in the CSIS website about this backdoor :</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cwPXL5_4TzmqjcGLdWm5mw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cwPXL5_4TzmqjcGLdWm5mw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cwPXL5_4TzmqjcGLdWm5mw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cwPXL5_4TzmqjcGLdWm5mw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cwPXL5_4TzmqjcGLdWm5mw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cwPXL5_4TzmqjcGLdWm5mw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cwPXL5_4TzmqjcGLdWm5mw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cwPXL5_4TzmqjcGLdWm5mw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cwPXL5_4TzmqjcGLdWm5mw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cwPXL5_4TzmqjcGLdWm5mw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cwPXL5_4TzmqjcGLdWm5mw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cwPXL5_4TzmqjcGLdWm5mw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cwPXL5_4TzmqjcGLdWm5mw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*cwPXL5_4TzmqjcGLdWm5mw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="62" loading="lazy" role="presentation"/></picture></div></div><figcaption class="mu ff mv mg mh mw mx bf b bg z du">source : <a class="af my" href="https://www.csis.dk/newsroom-blog-overview/2021/moserpass-supply-chain/" rel="noopener ugc nofollow" target="_blank">https://www.csis.dk/newsroom-blog-overview/2021/moserpass-supply-chain/</a></figcaption></figure><p id="17c2" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">it corresponds to :</p><p id="507a" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk"><strong class="nb gv">GMT</strong>: Friday, April 23, 2021 8:22:07 PM</p><p id="33e2" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Finally, now that the file upgrade_service_upgrade.zip was downloaded and stored in memory. let’s check what the Loader() class will do with this file. Loader class will set the correct attributes in the constructor. Then as we saw earlier, the backdoor called Process() function, which in turn calls the method below ThreadFunc():</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UDyx_hm2TZbh6xYA6Y5MYQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="230" loading="lazy" role="presentation"/></picture></div></div></figure><p id="0716" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">This method will load the assembly (the downloaded file) and will execute a method “Invoke”, invoked with null parameters (Invoke(null, null)). We at this point assume that this second stage downloaded is ultimately a valid PE file (after being AES decrypted).</p><p id="9b7b" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Note: based on the AES ECB decryption function below, this file, should be a valid base64 blob.</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dSOtw5TjLpIPEmGlWWwg0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dSOtw5TjLpIPEmGlWWwg0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dSOtw5TjLpIPEmGlWWwg0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dSOtw5TjLpIPEmGlWWwg0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dSOtw5TjLpIPEmGlWWwg0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dSOtw5TjLpIPEmGlWWwg0Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSOtw5TjLpIPEmGlWWwg0Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dSOtw5TjLpIPEmGlWWwg0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dSOtw5TjLpIPEmGlWWwg0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dSOtw5TjLpIPEmGlWWwg0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dSOtw5TjLpIPEmGlWWwg0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dSOtw5TjLpIPEmGlWWwg0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dSOtw5TjLpIPEmGlWWwg0Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*dSOtw5TjLpIPEmGlWWwg0Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="214" loading="lazy" role="presentation"/></picture></div></div><figcaption class="mu ff mv mg mh mw mx bf b bg z du">AESDecrypt function from Moserware.SecretSplitter.dll</figcaption></figure><p id="56a1" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">What’s in the file upgrade_service_upgrade.zip ? we don’t know, it is fair to assume it’s an AES encrypted PE file encoded in base64, it seems it’s not available to download from the C2, nor it is available in usual online malware repositories. to be continued..I will keep this blog open for more updates, as I continue the analysis.</p><p id="2a2e" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Should you worry? I guess if you have any version of PasswordState it is worth to check the DLL Moserware.SecretSplitter.dll against the finding in this blog, or against this YARA rule that I just wrote (not tested in production)</p><pre class="nx ny nz oa ob pm pn po pp ay pq bk"><span id="3355" class="pr ps gu pn b ij pt pu l pv pw">rule MOSERPASS_LOADER<br/>{</span><span id="67b3" class="pr ps gu pn b ij px pu l pv pw">meta:<br/>        author = &quot;lordx64&quot;<br/>        info = &quot;moserpass loader detection rule&quot;<br/>        <br/>    strings:<br/>        $s1 = &quot;Loader&quot;  <br/>        $s2 = &quot;ThreadFunc&quot;  <br/>        $s3 = &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36&quot; wide  <br/>        $s4 = &quot;upgrade_service_upgrade.zip&quot; wide</span><span id="1913" class="pr ps gu pn b ij px pu l pv pw">condition:<br/>        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and all of them<br/>}</span></pre><p id="d89b" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">If you are victim of a supply chain attack like this one, cleaning up the software isn’t enough, you might need to start investigating your whole infrastructure accordingly.</p><p id="bf04" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk"><strong class="nb gv">UPDATE</strong> — 24 April 2021: The second stage payload was shared with me by Peter Kruse (@<a class="af my" href="https://twitter.com/peterkruse" rel="noopener ugc nofollow" target="_blank">PeterKruse</a>) thanks to him. Please find the second stage payload analysis below:</p><p id="899e" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Decoded and decrypted the payload using the following script:</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh py"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DlhGUOk4neF1pQQrWw2fkg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DlhGUOk4neF1pQQrWw2fkg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DlhGUOk4neF1pQQrWw2fkg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DlhGUOk4neF1pQQrWw2fkg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DlhGUOk4neF1pQQrWw2fkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DlhGUOk4neF1pQQrWw2fkg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DlhGUOk4neF1pQQrWw2fkg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*DlhGUOk4neF1pQQrWw2fkg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DlhGUOk4neF1pQQrWw2fkg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DlhGUOk4neF1pQQrWw2fkg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DlhGUOk4neF1pQQrWw2fkg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DlhGUOk4neF1pQQrWw2fkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DlhGUOk4neF1pQQrWw2fkg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DlhGUOk4neF1pQQrWw2fkg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="589" loading="lazy" role="presentation"/></picture></div></div></figure><p id="fb49" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">This gave us the following file: c2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6</p><p id="7d7d" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Second stage payload was exactly what we assumed, a base64 blob, of an AES encrypted payload, with exported function called “Invoke()” with no parameters.</p><p id="e975" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">In the function Invoke() relies all the DLL functionality :</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh pz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*PTeVJgJsgwx7JRJKb3u7JA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*PTeVJgJsgwx7JRJKb3u7JA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*PTeVJgJsgwx7JRJKb3u7JA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*PTeVJgJsgwx7JRJKb3u7JA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*PTeVJgJsgwx7JRJKb3u7JA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*PTeVJgJsgwx7JRJKb3u7JA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PTeVJgJsgwx7JRJKb3u7JA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*PTeVJgJsgwx7JRJKb3u7JA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*PTeVJgJsgwx7JRJKb3u7JA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*PTeVJgJsgwx7JRJKb3u7JA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*PTeVJgJsgwx7JRJKb3u7JA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*PTeVJgJsgwx7JRJKb3u7JA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*PTeVJgJsgwx7JRJKb3u7JA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*PTeVJgJsgwx7JRJKb3u7JA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="341" loading="lazy" role="presentation"/></picture></div></div></figure><p id="232e" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">It first collects a bunch of information related to the current USER:</p><ul class=""><li id="e85f" class="mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw qa qb qc bk">Computer name</li><li id="4b89" class="mz na gu nb b nc qd ne nf ng qe ni nj nk qf nm nn no qg nq nr ns qh nu nv nw qa qb qc bk">User Name</li><li id="7c73" class="mz na gu nb b nc qd ne nf ng qe ni nj nk qf nm nn no qg nq nr ns qh nu nv nw qa qb qc bk">User Domain</li></ul><p id="297f" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Also information related to PasswordState, including:</p><ul class=""><li id="c506" class="mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw qa qb qc bk">PasswordState Proxy Username</li><li id="1916" class="mz na gu nb b nc qd ne nf ng qe ni nj nk qf nm nn no qg nq nr ns qh nu nv nw qa qb qc bk">PasswordState Proxy Password</li></ul><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh qi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YOiR8BrFR4YXYgMUHMS-dA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YOiR8BrFR4YXYgMUHMS-dA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YOiR8BrFR4YXYgMUHMS-dA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YOiR8BrFR4YXYgMUHMS-dA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YOiR8BrFR4YXYgMUHMS-dA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YOiR8BrFR4YXYgMUHMS-dA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YOiR8BrFR4YXYgMUHMS-dA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YOiR8BrFR4YXYgMUHMS-dA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YOiR8BrFR4YXYgMUHMS-dA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YOiR8BrFR4YXYgMUHMS-dA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YOiR8BrFR4YXYgMUHMS-dA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YOiR8BrFR4YXYgMUHMS-dA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YOiR8BrFR4YXYgMUHMS-dA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YOiR8BrFR4YXYgMUHMS-dA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="310" loading="lazy" role="presentation"/></picture></div></div></figure><p id="942e" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">But most importantly All the PasswordState stored <strong class="nb gv">passwords</strong> of the current USER, are also exfiltrated:</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*BUOYHuEgrUpA-WUmJ2Wxsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="416" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5748" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">The technique used by this Threat Actor is to be able to load the assembly from the the CurrentDomain by locating the wanted assembly by name using the following FindAssembly() method:</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*66ZQfHR3iJkSsvtYxT6RZw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*66ZQfHR3iJkSsvtYxT6RZw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*66ZQfHR3iJkSsvtYxT6RZw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*66ZQfHR3iJkSsvtYxT6RZw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*66ZQfHR3iJkSsvtYxT6RZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*66ZQfHR3iJkSsvtYxT6RZw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*66ZQfHR3iJkSsvtYxT6RZw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*66ZQfHR3iJkSsvtYxT6RZw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*66ZQfHR3iJkSsvtYxT6RZw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*66ZQfHR3iJkSsvtYxT6RZw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*66ZQfHR3iJkSsvtYxT6RZw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*66ZQfHR3iJkSsvtYxT6RZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*66ZQfHR3iJkSsvtYxT6RZw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*66ZQfHR3iJkSsvtYxT6RZw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="204" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5720" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">Once the assembly located, they can execute methods from this Assembly object in memory (since this is assembly was loaded in the same domain as PasswordState), for example getting properties like the <strong class="nb gv">DBConnectiongString</strong> from the <strong class="nb gv">PasswordstateService.GlobalSettings </strong>to query the <strong class="nb gv">Passwords</strong> database:</p></div></div><div class="mo"><div class="ab cb"><div class="li ol lj om lk on cf oo cg op ci bh"><figure class="nx ny nz oa ob mo os ot paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*frH265TbaXTPdEGWY3-KCw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*frH265TbaXTPdEGWY3-KCw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*frH265TbaXTPdEGWY3-KCw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*frH265TbaXTPdEGWY3-KCw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*frH265TbaXTPdEGWY3-KCw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*frH265TbaXTPdEGWY3-KCw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*frH265TbaXTPdEGWY3-KCw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*frH265TbaXTPdEGWY3-KCw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*frH265TbaXTPdEGWY3-KCw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*frH265TbaXTPdEGWY3-KCw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*frH265TbaXTPdEGWY3-KCw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*frH265TbaXTPdEGWY3-KCw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*frH265TbaXTPdEGWY3-KCw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*frH265TbaXTPdEGWY3-KCw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln mt c" width="1000" height="107" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="16f1" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">But also calling the <strong class="nb gv">AES_Decrypt</strong> function directly from the Assembly to decrypt password field.. (it seems this function didn’t needed the password to be passed as a parameter)</p><figure class="nx ny nz oa ob mo mg mh paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7rNMlg7E5NkZGQlXi2gddw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7rNMlg7E5NkZGQlXi2gddw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7rNMlg7E5NkZGQlXi2gddw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7rNMlg7E5NkZGQlXi2gddw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7rNMlg7E5NkZGQlXi2gddw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7rNMlg7E5NkZGQlXi2gddw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7rNMlg7E5NkZGQlXi2gddw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7rNMlg7E5NkZGQlXi2gddw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7rNMlg7E5NkZGQlXi2gddw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7rNMlg7E5NkZGQlXi2gddw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7rNMlg7E5NkZGQlXi2gddw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7rNMlg7E5NkZGQlXi2gddw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7rNMlg7E5NkZGQlXi2gddw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*7rNMlg7E5NkZGQlXi2gddw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mt c" width="700" height="320" loading="eager" role="presentation"/></picture></div></div></figure><p id="ab92" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">This data is then AES encrypted using a key having this form: <strong class="nb gv">MD5(“helloworld”)</strong>, and sent back to the same CDN where this second stage was previously hosted:</p></div></div><div class="mo"><div class="ab cb"><div class="li ol lj om lk on cf oo cg op ci bh"><figure class="nx ny nz oa ob mo os ot paragraph-image"><div role="button" tabindex="0" class="mp mq fj mr bh ms"><div class="mg mh qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0c6a5KdiD__Eh3P1UKKKJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0c6a5KdiD__Eh3P1UKKKJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0c6a5KdiD__Eh3P1UKKKJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0c6a5KdiD__Eh3P1UKKKJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0c6a5KdiD__Eh3P1UKKKJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0c6a5KdiD__Eh3P1UKKKJQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*0c6a5KdiD__Eh3P1UKKKJQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0c6a5KdiD__Eh3P1UKKKJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0c6a5KdiD__Eh3P1UKKKJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0c6a5KdiD__Eh3P1UKKKJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0c6a5KdiD__Eh3P1UKKKJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0c6a5KdiD__Eh3P1UKKKJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0c6a5KdiD__Eh3P1UKKKJQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*0c6a5KdiD__Eh3P1UKKKJQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln mt c" width="1000" height="43" loading="eager" role="presentation"/></picture></div></div><figcaption class="mu ff mv mg mh mw mx bf b bg z du"><strong class="bf qo">passwordstate-18ed2[.]kxcdn.com</strong></figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="1d93" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">For research purpose I uploaded this MOSERPASS final payload to VirusTotal:</p><p id="a30e" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk"><a class="af my" href="https://www.virustotal.com/gui/file/c2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6/detection" rel="noopener ugc nofollow" target="_blank">https://www.virustotal.com/gui/file/c2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6/detection</a></p><h1 id="3275" class="qp ps gu bf qo qq qr qs qt qu qv qw qx qy qz ra rb rc rd re rf rg rh ri rj rk bk"><strong class="al">Last notes:</strong></h1><p id="d926" class="pw-post-body-paragraph mz na gu nb b nc rl ne nf ng rm ni nj nk rn nm nn no ro nq nr ns rp nu nv nw gn bk">ClickStudios, 29 000 enterprise customers including many Fortune 500 clients if targeted by MOSERPASS, are at high risk of having their networks and user accounts compromised.</p><h1 id="6c52" class="qp ps gu bf qo qq qr qs qt qu qv qw qx qy qz ra rb rc rd re rf rg rh ri rj rk bk"><strong class="al">Indicators of compromise:</strong></h1><p id="7d96" class="pw-post-body-paragraph mz na gu nb b nc rl ne nf ng rm ni nj nk rn nm nn no ro nq nr ns rp nu nv nw gn bk">MOSERPASS Loader: f23f9c2aaf94147b2c5d4b39b56514cd67102d3293bdef85101e2c05ee1c3bf9</p><p id="3e2e" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">MOSERPASS: c2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6</p><p id="77db" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk">MOSERPASS C2:</p><p id="c735" class="pw-post-body-paragraph mz na gu nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw gn bk"><strong class="nb gv">passwordstate-18ed2[.]kxcdn.com</strong></p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rq rr ab iv"><div class="rs ab"><a class="rt ay am ao" href="https://medium.com/tag/supply-chain?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><div class="ru fj cx rv ge rw rx bf b bg z bk ry">Supply Chain</div></a></div><div class="rs ab"><a class="rt ay am ao" href="https://medium.com/tag/malware?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><div class="ru fj cx rv ge rw rx bf b bg z bk ry">Malware</div></a></div><div class="rs ab"><a class="rt ay am ao" href="https://medium.com/tag/backdoor?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><div class="ru fj cx rv ge rw rx bf b bg z bk ry">Backdoor</div></a></div></div></div></div><div class="l"></div><footer class="rz sa sb sc sd ab q se sf c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sg"><div class="ab q ke"><div class="sh l"><span class="l si sj sk e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Faaff1df389e4&amp;operation=register&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;user=taha+aka+%22lordx64%22&amp;userId=74f7de1013c&amp;source=---footer_actions--aaff1df389e4---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f sl sm"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Faaff1df389e4&amp;operation=register&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;user=taha+aka+%22lordx64%22&amp;userId=74f7de1013c&amp;source=---footer_actions--aaff1df389e4---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="sn l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaff1df389e4&amp;operation=register&amp;redirect=https%3A%2F%2Flordx64.medium.com%2Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4&amp;source=---footer_actions--aaff1df389e4---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="sn l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="so sp sq sr ss l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="st bh r su"></div><div class="ab sv sw sx iu it"><div class="sy sz ta tb tc td te tf tg th ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--aaff1df389e4--------------------------------"><div class="l fj"><img alt="taha aka &quot;lordx64&quot;" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*CeV88vA72XwNGRvC79wSOg.png" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay ti"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--aaff1df389e4--------------------------------"><div class="l fj"><img alt="taha aka &quot;lordx64&quot;" class="l fd by tj tk cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*CeV88vA72XwNGRvC79wSOg.png" width="64" height="64" loading="lazy"/><div class="fr by l tj tk fs n ay ti"></div></div></a></div><div class="j i d tl is"><div class="ab"><span><button class="bf b bg z tm ru tn to tp tq tr ev ew ts tt tu fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co tv"><div class="tw tx ty om ol l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--aaff1df389e4--------------------------------"><h2 class="pw-author-name bf ua ub uc ud ue uf ug nk uh ui no uj uk ns ul um bk"><span class="gn tz">Written by <!-- -->taha aka &quot;lordx64&quot;</span></h2></a><div class="rs ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--aaff1df389e4--------------------------------">175 Followers</a></span></div><div class="bf b bg z du ab pv"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/following?source=post_page---post_author_info--aaff1df389e4--------------------------------">2 Following</a></div></div><div class="un l"><p class="bf b bg z bk"><span class="gn">Malware reverse engineer &amp; curiosity - twitter at @lordx64</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z tm ru tn to tp tq tr ev ew ts tt tu fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="uo l"><div class="st bh r up uq ur us ut"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf ua qq qs qt qu qw qx qy ra rb rc re rf rg ri rj bk">No responses yet</h2><div class="ab uu"><div><div class="bm" aria-hidden="false"><a class="uv uw" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--aaff1df389e4--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="ux uy uz va vb l"></div></div></div></div><div class="vc vd ve vf vg l bx"><div class="h k j"><div class="st bh vh vi"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="vj ab ke iv"><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vk vl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----aaff1df389e4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://lordx64.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-aaff1df389e4","user-74f7de1013c"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"74f7de1013c","explicit":true},"viewerIsBot":false},"debug":{"requestId":"5f17ed10-22a8-434c-9c4a-e99a62a0f517","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-dfe0fe18558d880c3dfa8383d7765bf2-3512ecceee730bc9-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Flordx64.medium.com\u002Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4","host":"lordx64.medium.com","hostname":"lordx64.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"lordx64.medium.com\"})":null,"postResult({\"id\":\"aaff1df389e4\"})":{"__ref":"Post:aaff1df389e4"}},"LinkedAccounts:74f7de1013c":{"__typename":"LinkedAccounts","mastodon":null,"id":"74f7de1013c"},"Membership:322e3626e14d":{"__typename":"Membership","tier":"MEMBER","id":"322e3626e14d"},"User:74f7de1013c":{"__typename":"User","id":"74f7de1013c","linkedAccounts":{"__ref":"LinkedAccounts:74f7de1013c"},"isSuspended":false,"name":"taha aka \"lordx64\"","imageId":"1*CeV88vA72XwNGRvC79wSOg.png","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"lordx64.medium.com"}},"hasSubdomain":true,"username":"lordx64","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":175,"followingCount":0,"collectionFollowingCount":2},"bio":"Malware reverse engineer & curiosity - twitter at @lordx64","membership":{"__ref":"Membership:322e3626e14d"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:74f7de1013c-viewerId:lo_081cce60fec4"},"twitterScreenName":"lordx64"},"Paragraph:8decbeb46f88_0":{"__typename":"Paragraph","id":"8decbeb46f88_0","name":"faa9","type":"H3","href":null,"layout":null,"metadata":null,"text":"Initial analysis of PasswordState supply chain attack backdoor code","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*rnNDVgt04qrqCAsZ":{"__typename":"ImageMetadata","id":"0*rnNDVgt04qrqCAsZ","originalHeight":5304,"originalWidth":7952,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_1":{"__typename":"Paragraph","id":"8decbeb46f88_1","name":"2a72","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*rnNDVgt04qrqCAsZ"},"text":"Photo by Claudio Schwarz | @purzlbaum on Unsplash","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":37,"href":"https:\u002F\u002Funsplash.com\u002F@purzlbaum?utm_source=medium&utm_medium=referral","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":41,"end":49,"href":"https:\u002F\u002Funsplash.com?utm_source=medium&utm_medium=referral","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_2":{"__typename":"Paragraph","id":"8decbeb46f88_2","name":"7e00","type":"P","href":null,"layout":null,"metadata":null,"text":"UPDATE — 24 April 2021: The second stage payload was shared with me by Peter Kruse (@PeterKruse) thanks to him. Please find the second stage payload analysis at the end of this document.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":85,"end":95,"href":"https:\u002F\u002Ftwitter.com\u002Fpeterkruse","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_3":{"__typename":"Paragraph","id":"8decbeb46f88_3","name":"4a83","type":"P","href":null,"layout":null,"metadata":null,"text":"One hour ago, I became aware of this supply chain attack from a tweet by Kim Zetter. If you don’t follow her please do and subscribe to her blog for amazing cyber espionage related content : zetter@substack.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":191,"end":210,"href":"mailto:zetter@substack.com","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:c9123f9e8bc98a64d02ffd2379f3cce8":{"__typename":"MediaResource","id":"c9123f9e8bc98a64d02ffd2379f3cce8","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A\u002F\u002Ftwitter.com\u002Fkimzetter\u002Fstatus\u002F1385674580660916228&image=https%3A\u002F\u002Fi.embed.ly\u002F1\u002Fimage%3Furl%3Dhttps%253A%252F%252Fabs.twimg.com%252Ferrors%252Flogo46x38.png%26key%3Da19fcc184b9711e1b4764040d3dc5c07","iframeHeight":281,"iframeWidth":500,"title":"Kim Zetter on Twitter: \"ClickStudios has told customers a breach occurred that resulted in a supply chain attack via update of password manager PASSWORDSTATE. Breach occurred between Apr 20-22. The update dropped a malicious zip file \"Passwordstate_upgrade.zip\" w\u002F rogue .dll https:\u002F\u002Ft.co\u002FUHkjlO4NK0 \u002F Twitter\""},"Paragraph:8decbeb46f88_4":{"__typename":"Paragraph","id":"8decbeb46f88_4","name":"8514","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:c9123f9e8bc98a64d02ffd2379f3cce8"}},"mixtapeMetadata":null},"Paragraph:8decbeb46f88_5":{"__typename":"Paragraph","id":"8decbeb46f88_5","name":"f6ec","type":"P","href":null,"layout":null,"metadata":null,"text":"Why this quick analysis? well it’s Friday, and this news will worry a lot of people, and many would want to know what is this about and fast.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_6":{"__typename":"Paragraph","id":"8decbeb46f88_6","name":"befc","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: Based on ClickStudios customers, this attack might be impacting 29 000 enterprise customers including many Fortune 500 clients.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_7":{"__typename":"Paragraph","id":"8decbeb46f88_7","name":"e6fe","type":"P","href":null,"layout":null,"metadata":null,"text":"Based on the initial information we have, I will explain in details how this legitimate software: PasswordState from ClickStudios, was backdoored, as well as how to detect this backdoor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_8":{"__typename":"Paragraph","id":"8decbeb46f88_8","name":"dd30","type":"P","href":null,"layout":null,"metadata":null,"text":"There was an official statement from CSIS group on their website, saying that ClickStudios recently notified their customers about a breach resulting in a supply chain attack conducted via an update of the password manager PASSWORDSTATE. the attack was noticed between 20th of April 2021 8:33 PM UTC and 22nd of April 2021 00.30am UTC","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8edWR4HHiPRU_Tt-IdfWDw.png":{"__typename":"ImageMetadata","id":"1*8edWR4HHiPRU_Tt-IdfWDw.png","originalHeight":394,"originalWidth":2350,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_9":{"__typename":"Paragraph","id":"8decbeb46f88_9","name":"a2fb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8edWR4HHiPRU_Tt-IdfWDw.png"},"text":"source: https:\u002F\u002Fwww.csis.dk\u002Fnewsroom-blog-overview\u002F2021\u002Fmoserpass-supply-chain\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":8,"end":79,"href":"https:\u002F\u002Fwww.csis.dk\u002Fnewsroom-blog-overview\u002F2021\u002Fmoserpass-supply-chain\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_10":{"__typename":"Paragraph","id":"8decbeb46f88_10","name":"5aa3","type":"P","href":null,"layout":null,"metadata":null,"text":"CSIS group shared IOC’s, I confirmed them and below is the analysis of the backdoor code.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_11":{"__typename":"Paragraph","id":"8decbeb46f88_11","name":"c4cc","type":"P","href":null,"layout":null,"metadata":null,"text":"Sample in question is a rogue DLL file, downloaded during an update of PasswordState ( I am not sure yet which version of PasswordState exactly): f23f9c2aaf94147b2c5d4b39b56514cd67102d3293bdef85101e2c05ee1c3bf9 Moserware.SecretSplitter.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_12":{"__typename":"Paragraph","id":"8decbeb46f88_12","name":"a921","type":"P","href":null,"layout":null,"metadata":null,"text":"The backdoor code was inserted in the assembly, via a Loader method see below :","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-mbV4nRKv5y3EMbUoEQHzg.png":{"__typename":"ImageMetadata","id":"1*-mbV4nRKv5y3EMbUoEQHzg.png","originalHeight":376,"originalWidth":874,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_13":{"__typename":"Paragraph","id":"8decbeb46f88_13","name":"b949","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*-mbV4nRKv5y3EMbUoEQHzg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JVyT8W6e0TdbN-S0G71bTQ.png":{"__typename":"ImageMetadata","id":"1*JVyT8W6e0TdbN-S0G71bTQ.png","originalHeight":414,"originalWidth":866,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_14":{"__typename":"Paragraph","id":"8decbeb46f88_14","name":"63b6","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*JVyT8W6e0TdbN-S0G71bTQ.png"},"text":"clean vs backdoored","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_15":{"__typename":"Paragraph","id":"8decbeb46f88_15","name":"9166","type":"P","href":null,"layout":null,"metadata":null,"text":"(compared it with a clean version of this dll: 1ee0f14c44058e3d0d1c19b4713d573c81b49c28ed58bd41c72832c78f7d1464)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_16":{"__typename":"Paragraph","id":"8decbeb46f88_16","name":"5ed6","type":"P","href":null,"layout":null,"metadata":null,"text":"Next let’s jump into the backdoor code and how it’s been called from the legitimate code:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_17":{"__typename":"Paragraph","id":"8decbeb46f88_17","name":"2186","type":"P","href":null,"layout":null,"metadata":null,"text":"Inside the namespace Moserware.Security.Cryptography, there’s class named Diffuser, containing a protected method called Diffuse() which is the constructor of this virtual class:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*N_T_YuwnQo4IWGixRJtoNQ.png":{"__typename":"ImageMetadata","id":"1*N_T_YuwnQo4IWGixRJtoNQ.png","originalHeight":902,"originalWidth":1358,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_18":{"__typename":"Paragraph","id":"8decbeb46f88_18","name":"87d4","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*N_T_YuwnQo4IWGixRJtoNQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*gcEY81L5OJVQ-s0UyP0Hhw.png":{"__typename":"ImageMetadata","id":"1*gcEY81L5OJVQ-s0UyP0Hhw.png","originalHeight":1142,"originalWidth":2068,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_19":{"__typename":"Paragraph","id":"8decbeb46f88_19","name":"ba3c","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*gcEY81L5OJVQ-s0UyP0Hhw.png"},"text":"clean vs backdoored version","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_20":{"__typename":"Paragraph","id":"8decbeb46f88_20","name":"a12e","type":"P","href":null,"layout":null,"metadata":null,"text":"I checked how this class Diffuser() was called, it is indeed used by 3 other classes, amongst them XteaDiffuser that inherit from Diffuser.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":117,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*U2ZSzsqh9kj43SyIxw7ewg.png":{"__typename":"ImageMetadata","id":"1*U2ZSzsqh9kj43SyIxw7ewg.png","originalHeight":164,"originalWidth":1180,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_21":{"__typename":"Paragraph","id":"8decbeb46f88_21","name":"f780","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*U2ZSzsqh9kj43SyIxw7ewg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_22":{"__typename":"Paragraph","id":"8decbeb46f88_22","name":"b8df","type":"P","href":null,"layout":null,"metadata":null,"text":"Which means every time a object XteaDiffuser is instantiated the constructor Diffuser() will be called and the backdoor code will run. XteaDiffuser object is used by SsssDiffuser() Class as an attribute and used for every Xtea encryption\u002Fdecryption operations (kinda like a wrapper). which in turn called by SecretSplitter as the default diffuser. It seems PasswordState uses Xtea for splitting the secret password (based on SecretSplitter class name, didn’t look in the code in details):","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mM4DWRnC8TbmlnE-yI_eBA.png":{"__typename":"ImageMetadata","id":"1*mM4DWRnC8TbmlnE-yI_eBA.png","originalHeight":552,"originalWidth":1306,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_23":{"__typename":"Paragraph","id":"8decbeb46f88_23","name":"6207","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mM4DWRnC8TbmlnE-yI_eBA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_24":{"__typename":"Paragraph","id":"8decbeb46f88_24","name":"53c8","type":"P","href":null,"layout":null,"metadata":null,"text":"Back to the diffuser() constructor:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_25":{"__typename":"Paragraph","id":"8decbeb46f88_25","name":"46d0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*gcEY81L5OJVQ-s0UyP0Hhw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_26":{"__typename":"Paragraph","id":"8decbeb46f88_26","name":"66e4","type":"P","href":null,"layout":null,"metadata":null,"text":"We have a method Container.Running(), taking 5 arguments. amongst them a URL that points to a zip file? to be downloaded from passwordstate-18ed2[.]kxcdn.com , and a sort of hash, which is as we will see later, is the AES password to decrypt the downloaded file.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":126,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_27":{"__typename":"Paragraph","id":"8decbeb46f88_27","name":"8d2f","type":"P","href":null,"layout":null,"metadata":null,"text":"let’s look at the Container.Running() function:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7yxUs6dF47NcR3Qop6fr7g.png":{"__typename":"ImageMetadata","id":"1*7yxUs6dF47NcR3Qop6fr7g.png","originalHeight":718,"originalWidth":1652,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_28":{"__typename":"Paragraph","id":"8decbeb46f88_28","name":"0553","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7yxUs6dF47NcR3Qop6fr7g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_29":{"__typename":"Paragraph","id":"8decbeb46f88_29","name":"d30c","type":"P","href":null,"layout":null,"metadata":null,"text":"This function checks if the current process name is “Passwordstate” then Container class attributes are set (url, decryption key, interval, assemblyType (set to “Agent.Agent”), assemblyMethod (set to “Invoke”)) and the method Container.ThreadFunc() is run in a Thread in the backgroud.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_30":{"__typename":"Paragraph","id":"8decbeb46f88_30","name":"8e19","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s look at Container.ThreadFunc()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9B8Bp4CSXKRqlB7Em6X8mw.png":{"__typename":"ImageMetadata","id":"1*9B8Bp4CSXKRqlB7Em6X8mw.png","originalHeight":1148,"originalWidth":2048,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_31":{"__typename":"Paragraph","id":"8decbeb46f88_31","name":"784d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9B8Bp4CSXKRqlB7Em6X8mw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_32":{"__typename":"Paragraph","id":"8decbeb46f88_32","name":"5389","type":"P","href":null,"layout":null,"metadata":null,"text":"This function will download a file, via the method Container.Get(), will AES decrypt it using the password: f4f15dddc3ba10dd443493a2a8a526b0 and pass it to the Loader Class(), we will describe what this class does later, then the method Loader.Process() is called.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":108,"end":140,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_33":{"__typename":"Paragraph","id":"8decbeb46f88_33","name":"2cb7","type":"P","href":null,"layout":null,"metadata":null,"text":"Container.Get() will set the correct User-Agent, will activate Certificate pining checks, and download a file and store it in memory:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9hoN-u3v-QdgrA-ZHf4SxQ.png":{"__typename":"ImageMetadata","id":"1*9hoN-u3v-QdgrA-ZHf4SxQ.png","originalHeight":1244,"originalWidth":2104,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_34":{"__typename":"Paragraph","id":"8decbeb46f88_34","name":"fd7b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9hoN-u3v-QdgrA-ZHf4SxQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_35":{"__typename":"Paragraph","id":"8decbeb46f88_35","name":"5564","type":"P","href":null,"layout":null,"metadata":null,"text":"Note of the User-Agent used by this backdoor is the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_36":{"__typename":"Paragraph","id":"8decbeb46f88_36","name":"530b","type":"P","href":null,"layout":null,"metadata":null,"text":"“Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F89.0.4389.128 Safari\u002F537.36”;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_37":{"__typename":"Paragraph","id":"8decbeb46f88_37","name":"31b7","type":"P","href":null,"layout":null,"metadata":null,"text":"Notice that it is a GET request, and the url is appended with a param “?id=” containing the Datetime.UtcNow.ToFileTime().ToString() this returns a string representing value of the current DateTime object expressed as a Windows file time.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":71,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_38":{"__typename":"Paragraph","id":"8decbeb46f88_38","name":"a98a","type":"P","href":null,"layout":null,"metadata":null,"text":"A Windows file time is a 64-bit value that represents the number of 100-nanosecond intervals that have elapsed since 12:00 midnight, January 1, 1601 A.D. (C.E.) Coordinated Universal Time (UTC).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_39":{"__typename":"Paragraph","id":"8decbeb46f88_39","name":"0c36","type":"P","href":null,"layout":null,"metadata":null,"text":"And If we convert the value given in the CSIS website about this backdoor :","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cwPXL5_4TzmqjcGLdWm5mw.png":{"__typename":"ImageMetadata","id":"1*cwPXL5_4TzmqjcGLdWm5mw.png","originalHeight":206,"originalWidth":2326,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_40":{"__typename":"Paragraph","id":"8decbeb46f88_40","name":"c034","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cwPXL5_4TzmqjcGLdWm5mw.png"},"text":"source : https:\u002F\u002Fwww.csis.dk\u002Fnewsroom-blog-overview\u002F2021\u002Fmoserpass-supply-chain\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":80,"href":"https:\u002F\u002Fwww.csis.dk\u002Fnewsroom-blog-overview\u002F2021\u002Fmoserpass-supply-chain\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_41":{"__typename":"Paragraph","id":"8decbeb46f88_41","name":"17c2","type":"P","href":null,"layout":null,"metadata":null,"text":"it corresponds to :","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_42":{"__typename":"Paragraph","id":"8decbeb46f88_42","name":"507a","type":"P","href":null,"layout":null,"metadata":null,"text":"GMT: Friday, April 23, 2021 8:22:07 PM","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_43":{"__typename":"Paragraph","id":"8decbeb46f88_43","name":"33e2","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, now that the file upgrade_service_upgrade.zip was downloaded and stored in memory. let’s check what the Loader() class will do with this file. Loader class will set the correct attributes in the constructor. Then as we saw earlier, the backdoor called Process() function, which in turn calls the method below ThreadFunc():","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UDyx_hm2TZbh6xYA6Y5MYQ.png":{"__typename":"ImageMetadata","id":"1*UDyx_hm2TZbh6xYA6Y5MYQ.png","originalHeight":572,"originalWidth":1744,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_44":{"__typename":"Paragraph","id":"8decbeb46f88_44","name":"0b8c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UDyx_hm2TZbh6xYA6Y5MYQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_45":{"__typename":"Paragraph","id":"8decbeb46f88_45","name":"0716","type":"P","href":null,"layout":null,"metadata":null,"text":"This method will load the assembly (the downloaded file) and will execute a method “Invoke”, invoked with null parameters (Invoke(null, null)). We at this point assume that this second stage downloaded is ultimately a valid PE file (after being AES decrypted).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_46":{"__typename":"Paragraph","id":"8decbeb46f88_46","name":"9b7b","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: based on the AES ECB decryption function below, this file, should be a valid base64 blob.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dSOtw5TjLpIPEmGlWWwg0Q.png":{"__typename":"ImageMetadata","id":"1*dSOtw5TjLpIPEmGlWWwg0Q.png","originalHeight":324,"originalWidth":1064,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_47":{"__typename":"Paragraph","id":"8decbeb46f88_47","name":"40b3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dSOtw5TjLpIPEmGlWWwg0Q.png"},"text":"AESDecrypt function from Moserware.SecretSplitter.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_48":{"__typename":"Paragraph","id":"8decbeb46f88_48","name":"56a1","type":"P","href":null,"layout":null,"metadata":null,"text":"What’s in the file upgrade_service_upgrade.zip ? we don’t know, it is fair to assume it’s an AES encrypted PE file encoded in base64, it seems it’s not available to download from the C2, nor it is available in usual online malware repositories. to be continued..I will keep this blog open for more updates, as I continue the analysis.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_49":{"__typename":"Paragraph","id":"8decbeb46f88_49","name":"2a2e","type":"P","href":null,"layout":null,"metadata":null,"text":"Should you worry? I guess if you have any version of PasswordState it is worth to check the DLL Moserware.SecretSplitter.dll against the finding in this blog, or against this YARA rule that I just wrote (not tested in production)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_50":{"__typename":"Paragraph","id":"8decbeb46f88_50","name":"3355","type":"PRE","href":null,"layout":null,"metadata":null,"text":"rule MOSERPASS_LOADER\n{","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_51":{"__typename":"Paragraph","id":"8decbeb46f88_51","name":"67b3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"meta:\n        author = \"lordx64\"\n        info = \"moserpass loader detection rule\"\n        \n    strings:\n        $s1 = \"Loader\"  \n        $s2 = \"ThreadFunc\"  \n        $s3 = \"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F89.0.4389.128 Safari\u002F537.36\" wide  \n        $s4 = \"upgrade_service_upgrade.zip\" wide","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_52":{"__typename":"Paragraph","id":"8decbeb46f88_52","name":"1913","type":"PRE","href":null,"layout":null,"metadata":null,"text":"condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and all of them\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_53":{"__typename":"Paragraph","id":"8decbeb46f88_53","name":"d89b","type":"P","href":null,"layout":null,"metadata":null,"text":"If you are victim of a supply chain attack like this one, cleaning up the software isn’t enough, you might need to start investigating your whole infrastructure accordingly.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_54":{"__typename":"Paragraph","id":"8decbeb46f88_54","name":"bf04","type":"P","href":null,"layout":null,"metadata":null,"text":"UPDATE — 24 April 2021: The second stage payload was shared with me by Peter Kruse (@PeterKruse) thanks to him. Please find the second stage payload analysis below:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":85,"end":95,"href":"https:\u002F\u002Ftwitter.com\u002Fpeterkruse","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_55":{"__typename":"Paragraph","id":"8decbeb46f88_55","name":"899e","type":"P","href":null,"layout":null,"metadata":null,"text":"Decoded and decrypted the payload using the following script:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*DlhGUOk4neF1pQQrWw2fkg.png":{"__typename":"ImageMetadata","id":"1*DlhGUOk4neF1pQQrWw2fkg.png","originalHeight":870,"originalWidth":1034,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_56":{"__typename":"Paragraph","id":"8decbeb46f88_56","name":"9f71","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*DlhGUOk4neF1pQQrWw2fkg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_57":{"__typename":"Paragraph","id":"8decbeb46f88_57","name":"fb49","type":"P","href":null,"layout":null,"metadata":null,"text":"This gave us the following file: c2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_58":{"__typename":"Paragraph","id":"8decbeb46f88_58","name":"7d7d","type":"P","href":null,"layout":null,"metadata":null,"text":"Second stage payload was exactly what we assumed, a base64 blob, of an AES encrypted payload, with exported function called “Invoke()” with no parameters.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_59":{"__typename":"Paragraph","id":"8decbeb46f88_59","name":"e975","type":"P","href":null,"layout":null,"metadata":null,"text":"In the function Invoke() relies all the DLL functionality :","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*PTeVJgJsgwx7JRJKb3u7JA.png":{"__typename":"ImageMetadata","id":"1*PTeVJgJsgwx7JRJKb3u7JA.png","originalHeight":904,"originalWidth":1856,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_60":{"__typename":"Paragraph","id":"8decbeb46f88_60","name":"4d71","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*PTeVJgJsgwx7JRJKb3u7JA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_61":{"__typename":"Paragraph","id":"8decbeb46f88_61","name":"232e","type":"P","href":null,"layout":null,"metadata":null,"text":"It first collects a bunch of information related to the current USER:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_62":{"__typename":"Paragraph","id":"8decbeb46f88_62","name":"e85f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Computer name","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_63":{"__typename":"Paragraph","id":"8decbeb46f88_63","name":"4b89","type":"ULI","href":null,"layout":null,"metadata":null,"text":"User Name","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_64":{"__typename":"Paragraph","id":"8decbeb46f88_64","name":"7c73","type":"ULI","href":null,"layout":null,"metadata":null,"text":"User Domain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_65":{"__typename":"Paragraph","id":"8decbeb46f88_65","name":"297f","type":"P","href":null,"layout":null,"metadata":null,"text":"Also information related to PasswordState, including:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_66":{"__typename":"Paragraph","id":"8decbeb46f88_66","name":"c506","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PasswordState Proxy Username","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_67":{"__typename":"Paragraph","id":"8decbeb46f88_67","name":"1916","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PasswordState Proxy Password","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YOiR8BrFR4YXYgMUHMS-dA.png":{"__typename":"ImageMetadata","id":"1*YOiR8BrFR4YXYgMUHMS-dA.png","originalHeight":962,"originalWidth":2178,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_68":{"__typename":"Paragraph","id":"8decbeb46f88_68","name":"d8f6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YOiR8BrFR4YXYgMUHMS-dA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_69":{"__typename":"Paragraph","id":"8decbeb46f88_69","name":"942e","type":"P","href":null,"layout":null,"metadata":null,"text":"But most importantly All the PasswordState stored passwords of the current USER, are also exfiltrated:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":50,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BUOYHuEgrUpA-WUmJ2Wxsw.png":{"__typename":"ImageMetadata","id":"1*BUOYHuEgrUpA-WUmJ2Wxsw.png","originalHeight":1288,"originalWidth":2172,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_70":{"__typename":"Paragraph","id":"8decbeb46f88_70","name":"76d2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BUOYHuEgrUpA-WUmJ2Wxsw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_71":{"__typename":"Paragraph","id":"8decbeb46f88_71","name":"5748","type":"P","href":null,"layout":null,"metadata":null,"text":"The technique used by this Threat Actor is to be able to load the assembly from the the CurrentDomain by locating the wanted assembly by name using the following FindAssembly() method:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*66ZQfHR3iJkSsvtYxT6RZw.png":{"__typename":"ImageMetadata","id":"1*66ZQfHR3iJkSsvtYxT6RZw.png","originalHeight":330,"originalWidth":1136,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_72":{"__typename":"Paragraph","id":"8decbeb46f88_72","name":"8265","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*66ZQfHR3iJkSsvtYxT6RZw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_73":{"__typename":"Paragraph","id":"8decbeb46f88_73","name":"5720","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the assembly located, they can execute methods from this Assembly object in memory (since this is assembly was loaded in the same domain as PasswordState), for example getting properties like the DBConnectiongString from the PasswordstateService.GlobalSettings to query the Passwords database:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":201,"end":220,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":230,"end":266,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":279,"end":288,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*frH265TbaXTPdEGWY3-KCw.png":{"__typename":"ImageMetadata","id":"1*frH265TbaXTPdEGWY3-KCw.png","originalHeight":220,"originalWidth":2066,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_74":{"__typename":"Paragraph","id":"8decbeb46f88_74","name":"8baf","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*frH265TbaXTPdEGWY3-KCw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_75":{"__typename":"Paragraph","id":"8decbeb46f88_75","name":"16f1","type":"P","href":null,"layout":null,"metadata":null,"text":"But also calling the AES_Decrypt function directly from the Assembly to decrypt password field.. (it seems this function didn’t needed the password to be passed as a parameter)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":21,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7rNMlg7E5NkZGQlXi2gddw.png":{"__typename":"ImageMetadata","id":"1*7rNMlg7E5NkZGQlXi2gddw.png","originalHeight":870,"originalWidth":1904,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_76":{"__typename":"Paragraph","id":"8decbeb46f88_76","name":"d488","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7rNMlg7E5NkZGQlXi2gddw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_77":{"__typename":"Paragraph","id":"8decbeb46f88_77","name":"ab92","type":"P","href":null,"layout":null,"metadata":null,"text":"This data is then AES encrypted using a key having this form: MD5(“helloworld”), and sent back to the same CDN where this second stage was previously hosted:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":62,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0c6a5KdiD__Eh3P1UKKKJQ.png":{"__typename":"ImageMetadata","id":"1*0c6a5KdiD__Eh3P1UKKKJQ.png","originalHeight":78,"originalWidth":1824,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:8decbeb46f88_78":{"__typename":"Paragraph","id":"8decbeb46f88_78","name":"5067","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0c6a5KdiD__Eh3P1UKKKJQ.png"},"text":"passwordstate-18ed2[.]kxcdn.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_79":{"__typename":"Paragraph","id":"8decbeb46f88_79","name":"1d93","type":"P","href":null,"layout":null,"metadata":null,"text":"For research purpose I uploaded this MOSERPASS final payload to VirusTotal:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_80":{"__typename":"Paragraph","id":"8decbeb46f88_80","name":"a30e","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002Fc2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6\u002Fdetection","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":110,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002Fc2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6\u002Fdetection","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_81":{"__typename":"Paragraph","id":"8decbeb46f88_81","name":"3275","type":"H3","href":null,"layout":null,"metadata":null,"text":"Last notes:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_82":{"__typename":"Paragraph","id":"8decbeb46f88_82","name":"d926","type":"P","href":null,"layout":null,"metadata":null,"text":"ClickStudios, 29 000 enterprise customers including many Fortune 500 clients if targeted by MOSERPASS, are at high risk of having their networks and user accounts compromised.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_83":{"__typename":"Paragraph","id":"8decbeb46f88_83","name":"6c52","type":"H3","href":null,"layout":null,"metadata":null,"text":"Indicators of compromise:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_84":{"__typename":"Paragraph","id":"8decbeb46f88_84","name":"7d96","type":"P","href":null,"layout":null,"metadata":null,"text":"MOSERPASS Loader: f23f9c2aaf94147b2c5d4b39b56514cd67102d3293bdef85101e2c05ee1c3bf9","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_85":{"__typename":"Paragraph","id":"8decbeb46f88_85","name":"3e2e","type":"P","href":null,"layout":null,"metadata":null,"text":"MOSERPASS: c2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_86":{"__typename":"Paragraph","id":"8decbeb46f88_86","name":"77db","type":"P","href":null,"layout":null,"metadata":null,"text":"MOSERPASS C2:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:8decbeb46f88_87":{"__typename":"Paragraph","id":"8decbeb46f88_87","name":"c735","type":"P","href":null,"layout":null,"metadata":null,"text":"passwordstate-18ed2[.]kxcdn.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:74f7de1013c-viewerId:lo_081cce60fec4":{"__typename":"UserViewerEdge","id":"userId:74f7de1013c-viewerId:lo_081cce60fec4","isMuting":false},"PostViewerEdge:postId:aaff1df389e4-viewerId:lo_081cce60fec4":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:aaff1df389e4-viewerId:lo_081cce60fec4"},"Tag:supply-chain":{"__typename":"Tag","id":"supply-chain","displayTitle":"Supply Chain","normalizedTagSlug":"supply-chain"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Tag:backdoor":{"__typename":"Tag","id":"backdoor","displayTitle":"Backdoor","normalizedTagSlug":"backdoor"},"Post:aaff1df389e4":{"__typename":"Post","id":"aaff1df389e4","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"f993","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:8decbeb46f88_0"},{"__ref":"Paragraph:8decbeb46f88_1"},{"__ref":"Paragraph:8decbeb46f88_2"},{"__ref":"Paragraph:8decbeb46f88_3"},{"__ref":"Paragraph:8decbeb46f88_4"},{"__ref":"Paragraph:8decbeb46f88_5"},{"__ref":"Paragraph:8decbeb46f88_6"},{"__ref":"Paragraph:8decbeb46f88_7"},{"__ref":"Paragraph:8decbeb46f88_8"},{"__ref":"Paragraph:8decbeb46f88_9"},{"__ref":"Paragraph:8decbeb46f88_10"},{"__ref":"Paragraph:8decbeb46f88_11"},{"__ref":"Paragraph:8decbeb46f88_12"},{"__ref":"Paragraph:8decbeb46f88_13"},{"__ref":"Paragraph:8decbeb46f88_14"},{"__ref":"Paragraph:8decbeb46f88_15"},{"__ref":"Paragraph:8decbeb46f88_16"},{"__ref":"Paragraph:8decbeb46f88_17"},{"__ref":"Paragraph:8decbeb46f88_18"},{"__ref":"Paragraph:8decbeb46f88_19"},{"__ref":"Paragraph:8decbeb46f88_20"},{"__ref":"Paragraph:8decbeb46f88_21"},{"__ref":"Paragraph:8decbeb46f88_22"},{"__ref":"Paragraph:8decbeb46f88_23"},{"__ref":"Paragraph:8decbeb46f88_24"},{"__ref":"Paragraph:8decbeb46f88_25"},{"__ref":"Paragraph:8decbeb46f88_26"},{"__ref":"Paragraph:8decbeb46f88_27"},{"__ref":"Paragraph:8decbeb46f88_28"},{"__ref":"Paragraph:8decbeb46f88_29"},{"__ref":"Paragraph:8decbeb46f88_30"},{"__ref":"Paragraph:8decbeb46f88_31"},{"__ref":"Paragraph:8decbeb46f88_32"},{"__ref":"Paragraph:8decbeb46f88_33"},{"__ref":"Paragraph:8decbeb46f88_34"},{"__ref":"Paragraph:8decbeb46f88_35"},{"__ref":"Paragraph:8decbeb46f88_36"},{"__ref":"Paragraph:8decbeb46f88_37"},{"__ref":"Paragraph:8decbeb46f88_38"},{"__ref":"Paragraph:8decbeb46f88_39"},{"__ref":"Paragraph:8decbeb46f88_40"},{"__ref":"Paragraph:8decbeb46f88_41"},{"__ref":"Paragraph:8decbeb46f88_42"},{"__ref":"Paragraph:8decbeb46f88_43"},{"__ref":"Paragraph:8decbeb46f88_44"},{"__ref":"Paragraph:8decbeb46f88_45"},{"__ref":"Paragraph:8decbeb46f88_46"},{"__ref":"Paragraph:8decbeb46f88_47"},{"__ref":"Paragraph:8decbeb46f88_48"},{"__ref":"Paragraph:8decbeb46f88_49"},{"__ref":"Paragraph:8decbeb46f88_50"},{"__ref":"Paragraph:8decbeb46f88_51"},{"__ref":"Paragraph:8decbeb46f88_52"},{"__ref":"Paragraph:8decbeb46f88_53"},{"__ref":"Paragraph:8decbeb46f88_54"},{"__ref":"Paragraph:8decbeb46f88_55"},{"__ref":"Paragraph:8decbeb46f88_56"},{"__ref":"Paragraph:8decbeb46f88_57"},{"__ref":"Paragraph:8decbeb46f88_58"},{"__ref":"Paragraph:8decbeb46f88_59"},{"__ref":"Paragraph:8decbeb46f88_60"},{"__ref":"Paragraph:8decbeb46f88_61"},{"__ref":"Paragraph:8decbeb46f88_62"},{"__ref":"Paragraph:8decbeb46f88_63"},{"__ref":"Paragraph:8decbeb46f88_64"},{"__ref":"Paragraph:8decbeb46f88_65"},{"__ref":"Paragraph:8decbeb46f88_66"},{"__ref":"Paragraph:8decbeb46f88_67"},{"__ref":"Paragraph:8decbeb46f88_68"},{"__ref":"Paragraph:8decbeb46f88_69"},{"__ref":"Paragraph:8decbeb46f88_70"},{"__ref":"Paragraph:8decbeb46f88_71"},{"__ref":"Paragraph:8decbeb46f88_72"},{"__ref":"Paragraph:8decbeb46f88_73"},{"__ref":"Paragraph:8decbeb46f88_74"},{"__ref":"Paragraph:8decbeb46f88_75"},{"__ref":"Paragraph:8decbeb46f88_76"},{"__ref":"Paragraph:8decbeb46f88_77"},{"__ref":"Paragraph:8decbeb46f88_78"},{"__ref":"Paragraph:8decbeb46f88_79"},{"__ref":"Paragraph:8decbeb46f88_80"},{"__ref":"Paragraph:8decbeb46f88_81"},{"__ref":"Paragraph:8decbeb46f88_82"},{"__ref":"Paragraph:8decbeb46f88_83"},{"__ref":"Paragraph:8decbeb46f88_84"},{"__ref":"Paragraph:8decbeb46f88_85"},{"__ref":"Paragraph:8decbeb46f88_86"},{"__ref":"Paragraph:8decbeb46f88_87"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:74f7de1013c"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Flordx64.medium.com\u002Finitial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"8decbeb46f88","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":7,"allowResponses":true,"isLimitedState":false,"title":"Initial  analysis of PasswordState supply chain attack backdoor code","isSeries":false,"sequence":null,"uniqueSlug":"initial-analysis-of-passwordstate-supply-chain-attack-backdoor-code-aaff1df389e4","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1619290264842,"readingTime":6.730188679245282,"previewContent":{"__typename":"PreviewContent","subtitle":"One hour ago, I became aware of this supply chain attack from tweet by Kim Zetter. If you don’t follow her please do and subscribe to her…"},"previewImage":{"__ref":"ImageMetadata:0*rnNDVgt04qrqCAsZ"},"isShortform":false,"seoTitle":"","firstPublishedAt":1619218071342,"updatedAt":1641516124543,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:aaff1df389e4-viewerId:lo_081cce60fec4"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:supply-chain"},{"__ref":"Tag:malware"},{"__ref":"Tag:backdoor"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1280,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3b4953a8cdcb10',t:'MTczNDQ4NDM2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3b4953a8cdcb10","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>