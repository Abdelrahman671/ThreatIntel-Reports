<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>APT Cloud Atlas: Unbroken Threat</title><meta name="description" content="Specialists at the PT Expert Security Center have been monitoring the Cloud Atlas group since May 2019.
The goals of the group are espionage and theft of confidential information.
The group typically uses phishing emails with malicious attachments as the initial vector for their attacks.
In the third quarter of 2022, during our investigation we identified a phishing campaign targeting employees of Russian government agencies. 
The attackers used targeted mailing based on the professional field of the recipients, even though we found no publicly available information about them.
We first knew about the attackers back in 2014, when Kaspersky researchers published a report.
Since then, their tools have not changed much &amp;#40;you can find more about them in the &amp;quot;Malware analysis&amp;quot; section&amp;#41;.
However, there has not yet been a detailed analysis and description of the functionality of these tools.
In this report, we&amp;#39;ll discuss the main techniques of the Cloud Atlas group, and take an in-depth look at the tools they use."/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/images/favicons/favicon.ico" sizes="any"/><link rel="icon" href="/images/favicons/icon.svg" type="image/svg+xml"/><link rel="apple-touch-icon" href="/images/favicons/apple-touch-icon.png"/><meta name="next-head-count" content="7"/><script type="text/javascript">
                   
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();
    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
  
                   ym(93900442, "init", {
                       clickmap: true,
                       trackLinks: true,
                       accurateTrackBounce: true,
                       webvisor: true
                   });
             </script><noscript><div><img src="https://mc.yandex.ru/watch/93900442" style="position:absolute;left:-9999px" alt=""/></div></noscript><script id="mindbox-init">
    mindbox = window.mindbox || function() { mindbox.queue.push(arguments); };
    mindbox.queue = mindbox.queue || [];

    mindbox('create', {
        endpointId: 'ptsec.global',
    });
</script><script async="" src="https://api.mindbox.ru/scripts/v1/tracker.js"></script><script async="" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" data-domain-script="0191d674-840f-7931-a533-9567b38dbd10" data-document-language="true"></script><script type="text/javascript">function OptanonWrapper() { }</script><link rel="preload" href="/_next/static/css/80c4a58119cf7c0b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/80c4a58119cf7c0b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/941fc73e0d448350.css" as="style"/><link rel="stylesheet" href="/_next/static/css/941fc73e0d448350.css" data-n-p=""/><link rel="preload" href="/_next/static/css/aabb9bc1061deee8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/aabb9bc1061deee8.css" data-n-p=""/><link rel="preload" href="/_next/static/css/37c177beab301399.css" as="style"/><link rel="stylesheet" href="/_next/static/css/37c177beab301399.css" data-n-p=""/><link rel="preload" href="/_next/static/css/bb426d7648eb51ac.css" as="style"/><link rel="stylesheet" href="/_next/static/css/bb426d7648eb51ac.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d6441674d4b92143.js" defer=""></script><script src="/_next/static/chunks/framework-ce84985cd166733a.js" defer=""></script><script src="/_next/static/chunks/main-2aa161cc193cdf0e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8c55b79d26c9bd3.js" defer=""></script><script src="/_next/static/chunks/4b358913-e177b648ea0062d1.js" defer=""></script><script src="/_next/static/chunks/f10e284a-c46ff7024e963ef1.js" defer=""></script><script src="/_next/static/chunks/dff27125-edb64a536e668286.js" defer=""></script><script src="/_next/static/chunks/4322cd96-db9c9cbc97931387.js" defer=""></script><script src="/_next/static/chunks/5300-5d5240edfe5088d0.js" defer=""></script><script src="/_next/static/chunks/4028-70e0d285b32e5897.js" defer=""></script><script src="/_next/static/chunks/2580-447bcccef7567d77.js" defer=""></script><script src="/_next/static/chunks/8675-7126786e5e2e65c5.js" defer=""></script><script src="/_next/static/chunks/585-0d6245c6d60804bf.js" defer=""></script><script src="/_next/static/chunks/8973-5b086d43f68f9a0f.js" defer=""></script><script src="/_next/static/chunks/9381-dd4de4005cd3d545.js" defer=""></script><script src="/_next/static/chunks/254-dde07e0bcb3d5f5a.js" defer=""></script><script src="/_next/static/chunks/3330-13425461e8bb6bd9.js" defer=""></script><script src="/_next/static/chunks/4883-6aebae388f310771.js" defer=""></script><script src="/_next/static/chunks/9852-d3e7d7c2bf949d3a.js" defer=""></script><script src="/_next/static/chunks/9943-72218bdced5389b6.js" defer=""></script><script src="/_next/static/chunks/5363-fea1d2f79e1d9971.js" defer=""></script><script src="/_next/static/chunks/pages/analytics/pt-esc-threat-intelligence/%5Bslug%5D-debebc1698dc2505.js" defer=""></script><script src="/_next/static/9J5r29UMeK7ol_-oUfSrr/_buildManifest.js" defer=""></script><script src="/_next/static/9J5r29UMeK7ol_-oUfSrr/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class=""><header class="Header_header__Hd6K0" id="nav-bar"></header><main id="main" class="PageLayout_main__LUbC0"><div class="ArticleHeader_banner__enm6f"><section class="PageSection_section__GxaaG ArticleHeader_section__sve5w ArticleHeader_withBottomBar__d_wKA"><div class="ArticleHeader_header___PnMn"><div class="ArticleHeader_headerInner__2bYRI"><h2 class="Heading_base__MUnbH Heading_level_2__qXMBH"><span>APT Cloud Atlas: Unbroken Threat</span></h2></div></div><div class="ArticleHeader_bottomBar__EgyS1"><div class="ArticleHeader_leftSide__gAaId"><div class="ArticleBageLink_container__n25zS"><div class="ArticleBageLink_icon__Z9k9v"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.312 12.1358L8 14.7438L3.688 12.1358C3.1848 11.8491 2.76468 11.4366 2.46878 10.9388C2.17288 10.441 2.01135 9.8748 2 9.29577L2 2.50377C2 2.50377 2.04 2.39977 2.16 2.35177L7.808 1.21577C7.93487 1.19175 8.06513 1.19175 8.192 1.21577L13.84 2.35177C13.96 2.35177 14 2.46377 14 2.50377L14 9.29577C13.9887 9.8748 13.8271 10.441 13.5312 10.9388C13.2353 11.4366 12.8152 11.8491 12.312 12.1358Z" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.40039 7.1999L8.00039 8.7999L10.4004 6.3999" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg></div><a href="/analytics/pt-esc-threat-intelligence"><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_dark__type_pS__jWlgX"><span>PT EXPERT SECURITY CENTER</span></div></a></div><div class="ArticleDate_dark__bQPEn Text_base__riB2c Text_type_pS__4RXUf Text_theme_dark__type_pS__jWlgX"></div></div><div class="ArticleHeader_rightSide__zUGU_"><button type="button" class="ButtonShareLink_extraButton__6pf3i ArticleHeader_extraButton__zTZOf Button_button__F7Ulc Button_button_size_s___Bpb6 Button_button_theme_dark__iuu3A"><span>Share<img alt="share" loading="lazy" width="16" height="16" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/sharing.472b5ae7.svg"/></span></button></div></div></section></div><section class="PageSection_section__GxaaG Card_section__QzdVO"><div class="Card_contentWrapper__45uLa Card_mode_light__02f7V Card_zIndex_1__NP_2j"><div class="ArticleLayout_grid__ARjhp"><div class="ArticleLayout_leftColumn___AQb_"><div class="SidebarWidgets_root__EIInZ"><div class="SidebarWidget_root__IWq9u" data-theme="light"><span class="SidebarWidget_badge__gm6Re" aria-hidden="true"></span><a href="/analytics"><h4 class="SidebarWidget_link__7lVne Heading_base__MUnbH Heading_level_4__vTL_m Heading_theme_light__level_4__u4aOM"><span>Analytics articles</span></h4></a><ul class="SidebarWidget_articles__wrBxg"><li class="ArticlesWidget_article__5hn4y"><div class="ArticlesWidget_article_date__LAjT6 ArticleDate_light__n8s4o Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"></div><a target="_blank" href="/analytics/cyberthreats-to-industrial-iot"><div class="ArticlesWidget_article_text__Bx4ya Text_base__riB2c Text_type_pM__mE14b Text_clamp_3__8DSUm Text_theme_light__type_pM__2zLmc"><span>Cyberthreats to industrial IoT in the manufacturing sector</span></div></a></li><li class="ArticlesWidget_article__5hn4y"><div class="ArticlesWidget_article_date__LAjT6 ArticleDate_light__n8s4o Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"></div><a target="_blank" href="/analytics/cyberthreats-evolve-while-forecasts-signal-more-sophisticated-risks-ahead"><div class="ArticlesWidget_article_text__Bx4ya Text_base__riB2c Text_type_pM__mE14b Text_clamp_3__8DSUm Text_theme_light__type_pM__2zLmc"><span>Cyberthreats evolve while forecasts signal more sophisticated risks ahead</span></div></a></li><li class="ArticlesWidget_article__5hn4y"><div class="ArticlesWidget_article_date__LAjT6 ArticleDate_light__n8s4o Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"></div><a target="_blank" href="/analytics/trending-vulnerability-digest-november-2024"><div class="ArticlesWidget_article_text__Bx4ya Text_base__riB2c Text_type_pM__mE14b Text_clamp_3__8DSUm Text_theme_light__type_pM__2zLmc"><span>Trending vulnerability digest November 2024</span></div></a></li></ul></div><div class="AdBanner_banner__Phuq9"><img alt="" loading="lazy" decoding="async" data-nimg="fill" class="AdBanner_image__8dCJL" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent" src="https://pt-global.storage.yandexcloud.net/PT_Network_Attack_Discovery_2x_0d8a5793c7.png"/><div class="AdBanner_detail__tt_BJ"><h4 class="Heading_base__MUnbH Heading_level_4__vTL_m Heading_theme_dark__level_4__5RqHy"><span>What are the security threats on your network?</span></h4><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_dark__type_pM__3GUPK"><span>Check your traffic-for free</span></div><a class="AdBanner_button__9I57f Button_button__F7Ulc Button_button_size_m__cmMD_ Button_button_theme_dark__iuu3A" href="/analytics/pt-esc-threat-intelligence/apt-cloud-atlas-unbroken-threat#contacts"><span><span>Request pilot</span></span><img alt="" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="Button_arrow__ZXQXI" style="color:transparent" src="/_next/static/media/arrows-right.1fc87099.svg"/></a></div></div></div></div><div class="ArticleLayout_rightColumns___55GM"><div class="ArticleLayout_rightColumn__c8u4z"><div class="HtmlContent_content__ajDaE esiArticle_bitrixContent__PCSBe"><article>
<h2>Introduction</h2>
<p>
	 Specialists at the PT Expert Security Center have been monitoring the Cloud Atlas group since May 2019. According to our data, its attacks have been targeting the government sector of the following countries:
</p>
<ul>
	<li>Russia</li>
	<li>Belarus</li>
	<li>Azerbaijan</li>
	<li>Turkey</li>
	<li>Slovenia</li>
</ul>
<p>
	 The goals of the group are espionage and theft of confidential information.
</p>
<p>
	 The group typically uses phishing emails with malicious attachments as the initial vector for their attacks.
</p>
<p>
	 In the third quarter of 2022, during our investigation we identified a phishing campaign targeting employees of Russian government agencies. The attackers used targeted mailing based on the professional field of the recipients, even though we found no publicly available information about them.
</p>
<p>
	 We first knew about the attackers back in 2014, when Kaspersky researchers published a <a href="https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/">report</a>. Since then, their tools have not changed much (you can find more about them in the &quot;Malware analysis&quot; section). However, there has not yet been a detailed analysis and description of the functionality of these tools.
</p>
<p>
	 In this report, we&#x27;ll discuss the main techniques of the Cloud Atlas group, and take an in-depth look at the tools they use.
</p>
<h2>Analysis of the documents found</h2>
<p>
	 As in previous years, the group begins its attack by sending phishing emails, using current geopolitical issues that are directly related to the target country as a bait text. An example of an email with malicious content that was sent as part of the campaign in 2022 is shown in Figure 1. Pay special attention to the sender&#x27;s address: the attackers disguised themselves as the news portal <a href="https://lenta.ru">Lenta.ru</a>, well-known in Russia and the CIS. However, email addresses with such a domain can be created with Rambler (Figure 2).
</p>
 <figure> <img alt="The email" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/1.png"/> <figcaption>Figure 1. The email</figcaption> </figure> <figure> <img alt="A registration window with the @lenta.ru domain name" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/2.png"/> <figcaption>Figure 2. A registration window with the @lenta.ru domain name</figcaption> </figure>
<p>
	 Most often, the text is taken from the media or from publicly available official documents. Also, for example, in a 2019 attack aimed at Azerbaijan, a text related to the &quot;Indestructible Brotherhood 2019&quot; training exercises in Tajikistan was used, while in the 2020 attacks on organizations in Belarus, the emails contained a text related to the presidential elections.
</p>
<p>
	 Figure 3 shows an example of a document which downloads a malicious template (here is a <a href="https://news.ru/near-east/pochemu-islamskij-mir-ne-daet-zapadu-izolirovat-rossiyu/">link</a> to the page with the document&#x27;s contents).
</p>
 <figure> <img alt="The malicious document" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/3.png"/> <figcaption>Figure 3. The malicious document</figcaption> </figure>
<p>
	 In all cases, the malicious attachment was a document (in either DOC or DOCX format) that implements a Template Injection attack. In such attacks, the document does not contain macros or any other malicious code, and, in most of the observed cases when the DOC format was used, it may not be flagged by static analysis tools such as antiviruses (see Figure 4).
</p>
 <figure> <img alt="The document with a link to the template is not detected as malicious" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/4.png"/> <figcaption>Figure 4. The document with a link to the template is not detected as malicious</figcaption> </figure>
<p>
	 The document contains only a link to the template, which is located on a remote server. When the document is opened, the template is automatically downloaded from the remote server.
</p>
 <figure> <img alt="An example of a template link in Cloud Atlas documents" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/5.png"/> <figcaption>Figure 5. An example of a template link in Cloud Atlas documents</figcaption> </figure>
<p>
	 It&#x27;s the template that may be malicious, containing a macro or exploit. This download method is a legitimate function of Microsoft Office, but attackers can take advantage of it. For example, the same technique is used by the Gamaredon group in their attacks.
</p>
<p>
	 In most cases of a successful connection, an empty document was returned in response. However, in some attacks, we managed to detect the download of a malicious template in the form of an RTF file containing an exploit for the <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2017-11882">CVE-2017-11882</a> vulnerability.
</p>
<p>
	 Researchers at Palo Alto <a href="https://unit42.paloaltonetworks.com/unit42-inception-attackers-target-europe-year-old-office-vulnerability/">discovered</a> a similar malware delivery chain in 2018. In these attacks, the downloaded RTF templates contained an exploit for the CVE-2017-11882 vulnerability, as well as a simple PowerShell backdoor, which was dubbed PowerShower.
</p>
<p>
	 We paid special attention to the <a href="https://interoperability.blob.core.windows.net/files/MS-DOC/%5bMS-DOC%5d.pdf">DOC</a> documents used in this attack: a characteristic feature of all the documents containing a malicious download was a link to malicious content inside the 1Table or 0Table stream (Figure 9, highlighted in green).
</p>
<p>
	 After studying the DOC format and comparing malicious documents with regular ones, we found a number of patterns in the infected files.
</p>
<p>
	 First, the DOC format requires the 1Table or 0Table stream in any document, along with the mandatory WordDocument stream (Figure 6).
</p>
 <figure> <img alt="DOC format content" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/6.png"/> <figcaption>Figure 6. DOC format content</figcaption> </figure>
<p>
	 Second, each document contains a special FIB (File Information Block) structure—in Figure 7, the fragment is highlighted in yellow—in which there is a base.fWhichTblStm parameter. Setting this bit to 0 or 1 determines which of the given streams should be used in the document.
</p>
 <figure> <img alt="An FIB fragment in a document" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/7.png"/> <figcaption>Figure 7. An FIB fragment in a document</figcaption> </figure>
<p>
	 Figure 8 shows the structure of an FIB taken from the documentation. Particular attention should be paid to the structure highlighted in red. The G bit interests us here the most (highlighted in green). This is the base.fWhichTblStm parameter.
</p>
 <figure> <img alt="A fragment of an FIB structure" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/8.png"/> <figcaption>Figure 8. A fragment of an FIB structure</figcaption> </figure>
<p>
	 Finally, the last thing that we discovered: links to malicious templates are always located at approximately the same offsets relative to the hex strings in the Table stream. (We were not much interested in the format of the stream itself yet.) In Figure 9, the strings of bytes are shown in yellow and red. Using these, we calculated various malicious template link offsets. This allowed us to quite effectively detect the use of this technique in a specific implementation.
</p>
 <figure> <img alt="A malicious link inside a Table stream" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/9.png"/> <figcaption>Figure 9. A malicious link inside a Table stream</figcaption> </figure>
<h2>Attack chain analysis</h2>
<p>
	 In the course of our research, we identified several attack chains (Figure 10), which differed in the number of stages required to load the main functionality, as well as the tools used at each stage. Nevertheless, the use of these chains is not new for this group.
</p>
 <figure> <img alt="Flow chart of the identified attack chains" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/10.png"/> <figcaption>Figure 10. Flow chart of the identified attack chains</figcaption> </figure>
<p>
	 The first thing we noticed was a remote template downloading an RTF document with an exploit, which in turn downloads and launches an HTA file. An example of the contents is shown in Figure 11.
</p>
 <figure> <img alt="The contents of the HTA file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/11.png"/> <figcaption>Figure 11. The contents of the HTA file</figcaption> </figure>
<p>
	 An examination of the document and its contents revealed that a vulnerability in Equation Editor was used to launch the exploit payload. The shellcode (highlighted in red in Figure 12) is located inside one of the document&#x27;s objects and is executed in the context of the EQNEDT32.EXE process.
</p>
 <figure> <img alt="The encrypted shellcode" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/12.png"/> <figcaption>Figure 12. The encrypted shellcode</figcaption> </figure>
<p>
	 The bulk of the shellcode is stored in encrypted form and decrypted after control is transferred to it.
</p>
<p>
	 Figure 13 shows the decrypted shellcode, with the first 13 bytes responsible for decrypting the main part of the shellcode (the loop statement is decrypted at the first iteration). For decryption, XOR is used with a two-byte key embedded in the code.
</p>
 <figure> <img alt="The decrypted shellcode" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/13.png"/> <figcaption>Figure 13. The decrypted shellcode</figcaption> </figure>
<p>
	 The direct link to the HTA file (through which the loading is performed) is stored in the body of the shellcode (Figure 14) and is additionally XOR-encrypted with the one-byte value of 0x12.
</p>
 <figure> <img alt="The link to the malicious HTA file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/14.png"/> <figcaption>Figure 14. The link to the malicious HTA file</figcaption> </figure>
<p>
	 As seen in Figure 11, the HTA file is designed to create on the disk the VBS scripts with the payload for subsequent stages, as well as an LNK file with the main payload containing the code for loading binary modules. Thus, the main task of the VBS macros (in our case, both macros had similar names: unbroken.vbs and unbroken.vbs.vbs) is to deobfuscate the contents of the LNK file (shown in Figure 15) and transfer control to it, after which the payload which was downloaded by the LNK file code is launched (we will discuss this in the &quot;Malware analysis&quot; section).
</p>
 <figure> <img alt="The LNK file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/15.png"/> <figcaption>Figure 15. The LNK file</figcaption> </figure>
<p>
	 It is also worth noting that malicious documents which exploit the same vulnerabilities in Equation Editor and contain identical object names (for example, &quot;weaseoijsd&quot;,highlighted in red in Figure 16) in RTF documents <a href="https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html">were analyzed</a> by Cisco Talos Intelligence specialists and attributed to the Bitter APT group.
</p>
 <figure> <img alt="The object name in the RTF file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/16.png"/> <figcaption>Figure 16. The object name in the RTF file</figcaption> </figure>
<p>
	 The second chain that we found is downloading malicious PowerShell scripts via remote templates (Figure 17), which in turn download malicious components (mostly Base64-encoded).
</p>
 <figure> <img alt="The script that loads the payload" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/17.png"/> <figcaption>Figure 17. The script that loads the payload</figcaption> </figure>
<p>
	 We also encountered cases of an intermediate .NET loader that downloaded a payload from a remote server and transferred control to it.
</p>
<p>
	 This .NET loader is decoded from Base64 and launched by a PowerShell script (Figure 18).
</p>
 <figure> <img alt="The script for decoding and launching the necessary export" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/18.png"/> <figcaption>Figure 18. The script for decoding and launching the necessary export</figcaption> </figure>
<p>
	 The export (Figure 19), activated from the loader, takes all the necessary parameters for network communication, including the connection encryption key (highlighted in yellow in Figure 18).
</p>
 <figure> <img alt="The export activated from the loader" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/19.png"/> <figcaption>Figure 19. The export activated from the loader</figcaption> </figure>
<p>
	 The communication is encrypted with a simple XOR operation with the transferred key (Figure 20).
</p>
 <figure> <img alt="The encryption of the communication inside the loader" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/20.png"/> <figcaption>Figure 20. The encryption of the communication inside the loader</figcaption> </figure>
<h2>Malware analysis</h2>
<h3>Initial module</h3>
<p>
	 The main task of the initial stage is to decrypt the loader of the main functionality and transfer control to it. We should mention that all such samples that we discovered are quite large and also obfuscated. The loader, in turn, is stored exclusively in the process memory and is not present on the disk at all. The loader is decrypted in parts, via single-byte XOR with different keys (Figure 21). It is also striking that the decryption code is &quot;diluted&quot; with various operations. This is obviously to make searching for and identifying data decryption procedures more complicated.
</p>
 <figure> <img alt="Partial decryption of the loader" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/21.png"/> <figcaption>Figure 21. Partial decryption of the loader</figcaption> </figure>
<p>
	 We also noted that almost all of the functions that decrypt the loader contain a large amount of polymorphic code. This performs various operations with strings located inside the image, stack strings, as well as with their individual elements (Figure 22 shows an example). However, these operations do not have any effect on the decrypted data itself. They are used to calculate various variables and constants that affect the decryption parameters (data size, offsets, and so on), as well as to complicate the analysis process. The decrypted data is copied to a pre-allocated memory area as a valid PE image, after which control is transferred to it.
</p>
 <figure> <img alt="An example of polymorphic code" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/22.png"/> <figcaption>Figure 22. An example of polymorphic code</figcaption> </figure>
<h3>Main loader</h3>
<p>
	 The loader, in turn, is responsible for reading the data from the file containing the main payload, as well as for its decryption and unpacking.
</p>
<p>
	 First, the loader decrypts the configuration located in its body. The decryption algorithm (Figure 23) is single-byte XOR with an embedded key. After decryption, the configuration is validated.
</p>
<p>
	 We noted that the configuration has not changed since previous studies—it contains the same data and parameters (Figure 23).
</p>
 <figure> <img alt="Decrypting the loader configuration" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/23.png"/> <figcaption>Figure 23. Decrypting the loader configuration</figcaption> </figure> <figure> <img alt="The loader configuration" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/24.png"/> <figcaption>Figure 24. The loader configuration</figcaption> </figure>
<p>
	 Next, the loader reads the file created at the initial stage of the installation, after which it decrypts and unpacks the data contained in it.
</p>
<p>
	 It&#x27;s at this stage where the first differences from earlier samples appear: to hide the payload, AES in CBC mode is used, after which the data is unpacked by LZNT1 (it used to be LZMA).
</p>
<p>
	 The unpacking algorithm is rather interesting: the data is unpacked not as a single byte array, but by chunks of various sizes. Figure 25 shows the addition of the header_start_chunk offset to the zero offset of each chunk (for the first of them, an additional offset of 4), after which the unpacking function is activated.
</p>
<p>
	 Thus, the structure of the first chunk in the decrypted load can be represented as follows:
</p>
 <pre>    <div class="code">
struct first_comprChunk
{
DWORD signature;
WORD sizeOfCurrChunk; // in fact compressed buffer size
BYTE data[sizeOfCurrChunk]; //compressed data
};
    </div>
</pre>
<p>
	 Correspondingly, the remaining chunks do not have the first DWORD field and have the following structure:
</p>
 <pre>    <div class="code">
struct comprChunk
{
WORD compressedBuffSize;
BYTE data[sizeOfCurrChunk];
};
    </div>
</pre>
<p>
	 Each chunk is unpacked independently of the others, without any padding, strictly according to the offsets from its headers.
</p>
 <figure> <img alt="Unpacking the decrypted data" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/25.png"/> <figcaption>Figure 25. Unpacking the decrypted data</figcaption> </figure>
<p>
	 The final stage of the loader involves loading the unpacked data as a valid PE image, searching for the required export by the ordinal name, and transferring control to it (Figure 26).
</p>
 <figure> <img alt="Overview of the loader functionality" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/26.png"/> <figcaption>Figure 26. Overview of the loader functionality</figcaption> </figure>
<h3>Payload</h3>
<p>
	 The data received at the loader stage is the payload of the malware. Its main functionality is to initialize the connection to the control server and load various modules from it.
</p>
<p>
	 Curiously enough, the payload module also has a configuration inside which is identical to the one in the loader, but in this case it is AES-encrypted and gets decrypted after control is transferred to the main module.
</p>
<p>
	 Next, the malware generates a communication packet that is sent to the server to establish a connection. This packet contains information about the infected machine and is most likely designed to identify targets that are of interest for attackers.
</p>
<p>
	 The structure of the packet is shown below (Figure 27).
</p>
 <pre>    <div class="code">
struct Message
{
DWORD lenOfPacket;
DWORD sizeOf_OSVERSIONINFO;
BYTE data_OSVERSIONINFO[sizeOf_OSVERSIONINFO - 4];
DWORD volumeInformation;
BYTE timestamp[16]; // GetLocalTime
WORD GetUserDefaultLCID;
WORD GetSystemDefaultLCID;
DWORD len_of_1_field;
DWORD len_of_2_field;
DWORD len_of_3_field;
DWORD len_of_4_field;
char username; //1_field
char PcName; //2_field
char executePath; //3_field
char applicationName; //4_field
char argvParam;
DWORD lenOf_curr currFileSystem;
char currFileSystem[lenOf_curr currFileSystem];
};</div>
</pre> <figure> <img alt="An example of a generated packet" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/27.png"/> <figcaption>Figure 27. An example of a generated packet</figcaption> </figure>
<p>
	 The malware sends the generated packet to the control server, using the CLSID_IServerXMLHTTPRequest2 COM object for communication (Figure 28).
</p>
 <figure> <img alt="The object initialization code" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/28.png"/> <figcaption>Figure 28. The object initialization code</figcaption> </figure>
<p>
	 The restored table of this object&#x27;s virtual methods can be described by the following structure:
</p>
<p>
</p>
 <pre>    <div class="code">
struct IServerXmlHttpRequest2Vtbl
{
int QueryInterface;
int AddRef;
int Release;
int GetTypeInfoCount;
int GetTypeInfo;
int GetIDsOfNames;
int Invoke;
int open;
int setRequestHeader;
int getResponseHeader;
int getAllResponseHeaders;
int send;
int abort;
int get_status;
int get_statusText;
int get_responseXML;
int get_responseText;
int get_responseBody;
int get_responseStream;
int get_readyState;
int put_onreadystatechange;
int setTimeouts;
int waitForResponse;
int getOption;
int setOption;
int setProxy;
int setProxyCredentials;
};
    </div>
</pre>
<p>
	 It should be noted that the protocol for communicating between the malware and the server supports five types of requests (Figure 29), each of which is used at a certain stage of communication.
</p>
 <figure> <img alt="Types of requests from the malware to the control server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/29.png"/> <figcaption>Figure 29. Types of requests from the malware to the control server</figcaption> </figure>
<p>
	 For example, after a PROPFIND request that installs the directory contents on the remote server, a GET request is made to load the module contained on the control server. Curiously, if the loading is successful, this module is deleted (Figure 30).
</p>
 <figure> <img alt="A fragment of the communication with the control server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/30.png"/> <figcaption>Figure 30. A fragment of the communication with the control server</figcaption> </figure>
<p>
	 If the communication is successful, binary data is loaded (Figure 31) containing a specific module in obfuscated form.
</p>
 <figure> <img alt="Loading a module from the server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/31.png"/> <figcaption>Figure 31. Loading a module from the server</figcaption> </figure>
<p>
	 The same procedures are used for obfuscating the data as for extracting the payload with the loader: AES-CBC encryption and LZNT1 compression.
</p>
<p>
	 The functions responsible for the payload extraction procedure, as well as the encryption keys and initialization vectors used to encrypt the communication, are identical to those used to extract the payload in the loader.
</p>
<p>
	 In the course of our research, we managed to obtain a sample that the malware downloads from the control server (examples of the server contents are shown in Figures 32 and 33).
</p>
 <figure> <img alt="The directories on the remote server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/32.png"/> <figcaption>Figure 32. The directories on the remote server</figcaption> </figure> <figure> <img alt="The file containing the module on the server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/33.png"/> <figcaption>Figure 33. The file containing the module on the server</figcaption> </figure>
<p>
	 The loaded module is decrypted and unpacked (Figure 34), and placed in the memory as a PE image, just as in the case of the loader. It&#x27;s also worth noting that the ordinal name (which is used to search for the export to call) is identical to the one used to transfer control to the payload.
</p>
 <figure> <img alt="A fragment of decrypted and unpacked data" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/34.png"/> <figcaption>Figure 34. A fragment of decrypted and unpacked data</figcaption> </figure>
<p>
	 The decrypted payload is an executable module, which is preceded by a configuration. Based on the content of the configuration, the main functionality of the loaded module becomes clear: to steal files from an infected computer according to certain parameters.
</p>
<p>
	 In particular, attackers are interested in files with these extensions: *.doc, *.docx, *.xls, *.xlsx, *.pdf, *.rtf, *.contact, *.odt, *.jpg, *.jpeg. Accordingly, the paths needed to search for the files are also present in the configuration. These can be both disk names and network paths to remote machines.
</p>
<h3>Functionality of the loaded module</h3>
<p>
	 The first thing that interested us was that the function that transfers control to the code of the loaded module in the first argument (Figure 35) passes a pointer to the function which communicates with the control server.
</p>
 <figure> <img alt="A code fragment for calling the downloaded module" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/35.png"/> <figcaption>Figure 35. A code fragment for calling the downloaded module</figcaption> </figure>
<p>
	 Analyzing this function allowed us to understand that in this case the communication scheme is identical to the one described above: data is transferred by function calls from the table of virtual methods of the same COM object (in this case, PUT is used as the communication method).
</p>
<p>
	 Other than this, the analysis of the loaded module reveals nothing of interest. It simply performs a recursive search in the directories of certain paths.
</p>
<p>
	 It&#x27;s worth noting that for each type of disk connected to the computer, a different type of search is used (Figure 36). It is also possible to steal files from remote servers—in this case, usernames and passwords (stored in the malware configuration) are transferred as parameters.
</p>
 <figure> <img alt="Different types of search implemented in the malware" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/36.png"/> <figcaption>Figure 36. Different types of search implemented in the malware</figcaption> </figure>
<p>
	 Let&#x27;s also have a look at the function responsible for analyzing the contents of the scanned directories (Figure 37). It&#x27;s worth noting that the function itself does not read the file directly. Instead, the pointer to the read function (pfnReadFile in the figure) is transferred through the global context—the structure that is initialized at the initial stage of the application—and the function is called this way.
</p>
 <figure> <img alt="The function for searching files in a directory" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/37.png"/> <figcaption>Figure 37. The function for searching files in a directory</figcaption> </figure>
<h2>Network infrastructure</h2>
<p>
	 All the domains that we discovered in the 2019–2021 attacks were registered through the anonymous registrar bitdomain[.]biz. This resource guarantees complete anonymity and payment on the service is made exclusively in bitcoins.
</p>
<p>
	 After analyzing the SOA records of the domains, we found that the admin email address field contains perfectly normal email addresses. In some cases, they turned out to be the registrant addresses that we found in WHOIS. Therefore, in those domains where WHOIS was hidden by the privacy settings, it can be assumed that the email in the SOA is the email of the registrant.
</p>
 <br/>
<div class="table-container">
	<table class="table-article">
	<tbody>
	<tr>
		<td>
			<p align="center">
 <b>Domain </b>
			</p>
 <b> </b>
		</td>
		<td>
 <b> </b>
			<p align="center">
 <b>
				email </b>
			</p>
 <b> </b>
		</td>
	</tr>
	</tbody>
	<tbody>
	<tr>
		<td>
			<p align="center">
				 mynewtemplate.com
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:adam_s92@protonmail.com">adam_s92@protonmail.com</a>
			</p>
		</td>
	</tr>
	<tr>
		<td>
			<p align="center">
				 new-template.com
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:piterjesten@protonmail.com">piterjesten@protonmail.com</a>
			</p>
		</td>
	</tr>
	<tr>
		<td>
			<p align="center">
				 upgrade-office.com
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:p.borovin@protonmail.com">p.borovin@protonmail.com</a>
			</p>
		</td>
	</tr>
	<tr>
		<td>
			<p align="center">
				 upgrade-office.org
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:pavel.savin1992@bk.ru">pavel.savin1992@bk.ru</a>
			</p>
		</td>
	</tr>
	<tr>
		<td>
			<p align="center">
				 msofficeupdate.org
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:g.j.dodson@protonmail.com">g.j.dodson@protonmail.com</a>
			</p>
		</td>
	</tr>
	<tr>
		<td>
			<p align="center">
				 officeupgrade.org
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:alex.sval@tutanota.com">alex.sval@tutanota.com</a>
			</p>
		</td>
	</tr>
	<tr>
		<td>
			<p align="center">
				 newoffice-template.com
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:j.konnoban@email.cz">j.konnoban@email.cz</a>
			</p>
		</td>
	</tr>
	<tr>
		<td>
			<p align="center">
				 template-new.com
			</p>
		</td>
		<td>
			<p align="center">
 <a href="mailto:e.darmanin@inbox.lv">e.darmanin@inbox.lv</a>
			</p>
		</td>
	</tr>
	</tbody>
	</table>
</div>
 <br/>
<p>
	 When analyzing the 2022 campaign, we found a pattern: all the control servers registered by the attackers are used only to load remote templates.
</p>
<p>
	 List of the detected servers:
</p>
<ul>
	<li>checklicensekey.com</li>
	<li>comparelicense.com</li>
	<li>driver-updated.com</li>
	<li>sync-firewall.com</li>
	<li>system-logs.com</li>
	<li>technology-requests.net</li>
	<li>translate-news.net</li>
</ul>
<p>
	 We also discovered an interesting fact: the attackers disguised one of the control servers (technology-requests.net), trying to make it look like the site <a href="https://www.hoosierheightsindianapolis.com">https://www.hoosierheightsindianapolis.com</a> (Figure 38).
</p>
 <figure> <img alt="The legitimate site" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/38.png"/> <figcaption>Figure 38. The legitimate site</figcaption> </figure>
<p>
	 Figure 39 shows what the malicious site looked like on July 26, according to webcache.googleusercontent.com.
</p>
 <figure> <img alt="The site from which the malicious content was downloaded" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/39.png"/> <figcaption>Figure 39. The site from which the malicious content was downloaded</figcaption> </figure>
<p>
	 The malicious tools communicate through a cloud service (similar to previous years), namely OpenDrive (<a href="https://www.opendrive.com/">https://www.opendrive.com</a>). The service is used for both storing the malware modules to be loaded and for loading the collected data. In this case, a temporary mailbox is used for logins.
</p>
<h2>Conclusion</h2>
<p>
	 The Cloud Atlas group has been active for many years, carefully thinking through every aspect of their attacks. The group&#x27;s toolkit has not changed for years—they try to hide their malware from researchers by using one-time payload requests and validating them. The group avoids network and file attack detection tools by using legitimate cloud storage and well-documented software features, in particular in Microsoft Office.
</p>
<p>
	 The attackers also carefully choose their victims and target their attacks: the group used targeted mailings based on the professional field of the recipients, but we noted the absence of any publicly available information about the recipients, which could indicate a well-prepared attack.
</p>
<p>
	 We predict that the group will continue to operate, increasing the complexity of its tools and attack techniques due to the fact that it has once again attracted the attention of researchers.
</p>

<p>
<b>Authors:</b> Denis Kuvshinov, Aleksandr Grigorian, Daniil Koloskov, Positive Technologies
</p>

<p>The article&#x27;s authors thank the incident response and threat intelligence teams PT Expert Security Center for their help in drafting the story.
</p>




<h2>Detection of CloudAtlas group activity by Positive Technologies products</h2>
<h3><a href="https://www.ptsecurity.com/ww-en/products/mpsiem/">MP SIEM</a></h3>
<p>
The following correlation rules analyze triggered processes and help identify the described activity:
</p>
<ul>
<li>Suspicious_Connection</li>
<li>Malicious_Office_Document</li>
<li>Windows_Autorun_Modification</li>
</ul>
<p>
The following correlation rules analyze the triggered scripts and help detect the described activity:
</p>
<ul>
<li>Execute_Malicious_Powershell_Cmdlet</li>
<li>Execute_Malicious_Command</li>
</ul>
<p>
Implementation of D3FEND techniques in MP SIEM, which will help in detecting CloudAtlas grouping activity
</p>
<div class="table-container">
	<table class="table-article">
	<tbody>
<tr>
	<td>
		<p align="center">
			 <b>D3FEND ID
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Name of technique  D3FEND
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Description</b>
		</p>
	</td>
</tr>
</tbody><tbody>
<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:ProcessAnalysis/">D3-PA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 Process Analysis
		</p>
	</td>
	<td>
		<p>
			CloudAtlas group activity can be identified through the rules of process analysis.

		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:ScriptExecutionAnalysis/">D3-SEA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 Script Execution Analysis
		</p>
	</td>
	<td>
		<p>
			CloudAtlas group activity can be detected through the analysis rules of the launched scripts. 
			</p>
	</td>
</tr>

</tbody>
	</table>
</div><br/>

<h3><a href="https://www.ptsecurity.com/ww-en/products/network-attack-discovery/">PT NAD</a></h3>
<p>
PT NAD contains a CloudAtlas reputation list, which will help in identifying CloudAtlas grouping activity.
</p>
<p>
Implementation of D3FEND techniques in PT NAD, which will help in detecting CloudAtlas activity.
</p>
<div class="table-container">
	<table class="table-article">
	<tbody>
<tr>
	<td>
		<p align="center">
			 <b>D3FEND ID
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Name of technique  D3FEND
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Description</b>
		</p>
	</td>
</tr>
</tbody><tbody>
	
<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:DNSTrafficAnalysis/">D3-DNSTA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 DNS Traffic Analysis
		</p>
	</td>
	<td>
		<p>
			Using reputation lists to detect Cloud Atlas group activity
			</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:FileCarving/">D3-FC</a>
		</p>
	</td>
	<td>
		<p align="center">
			 File Carving
		</p>
	</td>
	<td>
		<p>
			Extracting from traffic the files downloaded by the Cloud Atlas group
			</p>
	</td>
</tr>

</tbody>
	</table>
</div><br/>


<h3><a href="https://www.ptsecurity.com/ww-en/products/sandbox/">PT Sandbox</a></h3>
<p>
PT Sandbox verdicts on CloudAtlas grouping activity:
</p>
<ul>
<li>Trojan.Win32.Generic.a</li>
<li>Trojan.Win32.RegLOLBins.a</li>
<li>Backdoor.Win32.CloudAtlas.a</li>
<li>Trojan-Downloader.Win32.Generic.a</li>
</ul>
<p>
Network traffic analysis rules to help detect CloudAtlas grouping activity:
</p>
<ul>
<li>LOADER [PTsecurity] Possible CloudAtlas</li>
<li>SUSPICIOUS [PTsecurity] PROPFIND method in http request</li>
<li>SUSPICIOUS [PTsecurity] MKCOL method in http request</li>
</ul>
<p>
Yara-rules, which will help in detecting CloudAtlas grouping activity:
</p>
<ul>
<li>PTESC_tool_win_ZZ_OfficeTemplate__Downloader__DOC</li>
<li>PTESC_exploit_win_ZZ_MalDoc__CVE201711882__Rtf__CA</li>
</ul>

<p>
Implementation of D3FEND techniques in PT Sandbox, which will help in detecting CloudAtlas grouping activity
</p>
<div class="table-container">
	<table class="table-article">
	<tbody>
<tr>
	<td>
		<p align="center">
			 <b>D3FEND ID
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Name of technique  D3FEND
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Description</b>
		</p>
	</td>
</tr>
</tbody><tbody>
	
<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:ProcessAnalysis/">D3-PA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 Process Analysis
		</p>
	</td>
	<td>
		<p>
			Analysis of the behavior of processes created by malicious applications of the Cloud Atlas group
			</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:FileAnalysis/">D3-FA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 File Analysis
		</p>
	</td>
	<td>
		<p>
			Analysis of Cloud Atlas group files to determine their status and functionality
			</p>
	</td>
</tr>


<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis/">D3-NTA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 Network Traffic Analysis
		</p>
	</td>
	<td>
		<p>
			CloudAtlas activity can be detected through traffic analysis
			</p>
	</td>
</tr>

</tbody>
	</table>
</div><br/>



<h2 id="id7">Yara</h2>
<pre>    <div class="code">
rule PTESC_tool_win_ZZ_OfficeTemplate__Downloader__DOC
{
	strings:
		$a = {00 A5 06 6E 04 B4}
		$b = {FF FF FF 7F FF FF FF 7F}
		$c = {B4 00 B4 00 81 81 12 30 00}
		$pref_1 = {68 00 74 00 74 00 70 00 3A 00 2F 00 2F}
		$pref_2 = {68 00 74 00 74 00 70 00 73 00 3A 00 2F 00 2F}
	condition:
		uint16be ( 0 ) == 0xd0cf and ( for any i in ( 300 .. 400 ) : ( uint8be ( @a + i ) == 0x68 and uint8be ( @a + i + 2 ) == 0x74 and uint8be ( @a + i + 4 ) == 0x74 and uint8be ( @a + i + 6 ) == 0x70 ) or for any j in ( 100 .. 200 ) : ( uint8be ( @b + j ) == 0x68 and uint8be ( @b + j + 2 ) == 0x74 and uint8be ( @b + j + 4 ) == 0x74 and uint8be ( @b + j + 6 ) == 0x70 ) or for any k in ( 200 .. 400 ) : ( uint8be ( @c + k ) == 0x68 and uint8be ( @c + k + 2 ) == 0x74 and uint8be ( @c + k + 4 ) == 0x74 and uint8be ( @c + k + 6 ) == 0x70 ) ) and ( ( for any l in ( 14 .. 70 ) : ( uint8be ( @pref_1 + l ) == 0x2f ) ) or ( for any y in ( 16 .. 70 ) : ( uint8be ( @pref_2 + y ) == 0x2f ) ) )
}

</div></pre>

<pre>    <div class="code">
rule PTESC_exploit_win_ZZ_MalDoc__CVE201711882__Rtf__CA
{
 strings:
 $equation = &quot;4571756174696F6E&quot; nocase ascii //180000004571756174696F6E
 $msftedit = &quot;generator Msftedit 6.39.15&quot; nocase ascii //generator Msftedit 6.39.15.1401
 $objclass = &quot;objclass weaseoijsd&quot; nocase ascii
 condition:
 uint32be ( 0 ) == 0x7B5C7274 and ($equation and ($msftedit or $objclass) or (for any i in (50..350) : (uint8be (@equation + i) == 0x64 and uint8be (@equation + i + 2) == 0x64 and uint8be (@equation + i + 4) == 0x64 and uint8be (@equation + i + 6) == 0x38)))
}
</div></pre>



<h2>IOCs</h2>

	<h3>File indicators</h3>
<br/>
<div class="table-container">
	<table class="table-article">
	<tbody>
<tr>
	<td>
		<p align="left">
			 <b>Name
		</b></p><b>
	</b></td><td><b>
		</b><p align="left"><b>
			 SHA-256
		</b></p><b>
	</b></td><td><b>
		</b><p align="left"><b>
			 MD5
		</b></p><b>
	</b></td><td><b>
		</b><p align="left"><b>
			 SHA-1</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 Методические рекомендации для грузоотправителей-грузополучателей (2022).doc (Guidelines for consignors-consignees (2022).doc)
		</p>
	</td>
	<td>
		<p align="left">
			 f2c4281e4d6c11173493b759adfb0eb798ce46650076e7633cf086b6d59fdb98
		</p>
	</td>
	<td>
		<p align="left">
			 b3f55d9065dd51a8be2d6c5078866086
		</p>
	</td>
	<td>
		<p align="left">
			 9f4a18adaa094eef06ef88e76b6f4ed777f677e7
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 Будьте_бдительны_Корпоративное_уведомление.doc (Stay_alert_Corporate_Notice.doc)
		</p>
	</td>
	<td>
		<p align="left">
			 482aeb3db436e8d531b2746a513fe9a96407cf4458405680a49605e136858ec5
		</p>
	</td>
	<td>
		<p align="left">
			 3399deafaa6b91e8c19d767935ae0908
		</p>
	</td>
	<td>
		<p align="left">
			 b745032dd5cd6f7eba2187fa3c86c775953a5611
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			Иранские оценки визита В. Путина в Тегеран.doc (Iranian assessments of V. Putin&#x27;s visit to Tehran.doc)
		</p>
	</td>
	<td>
		<p align="left">
			 2f97374c76ae10c642a57a8b13d25cbdc070c9098c951ea418d1533ac01dc23c
		</p>
	</td>
	<td>
		<p align="left">
			 61b6e2040d5815d0135b2850137828d9
		</p>
	</td>
	<td>
		<p align="left">
			 df80df54f94d56aa436cdc2713e3bc8160ce43f8
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 Почему исламский мир не дает Западу изолировать Россию.doc (Why the Islamic world does not allow the West to isolate Russia.doc)
		</p>
	</td>
	<td>
		<p align="left">
			 3cf2bda35e88c59bb89e7fdc8fcfd4c46b2b9186e61325d2924e049d775b741f
		</p>
	</td>
	<td>
		<p align="left">
			 2b5cec8715e92d87bf6992e003a5651c
		</p>
	</td>
	<td>
		<p align="left">
			 9fc804b58ab43fc5f453810a30ea311fc3f5cbe6
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 leptophis[1].doc
		</p>
	</td>
	<td>
		<p align="left">
			 c0e154b10d70b99b5616a2eda6bfe188a49f85ed3aa92d48ec9ce709df9d563f
		</p>
	</td>
	<td>
		<p align="left">
			 470c1df23bd825c6e36e1cd5936db912
		</p>
	</td>
	<td>
		<p align="left">
			 ba9fc2f0d9f0fcf726a2cbc426f570bea5f22c96
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 lep[1].hta
		</p>
	</td>
	<td>
		<p align="left">
			 a4194555b19ea32680cc23f8f7d42da02b82eba8b64cb5f4630110f4e2c1ddf3
		</p>
	</td>
	<td>
		<p align="left">
			 66ecc2285e9d172ceb9f0b0ba030c65c
		</p>
	</td>
	<td>
		<p align="left">
			 b5cc0a7ff0d8cd151545cbabcaf23c5486acec95
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 unbroken.vbs
		</p>
	</td>
	<td>
		<p align="left">
			 59066dc428cde7cc55f3c24c2658d3e288f3f072811d86243a85af14bd482744
		</p>
	</td>
	<td>
		<p align="left">
			 7ce01fc92fc221cad338cea1cfd43a22
		</p>
	</td>
	<td>
		<p align="left">
			 9579b7f3a98657f704575aa4a08ed6ff3d8680a4
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 unbroken.vbs.vbs
		</p>
	</td>
	<td>
		<p align="left">
			 4cb6e224b6b03a2f6ac1ac23e6bf097067018b90493ee94f210f66fbbbbdce77
		</p>
	</td>
	<td>
		<p align="left">
			 1aa04f847bd7ec987986ec6e52966b89
		</p>
	</td>
	<td>
		<p align="left">
			 8e23ac686bbc958dd85e46a2d4bb6acaee5aa35f
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 list.ps1
		</p>
	</td>
	<td>
		<p align="left">
			 2233c0d4030cc728c2219b1e9c4c05cb262e2ddc7f4ac2f2924767396418c25a
		</p>
	</td>
	<td>
		<p align="left">
			 d5a40e2986efd4a182bf564084533763
		</p>
	</td>
	<td>
		<p align="left">
			 89364b9d170ab90d25d30649582679c3d7332b91
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 office.ps1
		</p>
	</td>
	<td>
		<p align="left">
			 7fcf7c1dad362283d0a27993df4764e2bbb11857842b80f63d63449b9f2f1fa4
		</p>
	</td>
	<td>
		<p align="left">
			 d02ab337bc56214d72b8cabea8bc19b2
		</p>
	</td>
	<td>
		<p align="left">
			 81e22a16a6617670c394dbd7ee642eba8e419de7
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			office.ps1
		</p>
	</td>
	<td>
		<p align="left">
			 d9fc6504c8970fefc441c77965937c382b029f1278918d1f54d196859e9f6e7c
		</p>
	</td>
	<td>
		<p align="left">
			 077b71298ce31832ae43e834b7e6c080
		</p>
	</td>
	<td>
		<p align="left">
			 ee50f3cd04d0fdf5e931ad85bfd464828116279b
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			rtcpsvc.dll
		</p>
	</td>
	<td>
		<p align="left">
			 3e7b066c26ba98d285a41043c739be8767606d9df057ee2f7bcddb7862c00711
		</p>
	</td>
	<td>
		<p align="left">
			 f68e64dacd046289d4222098ee421478
		</p>
	</td>
	<td>
		<p align="left">
			 ce13a1ae0dd5d537320b77ac8e3d94df6448a82a
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 lockrail.dll
		</p>
	</td>
	<td>
		<p align="left">
			 c5d1de206445f508c1af5f213e46b915b536e4b36ef917c4e826a982dd47c312
		</p>
	</td>
	<td>
		<p align="left">
			 acbbc6fea0dbbe7cba511b450cc2b758
		</p>
	</td>
	<td>
		<p align="left">
			 94f342f9219cee4f2b91b54809de92d5bb00e93e
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 holeincorner
		</p>
	</td>
	<td>
		<p align="left">
			 8215e918ca3a77424dadac1aebc9a44b8f9840cd1389df0399a9fa4eb6329775
		</p>
	</td>
	<td>
		<p align="left">
			 dc3faa6840d1b5fd296d71ee8877254e
		</p>
	</td>
	<td>
		<p align="left">
			 53b767ff4fa5c5adc7041389ffd28bb4abda1434
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 Salzgitters.avi
		</p>
	</td>
	<td>
		<p align="left">
			 b8dc70b9ffe06c9ecaf0216ea7948fe718143db10641a23297652693ea026ab3
		</p>
	</td>
	<td>
		<p align="left">
			 e5e19040beabb0c0c68fdf4f3978a18b
		</p>
	</td>
	<td>
		<p align="left">
			 e68dc027aee851125960ee0559610f43fee581b0
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="left">
			 Schultes.wmv
		</p>
	</td>
	<td>
		<p align="left">
			 f4e710f515249e8c08ae76284bfb280070e1fd2308e9d9321d92163dfc73be66
		</p>
	</td>
	<td>
		<p align="left">
			 45f6f95918efbdcc2c97e3d905635f83
		</p>
	</td>
	<td>
		<p align="left">
			 9a1d8a68042b91ee17648606e43907354227d25f
		</p>
	</td>
</tr>
	</tbody></table>
</div><br/>


<h3>Network indicators:</h3>
<ul>
<li> api-help.com</li>
	<li>driver-updated.com</li>
	<li>sync-firewall.com</li>
	<li>system-logs.com</li>
	<li>technology-requests.net</li>
	<li>translate-news.net</li>
	<li>checklicensekey.com</li>
	<li>comparelicense.com</li>
<li>msupdatecheck.com</li>
<li>protocol-list.com</li>
</ul>

<h3>Payload filenames (from the configuration):</h3>
<ul>
<li>callicrates</li>
<li>tinh</li>
<li>amianthium</li>
<li>mandarinduck</li>
<li>cushioning</li>
<li>kingsclover</li>
</ul>

<h3 id="id10-2">Email addresses from which malicious emails were sent:</h3>
<ul>
<li><a href="mailto:ano.spectr@yandex.ru">ano.spectr@yandex.ru</a></li>
<li><a href="mailto:ancentr@lenta.ru">ancentr@lenta.ru</a></li>
</ul>


<br/>
<h2 id="id8">MITRE TTPs</h2>
<div class="table-container">
	<table class="table-article">
	<tbody>
<tr>
	<td>
		<p align="center">
			 <b>ID
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Name
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Description</b>
		</p>
	</td>
</tr>
</tbody><tbody>
<tr>
	<td colSpan="3">
		<p align="center">
			 <b>Resource Development</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1583
		</p>
	</td>
	<td>
		<p align="center">
			 Acquire Infrastructure
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group used servers to store remote templates, as well as cloud storage as a control server
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1585
		</p>
	</td>
	<td>
		<p align="center">
			 Establish Accounts
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group registered cloud service accounts and tempmail mailboxes
		</p>
	</td>
</tr>

<tr>
	<td colSpan="3">
		<p align="center">
			 <b>Initial Access</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1566.001
		</p>
	</td>
	<td>
		<p align="center">
			 Phishing: Spearphishing Attachment
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group sent phishing emails with malicious content
		</p>
	</td>
</tr>

<tr>
	<td colSpan="3">
		<p align="center">
			 <b>Execution</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1204.002
		</p>
	</td>
	<td>
		<p align="center">
			 User Execution: Malicious File
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group sent emails with malicious DOC and DOCX files
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1559.001
		</p>
	</td>
	<td>
		<p align="center">
			 Inter-Process Communication: Component Object Model
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used COM components in their tools
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1059.001
		</p>
	</td>
	<td>
		<p align="center">
			 Command and Scripting Interpreter: PowerShell
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used PowerShell scripts to load and run their components
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1059.005
		</p>
	</td>
	<td>
		<p align="center">
			 Command and Scripting Interpreter: Visual Basic
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used Visual Basic scripts to load and run their components
		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 T1203
		</p>
	</td>
	<td>
		<p align="center">
			 Exploitation for Client Execution
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used vulnerabilities in Microsoft Office components to launch their malicious components
		</p>
	</td>
</tr>


<tr>
	<td colSpan="3">
		<p align="center">
			 <b>Persistence</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1547.001
		</p>
	</td>
	<td>
		<p align="center">
			 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group used registry keys (autorun) for persistence
		</p>
	</td>
</tr>


<tr>
	<td colSpan="3">
		<p align="center">
			 <b>Defense Evasion</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1221
		</p>
	</td>
	<td>
		<p align="center">
			 Template Injection
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used a remote template injection technique to hide the malicious payload
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1140
		</p>
	</td>
	<td>
		<p align="center">
			 Deobfuscate/Decode Files or Information
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group encrypts its components to protect them from discovery and analysis
		</p>
	</td>
</tr>


<tr>
	<td colSpan="3">
		<p align="center">
			 <b>Collection</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1025
		</p>
	</td>
	<td>
		<p align="center">
			 Data from Removable Media
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group used tools to collect information from various remote devices
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1039
		</p>
	</td>
	<td>
		<p align="center">
			 Data from Network Shared Drive
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group used tools to collect information from various network devices
		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 T1005
		</p>
	</td>
	<td>
		<p align="center">
			 Data from Local System
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used tools to collect information from the file system
		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 T1560.002
		</p>
	</td>
	<td>
		<p align="center">
			 Archive Collected Data: Archive via Library
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group applies LZNT1 compression to collected data using the WinAPI library
		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 T1560.003
		</p>
	</td>
	<td>
		<p align="center">
			 Archive Collected Data: Archive via Custom Method
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used custom data encryption algorithms
		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 T1119
		</p>
	</td>
	<td>
		<p align="center">
			 Automated Collection
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used methods of automatic data collection from infected machines
		</p>
	</td>
</tr>

<tr>
	<td colSpan="3">
		<p align="center">
			 <b>Command and Control (C2)</b>
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1573.001
		</p>
	</td>
	<td>
		<p align="center">
			 Encrypted Channel: Symmetric Cryptography
		</p>
	</td>
	<td>
		<p>
			 The Cloud Atlas group used AES encryption to hide network communication
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1041
		</p>
	</td>
	<td>
		<p align="center">
			 Exfiltration Over C2 Channel
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used a C2 channel to transfer collected data
		</p>
	</td>
</tr>
<tr>
	<td>
		<p align="center">
			 T1102
		</p>
	</td>
	<td>
		<p align="center">
			 Web Service
		</p>
	</td>
	<td>
		<p>
			The Cloud Atlas group used the OpenDrive cloud service as a control server
		</p>
	</td>
</tr>
		</tbody>
	</table>
</div><br/>



<h2>General TTP countermeasures used by CloudAtlas</h2>
<h3>Basic protective measures</h3>

<div class="table-container">
	<table class="table-article">
	<tbody>
<tr>
	<td>
		<p align="center">
			 <b>D3FEND ID
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Name of technique D3FEND
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Description</b>
		</p>
	</td>
</tr>
</tbody><tbody>
	<tr><td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:SystemVulnerabilityAssessment/">D3-SYSVA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 System Vulnerability Assessment
		</p>
	</td>
	<td>
		<p>
			Since CloudAtlas exploits vulnerabilities, it is necessary to monitor the vulnerability of systems in the infrastructure and update vulnerable software in a timely manner
		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:SoftwareUpdate/">D3-SU</a>
		</p>
	</td>
	<td>
		<p align="center">
			 Software Update
		</p>
	</td>
	<td>
		<p>
			Since CloudAtlas exploits vulnerabilities, it is necessary to monitor the vulnerability of systems in the infrastructure and update vulnerable software in a timely manner
			</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering/">D3-OTF</a>
		</p>
	</td>
	<td>
		<p align="center">
			 Outbound Traffic Filtering
		</p>
	</td>
	<td>
		<p>
			Restrict network traffic to untrusted servers from IOC lists
			</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:DNSDenylisting/">D3-DNSDL</a>
		</p>
	</td>
	<td>
		<p align="center">
			 DNS Denylisting
		</p>
	</td>
	<td>
		<p>
			Block resolution of DNS names from IOC lists
			</p>
	</td>
</tr>


</tbody>
	</table>
</div><br/>

<h3>Additional protective measures</h3>

<div class="table-container">
	<table class="table-article">
	<tbody>
<tr>
	<td>
		<p align="center">
			 <b>D3FEND ID
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Name of technique D3FEND
		</b></p><b>
	</b></td><td><b>
		</b><p align="center"><b>
			 Description</b>
		</p>
	</td>
</tr>
</tbody><tbody>
	<tr><td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:SenderReputationAnalysis/">D3-SRA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 Sender Reputation Analysis
		</p>
	</td>
	<td>
		<p>
			CloudAtlas group uses free email services, so as an additional measure of protection against phishing, you can specially mark emails from external free services to attract additional attention of the user
		</p>
	</td>
</tr>

<tr>
	<td>
		<p align="center">
			 <a href="https://d3fend.mitre.org/technique/d3f:UserDataTransferAnalysis/">D3-UDTA</a>
		</p>
	</td>
	<td>
		<p align="center">
			 User Data Transfer Analysis
		</p>
	</td>
	<td>
		<p>
			CloudAtlas grouping downloads data through compromised workstations, so you can use profiling of the amount of data transferred to the Internet by the user to detect anomalies in the case of massive data exfiltration
			</p>
	</td>
</tr>

</tbody>
	</table>
</div><br/>




 </article></div></div><div class="ArticleLayout_rightColumn__c8u4z"><div class="ShareBlock_container__5nb7z"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>Share this article</span><span>:</span></div><div class="ShareBlock_icons__vIJLT"><button type="button" class="Social_icon__pVcgR"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"><path stroke="currentColor" d="M8.39 10.805a4.024 4.024 0 0 0 4.628 1.36 4.023 4.023 0 0 0 1.44-.925l2.413-2.416A4.029 4.029 0 0 0 14.012 2a4.02 4.02 0 0 0-2.83 1.13L9.8 4.507m1.81 4.688a4.024 4.024 0 0 0-4.627-1.36 4.022 4.022 0 0 0-1.44.925L3.13 11.176A4.029 4.029 0 0 0 5.988 18a4.02 4.02 0 0 0 2.83-1.13l1.375-1.377"></path></svg></button></div></div></div></div></div><div class="ArticleLayout_grid__ARjhp"><div class="ArticleLayout_rightColumns___55GM"><div class="ArticleLayout_rightColumn__c8u4z"></div></div></div></div></section><section class="PageSection_section__GxaaG Card_section__QzdVO" id="contacts"><div class="Card_contentWrapper__45uLa Card_mode_light__02f7V Card_zIndex_1__NP_2j AnyQuestions_container__KVhzR"><div class="AnyQuestions_heading__pSibU"><h1 class="AnyQuestions_title__ScrF1 Heading_base__MUnbH Heading_level_1__oOibP Heading_theme_light__level_1__7KeY7"><span>Get in touch</span></h1><div class="Text_base__riB2c Text_type_pL__A_h0d Text_theme_light__type_pL___Cab8"><span>Fill in the form and our specialists<br> will contact you shortly</span></div></div><div class="AnyQuestions_content__rdK_e"><div class="CardsSlider_root__4cbz_ AnyQuestions_radioGroupWrapper__WrSuy"><div class="CardsSlider_scrollArea__LArfW AnyQuestions_radioGroup__DBJB4"><label style="--cards-count:3" data-testid="form-tab-feedback" class="CardRadio_mode_light__Fnmg8 CardRadio_container__9oMVF CardRadio_checked__7uYOJ AnyQuestions_cardLayout__p5bqj"><input name="type" type="radio" checked="" value="feedback"/><div class="CardRadio_title__SlAzv Text_base__riB2c Text_type_postscript__I0CC_ Text_theme_light__type_postscript__JvgMb"><span>General<br> questions</span></div><div class="CardRadio_description__rzM_f Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>We're happy to answer any questions you may have.</span></div></label><label style="--cards-count:3" data-testid="form-tab-partnership" class="CardRadio_mode_light__Fnmg8 CardRadio_container__9oMVF AnyQuestions_cardLayout__p5bqj"><input name="type" type="radio" value="partnership"/><div class="CardRadio_title__SlAzv Text_base__riB2c Text_type_postscript__I0CC_ Text_theme_light__type_postscript__JvgMb"><span>Partnership</span></div><div class="CardRadio_description__rzM_f Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>Join us in making the world a safer place.</span></div></label><label style="--cards-count:3" data-testid="form-tab-pilotApplication" class="CardRadio_mode_light__Fnmg8 CardRadio_container__9oMVF AnyQuestions_cardLayout__p5bqj"><input name="type" type="radio" value="pilotApplication"/><div class="CardRadio_title__SlAzv Text_base__riB2c Text_type_postscript__I0CC_ Text_theme_light__type_postscript__JvgMb"><span>Request a pilot</span></div><div class="CardRadio_description__rzM_f Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>Test drive our solutions with a customized pilot program.</span></div></label></div></div><form><div class="FeedbackForm_fields__NxBGh"><div class="FeedbackForm_field__GSf0c FeedbackForm_fullWidth__SPrCb"><label class="Input_container__CtV41 Input_mode_light__DDarT"><input class="Input_input__dAKAo" placeholder="Name" type="text" autoComplete="name" maxLength="250" name="fullName" value=""/></label></div><div class="FeedbackForm_field__GSf0c"><label class="Input_container__CtV41 Input_mode_light__DDarT"><input class="Input_input__dAKAo" placeholder="Phone number" type="text" autoComplete="tel" maxLength="20" name="phone" value=""/></label></div><div class="FeedbackForm_field__GSf0c"><label class="Input_container__CtV41 Input_mode_light__DDarT"><input class="Input_input__dAKAo" placeholder="Email" type="text" autoComplete="email" maxLength="250" name="email" value=""/></label></div><div class="FeedbackForm_field__GSf0c FeedbackForm_fullWidth__SPrCb"><div class="Autocomplete_root__of0uL Select_root__qV3jk Select_mode_light__6i67a"><div class="Select_select__Wgg4m"><div class="SearchField_container__r8UBy"><input placeholder="Country" class="Input_input__dAKAo SearchField_input__OhP5T" id="headlessui-combobox-input-:R1d8qkf6:" role="combobox" type="text" aria-expanded="false" aria-autocomplete="list" data-headlessui-state=""/><button class="SearchField_icon__n277G SearchField_icon_second__tgr0q SearchField_icon_action__K_KOk" id="headlessui-combobox-button-:R2d8qkf6:" type="button" tabindex="-1" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""></button><button class="SearchField_icon__n277G SearchField_icon_grey__v_ngf" id="headlessui-combobox-button-:R3d8qkf6:" type="button" tabindex="-1" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.7645 11.4123C12.0858 10.3117 12.9268 8.65406 12.9268 6.79999C12.9268 3.48628 10.2405 0.799988 6.92676 0.799988C3.61305 0.799988 0.926758 3.48628 0.926758 6.79999C0.926758 10.1137 3.61305 12.8 6.92676 12.8C8.3864 12.8 9.7243 12.2788 10.7645 11.4123ZM10.7645 11.4123L14.5522 15.2" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div></div><div class="FeedbackForm_field__GSf0c FeedbackForm_fullWidth__SPrCb"><label class="Textarea_container__HPtza Textarea_mode_light__E0Y92"><textarea id="comment" class="Textarea_textarea__MapxB" placeholder="How can we help?" maxLength="1000" name="comment"></textarea></label></div></div><div class="FeedbackForm_agrees__062n_"><label class="InputCheckbox_mode_light__1Ed_W"><input class="InputCheckbox_input__x9X51" type="checkbox" name="consentsTerms" value="false"/><div class="InputCheckbox_checkboxLabel__hXRgu Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>I give <a data-sanitize-target="_blank" href="https://global.ptsecurity.com/policies/consent" target="_blank">my&nbsp;consent to&nbsp;the processing of&nbsp;my&nbsp;personal data</a> in&nbsp;accordance with the terms of&nbsp;the <a data-sanitize-target="_blank" href="https://global.ptsecurity.com/policies/privacy-policy" target="_blank">Privacy Notice</a></span></div></label><label class="InputCheckbox_mode_light__1Ed_W"><input class="InputCheckbox_input__x9X51" type="checkbox" name="subscription" value="false"/><div class="InputCheckbox_checkboxLabel__hXRgu Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>I&nbsp;give <a data-sanitize-target="_blank" href="https://global.ptsecurity.com/policies/consent-email" target="_blank">my&nbsp;consent to&nbsp;receive marketing and&nbsp;informational messages</a></span></div></label></div><div><div class="smart-captcha"></div><button type="submit" class="Button_button__F7Ulc Button_button_size_m__cmMD_ Button_button_theme_light__W9pGX"><span><span>SEND</span></span><img alt="" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="Button_arrow__ZXQXI" style="color:transparent" src="/_next/static/media/arrows-right.1fc87099.svg"/></button></div></form></div></div></section><footer class="Footer_wrapper__igPy4"><div class="Footer_info__BLmy7"><div class="Footer_head__3m28S"><div class="Footer_copyright__JcWnj Text_base__riB2c Text_type_pM__mE14b"><span>Copyright <mark>©</mark> 2002–2025 Positive Technologies. All rights reserved.</span></div><h2 class="Footer_heading__mQ6QG Heading_base__MUnbH Heading_level_2__qXMBH"><span>Cybersecurity market leader</span></h2><div class="Footer_additionalLinks__KyguX"><a class="Footer_additionalLink__5ONRT" target="_blank" href="https://global.ptsecurity.com/policies/terms-of-use">Legal documents</a><a class="Footer_additionalLink__5ONRT" href="https://www.ptsecurity.com/choose-region/?return_url=/analytics/pt-esc-threat-intelligence/apt-cloud-atlas-unbroken-threat">Change region</a></div></div><nav class="Footer_nav__LBYFW"><div class="Footer_nav_col__lYnPU"><div class="NavBlock_title__7sNY5 Text_base__riB2c Text_type_pL__A_h0d"><span>Products</span></div><a class="NavBlock_list_item__wGeXz" href="/products/network-attack-discovery"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT NAD</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/ngfw"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT NGFW</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/sandbox"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Sandbox</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/maxpatrol-vm"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol VM</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/siem"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol SIEM</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/ai"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Application Inspector</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/blackbox"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT BlackBox</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/isim"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT ISIM</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/mp-o2"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol O2</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/edr"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol EDR</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/pt-af"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Application Firewall</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/cs"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Container Security</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/ics"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Industrial Cybersecurity Suite</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/threat-intelligence-feeds"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Threat Intelligence Feeds</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/knockin"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Knockin</span></div></a></div><div class="Footer_nav_col__lYnPU"><div class="NavBlock_title__7sNY5 Text_base__riB2c Text_type_pL__A_h0d"><span>ANALYTICS</span></div><a class="NavBlock_list_item__wGeXz" href="/analytics"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Analytics articles</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/knowledge-base"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Knowledge base</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/pt-esc-threat-intelligence"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT ESC threat intelligence</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/threatscape"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Threatscape</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/hacker-groups"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Hacker groups</span></div></a></div><div class="Footer_nav_col__lYnPU"><div class="NavBlock_title__7sNY5 Text_base__riB2c Text_type_pL__A_h0d"><span>COMPANY</span></div><a class="NavBlock_list_item__wGeXz" href="/about"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>About us</span></div></a><a class="NavBlock_list_item__wGeXz" href="/about/clients"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Clients</span></div></a><a class="NavBlock_list_item__wGeXz" href="/about/contacts"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Contacts</span></div></a><a class="NavBlock_list_item__wGeXz" href="/about/pt-in-the-media"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT in the Media</span></div></a><a href="https://edu.ptsecurity.com/learning-space" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Education</span></div></a><a href="https://www.youtube.com/channel/UC9hnMfdwfLd8V5qEc-6MXXQ" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>YouTube</span></div></a><a href="https://www.linkedin.com/company/positivetechnologies/" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>LinkedIn</span></div></a><a href="https://x.com/PTsecurity_EN" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Х</span></div></a><a href="https://www.tiktok.com/@positivetechnologies" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>TikTok</span></div></a><a href="https://vacancy.global.ptsecurity.com/" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Vacancy</span></div></a></div></nav></div><div><img alt="" loading="lazy" width="1200" height="100" decoding="async" data-nimg="1" class="Footer_logo__cDBuS" style="color:transparent" src="https://pt-global.storage.yandexcloud.net/logo_1d137588e3.svg"/></div></footer></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"seo":{"title":"APT Cloud Atlas: Unbroken Threat","description":"Specialists at the PT Expert Security Center have been monitoring the Cloud Atlas group since May 2019.\nThe goals of the group are espionage and theft of confidential information.\nThe group typically uses phishing emails with malicious attachments as the initial vector for their attacks.\nIn the third quarter of 2022, during our investigation we identified a phishing campaign targeting employees of Russian government agencies. \nThe attackers used targeted mailing based on the professional field of the recipients, even though we found no publicly available information about them.\nWe first knew about the attackers back in 2014, when Kaspersky researchers published a report.\nSince then, their tools have not changed much \u0026#40;you can find more about them in the \u0026quot;Malware analysis\u0026quot; section\u0026#41;.\nHowever, there has not yet been a detailed analysis and description of the functionality of these tools.\nIn this report, we\u0026#39;ll discuss the main techniques of the Cloud Atlas group, and take an in-depth look at the tools they use."},"headerData":{"logoImage":{"src":"https://pt-global.storage.yandexcloud.net/logo_header_1bd424ccc4.svg","width":249,"height":22,"alt":""},"nav":[{"type":"product-menu","data":{"title":"Products","button":{"link":"/products","text":"Jump to section","targetBlank":false},"items":[{"description":"NDR system for detecting hidden threats on the perimeter and inside the network","link":"/products/network-attack-discovery","title":"PT NAD"},{"description":"Expert in excellent performance","link":"/products/ngfw","title":"PT NGFW"},{"description":"Advanced sandbox with customizable virtual environments","link":"/products/sandbox","title":"PT Sandbox"},{"description":"Next-generation vulnerability management system","link":"/products/maxpatrol-vm","title":"MaxPatrol VM"},{"description":"Pinpoint threat detection solution for your infrastructure","link":"/products/siem","title":"MaxPatrol SIEM"},{"description":"Source-code analysis tool","link":"/products/ai","title":"PT Application Inspector"},{"description":"Dynamic application security testing tool","link":"/products/blackbox","title":"PT BlackBox"},{"description":"Cyberthreat detection and incident response in ICS","link":"/products/isim","title":"PT ISIM"},{"description":"Autopilot for result-driven cybersecurity","link":"/products/mp-o2/","title":"MaxPatrol O2"},{"description":"Protects your endpoints","link":"/products/edr","title":"MaxPatrol EDR"},{"description":"A web application firewall","link":"/products/pt-af","title":"PT Application Firewall"},{"description":"Innovative solution for the comprehensive protection","link":"/products/cs","title":"PT Container Security"},{"description":"The first comprehensive platform for cyberthreat detection and response in industrial systems","link":"/products/ics","title":"PT Industrial Cybersecurity Suite"},{"description":"Data feeds collected by Positive Technologies experts for threat detection","link":"/products/threat-intelligence-feeds","title":"PT Threat Intelligence Feeds"},{"description":"Check your email security in 2 minutes","link":"/products/knockin","title":"PT Knockin"}]}},{"type":"product-menu","data":{"title":"Services","button":{"link":"/services","text":"Jump to section","targetBlank":false},"items":[{"description":"","link":"/services/esc","title":"ESC"}]}},{"type":"product-menu","data":{"title":"Education","button":null,"items":[{"description":"","link":"https://edu.ptsecurity.com/learning-space","title":"Positive Education Cybersecurity Academy"},{"description":"","link":"https://edu.ptsecurity.com/pros-programs","title":"Cybersecurity programs for Professionals"},{"description":"","link":"https://edu.ptsecurity.com/c-level-programs","title":"Cybersecurity programs for Executives"},{"description":"","link":"https://edu.ptsecurity.com/product-courses","title":"Product courses"}]}},{"type":"link","data":{"link":"/about/news/","title":"News \u0026 events"}},{"type":"product-menu","data":{"title":"Analytics","button":{"link":"/analytics","text":"Jump to section","targetBlank":false},"items":[{"description":"","link":"/analytics/knowledge-base","title":"Knowledge base"},{"description":"","link":"/analytics/pt-esc-threat-intelligence","title":"PT ESC threat intelligence"},{"description":"","link":"/analytics/threatscape","title":"Threatscape"},{"description":"","link":"/analytics/hacker-groups","title":"Hacker groups"}]}},{"type":"product-menu","data":{"title":"About us","button":{"link":"/about","text":"Jump to section","targetBlank":false},"items":[{"description":"","link":"/about/clients","title":"Clients"},{"description":"","link":"/about/contacts","title":"Contacts"},{"description":"","link":"/about/pt-in-the-media","title":"PT in the Media"},{"description":"","link":"https://vacancy.global.ptsecurity.com/","title":"Vacancy"}]}}],"searchInputPlaceholder":"Search on ptsecurity.com"},"articleData":{"content":[],"deprecatedDetailText":"\u003carticle\u003e\r\n\u003ch2\u003eIntroduction\u003c/h2\u003e\r\n\u003cp\u003e\r\n\t Specialists at the PT Expert Security Center have been monitoring the Cloud Atlas group since May 2019. According to our data, its attacks have been targeting the government sector of the following countries:\r\n\u003c/p\u003e\r\n\u003cul\u003e\r\n\t\u003cli\u003eRussia\u003c/li\u003e\r\n\t\u003cli\u003eBelarus\u003c/li\u003e\r\n\t\u003cli\u003eAzerbaijan\u003c/li\u003e\r\n\t\u003cli\u003eTurkey\u003c/li\u003e\r\n\t\u003cli\u003eSlovenia\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e\r\n\t The goals of the group are espionage and theft of confidential information.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t The group typically uses phishing emails with malicious attachments as the initial vector for their attacks.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t In the third quarter of 2022, during our investigation we identified a phishing campaign targeting employees of Russian government agencies. The attackers used targeted mailing based on the professional field of the recipients, even though we found no publicly available information about them.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t We first knew about the attackers back in 2014, when Kaspersky researchers published a \u003ca href=\"https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/\"\u003ereport\u003c/a\u003e. Since then, their tools have not changed much (you can find more about them in the \"Malware analysis\" section). However, there has not yet been a detailed analysis and description of the functionality of these tools.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t In this report, we'll discuss the main techniques of the Cloud Atlas group, and take an in-depth look at the tools they use.\r\n\u003c/p\u003e\r\n\u003ch2\u003eAnalysis of the documents found\u003c/h2\u003e\r\n\u003cp\u003e\r\n\t As in previous years, the group begins its attack by sending phishing emails, using current geopolitical issues that are directly related to the target country as a bait text. An example of an email with malicious content that was sent as part of the campaign in 2022 is shown in Figure 1. Pay special attention to the sender's address: the attackers disguised themselves as the news portal \u003ca href=\"https://lenta.ru\"\u003eLenta.ru\u003c/a\u003e, well-known in Russia and the CIS. However, email addresses with such a domain can be created with Rambler (Figure 2).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The email\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/1.png\"\u003e \u003cfigcaption\u003eFigure 1. The email\u003c/figcaption\u003e \u003c/figure\u003e \u003cfigure\u003e \u003cimg alt=\"A registration window with the @lenta.ru domain name\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/2.png\"\u003e \u003cfigcaption\u003eFigure 2. A registration window with the @lenta.ru domain name\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Most often, the text is taken from the media or from publicly available official documents. Also, for example, in a 2019 attack aimed at Azerbaijan, a text related to the \"Indestructible Brotherhood 2019\" training exercises in Tajikistan was used, while in the 2020 attacks on organizations in Belarus, the emails contained a text related to the presidential elections.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t Figure 3 shows an example of a document which downloads a malicious template (here is a \u003ca href=\"https://news.ru/near-east/pochemu-islamskij-mir-ne-daet-zapadu-izolirovat-rossiyu/\"\u003elink\u003c/a\u003e to the page with the document's contents).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The malicious document\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/3.png\"\u003e \u003cfigcaption\u003eFigure 3. The malicious document\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t In all cases, the malicious attachment was a document (in either DOC or DOCX format) that implements a Template Injection attack. In such attacks, the document does not contain macros or any other malicious code, and, in most of the observed cases when the DOC format was used, it may not be flagged by static analysis tools such as antiviruses (see Figure 4).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The document with a link to the template is not detected as malicious\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/4.png\"\u003e \u003cfigcaption\u003eFigure 4. The document with a link to the template is not detected as malicious\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The document contains only a link to the template, which is located on a remote server. When the document is opened, the template is automatically downloaded from the remote server.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"An example of a template link in Cloud Atlas documents\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/5.png\"\u003e \u003cfigcaption\u003eFigure 5. An example of a template link in Cloud Atlas documents\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t It's the template that may be malicious, containing a macro or exploit. This download method is a legitimate function of Microsoft Office, but attackers can take advantage of it. For example, the same technique is used by the Gamaredon group in their attacks.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t In most cases of a successful connection, an empty document was returned in response. However, in some attacks, we managed to detect the download of a malicious template in the form of an RTF file containing an exploit for the \u003ca href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2017-11882\"\u003eCVE-2017-11882\u003c/a\u003e vulnerability.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t Researchers at Palo Alto \u003ca href=\"https://unit42.paloaltonetworks.com/unit42-inception-attackers-target-europe-year-old-office-vulnerability/\"\u003ediscovered\u003c/a\u003e a similar malware delivery chain in 2018. In these attacks, the downloaded RTF templates contained an exploit for the CVE-2017-11882 vulnerability, as well as a simple PowerShell backdoor, which was dubbed PowerShower.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t We paid special attention to the \u003ca href=\"https://interoperability.blob.core.windows.net/files/MS-DOC/%5bMS-DOC%5d.pdf\"\u003eDOC\u003c/a\u003e documents used in this attack: a characteristic feature of all the documents containing a malicious download was a link to malicious content inside the 1Table or 0Table stream (Figure 9, highlighted in green).\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t After studying the DOC format and comparing malicious documents with regular ones, we found a number of patterns in the infected files.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t First, the DOC format requires the 1Table or 0Table stream in any document, along with the mandatory WordDocument stream (Figure 6).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"DOC format content\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/6.png\"\u003e \u003cfigcaption\u003eFigure 6. DOC format content\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Second, each document contains a special FIB (File Information Block) structure—in Figure 7, the fragment is highlighted in yellow—in which there is a base.fWhichTblStm parameter. Setting this bit to 0 or 1 determines which of the given streams should be used in the document.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"An FIB fragment in a document\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/7.png\"\u003e \u003cfigcaption\u003eFigure 7. An FIB fragment in a document\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Figure 8 shows the structure of an FIB taken from the documentation. Particular attention should be paid to the structure highlighted in red. The G bit interests us here the most (highlighted in green). This is the base.fWhichTblStm parameter.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"A fragment of an FIB structure\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/8.png\"\u003e \u003cfigcaption\u003eFigure 8. A fragment of an FIB structure\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Finally, the last thing that we discovered: links to malicious templates are always located at approximately the same offsets relative to the hex strings in the Table stream. (We were not much interested in the format of the stream itself yet.) In Figure 9, the strings of bytes are shown in yellow and red. Using these, we calculated various malicious template link offsets. This allowed us to quite effectively detect the use of this technique in a specific implementation.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"A malicious link inside a Table stream\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/9.png\"\u003e \u003cfigcaption\u003eFigure 9. A malicious link inside a Table stream\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003ch2\u003eAttack chain analysis\u003c/h2\u003e\r\n\u003cp\u003e\r\n\t In the course of our research, we identified several attack chains (Figure 10), which differed in the number of stages required to load the main functionality, as well as the tools used at each stage. Nevertheless, the use of these chains is not new for this group.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Flow chart of the identified attack chains\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/10.png\"\u003e \u003cfigcaption\u003eFigure 10. Flow chart of the identified attack chains\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The first thing we noticed was a remote template downloading an RTF document with an exploit, which in turn downloads and launches an HTA file. An example of the contents is shown in Figure 11.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The contents of the HTA file\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/11.png\"\u003e \u003cfigcaption\u003eFigure 11. The contents of the HTA file\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t An examination of the document and its contents revealed that a vulnerability in Equation Editor was used to launch the exploit payload. The shellcode (highlighted in red in Figure 12) is located inside one of the document's objects and is executed in the context of the EQNEDT32.EXE process.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The encrypted shellcode\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/12.png\"\u003e \u003cfigcaption\u003eFigure 12. The encrypted shellcode\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The bulk of the shellcode is stored in encrypted form and decrypted after control is transferred to it.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t Figure 13 shows the decrypted shellcode, with the first 13 bytes responsible for decrypting the main part of the shellcode (the loop statement is decrypted at the first iteration). For decryption, XOR is used with a two-byte key embedded in the code.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The decrypted shellcode\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/13.png\"\u003e \u003cfigcaption\u003eFigure 13. The decrypted shellcode\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The direct link to the HTA file (through which the loading is performed) is stored in the body of the shellcode (Figure 14) and is additionally XOR-encrypted with the one-byte value of 0x12.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The link to the malicious HTA file\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/14.png\"\u003e \u003cfigcaption\u003eFigure 14. The link to the malicious HTA file\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t As seen in Figure 11, the HTA file is designed to create on the disk the VBS scripts with the payload for subsequent stages, as well as an LNK file with the main payload containing the code for loading binary modules. Thus, the main task of the VBS macros (in our case, both macros had similar names: unbroken.vbs and unbroken.vbs.vbs) is to deobfuscate the contents of the LNK file (shown in Figure 15) and transfer control to it, after which the payload which was downloaded by the LNK file code is launched (we will discuss this in the \"Malware analysis\" section).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The LNK file\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/15.png\"\u003e \u003cfigcaption\u003eFigure 15. The LNK file\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t It is also worth noting that malicious documents which exploit the same vulnerabilities in Equation Editor and contain identical object names (for example, \"weaseoijsd\",highlighted in red in Figure 16) in RTF documents \u003ca href=\"https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html\"\u003ewere analyzed\u003c/a\u003e by Cisco Talos Intelligence specialists and attributed to the Bitter APT group.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The object name in the RTF file\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/16.png\"\u003e \u003cfigcaption\u003eFigure 16. The object name in the RTF file\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The second chain that we found is downloading malicious PowerShell scripts via remote templates (Figure 17), which in turn download malicious components (mostly Base64-encoded).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The script that loads the payload\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/17.png\"\u003e \u003cfigcaption\u003eFigure 17. The script that loads the payload\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t We also encountered cases of an intermediate .NET loader that downloaded a payload from a remote server and transferred control to it.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t This .NET loader is decoded from Base64 and launched by a PowerShell script (Figure 18).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The script for decoding and launching the necessary export\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/18.png\"\u003e \u003cfigcaption\u003eFigure 18. The script for decoding and launching the necessary export\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The export (Figure 19), activated from the loader, takes all the necessary parameters for network communication, including the connection encryption key (highlighted in yellow in Figure 18).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The export activated from the loader\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/19.png\"\u003e \u003cfigcaption\u003eFigure 19. The export activated from the loader\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The communication is encrypted with a simple XOR operation with the transferred key (Figure 20).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The encryption of the communication inside the loader\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/20.png\"\u003e \u003cfigcaption\u003eFigure 20. The encryption of the communication inside the loader\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003ch2\u003eMalware analysis\u003c/h2\u003e\r\n\u003ch3\u003eInitial module\u003c/h3\u003e\r\n\u003cp\u003e\r\n\t The main task of the initial stage is to decrypt the loader of the main functionality and transfer control to it. We should mention that all such samples that we discovered are quite large and also obfuscated. The loader, in turn, is stored exclusively in the process memory and is not present on the disk at all. The loader is decrypted in parts, via single-byte XOR with different keys (Figure 21). It is also striking that the decryption code is \"diluted\" with various operations. This is obviously to make searching for and identifying data decryption procedures more complicated.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Partial decryption of the loader\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/21.png\"\u003e \u003cfigcaption\u003eFigure 21. Partial decryption of the loader\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t We also noted that almost all of the functions that decrypt the loader contain a large amount of polymorphic code. This performs various operations with strings located inside the image, stack strings, as well as with their individual elements (Figure 22 shows an example). However, these operations do not have any effect on the decrypted data itself. They are used to calculate various variables and constants that affect the decryption parameters (data size, offsets, and so on), as well as to complicate the analysis process. The decrypted data is copied to a pre-allocated memory area as a valid PE image, after which control is transferred to it.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"An example of polymorphic code\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/22.png\"\u003e \u003cfigcaption\u003eFigure 22. An example of polymorphic code\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003ch3\u003eMain loader\u003c/h3\u003e\r\n\u003cp\u003e\r\n\t The loader, in turn, is responsible for reading the data from the file containing the main payload, as well as for its decryption and unpacking.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t First, the loader decrypts the configuration located in its body. The decryption algorithm (Figure 23) is single-byte XOR with an embedded key. After decryption, the configuration is validated.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t We noted that the configuration has not changed since previous studies—it contains the same data and parameters (Figure 23).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Decrypting the loader configuration\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/23.png\"\u003e \u003cfigcaption\u003eFigure 23. Decrypting the loader configuration\u003c/figcaption\u003e \u003c/figure\u003e \u003cfigure\u003e \u003cimg alt=\"The loader configuration\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/24.png\"\u003e \u003cfigcaption\u003eFigure 24. The loader configuration\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Next, the loader reads the file created at the initial stage of the installation, after which it decrypts and unpacks the data contained in it.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t It's at this stage where the first differences from earlier samples appear: to hide the payload, AES in CBC mode is used, after which the data is unpacked by LZNT1 (it used to be LZMA).\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t The unpacking algorithm is rather interesting: the data is unpacked not as a single byte array, but by chunks of various sizes. Figure 25 shows the addition of the header_start_chunk offset to the zero offset of each chunk (for the first of them, an additional offset of 4), after which the unpacking function is activated.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t Thus, the structure of the first chunk in the decrypted load can be represented as follows:\r\n\u003c/p\u003e\r\n \u003cpre\u003e    \u003cdiv class=\"code\"\u003e\r\nstruct first_comprChunk\r\n{\r\nDWORD signature;\r\nWORD sizeOfCurrChunk; // in fact compressed buffer size\r\nBYTE data[sizeOfCurrChunk]; //compressed data\r\n};\r\n    \u003c/div\u003e\r\n\u003c/pre\u003e\r\n\u003cp\u003e\r\n\t Correspondingly, the remaining chunks do not have the first DWORD field and have the following structure:\r\n\u003c/p\u003e\r\n \u003cpre\u003e    \u003cdiv class=\"code\"\u003e\r\nstruct comprChunk\r\n{\r\nWORD compressedBuffSize;\r\nBYTE data[sizeOfCurrChunk];\r\n};\r\n    \u003c/div\u003e\r\n\u003c/pre\u003e\r\n\u003cp\u003e\r\n\t Each chunk is unpacked independently of the others, without any padding, strictly according to the offsets from its headers.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Unpacking the decrypted data\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/25.png\"\u003e \u003cfigcaption\u003eFigure 25. Unpacking the decrypted data\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The final stage of the loader involves loading the unpacked data as a valid PE image, searching for the required export by the ordinal name, and transferring control to it (Figure 26).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Overview of the loader functionality\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/26.png\"\u003e \u003cfigcaption\u003eFigure 26. Overview of the loader functionality\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003ch3\u003ePayload\u003c/h3\u003e\r\n\u003cp\u003e\r\n\t The data received at the loader stage is the payload of the malware. Its main functionality is to initialize the connection to the control server and load various modules from it.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t Curiously enough, the payload module also has a configuration inside which is identical to the one in the loader, but in this case it is AES-encrypted and gets decrypted after control is transferred to the main module.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t Next, the malware generates a communication packet that is sent to the server to establish a connection. This packet contains information about the infected machine and is most likely designed to identify targets that are of interest for attackers.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t The structure of the packet is shown below (Figure 27).\r\n\u003c/p\u003e\r\n \u003cpre\u003e    \u003cdiv class=\"code\"\u003e\r\nstruct Message\r\n{\r\nDWORD lenOfPacket;\r\nDWORD sizeOf_OSVERSIONINFO;\r\nBYTE data_OSVERSIONINFO[sizeOf_OSVERSIONINFO - 4];\r\nDWORD volumeInformation;\r\nBYTE timestamp[16]; // GetLocalTime\r\nWORD GetUserDefaultLCID;\r\nWORD GetSystemDefaultLCID;\r\nDWORD len_of_1_field;\r\nDWORD len_of_2_field;\r\nDWORD len_of_3_field;\r\nDWORD len_of_4_field;\r\nchar username; //1_field\r\nchar PcName; //2_field\r\nchar executePath; //3_field\r\nchar applicationName; //4_field\r\nchar argvParam;\r\nDWORD lenOf_curr currFileSystem;\r\nchar currFileSystem[lenOf_curr currFileSystem];\r\n};\u003c/div\u003e\r\n\u003c/pre\u003e \u003cfigure\u003e \u003cimg alt=\"An example of a generated packet\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/27.png\"\u003e \u003cfigcaption\u003eFigure 27. An example of a generated packet\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The malware sends the generated packet to the control server, using the CLSID_IServerXMLHTTPRequest2 COM object for communication (Figure 28).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The object initialization code\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/28.png\"\u003e \u003cfigcaption\u003eFigure 28. The object initialization code\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The restored table of this object's virtual methods can be described by the following structure:\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\u003c/p\u003e\r\n \u003cpre\u003e    \u003cdiv class=\"code\"\u003e\r\nstruct IServerXmlHttpRequest2Vtbl\r\n{\r\nint QueryInterface;\r\nint AddRef;\r\nint Release;\r\nint GetTypeInfoCount;\r\nint GetTypeInfo;\r\nint GetIDsOfNames;\r\nint Invoke;\r\nint open;\r\nint setRequestHeader;\r\nint getResponseHeader;\r\nint getAllResponseHeaders;\r\nint send;\r\nint abort;\r\nint get_status;\r\nint get_statusText;\r\nint get_responseXML;\r\nint get_responseText;\r\nint get_responseBody;\r\nint get_responseStream;\r\nint get_readyState;\r\nint put_onreadystatechange;\r\nint setTimeouts;\r\nint waitForResponse;\r\nint getOption;\r\nint setOption;\r\nint setProxy;\r\nint setProxyCredentials;\r\n};\r\n    \u003c/div\u003e\r\n\u003c/pre\u003e\r\n\u003cp\u003e\r\n\t It should be noted that the protocol for communicating between the malware and the server supports five types of requests (Figure 29), each of which is used at a certain stage of communication.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Types of requests from the malware to the control server\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/29.png\"\u003e \u003cfigcaption\u003eFigure 29. Types of requests from the malware to the control server\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t For example, after a PROPFIND request that installs the directory contents on the remote server, a GET request is made to load the module contained on the control server. Curiously, if the loading is successful, this module is deleted (Figure 30).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"A fragment of the communication with the control server\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/30.png\"\u003e \u003cfigcaption\u003eFigure 30. A fragment of the communication with the control server\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t If the communication is successful, binary data is loaded (Figure 31) containing a specific module in obfuscated form.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Loading a module from the server\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/31.png\"\u003e \u003cfigcaption\u003eFigure 31. Loading a module from the server\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The same procedures are used for obfuscating the data as for extracting the payload with the loader: AES-CBC encryption and LZNT1 compression.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t The functions responsible for the payload extraction procedure, as well as the encryption keys and initialization vectors used to encrypt the communication, are identical to those used to extract the payload in the loader.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t In the course of our research, we managed to obtain a sample that the malware downloads from the control server (examples of the server contents are shown in Figures 32 and 33).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The directories on the remote server\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/32.png\"\u003e \u003cfigcaption\u003eFigure 32. The directories on the remote server\u003c/figcaption\u003e \u003c/figure\u003e \u003cfigure\u003e \u003cimg alt=\"The file containing the module on the server\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/33.png\"\u003e \u003cfigcaption\u003eFigure 33. The file containing the module on the server\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The loaded module is decrypted and unpacked (Figure 34), and placed in the memory as a PE image, just as in the case of the loader. It's also worth noting that the ordinal name (which is used to search for the export to call) is identical to the one used to transfer control to the payload.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"A fragment of decrypted and unpacked data\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/34.png\"\u003e \u003cfigcaption\u003eFigure 34. A fragment of decrypted and unpacked data\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The decrypted payload is an executable module, which is preceded by a configuration. Based on the content of the configuration, the main functionality of the loaded module becomes clear: to steal files from an infected computer according to certain parameters.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t In particular, attackers are interested in files with these extensions: *.doc, *.docx, *.xls, *.xlsx, *.pdf, *.rtf, *.contact, *.odt, *.jpg, *.jpeg. Accordingly, the paths needed to search for the files are also present in the configuration. These can be both disk names and network paths to remote machines.\r\n\u003c/p\u003e\r\n\u003ch3\u003eFunctionality of the loaded module\u003c/h3\u003e\r\n\u003cp\u003e\r\n\t The first thing that interested us was that the function that transfers control to the code of the loaded module in the first argument (Figure 35) passes a pointer to the function which communicates with the control server.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"A code fragment for calling the downloaded module\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/35.png\"\u003e \u003cfigcaption\u003eFigure 35. A code fragment for calling the downloaded module\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Analyzing this function allowed us to understand that in this case the communication scheme is identical to the one described above: data is transferred by function calls from the table of virtual methods of the same COM object (in this case, PUT is used as the communication method).\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t Other than this, the analysis of the loaded module reveals nothing of interest. It simply performs a recursive search in the directories of certain paths.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t It's worth noting that for each type of disk connected to the computer, a different type of search is used (Figure 36). It is also possible to steal files from remote servers—in this case, usernames and passwords (stored in the malware configuration) are transferred as parameters.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"Different types of search implemented in the malware\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/36.png\"\u003e \u003cfigcaption\u003eFigure 36. Different types of search implemented in the malware\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Let's also have a look at the function responsible for analyzing the contents of the scanned directories (Figure 37). It's worth noting that the function itself does not read the file directly. Instead, the pointer to the read function (pfnReadFile in the figure) is transferred through the global context—the structure that is initialized at the initial stage of the application—and the function is called this way.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The function for searching files in a directory\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/37.png\"\u003e \u003cfigcaption\u003eFigure 37. The function for searching files in a directory\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003ch2\u003eNetwork infrastructure\u003c/h2\u003e\r\n\u003cp\u003e\r\n\t All the domains that we discovered in the 2019–2021 attacks were registered through the anonymous registrar bitdomain[.]biz. This resource guarantees complete anonymity and payment on the service is made exclusively in bitcoins.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t After analyzing the SOA records of the domains, we found that the admin email address field contains perfectly normal email addresses. In some cases, they turned out to be the registrant addresses that we found in WHOIS. Therefore, in those domains where WHOIS was hidden by the privacy settings, it can be assumed that the email in the SOA is the email of the registrant.\r\n\u003c/p\u003e\r\n \u003cbr\u003e\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003cb\u003eDomain \u003c/b\u003e\r\n\t\t\t\u003c/p\u003e\r\n \u003cb\u003e \u003c/b\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n \u003cb\u003e \u003c/b\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003cb\u003e\r\n\t\t\t\temail \u003c/b\u003e\r\n\t\t\t\u003c/p\u003e\r\n \u003cb\u003e \u003c/b\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003c/tbody\u003e\r\n\t\u003ctbody\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t mynewtemplate.com\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:adam_s92@protonmail.com\"\u003eadam_s92@protonmail.com\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t new-template.com\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:piterjesten@protonmail.com\"\u003epiterjesten@protonmail.com\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t upgrade-office.com\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:p.borovin@protonmail.com\"\u003ep.borovin@protonmail.com\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t upgrade-office.org\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:pavel.savin1992@bk.ru\"\u003epavel.savin1992@bk.ru\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t msofficeupdate.org\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:g.j.dodson@protonmail.com\"\u003eg.j.dodson@protonmail.com\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t officeupgrade.org\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:alex.sval@tutanota.com\"\u003ealex.sval@tutanota.com\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t newoffice-template.com\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:j.konnoban@email.cz\"\u003ej.konnoban@email.cz\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003ctr\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t\t template-new.com\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\t\u003ctd\u003e\r\n\t\t\t\u003cp align=\"center\"\u003e\r\n \u003ca href=\"mailto:e.darmanin@inbox.lv\"\u003ee.darmanin@inbox.lv\u003c/a\u003e\r\n\t\t\t\u003c/p\u003e\r\n\t\t\u003c/td\u003e\r\n\t\u003c/tr\u003e\r\n\t\u003c/tbody\u003e\r\n\t\u003c/table\u003e\r\n\u003c/div\u003e\r\n \u003cbr\u003e\r\n\u003cp\u003e\r\n\t When analyzing the 2022 campaign, we found a pattern: all the control servers registered by the attackers are used only to load remote templates.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t List of the detected servers:\r\n\u003c/p\u003e\r\n\u003cul\u003e\r\n\t\u003cli\u003echecklicensekey.com\u003c/li\u003e\r\n\t\u003cli\u003ecomparelicense.com\u003c/li\u003e\r\n\t\u003cli\u003edriver-updated.com\u003c/li\u003e\r\n\t\u003cli\u003esync-firewall.com\u003c/li\u003e\r\n\t\u003cli\u003esystem-logs.com\u003c/li\u003e\r\n\t\u003cli\u003etechnology-requests.net\u003c/li\u003e\r\n\t\u003cli\u003etranslate-news.net\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e\r\n\t We also discovered an interesting fact: the attackers disguised one of the control servers (technology-requests.net), trying to make it look like the site \u003ca href=\"https://www.hoosierheightsindianapolis.com\"\u003ehttps://www.hoosierheightsindianapolis.com\u003c/a\u003e (Figure 38).\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The legitimate site\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/38.png\"\u003e \u003cfigcaption\u003eFigure 38. The legitimate site\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t Figure 39 shows what the malicious site looked like on July 26, according to webcache.googleusercontent.com.\r\n\u003c/p\u003e\r\n \u003cfigure\u003e \u003cimg alt=\"The site from which the malicious content was downloaded\" src=\"/upload/corporate/ww-en/images/esc/apt-cloudatlas-unbroken-threat/39.png\"\u003e \u003cfigcaption\u003eFigure 39. The site from which the malicious content was downloaded\u003c/figcaption\u003e \u003c/figure\u003e\r\n\u003cp\u003e\r\n\t The malicious tools communicate through a cloud service (similar to previous years), namely OpenDrive (\u003ca href=\"https://www.opendrive.com/\"\u003ehttps://www.opendrive.com\u003c/a\u003e). The service is used for both storing the malware modules to be loaded and for loading the collected data. In this case, a temporary mailbox is used for logins.\r\n\u003c/p\u003e\r\n\u003ch2\u003eConclusion\u003c/h2\u003e\r\n\u003cp\u003e\r\n\t The Cloud Atlas group has been active for many years, carefully thinking through every aspect of their attacks. The group's toolkit has not changed for years—they try to hide their malware from researchers by using one-time payload requests and validating them. The group avoids network and file attack detection tools by using legitimate cloud storage and well-documented software features, in particular in Microsoft Office.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t The attackers also carefully choose their victims and target their attacks: the group used targeted mailings based on the professional field of the recipients, but we noted the absence of any publicly available information about the recipients, which could indicate a well-prepared attack.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\n\t We predict that the group will continue to operate, increasing the complexity of its tools and attack techniques due to the fact that it has once again attracted the attention of researchers.\r\n\u003c/p\u003e\r\n\r\n\u003cp\u003e\r\n\u003cb\u003eAuthors:\u003c/b\u003e Denis Kuvshinov, Aleksandr Grigorian, Daniil Koloskov, Positive Technologies\r\n\u003c/p\u003e\r\n\r\n\u003cp\u003eThe article's authors thank the incident response and threat intelligence teams PT Expert Security Center for their help in drafting the story.\r\n\u003c/p\u003e\r\n\r\n\r\n\r\n\r\n\u003ch2\u003eDetection of CloudAtlas group activity by Positive Technologies products\u003c/h2\u003e\r\n\u003ch3\u003e\u003ca href=\"https://www.ptsecurity.com/ww-en/products/mpsiem/\"\u003eMP SIEM\u003c/a\u003e\u003c/h3\u003e\r\n\u003cp\u003e\r\nThe following correlation rules analyze triggered processes and help identify the described activity:\r\n\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eSuspicious_Connection\u003c/li\u003e\r\n\u003cli\u003eMalicious_Office_Document\u003c/li\u003e\r\n\u003cli\u003eWindows_Autorun_Modification\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e\r\nThe following correlation rules analyze the triggered scripts and help detect the described activity:\r\n\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eExecute_Malicious_Powershell_Cmdlet\u003c/li\u003e\r\n\u003cli\u003eExecute_Malicious_Command\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e\r\nImplementation of D3FEND techniques in MP SIEM, which will help in detecting CloudAtlas grouping activity\r\n\u003c/p\u003e\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eD3FEND ID\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Name of technique  D3FEND\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Description\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003c/tbody\u003e\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:ProcessAnalysis/\"\u003eD3-PA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Process Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tCloudAtlas group activity can be identified through the rules of process analysis.\r\n\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:ScriptExecutionAnalysis/\"\u003eD3-SEA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Script Execution Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tCloudAtlas group activity can be detected through the analysis rules of the launched scripts. \r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003c/tbody\u003e\r\n\t\u003c/table\u003e\r\n\u003c/div\u003e\u003cbr\u003e\r\n\r\n\u003ch3\u003e\u003ca href=\"https://www.ptsecurity.com/ww-en/products/network-attack-discovery/\"\u003ePT NAD\u003c/a\u003e\u003c/h3\u003e\r\n\u003cp\u003e\r\nPT NAD contains a CloudAtlas reputation list, which will help in identifying CloudAtlas grouping activity.\r\n\u003c/p\u003e\r\n\u003cp\u003e\r\nImplementation of D3FEND techniques in PT NAD, which will help in detecting CloudAtlas activity.\r\n\u003c/p\u003e\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eD3FEND ID\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Name of technique  D3FEND\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Description\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003c/tbody\u003e\u003ctbody\u003e\r\n\t\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:DNSTrafficAnalysis/\"\u003eD3-DNSTA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t DNS Traffic Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tUsing reputation lists to detect Cloud Atlas group activity\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:FileCarving/\"\u003eD3-FC\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t File Carving\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tExtracting from traffic the files downloaded by the Cloud Atlas group\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003c/tbody\u003e\r\n\t\u003c/table\u003e\r\n\u003c/div\u003e\u003cbr\u003e\r\n\r\n\r\n\u003ch3\u003e\u003ca href=\"https://www.ptsecurity.com/ww-en/products/sandbox/\"\u003ePT Sandbox\u003c/a\u003e\u003c/h3\u003e\r\n\u003cp\u003e\r\nPT Sandbox verdicts on CloudAtlas grouping activity:\r\n\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eTrojan.Win32.Generic.a\u003c/li\u003e\r\n\u003cli\u003eTrojan.Win32.RegLOLBins.a\u003c/li\u003e\r\n\u003cli\u003eBackdoor.Win32.CloudAtlas.a\u003c/li\u003e\r\n\u003cli\u003eTrojan-Downloader.Win32.Generic.a\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e\r\nNetwork traffic analysis rules to help detect CloudAtlas grouping activity:\r\n\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eLOADER [PTsecurity] Possible CloudAtlas\u003c/li\u003e\r\n\u003cli\u003eSUSPICIOUS [PTsecurity] PROPFIND method in http request\u003c/li\u003e\r\n\u003cli\u003eSUSPICIOUS [PTsecurity] MKCOL method in http request\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e\r\nYara-rules, which will help in detecting CloudAtlas grouping activity:\r\n\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003ePTESC_tool_win_ZZ_OfficeTemplate__Downloader__DOC\u003c/li\u003e\r\n\u003cli\u003ePTESC_exploit_win_ZZ_MalDoc__CVE201711882__Rtf__CA\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003cp\u003e\r\nImplementation of D3FEND techniques in PT Sandbox, which will help in detecting CloudAtlas grouping activity\r\n\u003c/p\u003e\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eD3FEND ID\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Name of technique  D3FEND\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Description\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003c/tbody\u003e\u003ctbody\u003e\r\n\t\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:ProcessAnalysis/\"\u003eD3-PA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Process Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tAnalysis of the behavior of processes created by malicious applications of the Cloud Atlas group\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:FileAnalysis/\"\u003eD3-FA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t File Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tAnalysis of Cloud Atlas group files to determine their status and functionality\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis/\"\u003eD3-NTA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Network Traffic Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tCloudAtlas activity can be detected through traffic analysis\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003c/tbody\u003e\r\n\t\u003c/table\u003e\r\n\u003c/div\u003e\u003cbr\u003e\r\n\r\n\r\n\r\n\u003ch2 id=\"id7\"\u003eYara\u003c/h2\u003e\r\n\u003cpre\u003e    \u003cdiv class=\"code\"\u003e\r\nrule PTESC_tool_win_ZZ_OfficeTemplate__Downloader__DOC\r\n{\r\n\tstrings:\r\n\t\t$a = {00 A5 06 6E 04 B4}\r\n\t\t$b = {FF FF FF 7F FF FF FF 7F}\r\n\t\t$c = {B4 00 B4 00 81 81 12 30 00}\r\n\t\t$pref_1 = {68 00 74 00 74 00 70 00 3A 00 2F 00 2F}\r\n\t\t$pref_2 = {68 00 74 00 74 00 70 00 73 00 3A 00 2F 00 2F}\r\n\tcondition:\r\n\t\tuint16be ( 0 ) == 0xd0cf and ( for any i in ( 300 .. 400 ) : ( uint8be ( @a + i ) == 0x68 and uint8be ( @a + i + 2 ) == 0x74 and uint8be ( @a + i + 4 ) == 0x74 and uint8be ( @a + i + 6 ) == 0x70 ) or for any j in ( 100 .. 200 ) : ( uint8be ( @b + j ) == 0x68 and uint8be ( @b + j + 2 ) == 0x74 and uint8be ( @b + j + 4 ) == 0x74 and uint8be ( @b + j + 6 ) == 0x70 ) or for any k in ( 200 .. 400 ) : ( uint8be ( @c + k ) == 0x68 and uint8be ( @c + k + 2 ) == 0x74 and uint8be ( @c + k + 4 ) == 0x74 and uint8be ( @c + k + 6 ) == 0x70 ) ) and ( ( for any l in ( 14 .. 70 ) : ( uint8be ( @pref_1 + l ) == 0x2f ) ) or ( for any y in ( 16 .. 70 ) : ( uint8be ( @pref_2 + y ) == 0x2f ) ) )\r\n}\r\n\r\n\u003c/div\u003e\u003c/pre\u003e\r\n\r\n\u003cpre\u003e    \u003cdiv class=\"code\"\u003e\r\nrule PTESC_exploit_win_ZZ_MalDoc__CVE201711882__Rtf__CA\r\n{\r\n strings:\r\n $equation = \"4571756174696F6E\" nocase ascii //180000004571756174696F6E\r\n $msftedit = \"generator Msftedit 6.39.15\" nocase ascii //generator Msftedit 6.39.15.1401\r\n $objclass = \"objclass weaseoijsd\" nocase ascii\r\n condition:\r\n uint32be ( 0 ) == 0x7B5C7274 and ($equation and ($msftedit or $objclass) or (for any i in (50..350) : (uint8be (@equation + i) == 0x64 and uint8be (@equation + i + 2) == 0x64 and uint8be (@equation + i + 4) == 0x64 and uint8be (@equation + i + 6) == 0x38)))\r\n}\r\n\u003c/div\u003e\u003c/pre\u003e\r\n\r\n\r\n\r\n\u003ch2\u003eIOCs\u003c/h2\u003e\r\n\r\n\t\u003ch3\u003eFile indicators\u003c/h3\u003e\r\n\u003cbr\u003e\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t \u003cb\u003eName\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"left\"\u003e\u003cb\u003e\r\n\t\t\t SHA-256\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"left\"\u003e\u003cb\u003e\r\n\t\t\t MD5\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"left\"\u003e\u003cb\u003e\r\n\t\t\t SHA-1\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t Методические рекомендации для грузоотправителей-грузополучателей (2022).doc (Guidelines for consignors-consignees (2022).doc)\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t f2c4281e4d6c11173493b759adfb0eb798ce46650076e7633cf086b6d59fdb98\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t b3f55d9065dd51a8be2d6c5078866086\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 9f4a18adaa094eef06ef88e76b6f4ed777f677e7\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t Будьте_бдительны_Корпоративное_уведомление.doc (Stay_alert_Corporate_Notice.doc)\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 482aeb3db436e8d531b2746a513fe9a96407cf4458405680a49605e136858ec5\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 3399deafaa6b91e8c19d767935ae0908\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t b745032dd5cd6f7eba2187fa3c86c775953a5611\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\tИранские оценки визита В. Путина в Тегеран.doc (Iranian assessments of V. Putin's visit to Tehran.doc)\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 2f97374c76ae10c642a57a8b13d25cbdc070c9098c951ea418d1533ac01dc23c\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 61b6e2040d5815d0135b2850137828d9\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t df80df54f94d56aa436cdc2713e3bc8160ce43f8\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t Почему исламский мир не дает Западу изолировать Россию.doc (Why the Islamic world does not allow the West to isolate Russia.doc)\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 3cf2bda35e88c59bb89e7fdc8fcfd4c46b2b9186e61325d2924e049d775b741f\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 2b5cec8715e92d87bf6992e003a5651c\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 9fc804b58ab43fc5f453810a30ea311fc3f5cbe6\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t leptophis[1].doc\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t c0e154b10d70b99b5616a2eda6bfe188a49f85ed3aa92d48ec9ce709df9d563f\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 470c1df23bd825c6e36e1cd5936db912\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t ba9fc2f0d9f0fcf726a2cbc426f570bea5f22c96\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t lep[1].hta\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t a4194555b19ea32680cc23f8f7d42da02b82eba8b64cb5f4630110f4e2c1ddf3\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 66ecc2285e9d172ceb9f0b0ba030c65c\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t b5cc0a7ff0d8cd151545cbabcaf23c5486acec95\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t unbroken.vbs\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 59066dc428cde7cc55f3c24c2658d3e288f3f072811d86243a85af14bd482744\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 7ce01fc92fc221cad338cea1cfd43a22\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 9579b7f3a98657f704575aa4a08ed6ff3d8680a4\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t unbroken.vbs.vbs\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 4cb6e224b6b03a2f6ac1ac23e6bf097067018b90493ee94f210f66fbbbbdce77\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 1aa04f847bd7ec987986ec6e52966b89\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 8e23ac686bbc958dd85e46a2d4bb6acaee5aa35f\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t list.ps1\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 2233c0d4030cc728c2219b1e9c4c05cb262e2ddc7f4ac2f2924767396418c25a\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t d5a40e2986efd4a182bf564084533763\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 89364b9d170ab90d25d30649582679c3d7332b91\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t office.ps1\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 7fcf7c1dad362283d0a27993df4764e2bbb11857842b80f63d63449b9f2f1fa4\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t d02ab337bc56214d72b8cabea8bc19b2\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 81e22a16a6617670c394dbd7ee642eba8e419de7\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\toffice.ps1\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t d9fc6504c8970fefc441c77965937c382b029f1278918d1f54d196859e9f6e7c\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 077b71298ce31832ae43e834b7e6c080\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t ee50f3cd04d0fdf5e931ad85bfd464828116279b\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\trtcpsvc.dll\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 3e7b066c26ba98d285a41043c739be8767606d9df057ee2f7bcddb7862c00711\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t f68e64dacd046289d4222098ee421478\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t ce13a1ae0dd5d537320b77ac8e3d94df6448a82a\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t lockrail.dll\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t c5d1de206445f508c1af5f213e46b915b536e4b36ef917c4e826a982dd47c312\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t acbbc6fea0dbbe7cba511b450cc2b758\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 94f342f9219cee4f2b91b54809de92d5bb00e93e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t holeincorner\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 8215e918ca3a77424dadac1aebc9a44b8f9840cd1389df0399a9fa4eb6329775\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t dc3faa6840d1b5fd296d71ee8877254e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 53b767ff4fa5c5adc7041389ffd28bb4abda1434\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t Salzgitters.avi\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t b8dc70b9ffe06c9ecaf0216ea7948fe718143db10641a23297652693ea026ab3\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t e5e19040beabb0c0c68fdf4f3978a18b\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t e68dc027aee851125960ee0559610f43fee581b0\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t Schultes.wmv\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t f4e710f515249e8c08ae76284bfb280070e1fd2308e9d9321d92163dfc73be66\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 45f6f95918efbdcc2c97e3d905635f83\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"left\"\u003e\r\n\t\t\t 9a1d8a68042b91ee17648606e43907354227d25f\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\t\u003c/tbody\u003e\u003c/table\u003e\r\n\u003c/div\u003e\u003cbr\u003e\r\n\r\n\r\n\u003ch3\u003eNetwork indicators:\u003c/h3\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e api-help.com\u003c/li\u003e\r\n\t\u003cli\u003edriver-updated.com\u003c/li\u003e\r\n\t\u003cli\u003esync-firewall.com\u003c/li\u003e\r\n\t\u003cli\u003esystem-logs.com\u003c/li\u003e\r\n\t\u003cli\u003etechnology-requests.net\u003c/li\u003e\r\n\t\u003cli\u003etranslate-news.net\u003c/li\u003e\r\n\t\u003cli\u003echecklicensekey.com\u003c/li\u003e\r\n\t\u003cli\u003ecomparelicense.com\u003c/li\u003e\r\n\u003cli\u003emsupdatecheck.com\u003c/li\u003e\r\n\u003cli\u003eprotocol-list.com\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003ch3\u003ePayload filenames (from the configuration):\u003c/h3\u003e\r\n\u003cul\u003e\r\n\u003cli\u003ecallicrates\u003c/li\u003e\r\n\u003cli\u003etinh\u003c/li\u003e\r\n\u003cli\u003eamianthium\u003c/li\u003e\r\n\u003cli\u003emandarinduck\u003c/li\u003e\r\n\u003cli\u003ecushioning\u003c/li\u003e\r\n\u003cli\u003ekingsclover\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\u003ch3 id=\"id10-2\"\u003eEmail addresses from which malicious emails were sent:\u003c/h3\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003ca href=\"mailto:ano.spectr@yandex.ru\"\u003eano.spectr@yandex.ru\u003c/a\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003ca href=\"mailto:ancentr@lenta.ru\"\u003eancentr@lenta.ru\u003c/a\u003e\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\r\n\r\n\u003cbr\u003e\r\n\u003ch2 id=\"id8\"\u003eMITRE TTPs\u003c/h2\u003e\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eID\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Name\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Description\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003c/tbody\u003e\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd colspan=\"3\"\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eResource Development\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1583\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Acquire Infrastructure\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group used servers to store remote templates, as well as cloud storage as a control server\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1585\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Establish Accounts\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group registered cloud service accounts and tempmail mailboxes\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd colspan=\"3\"\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eInitial Access\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1566.001\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Phishing: Spearphishing Attachment\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group sent phishing emails with malicious content\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd colspan=\"3\"\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eExecution\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1204.002\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t User Execution: Malicious File\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group sent emails with malicious DOC and DOCX files\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1559.001\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Inter-Process Communication: Component Object Model\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used COM components in their tools\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1059.001\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Command and Scripting Interpreter: PowerShell\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used PowerShell scripts to load and run their components\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1059.005\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Command and Scripting Interpreter: Visual Basic\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used Visual Basic scripts to load and run their components\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1203\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Exploitation for Client Execution\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used vulnerabilities in Microsoft Office components to launch their malicious components\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd colspan=\"3\"\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003ePersistence\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1547.001\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group used registry keys (autorun) for persistence\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd colspan=\"3\"\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eDefense Evasion\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1221\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Template Injection\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used a remote template injection technique to hide the malicious payload\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1140\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Deobfuscate/Decode Files or Information\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group encrypts its components to protect them from discovery and analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd colspan=\"3\"\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eCollection\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1025\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Data from Removable Media\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group used tools to collect information from various remote devices\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1039\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Data from Network Shared Drive\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group used tools to collect information from various network devices\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1005\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Data from Local System\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used tools to collect information from the file system\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1560.002\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Archive Collected Data: Archive via Library\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group applies LZNT1 compression to collected data using the WinAPI library\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1560.003\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Archive Collected Data: Archive via Custom Method\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used custom data encryption algorithms\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1119\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Automated Collection\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used methods of automatic data collection from infected machines\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd colspan=\"3\"\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eCommand and Control (C2)\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1573.001\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Encrypted Channel: Symmetric Cryptography\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\t The Cloud Atlas group used AES encryption to hide network communication\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1041\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Exfiltration Over C2 Channel\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used a C2 channel to transfer collected data\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t T1102\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Web Service\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tThe Cloud Atlas group used the OpenDrive cloud service as a control server\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\t\t\u003c/tbody\u003e\r\n\t\u003c/table\u003e\r\n\u003c/div\u003e\u003cbr\u003e\r\n\r\n\r\n\r\n\u003ch2 \u003eGeneral TTP countermeasures used by CloudAtlas\u003c/h2\u003e\r\n\u003ch3\u003eBasic protective measures\u003c/h3\u003e\r\n\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eD3FEND ID\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Name of technique D3FEND\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Description\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003c/tbody\u003e\u003ctbody\u003e\r\n\t\u003ctr\u003e\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:SystemVulnerabilityAssessment/\"\u003eD3-SYSVA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t System Vulnerability Assessment\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tSince CloudAtlas exploits vulnerabilities, it is necessary to monitor the vulnerability of systems in the infrastructure and update vulnerable software in a timely manner\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:SoftwareUpdate/\"\u003eD3-SU\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Software Update\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tSince CloudAtlas exploits vulnerabilities, it is necessary to monitor the vulnerability of systems in the infrastructure and update vulnerable software in a timely manner\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering/\"\u003eD3-OTF\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Outbound Traffic Filtering\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tRestrict network traffic to untrusted servers from IOC lists\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:DNSDenylisting/\"\u003eD3-DNSDL\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t DNS Denylisting\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tBlock resolution of DNS names from IOC lists\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\r\n\u003c/tbody\u003e\r\n\t\u003c/table\u003e\r\n\u003c/div\u003e\u003cbr\u003e\r\n\r\n\u003ch3 \u003eAdditional protective measures\u003c/h3\u003e\r\n\r\n\u003cdiv class=\"table-container\"\u003e\r\n\t\u003ctable class=\"table-article\"\u003e\r\n\t\u003ctbody\u003e\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003cb\u003eD3FEND ID\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Name of technique D3FEND\r\n\t\t\u003c/b\u003e\u003c/p\u003e\u003cb\u003e\r\n\t\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003e\r\n\t\t\u003c/b\u003e\u003cp align=\"center\"\u003e\u003cb\u003e\r\n\t\t\t Description\u003c/b\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\u003c/tbody\u003e\u003ctbody\u003e\r\n\t\u003ctr\u003e\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:SenderReputationAnalysis/\"\u003eD3-SRA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t Sender Reputation Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tCloudAtlas group uses free email services, so as an additional measure of protection against phishing, you can specially mark emails from external free services to attract additional attention of the user\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003ctr\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t \u003ca href=\"https://d3fend.mitre.org/technique/d3f:UserDataTransferAnalysis/\"\u003eD3-UDTA\u003c/a\u003e\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp align=\"center\"\u003e\r\n\t\t\t User Data Transfer Analysis\r\n\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\t\u003ctd\u003e\r\n\t\t\u003cp\u003e\r\n\t\t\tCloudAtlas grouping downloads data through compromised workstations, so you can use profiling of the amount of data transferred to the Internet by the user to detect anomalies in the case of massive data exfiltration\r\n\t\t\t\u003c/p\u003e\r\n\t\u003c/td\u003e\r\n\u003c/tr\u003e\r\n\r\n\u003c/tbody\u003e\r\n\t\u003c/table\u003e\r\n\u003c/div\u003e\u003cbr\u003e\r\n\r\n\r\n\r\n\r\n \u003c/article\u003e","title":"APT Cloud Atlas: Unbroken Threat","date":"2022-12-09T00:00:00.000Z","slug":"apt-cloud-atlas-unbroken-threat","file":"","titleOfHelpfulFiles":"","helpfulFiles":[]},"footerData":{"title":"Cybersecurity market leader","copyright":"Copyright \u003cmark\u003e©\u003c/mark\u003e 2002–2025 Positive Technologies. All rights reserved.","products":{"title":"Products","navItems":[{"name":"PT NAD","link":"/products/network-attack-discovery"},{"name":"PT NGFW","link":"/products/ngfw"},{"name":"PT Sandbox","link":"/products/sandbox"},{"name":"MaxPatrol VM","link":"/products/maxpatrol-vm"},{"name":"MaxPatrol SIEM","link":"/products/siem"},{"name":"PT Application Inspector","link":"/products/ai"},{"name":"PT BlackBox","link":"/products/blackbox"},{"name":"PT ISIM","link":"/products/isim"},{"name":"MaxPatrol O2","link":"/products/mp-o2"},{"name":"MaxPatrol EDR","link":"/products/edr"},{"name":"PT Application Firewall","link":"/products/pt-af"},{"name":"PT Container Security","link":"/products/cs"},{"name":"PT Industrial Cybersecurity Suite","link":"/products/ics"},{"name":"PT Threat Intelligence Feeds","link":"/products/threat-intelligence-feeds"},{"name":"PT Knockin","link":"/products/knockin"}]},"company":{"title":"ANALYTICS","navItems":[{"name":"Analytics articles","link":"/analytics"},{"name":"Knowledge base","link":"/analytics/knowledge-base"},{"name":"PT ESC threat intelligence","link":"/analytics/pt-esc-threat-intelligence"},{"name":"Threatscape","link":"/analytics/threatscape"},{"name":"Hacker groups","link":"/analytics/hacker-groups"}]},"social":{"title":"COMPANY","navItems":[{"name":"About us","link":"/about"},{"name":"Clients","link":"/about/clients"},{"name":"Contacts","link":"/about/contacts"},{"name":"PT in the Media","link":"/about/pt-in-the-media"},{"name":"Education","link":"https://edu.ptsecurity.com/learning-space"},{"name":"YouTube","link":"https://www.youtube.com/channel/UC9hnMfdwfLd8V5qEc-6MXXQ"},{"name":"LinkedIn","link":"https://www.linkedin.com/company/positivetechnologies/"},{"name":"Х","link":"https://x.com/PTsecurity_EN"},{"name":"TikTok","link":"https://www.tiktok.com/@positivetechnologies"},{"name":"Vacancy","link":"https://vacancy.global.ptsecurity.com/"}]},"logoImage":{"src":"https://pt-global.storage.yandexcloud.net/logo_1d137588e3.svg","width":1200,"height":100,"alt":""},"legalDocsLink":{"id":61,"text":"Legal documents","link":"https://global.ptsecurity.com/policies/terms-of-use","targetBlank":true}},"anyQuestionsData":{"selectProductOptions":[{"value":"network-attack-discovery","label":"PT NAD","crmId":"3212ea27-d047-42f9-9da3-9ef5233634bb"},{"value":"ngfw","label":"PT NGFW","crmId":"2c0baa3e-9671-4bd2-b082-1a94298bd17f"},{"value":"sandbox","label":"PT Sandbox","crmId":"5addae27-2762-4a89-8b58-e247ab1e71dc"},{"value":"maxpatrol-vm","label":"MaxPatrol VM","crmId":"e5ffe330-69bf-4344-b0b0-c228de0f6f83"},{"value":"siem","label":"MaxPatrol SIEM","crmId":"0c54a201-09a7-4dc9-b3ca-1ce61715388b"},{"value":"ai","label":"PT Application Inspector","crmId":"4c2c50e6-2b8c-4c1e-a2da-f6423ece496b"},{"value":"blackbox","label":"PT BlackBox","crmId":"081eb4e2-54c2-4ce5-b171-d7dcaecc1c1f"},{"value":"isim","label":"PT ISIM","crmId":"67a72950-2d9c-47a1-8bb8-49540356da8f"},{"value":"mp-o2","label":"MaxPatrol O2","crmId":"29563721-4ec7-4e5b-8a48-f3674ab70749"},{"value":"edr","label":"MaxPatrol EDR","crmId":"c667eb61-0b7a-457c-991c-43b83504a7ed"},{"value":"pt-af","label":"PT Application Firewall","crmId":"b6b16deb-0ceb-4318-b947-fd238d7a9935"},{"value":"cs","label":"PT Container Security","crmId":"2df38b89-5d1f-4a0d-8be4-76ea9f8d2e30"},{"value":"ics","label":"PT Industrial Cybersecurity Suite","crmId":""},{"value":"threat-intelligence-feeds","label":"PT Threat Intelligence Feeds","crmId":""},{"value":"knockin","label":"PT Knockin","crmId":"0d1bb29e-4b9e-4fa4-bed0-03fe41c09746"}],"title":"Get in touch","description":"Fill in the form and our specialists\u003cbr/\u003e will contact you shortly","feedback":{"title":"General\u003cbr/\u003e questions","description":"We're happy to answer any questions you may have.","fieldName":"Name","fieldPhone":"Phone number","fieldEmail":"Email","fieldComment":"How can we help?","fieldCountry":"Country","checkboxConsentsTerms":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent\" target=\"_blank\"\u003emy consent to the processing of my personal data\u003c/a\u003e in accordance with the terms of the \u003ca href=\"https://global.ptsecurity.com/policies/privacy-policy\" target=\"_blank\"\u003ePrivacy Notice\u003c/a\u003e","checkboxSubscription":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent-email\" target=\"_blank\"\u003emy consent to receive marketing and informational messages\u003c/a\u003e","buttonSubmit":"SEND","successTitle":"Thank you, your application has been sent","successDescription":"Our specialists will contact you soon."},"partnership":{"title":"Partnership","description":"Join us in making the world a safer place.","fieldName":"Name","fieldCompanyName":"Company name","fieldPhone":"Phone number","fieldEmail":"Email","fieldComment":"How can we help?","fieldAddress":"Address","fieldCountry":"Country","checkboxConsentsTerms":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent\" target=\"_blank\"\u003emy consent to the processing of my personal data\u003c/a\u003e in accordance with the terms of the \u003ca href=\"https://global.ptsecurity.com/policies/privacy-policy\" target=\"_blank\"\u003ePrivacy Notice\u003c/a\u003e","checkboxSubscription":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent-email\" target=\"_blank\"\u003emy consent to receive marketing and informational messages\u003c/a\u003e","buttonSubmit":"SEND","successTitle":"Thank you, your application has been sent","successDescription":"Our specialists will contact you shortly."},"pilotApplication":{"title":"Request a pilot","description":"Test drive our solutions with a customized pilot program.","fieldProduct":"Select a product","fieldName":"Name","fieldCompanyName":"Company name","fieldPhone":"Phone number","fieldEmail":"Email","fieldComment":"How can we help?","fieldCountry":"Country","checkboxConsentsTerms":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent\" target=\"_blank\"\u003emy consent to the processing of my personal data\u003c/a\u003e in accordance with the terms of the \u003ca href=\"https://global.ptsecurity.com/policies/privacy-policy\" target=\"_blank\"\u003ePrivacy Notice\u003c/a\u003e","checkboxSubscription":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent-email\" target=\"_blank\"\u003emy consent to receive marketing and informational messages\u003c/a\u003e","buttonSubmit":"SEND","successTitle":"Thank you, your application has been sent","successDescription":"Our specialists will contact you shortly."}},"sidebarData":{"widgets":[{"kind":"analytics-articles","data":{"title":"Analytics articles","link":"/analytics","withFlag":true,"items":[{"text":"Cyberthreats to industrial IoT in the manufacturing sector","link":"/analytics/cyberthreats-to-industrial-iot","targetBlank":true,"publishedDate":"2025-01-28T00:00:00.000Z"},{"text":"Cyberthreats evolve while forecasts signal more sophisticated risks ahead","link":"/analytics/cyberthreats-evolve-while-forecasts-signal-more-sophisticated-risks-ahead","targetBlank":true,"publishedDate":"2025-01-07T00:00:00.000Z"},{"text":"Trending vulnerability digest November 2024","link":"/analytics/trending-vulnerability-digest-november-2024","targetBlank":true,"publishedDate":"2024-12-26T00:00:00.000Z"}]}},{"kind":"ad-banner","data":{"title":"What are the security threats on your network?","subtitle":"Check your traffic-for free","backgroundColor":null,"image":{"src":"https://pt-global.storage.yandexcloud.net/PT_Network_Attack_Discovery_2x_0d8a5793c7.png","width":542,"height":822,"alt":""},"actionProps":{"label":"Request pilot","href":"#contacts","isExternal":false}}}]},"_sentryTraceData":"b4703fab17954fe28dde2267ad83068a-bea3aeae9b24d406-1","_sentryBaggage":"sentry-environment=production,sentry-release=9J5r29UMeK7ol_-oUfSrr,sentry-public_key=98e9d1bba200933ad4e97a71f2de0390,sentry-trace_id=b4703fab17954fe28dde2267ad83068a,sentry-sample_rate=1,sentry-transaction=%2Fanalytics%2Fpt-esc-threat-intelligence%2F%5Bslug%5D,sentry-sampled=true"},"__N_SSP":true},"page":"/analytics/pt-esc-threat-intelligence/[slug]","query":{"slug":"apt-cloud-atlas-unbroken-threat"},"buildId":"9J5r29UMeK7ol_-oUfSrr","isFallback":false,"gssp":true,"locale":"en","locales":["en","es","pt"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>