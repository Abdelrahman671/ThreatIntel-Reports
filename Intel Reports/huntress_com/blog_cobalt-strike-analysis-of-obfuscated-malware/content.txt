<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=GTM-TXRTDGW4"></script><script type="text/javascript" async="" defer="" src="/assets/scripts/drift.js"></script><script type="text/javascript" async="" defer="" src="//js.hs-scripts.com/3911692.js"></script><script src="https://fast.wistia.com/embed/medias/lqy5p1741e.jsonp" async=""></script><script src="https://fast.wistia.com/assets/external/E-v1.js" async=""></script><script type="text/javascript" src="https://flackr.github.io/scroll-timeline/dist/scroll-timeline.js" async=""></script><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><title>Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress</title><meta name="description" content="Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values."/><meta property="og:title" content="Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress"/><meta property="og:description" content="Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values."/><meta property="twitter:title" content="Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress"/><meta property="twitter:description" content="Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values."/><link rel="canonical" href="https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware"/><link rel="icon" href="/assets/favicon-96x96-CtLNOBqH.png" type="image/png" sizes="96x96"/><link rel="icon" href="/assets/favicon-29P8YngA.svg" type="image/svg+xml"/><link rel="shortcut icon" href="/assets/favicon-C5x0nhzu.ico"/><link rel="apple-touch-icon" href="/assets/apple-touch-icon-DudXUahm.png" sizes="180x180"/><link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIkh1bnRyZXNzIiwKICAic2hvcnRfbmFtZSI6ICJIdW50cmVzcyIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogIi93ZWItYXBwLW1hbmlmZXN0LTE5MngxOTIucG5nIiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciLAogICAgICAicHVycG9zZSI6ICJtYXNrYWJsZSIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiL3dlYi1hcHAtbWFuaWZlc3QtNTEyeDUxMi5wbmciLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIsCiAgICAgICJwdXJwb3NlIjogIm1hc2thYmxlIgogICAgfQogIF0sCiAgInRoZW1lX2NvbG9yIjogIiNmZmZmZmYiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiCn0="/><meta name="google-site-verification" content="QZk47k59WXGOBjZRZodH6wC5rKaX9MnmeBFsV5jchE4"/><link rel="modulepreload" href="/assets/entry.client-m4_Zd7NT.js"/><link rel="modulepreload" href="/assets/chunk-HA7DTUK3-BpyMo6tN.js"/><link rel="modulepreload" href="/assets/index-DqyGAN61.js"/><link rel="modulepreload" href="/assets/root-DxiQAKzj.js"/><link rel="modulepreload" href="/assets/with-props-Dkp9k_PK.js"/><link rel="modulepreload" href="/assets/snowplow.tracker-OcujGbXE.js"/><link rel="modulepreload" href="/assets/blog._slug-CFRz3pg3.js"/><link rel="modulepreload" href="/assets/metadata-Dts9WTeE.js"/><link rel="stylesheet" href="/assets/root-DOhbAGIK.css"/><link rel="stylesheet" href="/assets/snowplow-BwfoH6KX.css"/><link rel="stylesheet" href="/assets/blog-post-CbkYeKVf.css"/><link rel="stylesheet" href="/assets/webflow.styles-qJ3oDT1C.css"/><link rel="stylesheet" href="/assets/webflow.head.styles-rFHjEbAs.css"/><link rel="stylesheet" href="/assets/webflow.supplimental.styles-CAjEq2ro.css"/><link rel="stylesheet" href="/assets/app-DF3E5Rn7.css"/><link rel="stylesheet" href="/assets/metadata-DeWOA2Zs.css"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=cT3rVWvp_kLHQtcar4fL6A&gtm_preview=env-390&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayer','GTM-TXRTDGW4');</script><script src="https://cdn.optimizely.com/js/5179843176824832.js"></script></head><body class="body"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXRTDGW4&amp;gtm_auth=cT3rVWvp_kLHQtcar4fL6A&amp;gtm_preview=env-390&amp;gtm_cookies_win=x" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image banner-ellipse desktop css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2"/></picture><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image banner-ellipse mobile css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff"/></picture></div><header class="header header-navigation-override" style="will-change:background"><div data-animation="default" class="navbar-logo-left-container shadow-three w-nav" data-easing2="ease" data-easing="ease" data-collapse="medium" role="banner" data-no-scroll="1" data-duration="400" data-doc-height="1"><div class="search-bar navigation-wrapper-top" style="opacity:1;height:40px"><a href="https://huntress.io/" target="_blank" class="top-bar-links">Partner Login</a><div class="search-container nav "><span class="span search ">Search</span><form class="nav-search w-form " data-hs-cf-bound="true" action="/search"><input class="nav-search-input w-input " autoComplete="false" maxLength="256" placeholder="Search..." type="search" id="search" name="query"/><input type="submit" class="nav-search-button w-button" value=""/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1758ef4667574398807a9dd0b08d4990" loading="lazy" alt="close icon" class="nav-search-close "/></form><div class="nav-search-overlay"></div></div></div><div class="navigation-wrapper"><a href="/" class="navigation-brand link w-nav-brand" aria-label="home"><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image navigation-brand css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02"/></picture></a><nav role="navigation" class="navigation-menu-wrapper w-nav-menu hidden lg:block"><ul role="list" class="nav-menu-main mobile w-list-unstyled"><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-0" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Platform</div></div><nav class="sub-menu-dropdown one w-dropdown-list " aria-labelledby="w-dropdown-toggle-0"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Huntress Managed Security Platform</div><div class="sub-menu-item-main"><a href="/platform/managed-edr" aria-current="page" class="sub-menu-item-2 w-inline-block w--current" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9a581d96024446599c07e34e19c93b07" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed EDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Get full visibility, detection, and response for your endpoints.</div></a><a href="/platform/security-awareness-training" class="sub-menu-item-2 tablet-hide w-inline-block" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img width="98.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0563b097f1c748188681789c23fe204a" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed Security Awareness Training</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Empower your teams with science-backed security awareness training.</div></a></div><a href="/platform" class="secondary-button hide-tablet w-inline-block" tabindex="0"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="sub-menu-item-main"><div class="spacer-52"></div><a href="/platform/managed-itdr" class="sub-menu-item-2 w-inline-block" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img width="95.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed ITDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Protect your Microsoft 365 identities and email environments.</div></a><a href="/platform/siem" class="sub-menu-item-2 w-inline-block" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed SIEM</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Capture the data that matters while filtering out the noise.</div></a></div><a href="/platform" class="secondary-button hide-desktop w-inline-block" tabindex="0"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column background-color-gray"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F675068d5b65d403cac4485154bb5ca16" loading="lazy" alt="" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Learn More</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Request a Demo</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Solutions</div></div><nav class="sub-menu-dropdown four w-dropdown-list " aria-labelledby="w-dropdown-toggle-1"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Solutions by Topic</div><div class="sub-menu-item-main"><a href="/solutions/topics/phishing" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Phishing</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/cybersecurity-compliance" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Compliance</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/business-email-compromise" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business Email Compromise</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block">Solutions by Industry</div><div class="sub-menu-item-main"><a href="/industries/education" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Education</h6></div></a><a href="/industries/financial-services" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Finance</h6></div></a><a href="/industries/healthcare" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Healthcare</h6></div></a><a href="/industries/manufacturing" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Manufacturing</h6></div></a><a href="/industries/state-and-local-government" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">State &amp; Local Government</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Resource</div><a href="/industries/healthcare/healthcare-resource-kit" class="sub-menu-nav w-inline-block" tabindex="0"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F906b12f80f904ae6b4753ee4a19183a7" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Healthcare Cybersecurity Success Kit</h6><div class="submenu-text-block-2">Packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.</div></div><a href="/industries/healthcare/healthcare-resource-kit" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Why Huntress</div></div><nav class="sub-menu-dropdown two w-dropdown-list " aria-labelledby="w-dropdown-toggle-2"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Who We Serve</div><div class="sub-menu-item-main"><a href="/why-huntress/managed-service-providers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="100" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F721ae206651e4037bf5e134b3d7a7ae6" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Managed Service Providers</h6></div></a><a href="/why-huntress/value-added-resellers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="98.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff0209e5a35e34a25a31075aca24dec96" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Value Added Resellers</h6></div></a><a href="/why-huntress/businesses-it-teams" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff257bebdca1c45cab6259f8436ca7221" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business &amp; IT Teams</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block no-border">The Huntress Difference</div><div class="sub-menu-item-main"><a href="/why-huntress/24-7-soc" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc7a2dd82c76547b8830a35af9c98a511" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress SOC</h6></div></a><a href="/success-stories" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f5b67604e284cb9bdf92a9a456fa608" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Case Studies</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border">Compare Huntress</div><div class="tablet-grid"><a href="/comparison/huntress-vs-bitdefender" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Bitdefender</h6></div></a><a href="/comparison/huntress-vs-blackpoint" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blackpoint</h6></div></a><a href="/comparison/huntress-vs-crowdstrike" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">CrowdStrike</h6></div></a><a href="/comparison/huntress-vs-datto" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datto</h6></div></a><a href="/comparison/huntress-vs-sentinelone" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">SentinelOne</h6></div></a><a href="/comparison/huntress-vs-sophos" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Sophos</h6></div></a><a href="/comparison/huntress-vs-webroot" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Webroot</h6></div></a><a href="/comparison" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Compare All</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-3" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Resources</div></div><nav class="sub-menu-dropdown three w-dropdown-list " aria-labelledby="w-dropdown-toggle-3"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Resource Center</div><div class="sub-menu-item-main"><a href="/resources?assets=Datasheet" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datasheets</h6></div></a><a href="/resources?assets=eBook" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Ebooks</h6></div></a><a href="/resources?assets=Report" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Reports</h6></div></a><a href="/resources?assets=On-Demand+Webinar" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">On-Demand Webinars</h6></div></a><a href="/resources?assets=Whitepaper" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Whitepapers</h6></div></a><a href="/resources?assets=Video" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Videos</h6></div></a></div><a href="/resources" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">View All Resources</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="spacer-24"></div><div class="sub-menu-item-main"><a href="/blog" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F40ee60b01d8d49f09d997eb34a43439c" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blog</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F125f40690a05440e9089e436d8b31ca5" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F694358fe49614632ad86600a467e9cfe" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Support Documentation</h6></div></a><a href="/integrations" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2b996be85228451f95f093c5387c229a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Integrations</h6></div></a><a href="https://hub.huntress.com/#/page/login" target="_blank" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4c51b19e07db4998921e15175320f9a7" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress Hub</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray hide-tablet"><div class="submenu-text-block no-border">Produced by Huntress</div><div class="sub-menu-item-main"><a href="/tradecraft-tuesday" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe39cd53f6f734c9fb9c75943e16a2f1f" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/firesidechat" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febc3adfc1175461e8b12d0fd6532ce26" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/product-lab-channel" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faed4732478f64b30acfc34fbdf4dd9ff" alt="" class="submenu-desktop-icon large-icon"/></div></a></div></div><div class="nav-dropdown-column background-color-gray show-tablet"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa895b30051794852b24aa18710f517e1" loading="lazy" alt="Huntress teal logo" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">The Huntress Threat Report</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-4" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">About</div></div><nav class="sub-menu-dropdown four w-dropdown-list " aria-labelledby="w-dropdown-toggle-4"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">About Huntress</div><div class="sub-menu-item-main"><a href="/company/our-company" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff4de7538b5ec415fa770b6c07fd89d53" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Our Story</h6></div></a><a href="/company/leadership" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1ba4e8f20634dc2991a67e2470eb39f" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Leadership</h6></div></a><a href="/company/press" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fde237b5630004059a52887d223bd2a83" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Latest News</h6></div></a><a href="/awards-and-accolades" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Awards</h6></div></a></div></div><div class="nav-dropdown-column"><div class="spacer-32"></div><div class="sub-menu-item-main"><a href="/company/careers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F80b5a5a31d2245e49c4038e433792c22" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Careers</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f5b67604e284cb9bdf92a9a456fa608" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="/contact-us" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="SAT icon" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3324b3cde0b84f3b8749e3f6577c6540" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Contact Us</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Success Story</div><a href="https://assets-global.website-files.com/6579dd0b5f9a54376d296939/6598317ed13aaee7ad5b2b9b_CascadeTechnologies-CaseStudy.pdf" target="_blank" class="sub-menu-nav w-inline-block" tabindex="0"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e90224bce1c415c81faa880b1cad6e6" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Cascade Technologies</h6><div class="submenu-text-block-2">See how Cascade Technologies was notified about the presence of a remote access Trojan with the help of Huntress,.</div></div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05fe4c70b424477ba87314407b7da543?alt=media&amp;token=6dcf35e4-e4c5-4858-8e97-a8a8c2be3811&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="main-menu-button-nav"><a href="/start-trial" class="button-primary navigation-button is-mobile w-button">Free Trial</a></li></ul></nav><div class="menu-button-mobile w-nav-button " data-ix="mobile-menu-open" style="-webkit-user-select:text" aria-label="menu" role="button" tabindex="0" aria-controls="w-nav-overlay-0" aria-haspopup="menu" aria-expanded="false"><div class="top-line" style="transform-style:preserve-3d;transition:all, transform 200ms;transform:translateX(0px) translateY(0px) translateZ(0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg)"></div><div class="middle-line" style="transition:all, opacity 200ms; opacity: 1"></div><div class="bottom-line" style="transform-style:preserve-3d;transition:all, transform 200ms;transform:translateX(0px) translateY(0px) translateZ(0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg)"></div></div></div><div class="w-nav-overlay h-screen hidden"><nav role="navigation" class="navigation-menu-wrapper block" style="transition:all, transform 400ms;transform:translateY(0px)"><ul role="list" class="nav-menu-main mobile w-list-unstyled"><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-0" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Platform</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile "><div class="sub-menu-link-container-mobile back">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Huntress Managed Security Platform</div><div class="sub-menu-item-main"><a href="/platform/managed-edr" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01041f90e1984945aab0dccf0916722e" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed EDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Get full endpoint visibility, detection, and response.</div></a><a href="/platform/security-awareness-training" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F35aa234381d6427a80d30e63bbfaa09f" alt="HSAT icon white" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed Security Awareness Training</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Empower your teams with science-backed security awareness training.</div></a></div><a href="/platform" class="secondary-button hide-tablet w-inline-block"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="sub-menu-item-main"><div class="spacer-52"></div><a href="/platform/managed-itdr" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed ITDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Protect your Microsoft 365 identities and email environments.</div></a><a href="/platform/siem" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed SIEM</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Capture the data that matter while filtering out the noise.</div></a></div><a href="/platform" class="secondary-button hide-desktop w-inline-block"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column background-color-gray"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F675068d5b65d403cac4485154bb5ca16" loading="lazy" alt="" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Learn More</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block"><div class="secodnary-button-text">Request a Demo</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Solutions</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Solutions by Topic</div><div class="sub-menu-item-main"><a href="/solutions/topics/phishing" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Phishing</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/cybersecurity-compliance" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Compliance</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/business-email-compromise" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business Email Compromise</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block first">Solutions by Industry</div><div class="sub-menu-item-main"><a href="/industries/education" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Education</h6></div></a><a href="/industries/financial-services" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Finance</h6></div></a><a href="/industries/healthcare" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Healthcare</h6></div></a><a href="/industries/manufacturing" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Manufacturing</h6></div></a><a href="/industries/state-and-local-government" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">State &amp; Local Government</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Resource</div><a href="/solutions/topics/phishing" class="sub-menu-nav w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F906b12f80f904ae6b4753ee4a19183a7" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Healthcare Cybersecurity Success Kit</h6><div class="submenu-text-block-2">Packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.</div></div><a href="/solutions/topics/phishing" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Why Huntress</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Who We Serve</div><div class="sub-menu-item-main"><a href="/why-huntress/managed-service-providers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e7ba690e3594165ae81c6634bd5674b" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Managed Service Providers</h6></div></a><a href="/why-huntress/value-added-resellers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F88641b569dc740a68238040efc5b4475" alt="EDR icon" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Value Added Resellers</h6></div></a><a href="/why-huntress/businesses-it-teams" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F45741133357a476e828f3fc9eff31134" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business &amp; IT Teams</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block no-border">The Huntress Difference</div><div class="sub-menu-item-main"><a href="/why-huntress/24-7-soc" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b28c9a9c5474bbfa61c1b00f5f205df" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress SOC</h6></div></a><a href="/success-stories" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc011a5e2c8c444b2bf1276d09d779297" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Case Studies</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray flex-col"><div class="submenu-text-block no-border">Compare Huntress</div><div class="tablet-grid"><a href="/comparison/huntress-vs-bitdefender" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Bitdefender</h6></div></a><a href="/comparison/huntress-vs-blackpoint" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blackpoint</h6></div></a><a href="/comparison/huntress-vs-crowdstrike" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">CrowdStrike</h6></div></a><a href="/comparison/huntress-vs-datto" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datto</h6></div></a><a href="/comparison/huntress-vs-sentinelone" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">SentinelOne</h6></div></a><a href="/comparison/huntress-vs-sophos" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Sophos</h6></div></a><a href="/comparison/huntress-vs-webroot" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Webroot</h6></div></a></div><a href="/comparison" class="secondary-button w-inline-block"><div class="secodnary-button-text">Compare All</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-3" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Resources</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Resource Center</div><div class="sub-menu-item-main"><a href="/resources?assets=Datasheet" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datasheets</h6></div></a><a href="/resources?assets=eBook" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Ebooks</h6></div></a><a href="/resources?assets=Report" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Reports</h6></div></a><a href="/resources?assets=On-Demand+Webinar" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">On-Demand Webinars</h6></div></a><a href="/resources?assets=Whitepaper" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Whitepapers</h6></div></a><a href="/resources?assets=Video" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Videos</h6></div></a></div><a href="/resources" class="secondary-button w-inline-block"><div class="secodnary-button-text">View All Resources</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="spacer-24"></div><div class="sub-menu-item-main"><a href="/blog" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9599aec9aca24cc38ed0787b9cf7af2a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blog</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F71184ce1c7ea4e40aeed46b2b1caa956" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd878e498b479437fb17af8599281c501" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Support Documentation</h6></div></a><a href="/integrations" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2b996be85228451f95f093c5387c229a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Integrations</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray flex-row hide-tablet"><div class="submenu-text-block no-border">Produced by Huntress</div><div class="sub-menu-item-main"><a href="/tradecraft-tuesday" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe39cd53f6f734c9fb9c75943e16a2f1f" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/firesidechat" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febc3adfc1175461e8b12d0fd6532ce26" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/product-lab-channel" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faed4732478f64b30acfc34fbdf4dd9ff" alt="" class="submenu-desktop-icon large-icon"/></div></a></div></div><div class="nav-dropdown-column background-color-gray show-tablet"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa895b30051794852b24aa18710f517e1" loading="lazy" alt="Huntress teal logo" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">The Huntress Threat Report</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-4" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">About</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">About Huntress</div><div class="sub-menu-item-main"><a href="/company/our-company" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa41cf78d4c9d4d4eb183c881deaa3c17" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Our Story</h6></div></a><a href="/company/leadership" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feaa35d4f1c7b42c789e587ecd7797b1a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Leadership</h6></div></a><a href="/company/press" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fde090186c37343fd9e65dc6c6d65b691" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Latest News</h6></div></a><a href="/awards-and-accolades" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Awards</h6></div></a></div></div><div class="nav-dropdown-column"><div class="spacer-32"></div><div class="sub-menu-item-main"><a href="/company/careers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8f51f4c3ba104f94921e0584294c9bde" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Careers</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1af4796442c046f58fd94a8e484e6ad1" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="/contact-us" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffae29f3a7d0e45bf9bc1403cb7722f81" alt="SAT icon" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Contact Us</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Success Story</div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05fe4c70b424477ba87314407b7da543?alt=media&amp;token=6dcf35e4-e4c5-4858-8e97-a8a8c2be3811&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="sub-menu-nav w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F78060584ce444ba5a726170f7951a8ec" loading="lazy" alt="Huntress Cybersecurity" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Cascade Technologies</h6><div class="submenu-text-block-2">See how Cascade Technologies was notified about the presence of a remote access Trojan with the help of Huntress,.</div></div><a href="https://assets-global.website-files.com/6579dd0b5f9a54376d296939/6598317ed13aaee7ad5b2b9b_CascadeTechnologies-CaseStudy.pdf" target="_blank" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="main-menu-button-nav"><a href="/start-trial" class="button-primary navigation-button is-mobile w-button">Free Trial</a></li></ul></nav></div></div></header><div class="page-wrapper"><div class="builder-component builder-component-65f3299e49a461b4b9c729ba" data-name="page" data-source="Rendered by Builder.io"><div class="builder-content" builder-content-id="65f3299e49a461b4b9c729ba" builder-model="page"><div data-builder-component="page" data-builder-content-id="65f3299e49a461b4b9c729ba"><style data-emotion-css="h47494">.css-h47494{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="builder-blocks css-h47494" builder-type="blocks"><style data-emotion-css="4hp89i">.css-4hp89i.builder-block{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;box-sizing:border-box;}</style><div class="builder-block builder-ddebc027a2b547be8bb340dc4719efa5 builder-has-component css-4hp89i" builder-id="builder-ddebc027a2b547be8bb340dc4719efa5"><section class="blog-banner-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658" loading="eager" alt="" class="landing-banner-shape-1 blog-listing-landing-banner-shape-1"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-listing-banner-wrapper"><div class="blog-listing-banner-main-breadcrumb-wrap"><div class="breadcrumb contained"><a href="/" class="breadcrumb-link level-1">Home</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><a href="/blog" class="breadcrumb-link level-2">Blog</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><div class="breadcrumb-text">Cobalt Strikes Again: An Analysis of Obfuscated Malware</div></div></div><div class="blog-listing-heading-inner"><div class="landing-banner-heading blog-landing-banner-heading"><div class="breadcrumb blog-date-breadcrumb"><div class="published-text">Last Updated:</div><a href="/" class="breadcrumb-link breadcrumb-link-back">July 5, 2024</a></div><h1 class="landing-banner-heading-h1 blog">Cobalt Strikes Again: An Analysis of Obfuscated Malware</h1><div class="attribution-container"><div class="author-container"><div class="author-wrap-text">By: </div><div class="authors-wrapper w-dyn-list"><div fs-cmsnest-collection="authors" fs-cmsnest-element="template-reference" role="list" class="authors-list w-dyn-items"><div role="listitem" class="author-item w-dyn-item"><a href="/authors/matthew-brennan" class="author-link w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F614678645a7f4d4390c95f21d47ba040" loading="lazy" width="40" height="40" alt="" class="author-profile" style="width:40px;height:40px"/><div class="author-name blog-single">Matthew Brennan</div></a></div></div></div><div class="author-divider w-condition-invisible">|</div></div><div class="contributors-custom-styles w-embed"></div></div></div></div><div class="blog-listing-inner-image-wrap"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F960a09d94f2949da8eb1ff1d3096189c" loading="lazy" alt="" class="blog-listing-banner-image"/></div></div></div><div class="social-share-icon-mobile"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe499a4a7ecac4052ab9e5c194b638f16" loading="lazy" alt="Share icon"/></div></section><section class="blog-detail-content-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="eager" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-shape-8"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-glitch-2"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0658aac7c84b4f7e9a7c7b2a5b519b28" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-right-glitch"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-detail-content-wrapper"><div class="blog-main-section"><div class="post-wrapper"><div class="blog-post-summary-main"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836" loading="eager" alt="Glitch banner" class="blog-post-summary-main-glitch-top medium-zoom-image"/><div fs-richtext-sanitize="true" fs-richtext-element="rich-text" class="blog-post-summary first w-richtext"><p>How deep can a rabbit hole go? Recently, we discovered a suspicious-looking run key on a victim system. It was clear that the key was likely malicious, but it didnt seem like anything out of the ordinary.</p><p>Little did we know, we were about to encounter <a href="https://www.cobaltstrike.com/" target="_blank">Cobalt Strike</a> malware hidden across almost 700 registry values and encased within multiple layers of fileless executables.</p><p>This particular malware sample went to great lengths to hide itself, deploying numerous evasion tactics and <a href="/blog/tried-and-true-hacker-technique-dos-obfuscation" data-discover="true">obfuscation techniques</a> in order to evade detection and analysis. And as you&#x27;ll see, it goes to show the great lengths hackers will go to evade detection and compromise their targets.</p><p>Let&#x27;s dive in.</p><h2>What is Cobalt Strike?</h2><p>Cobalt Strike is a commercial threat-emulation and post-exploitation tool commonly used by malicious attackers and penetration testers to compromise and maintain access to networks. The tool uses a modular framework comprising numerous specialized modules, each responsible for a particular function within the attack chain. Some are focused on stealth and evasion, while others are focused on the silent exfiltration of corporate data.</p><p>While the intent of Cobalt Strike is to better equip legitimate red teams and pen testers with the capabilities of sophisticated threat actors, it is often misused when in the wrong hands. You know what they say... with great power comes great responsibility. Cobalt Strike is an undeniably powerful framework, but it&#x27;s easily weaponized by malicious actors as a go-to tool for undercover attacks.</p><h2>Finding Cobalt Strike Malware</h2><p>It all started with a RunOnce key, which is typically found here:</p><p>HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</p><p>This key is used to automatically execute a program when a user logs into their machine. Since this is a RunOnce key, it will automatically be deleted once it has executed. Typically, this is used by legitimate installation and update tools to resume an update after rebootbut not to resume after <em>every</em> reboot.</p><p>There are also Run keys, which dont get removed each time and are used both legitimately and maliciously to <a href="/blog/what-is-a-persistent-foothold" data-discover="true">create persistent footholds</a>between reboots.</p><p>In this particular case, we foundmultiple commands for legitimate applications contained in the RunOnce key, but there wasone that looked awfully suspicious. </p><p>We inspected the command in the suspicious key and found this, which seemed to be executing a PowerShell command stored in one users environment variables.</p><p>Looking at the command in further detail, we can note that it does the following:</p><ul><li>loads PowerShell in a hidden window</li><li>loads the environment variables of the current user</li><li>loads a value from the environment with the same name as the current user</li><li>retrieves the data from this value and uses them as arguments for the PowerShell command<br/><br/></li></ul><p>This was starting to look extremely suspicious, and we knew we had to find out what was lurking in that environment variable.</p><p>After extracting that environment variable from the machine, we found a PowerShell command, this time executing a Base64 encoded string. After decoding and cleaning up the Base64 string, it ended up looking like this:</p><h4>What Does This Script Do?</h4><p>If youre unfamiliar with PowerShell, that script may look a bit intimidating. Ultimately, the PowerShell script achieves four main things:</p><ul><li>Loads an obfuscated string that has been stored in the registry.</li><li>De-obfuscates the string and converts the result into a byte array.</li><li>Loads the byte array into memory as a DLL using PowerShell reflection (this is a common evasion technique that avoids writing a decoded payload to disk).</li><li>Executes the test method of that DLL, located in the Open object class.<br/><br/></li></ul><p>From a more technical lens, heres a line-by-line breakdown of the PowerShell script in action:</p><ul><li><strong>Lines 1-9:</strong> This section is used to pull data from some more registry keys (up to 700 of them) and stores this data in a string.</li><li><strong>Lines 10-17:</strong> This defines a function that takes that string and converts it into a byte array. This usually indicates that the string will be used to create an executable file.</li><li><strong>Lines 19-25:</strong> This section is a bit strange. It essentially generates the number 1000 and stores it into the $ko variable. It does this in a way that takes a million loop iterations to generatewhich might be an anti-analysis technique.</li><li><strong>Line 27:</strong> Loads the StringToBytes function, but first replaces any instance of the # character with the number in $ko.</li><li><strong>Line 28:</strong> Utilizes reflection to load the byte array into memory as a DLL. This avoids writing the payload to disk and is a common antivirus evasion technique.</li><li><strong>Line 29:</strong> Executes the test function of the loaded DLL.<br/><br/></li></ul><p>The <a href="/why-huntress/24-7-soc" data-discover="true">Huntress Security team</a> was able to retrieve the relevant registry values from the victim system and modify the script to dump out the payload as a file instead of loading it into memory. This resulted in our first executable payload.</p><h2>The First Binary File</h2><p>After successfully reversing that first PowerShell script, we were able to recreate the binary file that it was loading into memory. This file was a 6KB 32-bit .NET binary file.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1688px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1688px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49"/></picture></div></figure><p>Given the rather small size (only 6KB) of this file, we were suspicious that we might have missed something. The file seemed too small to contain a proper payload. We suspected that this was not the final payload and was likely a stager used to retrieve <em>another</em> payload.</p><p>Since the file was written in .NET, we were able to load it into dnSpy to analyze the source code. This is possible because .NET does not fully compile in the same way that C/C++ code does and instead compiles to an intermediary bytecode format that can be converted back into source code by tools like dnSpy.</p><p>So, we loaded the file into the dnSpy tool and were quickly able to find the Open class referenced by the PowerShell scriptwhich is where we found the following code.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1318px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1318px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2"/></picture></div></figure><p>What&#x27;s interesting is that this code seemed to be loading <em>even more</em> registry values from a suspicious registry key and resetting the RunOnce registry values that initially triggered the investigation. <strong>This allows the malware to persist across reboots as if it were a regular Run key.</strong></p><p>Our team was then able to retrieve the suspicious registry key that was being loaded from the users machine, where we found encoded data that was spread across 662 Registry values. Since the data was pre-formatted in JSON, it was simple to write a regex to dump only the relevant data to a text file. Once this was done, we were able to decode it using a simple Python scriptwhich was essentially just a wrapper around the original code used by the malware.</p><h2>The Second Binary File</h2><p>Using the output of the Python script, we were able to produce another 32-bit .NET binary file. This one was significantly larger than the first file, so we knew we were getting somewhere!</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1796px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1796px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5"/></picture></div></figure><p>Since this was another .NET file, we loaded it up into dnSpy for another round of analysis. This is where we noticed some interesting evasion and anti-analysis techniques.</p><h4>Evasion Techniques: Part One</h4><p>The first thing we noticed was numerous sleep functions scattered across the code, which would cause the program to sleep for 60 seconds between the components of its initial setup.</p><p>This technique is often used to bypass automated scanning tools that dont have the time to wait for the sleep functions to complete. It can also be used to evade manual dynamic analysis, since an analyst may falsely believe that the malware is not doing anything when its actually just taking a quick nap.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1178px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1178px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66"/></picture></div></figure><p><strong>Learn More: </strong>To dive into more defense evasion techniques, <a href="/resources/hack-it-2021" target="_blank" data-discover="true">check out our <em>Intro to Antivirus Evasion</em> session</a> from this year&#x27;s <em>hack_it</em> event!</p><h4>Obfuscation</h4><p>Deeper down in the code, we observed numerous references to functions used to perform process injection. The names of these functions were lightly obfuscated using exclamation marks, which can be seen on the right side of the below screenshot.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1000px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1000px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801"/></picture></div></figure><p>Browsing further, we find the victim process that the malware is targeting for the injection. In this case, it was the genuine (and signed) Windows Werfault.exe process.</p><p>This is a legitimate process used by the Windows OS for error reportingand it was likely targeted for two reasons:</p><ul><li>It&#x27;s a genuine and signed Windows process. These are sometimes ignored or whitelisted by detection systems. (Look up <a href="https://lolbas-project.github.io/#" target="_blank">LOLBAS</a> as to why its a terrible idea to whitelist Microsoft binaries.)</li><li>Since the Werfault.exe process performs error reporting, it may have legitimate reasons for making external network connections, meaning any malicious traffic created by the malware will have something to blend in with.</li></ul><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:900px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="900px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be"/></picture></div></figure><p>This is consistent with <a href="https://posts.specterops.io/a-deep-dive-into-cobalt-strike-malleable-c2-6660e33b0e0b" target="_blank">SpecterOps</a> usage recommendations for Cobalt Strike.</p><p>&quot;Consider choosing a binary that would not look strange making network connections.&quot;</p><p>As we continued browsing, wefound that alarge stringcontained the payload to be injected into Werfault.exe. If you look closely, you can see that it is lightly obfuscated with # values, which are later replaced with the number 1000.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7"/></picture></div></figure><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05"/></picture></div></figure><h2>The Third Binary File</h2><p>Getting closer! But this time, the data we saved as our third binary file was not a .NET, so we cant peek at the source code using dnSpy.</p><p>We are dealing with a 32-bit Delphi compiled binary, with a fake compiler timestamp dated in 1992. In case youre not familiar with Delphi, its a programming language that allows you to write, package and deploy cross-platform native applications across a number of operating systems.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1696px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1696px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7"/></picture></div></figure><h4>Evasion Techniques: Part Two</h4><p>We initially performed some basic static analysis and found that the strings within the code contained references to VirtualProtect (commonly used in process injection), but this function was not listed in the import table. This indicated that the code was likely resolving some functions at runtime, which is suspicious behaviorand yet another tactic used to evade preventive security toolsand thwart analysis.</p><p>We also noted the presence of <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress" target="_blank">GetProcAddress</a> and <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" target="_blank">LoadLibrary, which</a> further confirmed our suspicions that the file may be loading functions at runtime.</p><p>If youre not familiar, GetProcAddress is a Win32 API call often used in reflection techniques that can be used to find the memory address of a given symbol (essentially a function) at runtime. LoadLibrary is another Win32 API that loads a DLL into the context of the currently running process. These two functions combined allow a piece of malware to hide functionality from static analysis and potentially evade some basic forms of detection.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:874px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="874px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b"/></picture></div></figure><p>Loading up the file within the x32dbg debugger, we observed a large number of calls to the sleep function, which would cause the program to sleep 10 seconds between performing suspicious actions. This is yet <em>another</em> anti-analysis tactic.</p><p>After getting through the sleep calls, we finally made it to some suspicious functionsnamely some calls to VirtualAlloc and VirtualProtect.</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc" target="_blank">VirtualAlloc</a>is a Win32 API call that will allocate a section of memory that can be used later in the programs runtime. Typically, malware might allocate memory and then move malicious code (such as shellcode) into that section before executing it with another API call like CreateThread.</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect" target="_blank">VirtualProtect</a> is an API call that will change the memory protections on a given memory section, this is used to mark a section of memory as readable, writable and/or executable.</p><p>Paying close attention to suspicious functions and newly allocated sections of memory, we eventually hit a breakpoint on CreateThread, which was targeting one of the newly allocated sections of memory created by the VirtualAlloc calls. We inspected that section further and found an MZ header, indicating that we had found our fourthbinary file.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1918px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1918px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a"/></picture></div></figure><h2>The Fourth Binary File</h2><p>After dumping the newly discovered section from the debugger, and re-aligning the sections using PE-bear, we were able to retrieve a fourth binary file: a 32-bit DLL, 315KB in size.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1694px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1694px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284"/></picture></div></figure><p>Inspecting the imports of the function, we observed even more references to VirtualAlloc and VirtualProtect, indicating that more process injection was about to take place.</p><p>However, this time we noticed references to MemCpy, indicating that the process may be injecting or overwriting code into itself rather than into a separate process. Note that if this code was executing as intended, then itself would refer to the already injected Werfault.exe process.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397"/></picture></div></figure><p>A few lines below the memory imports, we see references to <a href="https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes" target="_blank">named pipe</a> functions being imported by the malware. In most cases, named pipes arelegitimatelyusedfor inter-process communication. But they are also a key component of Cobalt Strike beacons and a common tactic used to evade automated analysis as they tend to cause issues for emulation tools and automated sandboxes.</p><p>Below, we can see something else interesting: a reference to a named pipe that is highly consistent with the Default Naming Scheme of named pipes used by Cobalt Strike.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1981px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1981px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73"/></picture></div></figure><p>We wont dive too much into this, but there are a few great write-ups on this topic on the <a href="https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/" target="_blank">Cobalt Strike blog</a> and by <a href="https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/" target="_blank">F-Secure Labs</a>.</p><p>In order to confirm that this was really Cobalt Strike malware, and to try and pull more information, we parsed the file using this <a href="https://github.com/Sentinel-One/CobaltStrikeParser" target="_blank">Cobalt Strike Parser</a>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1504px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1504px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89"/></picture></div></figure><p>This worked great and confirmed our suspicions that this was Cobalt Strike.</p><p>It also allowed us to view the Cobalt Strike configuration file, which included the communication method (HTTPS POST requests) and the IP of the C2 Server.</p><p>Submitting that IP address to VirusTotal, we observed only 1/82 detections. This indicated that the server may not have been widely used, or that it was potentially still active.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1673px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1673px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139"/></picture></div></figure><h2>The Fifth Binary File</h2><p>We are <em>well</em> beyond the point of necessary analysis, but we decided to continue down this rabbit hole.</p><p>Using a debugger, we tried to monitor the buffers used by the named pipes, as they are often used to move payloads and malicious data used by Cobalt Strike.</p><p>Shortly after monitoring these buffers, we found a new file appearing in memory. Note the MZRE Header, which is part of the default configuration of Cobalt Strike.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1919px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1919px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524"/></picture></div></figure><p>Dumping out that segment, we were able to pull a fifth binary file. This time, it appeared to be the <a href="https://blog.cobaltstrike.com/2016/06/15/what-is-a-stageless-payload-artifact/" target="_blank">Reflective Loader</a> used by the Cobalt Strike Beacon. And as we loaded up the new binary, we can see that it is another 32-bit DLL, about 211KB in size.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2106px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2106px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f"/></picture></div></figure><p>Doing some basic static analysis, we saw that the file is potentially downloading a PowerShell script from localhost, indicating that theremay be a tiny web server storing PowerShell commands somewhere else in the code.</p><h2>Manually Finding Indicators of Compromise (IOCs)</h2><p>Eventually, we hit <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" target="_blank">LoadLibrary</a> again and observed the <a href="https://docs.microsoft.com/en-us/windows/win32/wininet/about-wininet" target="_blank">WinInet.DLL</a> and WS2_32.DLL module being loaded. Since these are Windows libraries used for network and web communication, we knew that the code might be about to reach out to its C2 Server.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2"/></picture></div></figure><p>We were able to set breakpoints on web-related functions, which confirmed some of the malicious indicators extracted from the Cobalt Strike parsing tool. And one thing that we noticed was that the beacon references the <a href="https://www.google.com/search?q=avant+browser&amp;oq=Avant+Browser" target="_blank">Avant Browser</a> in the user-agent of its C2 requests. This likely means that the C2 server wont respond (or will return something benign) unless it sees that header.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2168px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2168px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605"/></picture></div></figure><p>Digging deeper, we also find pieces of the <a href="https://www.cobaltstrike.com/help-malleable-c2" target="_blank">Malleable C2</a> commands used by the beacon, which in this case are embedded into HTTP cookie headers.</p><p>&amp;Cookie: Jn9f/eO8Xfay/dYKGpmuBIXL6ZpnGtPuLtugLgeU5vsP4K/bMWYy21s2ulMVQjYmUq9ClOYS8XWbLNMwPV3y10tGAbupka2lk+gbRlJntI6gPqBUl</p><p>Although it looked like the data was Base64 encoded, we were unable to extract anything meaningful from using variations of Base64 decoders.</p><p><strong>But wait  are these actually addresses?</strong></p><p>Looking at the cookie data within the dump view, we noticed that there were three valid memory addresses contained within the encoded version of the cookie data.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:858px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="858px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e"/></picture></div></figure><p>One of these referenced the ws2_32.DLL, and the other two referenced a suspicious section of memory.</p><p>Running strings on the memory sections referenced in the red underlines provided some interesting results  namely lots of information about my virtual machine that the malware was likely trying to send to the C2 server.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1200px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1200px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9"/></picture></div></figure><p>Continuing on, we noticed some more references to the C2 server and the communication methods used, as well as a reference to a full URL used by the payload.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1610px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1610px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838"/></picture></div></figure><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2068px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2068px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a"/></picture></div></figure><p>Unfortunately, we didnt have networking enabled on our test machine; so these requests all failed, causing an infinite loop where the beacon would sleep for a while and try again. If we were to enable networking, the beacon would likely download some additional payload modules and begin to truly compromise our machine. Maybe in a later article we can retrieve one of these payloads and do a deeper technical analysis of what this Cobalt Strike malware is capable of.</p><p></p><p>That wraps up our analysis of this persistence mechanism and the binary files involved. It was a wild ride, and hopefully you enjoyed reading as much as we enjoyed researching.</p><p>If there&#x27;s one lesson this should leave you with, it&#x27;s that we simply can&#x27;t<a href="/blog/what-is-human-powered-threat-hunting" data-discover="true"> rely on automated tools alone</a> to protect our systems. Through all these layers of obfuscation and evasion tactics, it&#x27;s clear just how many hoops hackers will jump through to execute their malware  and that&#x27;s why you need some type of human element to catch these sneaky threat actors in their tracks. </p><p>Well come back to this another day, but for now, this is the end of this rabbit hole.</p><p></p></div><div class="pdf-download w-condition-invisible"><a aria-label="download" href="#" class="primary-button w-condition-invisible w-dyn-bind-empty w-button"></a><a aria-label="download" href="#" class="primary-button w-condition-invisible w-dyn-bind-empty w-button"></a></div></div></div><div class="blog-line-divider mg-40 w-condition-invisible"></div><div class="blog-cta-main w-condition-invisible"><div class="blog-cta w-condition-invisible"><div id="w-node-_31878ec5-f5b2-d418-3dc8-993c0d5db453-b9c729ba" class="blog-cta-image-wrapper"><img loading="lazy" alt="Huntress social logo" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F278d55e06d4843e59195957f97b794b4" class="blog-cta-image"/></div><div id="w-node-b0b97a18-5681-c15e-4d4e-0491357856ef-b9c729ba" class="blog-cta-content"><div class="blog-cta-content-inner"><h2 class="heading-h2 w-dyn-bind-empty"></h2><a href="#" class="primary-button-2 w-button">Call to Action</a></div><div class="gradient-green-dark-blue-black"></div></div></div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdb70cb08b82e4eb6bd5023475d56f8bb" loading="lazy" alt="Blurry glitch effect" class="cta-blog-glitch _01"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd7d3c84c82874bb2b175de0162451f36" loading="lazy" alt="Glitch effect" class="cta-blog-glitch _02"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fda78b25da881485489193909ada5b685" loading="lazy" alt="Glitch effect" class="cta-blog-glitch _03"/></div><div class="blog-line-divider mg-20 w-condition-invisible"></div></div><div class="blog-sidebar"><div class="blog-sidebar-inner"><div class="blog-category-list-wrapper"><div class="category-heading">Categories<br/></div><div class="w-dyn-list"><div role="list" class="blog-category-sidebar-list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/blog-categories/threat-analysis" class="category-sidebar-item">Threat Analysis</a></div></div></div></div><div class="sidebar-cta"><h4 class="sidebar-cta-heading w-condition-invisible w-dyn-bind-empty"></h4><h4 class="sidebar-cta-heading">See Huntress in action</h4><div class="sidebar-cta-text w-condition-invisible w-dyn-bind-empty"></div><div class="sidebar-cta-text"><p>Our platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).</p></div><div class="w-condition-invisible"><a href="#" class="primary-button hero small w-button"></a></div><div><a href="/demo" class="primary-button hero small w-button" rel="  ">Book a Demo</a></div></div><div class="blog-social-icons horizontal"><div class="socials-text">Share</div><div class="social-grid horizontal"><a data-share-facebook="true" href="https://www.facebook.com/sharer/sharer.php?u=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons facebook w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c" loading="eager" alt="Facebook icon" class="social-links-icons"/></a><a data-share-twitter="true" href="https://twitter.com/share?url=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons twitter w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669" loading="eager" alt="Twitter X icon" class="social-links-icons"/></a><a data-share-linkedin="true" href="https://www.linkedin.com/shareArticle?mini=true&amp;amp;url=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons linkedin w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9" loading="eager" alt="Linkedin icon" class="social-links-icons"/></a><a data-share-reddit="true" href="http://www.reddit.com/submit?url=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons reddit w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb" loading="eager" alt="Download icon" class="social-links-icons"/></a></div></div></div></div></div></div></section></div><div class="builder-block builder-2b27cff7899944738e3b3d18be93d1f3 builder-has-component css-4hp89i" builder-id="builder-2b27cff7899944738e3b3d18be93d1f3"><section class="related-resources-section blog-related-resources-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F97d1ebf9f67945c9af2c6341e585bc21" loading="lazy" alt="Glitch effect" class="related-glitch-top-right"/><div class="w-layout-blockcontainer container-1304 w-container"><div class="related-resources-div-block"><h2 class="heading-7">You Might Also Like</h2><p class="paragraph-9"></p></div></div><div class="w-layout-blockcontainer container-1304 w-container"><div><div id="w-node-_4d86426b-a059-499f-3630-0a5865df107c-b9c729ba" class="w-dyn-list"><div role="list" class="related-resources-block-box w-dyn-items"><div role="listitem" class="flex-column w-dyn-item"><a href="/blog/the-hunt-for-redcurl-2" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="Huntress Cybersecurity" class="related-resources-box-image pos-absolute w-condition-invisible"/><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7cec99d221cc47fc945c3f1eadc23962" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">The Hunt for RedCurl</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column w-dyn-item"><a href="/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="Huntress Cybersecurity" class="related-resources-box-image pos-absolute w-condition-invisible"/><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7345981665e34e4780ff76dcd1e1714f" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">Know Thy Enemy: A Novel November Case on Persistent Remote Access</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column w-dyn-item"><a href="/blog/you-can-run-but-you-cant-hide-defender-exclusions" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="Huntress Cybersecurity" class="related-resources-box-image pos-absolute w-condition-invisible"/><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb4ebc0447fc34db1a4ca274e87f1ca92" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">You Can Run, but You Cant Hide: Defender Exclusions</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div></div></div></div></div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4c269018ce94700a59e351c5b9edb99" loading="lazy" alt="" class="related-resources-shap-1 desktop blog-related-glitch"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1aa59311842f4ca6bda70300ff181cf9" loading="lazy" alt="" class="related-resources-shap-7"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9ad6bcb77d1842b98142269ef70c4f47" loading="lazy" alt="" class="related-resources-shap-6"/></section></div><div class="builder-block builder-0f50d623022042208a513ab79514b79b builder-has-component css-4hp89i" builder-id="builder-0f50d623022042208a513ab79514b79b"><section data-w-id="f6544d89-ec66-1206-8508-b30ad6592c68" style="opacity:1;transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d" class="call-to-action-section"><div class="w-layout-blockcontainer container-width-1286 bg-container-mobile md-px-20 w-container"><div class="gradient-blue-green-2 cta-gradient-blue-green"><div class="latest-resources-feature-post"><div class="latest-resources-feature-post-description lg:pr-10"><h2 class="latest-resources-sub-heading-2 cta-latest-resources-sub-heading">Sign Up for Huntress Updates</h2><p class="paragraph-large margin-bottom-52">Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.</p><div class="w-full "><div class="_formWrap_qzntk_24"><div class=""><div class="_form_qzntk_1 pt-5 pb-0 px-0"><form id="wf-form-Blog-Signup-Form" name="wf-form-Blog-Signup-Form" data-hs-cf-bound="false" data-hubspot-form-id="5198e52f-a296-4d78-935d-fe864d69a67a" class="_formGrid_qzntk_106"><div class="_formGroup_qzntk_115 _colspan2_qzntk_129"><div class="_wrapper_1ark4_1"><input type="email" class="_input_1ark4_7" aria-invalid="false" id="email" autoComplete="email" data-snowplow-fieldname="email" data-ignore-nb="true" name="email" value=""/><label class="_label_1ark4_28">Work Email*</label></div></div><div class="_formGroup_qzntk_115 _colspan2_qzntk_129"><div class="_submitButtonRow_qzntk_133"><div><div id="cf-turnstile" style="width:300px;height:65px"></div> <div></div></div><button class="_primaryButton_1tx4z_1 _submitButton_qzntk_133 " aria-label="Submit" type="submit" id="submitButton"><div class="_buttonText_1tx4z_83">Submit</div></button></div></div><div class="_formGroup_qzntk_115 _colspan2_qzntk_129"><div class="_privacyPolicy_qzntk_182">By submitting this form, you accept our<!-- --> <a class="_noWrap_qzntk_249" href="/terms-of-use" target="_blank" data-discover="true">Terms of Service</a> <!-- -->&amp;<!-- --> <a class="_noWrap_qzntk_249" href="/privacy-policy" target="_blank" data-discover="true">Privacy Policy</a></div></div><input type="hidden" data-io-platform-fieldname="user[correlation_id]" data-snowplow-fieldname="correlation_id" name="correlation_id" value="31f1d50e-40a2-4d3d-935f-6dcdeb6fb873"/><input type="hidden" data-io-platform-fieldname="user[utm_source]" name="utm_source" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_medium]" name="utm_medium" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_campaign]" name="utm_campaign" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_content]" name="utm_content" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_keyword]" name="utm_keyword" value=""/><input type="hidden" name="page_url" value=""/><input type="hidden" name="pageUri" value=""/><input type="hidden" name="hutk" value=""/></form></div></div><div class="text-pretty md:text-balance subscribe-success-state _successState_qzntk_197 " tabindex="-1" role="region" aria-label="Schedule a demo success"><div>Thank you! Your submission has been received!</div></div><div class="text-pretty md:text-balance error-message-alt _errorMessage_qzntk_217 " tabindex="-1" role="region" aria-label="Schedule a demo failure"><div>Oops! Something went wrong while submitting the form.</div></div></div></div></div><div class="latest-resources-feature-post-image-wrapper cta-latest-resources-feature-post-image-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f" alt="Huntress at work" class="latest-resources-feature-post-image cta-latest-resources-feature-post-image"/></div></div></div></div></section></div><style data-emotion-css="191e8qc">.css-191e8qc.builder-block{height:0;width:0;display:inline-block;opacity:0;overflow:hidden;pointer-events:none;}</style><img src="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" aria-hidden="true" alt="" role="presentation" width="0" height="0" class="builder-block builder-pixel-a1u9xzhvbv css-191e8qc" builder-id="builder-pixel-a1u9xzhvbv"/></div></div></div></div></div><div><footer class="footer"><div class="w-layout-blockcontainer primary-container w-container"><div class="footer-inner-grid footer-inner-four-grid"><div data-hover="false" data-delay="0" id="w-node-_8db5101a-d165-e0e7-c7a6-e04b30595352-3059534f" data-w-id="8db5101a-d165-e0e7-c7a6-e04b30595352" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-5" aria-controls="w-dropdown-list-5" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Platform</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-5" aria-labelledby="w-dropdown-toggle-5"><a href="/platform" class="footer-nav-item" tabindex="0">Huntress Managed Security Platform</a><a href="/platform/managed-edr" aria-current="page" class="footer-nav-item w--current" tabindex="0">Managed EDR</a><a href="/platform/managed-edr-for-macos" class="footer-nav-item" tabindex="0">Managed EDR for macOS</a><a href="/platform/managed-itdr" class="footer-nav-item" tabindex="0">Managed ITDR</a><a href="/platform/siem" class="footer-nav-item" tabindex="0">Managed SIEM</a><a href="/platform/security-awareness-training" class="footer-nav-item" tabindex="0">Managed Security Awareness Training</a><a href="/demo" class="footer-nav-item" tabindex="0">Book A Demo</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059535b" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-6" aria-controls="w-dropdown-list-6" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Solutions</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-6" aria-labelledby="w-dropdown-toggle-6"><a href="/solutions/topics/phishing" class="footer-nav-item" tabindex="0">Phishing</a><a href="/solutions/topics/cybersecurity-compliance" class="footer-nav-item" tabindex="0">Compliance</a><a href="/solutions/topics/business-email-compromise" class="footer-nav-item" tabindex="0">Business Email Compromise</a><a href="/industries/education" class="footer-nav-item" tabindex="0">Education</a><a href="/industries/financial-services" class="footer-nav-item" tabindex="0">Finance</a><a href="/industries/healthcare" class="footer-nav-item" tabindex="0">Healthcare</a><a href="/industries/manufacturing" class="footer-nav-item" tabindex="0">Manufacturing</a><a href="/industries/state-and-local-government" class="footer-nav-item" tabindex="0">State &amp; Local Government</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b30595364" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-7" aria-controls="w-dropdown-list-7" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Why Huntress?</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-7" aria-labelledby="w-dropdown-toggle-7"><a href="/why-huntress/managed-service-providers" class="footer-nav-item" tabindex="0">Managed Service Providers</a><a href="/why-huntress/value-added-resellers" class="footer-nav-item" tabindex="0">Value Added Resellers</a><a href="/why-huntress/businesses-it-teams" class="footer-nav-item" tabindex="0">Business &amp; ITTeams</a><a href="/why-huntress/24-7-soc" class="footer-nav-item" tabindex="0">24/7 SOC</a><a href="/success-stories" class="footer-nav-item" tabindex="0">Case Studies</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059536d" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-8" aria-controls="w-dropdown-list-8" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Resources</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-8" aria-labelledby="w-dropdown-toggle-8"><a href="/resources" class="footer-nav-item" tabindex="0">Resource Center</a><a href="/blog" class="footer-nav-item" tabindex="0">Blog</a><a href="/upcoming-events" class="footer-nav-item" tabindex="0">Upcoming Events</a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="footer-nav-item" tabindex="0">Support Documentation</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059537c" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-9" aria-controls="w-dropdown-list-9" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">About</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-9" aria-labelledby="w-dropdown-toggle-9"><a href="/company/our-company" class="footer-nav-item" tabindex="0">Our Company</a><a href="/company/leadership" class="footer-nav-item" tabindex="0">Leadership</a><a href="/company/press" class="footer-nav-item" tabindex="0">News &amp; Press</a><a href="/company/careers" class="footer-nav-item" tabindex="0">Careers</a><a href="/contact-us" class="footer-nav-item" tabindex="0">Contact Us</a></nav></div></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059538b-3059534f" class="footer-gradient-line"></div><div class="footer-copyright-grid"><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059538d-3059534f" class="fcg-col"><a href="/" class="footer-brand w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b2e3c89b5046b89682ef20ccb7218d" loading="lazy" alt="Hunteress white logo"/></a></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b30595390-3059534f" class="fcg-col md-order-2"><div class="extra-small-paragraph"> 2025 Huntress All Rights Reserved.</div><div class="fcg-cta-group"><a href="/privacy-policy" target="_blank" class="fcg-cta">Privacy Policy</a><div class="fcg-seperator">|</div><a href="/cookie-policy" target="_blank" class="fcg-cta">Cookie Policy</a><div class="fcg-seperator">|</div><a href="/terms-of-use" target="_blank" class="fcg-cta">Terms of Use</a></div></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059539a-3059534f" class="fcg-col md-order-3"><a id="free_trial_footer_button" href="/start-trial" class="primary-button footer-cta w-button">Free Trial</a></div></div></div></footer></div><script>((storageKey2, restoreKey) => {
    if (!window.history.state || !window.history.state.key) {
      let key = Math.random().toString(32).slice(2);
      window.history.replaceState({ key }, "");
    }
    try {
      let positions = JSON.parse(sessionStorage.getItem(storageKey2) || "{}");
      let storedY = positions[restoreKey || window.history.state.key];
      if (typeof storedY === "number") {
        window.scrollTo(0, storedY);
      }
    } catch (error) {
      console.error(error);
      sessionStorage.removeItem(storageKey2);
    }
  })("react-router-scroll-positions", null)</script><script>window.__reactRouterContext = {"basename":"/","future":{"unstable_optimizeDeps":false,"unstable_splitRouteModules":false,"unstable_viteEnvironmentApi":false},"ssr":true,"isSpaMode":false};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());</script><script type="module" async="">;
import * as route0 from "/assets/root-DxiQAKzj.js";
import * as route1 from "/assets/blog._slug-CFRz3pg3.js";
  window.__reactRouterManifest = {
  "entry": {
    "module": "/assets/entry.client-m4_Zd7NT.js",
    "imports": [
      "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
      "/assets/index-DqyGAN61.js"
    ],
    "css": []
  },
  "routes": {
    "root": {
      "id": "root",
      "path": "",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": true,
      "module": "/assets/root-DxiQAKzj.js",
      "imports": [
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/index-DqyGAN61.js",
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/snowplow.tracker-OcujGbXE.js"
      ],
      "css": [
        "/assets/root-DOhbAGIK.css",
        "/assets/snowplow-BwfoH6KX.css"
      ]
    },
    "routes/blog.$slug": {
      "id": "routes/blog.$slug",
      "parentId": "root",
      "path": "blog/:slug",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._slug-CFRz3pg3.js",
      "imports": [
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/snowplow.tracker-OcujGbXE.js",
        "/assets/metadata-Dts9WTeE.js",
        "/assets/index-DqyGAN61.js"
      ],
      "css": [
        "/assets/snowplow-BwfoH6KX.css",
        "/assets/metadata-DeWOA2Zs.css"
      ]
    },
    "routes/($slug)._index": {
      "id": "routes/($slug)._index",
      "parentId": "root",
      "path": ":slug?",
      "index": true,
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": false,
      "module": "/assets/(_slug)._index-YrmLJr_L.js",
      "imports": [
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/snowplow.tracker-OcujGbXE.js",
        "/assets/metadata-Dts9WTeE.js",
        "/assets/index-DqyGAN61.js"
      ],
      "css": [
        "/assets/snowplow-BwfoH6KX.css",
        "/assets/metadata-DeWOA2Zs.css"
      ]
    },
    "routes/blog._index": {
      "id": "routes/blog._index",
      "parentId": "root",
      "path": "blog",
      "index": true,
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._index-CUrtwdwI.js",
      "imports": [
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/snowplow.tracker-OcujGbXE.js",
        "/assets/metadata-Dts9WTeE.js",
        "/assets/index-DqyGAN61.js"
      ],
      "css": [
        "/assets/snowplow-BwfoH6KX.css",
        "/assets/metadata-DeWOA2Zs.css"
      ]
    }
  },
  "url": "/assets/manifest-59e425ad.js",
  "version": "59e425ad"
};
  window.__reactRouterRouteModules = {"root":route0,"routes/blog.$slug":route1};

import("/assets/entry.client-m4_Zd7NT.js");</script><!--$?--><template id="B:0"></template><!--/$--><div hidden id="S:0"><script>window.__reactRouterContext.streamController.enqueue("[{\"_1\":2,\"_328\":-5,\"_329\":-5},\"loaderData\",{\"_3\":-7,\"_4\":5},\"root\",\"routes/blog.$slug\",{\"_6\":7,\"_158\":177,\"_306\":307,\"_326\":327},\"page\",{\"_8\":9,\"_10\":11,\"_12\":13,\"_14\":15,\"_16\":17,\"_18\":18,\"_19\":20,\"_34\":35,\"_45\":46,\"_161\":162,\"_163\":164,\"_165\":11,\"_166\":167,\"_168\":169,\"_170\":171,\"_172\":171,\"_173\":174,\"_175\":176},\"folders\",[],\"createdDate\",1737878646725,\"id\",\"65f3299e49a461b4b9c729ba\",\"name\",\"Blog Post\",\"modelId\",\"3fa669f9656b425bbe84446dd9c5a7cd\",\"published\",\"meta\",{\"_21\":6,\"_22\":23,\"_24\":25,\"_32\":33},\"kind\",\"lastPreviewUrl\",\"https://staging.huntress.com/blog/(slug)?builder.space=3eb6f92aedf74f109c7b4b0897ec39a8\u0026builder.user.permissions=read%2Ccreate%2Cpublish%2CeditCode%2CeditDesigns%2Cadmin%2CeditLayouts%2CeditLayers%2CeditContentPriority\u0026builder.user.role.name=Admin\u0026builder.user.role.id=admin\u0026builder.cachebust=true\u0026builder.preview=page\u0026builder.noCache=true\u0026builder.allowTextEdit=true\u0026__builder_editing__=true\u0026builder.overrides.page=65f3299e49a461b4b9c729ba\u0026builder.overrides.65f3299e49a461b4b9c729ba=65f3299e49a461b4b9c729ba\u0026builder.overrides.page:/blog/(slug)=65f3299e49a461b4b9c729ba\u0026builder.options.includeRefs=true\u0026builder.options.enrich=true\",\"breakpoints\",{\"_26\":27,\"_28\":29,\"_30\":31},\"xsmall\",479,\"small\",767,\"medium\",991,\"hasLinks\",false,\"query\",[36],{\"_37\":38,\"_39\":40,\"_41\":42,\"_43\":44},\"@type\",\"@builder.io/core:Query\",\"property\",\"urlPath\",\"operator\",\"is\",\"value\",\"/blog/(slug)\",\"data\",{\"_47\":48,\"_49\":48,\"_50\":51,\"_52\":48,\"_53\":48,\"_54\":44,\"_55\":48,\"_56\":48,\"_57\":48,\"_58\":59,\"_150\":151},\"title\",\"\",\"slug\",\"templateDataModel\",\"blog-posts\",\"description\",\"openGraphDescription\",\"url\",\"titleTag\",\"metaDescription\",\"openGraphTitle\",\"blocks\",[60,94,103,127],{\"_37\":61,\"_62\":63,\"_12\":64,\"_65\":66,\"_80\":81},\"@builder.io/sdk:Element\",\"@version\",2,\"builder-ddebc027a2b547be8bb340dc4719efa5\",\"component\",{\"_14\":67,\"_68\":69},\"BlogBannerSection\",\"options\",{\"_70\":71,\"_72\":73,\"_74\":75,\"_76\":77,\"_78\":79},\"_data\",\"hunting-for-m365-password-spraying\",\"SidebarCtaHeading\",\"See Huntress in action\",\"SidebarCtaText\",\"\u003cp\u003eOur platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).\u003c/p\u003e\",\"SidebarCtaButtonText\",\"Book a Demo\",\"SidebarCtaButtonUrl\",\"/demo\",\"responsiveStyles\",{\"_82\":83},\"large\",{\"_84\":85,\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93},\"display\",\"flex\",\"flexDirection\",\"column\",\"position\",\"relative\",\"flexShrink\",\"0\",\"boxSizing\",\"border-box\",{\"_37\":61,\"_62\":63,\"_12\":95,\"_65\":96,\"_80\":101},\"builder-2b27cff7899944738e3b3d18be93d1f3\",{\"_14\":97,\"_68\":98},\"BlogRelatedResourcesSection\",{\"_99\":100},\"heading\",\"You Might Also Like\",{\"_82\":102},{\"_84\":85,\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93},{\"_37\":61,\"_62\":63,\"_12\":104,\"_65\":105,\"_80\":125},\"builder-0f50d623022042208a513ab79514b79b\",{\"_14\":106,\"_68\":107},\"BlogSignupSection\",{\"_99\":108,\"_109\":110,\"_111\":112,\"_113\":114},\"Sign Up for Huntress Updates\",\"summary\",\"Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.\",\"image\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f\",\"blogSignupForm\",{\"_115\":116,\"_117\":33,\"_118\":119,\"_120\":121,\"_122\":33,\"_123\":33,\"_124\":33},\"formId\",\"wf-form-Blog-Signup-Form\",\"showFormTitle\",\"submitButtonText\",\"Submit\",\"hubspotFormId\",\"5198e52f-a296-4d78-935d-fe864d69a67a\",\"showBlueGreenGradient\",\"showBluePurpleGradient\",\"useNeverBounce\",{\"_82\":126},{\"_84\":85,\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93},{\"_12\":128,\"_37\":61,\"_129\":130,\"_131\":132,\"_80\":142},\"builder-pixel-a1u9xzhvbv\",\"tagName\",\"img\",\"properties\",{\"_133\":134,\"_135\":136,\"_137\":48,\"_138\":139,\"_140\":91,\"_141\":91},\"src\",\"https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8\",\"aria-hidden\",\"true\",\"alt\",\"role\",\"presentation\",\"width\",\"height\",{\"_82\":143},{\"_141\":91,\"_140\":91,\"_84\":144,\"_145\":91,\"_146\":147,\"_148\":149},\"inline-block\",\"opacity\",\"overflow\",\"hidden\",\"pointerEvents\",\"none\",\"state\",{\"_152\":82,\"_153\":154},\"deviceSize\",\"location\",{\"_155\":44,\"_156\":157,\"_34\":160},\"pathname\",\"path\",[158,159],\"blog\",\"(slug)\",{},\"variations\",{},\"lastUpdated\",1741588976692,\"firstPublished\",\"testRatio\",1,\"screenshot\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F42ecb2c04afd4f21884c74eac157f836\",\"createdBy\",\"Kz459QsZDzNpORbTSiA9L6WRQc23\",\"lastUpdatedBy\",\"rev\",\"r63rxa2j8a\",\"template\",\"huntress\",{\"_12\":178,\"_14\":179,\"_18\":18,\"_10\":180,\"_16\":181,\"_45\":182,\"_173\":305},\"65f3299e49a461b4b9c72e1c\",\"Cobalt Strikes Again: An Analysis of Obfuscated Malware\",1742717161586,\"beafe50240af45639f2b59e6aefd89f9\",{\"_14\":179,\"_49\":183,\"_184\":185,\"_190\":191,\"_192\":193,\"_194\":195,\"_196\":197,\"_269\":270,\"_289\":290,\"_300\":301,\"_302\":33,\"_303\":304},\"cobalt-strike-analysis-of-obfuscated-malware\",\"metadata\",{\"_47\":186,\"_52\":187,\"_188\":33,\"_189\":33},\"Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress\",\"Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values.\",\"noIndex\",\"noFollow\",\"canonicalUrl\",\"https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware\",\"publishDate\",\"May 25, 2021\",\"lastUpdatedDate\",\"July 5, 2024\",\"authors\",[198],{\"_199\":200},\"author\",{\"_37\":201,\"_12\":202,\"_203\":204,\"_43\":205},\"@builder.io/core:Reference\",\"66048bf6ebfd6c83c4752c57\",\"model\",\"people\",{\"_34\":206,\"_8\":207,\"_10\":208,\"_12\":202,\"_14\":209,\"_16\":210,\"_18\":18,\"_19\":211,\"_45\":213,\"_161\":265,\"_163\":266,\"_165\":208,\"_166\":167,\"_170\":267,\"_172\":267,\"_173\":268},[],[],1742719356233,\"Matthew Brennan\",\"d50b5ec346a64579b280b4104dca236e\",{\"_24\":212,\"_21\":45,\"_22\":48},{\"_26\":27,\"_28\":29,\"_30\":31},{\"_214\":215,\"_216\":-5,\"_14\":209,\"_49\":217,\"_218\":219,\"_220\":221,\"_184\":222,\"_225\":226,\"_227\":228,\"_263\":264},\"linkedInUrl\",\"https://www.linkedin.com/in/matthew-brennan-69b96bb9/\",\"profileImageAltText\",\"matthew-brennan\",\"bioDetail\",\"\u003cp id=\\\"\\\"\u003eMalware Enthusiast. Appreciator of Burritos. Former Detection Engineer at Huntress.\u003c/p\u003e\u003cp id=\\\"\\\"\u003e\u003c/p\u003e\",\"companyName\",\"Embee Research\",{\"_47\":223,\"_188\":33,\"_189\":33,\"_52\":224},\"Matthew Brennan | Huntress\",\"Read blog posts from Matthew Brennan on the Huntress Blog.\",\"jobTitle\",\"Security Researcher \u0026 Technical Writer\",\"groups\",[229,248],{\"_230\":231},\"group\",{\"_37\":201,\"_12\":232,\"_203\":227,\"_43\":233},\"00d1d80145b14a6b87c45567b169a8f4\",{\"_34\":234,\"_8\":235,\"_10\":236,\"_12\":232,\"_14\":237,\"_16\":238,\"_18\":18,\"_19\":239,\"_45\":243,\"_161\":244,\"_163\":245,\"_165\":246,\"_166\":167,\"_170\":171,\"_172\":171,\"_173\":247},[],[],1735687100903,\"Authors\",\"8749400659754b178d5088546f7b2f6f\",{\"_24\":240,\"_21\":45,\"_22\":48},{\"_28\":241,\"_30\":242},478,1023,{\"_14\":237},{},1735687106469,1735687106464,\"bel1w2w09qa\",{\"_230\":249},{\"_37\":201,\"_12\":250,\"_203\":227,\"_43\":251},\"babc0d8823f34ab894a4431d5b302dc7\",{\"_34\":252,\"_8\":253,\"_10\":254,\"_12\":250,\"_14\":255,\"_16\":238,\"_18\":18,\"_19\":256,\"_45\":258,\"_161\":259,\"_163\":260,\"_165\":261,\"_166\":167,\"_170\":171,\"_172\":171,\"_173\":262},[],[],1742334085525,\"Speakers\",{\"_24\":257,\"_21\":45,\"_22\":48},{\"_26\":27,\"_28\":29,\"_30\":31},{\"_14\":255},{},1742334347573,1742334347569,\"9zuifxvjrgw\",\"profileImage\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F614678645a7f4d4390c95f21d47ba040\",{},1742758868932,\"XBN8lOXr7QMH6JvQimte3OCtO6c2\",\"ro1tip94ke\",\"categories\",[271],{\"_272\":273},\"category\",{\"_37\":201,\"_12\":274,\"_203\":275,\"_43\":276},\"65f3299e49a461b4b9c72e31\",\"blog-categories\",{\"_12\":274,\"_14\":277,\"_18\":18,\"_10\":278,\"_16\":279,\"_45\":280,\"_173\":288},\"Threat Analysis\",1739997400726,\"b7b51689bde4424484bccde4b9ee6d6b\",{\"_14\":277,\"_49\":281,\"_184\":282,\"_285\":283,\"_56\":284,\"_190\":286,\"_52\":287},\"threat-analysis\",{\"_47\":283,\"_52\":284},\"Threat Analysis Blog Posts | Huntress\",\"Read our Threat Analyses in these Huntress blog posts. \",\"metaTitle\",\"https://www.huntress.com/blog-categories/threat-analysis\",\"\u003cp\u003eDive in and nerd out with us on current and emerging cybersecurity threats. We cover attack vectors, threat actors, and new vulnerabilities, providing insights to help you understand and counteract these risks.\u003c/p\u003e\",\"k1hv911ank\",\"tags\",[291],{\"_292\":293},\"tag\",{\"_37\":201,\"_12\":294,\"_203\":289,\"_43\":295},\"65f3299e49a461b4b9c72e5a\",{\"_12\":294,\"_14\":277,\"_18\":18,\"_10\":296,\"_16\":297,\"_45\":298,\"_173\":299},1741825543263,\"06a1fff4f2d64eed986229acc010c74f\",{\"_14\":277},\"e0m46zvy2oi\",\"content\",\"\u003cp\u003eHow deep can a rabbit hole go? Recently, we discovered a suspicious-looking run key on a victim system. It was clear that the key was likely malicious, but it didnt seem like anything out of the ordinary.\u003c/p\u003e\u003cp\u003eLittle did we know, we were about to encounter \u003ca href=\\\"https://www.cobaltstrike.com/\\\" target=\\\"_blank\\\"\u003eCobalt Strike\u003c/a\u003e malware hidden across almost 700 registry values and encased within multiple layers of fileless executables.\u003c/p\u003e\u003cp\u003eThis particular malware sample went to great lengths to hide itself, deploying numerous evasion tactics and \u003ca href=\\\"/blog/tried-and-true-hacker-technique-dos-obfuscation\\\"\u003eobfuscation techniques\u003c/a\u003e in order to evade detection and analysis. And as you'll see, it goes to show the great lengths hackers will go to evade detection and compromise their targets.\u0026nbsp;\u003c/p\u003e\u003cp\u003eLet's dive in.\u003c/p\u003e\u003ch2\u003eWhat is Cobalt Strike?\u003c/h2\u003e\u003cp\u003eCobalt Strike is a commercial threat-emulation and post-exploitation tool commonly used by malicious attackers and penetration testers to compromise and maintain access to networks. The tool uses a modular framework comprising numerous specialized modules, each responsible for a particular function within the attack chain. Some are focused on stealth and evasion, while others are focused on the silent exfiltration of corporate data.\u003c/p\u003e\u003cp\u003eWhile the intent of Cobalt Strike is to better equip legitimate red teams and pen testers with the capabilities of sophisticated threat actors, it is often misused when in the wrong hands. You know what they say... with great power comes great responsibility. Cobalt Strike is an undeniably powerful framework, but it's easily weaponized by malicious actors as a go-to tool for undercover attacks.\u003c/p\u003e\u003ch2\u003eFinding Cobalt Strike Malware\u003c/h2\u003e\u003cp\u003eIt all started with a RunOnce key, which is typically found here:\u003c/p\u003e\u003cp\u003eHKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\u003c/p\u003e\u003cp\u003eThis key is used to automatically execute a program when a user logs into their machine. Since this is a RunOnce key, it will automatically be deleted once it has executed. Typically, this is used by legitimate installation and update tools to resume an update after rebootbut not to resume after \u003cem\u003eevery\u003c/em\u003e reboot.\u003c/p\u003e\u003cp\u003eThere are also Run keys, which dont get removed each time and are used both legitimately and maliciously to \u003ca href=\\\"/blog/what-is-a-persistent-foothold\\\"\u003ecreate persistent footholds\u003c/a\u003e\u0026nbsp;between reboots.\u003c/p\u003e\u003cp\u003eIn this particular case, we found\u0026nbsp;multiple commands for legitimate applications contained in the RunOnce key, but there was\u0026nbsp;one that looked awfully suspicious. \u003c/p\u003e\u003cp\u003eWe inspected the command in the suspicious key and found this, which seemed to be executing a PowerShell command stored in one users environment variables.\u003c/p\u003e\u003cp\u003eLooking at the command in further detail, we can note that it does the following:\u003c/p\u003e\u003cul\u003e\u003cli\u003eloads PowerShell in a hidden window\u003c/li\u003e\u003cli\u003eloads the environment variables of the current user\u003c/li\u003e\u003cli\u003eloads a value from the environment with the same name as the current user\u003c/li\u003e\u003cli\u003eretrieves the data from this value and uses them as arguments for the PowerShell command\u003cbr\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThis was starting to look extremely suspicious, and we knew we had to find out what was lurking in that environment variable.\u003c/p\u003e\u003cp\u003eAfter extracting that environment variable from the machine, we found a PowerShell command, this time executing a Base64 encoded string. After decoding and cleaning up the Base64 string, it ended up looking like this:\u003c/p\u003e\u003ch4\u003eWhat Does This Script Do?\u003c/h4\u003e\u003cp\u003eIf youre unfamiliar with PowerShell, that script may look a bit intimidating. Ultimately, the PowerShell script achieves four main things:\u003c/p\u003e\u003cul\u003e\u003cli\u003eLoads an obfuscated string that has been stored in the registry.\u003c/li\u003e\u003cli\u003eDe-obfuscates the string and converts the result into a byte array.\u003c/li\u003e\u003cli\u003eLoads the byte array into memory as a DLL using PowerShell reflection (this is a common evasion technique that avoids writing a decoded payload to disk).\u003c/li\u003e\u003cli\u003eExecutes the test method of that DLL, located in the Open object class.\u003cbr\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eFrom a more technical lens, heres a line-by-line breakdown of the PowerShell script in action:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eLines 1-9:\u003c/strong\u003e This section is used to pull data from some more registry keys (up to 700 of them) and stores this data in a string.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLines 10-17:\u003c/strong\u003e This defines a function that takes that string and converts it into a byte array. This usually indicates that the string will be used to create an executable file.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLines 19-25:\u003c/strong\u003e This section is a bit strange. It essentially generates the number 1000 and stores it into the $ko variable. It does this in a way that takes a million loop iterations to generatewhich might be an anti-analysis technique.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLine 27:\u003c/strong\u003e Loads the StringToBytes function, but first replaces any instance of the # character with the number in $ko.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLine 28:\u003c/strong\u003e Utilizes reflection to load the byte array into memory as a DLL. This avoids writing the payload to disk and is a common antivirus evasion technique.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLine 29:\u003c/strong\u003e Executes the test function of the loaded DLL.\u003cbr\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe \u003ca href=\\\"/why-huntress/24-7-soc\\\"\u003eHuntress Security team\u003c/a\u003e was able to retrieve the relevant registry values from the victim system and modify the script to dump out the payload as a file instead of loading it into memory. This resulted in our first executable payload.\u003c/p\u003e\u003ch2\u003eThe First Binary File\u003c/h2\u003e\u003cp\u003eAfter successfully reversing that first PowerShell script, we were able to recreate the binary file that it was loading into memory. This file was a 6KB 32-bit .NET binary file.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1688px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1688px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49\\\" alt=\\\"Binary File 1\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eGiven the rather small size (only 6KB) of this file, we were suspicious that we might have missed something. The file seemed too small to contain a proper payload. We suspected that this was not the final payload and was likely a stager used to retrieve \u003cem\u003eanother\u003c/em\u003e payload.\u003c/p\u003e\u003cp\u003eSince the file was written in .NET, we were able to load it into dnSpy to analyze the source code. This is possible because .NET does not fully compile in the same way that C/C++ code does and instead compiles to an intermediary bytecode format that can be converted back into source code by tools like dnSpy.\u003c/p\u003e\u003cp\u003eSo, we loaded the file into the dnSpy tool and were quickly able to find the Open class referenced by the PowerShell scriptwhich is where we found the following code.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1318px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1318px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2\\\" alt=\\\"Run Key\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWhat's interesting is that this code seemed to be loading \u003cem\u003eeven more\u003c/em\u003e registry values from a suspicious registry key and resetting the RunOnce registry values that initially triggered the investigation. \u003cstrong\u003eThis allows the malware to persist across reboots as if it were a regular Run key.\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eOur team was then able to retrieve the suspicious registry key that was being loaded from the users machine, where we found encoded data that was spread across 662 Registry values. Since the data was pre-formatted in JSON, it was simple to write a regex to dump only the relevant data to a text file. Once this was done, we were able to decode it using a simple Python scriptwhich was essentially just a wrapper around the original code used by the malware.\u003c/p\u003e\u003ch2\u003eThe Second Binary File\u003c/h2\u003e\u003cp\u003eUsing the output of the Python script, we were able to produce another 32-bit .NET binary file. This one was significantly larger than the first file, so we knew we were getting somewhere!\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1796px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1796px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5\\\" alt=\\\"Second Binary\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eSince this was another .NET file, we loaded it up into dnSpy for another round of analysis. This is where we noticed some interesting evasion and anti-analysis techniques.\u003c/p\u003e\u003ch4\u003eEvasion Techniques: Part One\u003c/h4\u003e\u003cp\u003eThe first thing we noticed was numerous sleep functions scattered across the code, which would cause the program to sleep for 60 seconds between the components of its initial setup.\u003c/p\u003e\u003cp\u003eThis technique is often used to bypass automated scanning tools that dont have the time to wait for the sleep functions to complete. It can also be used to evade manual dynamic analysis, since an analyst may falsely believe that the malware is not doing anything when its actually just taking a quick nap.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1178px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1178px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66\\\" alt=\\\"Dynamic Analysis\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u003cstrong\u003eLearn More: \u003c/strong\u003eTo dive into more defense evasion techniques, \u003ca href=\\\"/resources/hack-it-2021\\\" target=\\\"_blank\\\"\u003echeck out our \u003cem\u003eIntro to Antivirus Evasion\u003c/em\u003e session\u003c/a\u003e from this year's \u003cem\u003ehack_it\u003c/em\u003e event!\u003c/p\u003e\u003ch4\u003eObfuscation\u003c/h4\u003e\u003cp\u003eDeeper down in the code, we observed numerous references to functions used to perform process injection. The names of these functions were lightly obfuscated using exclamation marks, which can be seen on the right side of the below screenshot.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1000px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1000px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801\\\" alt=\\\"Obfuscated\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eBrowsing further, we find the victim process that the malware is targeting for the injection. In this case, it was the genuine (and signed) Windows Werfault.exe process.\u003c/p\u003e\u003cp\u003eThis is a legitimate process used by the Windows OS for error reportingand it was likely targeted for two reasons:\u003c/p\u003e\u003cul\u003e\u003cli\u003eIt's a genuine and signed Windows process. These are sometimes ignored or whitelisted by detection systems. (Look up \u003ca href=\\\"https://lolbas-project.github.io/#\\\" target=\\\"_blank\\\"\u003eLOLBAS\u003c/a\u003e as to why its a terrible idea to whitelist Microsoft binaries.)\u003c/li\u003e\u003cli\u003eSince the Werfault.exe process performs error reporting, it may have legitimate reasons for making external network connections, meaning any malicious traffic created by the malware will have something to blend in with.\u003c/li\u003e\u003c/ul\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:900px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"900px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be\\\" alt=\\\"Traffic\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThis is consistent with \u003ca href=\\\"https://posts.specterops.io/a-deep-dive-into-cobalt-strike-malleable-c2-6660e33b0e0b\\\" target=\\\"_blank\\\"\u003eSpecterOps\u003c/a\u003e usage recommendations for Cobalt Strike.\u003c/p\u003e\u003cp\u003e\\\"Consider choosing a binary that would not look strange making network connections.\\\"\u003c/p\u003e\u003cp\u003eAs we continued browsing, we\u0026nbsp;found that a\u0026nbsp;large string\u0026nbsp;contained the payload to be injected into Werfault.exe. If you look closely, you can see that it is lightly obfuscated with # values, which are later replaced with the number 1000.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7\\\" alt=\\\"Values\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05\\\" alt=\\\"continued browsing\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch2\u003eThe Third Binary File\u003c/h2\u003e\u003cp\u003eGetting closer! But this time, the data we saved as our third binary file was not a .NET, so we cant peek at the source code using dnSpy.\u003c/p\u003e\u003cp\u003eWe are dealing with a 32-bit Delphi compiled binary, with a fake compiler timestamp dated in 1992. In case youre not familiar with Delphi, its a programming language that allows you to write, package and deploy cross-platform native applications across a number of operating systems.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1696px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1696px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7\\\" alt=\\\"Delphi\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch4\u003eEvasion Techniques: Part Two\u003c/h4\u003e\u003cp\u003eWe initially performed some basic static analysis and found that the strings within the code contained references to VirtualProtect (commonly used in process injection), but this function was not listed in the import table. This indicated that the code was likely resolving some functions at runtime, which is suspicious behaviorand yet another tactic used to evade preventive security tools\u0026nbsp;and thwart analysis.\u003c/p\u003e\u003cp\u003eWe also noted the presence of \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress\\\" target=\\\"_blank\\\"\u003eGetProcAddress\u003c/a\u003e and \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya\\\" target=\\\"_blank\\\"\u003eLoadLibrary, which\u003c/a\u003e further confirmed our suspicions that the file may be loading functions at runtime.\u003c/p\u003e\u003cp\u003eIf youre not familiar, GetProcAddress is a Win32 API call often used in reflection techniques that can be used to find the memory address of a given symbol (essentially a function) at runtime. LoadLibrary is another Win32 API that loads a DLL into the context of the currently running process. These two functions combined allow a piece of malware to hide functionality from static analysis and potentially evade some basic forms of detection.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:874px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"874px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b\\\" alt=\\\"Debugger3\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eLoading up the file within the x32dbg debugger, we observed a large number of calls to the sleep function, which would cause the program to sleep 10 seconds between performing suspicious actions. This is yet \u003cem\u003eanother\u003c/em\u003e anti-analysis tactic.\u003c/p\u003e\u003cp\u003eAfter getting through the sleep calls, we finally made it to some suspicious functionsnamely some calls to VirtualAlloc and VirtualProtect.\u003c/p\u003e\u003cp\u003e\u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc\\\" target=\\\"_blank\\\"\u003eVirtualAlloc\u003c/a\u003e\u0026nbsp;is a Win32 API call that will allocate a section of memory that can be used later in the programs runtime. Typically, malware might allocate memory and then move malicious code (such as shellcode) into that section before executing it with another API call like CreateThread.\u003c/p\u003e\u003cp\u003e\u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect\\\" target=\\\"_blank\\\"\u003eVirtualProtect\u003c/a\u003e is an API call that will change the memory protections on a given memory section, this is used to mark a section of memory as readable, writable and/or executable.\u003c/p\u003e\u003cp\u003ePaying close attention to suspicious functions and newly allocated sections of memory, we eventually hit a breakpoint on CreateThread, which was targeting one of the newly allocated sections of memory created by the VirtualAlloc calls. We inspected that section further and found an MZ header, indicating that we had found our fourth\u0026nbsp;binary file.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1918px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1918px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a\\\" alt=\\\"Debugger5\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch2\u003eThe Fourth Binary File\u003c/h2\u003e\u003cp\u003eAfter dumping the newly discovered section from the debugger, and re-aligning the sections using PE-bear, we were able to retrieve a fourth binary file: a 32-bit DLL, 315KB in size.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1694px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1694px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284\\\" alt=\\\"Fourth Binary\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eInspecting the imports of the function, we observed even more references to VirtualAlloc and VirtualProtect, indicating that more process injection was about to take place.\u003c/p\u003e\u003cp\u003eHowever, this time we noticed references to MemCpy, indicating that the process may be injecting or overwriting code into itself rather than into a separate process. Note that if this code was executing as intended, then itself would refer to the already injected Werfault.exe process.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397\\\" alt=\\\"Binary4_2\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eA few lines below the memory imports, we see references to \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes\\\" target=\\\"_blank\\\"\u003enamed pipe\u003c/a\u003e functions being imported by the malware. In most cases, named pipes are\u0026nbsp;legitimately\u0026nbsp;used\u0026nbsp;for inter-process communication. But they are also a key component of Cobalt Strike beacons and a common tactic used to evade automated analysis as they tend to cause issues for emulation tools and automated sandboxes.\u003c/p\u003e\u003cp\u003eBelow, we can see something else interesting: a reference to a named pipe that is highly consistent with the Default Naming Scheme of named pipes used by Cobalt Strike.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1981px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1981px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73\\\" alt=\\\"Binary 4_4\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWe wont dive too much into this, but there are a few great write-ups on this topic on the \u003ca href=\\\"https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/\\\" target=\\\"_blank\\\"\u003eCobalt Strike blog\u003c/a\u003e and by \u003ca href=\\\"https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/\\\" target=\\\"_blank\\\"\u003eF-Secure Labs\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eIn order to confirm that this was really Cobalt Strike malware, and to try and pull more information, we parsed the file using this \u003ca href=\\\"https://github.com/Sentinel-One/CobaltStrikeParser\\\" target=\\\"_blank\\\"\u003eCobalt Strike Parser\u003c/a\u003e.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1504px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1504px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89\\\" alt=\\\"Binary 4_5\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThis worked great and confirmed our suspicions that this was Cobalt Strike.\u003c/p\u003e\u003cp\u003eIt also allowed us to view the Cobalt Strike configuration file, which included the communication method (HTTPS POST requests) and the IP of the C2 Server.\u003c/p\u003e\u003cp\u003eSubmitting that IP address to VirusTotal, we observed only 1/82 detections. This indicated that the server may not have been widely used, or that it was potentially still active.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1673px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1673px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139\\\" alt=\\\"Binary 4_6\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch2\u003eThe Fifth Binary File\u003c/h2\u003e\u003cp\u003eWe are \u003cem\u003ewell\u003c/em\u003e beyond the point of necessary analysis, but we decided to continue down this rabbit hole.\u003c/p\u003e\u003cp\u003eUsing a debugger, we tried to monitor the buffers used by the named pipes, as they are often used to move payloads and malicious data used by Cobalt Strike.\u003c/p\u003e\u003cp\u003eShortly after monitoring these buffers, we found a new file appearing in memory. Note the MZRE Header, which is part of the default configuration of Cobalt Strike.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1919px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1919px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524\\\" alt=\\\"Binary 5_1\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDumping out that segment, we were able to pull a fifth binary file. This time, it appeared to be the \u003ca href=\\\"https://blog.cobaltstrike.com/2016/06/15/what-is-a-stageless-payload-artifact/\\\" target=\\\"_blank\\\"\u003eReflective Loader\u003c/a\u003e used by the Cobalt Strike Beacon. And as we loaded up the new binary, we can see that it is another 32-bit DLL, about 211KB in size.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2106px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2106px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f\\\" alt=\\\"Binary 5_2\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDoing some basic static analysis, we saw that the file is potentially downloading a PowerShell script from localhost, indicating that there\u0026nbsp;may be a tiny web server storing PowerShell commands somewhere else in the code.\u003c/p\u003e\u003ch2\u003eManually Finding Indicators of Compromise (IOCs)\u003c/h2\u003e\u003cp\u003eEventually, we hit \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya\\\" target=\\\"_blank\\\"\u003eLoadLibrary\u003c/a\u003e again and observed the \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/wininet/about-wininet\\\" target=\\\"_blank\\\"\u003eWinInet.DLL\u003c/a\u003e and WS2_32.DLL module being loaded. Since these are Windows libraries used for network and web communication, we knew that the code might be about to reach out to its C2 Server.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2\\\" alt=\\\"looks like code\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWe were able to set breakpoints on web-related functions, which confirmed some of the malicious indicators extracted from the Cobalt Strike parsing tool. And one thing that we noticed was that the beacon references the \u003ca href=\\\"https://www.google.com/search?q=avant+browser\u0026oq=Avant+Browser\\\" target=\\\"_blank\\\"\u003eAvant Browser\u003c/a\u003e in the user-agent of its C2 requests. This likely means that the C2 server wont respond (or will return something benign) unless it sees that header.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2168px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2168px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605\\\" alt=\\\"IOC_3\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDigging deeper, we also find pieces of the \u003ca href=\\\"https://www.cobaltstrike.com/help-malleable-c2\\\" target=\\\"_blank\\\"\u003eMalleable C2\u003c/a\u003e commands used by the beacon, which in this case are embedded into HTTP cookie headers.\u003c/p\u003e\u003cp\u003e\u0026amp;Cookie: Jn9f/eO8Xfay/dYKGpmuBIXL6ZpnGtPuLtugLgeU5vsP4K/bMWYy21s2ulMVQjYmUq9ClOYS8XWbLNMwPV3y10tGAbupka2lk+gbRlJntI6gPqBUl\u003c/p\u003e\u003cp\u003eAlthough it looked like the data was Base64 encoded, we were unable to extract anything meaningful from using variations of Base64 decoders.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eBut wait  are these actually addresses?\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eLooking at the cookie data within the dump view, we noticed that there were three valid memory addresses contained within the encoded version of the cookie data.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:858px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"858px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e\\\" alt=\\\"IOC_6\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eOne of these referenced the ws2_32.DLL, and the other two referenced a suspicious section of memory.\u003c/p\u003e\u003cp\u003eRunning strings on the memory sections referenced in the red underlines provided some interesting results  namely lots of information about my virtual machine that the malware was likely trying to send to the C2 server.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1200px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1200px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9\\\" alt=\\\"IOC_7\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eContinuing on, we noticed some more references to the C2 server and the communication methods used, as well as a reference to a full URL used by the payload.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1610px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1610px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838\\\" alt=\\\"IOC_8\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2068px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2068px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a\\\" alt=\\\"IOC_9\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eUnfortunately, we didnt have networking enabled on our test machine; so these requests all failed, causing an infinite loop where the beacon would sleep for a while and try again. If we were to enable networking, the beacon would likely download some additional payload modules and begin to truly compromise our machine. Maybe in a later article we can retrieve one of these payloads and do a deeper technical analysis of what this Cobalt Strike malware is capable of.\u0026nbsp;\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u0026nbsp;\u003c/p\u003e\u003cp\u003eThat wraps up our analysis of this persistence mechanism and the binary files involved. It was a wild ride, and hopefully you enjoyed reading as much as we enjoyed researching.\u003c/p\u003e\u003cp\u003eIf there's one lesson this should leave you with, it's that we simply can't\u003ca href=\\\"/blog/what-is-human-powered-threat-hunting\\\"\u003e rely on automated tools alone\u003c/a\u003e to protect our systems. Through all these layers of obfuscation and evasion tactics, it's clear just how many hoops hackers will jump through to execute their malware  and that's why you need some type of human element to catch these sneaky threat actors in their tracks. \u003c/p\u003e\u003cp\u003eWell come back to this another day, but for now, this is the end of this rabbit hole.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\",\"featured\",\"thumbnail\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F960a09d94f2949da8eb1ff1d3096189c\",\"g8satlwvr4\",\"relatedPosts\",[308,314,320],{\"_12\":309,\"_14\":310,\"_45\":311},\"67644708809124de50fa0e3c\",\"The Hunt for RedCurl\",{\"_49\":312,\"_303\":313},\"the-hunt-for-redcurl-2\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7cec99d221cc47fc945c3f1eadc23962\",{\"_12\":315,\"_14\":316,\"_45\":317},\"6740ad0b03c34fd25906fe8f\",\"Know Thy Enemy: A Novel November Case on Persistent Remote Access\",{\"_49\":318,\"_303\":319},\"know-thy-enemy-a-novel-november-case-on-persistent-remote-access\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7345981665e34e4780ff76dcd1e1714f\",{\"_12\":321,\"_14\":322,\"_45\":323},\"673bbadf6ee3cb266361f7ae\",\"You Can Run, but You Cant Hide: Defender Exclusions\",{\"_49\":324,\"_303\":325},\"you-can-run-but-you-cant-hide-defender-exclusions\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb4ebc0447fc34db1a4ca274e87f1ca92\",\"builderApiKey\",\"3eb6f92aedf74f109c7b4b0897ec39a8\",\"actionData\",\"errors\"]\n");</script><!--$?--><template id="B:1"></template><!--/$--></div><script>$RC=function(b,c,e){c=document.getElementById(c);c.parentNode.removeChild(c);var a=document.getElementById(b);if(a){b=a.previousSibling;if(e)b.data="$!",a.setAttribute("data-dgst",e);else{e=b.parentNode;a=b.nextSibling;var f=0;do{if(a&&8===a.nodeType){var d=a.data;if("/$"===d)if(0===f)break;else f--;else"$"!==d&&"$?"!==d&&"$!"!==d||f++}d=a.nextSibling;e.removeChild(a);a=d}while(a);for(;c.firstChild;)e.insertBefore(c.firstChild,a);b.data="$"}b._reactRetry&&b._reactRetry()}};$RC("B:0","S:0")</script><div hidden id="S:1"><script>window.__reactRouterContext.streamController.close();</script></div><script>$RC("B:1","S:1")</script></body></html>