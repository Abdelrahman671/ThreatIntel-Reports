<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US"  class="touch-styles">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- This is Squarespace. --><!-- stratosphere-ips -->
<base href="">
<meta charset="utf-8" />
<title>Dissecting a RAT. Analysis of the Saefko RAT. &mdash; Stratosphere IPS</title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model" /><link rel="icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510076526263-H5676DRO9FLHCI9DST2F/favicon.ico?format=100w"/>
<link rel="canonical" href="https://www.stratosphereips.org/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat"/>
<meta property="og:site_name" content="Stratosphere IPS"/>
<meta property="og:title" content="Dissecting a RAT. Analysis of the Saefko RAT. &mdash; Stratosphere IPS"/>
<meta property="og:latitude" content="50.0757517"/>
<meta property="og:longitude" content="14.419946699999969"/>
<meta property="og:locality" content=""/>
<meta property="og:url" content="https://www.stratosphereips.org/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This is the eighth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [  more information here  ], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffi"/>
<meta property="og:image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/60b7c79e65d7df4bcf8373b3/1633960116494/purple_rat.jpg?format=1500w"/>
<meta property="og:image:width" content="800"/>
<meta property="og:image:height" content="800"/>
<meta itemprop="name" content="Dissecting a RAT. Analysis of the Saefko RAT. — Stratosphere IPS"/>
<meta itemprop="url" content="https://www.stratosphereips.org/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat"/>
<meta itemprop="description" content="This is the eighth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [  more information here  ], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffi"/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/60b7c79e65d7df4bcf8373b3/1633960116494/purple_rat.jpg?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/60b7c79e65d7df4bcf8373b3/1633960116494/purple_rat.jpg?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/60b7c79e65d7df4bcf8373b3/1633960116494/purple_rat.jpg?format=1500w"/>
<meta itemprop="author" content="Stratosphere IPS"/>
<meta itemprop="datePublished" content="2021-06-21T11:55:55-0400"/>
<meta itemprop="dateModified" content="2021-10-11T09:48:36-0400"/>
<meta itemprop="headline" content="Dissecting a RAT. Analysis of the Saefko RAT."/>
<meta itemprop="publisher" content="Stratosphere IPS"/>
<meta name="twitter:title" content="Dissecting a RAT. Analysis of the Saefko RAT. — Stratosphere IPS"/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/60b7c79e65d7df4bcf8373b3/1633960116494/purple_rat.jpg?format=1500w"/>
<meta name="twitter:url" content="https://www.stratosphereips.org/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="This is the eighth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [  more information here  ], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffi"/>
<meta name="description" content="This is the eighth blog of a series analyzing the network traffic of 
Android RATs from our Android Mischief Dataset [more information here], a 
dataset of network traffic from Android phones infected with Remote Access 
Trojans (RAT). In this blog post we provide the analysis of the network 
traffic of the RAT06-Saefko [download here]. The previous blogs analyzed 
Android Tester RAT, DroidJack RAT, SpyMax RAT, AndroRAT, HawkShaw, AhMyth 
and Command-line AndroRAT." />
<link rel="preconnect" href="https://images.squarespace-cdn.com">
<link rel="preconnect" href="https://use.typekit.net" crossorigin>
<link rel="preconnect" href="https://p.typekit.net" crossorigin>
<script type="text/javascript" src="//use.typekit.net/ik/7S7aiE_3ARNLZHBfVF5QpfYr3D_L04qpJYjAtrEXszqfeCvffFHN4UJLFRbh52jhWDmyw2IUw2gcFRqkZA48w2bu5AIU529oZy7pMPG0SaskjWszSagGZW48OA83SkoDSWmyScmDSeBRZPoRdhXCdeNRjAUGdaFXOYFXScBXdaF3-emkZPuTSYw0SaBujW48Sagyjh90jhNlOYFXScBXdaF3-emkZA83SkozScSCiaiaO1FXScBXdaF3-emkZPuTSYw0SaBujW48Sagyjh90jhNlOYiaikoDiY4yieNDSey8ScmTSYw0da41J6iRjAUCiAoyJ6Z8iW4zSeI7fbKbwgMMeMw6MKG4fwXVIMMjgfMfH6qJD3vbMg6YJMJ7fbRb2UMMegI6MKG4fH8oIMIjMkMfH6qJ71qbMs6IJMJ7fbKGpsMgeMS6MKGHf55eMsMgeMX6MKGHf5PeMsMgeMt6MKGHf5AeMsMgegI6MTMglZptv39.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700"><script type="text/javascript" crossorigin="anonymous" defer="true" nomodule="nomodule" src="//assets.squarespace.com/@sqs/polyfiller/1.6/legacy.js"></script>
<script type="text/javascript" crossorigin="anonymous" defer="true" src="//assets.squarespace.com/@sqs/polyfiller/1.6/modern.js"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-d99742db7c3e1761-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-d99742db7c3e1761-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-a86e12ea17d7e7b5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-a86e12ea17d7e7b5-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-df1fd1183d9390fb-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-df1fd1183d9390fb-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-7b201f858dc219cf-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-7b201f858dc219cf-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-469bf6a494aa7811-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/performance-469bf6a494aa7811-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["campaigns_discount_section_in_automations","campaigns_new_image_layout_picker","order_status_page_checkout_landing_enabled","campaigns_discount_section_in_blasts","campaigns_import_discounts","marketing_automations","contacts_and_campaigns_redesign","i18n_beta_website_locales","campaigns_thumbnail_layout","marketing_landing_page"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-929d54e21180185e-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-5d864aadea1060d1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-db0a42bc9a745b13-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-47a224f34e715983-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-2204db19701b2ebe-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-96b256171ee039c1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-ea68dbda5f388989-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-01eecf660cca1c8d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-0a38891230aaac9c-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-01f4ea53f1ef2e01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-282fe7613747318b-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-f9093f2d526b94df-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-12b6a5be5e64a5dc-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-a51a0c508870ad93-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-ec12b1513f197549-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-0afd3c6ac30bbab1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-ee423cf78a6d9847-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-de0dea92b161a99b-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-104246dd5ee81f93-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-71b95dc6a65ad0b0-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-b742b752f5880972-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-2356da150be012eb-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-0ba5bac716923b8e-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-b1bef1d49abb1dcb-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-d1bdb2ab433d5058-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-6676ab1a86064e26-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-90a67fc09b9b32c6-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-427f06a82a4c7a3d-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-a56885d30b3c3073-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-701bf8bbc05ec6aa-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-b76ae7bcbecc9533-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-95032e5fa98e47a5-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-476538637d19f94c-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-58c6d775dcd3c2e1-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-07ea5a4e004e6710-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-0ab5b1476f53fc55-min.en-US.js"}},"pageType":50,"website":{"id":"5a01100f692ebe0459a1859f","identifier":"stratosphere-ips","websiteType":1,"contentModifiedOn":1741599218675,"cloneable":false,"hasBeenCloneable":false,"siteStatus":{},"language":"en-US","timeZone":"America/New_York","machineTimeZoneOffset":-14400000,"timeZoneOffset":-14400000,"timeZoneAbbr":"EDT","siteTitle":"Stratosphere IPS","fullSiteTitle":"Dissecting a RAT. Analysis of the Saefko RAT. \u2014 Stratosphere IPS","siteTagLine":"","siteDescription":"<p><span style=\"font-size:16px\">The Stratosphere </span><span style=\"font-size:16px\">IPS</span><span style=\"font-size:16px\">&nbsp;project was born in the </span><span style=\"font-size:16px\">CTU</span><span style=\"font-size:16px\">&nbsp;University of Prague in Czech Republic, as part of the PhD work of Sebastian Garc\u00EDa. Currently the project is being funded by the NLnet Foundation from Netherlands, to whom we are greatly thankful. Sebastian did his PhD in the </span><span style=\"font-size:16px\">ISISTAN</span><span style=\"font-size:16px\">&nbsp;Institute of</span><span style=\"font-size:16px\">UNICEN</span><span style=\"font-size:16px\">&nbsp;University in Argentina.</span></p>","location":{"mapLat":50.0757517,"mapLng":14.419946699999969,"addressTitle":"","addressLine1":"Karlovo n\u00E1m\u011Bst\u00ED","addressLine2":"Praha","addressCountry":"Czech Republic"},"logoImageId":"5a01f28c652dea59e99249e1","socialLogoImageId":"5a0111498165f56ac4a11d93","shareButtonOptions":{"1":true,"4":true},"logoImageUrl":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png","socialLogoImageUrl":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510019401957-BZZD6BHIYSZHJO8KSNKG/StratosphereIPS+logo+1.png","authenticUrl":"https://www.stratosphereips.org","internalUrl":"https://stratosphere-ips.squarespace.com","baseUrl":"https://www.stratosphereips.org","primaryDomain":"www.stratosphereips.org","sslSetting":3,"isHstsEnabled":false,"socialAccounts":[{"serviceId":62,"screenname":"Twitter","addedOn":1580913754185,"profileUrl":"https://twitter.com/StratosphereIPS","iconEnabled":true,"serviceName":"twitter-unauth"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"0a79fb1ba57f3eed2545bd138ee53d4c5132eaa4b6b3957737b03ff5a1628ef3","showOwnerLogin":false},"websiteSettings":{"id":"5a01100f692ebe0459a185a1","websiteId":"5a01100f692ebe0459a1859f","type":"Non-Profit","subjects":[],"country":"CZ","state":"B","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":true,"contactPhoneNumber":"","businessHours":{"monday":{"text":"","ranges":[{}]},"tuesday":{"text":"","ranges":[{}]},"wednesday":{"text":"","ranges":[{}]},"thursday":{"text":"","ranges":[{}]},"friday":{"text":"","ranges":[{}]},"saturday":{"text":"","ranges":[{}]},"sunday":{"text":"","ranges":[{}]}},"storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":2,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsSuccessText":"","restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"minimumOrderSubtotal":{"currency":"USD","value":"0.00"},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"userAccountsSettings":{"loginAllowed":false,"signupAllowed":false}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Stratosphere IPS Research Blog","id":"5a01202be2c48324aeddc117","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"Dissecting a RAT. Analysis of the Saefko RAT.","id":"60b7c79e65d7df4bcf8373b3","fullUrl":"/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat","publicCommentCount":0,"commentState":1,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"aspect-ratio":"Auto","banner-slideshow-controls":"Arrows","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Grid","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"280px","gridSpacing":"10px","logoContainerWidth":"140px","product-gallery-auto-crop":"false","product-image-auto-crop":"true","siteTitleContainerWidth":"360px","tweak-v1-related-products-title-spacing":"50px"},"templateId":"52a74dafe4b073a80cd253c5","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1053/scripts/","impersonatedSession":false,"tzData":{"zones":[[-300,"US","E%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/New_York","name":"Eastern Time"}},"env":"PRODUCTION"};</script><script type="module">Squarespace.load(window);</script>
<script data-sqs-type="imageloader-bootstrapper" type="module">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script>
<script type="module">Squarespace.afterBodyLoad(Y);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.stratosphereips.org/blog?format=rss" />
<script type="application/ld+json">{"url":"https://www.stratosphereips.org","name":"Stratosphere IPS","description":"<p><span style=\"font-size:16px\">The Stratosphere </span><span style=\"font-size:16px\">IPS</span><span style=\"font-size:16px\">&nbsp;project was born in the </span><span style=\"font-size:16px\">CTU</span><span style=\"font-size:16px\">&nbsp;University of Prague in Czech Republic, as part of the PhD work of Sebastian Garc\u00EDa. Currently the project is being funded by the NLnet Foundation from Netherlands, to whom we are greatly thankful. Sebastian did his PhD in the </span><span style=\"font-size:16px\">ISISTAN</span><span style=\"font-size:16px\">&nbsp;Institute of</span><span style=\"font-size:16px\">UNICEN</span><span style=\"font-size:16px\">&nbsp;University in Argentina.</span></p>","image":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"legalName":"","address":"Karlovo n\u00E1m\u011Bst\u00ED\nPraha\nCzech Republic","email":"stratosphere@aic.fel.cvut.cz","telephone":"","sameAs":["https://twitter.com/StratosphereIPS"],"@context":"http://schema.org","@type":"Organization"}</script><script type="application/ld+json">{"address":"Karlovo n\u00E1m\u011Bst\u00ED\nPraha\nCzech Republic","image":"https://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5a01f28c652dea59e99249e1/1741599218675/","name":"","openingHours":", , , , , , ","@context":"http://schema.org","@type":"LocalBusiness"}</script><script type="application/ld+json">{"name":"Dissecting a RAT. Analysis of the Saefko RAT. \u2014 Stratosphere IPS","url":"https://www.stratosphereips.org/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat","datePublished":"2021-06-21T11:55:55-0400","dateModified":"2021-10-11T09:48:36-0400","headline":"Dissecting a RAT. Analysis of the Saefko RAT.","author":"Stratosphere IPS","publisher":{"name":"Stratosphere IPS","logo":{"@type":"ImageObject","url":"https://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5a01f28c652dea59e99249e1/1741599218675/"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/60b7c79e65d7df4bcf8373b3/1633960116494/purple_rat.jpg?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="https://static1.squarespace.com/static/sitecss/5a01100f692ebe0459a1859f/47/52a74dafe4b073a80cd253c5/5a01100f692ebe0459a185b3/1053/site.css"/><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59793876-1"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-59793876-1');</script><!-- End of Squarespace Headers -->
    <script>/* Must be below squarespace-headers */(function(){var e='ontouchstart'in window||navigator.msMaxTouchPoints;var t=document.documentElement;if(!e&&t){t.className=t.className.replace(/touch-styles/,'')}})()
    </script>
  </head>
  <body id="item-60b7c79e65d7df4bcf8373b3" class="enable-nav-button nav-button-style-solid nav-button-corner-style-square banner-button-style-solid banner-button-corner-style-square banner-slideshow-controls-arrows meta-priority-date  hide-entry-author hide-list-entry-footer    hide-blog-sidebar center-navigation--info     event-thumbnails event-thumbnail-size-32-standard event-date-label event-date-label-time event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts  event-item-back-link    gallery-design-grid aspect-ratio-auto lightbox-style-light gallery-navigation-bullets gallery-info-overlay-show-on-hover gallery-aspect-ratio-32-standard gallery-arrow-style-no-background gallery-transitions-fade gallery-show-arrows gallery-auto-crop   product-list-titles-under product-list-alignment-center product-item-size-11-square product-image-auto-crop product-gallery-size-11-square  show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-light  opentable-style-light small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-solid button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd view-item collection-type-blog collection-layout-default collection-5a01202be2c48324aeddc117 mobile-style-available has-banner-image item-main-image">
    <div class="body-overlay"></div>
    <div class="sqs-announcement-bar-dropzone"></div>
    <div id="sidecarNav">
      

  <div id="mobileNavWrapper" class="nav-wrapper" data-content-field="navigation-mobileNav">
    <nav id="mobileNavigation">
      

      
        
          
          <div class="index homepage">
            <a href="/">
              Home
            </a>
          </div>
          
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about">About</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/team">
                  Our Team
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/contact">
                  Contact
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/sebastian-garcia">
                  Sebastian Garcia
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/veronica-valeros">
                  Veronica Valeros
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about-datasets">Datasets</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/datasets-ctu13">
                  CTU-13 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot23">
                  IoT-23 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hornet-network-dataset-of-geographically-placed-honeypots">
                  Hornet: Network Dataset of Geographically Placed Honeypots
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-overview">
                  Datasets Overview
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-malware">
                  Malware Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-normal">
                  Normal Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-mixed">
                  Mixed Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot">
                  Malware on IoT Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/android-mischief-dataset">
                  Android Mischief Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-faq">
                  F.A.Q.
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/stratosphere-ips">Stratosphere IPS</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/technology">
                  Technology
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-ips-for-linux">
                  Stratosphere IPS for Linux
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-testing-framework">
                  Stratosphere Testing Framework
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/download">
                  Download
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/kalipso">
                  Kalipso
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/projects">Projects</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/ai-dojo">
                  AI Dojo
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/gsoc">
                  GSoC
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/defensive-llms">
                  Defensive LLMs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/cybercrime-research">
                  Cybercrime Research
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aposemat">
                  Aposemat Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere">
                  Civilsphere
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere-aivpn">
                  Civilsphere AI-VPN
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ludus">
                  Project Ludus
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/manati">
                  ManaTI
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/nomad">
                  Nomad
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/thesis-projects">
                  Thesis Projects
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-rats">
                  A Study of RATs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-iot-malware">
                  A Study of IoT Malware
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/icarus-project">
                  Icarus Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ad-honeypot-game">
                  AD-Honeypot Evasion Game
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/the-blocklist-generation-project">
                  The Blocklist Generation Project
                </a>
              </div>
              
              
            

              
              
              <div class="external">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
            

              
              <div class="collection">
                <a href="/feel-project">
                  FEEL Project
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/tools">Tools</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/should-i-click">
                  Should I Click
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hexa-payload-decoder">
                  Hexa Payload Decoder
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-anomaly-detector">
                  Zeek Anomaly Detector
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-irc-feature-extractor">
                  Zeek IRC Feature Extractor
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aip-tool">
                  AIP Tool
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/publications-overview">
                Publications
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/job-openings">
                Open Positions
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection active">
              <a href="/blog">
                Research Blog
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>



    </div>
    <div id="siteWrapper" class="clearfix">

      <div class="sqs-cart-dropzone"></div>

      <header id="header" class="show-on-scroll" data-offset-el=".index-section" data-offset-behavior="bottom" role="banner">
        <div class="header-inner">
          <div id="logoWrapper" class="wrapper" data-content-field="site-title">
            
              <h1 id="logoImage"><a href="/"><img src="//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png?format=1500w" alt="Stratosphere IPS" /></a></h1>
            
          </div><!--
          --><div class="mobile-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><div class="mobile-nav-toggle fixed-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><!--
          --><div id="headerNav">

  <div id="mainNavWrapper" class="nav-wrapper" data-content-field="navigation-mainNav">
    <nav id="mainNavigation" data-content-field="navigation-mainNav">
      

      
        
          
          <div class="index homepage">
            <a href="/">
              Home
            </a>
          </div>
          
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about">About</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/team">
                  Our Team
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/contact">
                  Contact
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/sebastian-garcia">
                  Sebastian Garcia
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/veronica-valeros">
                  Veronica Valeros
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about-datasets">Datasets</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/datasets-ctu13">
                  CTU-13 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot23">
                  IoT-23 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hornet-network-dataset-of-geographically-placed-honeypots">
                  Hornet: Network Dataset of Geographically Placed Honeypots
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-overview">
                  Datasets Overview
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-malware">
                  Malware Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-normal">
                  Normal Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-mixed">
                  Mixed Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot">
                  Malware on IoT Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/android-mischief-dataset">
                  Android Mischief Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-faq">
                  F.A.Q.
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/stratosphere-ips">Stratosphere IPS</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/technology">
                  Technology
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-ips-for-linux">
                  Stratosphere IPS for Linux
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-testing-framework">
                  Stratosphere Testing Framework
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/download">
                  Download
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/kalipso">
                  Kalipso
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/projects">Projects</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/ai-dojo">
                  AI Dojo
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/gsoc">
                  GSoC
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/defensive-llms">
                  Defensive LLMs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/cybercrime-research">
                  Cybercrime Research
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aposemat">
                  Aposemat Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere">
                  Civilsphere
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere-aivpn">
                  Civilsphere AI-VPN
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ludus">
                  Project Ludus
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/manati">
                  ManaTI
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/nomad">
                  Nomad
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/thesis-projects">
                  Thesis Projects
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-rats">
                  A Study of RATs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-iot-malware">
                  A Study of IoT Malware
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/icarus-project">
                  Icarus Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ad-honeypot-game">
                  AD-Honeypot Evasion Game
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/the-blocklist-generation-project">
                  The Blocklist Generation Project
                </a>
              </div>
              
              
            

              
              
              <div class="external">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
            

              
              <div class="collection">
                <a href="/feel-project">
                  FEEL Project
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/tools">Tools</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/should-i-click">
                  Should I Click
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hexa-payload-decoder">
                  Hexa Payload Decoder
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-anomaly-detector">
                  Zeek Anomaly Detector
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-irc-feature-extractor">
                  Zeek IRC Feature Extractor
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aip-tool">
                  AIP Tool
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/publications-overview">
                Publications
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/job-openings">
                Open Positions
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection active">
              <a href="/blog">
                Research Blog
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>
  <!-- style below blocks out the mobile nav toggle only when nav is loaded -->
  <style>.mobile-nav-toggle-label { display: inline-block !important; }</style>


</div>
        </div>
      </header>

      
        
          
            
              
                <div class="banner-thumbnail-wrapper" data-content-field="main-image">
                  <div class="color-overlay"></div>
                  <figure id="thumbnail" class="loading content-fill"><img data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624290530840-DTLBTCUYGIX8B4GWJPU5/purple_rat.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624290530840-DTLBTCUYGIX8B4GWJPU5/purple_rat.jpg" data-image-dimensions="800x800" data-image-focal-point="0.5,0.5" alt="Dissecting a RAT. Analysis of the Saefko RAT."  /></figure>
                  <div class="blog-item-wrapper">
                    <div class="title-desc-wrapper">
                      <time class="dt-published published post-date" datetime="2021-06-21" pubdate>June 21, 2021</time>
                      <div class="post-category"><a href="/blog?category=Mischief">Mischief</a></div>
                      <div class="post-author"><a href="/blog?author=5a010fd25e0ed880ec22749f">Stratosphere IPS</a></div>
                      <div class="post-title">Dissecting a RAT. Analysis of the Saefko RAT.</div>
                    </div>
                  </div>
                </div>
              
            
          
        
      


      
      
      

      <main id="page" role="main">
        
        <!--
        --><!--
        --><div id="content" class="main-content" data-content-field="main-content" data-collection-id="5a01202be2c48324aeddc117" data-edit-main-image="">
         <div class="blog-item">

  
  <article class="entry h-entry hentry category-mischief author-stratosphere-ips post-type-text has-main-image clear" id="article-60b7c79e65d7df4bcf8373b3" data-item-id="60b7c79e65d7df4bcf8373b3">

    <header class="entry-header">
      <div class="meta-above-title">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/blog?author=5a010fd25e0ed880ec22749f" class="p-author author entry-byline-link" rel="author">Stratosphere IPS</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2021-06-21" pubdate><a href="/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat" class="entry-dateline-link">June 21, 2021</a></time>
          <time class="dt-updated updated" datetime="2021-10-11"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Mischief" class="entry-morefrom-link" rel="tag">Mischief</a></span>
        </div>
        
      </div>
      <h1 data-content-field="title" class="entry-title p-name">
      
        <a href="/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat" class="u-url" rel="bookmark">Dissecting a RAT. Analysis of the Saefko RAT.</a>
      
      </h1>
      <div class="meta-below-title ">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/blog?author=5a010fd25e0ed880ec22749f" class="p-author author entry-byline-link" rel="author">Stratosphere IPS</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2021-06-21" pubdate><a href="/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat" class="entry-dateline-link">June 21, 2021</a></time>
          <time class="dt-updated updated" datetime="2021-10-11"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Mischief" class="entry-morefrom-link" rel="tag">Mischief</a></span>
        </div>
        
      </div>
    </header>

    <div class="entry-content e-content">
      
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1622658703805" id="item-60b7c79e65d7df4bcf8373b3"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-d78f8e946c585116de42"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p style="text-align:right;white-space:pre-wrap;" class=""><strong><em>This blog post was authored by Kamila Babayeva (@_kamifai_) and Sebastian Garcia (@eldracote).</em></strong></p><p class="" style="white-space:pre-wrap;"><em>The RAT analysis research is part of the Civilsphere Project (</em><a href="https://www.civilsphereproject.org/"><span style="text-decoration:underline"><em>https://www.civilsphereproject.org/</em></span></a><em>), which aims to protect the civil society at risk by understanding how the attacks work and how we can stop them. Check the webpage for more information.</em></p><p class="" style="white-space:pre-wrap;">This is the eighth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [<a href="https://www.stratosphereips.org/android-mischief-dataset"><span style="text-decoration:underline">more information here</span></a>], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffic of the RAT06-Saefko [<a href="https://mcfp.felk.cvut.cz/publicDatasets/Android-Mischief-Dataset/AndroidMischiefDataset_v2/RAT06_Saefko/"><span style="text-decoration:underline">download here</span></a>]. The previous blogs analyzed <a href="https://www.stratosphereips.org/blog/2020/12/14/ngwqj0h060yv40w1afp51fg7wo9ijy-pzlhk"><span style="text-decoration:underline">Android Tester RAT</span></a>, <a href="https://www.stratosphereips.org/blog/2021/1/22/analysis-of-droidjack-v44-rat-network-traffic"><span style="text-decoration:underline">DroidJack RAT</span></a>, <a href="https://www.stratosphereips.org/blog/2021/2/26/dissecting-a-rat-analysis-of-the-spymax"><span style="text-decoration:underline">SpyMax RAT</span></a>, <a href="https://www.stratosphereips.org/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat"><span style="text-decoration:underline">AndroRAT</span></a>, <a href="https://www.stratosphereips.org/blog/2021/5/6/dissecting-a-rat-analysis-of-the-hawkshaw"><span style="text-decoration:underline">HawkShaw</span></a>, <a href="https://www.stratosphereips.org/blog/2021/5/6/dissecting-a-rat-analysis-of-the-ahmyth"><span style="text-decoration:underline">AhMyth</span></a> and <a href="https://www.stratosphereips.org/blog/2021/5/6/dissecting-a-rat-analysis-of-the-command-line-androrat">Command-line AndroRAT</a>.&nbsp;</p><p class="" style="white-space:pre-wrap;"><strong>RAT Details and Execution Setup</strong></p><p class="" style="white-space:pre-wrap;">The procedure followed for each of our RAT experiments is to configure and execute the RAT software and to do every possible action while capturing all traffic and storing all logs. These RAT captures are functional and used as in real attacks.</p><p class="" style="white-space:pre-wrap;">The Saefko RAT is a software package that contains the controller software and builder software to create an APK. We executed the builder on a Windows 7 Virtualbox virtual machine with Ubuntu 20.04 as a host. The Android Application Package (APK) built by the RAT builder was then installed in an Android virtual emulator called Genymotion with Android version 8.&nbsp;</p><p class="" style="white-space:pre-wrap;">While performing different actions on the RAT controller (e.g. upload a file, get GPS location, monitor files, etc.), we captured the network traffic on the machine running the Android virtual emulator. The network traffic was captured on the Android virtual emulator network interface.</p><p class="" style="white-space:pre-wrap;">Configuration parameters of the C&amp;C Controller and the phone victim:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Controller:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">IPv4: 192.168.131.1</p></li><li><p class="" style="white-space:pre-wrap;">IPv6: 2001:718:2:903:f410:3340:d02b:b918</p></li><li><p class="" style="white-space:pre-wrap;">Link-Local IPv6: fe80::8052:f37c:25e9:69f0</p></li></ul></li><li><p class="" style="white-space:pre-wrap;">Victim:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">IPv4: 192.168.131.2</p></li><li><p class="" style="white-space:pre-wrap;">IPv6: 2001:718:2:903:b877:48ae:9531:fbfc</p></li><li><p class="" style="white-space:pre-wrap;">Link-local IPv6: fe80::2efc:36f:ce23:fac1</p></li></ul></li></ul><p class="" style="white-space:pre-wrap;">Details of the network capture pcap file:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">First Packet of the Infection: 36728</p></li><li><p class="" style="white-space:pre-wrap;">UTC Time of the Infection: 2021-04-10 14:55:09</p></li></ul><h1 style="white-space:pre-wrap;">First connections from the infected phone</h1><p class="" style="white-space:pre-wrap;">Compared to other analyzed RATs in the <a href="https://www.stratosphereips.org/android-mischief-dataset"><span style="text-decoration:underline">Android Mischief Dataset</span></a>, where the first malicious connection from the victim phone is direct to the C&amp;C server, in the case of Saefko RAT, the infected phone first connects to the webpage <a href="https://ipinfo.io/geo"><span style="text-decoration:underline">https://ipinfo.io/geo</span></a>. The connection from the phone to the service ipinfo.io is displayed in Figure 1. The phone tries to retrieve the latitude and longitude of the victim’s device location according to its IP address. In the malicious APK, there is a function for this automatic action of ‘getting the location’, called GetLocationInfo(), which is responsible for this action as shown in Figure 2.</p><pre style="text-align:center;"><code>1618066509.311319 &nbsp; &nbsp; &nbsp; C1hlpv4rTNvRlsA1k1&nbsp; &nbsp; &nbsp; 192.168.131.2 &nbsp; 55536 &nbsp; 216.239.36.21 &nbsp; 443&nbsp; ipinfo.io&nbsp;</code></pre><p class="" style="white-space:pre-wrap;"><strong><em>Figure 1. </em></strong>Zeek flow from the ssl.log that shows the connection form the victim’s device 192.168. to the ipinfo.io.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_3222"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1160px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 2. &lt;/em&gt;&lt;/strong&gt;The APK function GetLocationInfo() retrieves the longitude and latitude of the victim’s device location based on the IP address by connecting to the site https://ipinfo.io/geo.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:21.034482955932617%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png" data-image-dimensions="1160x244" data-image-focal-point="0.5,0.5" alt="Figure 2. The APK function GetLocationInfo() retrieves the longitude and latitude of the victim’s device location based on the IP address by connecting to the site https://ipinfo.io/geo." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png" width="1160" height="244" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659553439-KNYEICJHZ2UXFBC931Q2/image7.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 2. </em></strong>The APK function GetLocationInfo() retrieves the longitude and latitude of the victim’s device location based on the IP address by connecting to the site https://ipinfo.io/geo.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622658705560_4879"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">After retrieving the location information from the ipinfo.io service, the second malicious connection performed from the phone is the connection to the C&amp;C online database (The Zeek flow is shown in Figure 3). The C&amp;C uses a web hosting service called 000webhost.com to create an online database. Before starting our experiment, we have created a website on this hosting 000webhost.com with the name “<em>experimentsas”</em>. In our hosting website we installed the files “server.php” and “Saefko_db.db” provided by Saefko RAT software. This C&amp;C database URL link “experminetsas.000webhost.com” was specified in the APK (Figure 4), so the victim phone knows where to connect.</p><p class="" style="white-space:pre-wrap;"><em>1618066509.738157 &nbsp; &nbsp; &nbsp; CM6DFg4vphEr3CEc6g&nbsp; &nbsp; &nbsp; 2001:718:2:903:b877:48ae:9531:fbfc&nbsp; &nbsp; &nbsp; 39812 &nbsp; 2a02:4780:dead:494b::1&nbsp; 443 &nbsp; &nbsp; TLSv12&nbsp; experimentsas.000webhostapp.com&nbsp;</em></p><p class="" style="white-space:pre-wrap;"><strong><em>Figure 3. </em></strong>Zeek flow from the ssl.log file that summarizes the first connection from the infected phone to the C&amp;C online database created by us for this experiment experimentsas.000webhostapp.com.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_10750"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:739px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 4. &lt;/em&gt;&lt;/strong&gt;APK code with specifications of the database URL ‘&lt;a href=&quot;https://experimentsas.000webhostapp.com/&quot;&gt;https://experimentsas.000webhostapp.com/server.php&lt;/a&gt;’ and other necessary parameters.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:32.88227462768555%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png" data-image-dimensions="739x243" data-image-focal-point="0.5,0.5" alt="Figure 4. APK code with specifications of the database URL ‘https://experimentsas.000webhostapp.com/server.php’ and other necessary parameters." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png" width="739" height="243" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659703539-LZ39HPD3CG8N27FRS1V2/image21.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 4. </em></strong>APK code with specifications of the database URL ‘<a href="https://experimentsas.000webhostapp.com/">https://experimentsas.000webhostapp.com/server.php</a>’ and other necessary parameters.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622658705560_12773"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">A few seconds later, after establishing the first connection to the database, the victim established a second connection to the same online database, so there are two simultaneous connections established. Figure 5 shows the Zeek flow for the second connection to the online DB.</p><p style="text-align:center;white-space:pre-wrap;" class=""><strong><em>1618066510.358715 &nbsp; &nbsp; &nbsp; C82MTR16Hzvg4953R7&nbsp; &nbsp; &nbsp; 2001:718:2:903:b877:48ae:9531:fbfc&nbsp; &nbsp; &nbsp; 39814 &nbsp; 2a02:4780:dead:494b::1&nbsp; 443 &nbsp; &nbsp; TLSv12&nbsp; experimentsas.000webhostapp.com</em></strong></p><p class="" style="white-space:pre-wrap;"><strong><em>Figure 5. </em></strong>Zeek flow from ssl.log file that summarizes the second connection to the C&amp;C online database ‘experimentsas.000webhost.com’.</p><h1 style="white-space:pre-wrap;">C&amp;C methods to control the victim</h1><p class="" style="white-space:pre-wrap;">Saefko RAT is the first RAT in the Android Mischief dataset version 2 that uses 3 types of connections to control the victim: (i) IRC channels, (ii) HTTP requests and (iii) a TCP connection directly to the C&amp;C server.&nbsp; We will discuss each connection in detail.</p><h2 style="white-space:pre-wrap;">Connection to IRC servers</h2><p class="" style="white-space:pre-wrap;">Once the APK is installed and the C&amp;C enters the control panel on the interface (example is shown in Figure 6), the victim connects to 5 IRC servers according to the APK function <strong><em>StartIRCClient()</em></strong> in Figure 7. These connections have a refresh rate set to 99,000 milliseconds, which is approximately 28 minutes. It means that every 28 minutes, the victim closes the connections with the current IRC servers and connects to 5 other IRC servers. We know that there are always 5 IRC servers connected, because of the for-loop increasing from 0 to 4 inclusive. The IRC servers are chosen from the list of IRC servers set up in the APK. Figure 8 shows several IRC servers presented in this list of total 99 IRC servers. For each of the chosen IRC server, the victim calls the function <strong><em>IRCInfo.GenerateIRCInfo()</em></strong> that aims to connect to IRC server with specific parameters such as <em>IRC_SERVER</em>, <em>IRC_PORT</em> and <em>IRC_NICKNAME</em>. This function is shown in Figure 9. After the list of 5 IRC servers with their parameters has been created, it is sent to the C&amp;C online database by using the function <strong><em>update_server_informations </em></strong>(shown in Figure 10). The update to the online database is done so that the C&amp;C controller will connect to the same IRC servers and will control the victim by sending IRC private messages.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_14475"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:920px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 6. &lt;/em&gt;&lt;/strong&gt;The interface that the controller uses to execute C&amp;amp;C commands. The interface contains 3 tabs to separate the commands sent over IRC, HTTP and TCP. The tab for the C&amp;amp;C commands over IRC is command-line alike. The phone connects to three IRC servers listed in the beginning of Figure 6: irc.immortal-anime.net, irc.caelestia.net, irc.charrersweb.nl.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:58.369564056396484%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png" data-image-dimensions="920x537" data-image-focal-point="0.5,0.5" alt="Figure 6. The interface that the controller uses to execute C&amp;amp;C commands. The interface contains 3 tabs to separate the commands sent over IRC, HTTP and TCP. The tab for the C&amp;amp;C commands over IRC is command-line alike. The phone connects to three IRC servers listed in the beginning of Figure 6: irc.immortal-anime.net, irc.caelestia.net, irc.charrersweb.nl." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png" width="920" height="537" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659785187-D6SC1Z7SULTJM0MSFWC0/image6.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 6. </em></strong>The interface that the controller uses to execute C&amp;C commands. The interface contains 3 tabs to separate the commands sent over IRC, HTTP and TCP. The tab for the C&amp;C commands over IRC is command-line alike. The phone connects to three IRC servers listed in the beginning of Figure 6: irc.immortal-anime.net, irc.caelestia.net, irc.charrersweb.nl.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_17279"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:850px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:83.05882263183594%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png" data-image-dimensions="850x706" data-image-focal-point="0.5,0.5" alt="Figure 7. APK code that aims to establish a connection with an IRC server with specific parameters. The function generates a list of 5 IRC servers and sends it to the C&amp;amp;C database." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png" width="850" height="706" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659818290-CCKQ05VI2PHKEXOD9ZFK/image12.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 7. </em></strong>APK code that aims to establish a connection with an IRC server with specific parameters. The function generates a list of 5 IRC servers and sends it to the C&amp;C database.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_18726"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:534px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 8. &lt;/em&gt;&lt;/strong&gt;IRC servers listed in the APK code. The infected device connects to IRC servers from this list of 99 servers.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:127.71536254882812%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png" data-image-dimensions="534x682" data-image-focal-point="0.5,0.5" alt="Figure 8. IRC servers listed in the APK code. The infected device connects to IRC servers from this list of 99 servers." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png" width="534" height="682" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659874153-M2GH6SARGZYSDA0ZE2XO/image10.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 8. </em></strong>IRC servers listed in the APK code. The infected device connects to IRC servers from this list of 99 servers.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_20335"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:927px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 9. &lt;/em&gt;&lt;/strong&gt;APK function GenerateIRCInfo() that aims to connect to an IRC server with specified parameters IRC_SERVER, IRC_PORT and IRC_NICKNAME.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:49.83818817138672%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png" data-image-dimensions="927x462" data-image-focal-point="0.5,0.5" alt="Figure 9. APK function GenerateIRCInfo() that aims to connect to an IRC server with specified parameters IRC_SERVER, IRC_PORT and IRC_NICKNAME." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png" width="927" height="462" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622659985502-EDGUZ9TIUGCBSMY468E6/image4.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 9. </em></strong>APK function GenerateIRCInfo() that aims to connect to an IRC server with specified parameters IRC_SERVER, IRC_PORT and IRC_NICKNAME.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_21938"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1423px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 10. &lt;/em&gt;&lt;/strong&gt;APK function update_server_informations that sends the information about the victim’s connected IRC servers to the C&amp;amp;C.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:35.769500732421875%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png" data-image-dimensions="1423x509" data-image-focal-point="0.5,0.5" alt="Figure 10. APK function update_server_informations that sends the information about the victim’s connected IRC servers to the C&amp;amp;C." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png" width="1423" height="509" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660071346-FYS21KE50EOTSSIXTM7H/image11.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 10. </em></strong>APK function update_server_informations that sends the information about the victim’s connected IRC servers to the C&amp;C.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622658705560_16401"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">After both the victim and the controller connect to the same IRC servers, the C&amp;C is able to send the commands to the victim. The list of commands the C&amp;C can perform is shown in Figure 11.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_174673"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1392px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:29.02298927307129%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png" data-image-dimensions="1392x404" data-image-focal-point="0.5,0.5" alt="Figure 11. The list of C&amp;amp;C commands that can be executed over IRC channels." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png" width="1392" height="404" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285304168-NUX8U3Z63PBHU76RQDUY/Screenshot+from+2021-06-21+16-21-08.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 11. </em></strong>The list of C&amp;C commands that can be executed over IRC channels.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_174977"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">As an example of the communication between the C&amp;C and the phone over IRC channels, we show the communication in the IRC server chat.freenode.net. First, the phone performed a DNS lookup of the domain chat.freenode.net. Second, the phone established a connection with this IRC server after resolving its IP address. In Figure 12 it can be seen how the phone established a connection with this IRC server and then immediately terminated it.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_26011"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1310px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:5.572519302368164%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png" data-image-dimensions="1310x73" data-image-focal-point="0.5,0.5" alt="Figure 12. Connection from the phone to the IRC server chat.freenode.net. The connection was established and immediately terminated." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png" width="1310" height="73" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660496138-OPD92XC41GA8VISVGH35/image3.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 12. </em></strong>Connection from the phone to the IRC server <em>chat.freenode.net</em>. The connection was established and immediately terminated.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622658705560_28576"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Third, the phone reestablished the connection with IRC server <em>chat.freenode.net</em> (Figure 13) and sent a packet with the USER parameter to the IRC server. The victim connects to this IRC server with the randomly generated username <em>fcsryk,</em> as<em> </em>displayed in Figure 14<em>.</em> The user string for the infected device is generated by the function GetNickname() shown in Figure 15. The username and nickname the phone uses inside an IRC server are the same.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_30862"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1349px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;Figure 13&lt;/strong&gt;. Reestablished connection from the infected device to the IRC server chat.freenode.net.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:5.411416053771973%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png" data-image-dimensions="1349x73" data-image-focal-point="0.5,0.5" alt="Figure 13. Reestablished connection from the infected device to the IRC server chat.freenode.net." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png" width="1349" height="73" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622660696420-VPLR9PP9KON59I8R5ALB/image15.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong>Figure 13</strong>. Reestablished connection from the infected device to the IRC server chat.freenode.net.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_33489"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1296px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 14. &lt;/em&gt;&lt;/strong&gt;The packet with the USER command sent from the phone to the IRC server. The phone’s username is 6 letters long randomly generated string.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:19.907407760620117%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png" data-image-dimensions="1296x258" data-image-focal-point="0.5,0.5" alt="Figure 14. The packet with the USER command sent from the phone to the IRC server. The phone’s username is 6 letters long randomly generated string." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png" width="1296" height="258" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661157137-9W9XN59VRBZTUFR42F4W/image16.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 14. </em></strong>The packet with the USER command sent from the phone to the IRC server. The phone’s username is 6 letters long randomly generated string.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_53173"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:614px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 15. &lt;/em&gt;&lt;/strong&gt;Function GetNickname() inside the APK code that randomly generates a 6 letters long string to create the nick of the user in IRC.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:22.149837493896484%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png" data-image-dimensions="614x136" data-image-focal-point="0.5,0.5" alt="Figure 15. Function GetNickname() inside the APK code that randomly generates a 6 letters long string to create the nick of the user in IRC." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png" width="614" height="136" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661324672-Q7XTWBIOIO8Q9QB3MGE5/image2.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 15. </em></strong>Function GetNickname() inside the APK code that randomly generates a 6 letters long string to create the nick of the user in IRC.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622658705560_29955"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">After the phone has successfully connected to the IRC server, there is a heartbeat between this IRC server and the phone (shown in Figure 16), This heartbeat is a typical behaviour of an IRC server. The heartbeat stopped after the C&amp;C sent a private message to the phone over the IRC server with the command ‘location’. The packet with this C&amp;C command ‘location’ is presented in Figure 17.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1622658705560_58815"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:901px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:18.201997756958008%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png" data-image-dimensions="901x164" data-image-focal-point="0.5,0.5" alt="Figure 16. Ping and pong between the IRC server and the victim’s phone. The heartbeat continues until the C&amp;amp;C command is received.From Figure 17, it can be seen that the controller’s nick inside the IRC server was zelvmd and the IPv6 address was 2001:718:2:903:f410:3340:d02b:b918. The data sent by the C&amp;amp;C was ‘SASENCODEbG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw’. The data contains a string identifying Saefko: ‘SASENCODE’. The data after this string is bG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw and is Base64 encoded. Using the command-line command base64 to decode this string, we have got the following: $ echo 'bG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw' | base64 -d$ locationT_T1618066981630Figure 18. Base64 decoded data sent by the controller to the phone in the IRC server using a private message, as part of the C&amp;amp;C command ‘location’.The decoded data from the Figure 18 can be organized in the following structure: location				C&amp;amp;C commandT_T					delimiter1618066981630			timestampFigure 19. Structure of the C&amp;amp;C command ‘location’ sent to the phone over IRC. Overall, every C&amp;amp;C command sent by the controller over IRC server has the following structure: ‘SASENCODE’+base64_encode(C&amp;amp;C command + ‘T_T’ + timestamp)Figure 20. Structure of the C&amp;amp;C commands sent to the infected device over IRC. After the phone received the C&amp;amp;C command ‘location’, it replied with 6 packets separated by a one second interval. The phone is connected to three IRC servers and it receives the command in all three of them (probably as redundancy backup), and then it answers with 6 packets to all three of them too. Figure 21 shows the encoded and decoded data field of the 6 packets sent as a reply to the C&amp;amp;C command ‘location’. The packets sent from the phone have the same structure as the packets sent from the C&amp;amp;C." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png" width="901" height="164" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1622661453821-A7KXI07M2QS4TV2NXSPD/image9.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 16. </em></strong>Ping and pong between the IRC server and the victim’s phone. The heartbeat continues until the C&amp;C command is received.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_176782"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:924px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 17. &lt;/em&gt;&lt;/strong&gt;The private message from the C&amp;amp;C with the command ‘&lt;em&gt;location’&lt;/em&gt;. The top lines in the figure are the headers of the packet, the lower lines are the content According to the Internet Relay Chat field, the controller’s nick is &lt;em&gt;zelvmd&lt;/em&gt;, the IP is 2001:718:2:903:f410:3340:d02b:b918 and it sends the data ‘SASENCODEbG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw’.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:50.10822296142578%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png" data-image-dimensions="924x463" data-image-focal-point="0.5,0.5" alt="Figure 17. The private message from the C&amp;amp;C with the command ‘location’. The top lines in the figure are the headers of the packet, the lower lines are the content According to the Internet Relay Chat field, the controller’s nick is zelvmd, the IP is 2001:718:2:903:f410:3340:d02b:b918 and it sends the data ‘SASENCODEbG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw’." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png" width="924" height="463" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285387273-JHEGO855251DURP4H8DT/Screenshot+from+2021-06-21+16-22-36.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 17. </em></strong>The private message from the C&amp;C with the command ‘<em>location’</em>. The top lines in the figure are the headers of the packet, the lower lines are the content According to the Internet Relay Chat field, the controller’s nick is <em>zelvmd</em>, the IP is 2001:718:2:903:f410:3340:d02b:b918 and it sends the data ‘SASENCODEbG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw’.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1622718163007_49609"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">From Figure 17, it can be seen that the controller’s nick inside the IRC server was <em>zelvmd</em> and the IPv6 address was 2001:718:2:903:f410:3340:d02b:b918. The data sent by the C&amp;C was ‘SASENCODEbG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw’. The data contains a string identifying Saefko: ‘SASENCODE’. The data after this string is bG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw and is Base64 encoded. Using the command-line command <em>base64 </em>to decode this string, we have got the following:</p><pre><code>$ echo 'bG9jYXRpb25UX1QxNjE4MDY2OTgxNjMw' | base64 -d</code></pre><pre><code>$ locationT_T1618066981630</code></pre><p style="text-align:center;white-space:pre-wrap;" class=""><strong><em>Figure 18. </em></strong>Base64 decoded data sent by the controller to the phone in the IRC server using a private message, as part of the C&amp;C command ‘location’.</p><p class="" style="white-space:pre-wrap;">The decoded data from the Figure 18 can be organized in the following structure:</p><h3 style="text-align:center;white-space:pre-wrap;">location				  C&amp;C command</h3><h3 style="white-space:pre-wrap;">                           T_T					       delimiter</h3><h3 style="white-space:pre-wrap;">                           1618066981630		       timestamp</h3><p style="text-align:center;white-space:pre-wrap;" class=""><strong><em>Figure 19. </em></strong>Structure of the C&amp;C command ‘location’ sent to the phone over IRC.</p><p class="" style="white-space:pre-wrap;">Overall, every C&amp;C command sent by the controller over IRC server has the following structure:</p><h3 style="text-align:center;white-space:pre-wrap;">‘SASENCODE’+base64_encode(C&amp;C command + ‘T_T’ + timestamp)</h3><p style="text-align:center;white-space:pre-wrap;" class=""><strong><em>Figure 20. </em></strong>Structure of the C&amp;C commands sent to the infected device over IRC.</p><p class="" style="white-space:pre-wrap;">After the phone received the C&amp;C command ‘location’, it replied with 6 packets separated by a one second interval. The phone is connected to three IRC servers and it receives the command in all three of them (probably as redundancy backup), and then it answers with 6 packets to all three of them too. Figure 21 shows the encoded and decoded data field of the 6 packets sent as a reply to the C&amp;C command ‘location’. The packets sent from the phone have the same structure as the packets sent from the C&amp;C.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_299508"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:964px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 21. &lt;/em&gt;&lt;/strong&gt;The phone’s 6 packets sent as a reply to the C&amp;amp;C command ‘location’. The packets from the phone follow the same structure as the C&amp;amp;C packets.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:38.381744384765625%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png" data-image-dimensions="964x370" data-image-focal-point="0.5,0.5" alt="Figure 21. The phone’s 6 packets sent as a reply to the C&amp;amp;C command ‘location’. The packets from the phone follow the same structure as the C&amp;amp;C packets." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png" width="964" height="370" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287153532-7F8UKVZJ6A578FJP46NY/Screenshot+from+2021-06-21+16-52-00.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 21. </em></strong>The phone’s 6 packets sent as a reply to the C&amp;C command ‘location’. The packets from the phone follow the same structure as the C&amp;C packets.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_299823"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">It is important to note that the phone is connected to several IRC servers simultaneously (Figure 22). The C&amp;C commands to execute are sent to the phone through each connected IRC server as well as the replies from the phone are also sent to each of the connected servers:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624271605161_48912"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:100%;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 22. &lt;/em&gt;&lt;/strong&gt;The C&amp;amp;C commands are sent to each connected IRC server and the infected device replies to the C&amp;amp;C command in each server.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:8.120649337768555%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="true" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png" data-image-dimensions="1293x105" data-image-focal-point="0.5,0.5" alt="Figure 22. The C&amp;amp;C commands are sent to each connected IRC server and the infected device replies to the C&amp;amp;C command in each server." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png" width="1293" height="105" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277072111-X9WRQSQY6SIZBASRKSCD/image22.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 22. </em></strong>The C&amp;C commands are sent to each connected IRC server and the infected device replies to the C&amp;C command in each server.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624271605161_52555"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h2 style="white-space:pre-wrap;">HTTP requests from the C&amp;C</h2><p class="" style="white-space:pre-wrap;">Besides IRC connections, the C&amp;C controls the victim by sending HTTP requests to the phone with the commands. However, there are no HTTP requests seen in the traffic from the controller or in the IRC chat, meaning that the commands are sent over the C&amp;C online database. The phone has an HTTP server implemented in the APK, which is unusual. The controller acts as a client that sends HTTP requests with C&amp;C commands to execute, but the HTTP response might be sent back over the online database as well. The C&amp;C commands possible to execute using HTTP requests are very limited, namely Message Box, Shell commands, Visit Webpage and Open TCP Connection. According to the configuration, these commands are queued and will be executed every 21 minutes, which is the refresh rate parameter. An example of queued C&amp;C commands over HTTP is shown in Figure 23.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624271605161_59670"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1116px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:15.591398239135742%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png" data-image-dimensions="1116x174" data-image-focal-point="0.5,0.5" alt="Figure 23. The queue of HTTP requests with C&amp;amp;C commands to be executed on the phone. These commands will be executed according to the refresh rate parameter set in the configuration folder." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png" width="1116" height="174" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277178405-VY2CPRUZ33JFZ6EQCHHS/image5.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 23. </em></strong>The queue of HTTP requests with C&amp;C commands to be executed on the phone. These commands will be executed according to the refresh rate parameter set in the configuration folder.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624271605161_63084"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">These HTTP commands are also sent to the online database that was set up in this experiment. The connections from the phone and the controller to this database are over HTTPs that provides encrypted communication. It means that HTTP requests with C&amp;C commands sent from the controller are encrypted and cannot be analyzed.</p><h2 style="white-space:pre-wrap;">TCP connection to the C&amp;C</h2><p class="" style="white-space:pre-wrap;">A direct TCP connection established from the phone to the C&amp;C gives the attacker more power to control the victim’s device. It allows the controller to send and receive large data such as photos, videos, audios, calls, messages, files, etc. Figure 24 shows the C&amp;C interface with a list of the commands to perform over TCP.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624271605161_70597"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1121px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 24. &lt;/em&gt;&lt;/strong&gt;A list with C&amp;amp;C commands that are possible to perform over TCP connection between the controller and the phone.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:58.162353515625%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png" data-image-dimensions="1121x652" data-image-focal-point="0.5,0.5" alt="Figure 24. A list with C&amp;amp;C commands that are possible to perform over TCP connection between the controller and the phone." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png" width="1121" height="652" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277254967-B0GG0OYR21PAU5J12X03/image18.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 24. </em></strong>A list with C&amp;C commands that are possible to perform over TCP connection between the controller and the phone.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624271605161_74368"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Due to the RAT code being of medium quality, several TCP connections with really little data exchange were established between the C&amp;C and the phone (Figure 25). However, the C&amp;C interface was not displaying these established TCP connections and did not allow the attacker to perform any C&amp;C command. It explains why only the first connection has data exchange. Importantly, the amount of bytes sent from the infected device is much bigger than the response bytes. The other four connections have exactly the same amount of sent and received bytes. Moreover, the C&amp;C was not able to close any of the connections with a 4-way termination handshake. Connections from Zeek’s conn.log in Figure 25 have flags RSTR and S1. RSTR means there was a rejection from the response IP address (in our case the C&amp;C IP address) and S1 means the connection was opened and not closed.&nbsp;</p><p class="" style="white-space:pre-wrap;">id.orig_h &nbsp; &nbsp; &nbsp; id.orig_p &nbsp; &nbsp; &nbsp; id.resp_h &nbsp; &nbsp; &nbsp; id.resp_p &nbsp; &nbsp; &nbsp; proto &nbsp; conn_state&nbsp; &nbsp; &nbsp; orig_bytes&nbsp; &nbsp; &nbsp; resp_bytes</p><p class="" style="white-space:pre-wrap;">192.168.131.2 &nbsp; 35690 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.131.1 &nbsp; 8000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;   tcp &nbsp; &nbsp;   RSTR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    343220&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;     1797</p><p class="" style="white-space:pre-wrap;">192.168.131.2 &nbsp; 35728 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.131.1 &nbsp; 8000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    tcp &nbsp; &nbsp;   RSTR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    96&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;       &nbsp;  56</p><p class="" style="white-space:pre-wrap;">192.168.131.2 &nbsp; 35730 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.131.1 &nbsp; 8000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    tcp &nbsp; &nbsp;   RSTR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    96&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;        56</p><p class="" style="white-space:pre-wrap;">192.168.131.2 &nbsp; 35732 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.131.1 &nbsp; 8000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    tcp &nbsp; &nbsp;    S1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;        96&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;        56</p><p class="" style="white-space:pre-wrap;">192.168.131.2 &nbsp; 35736 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.131.1 &nbsp; 8000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    tcp &nbsp; &nbsp;    S1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;        96&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;        56</p><p class="" style="white-space:pre-wrap;"><strong><em>Figure 25. </em></strong>All the connections from the phone established with the C&amp;C over port 8000/TCP. Due to poor code quality, some of the connections were established but without a big exchange of data and a termination with the RSTR state.</p><p class="" style="white-space:pre-wrap;">As an example of the controller operating over TCP, we will look at the first TCP connection between the phone and the C&amp;C. After a successful 3-way TCP handshake (Figure 26), the C&amp;C sent the first packet with encoded data, as displayed in Figure 27:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624271605161_83503"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1072px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 26. &lt;/em&gt;&lt;/strong&gt;A 3-way TCP handshake to establish the connection over TCP/8000 between the phone and the controller.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:5.13059663772583%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png" data-image-dimensions="1072x55" data-image-focal-point="0.5,0.5" alt="Figure 26. A 3-way TCP handshake to establish the connection over TCP/8000 between the phone and the controller." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png" width="1072" height="55" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624277463279-CBS5JND9GAMC5B7Z0Q7D/image14.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 26. </em></strong>A 3-way TCP handshake to establish the connection over TCP/8000 between the phone and the controller.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_22203"><div class="sqs-block-content">

<div class="sqs-html-content">
  <pre style="text-align:center;"><code>eyJUeXBlIjoiSWRlbnRpZml5IiwiRGF0YSI6Im9xb2V6cWpyd2YifQ</code></pre><p style="text-align:center;white-space:pre-wrap;" class=""><strong><em>Figure 27.</em></strong><em> </em>The data field of the first packet sent from the C&amp;C to the phone.</p><p class="" style="white-space:pre-wrap;">The data in Figure 27 is base64 encoded, the decoded text is {"Type":"Identifiy","Data":"oqoezqjrwf"}. The value of the ‘Type’ key is the command to be executed, in our case is ‘Identify’.&nbsp; "Oqoezqjrwf” might be the identification ID that the controller uniquely generates for each connected infected device.&nbsp;&nbsp;</p><p class="" style="white-space:pre-wrap;"><br>The phone answers the command ‘Identity’ with 2 packets, shown in Figure 28 and Figure 29. The first packet defines the length of the data sent in the second packet. Byte 0x5C in hexadecimal format is 92 in decimal. The second packet is the actual base64 encoded response to the C&amp;C command. The decoded data of this response will result into JSON format <em>{"Data":{"ID":"6","RequestID":"oqoezqjrwf"},"Type":"Identification"}</em>. “ID” defines an ordinal number of the connected device and “RequestID” is the ID given by the C&amp;C. The data length of it being 92 bytes as it was defined in the first packet.</p><pre style="text-align:center;"><code>0000 &nbsp; 00 00 00 5c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...\</code></pre><p class="" style="white-space:pre-wrap;"><strong><em>Figure 28. </em></strong>The first packet sent by the phone after receiving the C&amp;C command. The data defines the length of the data sent in the next packet.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_35888"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1999px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 29.&amp;nbsp; &lt;/em&gt;&lt;/strong&gt;The data field of the second packet sent by the phone after receiving the C&amp;amp;C command. The data is base64 encoded.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:11.555778503417969%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg" data-image-dimensions="1999x231" data-image-focal-point="0.5,0.5" alt="Figure 29.&amp;nbsp; The data field of the second packet sent by the phone after receiving the C&amp;amp;C command. The data is base64 encoded." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg" width="1999" height="231" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282062994-90ALQF8ASGS77YFVPR9L/image13.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 29.&nbsp; </em></strong>The data field of the second packet sent by the phone after receiving the C&amp;C command. The data is base64 encoded.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_39726"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">The APK code with the function <em>SendMessage</em> that aims to send replies to the C&amp;C commands is shown in Figure 30. The function produces two packets: (i) a packet with the length of the data and (ii) a packet with base64 encoded data.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_41926"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:672px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 30. &lt;/em&gt;&lt;/strong&gt;Function sendMessage() in the APK code that aims to send the information from the phone to the C&amp;amp;C. The function sends two packets: (i) a packet with the data length of the next packet and (ii) a packet with the actual data.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:45.68452072143555%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png" data-image-dimensions="672x307" data-image-focal-point="0.5,0.5" alt="Figure 30. Function sendMessage() in the APK code that aims to send the information from the phone to the C&amp;amp;C. The function sends two packets: (i) a packet with the data length of the next packet and (ii) a packet with the actual data." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png" width="672" height="307" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282116269-FUABEQ6DCVP00KOH91SR/image19.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 30. </em></strong>Function sendMessage() in the APK code that aims to send the information from the phone to the C&amp;C. The function sends two packets: (i) a packet with the data length of the next packet and (ii) a packet with the actual data.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_44775"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">The complete communication between the phone and the controller goes the same way:</p><ol data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The C&amp;C sends the base64 encoded command.</p></li><li><p class="" style="white-space:pre-wrap;">The phone answers with two packets: the first packet with the hexadecimal representation of the data length in the next packet, the second packet with base64 encoded reply to the C&amp;C command.</p></li></ol><p class="" style="white-space:pre-wrap;">As an example, we will analyze the C&amp;C command ‘read SentSMS’ that retrieves all SMS sent from the infected device. The data field of the packet with C&amp;C command ‘read SentSMS’ is displayed in Figure 31.&nbsp;</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_50160"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1999px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 31.&lt;/em&gt;&lt;/strong&gt; The data field of the packet with the C&amp;amp;C command ‘read SentSMS’ that aims to retrieve all SMS sent from the infected device. The data is base64 decoded.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:23.811906814575195%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg" data-image-dimensions="1999x476" data-image-focal-point="0.5,0.5" alt="Figure 31. The data field of the packet with the C&amp;amp;C command ‘read SentSMS’ that aims to retrieve all SMS sent from the infected device. The data is base64 decoded." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg" width="1999" height="476" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282206395-413U0R03ARY2JKM3KEEA/image24.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 31.</em></strong> The data field of the packet with the C&amp;C command ‘read SentSMS’ that aims to retrieve all SMS sent from the infected device. The data is base64 decoded.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_56897"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">The phone replies with two packets: the first packet in Figure 31 and the second packet in Figure 32. Bytes 0x01d8 from the first packet defines 472 bytes in decimal format as the length of the data in the second packet.</p><pre style="text-align:center;"><code>0000 &nbsp; 00 00 01 d8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ....</code></pre><p class="" style="white-space:pre-wrap;"><strong><em>Figure 31. </em></strong>The data field of the first packet sent from the phone as a reply to the C&amp;C command ‘read SentSMS’. Bytes 0x01D8 in hexadecimal form presents 472 bytes in decimal form.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_64839"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1701px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:34.50911331176758%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg" data-image-dimensions="1701x587" data-image-focal-point="0.5,0.5" alt="Figure 32. The data field of the second packet sent from the phone as a reply to the C&amp;amp;C command ‘read sentSMS’. The data has a length of 472 and is base64 encoded." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg" width="1701" height="587" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282292759-CLNHAMFH8ZY5776IC4N7/image20.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 32.</em></strong> The data field of the second packet sent from the phone as a reply to the C&amp;C command ‘read sentSMS’. The data has a length of 472 and is base64 encoded.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_68812"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">During the complete communication between the phone and the controller, there was no heartbeat performed in the TCP connection.</p><h2 style="white-space:pre-wrap;">PCAP Statistics</h2><p class="" style="white-space:pre-wrap;">In order to create some statistics for this capture, we have been looking at all the malicious connections: connection to the database, TCP connections directly with the C&amp;C and connections to the IRC server.</p><p class="" style="white-space:pre-wrap;">In total, there were 21 connections to the RAT’s 000webhost.com database (Figure 33). According to the APK code, a new connection to the database was established every time the IRC servers were refreshed.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_149623"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:974px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 33. &lt;/em&gt;&lt;/strong&gt;All the connections performed to the 000webhost.com database from the phone. In total, there are 21 connections.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:38.50102615356445%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png" data-image-dimensions="974x375" data-image-focal-point="0.5,0.5" alt="Figure 33. All the connections performed to the 000webhost.com database from the phone. In total, there are 21 connections." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png" width="974" height="375" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624282554079-24E9CUSH93L839ER7YF4/image8.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 33. </em></strong>All the connections performed to the 000webhost.com database from the phone. In total, there are 21 connections.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_154831"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">From the APK list of IRC servers, it is clear that the phone connects over ports 6667/TCP, 6668/TCP, 6669/TCP, 7000/TCP and 7020/TCP. After filtering the Zeek conn.log file with all these ports, there were 34 connections to IRC servers in total:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_157344"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:881px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 34. &lt;/em&gt;&lt;/strong&gt;All connections from the phone to IRC servers over ports 6667/TCP, 6668/TCP, 6669/TCP, 7000/TCP, and 7020/TCP.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:70.03404998779297%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png" data-image-dimensions="881x617" data-image-focal-point="0.5,0.5" alt="Figure 34. All connections from the phone to IRC servers over ports 6667/TCP, 6668/TCP, 6669/TCP, 7000/TCP, and 7020/TCP." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png" width="881" height="617" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285057856-FGHOPSJJOCR8SZ9UTX1Q/image1.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 34. </em></strong>All connections from the phone to IRC servers over ports 6667/TCP, 6668/TCP, 6669/TCP, 7000/TCP, and 7020/TCP.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_160425"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">As for the connection to the C&amp;C over port 8000/TCP, there were in total 5 connections: 3 connections were closed with a RESET packet from the C&amp;C, and 2 connections were not closed.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624277493027_162917"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:464px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 32. &lt;/em&gt;&lt;/strong&gt;Five connections over TCP established with the C&amp;amp;C. The connections were ended with the flags RSTR and S1.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:19.181034088134766%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png" data-image-dimensions="464x89" data-image-focal-point="0.5,0.5" alt="Figure 32. Five connections over TCP established with the C&amp;amp;C. The connections were ended with the flags RSTR and S1." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png" width="464" height="89" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624285105591-XYODXCYH9AS6YXYDVD9G/image25.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 32. </em></strong>Five connections over TCP established with the C&amp;C. The connections were ended with the flags RSTR and S1.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624277493027_166091"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Through all the malicious connections, the heartbeat was only performed with IRC servers, which is a normal behaviour of such type of protocol.</p><h1 style="white-space:pre-wrap;">Conclusion</h1><p class="" style="white-space:pre-wrap;">In this blog post we have analyzed the network traffic from a phone infected with the Saefko Attack Systems RAT that uses 3 different methods to operate and control devices. All the retrieved data from the devices was stored in a database stored in the 000webhost.com hosting provider. We were not able to decode the secure connection to the database, but we have successfully decoded the connection to the IRC servers, HTTP and TCP connections. The Saefko RAT seems to be complex in its communication protocol, but it is still not sophisticated in its work.</p><p class="" style="white-space:pre-wrap;">To summarize, the details found in the network traffic of this RAT are:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The RAT is capable of controlling the targeted phone over IRC servers, HTTP request, and TCP connection.</p></li><li><p class="" style="white-space:pre-wrap;">The RAT’s database is hosted on the 000webhost.com web hosting service. And is up to the user to install it.</p></li><li><p class="" style="white-space:pre-wrap;">The connection from the infected device to the database in the 000webhost.com hosting is encrypted.</p></li><li><p class="" style="white-space:pre-wrap;">The packets sent from the controller and the phone over IRC servers follow the structure: ‘SASENCODE’+base64_encode(data + ‘T_T’+timestamp)</p></li><li><p class="" style="white-space:pre-wrap;">The packets sent from the controller and the phone over TCP follow the structure: base64_encode(data in JSON format)</p></li><li><p class="" style="white-space:pre-wrap;">The phone connects to the website ipinfo.io to retrieve and send its location to the C&amp;C.</p></li><li><p class="" style="white-space:pre-wrap;">There is no heartbeat in the TCP communication between the C&amp;C and the phone.</p></li><li><p class="" style="white-space:pre-wrap;">There is a heartbeat between the IRC server and the victim, but it is a normal behaviour for this protocol.</p></li><li><p class="" style="white-space:pre-wrap;">The connections with the C&amp;C over TCP were closed with RSTR and S1 states.</p></li><li><p class="" style="white-space:pre-wrap;">There are 34 connections established to different IRC servers.</p></li><li><p class="" style="white-space:pre-wrap;">There are 21 connections established to the database in the 000webhost.com hosting with the server_name ‘experimentsas.000webhostapp.com’.</p></li></ul><p class="" data-rte-preserve-empty="true" style="white-space:pre-wrap;"></p><p class="" style="white-space:pre-wrap;">Thanks to Vitaly Kim (@mercury0169) for drawing the blog cover picture.</p><h2 style="white-space:pre-wrap;">Biographies</h2>
</div>






















</div></div><div class="row sqs-row"><div class="col sqs-col-6 span-6"><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624287469088_41063"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:300px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:100%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg" data-image-dimensions="300x300" data-image-focal-point="0.5,0.5" alt="KAMILA BABAYEVA" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg" width="300" height="300" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287533558-DGE4XJC7LKY9CP4CGRVK/image5.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;">KAMILA BABAYEVA</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624287469088_82443"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" data-rte-preserve-empty="true" style="white-space:pre-wrap;"></p><p class="" style="white-space:pre-wrap;">Sebastian Garcia is a malware researcher and security teacher with experience in applied machine learning on network traffic. He founded the Stratosphere Lab, aiming to do impactful security research to help others using machine learning. He believes that free software and machine learning tools can help better protect users from abuse of our digital rights. He researches on machine learning for security, honeypots, malware traffic detection, social networks security detection, distributed scanning (dnmap), keystroke dynamics, fake news, Bluetooth analysis, privacy protection, intruder detection, and microphone detection with SDR (Salamandra). He co-founded the MatesLab hackspace in Argentina and co-founded the Independent Fund for Women in Tech. @eldracote. https://www.researchgate.net/profile/Sebastian_Garcia6</p>
</div>






















</div></div></div><div class="col sqs-col-6 span-6"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1624287469088_63109"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Kamila Babayeva is a 20 years old and third-year bachelor student in the Computer Science and Electrical Engineering program at the Czech Technical University in Prague. She is a researcher in the Civilsphere project, a project dedicated to protecting civil organizations and individuals from targeted attacks. Her research focuses on helping people and protecting their digital rights by developing free software based on machine learning. Initially, she worked as a junior Malware Reverser. Currently, Kamila leads the development of the Stratosphere Linux Intrusion Prevent System (Slips), which is used to protect the civil society in the Civilsphere lab.&nbsp;</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1624287469088_75356"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1067px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:104.87348175048828%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png" data-image-dimensions="1067x1119" data-image-focal-point="0.5,0.5" alt="SEBASTIAN GARCIA" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png" width="1067" height="1119" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624287615684-8PNH9HPXVVOI9H9HQ2C4/image1.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;">SEBASTIAN GARCIA</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div></div></div></div></div></div>
      
    </div>

    <footer class="entry-footer clear">
      
      
      <div class="entry-actions">
        
  <span class="sqs-simple-like" data-item-id="60b7c79e65d7df4bcf8373b3" data-like-count="2">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>
<span class="squarespace-social-buttons inline-style" data-system-data-id="1624290530840-DTLBTCUYGIX8B4GWJPU5" data-asset-url="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1624290530840-DTLBTCUYGIX8B4GWJPU5/purple_rat.jpg" data-record-type="1" data-full-url="/blog/2021/6/2/dissecting-a-rat-analysis-of-the-saefko-rat" data-title="Dissecting a RAT. Analysis of the Saefko RAT."></span>
      </div>
    </footer>

    

  </article>

  <div id="comments-60b7c79e65d7df4bcf8373b3" class="p-comment">
    
  <div class="squarespace-comments" id="comments-60b7c79e65d7df4bcf8373b3" data-item-id="60b7c79e65d7df4bcf8373b3" data-public-comment-count="0" data-comment-state="1"></div>

  </div>

  

  
  <nav class="pagination clear">
    <div class="newer"><span class="prev-label">Newer Post</span><a href="/blog/2021/9/20/create-and-test-your-own-taxii-server" rel="prev"><span>Create and Test Your Own TAXII Server</span></a></div><!-- comment the linebreak between these two elements because science
  --><div class="older"><span class="next-label">Older Post</span><a href="/blog/2021/5/6/dissecting-a-rat-analysis-of-the-command-line-androrat" rel="next"><span>Dissecting a RAT. Analysis of the Command-line AndroRAT.</span></a></div>
  </nav>
  

</div>
        </div><!--
        --><aside id="rightSidebar" role="complementary">
          <div class="sqs-layout sqs-grid-12 columns-12 open-block-field empty" data-layout-label="Blog Sidebar Content" data-type="block-field" id="blogBlocks-5a01202be2c48324aeddc117"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>
        </aside>
        
        
      </main>

      <div id="preFooter">
        <div class="pre-footer-inner">
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Pre-Footer Content" data-type="block-field" data-updated-on="1510062674452" id="preFooterBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1410979096848_3228"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 class="text-align-center">Protecting the civil society through high quality research</h1>
</div>






















</div></div></div></div></div>
        </div>
      </div>

      <footer id="footer" role="contentinfo">
        <div class="footer-inner">
          <div class="nav-wrapper back-to-top-nav"><nav><div class="back-to-top"><a href="#header">Back to Top</a></div></nav></div>
          


          <div id="siteInfo"><span class="site-address">Karlovo náměstí, Praha, Czech Republic</span><a href="mailto:stratosphere@aic.fel.cvut.cz" class="site-email"><span>stratosphere@aic.fel.cvut.cz</span></a></div>
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Footer Content" data-type="block-field" data-updated-on="1531498156355" id="footerBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block socialaccountlinks-v2-block sqs-block-socialaccountlinks-v2" data-block-type="54" id="block-yui_3_17_2_4_1519219355521_4463"><div class="sqs-block-content">



<div class="sqs-svg-icon--outer social-icon-alignment-center social-icons-color-white social-icons-size-extra-large social-icons-style-regular " >
  <style>
    #block-yui_3_17_2_4_1519219355521_4463 .social-icons-style-border .sqs-svg-icon--wrapper {
      
        box-shadow: 0 0 0 2px inset;
      
      border: none; 
    }
  </style>
  <nav class="sqs-svg-icon--list">
    <a href="https://twitter.com/StratosphereIPS" target="_blank" class="sqs-svg-icon--wrapper twitter-unauth" aria-label="Twitter">
      <div>
        <svg class="sqs-svg-icon--social" viewBox="0 0 64 64">
          <use class="sqs-use--icon" xlink:href="#twitter-unauth-icon"></use>
          <use class="sqs-use--mask" xlink:href="#twitter-unauth-mask"></use>
        </svg>
      </div>
    </a>
  </nav>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-713fe491a2c303b33937"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="text-align-center">Powered by <a target="_blank" href="http://www.squarespace.com?channel=word_of_mouth&amp;subchannel=customer&amp;source=footer&amp;campaign=4fd1028ee4b02be53c65dfb3">Squarespace</a></p>
</div>






















</div></div></div></div></div>
        </div>
      </footer>

    </div>

    <script defer="true" src="https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1053/scripts/site-bundle.js" type="text/javascript"></script>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="twitter-unauth-icon" viewBox="0 0 64 64"><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"/></symbol><symbol id="twitter-unauth-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M44.7,25.5c0,0.3,0,0.6,0,0.8C44.7,35,38.1,45,26.1,45c-3.7,0-7.2-1.1-10.1-2.9 c0.5,0.1,1,0.1,1.6,0.1c3.1,0,5.9-1,8.2-2.8c-2.9-0.1-5.3-2-6.1-4.6c0.4,0.1,0.8,0.1,1.2,0.1c0.6,0,1.2-0.1,1.7-0.2 c-3-0.6-5.3-3.3-5.3-6.4c0,0,0-0.1,0-0.1c0.9,0.5,1.9,0.8,3,0.8c-1.8-1.2-2.9-3.2-2.9-5.5c0-1.2,0.3-2.3,0.9-3.3 c3.2,4,8.1,6.6,13.5,6.9c-0.1-0.5-0.2-1-0.2-1.5c0-3.6,2.9-6.6,6.6-6.6c1.9,0,3.6,0.8,4.8,2.1c1.5-0.3,2.9-0.8,4.2-1.6 c-0.5,1.5-1.5,2.8-2.9,3.6c1.3-0.2,2.6-0.5,3.8-1C47.1,23.4,46,24.5,44.7,25.5z"/></symbol></svg>

  </body>
</html>
