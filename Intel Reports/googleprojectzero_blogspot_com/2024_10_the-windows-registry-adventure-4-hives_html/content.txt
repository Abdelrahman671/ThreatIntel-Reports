<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://googleprojectzero.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Project Zero - RSS" href="https://googleprojectzero.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Project Zero - Atom" href="https://www.blogger.com/feeds/4838136820032157985/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/1716815613826485459/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/s1200/image3.png' rel='image_src'/>
<meta content='https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html' property='og:url'/>
<meta content='The Windows Registry Adventure #4: Hives and the registry layout' property='og:title'/>
<meta content='  Posted by Mateusz Jurczyk, Google Project Zero     To a normal user or even a Win32 application developer, the registry layout may seem si...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/w1200-h630-p-k-no-nu/image3.png' property='og:image'/>
<title>Project Zero: The Windows Registry Adventure #4: Hives and the registry layout</title>
<style type='text/css'>@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4taVIGxA.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4kaVIGxA.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4saVIGxA.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4jaVIGxA.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4iaVIGxA.woff2)format('woff2');unicode-range:U+0307-0308,U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5caVIGxA.woff2)format('woff2');unicode-range:U+0302-0303,U+0305,U+0307-0308,U+0310,U+0312,U+0315,U+031A,U+0326-0327,U+032C,U+032F-0330,U+0332-0333,U+0338,U+033A,U+0346,U+034D,U+0391-03A1,U+03A3-03A9,U+03B1-03C9,U+03D1,U+03D5-03D6,U+03F0-03F1,U+03F4-03F5,U+2016-2017,U+2034-2038,U+203C,U+2040,U+2043,U+2047,U+2050,U+2057,U+205F,U+2070-2071,U+2074-208E,U+2090-209C,U+20D0-20DC,U+20E1,U+20E5-20EF,U+2100-2112,U+2114-2115,U+2117-2121,U+2123-214F,U+2190,U+2192,U+2194-21AE,U+21B0-21E5,U+21F1-21F2,U+21F4-2211,U+2213-2214,U+2216-22FF,U+2308-230B,U+2310,U+2319,U+231C-2321,U+2336-237A,U+237C,U+2395,U+239B-23B7,U+23D0,U+23DC-23E1,U+2474-2475,U+25AF,U+25B3,U+25B7,U+25BD,U+25C1,U+25CA,U+25CC,U+25FB,U+266D-266F,U+27C0-27FF,U+2900-2AFF,U+2B0E-2B11,U+2B30-2B4C,U+2BFE,U+3030,U+FF5B,U+FF5D,U+1D400-1D7FF,U+1EE00-1EEFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5OaVIGxA.woff2)format('woff2');unicode-range:U+0001-000C,U+000E-001F,U+007F-009F,U+20DD-20E0,U+20E2-20E4,U+2150-218F,U+2190,U+2192,U+2194-2199,U+21AF,U+21E6-21F0,U+21F3,U+2218-2219,U+2299,U+22C4-22C6,U+2300-243F,U+2440-244A,U+2460-24FF,U+25A0-27BF,U+2800-28FF,U+2921-2922,U+2981,U+29BF,U+29EB,U+2B00-2BFF,U+4DC0-4DFF,U+FFF9-FFFB,U+10140-1018E,U+10190-1019C,U+101A0,U+101D0-101FD,U+102E0-102FB,U+10E60-10E7E,U+1D2C0-1D2D3,U+1D2E0-1D37F,U+1F000-1F0FF,U+1F100-1F1AD,U+1F1E6-1F1FF,U+1F30D-1F30F,U+1F315,U+1F31C,U+1F31E,U+1F320-1F32C,U+1F336,U+1F378,U+1F37D,U+1F382,U+1F393-1F39F,U+1F3A7-1F3A8,U+1F3AC-1F3AF,U+1F3C2,U+1F3C4-1F3C6,U+1F3CA-1F3CE,U+1F3D4-1F3E0,U+1F3ED,U+1F3F1-1F3F3,U+1F3F5-1F3F7,U+1F408,U+1F415,U+1F41F,U+1F426,U+1F43F,U+1F441-1F442,U+1F444,U+1F446-1F449,U+1F44C-1F44E,U+1F453,U+1F46A,U+1F47D,U+1F4A3,U+1F4B0,U+1F4B3,U+1F4B9,U+1F4BB,U+1F4BF,U+1F4C8-1F4CB,U+1F4D6,U+1F4DA,U+1F4DF,U+1F4E3-1F4E6,U+1F4EA-1F4ED,U+1F4F7,U+1F4F9-1F4FB,U+1F4FD-1F4FE,U+1F503,U+1F507-1F50B,U+1F50D,U+1F512-1F513,U+1F53E-1F54A,U+1F54F-1F5FA,U+1F610,U+1F650-1F67F,U+1F687,U+1F68D,U+1F691,U+1F694,U+1F698,U+1F6AD,U+1F6B2,U+1F6B9-1F6BA,U+1F6BC,U+1F6C6-1F6CF,U+1F6D3-1F6D7,U+1F6E0-1F6EA,U+1F6F0-1F6F3,U+1F6F7-1F6FC,U+1F700-1F7FF,U+1F800-1F80B,U+1F810-1F847,U+1F850-1F859,U+1F860-1F887,U+1F890-1F8AD,U+1F8B0-1F8BB,U+1F8C0-1F8C1,U+1F900-1F90B,U+1F93B,U+1F946,U+1F984,U+1F996,U+1F9E9,U+1FA00-1FA6F,U+1FA70-1FA7C,U+1FA80-1FA89,U+1FA8F-1FAC6,U+1FACE-1FADC,U+1FADF-1FAE9,U+1FAF0-1FAF8,U+1FB00-1FBFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4vaVIGxA.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4uaVIGxA.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4gaVI.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Group description="Page Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#222222"/>
</Group>
<Group description="Backgrounds" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd"/>
<Variable name="content.background.color" description="Main Background" type="color" default="#ffffff"/>
<Variable name="header.background.color" description="Header Background" type="color" default="transparent"/>
</Group>
<Group description="Links" selector=".main-outer">
<Variable name="link.color" description="Link Color" type="color" default="#2288bb"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#888888"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Font" type="font"
default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#3399bb" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.text.color" description="Description Color" type="color"
default="#777777" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#999999"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, .comments h4">
<Variable name="post.title.font" description="Font" type="font"
default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
</Group>
<Group description="Date Header" selector=".date-header">
<Variable name="date.header.color" description="Text Color" type="color"
default="#000000"/>
<Variable name="date.header.background.color" description="Background Color" type="color"
default="transparent"/>
<Variable name="date.header.font" description="Text Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit"/>
<Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit"/>
<Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit"/>
</Group>
<Group description="Post Footer" selector=".post-footer">
<Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="post.footer.background.color" description="Background Color" type="color"
default="#f9f9f9"/>
<Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadgets" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999"/>
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="#ffffff"/>
<Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee"/>
<Variable name="image.text.color" description="Caption Text Color" type="color" default="#000000"/>
</Group>
<Group description="Accents" selector=".content-inner">
<Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee"/>
<Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="transparent"/>
</Group>
<Variable name="body.background" description="Body Background" type="background"
color="#eeeeee" default="$(color) none repeat scroll top left"/>
<Variable name="body.background.override" description="Body Background Override" type="string" default=""/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png)"/>
<Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner"/>
<Variable name="content.padding" description="Content Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" min="0" max="100px"/>
<Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" min="0" max="100px"/>
<Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" min="0" max="100px"/>
<Variable name="main.border.width" description="Main Border Width" type="length" default="0" min="0" max="10px"/>
<Variable name="header.background.gradient" description="Header Gradient" type="url" default="none"/>
<Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" min="0" max="100px"/>
<Variable name="header.padding" description="Header Padding" type="length" default="30px" min="0" max="100px"/>
<Variable name="header.border.size" description="Header Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="description.text.size" description="Description Text Size" type="string" default="140%"/>
<Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px" min="0" max="100px"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" min="0" max="100px"/>
<Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" min="0" max="10px"/>
<Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" min="0" max="10px"/>
<Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner"/>
<Variable name="page.width" description="Page Width" type="string" default="auto"/>
<Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding" description="Main Padding" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" min="0" max="100px"/>
<Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" min="0" max="100px"/>
<Variable name="paging.background"
color="#ffffff"
description="Background of blog paging area" type="background"
default="transparent none no-repeat scroll top center"/>
<Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" min="0" max="10px"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Open Sans;
color: #000000;
background: #eeeeee none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 40px Open Sans;
color: #000000;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px Open Sans;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Open Sans;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(//www.blogblog.com/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #000000;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1120px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1120px;
max-width: 1120px;
_width: 1120px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<script type='text/javascript'>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-240546891-1', 'auto', 'blogger');
        ga('blogger.send', 'pageview');
      </script>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=4b6deb10-59a2-4d3b-8b32-4b523c19fa3c' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=4b6deb10-59a2-4d3b-8b32-4b523c19fa3c' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4838136820032157985\x26blogName\x3dProject+Zero\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://googleprojectzero.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://googleprojectzero.blogspot.com/\x26targetPostID\x3d1716815613826485459\x26blogPostOrPageUrl\x3dhttps://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html\x26vt\x3d-3236074359124648769',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://googleprojectzero.blogspot.com/'>
Project Zero
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>News and updates from the Project Zero team at Google</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Friday, October 25, 2024</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/s1200/image3.png' itemprop='image_url'/>
<meta content='4838136820032157985' itemprop='blogId'/>
<meta content='1716815613826485459' itemprop='postId'/>
<a name='1716815613826485459'></a>
<h3 class='post-title entry-title' itemprop='name'>
The Windows Registry Adventure #4: Hives and the registry layout
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-1716815613826485459' itemprop='description articleBody'>
<style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=XGMkxXUZTA64h2imyzu79g);.lst-kix_xrbpc8tfqvva-7>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-7,lower-latin) ". "}.lst-kix_xrbpc8tfqvva-6>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-6,decimal) ". "}.lst-kix_phgwltrvdlzg-8>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-8}.lst-kix_xrbpc8tfqvva-0>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-0,decimal) ". "}.lst-kix_xrbpc8tfqvva-8>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-8,lower-roman) ". "}.lst-kix_tidwaau4ppsg-2>li:before{content:"\0025a0   "}.lst-kix_xrbpc8tfqvva-1>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-1,lower-latin) ". "}.lst-kix_tidwaau4ppsg-1>li:before{content:"\0025cb   "}.lst-kix_xrbpc8tfqvva-2>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-2,lower-roman) ". "}ol.lst-kix_phgwltrvdlzg-5.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-5 0}.lst-kix_xrbpc8tfqvva-3>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-3,decimal) ". "}.lst-kix_xrbpc8tfqvva-5>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-5,lower-roman) ". "}.lst-kix_tidwaau4ppsg-0>li:before{content:"\0025cf   "}.lst-kix_xrbpc8tfqvva-4>li:before{content:"" counter(lst-ctn-kix_xrbpc8tfqvva-4,lower-latin) ". "}.lst-kix_xrbpc8tfqvva-2>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-2}.lst-kix_r30wc2x8r6xx-8>li:before{content:"\0025a0   "}.lst-kix_r30wc2x8r6xx-7>li:before{content:"\0025cb   "}ol.lst-kix_xrbpc8tfqvva-6.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-6 0}.lst-kix_r30wc2x8r6xx-4>li:before{content:"\0025cb   "}.lst-kix_r30wc2x8r6xx-3>li:before{content:"\0025cf   "}.lst-kix_tidwaau4ppsg-4>li:before{content:"\0025cb   "}.lst-kix_r30wc2x8r6xx-2>li:before{content:"\0025a0   "}.lst-kix_tidwaau4ppsg-3>li:before{content:"\0025cf   "}.lst-kix_tidwaau4ppsg-5>li:before{content:"\0025a0   "}.lst-kix_tidwaau4ppsg-6>li:before{content:"\0025cf   "}.lst-kix_syb5po7nfbu-7>li{counter-increment:lst-ctn-kix_syb5po7nfbu-7}.lst-kix_r30wc2x8r6xx-5>li:before{content:"\0025a0   "}.lst-kix_tidwaau4ppsg-8>li:before{content:"\0025a0   "}.lst-kix_r30wc2x8r6xx-6>li:before{content:"\0025cf   "}.lst-kix_tidwaau4ppsg-7>li:before{content:"\0025cb   "}ul.lst-kix_qmeq7xkrbxt-4{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-3{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-6{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-5{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-8{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-7{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-0{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-2{list-style-type:none}ul.lst-kix_qmeq7xkrbxt-1{list-style-type:none}.lst-kix_r30wc2x8r6xx-0>li:before{content:"\0025cf   "}.lst-kix_r30wc2x8r6xx-1>li:before{content:"\0025cb   "}ol.lst-kix_phgwltrvdlzg-0.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-0 0}.lst-kix_xrbpc8tfqvva-4>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-4}ol.lst-kix_syb5po7nfbu-4.start{counter-reset:lst-ctn-kix_syb5po7nfbu-4 0}.lst-kix_syb5po7nfbu-2>li{counter-increment:lst-ctn-kix_syb5po7nfbu-2}ul.lst-kix_6a34hny9fd1v-8{list-style-type:none}ul.lst-kix_6a34hny9fd1v-5{list-style-type:none}ul.lst-kix_6a34hny9fd1v-4{list-style-type:none}ul.lst-kix_6a34hny9fd1v-7{list-style-type:none}ul.lst-kix_6a34hny9fd1v-6{list-style-type:none}ul.lst-kix_6a34hny9fd1v-1{list-style-type:none}ul.lst-kix_6a34hny9fd1v-0{list-style-type:none}ul.lst-kix_6a34hny9fd1v-3{list-style-type:none}.lst-kix_qmeq7xkrbxt-7>li:before{content:"\0025cb   "}ul.lst-kix_6a34hny9fd1v-2{list-style-type:none}.lst-kix_qmeq7xkrbxt-6>li:before{content:"\0025cf   "}.lst-kix_qmeq7xkrbxt-4>li:before{content:"\0025cb   "}.lst-kix_qmeq7xkrbxt-3>li:before{content:"\0025cf   "}.lst-kix_qmeq7xkrbxt-5>li:before{content:"\0025a0   "}ol.lst-kix_phgwltrvdlzg-6.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-6 0}.lst-kix_fmufqr7nbrst-6>li:before{content:"\0025cf   "}.lst-kix_qmeq7xkrbxt-0>li:before{content:"\0025cf   "}.lst-kix_qmeq7xkrbxt-1>li:before{content:"\0025cb   "}.lst-kix_fmufqr7nbrst-7>li:before{content:"\0025cb   "}.lst-kix_qmeq7xkrbxt-2>li:before{content:"\0025a0   "}.lst-kix_phgwltrvdlzg-6>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-6}.lst-kix_fmufqr7nbrst-8>li:before{content:"\0025a0   "}ol.lst-kix_syb5po7nfbu-3.start{counter-reset:lst-ctn-kix_syb5po7nfbu-3 0}.lst-kix_fmufqr7nbrst-1>li:before{content:"\0025cb   "}.lst-kix_fmufqr7nbrst-3>li:before{content:"\0025cf   "}.lst-kix_ok7mir9xvsfk-7>li:before{content:"\0025cb   "}.lst-kix_m1h2nk6mxy3s-0>li:before{content:"\0025cf   "}ol.lst-kix_syb5po7nfbu-2.start{counter-reset:lst-ctn-kix_syb5po7nfbu-2 0}.lst-kix_syb5po7nfbu-4>li{counter-increment:lst-ctn-kix_syb5po7nfbu-4}.lst-kix_m1h2nk6mxy3s-2>li:before{content:"\0025a0   "}.lst-kix_phgwltrvdlzg-2>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-2}.lst-kix_6a34hny9fd1v-1>li:before{content:"\0025cb   "}.lst-kix_fmufqr7nbrst-5>li:before{content:"\0025a0   "}.lst-kix_ok7mir9xvsfk-3>li:before{content:"\0025cf   "}ul.lst-kix_t322xbujlsbo-1{list-style-type:none}ul.lst-kix_t322xbujlsbo-2{list-style-type:none}.lst-kix_6a34hny9fd1v-5>li:before{content:"\0025a0   "}.lst-kix_6a34hny9fd1v-7>li:before{content:"\0025cb   "}ul.lst-kix_t322xbujlsbo-0{list-style-type:none}ol.lst-kix_phgwltrvdlzg-6{list-style-type:none}ul.lst-kix_t322xbujlsbo-5{list-style-type:none}ol.lst-kix_phgwltrvdlzg-7{list-style-type:none}ul.lst-kix_t322xbujlsbo-6{list-style-type:none}ol.lst-kix_phgwltrvdlzg-8{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-2.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-2 0}ul.lst-kix_t322xbujlsbo-3{list-style-type:none}ul.lst-kix_t322xbujlsbo-4{list-style-type:none}ol.lst-kix_phgwltrvdlzg-2{list-style-type:none}.lst-kix_qmeq7xkrbxt-8>li:before{content:"\0025a0   "}ol.lst-kix_phgwltrvdlzg-3{list-style-type:none}ol.lst-kix_phgwltrvdlzg-4{list-style-type:none}.lst-kix_6a34hny9fd1v-3>li:before{content:"\0025cf   "}ul.lst-kix_t322xbujlsbo-7{list-style-type:none}ol.lst-kix_phgwltrvdlzg-5{list-style-type:none}.lst-kix_ok7mir9xvsfk-5>li:before{content:"\0025a0   "}ul.lst-kix_t322xbujlsbo-8{list-style-type:none}ol.lst-kix_phgwltrvdlzg-0{list-style-type:none}ol.lst-kix_phgwltrvdlzg-1{list-style-type:none}.lst-kix_phgwltrvdlzg-1>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-1}.lst-kix_xrbpc8tfqvva-8>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-8}.lst-kix_syb5po7nfbu-8>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-8,lower-roman) ". "}.lst-kix_t322xbujlsbo-1>li:before{content:"\0025cb   "}.lst-kix_syb5po7nfbu-4>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-4,lower-latin) ". "}.lst-kix_ok7mir9xvsfk-1>li:before{content:"\0025cb   "}.lst-kix_syb5po7nfbu-2>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-2,lower-roman) ". "}.lst-kix_syb5po7nfbu-6>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-6,decimal) ". "}.lst-kix_t322xbujlsbo-3>li:before{content:"\0025cf   "}.lst-kix_t322xbujlsbo-7>li:before{content:"\0025cb   "}ol.lst-kix_phgwltrvdlzg-1.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-1 0}.lst-kix_t322xbujlsbo-5>li:before{content:"\0025a0   "}ol.lst-kix_xrbpc8tfqvva-0.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-0 0}ol.lst-kix_phgwltrvdlzg-4.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-4 0}ul.lst-kix_ok7mir9xvsfk-0{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-2{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-1{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-4{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-3{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-6{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-5{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-8{list-style-type:none}ul.lst-kix_ok7mir9xvsfk-7{list-style-type:none}ol.lst-kix_phgwltrvdlzg-3.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-3 0}ol.lst-kix_syb5po7nfbu-7{list-style-type:none}.lst-kix_syb5po7nfbu-3>li{counter-increment:lst-ctn-kix_syb5po7nfbu-3}ol.lst-kix_syb5po7nfbu-8{list-style-type:none}.lst-kix_m1h2nk6mxy3s-6>li:before{content:"\0025cf   "}ol.lst-kix_syb5po7nfbu-5{list-style-type:none}ol.lst-kix_syb5po7nfbu-6{list-style-type:none}ol.lst-kix_syb5po7nfbu-3{list-style-type:none}ol.lst-kix_syb5po7nfbu-4{list-style-type:none}.lst-kix_m1h2nk6mxy3s-4>li:before{content:"\0025cb   "}.lst-kix_m1h2nk6mxy3s-8>li:before{content:"\0025a0   "}ol.lst-kix_syb5po7nfbu-0.start{counter-reset:lst-ctn-kix_syb5po7nfbu-0 0}ol.lst-kix_syb5po7nfbu-1{list-style-type:none}ol.lst-kix_syb5po7nfbu-2{list-style-type:none}ol.lst-kix_syb5po7nfbu-0{list-style-type:none}.lst-kix_xrbpc8tfqvva-3>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-3}ol.lst-kix_xrbpc8tfqvva-1.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-1 0}ul.lst-kix_fmufqr7nbrst-2{list-style-type:none}ul.lst-kix_fmufqr7nbrst-3{list-style-type:none}ul.lst-kix_fmufqr7nbrst-0{list-style-type:none}ul.lst-kix_fmufqr7nbrst-1{list-style-type:none}ul.lst-kix_fmufqr7nbrst-6{list-style-type:none}ul.lst-kix_fmufqr7nbrst-7{list-style-type:none}ul.lst-kix_fmufqr7nbrst-4{list-style-type:none}ul.lst-kix_fmufqr7nbrst-5{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-8{list-style-type:none}ul.lst-kix_fmufqr7nbrst-8{list-style-type:none}ol.lst-kix_phgwltrvdlzg-2.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-2 0}.lst-kix_xrbpc8tfqvva-1>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-1}ul.lst-kix_tidwaau4ppsg-8{list-style-type:none}ul.lst-kix_tidwaau4ppsg-7{list-style-type:none}ul.lst-kix_tidwaau4ppsg-6{list-style-type:none}.lst-kix_phgwltrvdlzg-7>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-7}ol.lst-kix_syb5po7nfbu-1.start{counter-reset:lst-ctn-kix_syb5po7nfbu-1 0}ol.lst-kix_phgwltrvdlzg-8.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-8 0}ol.lst-kix_xrbpc8tfqvva-1{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-0{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-3.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-3 0}ul.lst-kix_m1h2nk6mxy3s-0{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-3{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-1{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-2{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-2{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-5{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-3{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-4{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-4{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-7{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-5{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-6{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-6{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-7{list-style-type:none}ul.lst-kix_m1h2nk6mxy3s-8{list-style-type:none}.lst-kix_phgwltrvdlzg-0>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-0}.lst-kix_syb5po7nfbu-1>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-1,lower-latin) ". "}.lst-kix_t322xbujlsbo-8>li:before{content:"\0025a0   "}.lst-kix_syb5po7nfbu-1>li{counter-increment:lst-ctn-kix_syb5po7nfbu-1}.lst-kix_syb5po7nfbu-0>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-0,decimal) ". "}ol.lst-kix_phgwltrvdlzg-7.start{counter-reset:lst-ctn-kix_phgwltrvdlzg-7 0}.lst-kix_phgwltrvdlzg-7>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-7,lower-latin) ". "}.lst-kix_phgwltrvdlzg-8>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-8,lower-roman) ". "}ul.lst-kix_tidwaau4ppsg-5{list-style-type:none}.lst-kix_syb5po7nfbu-8>li{counter-increment:lst-ctn-kix_syb5po7nfbu-8}ul.lst-kix_tidwaau4ppsg-4{list-style-type:none}ul.lst-kix_tidwaau4ppsg-3{list-style-type:none}ul.lst-kix_tidwaau4ppsg-2{list-style-type:none}ul.lst-kix_tidwaau4ppsg-1{list-style-type:none}ul.lst-kix_tidwaau4ppsg-0{list-style-type:none}.lst-kix_phgwltrvdlzg-6>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-6,decimal) ". "}.lst-kix_phgwltrvdlzg-5>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-5,lower-roman) ". "}.lst-kix_phgwltrvdlzg-4>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-4,lower-latin) ". "}.lst-kix_phgwltrvdlzg-2>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-2,lower-roman) ". "}.lst-kix_phgwltrvdlzg-1>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-1,lower-latin) ". "}.lst-kix_phgwltrvdlzg-3>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-3,decimal) ". "}.lst-kix_phgwltrvdlzg-3>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-3}ol.lst-kix_xrbpc8tfqvva-4.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-4 0}.lst-kix_phgwltrvdlzg-0>li:before{content:"" counter(lst-ctn-kix_phgwltrvdlzg-0,decimal) ". "}ul.lst-kix_r30wc2x8r6xx-6{list-style-type:none}ul.lst-kix_r30wc2x8r6xx-7{list-style-type:none}ul.lst-kix_r30wc2x8r6xx-8{list-style-type:none}.lst-kix_fmufqr7nbrst-2>li:before{content:"\0025a0   "}.lst-kix_ok7mir9xvsfk-8>li:before{content:"\0025a0   "}.lst-kix_6a34hny9fd1v-2>li:before{content:"\0025a0   "}.lst-kix_m1h2nk6mxy3s-3>li:before{content:"\0025cf   "}.lst-kix_6a34hny9fd1v-0>li:before{content:"\0025cf   "}.lst-kix_m1h2nk6mxy3s-1>li:before{content:"\0025cb   "}.lst-kix_fmufqr7nbrst-4>li:before{content:"\0025cb   "}.lst-kix_ok7mir9xvsfk-2>li:before{content:"\0025a0   "}.lst-kix_6a34hny9fd1v-6>li:before{content:"\0025cf   "}.lst-kix_xrbpc8tfqvva-7>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-7}.lst-kix_ok7mir9xvsfk-4>li:before{content:"\0025cb   "}ol.lst-kix_xrbpc8tfqvva-5.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-5 0}.lst-kix_6a34hny9fd1v-4>li:before{content:"\0025cb   "}.lst-kix_syb5po7nfbu-5>li{counter-increment:lst-ctn-kix_syb5po7nfbu-5}.lst-kix_fmufqr7nbrst-0>li:before{content:"\0025cf   "}.lst-kix_ok7mir9xvsfk-6>li:before{content:"\0025cf   "}.lst-kix_phgwltrvdlzg-4>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-4}.lst-kix_xrbpc8tfqvva-5>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-5}.lst-kix_syb5po7nfbu-7>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-7,lower-latin) ". "}.lst-kix_t322xbujlsbo-0>li:before{content:"\0025cf   "}.lst-kix_t322xbujlsbo-2>li:before{content:"\0025a0   "}ol.lst-kix_syb5po7nfbu-5.start{counter-reset:lst-ctn-kix_syb5po7nfbu-5 0}.lst-kix_6a34hny9fd1v-8>li:before{content:"\0025a0   "}.lst-kix_syb5po7nfbu-3>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-3,decimal) ". "}.lst-kix_syb5po7nfbu-5>li:before{content:"" counter(lst-ctn-kix_syb5po7nfbu-5,lower-roman) ". "}.lst-kix_t322xbujlsbo-4>li:before{content:"\0025cb   "}.lst-kix_t322xbujlsbo-6>li:before{content:"\0025cf   "}.lst-kix_ok7mir9xvsfk-0>li:before{content:"\0025cf   "}ul.lst-kix_r30wc2x8r6xx-2{list-style-type:none}ul.lst-kix_r30wc2x8r6xx-3{list-style-type:none}ul.lst-kix_r30wc2x8r6xx-4{list-style-type:none}ul.lst-kix_r30wc2x8r6xx-5{list-style-type:none}ol.lst-kix_syb5po7nfbu-8.start{counter-reset:lst-ctn-kix_syb5po7nfbu-8 0}ul.lst-kix_r30wc2x8r6xx-0{list-style-type:none}ul.lst-kix_r30wc2x8r6xx-1{list-style-type:none}ol.lst-kix_xrbpc8tfqvva-7.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-7 0}.lst-kix_phgwltrvdlzg-5>li{counter-increment:lst-ctn-kix_phgwltrvdlzg-5}.lst-kix_syb5po7nfbu-6>li{counter-increment:lst-ctn-kix_syb5po7nfbu-6}ol.lst-kix_syb5po7nfbu-7.start{counter-reset:lst-ctn-kix_syb5po7nfbu-7 0}ol.lst-kix_xrbpc8tfqvva-8.start{counter-reset:lst-ctn-kix_xrbpc8tfqvva-8 0}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_syb5po7nfbu-0>li{counter-increment:lst-ctn-kix_syb5po7nfbu-0}.lst-kix_m1h2nk6mxy3s-7>li:before{content:"\0025cb   "}ol.lst-kix_syb5po7nfbu-6.start{counter-reset:lst-ctn-kix_syb5po7nfbu-6 0}.lst-kix_xrbpc8tfqvva-0>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-0}.lst-kix_m1h2nk6mxy3s-5>li:before{content:"\0025a0   "}.lst-kix_xrbpc8tfqvva-6>li{counter-increment:lst-ctn-kix_xrbpc8tfqvva-6}ol{margin:0;padding:0}table td,table th{padding:0}.BGxMwKFqAI-c26{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:224.2pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c30{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:194.2pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c33{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:189pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c32{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:234.8pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c25{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:460.5pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c31{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:453.8pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c45{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:187.5pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c39{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.BGxMwKFqAI-c0{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.BGxMwKFqAI-c36{padding-top:18pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;text-align:left}.BGxMwKFqAI-c42{padding-top:18pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;text-align:left}.BGxMwKFqAI-c44{padding-top:14pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;text-align:left}.BGxMwKFqAI-c28{padding-top:14pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;text-align:left}.BGxMwKFqAI-c49{padding-top:16pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;text-align:left}.BGxMwKFqAI-c1{font-size:9pt;font-family:"Roboto Mono";color:#37474f;font-weight:400}.BGxMwKFqAI-c3{font-size:9pt;font-family:"Roboto Mono";color:#c5221f;font-weight:400}.BGxMwKFqAI-c11{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.BGxMwKFqAI-c5{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.BGxMwKFqAI-c43{border-spacing:0;border-collapse:collapse;margin-right:auto}.BGxMwKFqAI-c7{color:#000000;font-weight:400;font-size:9pt;font-family:"Roboto Mono"}.BGxMwKFqAI-c34{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.BGxMwKFqAI-c22{color:#434343;font-weight:400;font-size:14pt;font-family:"Arial"}.BGxMwKFqAI-c27{color:#666666;font-weight:400;font-size:12pt;font-family:"Arial"}.BGxMwKFqAI-c12{color:#000000;font-weight:400;font-size:7pt;font-family:"Roboto Mono"}.BGxMwKFqAI-c37{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:center}.BGxMwKFqAI-c10{color:#188038;font-weight:400;font-size:9pt;font-family:"Roboto Mono"}.BGxMwKFqAI-c4{padding-top:0pt;padding-bottom:0pt;line-height:1.5;text-align:left}.BGxMwKFqAI-c2{font-size:7pt;font-family:"Roboto Mono";color:#188038;font-weight:400}.BGxMwKFqAI-c6{text-decoration:none;vertical-align:baseline;font-style:normal}.BGxMwKFqAI-c19{color:#000000;font-size:11pt;font-family:"Arial"}.BGxMwKFqAI-c29{-webkit-text-decoration-skip:none;text-decoration:line-through;text-decoration-skip-ink:none}.BGxMwKFqAI-c9{font-size:8pt;font-family:"Roboto Mono";font-weight:400}.BGxMwKFqAI-c15{font-size:7pt;font-family:"Roboto Mono";font-weight:400}.BGxMwKFqAI-c50{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.BGxMwKFqAI-c20{font-size:9pt;font-family:"Roboto Mono";font-weight:400}.BGxMwKFqAI-c40{font-weight:400;font-size:16pt;font-family:"Arial"}.BGxMwKFqAI-c48{text-decoration:none;vertical-align:baseline}.BGxMwKFqAI-c8{orphans:2;widows:2}.BGxMwKFqAI-c47{margin-left:72pt;padding-left:0pt}.BGxMwKFqAI-c23{margin-left:36pt;padding-left:0pt}.BGxMwKFqAI-c41{vertical-align:baseline;font-style:normal}.BGxMwKFqAI-c18{height:11pt}.BGxMwKFqAI-c21{color:#37474f}.BGxMwKFqAI-c17{font-weight:700}.BGxMwKFqAI-c38{background-color:#d9d9d9}.BGxMwKFqAI-c35{color:#000000}.BGxMwKFqAI-c14{font-style:italic}.BGxMwKFqAI-c13{height:0pt}.BGxMwKFqAI-c24{color:#b80672}.BGxMwKFqAI-c16{color:#c5221f}.BGxMwKFqAI-c46{color:#1967d2}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c50 doc-content">
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Posted by Mateusz Jurczyk, Google Project Zero</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>To a normal user or even a Win32 application developer, the registry layout may seem simple: there are five root keys that we know from Regedit (abbreviated as HKCR, HKLM, HKCU, HKU and HKCC), and each of them contains a nested tree structure that serves a specific role in the system. But as one tries to dig deeper and understand how the registry </span><span class="BGxMwKFqAI-c14">really</span><span>&nbsp;works internally, things may get confusing really fast. What are </span><span class="BGxMwKFqAI-c14">hives</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">? How do they map or relate to the top-level keys? Why are some HKEY root keys pointing inside of other root keys (e.g. HKCU being located under HKU)? These are all valid questions, but they are difficult to answer without fully understanding the interactions between the user-mode Registry API and the kernel-mode registry interface, so let&#39;s start there.</span></p><h2 class="BGxMwKFqAI-c8 BGxMwKFqAI-c36" id="h.q37xztn1poe2"><span>The high-level view</span></h2>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">A simplified diagram of the execution flow taken when an application creates a registry key is shown below:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/s1999/image3.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="A diagram illustrating the call stack for the RegCreateKeyEx function in Windows. It shows the transition from user-mode to kernel-mode through various API calls: * **User-mode:** * Application.exe calls RegCreateKeyEx in KernelBase.dll * KernelBase.dll calls NtCreateKey in ntdll.dll * ntdll.dll makes a system call to NtCreateKey * **Kernel-mode:** * ntoskrnl.exe executes the NtCreateKey syscall" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/s1200/image3.png" style="max-height: 750px; max-width: 600px;" title="A diagram illustrating the call stack for the RegCreateKeyEx function in Windows. It shows the transition from user-mode to kernel-mode through various API calls: * **User-mode:** * Application.exe calls RegCreateKeyEx in KernelBase.dll * KernelBase.dll calls NtCreateKey in ntdll.dll * ntdll.dll makes a system call to NtCreateKey * **Kernel-mode:** * ntoskrnl.exe executes the NtCreateKey syscall" /></a></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In this example, Application.exe is a desktop program calling the documented </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regcreatekeyexw">RegCreateKeyEx</a></span><span>&nbsp;function, which is exported by KernelBase.dll. The KernelBase.dll library implements RegCreateKeyEx by translating the high-level API parameters passed by the caller (paths, flags, etc.) to internal ones understood by the kernel. It then invokes the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-zwcreatekey">NtCreateKey</a></span><span>&nbsp;system call through a thin wrapper provided by ntdll.dll, and the execution finally reaches the Windows kernel, where all of the actual work on the internal registry representation is performed.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The declaration of the RegCreateKeyEx function is as follows:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><code><span class="BGxMwKFqAI-c1">LSTATUS</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">RegCreateKeyExW(</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">hKey,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">LPCWSTR</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">lpSubKey,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">DWORD</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">Reserved,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in,</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">optional]</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">LPWSTR</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">lpClass,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">DWORD</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">dwOptions,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">REGSAM</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">samDesired,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in,</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">optional]</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">const</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">LPSECURITY_ATTRIBUTES</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">lpSecurityAttributes,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[out]</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">PHKEY</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">phkResult,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[out,</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">optional]</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">LPDWORD</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">lpdwDisposition</span></p>
 <p class="BGxMwKFqAI-c1">);</p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>As the first two arguments imply, many registry operations (and especially key opening/creation) are performed on a pair of a base key handle and a relative key path. </span><span>HKEY</span><span>&nbsp;is a dedicated type for registry key handles, but it is functionally equivalent to the standard </span><span>HANDLE</span><span>&nbsp;type. It can either contain a regular handle to a key object (as managed by the NT Object Manager), or one of a few possible pseudo-handles described in the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/predefined-keys">Predefined Keys</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;list. They are defined in winreg.h with the following numeric values:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_CLASSES_ROOT</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000000</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_CURRENT_USER</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000001</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_LOCAL_MACHINE</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000002</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_USERS</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000003</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_PERFORMANCE_DATA</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000004</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_PERFORMANCE_TEXT</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000050</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_PERFORMANCE_NLSTEXT</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000060</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_CURRENT_CONFIG</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000005</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_DYN_DATA</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000006</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY_CURRENT_USER_LOCAL_SETTINGS</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">((</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">(ULONG_PTR)((LONG)</span><span class="BGxMwKFqAI-c3">0x80000007</span><span class="BGxMwKFqAI-c1">)</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">)</span></p>
<p class="BGxMwKFqAI-c0"></p><p><span><br></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>As we can see, they all have the highest bit set, which is normally reserved for kernel-mode handles. Thanks to this, the values can never collide with legitimate user-mode handles, and can be freely used as </span><span>special pseudo-handles</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. It is the responsibility of the Registry API to translate these values into their corresponding low-level registry paths before calling into the kernel. In other words, predefined keys are a strictly user-mode concept, and the kernel itself has no awareness of them. If someone decided to write a program interacting with the registry directly through system calls rather than the API, they wouldn&#39;t have any use of the HKEY_* constants whatsoever.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>This explains why the top-level keys don&#39;t necessarily represent mutually exclusive subtrees &ndash; none of them </span><span class="BGxMwKFqAI-c14">inherently</span><span>&nbsp;represent any specific part of the registry, and their meaning is purely conventional. It is up to KernelBase.dll to decide how it handles each of these keys, and this is further highlighted by the existence of the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regoverridepredefkey">Reg&shy;Override&shy;Predef&shy;Key</a></span><span>&nbsp;function, which allows an application to remap them in the context of the local process. In literature, root keys are sometimes described as being &quot;links&quot; to specific registry paths, and while conceptually correct, this may confuse readers who know about the existence of </span><span class="BGxMwKFqAI-c14">symbolic links</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">, which is a separate, unrelated mechanism. In fact, if we count all the different ways in which access to a registry key can be transparently redirected to another path (either in the user or kernel part of the interface), we end up with at least four:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><ol class="lst-kix_xrbpc8tfqvva-0 start" start="1"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">User-mode Registry API interpreting top-level keys and translating them into specific internal paths, as discussed above.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>Kernel-mode Configuration Manager following symbolic links in the registry, i.e. keys created with the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regcreatekeyexw#REG_OPTION_CREATE_LINK">REG_OPTION_CREATE_LINK</a></span><span>&nbsp;flag and with a value named &quot;SymbolicLinkValue&quot; of type </span><span>REG_LINK</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>Kernel-mode Configuration Manager applying </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/registry-virtualization">Registry Virtualization</a></span><span>&nbsp;to a specific legacy application, and thus redirecting reads/writes to/from subkeys of </span><span>HKEY_LOCAL_MACHINE\Software</span><span>&nbsp;to </span><span>HKEY_USERS\&lt;SID&gt;_Classes\VirtualStore\Machine\Software</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>The user-mode Registry API and kernel-mode Configuration Manager </span><span>working</span><span>&nbsp;together to handle so-called &quot;predefined-handle keys&quot; (marked by flag 0x40 in </span><span>CM_KEY_NODE.Flags</span><span>). This is a special, undocumented type of key that works similarly to symbolic links, but instead of redirecting to an arbitrary registry path, they redirect to specific 32-bit predefined handles (i.e. one of the HKEY_* keys). They were historically a source of numerous security bugs, and were eventually deprecated in July/December 2023 to address Project Zero issues </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2445">#2445</a></span><span>&nbsp;+ </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2452">#2452</a></span><span>&nbsp;(CVE-2023-35356)</span><span>&nbsp;and </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2492">#2492</a></span><span>&nbsp;(CVE-2023-35633)</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></li></ol>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>This goes to show the extent of legacy/compatibility mechanisms maintained in Windows, and the degree of collaboration between the user-mode and kernel parts of the registry code. But coming back to the subject of top-level keys, it is worth having some general idea of their role in the system going forward. A number of existing resources do a great job of explaining exactly this (see my </span><span class="BGxMwKFqAI-c5"><a href="https://googleprojectzero.blogspot.com/2024/06/the-windows-registry-adventure-3.html">previous post</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;for references), so I will only provide a very brief overview below. Overall, the most important takeaway is the fact that HKEY_LOCAL_MACHINE and HKEY_USERS are the two integral keys that can be used to access almost all data in the globally visible registry view. The other HKEY_* keys are derivatives of these two (with the exception of HKEY_PERFORMANCE_* which aren&#39;t even real keys), and exist mostly for convenience.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><table class="BGxMwKFqAI-c43"><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33 BGxMwKFqAI-c38" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c19 BGxMwKFqAI-c17">Top-level key</span></p></td><td class="BGxMwKFqAI-c32 BGxMwKFqAI-c38" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c19 BGxMwKFqAI-c17">Internal registry path</span></p></td><td class="BGxMwKFqAI-c26 BGxMwKFqAI-c38" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c19 BGxMwKFqAI-c17">Description</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_CLASSES_ROOT</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Merged view of:</span></p><ul style="padding: 0;" class="lst-kix_qmeq7xkrbxt-0 start"><li style="margin-left: 46pt;" class="c4 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\Software\Classes</span></li><li style="margin-left: 46pt;" class="c4 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\User\&lt;SID&gt;_Classes</span></li></ul></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>The key contains file name extension associations and COM class registration information. The merging of the two keys is performed in KernelBase.dll, see </span><span>OpenClassesRootInternal</span><span>, </span><span>BaseRegQueryAndMergeValues</span><span>&nbsp;and other neighboring functions, as well as the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/hkey-classes-root-key">HKEY_CLASSES_ROOT Key</a></span><span>&nbsp;and </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/merged-view-of-hkey-classes-root">Merged View of HKEY_CLASSES_ROOT</a></span><span>&nbsp;official </span><span>articles.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_CURRENT_USER</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\User\&lt;SID&gt;</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Stores configuration associated with the current user.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_LOCAL_MACHINE</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Stores global, system-wide configuration.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_USERS</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\User</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Stores information about all users currently logged in the system.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_PERFORMANCE_DATA</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">-</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Not a real key: a pseudo-key that allows applications to query performance information through the Registry API.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_PERFORMANCE_TEXT</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">-</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Not a real key: can be used to query performance information through the Registry API, described in US English.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_PERFORMANCE_NLSTEXT</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">-</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Not a real key: can be used to query performance information through the Registry API, described in the local system language.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_CURRENT_CONFIG</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\System\CurrentControlSet\Hardware Profiles\Current</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Stores information about the current hardware profile.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_DYN_DATA</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">-</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">A deprecated equivalent of HKEY_PERFORMANCE_DATA which only existed in Windows 9x. It was designed to be a general store for dynamically generated information, such as performance counters or hardware configuration.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c33" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">HKEY_CURRENT_USER_LOCAL_SETTINGS</span></p></td><td class="BGxMwKFqAI-c32" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\User\&lt;SID&gt;_Classes\Local Settings</span></p></td><td class="BGxMwKFqAI-c26" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Stores configuration associated with the current user that is local to the machine and not subject to the roaming profile.</span></p></td></tr></table>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In terms of security, the top-level keys and their subtrees are generally protected in line with common sense. Nearly all subkeys of HKEY_LOCAL_MACHINE (i.e. global system settings) are only writable by Administrators and the system itself. Some of the subtrees are readable by normal users (e.g. HKLM\Software or HKLM\System), while others don&#39;t allow any access to restricted accounts (e.g. HKLM\SAM, which stores user credentials). Furthermore, normal users have full access to their own user hives (</span><span>HKU</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\&lt;SID&gt; and HKU\&lt;SID&gt;_Classes) and no access to other users&#39; hives, while Administrators have unrestricted access to all of the user hives under HKU.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">All in all, this is to ensure that each user has their own local hive to store data in, and can read non-sensitive system configuration, while Administrators have full control over everything in the registry so that they can administer the system effectively. With a basic understanding of the high-level structure of the registry, let&#39;s find out more about how it works under the hood.</span></p><h2 class="BGxMwKFqAI-c36 BGxMwKFqAI-c8" id="h.vih057xbllzz"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c40 BGxMwKFqAI-c35">The low-level view</span></h2>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>If the Windows kernel doesn&#39;t use predefined keys in the same way as the user-mode API does, then the question becomes &ndash; where does the registry tree </span><span>start? You have probably already guessed the answer based on this and previous blog posts: it&#39;s the </span><span>\Registry</span><span>&nbsp;object in the global NT object namespace. Internally, it is a volatile key in a virtual &quot;master&quot; hive (pointed to by </span><span>nt!CmpMasterHive</span><span>), with both the key and the hive existing only in memory for organizational purposes. Their setup takes place early in the boot process in the internal </span><span>CmInitSystem1</span><span>&nbsp;function, and the </span><span>\Registry</span><span>&nbsp;object can be seen in tools for exploring the object manager namespace, such as </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/sysinternals/downloads/winobj">WinObj</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3r4YZwUAP_s0Q4MCgAjLzA1rjhKGxnKpTyw8N1kpcspYIECTpCR9TCB6eX5AIkHplX6g7rPaDTJ2XekKEBsRyW4JzzZ6sfDm5DzujHE13R2DlHzEOAQHmJxzLCjRnsWSeIgsb6VFp-vc9h-_0WtbcB5nd4pFPD3011uxG6Pmydl0f0ev4G6z9PzXuPBA/s734/image2.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="A screenshot of the WinObj utility from Sysinternals, displaying a list of system objects in Windows. The &#39;REGISTRY&#39; object is highlighted." border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3r4YZwUAP_s0Q4MCgAjLzA1rjhKGxnKpTyw8N1kpcspYIECTpCR9TCB6eX5AIkHplX6g7rPaDTJ2XekKEBsRyW4JzzZ6sfDm5DzujHE13R2DlHzEOAQHmJxzLCjRnsWSeIgsb6VFp-vc9h-_0WtbcB5nd4pFPD3011uxG6Pmydl0f0ev4G6z9PzXuPBA/s734/image2.png" style="max-height: 750px; max-width: 600px;" title="A screenshot of the WinObj utility from Sysinternals, displaying a list of system objects in Windows. The &#39;REGISTRY&#39; object is highlighted." /></a></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>This is essentially the entry point to access any registry key in the system. Whenever the object manager is involved with an operation on a path starting with </span><span>\Registry</span><span>, it knows to pass execution to the </span><span>CmpParseKey</span><span>&nbsp;function, which takes over the operation, parses the remainder of the path, tries to open or create the given key and returns the object to the caller. Since </span><span>\Registry</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;is a normal key for most intents and purposes, we can query it in WinDbg:</span></p><code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">kd&gt; !reg querykey \Registry</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">Found KCB = ffff8f818bad92f0 :: \REGISTRY</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">Hive &nbsp; &nbsp; &nbsp; &nbsp; ffff8f818ba88000</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">KeyNode &nbsp; &nbsp; &nbsp;ffff8f818bada024</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">[SubKeyAddr] &nbsp; &nbsp; &nbsp; &nbsp; [SubKeyName]</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">ffff8f818bada244 &nbsp; &nbsp; A</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">ffff8f818bada16c &nbsp; &nbsp; MACHINE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">ffff8f818bada1d4 &nbsp; &nbsp; USER</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">ffff8f818bada2c4 &nbsp; &nbsp; WC</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c10"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">&nbsp;Use &#39;!reg keyinfo ffff8f818ba88000 &lt;SubKeyAddr&gt;&#39; to dump the subkey details</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">[ValueType] &nbsp; &nbsp; &nbsp; &nbsp; [ValueName] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ValueData]</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10">&nbsp;Key has no Values</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>As the output shows, the root key has four subkeys: </span><span class="BGxMwKFqAI-c14">A</span><span>, </span><span class="BGxMwKFqAI-c14">MACHINE</span><span>, </span><span class="BGxMwKFqAI-c14">USER</span><span>&nbsp;and </span><span class="BGxMwKFqAI-c14">WC</span><span>. Two of them are already known to us: &quot;Machine&quot; corresponds to HKEY_LOCAL_MACHINE, and &quot;User&quot; corresponds to HKEY_USERS. Furthermore, &quot;A&quot; serves as the root for all private hives loaded as application hives (using the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regloadappkeyw">RegLoadAppKey</a></span><span>&nbsp;API). The key and any of its subkeys cannot be opened through their fully qualified path (</span><span>\Registry\A\...</span><span>) regardless of their security descriptor or the privileges of the caller, because </span><span>CmpParseKey</span><span>&nbsp;detects and denies such requests with the </span><span>STATUS_ACCESS_DENIED</span><span>&nbsp;error code. This is to guarantee that all app hives remain private and can only be accessed through the handles returned by RegLoadAppKey. Lastly, &quot;</span><span>WC&quot; likely stands for &quot;Windows Containers&quot;</span><span>&nbsp;and is the mount point for </span><span class="BGxMwKFqAI-c14">differencing hives</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;loaded as part of Windows containerization support (introduced in Windows 10 1607). The key is world-readable and isn&#39;t subject to any special protections, but it is not mapped to any predefined keys either, so it is only accessible via system calls and not through the official API (with the exception of symbolic links). </span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>A diagram of the low-level view of the registry and how the high-level predefined keys map to it is shown below:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c8 BGxMwKFqAI-c37"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLkpY8R-fgiQDeZca900vRBEDOZXErCeqXcfJpxGXeHVyBpQd_AJp6CWTYmFhdIOnN4PBFHMF1dwZB9AYhYqEXi-tf9QHMgN7pexzPl08GJMIh-O76J7f9MZIAxgaXDFHhSVRTyssRAG-mV2DlKx8nJNrbFxfAS60xzBZlR9GhLK_KP0puXfOHy2uOQp8/s789/image7.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="A flowchart illustrating the hierarchical structure of the Windows Registry. The chart starts with the root node &#39;REGISTRY&#39; and branches down into five main keys: MACHINE, HKEY_LOCAL_MACHINE, USER, HKEY_USERS, and HKEY_CLASSES_ROOT. Each key further expands to reveal subkeys, highlighting the organization of system and user-specific settings within the registry." border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLkpY8R-fgiQDeZca900vRBEDOZXErCeqXcfJpxGXeHVyBpQd_AJp6CWTYmFhdIOnN4PBFHMF1dwZB9AYhYqEXi-tf9QHMgN7pexzPl08GJMIh-O76J7f9MZIAxgaXDFHhSVRTyssRAG-mV2DlKx8nJNrbFxfAS60xzBZlR9GhLK_KP0puXfOHy2uOQp8/s789/image7.png" style="max-height: 750px; max-width: 600px;" title="A flowchart illustrating the hierarchical structure of the Windows Registry. The chart starts with the root node &#39;REGISTRY&#39; and branches down into five main keys: MACHINE, HKEY_LOCAL_MACHINE, USER, HKEY_USERS, and HKEY_CLASSES_ROOT. Each key further expands to reveal subkeys, highlighting the organization of system and user-specific settings within the registry." /></a></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Evidently, the internal registry layout is much more structured than its high-level counterpart, and follows a few basic rules:</span></p><ul style="padding: 0;" class="lst-kix_m1h2nk6mxy3s-0 start"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The first and second levels of the tree are predetermined and always the same.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The third level consists solely of root keys of active hives loaded in the system.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The fourth and further levels are nested subkeys of the hives.</span></li></ul>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">On a typical installation of Windows, there are usually dozens of hives loaded in the system at any given time, storing a variety of configuration data. Having already used the term &quot;hives&quot; extensively in this and the previous blog posts, let&#39;s discuss in more detail what they are and how they work.</span></p><h2 class="BGxMwKFqAI-c36 BGxMwKFqAI-c8" id="h.rzmke0hjk04x"><span>Hive files</span></h2>
 <p class="BGxMwKFqAI-c0"><span>What better way to describe a registry hive than to quote an official definition from a Microsoft article (</span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/registry-hives">Registry Hives</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">):</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><table class="BGxMwKFqAI-c43"><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c39" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c14">A hive is a logical group of keys, subkeys, and values in the registry that has a set of supporting files loaded into memory when the operating system is started or a user logs in.</span></p></td></tr></table>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c14 BGxMwKFqAI-c48"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In other words, a hive is a standalone database encoded in the regf format that serves a specific purpose in the operating system (if you&#39;re curious about the origin of the name, check </span><span class="BGxMwKFqAI-c5"><a href="https://devblogs.microsoft.com/oldnewthing/20030808-00/?p=42943">Why is a registry file called a &quot;hive&quot;?</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">). Hives can be classified based on where they reside (on disk, in memory, or both):</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><ul style="padding: 0;" class="lst-kix_t322xbujlsbo-0 start"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c19 BGxMwKFqAI-c17">File-backed</span></li></ul><ul style="padding: 0;" class="lst-kix_t322xbujlsbo-1 start"><li style="margin-left: 76pt;" class="c4 c8 c47 li-bullet-0"><span class="BGxMwKFqAI-c17">Unloaded:</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;a hive that is stored persistently on disk but not actively loaded in the system.</span></li><li style="margin-left: 76pt;" class="c4 c8 c47 li-bullet-0"><span class="BGxMwKFqAI-c17">Loaded:</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;a hive that is both stored on disk and currently used by Windows. The in-memory and on-disk representations of the database are continuously synchronized by the kernel to ensure its consistency in the event of a sudden power loss or other system failures.</span></li></ul><ul style="padding: 0;" class="lst-kix_t322xbujlsbo-0"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">Volatile:</span><span>&nbsp;an ephemeral hive that is not stored on disk and only lives in memory until the next system reboot. Examples include the master hive (corresponding to the </span><span>\Registry</span><span>&nbsp;global root) and the hardware hive mounted at </span><span>\Registry\Machine\HARDWARE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. They are not particularly important from a security perspective but their existence is worth noting for completeness.</span></li></ul>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">A majority of hives are file-backed, because their purpose is precisely to store data across long periods of time and multiple reboots. Interestingly, whenever we observe a hive on disk (which may require the &quot;Show hidden files, folders, and drives&quot; option to be checked and &quot;Hide protected operating system files&quot; to be unchecked in Explorer), it is usually not a single file but a collection of files with a common name prefix. For instance, let&#39;s have a look at the NTUSER hive in a user&#39;s home directory in Windows 11:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEghOyZg4rqXW-eNCf1kIV0TpBM3hxbzB3gpdwgu8Urk7S1CHHZMSzFZRObe8gqjyHuNafp-MQLFjBeN4fL63S0UwRyyJqZM1m5OdIaKcRb_WWmw6HXkv-MVFGwwlet3rO8n49CeNfM5UWOOTPxOyd_5Vib5yXo-rPE5htrOwu4oiJ0BN8yPmn_dG0I6kHE/s618/image6.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="A screenshot of a Windows File Explorer window displaying the contents of the &#39;user&#39; folder. The folder contains various files related to user settings and data, including NTUSER.DAT, transaction logs, and temporary files" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEghOyZg4rqXW-eNCf1kIV0TpBM3hxbzB3gpdwgu8Urk7S1CHHZMSzFZRObe8gqjyHuNafp-MQLFjBeN4fL63S0UwRyyJqZM1m5OdIaKcRb_WWmw6HXkv-MVFGwwlet3rO8n49CeNfM5UWOOTPxOyd_5Vib5yXo-rPE5htrOwu4oiJ0BN8yPmn_dG0I6kHE/s618/image6.png" style="max-height: 750px; max-width: 600px;" title="A screenshot of a Windows File Explorer window displaying the contents of the &#39;user&#39; folder. The folder contains various files related to user settings and data, including NTUSER.DAT, transaction logs, and temporary files" /></a></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">All of these files are related to a single hive. Let&#39;s briefly go over each file type visible in the screenshot:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><ul style="padding: 0;" class="lst-kix_tidwaau4ppsg-0 start"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>.DAT &ndash; this is the core hive file and the only one that is strictly required. The .dat extension is frequently seen in the context of hive files (other less common variants: .hiv &nbsp;and .</span><span>h</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">ve), but it is only customary and the kernel will happily load a hive from any file regardless of its name (for example, none of the system hive files in C:\Windows\system32\config have any extension at all). While the hive is active, the kernel locks the file, preventing it from being simultaneously operated on by any other program.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>.LOG1 and .LOG2 &ndash; log files maintained by the Configuration Manager to safeguard the low-level recoverability of the hive. When they are used, every write operation to the hive is first written to a log file, and later flushed to the hive file itself. For a deeper analysis of the logging mechanism, please refer to the Registry chapter in the </span><span class="BGxMwKFqAI-c5"><a href="https://www.microsoftpressstore.com/store/windows-internals-part-2-9780135462331">Windows Internals</a></span><span>&nbsp;book (specifically the &quot;Stable storage&quot; and &quot;Incremental logging&quot; sections). Although hive files are typically accompanied by .LOG1/.LOG2 files in most real-life scenarios, it is also possible to have a single .LOG file (by loading the hive with the </span><span>REG_HIVE_SINGLE_LOG</span><span>&nbsp;flag), or prevent the kernel from creating them completely by using the </span><span>REG_OPEN_READ_ONLY</span><span>&nbsp;or </span><span>REG_IMMUTABLE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;flags.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>.regtrans-ms and .blf &ndash; additional log files related to the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/ktm/kernel-transaction-manager-portal">Kernel Transaction Manager</a></span><span>&nbsp;and transactional registry. They store information about pending operations performed on transacted keys opened with the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regcreatekeytransactedw">RegCreateKeyTransacted</a></span><span>&nbsp;or </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regopenkeytransactedw">RegOpenKeyTransacted</a></span><span>&nbsp;API functions, and are used to roll-forward these operations in case of a sudden system reboot. They are created at the request of the Configuration Manager, but are internally managed by the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-the-common-log-file-system">Common Log File System</a></span><span>&nbsp;driver. They are enabled for system hives (all hives under HKLM have their transaction logs collectively saved in C:\Windows\system32\config\TxR), and for user-specific hives (NTUSER.DAT and UsrClasses.dat), but they are always disabled for application hives (</span><span>\Registry\A\...</span><span>) and differencing hives (</span><span>\Registry\WC\...</span><span>). It is also possible to force the loading of a hive with disabled transactions by using the </span><span>REG_HIVE_NO_RM</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;flag.</span></li></ul>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In summary, a single hive may be associated with up to 10 files on disk. I won&#39;t go into the details of their binary formats as this will be discussed in future posts, but it&#39;s interesting to note that each file type has been affected by some security issues in the past (see examples for </span><span class="BGxMwKFqAI-c5"><a href="https://project-zero.issues.chromium.org/issues?q=id:(42450251%20%7C%2042452400%20%7C%2042451423%20%7C%2042451425%20%7C%2042451427%20%7C%2042451449%20%7C%2042451463%20%7C%2042451465%20%7C%2042451478%20%7C%2042451494%20%7C%2042451502%20%7C%2042451588%20%7C%2042451596%20%7C%2042451601%20%7C%2042451640)">.DAT</a></span><span>, </span><span class="BGxMwKFqAI-c5"><a href="https://project-zero.issues.chromium.org/issues?q=id:(42452405%20%7C%2042450541%20%7C%2042450609%20%7C%2042451598%20%7C%2042451600)">.LOG1/.LOG2</a></span><span>&nbsp;and </span><span class="BGxMwKFqAI-c5"><a href="https://project-zero.issues.chromium.org/issues?q=id:(42450872%20%7C%2042451149%20%7C%2042451150%20%7C%2042451559%20%7C%2042451560)">and .regtrans-ms/.blf</a>).</span> Let&#39;s now review some of the default hives that are commonly loaded in Windows, and how we can enumerate and examine them.</span></p><h2 class="BGxMwKFqAI-c36 BGxMwKFqAI-c8" id="h.3uxkacig34in"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c40 BGxMwKFqAI-c35">The hive list and memory mappings</span></h2>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Internally, the Windows kernel maintains a linked list of active hives in the system, starting with the global nt!</span><span>CmpHiveListHead</span><span>&nbsp;object. But what&#39;s interesting is that the information is also made globally visible through the registry itself: there is a special key at </span><span>\Registry\Machine\System\CurrentControlSet\Control\hivelist</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;where the kernel maintains a single string value per loaded hive, with its name indicating the registry mount point and its data specifying the low-level path on disk. All active file-backed hives in the system except application hives are listed there, and inspecting the list is as simple as finding the &quot;hivelist&quot; key in Regedit:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjEJrem5RY2MFlQ5hrJYI1gN1CxaEtEzReNrzs0mpOGg2Ms_Vx_g2V1IPimhTz7pnjkgEnOv4vxk3HI7gwoeZ08T6IRg2noqDfYXsHaq-uc7tJ9a-XF20yffKQzjth8CYmR5NAzlYBhervdcs3GEOxkrptFFsr3CzxMrVpo80pKj3j8RzQ1uDS_aUPr7ag/s718/image4.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="Image of Windows Registry Editor showing the &#39;hivelist&#39; key, which lists registry hives and their file paths" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjEJrem5RY2MFlQ5hrJYI1gN1CxaEtEzReNrzs0mpOGg2Ms_Vx_g2V1IPimhTz7pnjkgEnOv4vxk3HI7gwoeZ08T6IRg2noqDfYXsHaq-uc7tJ9a-XF20yffKQzjth8CYmR5NAzlYBhervdcs3GEOxkrptFFsr3CzxMrVpo80pKj3j8RzQ1uDS_aUPr7ag/s718/image4.png" style="max-height: 750px; max-width: 600px;" title="Image of Windows Registry Editor showing the &#39;hivelist&#39; key, which lists registry hives and their file paths" /></a></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c11"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Here, we can see the standard system hives mounted under </span><span>\Registry\Machine</span><span>, several user hives under </span><span>\Registry\User</span><span>&nbsp;(some of them for system accounts and some for the current user), and a number of </span><span>differencing</span><span>&nbsp;hives at </span><span>\Registry\WC</span><span>. A similar, but much more detailed list of hives may be obtained by using the </span><span class="BGxMwKFqAI-c14">!reg hivelist</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;command in WinDbg:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2">kd&gt;</span><span class="BGxMwKFqAI-c15">&nbsp;</span><span class="BGxMwKFqAI-c2">!reg</span><span class="BGxMwKFqAI-c15">&nbsp;</span><span class="BGxMwKFqAI-c2">hivelist</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c12 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2">-------------------------------------------------------------------------------------------------------------------------------------------------</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2">|</span><span class="BGxMwKFqAI-c15">&nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c2">HiveAddr</span><span class="BGxMwKFqAI-c15">&nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c2">|Stable</span><span class="BGxMwKFqAI-c15">&nbsp;</span><span class="BGxMwKFqAI-c2">Length|</span><span class="BGxMwKFqAI-c15">&nbsp; &nbsp; </span><span class="BGxMwKFqAI-c2">Stable</span><span class="BGxMwKFqAI-c15">&nbsp;</span><span class="BGxMwKFqAI-c2">Map</span><span class="BGxMwKFqAI-c15">&nbsp; &nbsp; </span><span class="BGxMwKFqAI-c2">|Volatile</span><span class="BGxMwKFqAI-c15">&nbsp;</span><span class="BGxMwKFqAI-c2">Length|</span><span class="BGxMwKFqAI-c15">&nbsp; &nbsp; </span><span class="BGxMwKFqAI-c2">Volatile</span><span class="BGxMwKFqAI-c15">&nbsp;</span><span class="BGxMwKFqAI-c2">Map</span><span class="BGxMwKFqAI-c15">&nbsp; &nbsp; </span><span class="BGxMwKFqAI-c2">|MappedViews &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c15">&nbsp; &nbsp; </span><span class="BGxMwKFqAI-c2">|</span><span class="BGxMwKFqAI-c15">&nbsp;</span><span class="BGxMwKFqAI-c2">FileName</span><span class="BGxMwKFqAI-c12 BGxMwKFqAI-c6">&nbsp;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2">-------------------------------------------------------------------------------------------------------------------------------------------------</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818ba88000 | &nbsp; &nbsp; &nbsp; 2000 &nbsp;| ffff8f818ba88128 | &nbsp; &nbsp; &nbsp; 1000 &nbsp; &nbsp;| &nbsp;ffff8f818ba883a0 &nbsp;| ffff8f818bad5000 &nbsp;| &lt;NONAME&gt;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818ba62000 | &nbsp; &nbsp; d8c000 &nbsp;| ffff8f818badc000 | &nbsp; &nbsp; &nbsp;41000 &nbsp; &nbsp;| &nbsp;ffff8f818ba623a0 &nbsp;| ffff8f818badb000 &nbsp;| SYSTEM</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818bb87000 | &nbsp; &nbsp; &nbsp;24000 &nbsp;| ffff8f818bb87128 | &nbsp; &nbsp; &nbsp;10000 &nbsp; &nbsp;| &nbsp;ffff8f818bb873a0 &nbsp;| ffff8f818bb5a000 &nbsp;| &lt;NONAME&gt;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818c813000 | &nbsp; &nbsp;4c4b000 &nbsp;| ffff8f818e482000 | &nbsp; &nbsp; 330000 &nbsp; &nbsp;| &nbsp;ffff8f8190b98000 &nbsp;| ffff8f818e470000 &nbsp;| emRoot\System32\Config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818e578000 | &nbsp; &nbsp; &nbsp; 8000 &nbsp;| ffff8f818e578128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f818e4f9000 &nbsp;| kVolume1\EFI\Microsoft\Boot\BCD</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818c75b000 | &nbsp; &nbsp; &nbsp;74000 &nbsp;| ffff8f818c75b128 | &nbsp; &nbsp; &nbsp; 1000 &nbsp; &nbsp;| &nbsp;ffff8f818c75b3a0 &nbsp;| ffff8f818e5d4000 &nbsp;| temRoot\System32\Config\DEFAULT</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818e773000 | &nbsp; &nbsp; &nbsp; 9000 &nbsp;| ffff8f818e773128 | &nbsp; &nbsp; &nbsp; 1000 &nbsp; &nbsp;| &nbsp;ffff8f818e7733a0 &nbsp;| ffff8f818e9be000 &nbsp;| emRoot\System32\Config\SECURITY</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818e9a8000 | &nbsp; &nbsp; &nbsp; d000 &nbsp;| ffff8f818e9a8128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f818ea2c000 &nbsp;| \SystemRoot\System32\Config\SAM</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818ec68000 | &nbsp; &nbsp; &nbsp;2f000 &nbsp;| ffff8f818ec68128 | &nbsp; &nbsp; &nbsp; 1000 &nbsp; &nbsp;| &nbsp;ffff8f818ec683a0 &nbsp;| ffff8f818ea54000 &nbsp;| files\NetworkService\NTUSER.DAT</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818ee2e000 | &nbsp; &nbsp; &nbsp;30000 &nbsp;| ffff8f818ee2e128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f818edf9000 &nbsp;| rofiles\LocalService\NTUSER.DAT</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f818ee63000 | &nbsp; &nbsp; &nbsp;72000 &nbsp;| ffff8f818ee63128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f818ee48000 &nbsp;| \SystemRoot\System32\Config\BBI</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f8190370000 | &nbsp; &nbsp; 19b000 &nbsp;| ffff8f8190370128 | &nbsp; &nbsp; &nbsp; 4000 &nbsp; &nbsp;| &nbsp;ffff8f81903703a0 &nbsp;| ffff8f81903e7000 &nbsp;| \??\C:\Users\user\ntuser.dat</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f8190373000 | &nbsp; &nbsp; 2cf000 &nbsp;| ffff8f81903fb000 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f81903eb000 &nbsp;| \Microsoft\Windows\UsrClass.dat</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f8191a2e000 | &nbsp; &nbsp; &nbsp; 7000 &nbsp;| ffff8f8191a2e128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f8191a8c000 &nbsp;| 5n1h2txyewy\ActivationStore.dat</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f8191a30000 | &nbsp; &nbsp; &nbsp;1c000 &nbsp;| ffff8f8191a30128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f8191a93000 &nbsp;| 5n1h2txyewy\ActivationStore.dat</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f8191a32000 | &nbsp; &nbsp; &nbsp;78000 &nbsp;| ffff8f8191a32128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f8191a9a000 &nbsp;| 5n1h2txyewy\ActivationStore.dat</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">| ffff8f8191bf7000 | &nbsp; &nbsp; 1f3000 &nbsp;| ffff8f8191bf7128 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;| &nbsp;0000000000000000 &nbsp;| ffff8f8191bfb000 &nbsp;| \AppCompat\Programs\Amcache.hve<br>[...]</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>This output is missing registry paths, but provides us with the file names, and also contains addresses of the corresponding </span><span>HHIVE</span><span>/</span><span>CMHIVE</span><span>&nbsp;structures and information about the stable/volatile spaces of each hive. It also shows all active hives in the system, including app hives and volatile hives. For example, the first and third items on the list are the </span><span>\Registry</span><span>&nbsp;and </span><span>\Registry\Machine\HARDWARE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;hives, respectively &ndash; since neither of them are file-backed, their FileName columns state &quot;&lt;NONAME&gt;&quot;.</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The final way to enumerate hives in the system is by listing section objects. In modern versions of Windows, most registry hives are mapped in the user address space of a special, thin process named Registry (you can find it in Task Manager), using </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/section-objects-and-views">sections</a></span><span>. The two notable exceptions are the SYSTEM hive and any hives that don&#39;t exist on disk at the time of the loading (i.e. are created from scratch using the NtLoadKey* call). But for all other hives, we can have them printed out in WinDbg by finding the Registry process, switching to its context, and issuing the </span><span class="BGxMwKFqAI-c14">!vad</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;command to display its associated virtual address descriptors (VADs):</span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">kd&gt; !process 0 0</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">**** NT ACTIVE PROCESS DUMP ****</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">PROCESS ffffb3047dcf4040</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">&nbsp; &nbsp; SessionId: none &nbsp;Cid: 0004 &nbsp; &nbsp;Peb: 00000000 &nbsp;ParentCid: 0000</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">&nbsp; &nbsp; DirBase: 001ae002 &nbsp;ObjectTable: ffff8f818ba85f00 &nbsp;HandleCount: 3193.</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">&nbsp; &nbsp; Image: System</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">PROCESS ffffb3047ddc0080</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">&nbsp; &nbsp; SessionId: none &nbsp;Cid: 0040 &nbsp; &nbsp;Peb: 00000000 &nbsp;ParentCid: 0004</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">&nbsp; &nbsp; DirBase: 02db7002 &nbsp;ObjectTable: ffff8f818ba02c00 &nbsp;HandleCount: &nbsp; 0.</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">&nbsp; &nbsp; Image: Registry<br><br>[...]</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">kd&gt; .process ffffb3047ddc0080</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">Implicit process is now ffffb304`7ddc0080</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">WARNING: .cache forcedecodeuser is not enabled</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">kd&gt; !vad</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">VAD &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Level &nbsp; &nbsp; &nbsp; &nbsp; Start &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Commit</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e3653e0 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;28700000 &nbsp; &nbsp; &nbsp; &nbsp;287001ff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e364a80 &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;28700200 &nbsp; &nbsp; &nbsp; &nbsp;287003ff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e365020 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;28700400 &nbsp; &nbsp; &nbsp; &nbsp;287005ff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e364760 &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp;28700600 &nbsp; &nbsp; &nbsp; &nbsp;287007ff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e364e40 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;28700800 &nbsp; &nbsp; &nbsp; &nbsp;287009ff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e364d00 &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;28700a00 &nbsp; &nbsp; &nbsp; &nbsp;28700bff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e3646c0 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;28700c00 &nbsp; &nbsp; &nbsp; &nbsp;28700dff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e364800 &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp;28700e00 &nbsp; &nbsp; &nbsp; &nbsp;28700fff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e3648a0 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;28701000 &nbsp; &nbsp; &nbsp; &nbsp;287011ff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e365160 &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;28701200 &nbsp; &nbsp; &nbsp; &nbsp;287013ff &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3048058e450 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;28701400 &nbsp; &nbsp; &nbsp; &nbsp;2870147f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 114 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\BBI</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb30480f68890 &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp;28701480 &nbsp; &nbsp; &nbsp; &nbsp;2870167f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;19 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Users\user\NTUSER.DAT</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb30480f690b0 &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;28701680 &nbsp; &nbsp; &nbsp; &nbsp;2870187f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Users\user\AppData\Local\Microsoft\Windows\UsrClass.dat</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb30480f69e70 &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp;28701880 &nbsp; &nbsp; &nbsp; &nbsp;2870197f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Users\user\AppData\Local\Microsoft\Windows\UsrClass.dat</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">[...]</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e364580 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;2877fca0 &nbsp; &nbsp; &nbsp; &nbsp;2877fe9f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SOFTWARE</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e364c60 &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;2877fea0 &nbsp; &nbsp; &nbsp; &nbsp;2877feaf &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \EFI\Microsoft\Boot\BCD</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e366b00 &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;2877feb0 &nbsp; &nbsp; &nbsp; &nbsp;2877ff2f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;19 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\DEFAULT</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e372ae0 &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp;2877ff30 &nbsp; &nbsp; &nbsp; &nbsp;2877ff3f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SECURITY</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2 BGxMwKFqAI-c6">ffffb3047e3745c0 &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;2877ff40 &nbsp; &nbsp; &nbsp; &nbsp;2877ff4f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Mapped &nbsp; &nbsp; &nbsp; READONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \Windows\System32\config\SAM</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c2">[...]</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>There may be multiple VADs associated with a single hive, because hives are mapped in a fragmented manner and may dynamically grow over time. The address ranges specified by the &quot;Start&quot; and &quot;End&quot; columns correspond to the &quot;pcell&quot; addresses returned by the </span><span class="BGxMwKFqAI-c14">!reg cellindex</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;WinDbg command when multiplied by 0x1000 (the page size). For example, the BCD hive is mapped between 0x2877fea0000 and 0x2877feaffff. The first page (the 4 KiB hive header) is typically not mapped, but we can see the raw data of the first bin residing at address 0x2877fea1000:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">kd&gt; db 0x2877fea1000</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">00000287`7fea1000 &nbsp;68 62 69 6e 00 00 00 00-00 10 00 00 00 00 00 00 &nbsp;hbin............</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">00000287`7fea1010 &nbsp;00 00 00 00 a5 7a 66 c9-8b 03 da 01 00 00 00 00 &nbsp;.....zf.........</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">00000287`7fea1020 &nbsp;a0 ff ff ff 6e 6b 2c 00-c1 e4 70 f6 e3 8b da 01 &nbsp;....nk,...p.....</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">00000287`7fea1030 &nbsp;03 00 00 00 48 04 00 00-02 00 00 00 00 00 00 00 &nbsp;....H...........</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">00000287`7fea1040 &nbsp;48 02 00 00 ff ff ff ff-00 00 00 00 ff ff ff ff &nbsp;H...............</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">00000287`7fea1050 &nbsp;68 01 00 00 ff ff ff ff-16 00 00 00 00 00 00 00 &nbsp;h...............</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10 BGxMwKFqAI-c6">00000287`7fea1060 &nbsp;00 00 00 00 00 00 00 00-00 00 00 00 0c 00 00 00 &nbsp;................</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c10">00000287`7fea1070 &nbsp;4e 65 77 53 74 6f 72 65-52 6f 6f 74 00 00 00 00 &nbsp;NewStoreRoot....</span></p></code><h2 class="BGxMwKFqAI-c8 BGxMwKFqAI-c42" id="h.suyvbyq1ls0w"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c40 BGxMwKFqAI-c35">Default system hives</span></h2>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Knowing the basic structure of the registry tree and how we can enumerate hives, let&#39;s now briefly discuss the role and properties of the default hives that we&#39;ll find in a clean installation of Windows:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><table class="BGxMwKFqAI-c43"><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30 BGxMwKFqAI-c38" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c34"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c19 BGxMwKFqAI-c17">Registry path</span></p></td><td class="BGxMwKFqAI-c31 BGxMwKFqAI-c38" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c34"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c17 BGxMwKFqAI-c19">Description</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>\Registry\A\</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c48 BGxMwKFqAI-c14">{RANDOM GUID}</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Application hives may contain any information the client program decides to save, but two of its primary uses are by Universal Windows Platform (UWP) applications to store information about their WinRT classes (in a file called ActivationStore.dat) and their private settings (backed by settings.dat). The lifespan of app hives is tied to their active references, so whenever all handles to the hive are closed (or the process terminates), the hive is automatically unloaded. The security rights set on the keys in app hives are generally irrelevant, because they cannot be opened by any process that doesn&#39;t have a valid handle to the hive to start with, thanks to the extra checks hardcoded in CmpParseKey.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\BCD00000000</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>The hive contains the Boot Configuration Database (BCD) that replaced the boot.ini file in Windows Vista. It is backed by a hidden \EFI\Microsoft\Boot\BCD file, and can be modified indirectly with the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/bcdedit">bcdedit</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;command line utility. Full access is granted to administrators, and no access is granted to normal users.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\HARDWARE</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The hive contains a specification of the system&#39;s legacy hardware (such as a keyboard or mouse). As previously mentioned, it is a volatile hive without a backing file, which is dynamically generated during boot in the internal CmpInitializeHardwareConfiguration function. It grants full access to administrators and read access to normal users.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\SAM</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The hive contains information managed by the Security Account Manager (SAM), such as user passwords and group definitions. It is backed by the C:\Windows\system32\config\SAM file, and it is the only hive with lazy flushing disabled, meaning that it must be manually synchronized with the backing file by the SAM Server using syscalls like NtFlushKey and NtRestoreKey. It grants full access to the LocalSystem account and no access to any of the users, so even administrators cannot modify or browse it by default.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\SECURITY</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>The hive contains security-critical information such as security policies and user right assignments. It is backed by C:\Windows\system32\config\SECURITY, and similarly to SAM, it only grants access to the LocalSystem account.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\SOFTWARE</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The hive is a general-purpose store for system-wide configuration of both Windows built-in components and third-party software. It is generally the only hive in HKLM where legitimate programs ever need to write to, and for this reason it is the only one subject to registry virtualization. It is backed by the C:\Windows\system32\config\SOFTWARE file, and a majority of its keys are user-readable and admin-writable. However, there are some exceptions to this rule: firstly, there are several default keys with more permissive rights (e.g. user-writable) and some default keys with more restrictive rights (e.g. only readable by specific users and not broadly accessible). Secondly, the responsibility to set adequate security of the keys is shared by all applications using the hive, but in practice, their behavior isn&#39;t always consistent with Windows (i.e. they may set more or less permissive rights than we would normally expect).</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">\Registry\Machine\SYSTEM</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The hive is a store for system-wide configuration that is required to boot the system, such as information about device drivers and system services. It is backed by the C:\Windows\system32\config\SYSTEM file and it is first loaded in memory before the Windows kernel itself, by a copy of the Configuration Manager found in the winload.exe/winload.efi executables. It is also the only system hive mapped in kernel paged pool and not in the user-space of the special Registry process. Similarly to SOFTWARE, most of its keys are user-readable and admin-writable, but there are some notable exceptions to this rule.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>\Registry\User\&lt;SID&gt;</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>The user hives are meant to store user-specific configuration; when a new user is created, the user hive starts off with a basic structure and grows larger as applications save their settings over time. They are typically backed by the NTUSER.DAT file in the user directory, but can also be overridden by NTUSER.MAN by taking advantage of the </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/shell/mandatory-user-profiles">Mandatory User Profiles</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. Their security is arranged such that they are accessible by the associated user and administrators, but not other users in the system.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4"><span>A special case of user hives are the hives corresponding to system-specific accounts which are mounted and globally visible under </span><span>\Registry\User</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">:</span></p><ul style="padding: 0;" class="lst-kix_6a34hny9fd1v-0 start"><li style="margin-left: 46pt;" class="c4 c23 li-bullet-0"><span>\Registry\User\.DEFAULT</span><span>&nbsp;&ndash; the user hive of the LocalSystem account, backed by C:\Windows\system32\config\DEFAULT. If you think this is a confusing name, I agree, and so does </span><span>Raymond Chen in his </span><span class="BGxMwKFqAI-c5"><a href="https://devblogs.microsoft.com/oldnewthing/20070302-00/?p=27783">The .Default user is not the default user</a></span><span>&nbsp;blog post.</span></li><li style="margin-left: 46pt;" class="c4 c23 li-bullet-0"><span>\Registry\User\S-1-5-18</span><span>&nbsp;&ndash; this is the SID of the LocalSystem account, so the key is simply a symbolic link to </span><span>\Registry\User\.DEFAULT</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></li><li style="margin-left: 46pt;" class="c4 c23 li-bullet-0"><span>\Registry\User\S-1-5-19</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;&ndash; the user hive of the LocalService account, backed by C:\Windows\ServiceProfiles\LocalService\NTUSER.DAT.</span></li><li style="margin-left: 46pt;" class="c4 c23 li-bullet-0"><span>\Registry\User\S-1-5-20</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;&ndash; the user hive of the NetworkService account, backed by C:\Windows\ServiceProfiles\NetworkService\NTUSER.DAT.</span></li></ul></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>\Registry\User\&lt;SID&gt;</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">_Classes</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>The &quot;</span><span>classes</span><span>&quot; hive is the second one that gets automatically loaded once a user logs into the system. It is responsible for storing the user-specific file extension associations and COM class registrations, which are then merged with </span><span>\Registry\Machine\Software\Classes</span><span>&nbsp;by the Registry API and exposed as the HKEY_CLASSES_ROOT top-level key. It is additionally used by the registry virtualization mechanism, and is pointed to by the </span><span>\Registry\User\&lt;SID&gt;\Software\Classes</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;symbolic link. The hive is backed by C:\Users\&lt;USER&gt;\AppData\Local\Microsoft\Windows\UsrClass.dat, and has the same security properties as the regular user hive: it is only accessible by the owner user and administrators.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c30" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>\Registry\WC\Silo</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">{...}</span></p></td><td class="BGxMwKFqAI-c31" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Differencing hives are a new technology introduced in Windows 10 Anniversary Update to support registry containerization in various Windows technologies such as Helium containers (application silos, used e.g. by MSIX packaged apps) or Argon containers (server silos, used e.g. by Docker). They are managed by the AppInfo service through VRegDriver &ndash; a special module built into ntoskrnl.exe that is tightly integrated with the Configuration Manager and exposes an IOCTL interface to operate on delta hives. Many default Windows components and programs (e.g. the Widgets app, Paint, Notepad) run in the context of app silos, so there are typically a number of hives mounted under \Registry\WC at any given time. Other than that, there isn&#39;t much that can be said about them as a whole, as their backing files and security settings can vary greatly depending on multiple factors. These special hives will be discussed in more detail in future blog posts.</span></p></td></tr></table>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">There are a few other system hives that can be found in C:\Windows\system32\config\ on modern versions of Windows that aren&#39;t discussed above:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><ul style="padding: 0;" class="lst-kix_r30wc2x8r6xx-0 start"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>BBI &ndash; likely </span><span class="BGxMwKFqAI-c14">Background Broker Infrastructure</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">, loaded during boot as an app hive by the Background Tasks Infrastructure Service (bisrv.dll).</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">COMPONENTS &ndash; contains information associated with Windows Update and the Component Based Servicing (CBS) stack. It isn&#39;t always active, but instead, it is loaded and unloaded on demand whenever a component installation or update takes place.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">DRIVERS &ndash; driver information store, loaded by the kernel on demand at \Registry\Machine\DRIVERS.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>ELAM &ndash; </span><span class="BGxMwKFqAI-c14">Early Launch Anti-Malware</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">, briefly loaded during boot at \Registry\Machine\ELAM.</span></li></ul>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Note that these hives exist, but they aren&#39;t particularly interesting in the context of this research. Now, equipped with the knowledge of how the default Windows hives function, let&#39;s see what operations can be performed on them as whole objects.</span></p><h2 class="BGxMwKFqAI-c36 BGxMwKFqAI-c8" id="h.2zooj0mirsrm"><span>Hive operations</span></h2>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The Windows kernel provides several system calls for operating on registry hives, which are summarized in the following table:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><table class="BGxMwKFqAI-c43"><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c45 BGxMwKFqAI-c38" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c34"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c19 BGxMwKFqAI-c17">Syscall name(s)</span></p></td><td class="BGxMwKFqAI-c25 BGxMwKFqAI-c38" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c34"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c19 BGxMwKFqAI-c17">Description</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c45" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">NtCompressKey</span></p></td><td class="BGxMwKFqAI-c25" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Compresses the specific hive in-place by defragmenting allocated cells.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c45" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">NtLoadKey*</span></p></td><td class="BGxMwKFqAI-c25" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>Loads an existing hive or creates a new one, and mounts it in the global tree view. Documented counterparts: </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regloadkeyw">RegLoadKey</a></span><span>&nbsp;and </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regloadappkeyw">RegLoadAppKey</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. The interface is internally used by the &#39;File &gt; Load Hive...&#39; option in Regedit.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c45" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">NtReplaceKey</span></p></td><td class="BGxMwKFqAI-c25" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>Replaces the backing file of a specific active hive with another file on the next system boot. Documented counterpart: </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regreplacekeyw">RegReplaceKey</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c45" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">NtRestoreKey</span></p></td><td class="BGxMwKFqAI-c25" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>Copies data from a hive file to the global registry tree. This operation is similar to loading, but doesn&#39;t maintain any synchronization between the in-memory and on-disk representations after the hive is loaded (</span><span class="BGxMwKFqAI-c14">restored</span><span>). Documented counterpart: </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regrestorekeyw">RegRestoreKey</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. This interface is internally used by the &#39;File &gt; Import...&#39; option in Regedit.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c45" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">NtSaveKey*, NtSaveMergedKeys</span></p></td><td class="BGxMwKFqAI-c25" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>Saves the specific subtree to a file on disk in the regf format. Documented counterparts: </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regsavekeyw">RegSaveKey</a></span><span>&nbsp;and </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regsavekeyexw">RegSaveKeyEx</a></span><span>. This interface is internally used by the &#39;File &gt; Export...&#39; option in Regedit. Interestingly, the sole purpose of NtSaveMergedKeys seems to be to provide a NtSaveKey-like functionality for HKEY_CLASSES_ROOT, which, as mentioned earlier, is a special merged view of </span><span>\Registry\Machine\Software\Classes</span><span>&nbsp;and </span><span>\Registry\User\&lt;SID&gt;_Classes</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;implemented in user-mode.</span></p></td></tr><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c45" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">NtUnloadKey*</span></p></td><td class="BGxMwKFqAI-c25" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4"><span>Unloads a registry hive and unmounts it from the global view. Documented counterpart: </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regunloadkeyw">RegUnLoadKey</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. This interface is internally used by the &#39;File &gt; Unload Hive...&#39; option in Regedit.</span></p></td></tr></table>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The above services provide some valuable insight into what actions can be performed on hives. A careful reader will notice that this list is longer than the table of basic hive operations shown in </span><span class="BGxMwKFqAI-c5"><a href="https://googleprojectzero.blogspot.com/2024/04/the-windows-registry-adventure-2.html">blog post #2</a></span><span>, which is because </span><span>all of these syscalls (other than NtLoadKey* with the </span><span>REG_APP_HIVE</span><span>&nbsp;flag) require administrative privileges (SeBackupPrivilege or SeRestorePrivilege) and are not a widely accessible attack surface. Furthermore, most of them see little to no use in a typical system run time. The only notable exception is NtRestoreKey, which is part of the &quot;</span><span>RXact</span><span>&quot; user-mode transaction mechanism used for operating on the SAM hive by the SAM Service, as mentioned in the </span><span class="BGxMwKFqAI-c5"><a href="https://github.com/googleprojectzero/p0tools/tree/master/WinRegLowSeverityBugs/Reports/15_Registry_quota_exhausted_SAM_corruption">Windows Kernel registry quota exhaustion may lead to permanent corruption of the SAM database</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;report (CVE-2024-26181).</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">From a strictly security perspective, the most critical hive-related operation is their loading. Let&#39;s dive deeper into how it works.</span></p><h2 class="BGxMwKFqAI-c36 BGxMwKFqAI-c8" id="h.iws2xszhgl0b"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c40 BGxMwKFqAI-c35">Loading hives</span></h2>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">There are currently three distinct ways in which registry hives are loaded in Windows:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><ol class="lst-kix_phgwltrvdlzg-0 start" start="1"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>Internally by the kernel at boot time.</span><span>&nbsp;This applies to most of the hives under </span><span>\Registry\Machine</span><span>, as well as </span><span>\Registry\User\.DEFAULT</span><span>. There is also an optional hive named &quot;OSDATA&quot; that gets loaded under </span><span>\Registry\Machine\OSDATA</span><span>&nbsp;if it exists at C:\Windows\system32\config\OSDATA. It is unclear what its role is, and I was unable to find much information during a quick web search. It seems to be used by user-mode libraries whenever </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-rtlisstateseparationenabled">RtlIsStateSeparationEnabled</a></span><span>&nbsp;returns TRUE, which implies it may be somehow related to </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/factoryos/state-separation?view=windows-11">State Separation</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span>Using one of the NtLoadKey-family system calls, which may be invoked from the kernel, a privileged user-mode service, or a normal user application. In the latter two cases, the request usually comes through a corresponding Registry API function such as </span><span>RegLoadKey</span><span>&nbsp;or (more likely) </span><span>RegLoadAppKey</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Through the IOCTL interface of the VRegDriver, in order to load a differencing hive under \Registry\WC. This path is taken exclusively by system services responsible for the initialization of application and server silos, such as the AppInfo service.</span></li></ol>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The first option isn&#39;t particularly important because it happens seamlessly before we can influence the system in any way, and we are simply left with the outcome (but if you&#39;re curious to learn more, here are some good starting points: CmInitSystem1, CmpInitializeSystemHive, NtInitializeRegistry, CmpInitializeSystemHivesLoad, CmpFinishSystemHivesLoad). Furthermore, option #3 is related to container support and thus mostly outside of the scope of this post, but we will briefly cover it later. Right now, let&#39;s focus on the standard interfaces that Windows exposes for loading hives (option #2), as this is where the magic happens.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The primary Registry API function for loading hives is </span><span>RegLoadKey</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">, whose Unicode version has the following declaration:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">LSTATUS</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">RegLoadKeyW(</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">HKEY</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">hKey,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in,</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">optional]</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">LPCWSTR</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">lpSubKey,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">LPCWSTR</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">lpFile</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">);</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>It&#39;s quite clear that the function offers limited customization options, as it only takes a handle to the root key, the name of the subkey that will become the mount point, and the path of the hive file to load. In Windows Vista, a second API function called </span><span>RegLoadAppKey</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;was introduced, designed specifically to allow the caller to load application hives:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">LSTATUS</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">RegLoadAppKeyW(</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">LPCWSTR</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">lpFile,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[out]</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">PHKEY</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">phkResult,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">REGSAM</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">samDesired,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">[in]</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">DWORD</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">dwOptions,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c1">DWORD</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp;</span><span class="BGxMwKFqAI-c1">Reserved</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">);</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In this case, we lose the ability to specify the path of the hive mount point, which is irrelevant because app hives cannot be accessed through fully-qualified paths anyway. On the other hand, we gain some customizability as we can pass the </span><span>REG_PROCESS_APPKEY</span><span>&nbsp;flag via </span><span>dwOptions</span><span>, and there is also a </span><span>Reserved</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;parameter that may be used to further extend the functionality in the future.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Both of these documented functions internally rely on NtLoadKey-family system calls, such as NtLoadKey, NtLoadKey2, NtLoadKeyEx or NtLoadKey3 (admittedly quite an unconventional progression). New iterations have been historically added in subsequent versions of Windows to extend the functionality of the previous syscalls. In the case of NtLoadKeyEx, the definition of this singular system call even changed between Windows Server 2003 and Windows Vista to accommodate new options, which is unusual, as syscall definitions tend to be stable. These developments are illustrated in the image below:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj67hfn8UpAN290AFsLJS_oeeJdHnVwnOTOqSVqXL7vsNjTIttrj_9ib9tlNIticxWSY_LmZGmr2tm2cDFN3gaEzVH7W4muzIueVWEEfnPkki8Dx4LjDFq6k8lM7R9GkwZgX62_TGuubdgp5bC-UbSKWuIyar49i3lw-VRbxCWsVD2vzN_imWxOVDw07r8/s643/image1.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="A chart depicting the evolution of the NtLoadKey function and its usage in loading registry hives in different versions of Microsoft Windows. The stages are as follows: * **Windows NT 3.1:** `NtLoadKey` * **Windows NT 4.0:** `NtLoadKey2` * **Windows Server 2003:** `NtLoadKeyEx` (4 arguments) * **Windows Vista:** `NtLoadKeyEx` (8 arguments) * **Windows 10 20H1:** `NtLoadKey3`" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj67hfn8UpAN290AFsLJS_oeeJdHnVwnOTOqSVqXL7vsNjTIttrj_9ib9tlNIticxWSY_LmZGmr2tm2cDFN3gaEzVH7W4muzIueVWEEfnPkki8Dx4LjDFq6k8lM7R9GkwZgX62_TGuubdgp5bC-UbSKWuIyar49i3lw-VRbxCWsVD2vzN_imWxOVDw07r8/s643/image1.png" style="max-height: 750px; max-width: 600px;" title="A chart depicting the evolution of the NtLoadKey function and its usage in loading registry hives in different versions of Microsoft Windows. The stages are as follows: * **Windows NT 3.1:** `NtLoadKey` * **Windows NT 4.0:** `NtLoadKey2` * **Windows Server 2003:** `NtLoadKeyEx` (4 arguments) * **Windows Vista:** `NtLoadKeyEx` (8 arguments) * **Windows 10 20H1:** `NtLoadKey3`" /></a></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Let&#39;s have a closer look at the prototype of NtLoadKeyEx, whose arguments most clearly reflect the evolution of the interface. While the latest NtLoadKey3 function introduced further advancements by making it possible to specify additional impersonation tokens, its definition references an undocumented structure and is thus less suitable as an example. If you&#39;re curious to learn more about this newest syscall, see James&#39;s </span><span class="BGxMwKFqAI-c5"><a href="https://www.tiraniddo.dev/2020/05/silent-exploit-mitigations-for-1.html">Silent Exploit Mitigations for the 1%</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;blog post. Meanwhile, NtLoadKeyEx is defined as follows:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">NTSTATUS NtLoadKeyEx(</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; POBJECT_ATTRIBUTES TargetKey, &nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKey &nbsp; (Windows NT 3.1)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; POBJECT_ATTRIBUTES SourceFile, </span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKey &nbsp; (Windows NT 3.1)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; ULONG Flags, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKey2 &nbsp;(Windows NT 4.0)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; HANDLE TrustClassKey, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKeyEx (Windows Server 2003)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; HANDLE Event, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKeyEx (Windows Vista)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; DWORD DesiredAccess, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKeyEx (Windows Vista)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; PHANDLE RootHandle, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKeyEx (Windows Vista)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">&nbsp; &nbsp; PIO_STATUS_BLOCK IoStatus &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c20 BGxMwKFqAI-c24">// since NtLoadKeyEx (Windows Vista)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">);</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Here&#39;s an overview of the semantics of the parameters:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><ul style="padding: 0;" class="lst-kix_fmufqr7nbrst-0 start"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">TargetKey</span><span>&nbsp;&ndash; specifies the new mount point of the hive, e.g. </span><span>\Registry\User\&lt;SID&gt;</span><span>. Corresponds to the combination of </span><span>hKey</span><span>/</span><span>lpSubKey</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;arguments in RegLoadKey.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">SourceFile</span><span>&nbsp;&ndash; specifies the path of the hive on a file system in the internal NT format, e.g. </span><span>\??\C:\Users\&lt;USER&gt;\NTUSER.DAT</span><span>. Directly corresponds to the </span><span>lpFile</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;argument in RegLoadKey.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">Flags</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;&ndash; specifies a set of options for loading the hive.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">TrustClassKey</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;&ndash; specifies an existing hive within the same &quot;trust class&quot; as the loading hive. Trust classes, introduced in Windows Server 2003, define strict rules for which hives can link to each other, preventing symbolic link attacks (for example, disallowing links from HKCU to HKLM).</span></li></ul>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The last four arguments are only used for app hives or hives for which the caller explicitly requests an open handle (</span><span>REG_APP_HIVE</span><span>&nbsp;or </span><span>REG_LOAD_HIVE_OPEN_HANDLE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;flags set):</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><ul style="padding: 0;" class="lst-kix_fmufqr7nbrst-0"><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">Event</span><span>&nbsp;&ndash; specifies an event object that gets signaled when the hive is unloaded. Internally, it gets added to a dynamically allocated array pointed to by </span><span>CMHIVE.UnloadEventArray</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. It is most meaningful for application hives, which get automatically unloaded when all references are closed, so the event makes it possible for applications to get notified about this fact and perform any follow up actions.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">DesiredAccess</span><span>&nbsp;&ndash; specifies the access rights requested for the returned root key. It directly corresponds to the </span><span>samDesired</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;argument in RegLoadAppKey.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">RootHandle</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;&ndash; a pointer to a variable that receives the handle to the root key of the hive. This is the same handle that gets returned by RegLoadAppKey.</span></li><li style="margin-left: 46pt;" class="c4 c8 c23 li-bullet-0"><span class="BGxMwKFqAI-c17">IoStatus</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;&ndash; an I/O status block that used to be passed to NtCreateFile when opening the hive file. It is currently unused.</span></li></ul>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The most interesting parameter is probably </span><span>Flags</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">, which takes a combination of options for loading the hive, and is very illustrative of what is actually possible with the interface. The supported flags are defined in the Windows SDK, both in the user-mode (winnt.h) and kernel-mode headers (wdm.h). The flag namespace is actually shared between the NtLoadKey* syscalls and NtRestoreKey, so I crossed out the flags that are not relevant to loading (mask 0xB):</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">//</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Key restore &amp; hive load flags</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">//</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c35"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_WHOLE_HIVE_VOLATILE</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000001L</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c41 BGxMwKFqAI-c24">// Restore whole hive volatile</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_REFRESH_HIVE</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000002L</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c24 BGxMwKFqAI-c41">// Unwind changes to last flush</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_NO_LAZY_FLUSH</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000004L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Never lazy flush this hive</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_FORCE_RESTORE</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000008L</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c29">&nbsp;</span><span class="BGxMwKFqAI-c29 BGxMwKFqAI-c9 BGxMwKFqAI-c41 BGxMwKFqAI-c24">// Force the restore process even when we have open handles on subkeys</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_APP_HIVE</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000010L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Loads the hive visible to the calling process</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_PROCESS_PRIVATE</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000020L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Hive cannot be mounted by any other process while in use</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_START_JOURNAL</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000040L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Starts Hive Journal</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_HIVE_EXACT_FILE_GROWTH</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000080L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Grow hive file in exact 4k increments</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_HIVE_NO_RM</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000100L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// No RM is started for this hive (no transactions)</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_HIVE_SINGLE_LOG</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000200L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Legacy single logging is used for this hive</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_BOOT_HIVE</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000400L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// This hive might be used by the OS loader</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_LOAD_HIVE_OPEN_HANDLE</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00000800L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Load the hive and return a handle to its root kcb</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_FLUSH_HIVE_FILE_GROWTH</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00001000L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Flush changes to primary hive file size as part of all flushes</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_OPEN_READ_ONLY</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00002000L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Open a hive&#39;s files in read-only mode</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_IMMUTABLE</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00004000L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Load the hive, but don&#39;t allow any modification of it</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">#define</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">REG_NO_IMPERSONATION_FALLBACK</span><span class="BGxMwKFqAI-c9">&nbsp; &nbsp;</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">(</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c16">0x00008000L</span><span class="BGxMwKFqAI-c9 BGxMwKFqAI-c21">)</span><span class="BGxMwKFqAI-c9">&nbsp;</span><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24">// Do not fall back to impersonating the caller if hive file access fails</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c9 BGxMwKFqAI-c24"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>As shown, there are a total of 13 available flags with clear names and comments explaining their purpose. However, not all 8192 combinations of them are valid. Rules and dependencies exist &ndash; for example, application hives (</span><span>REG_APP_HIVE</span><span>) cannot be loaded with lazy flushing disabled (</span><span>REG_NO_LAZY_FLUSH</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">). In the next sections, we will explore these limitations, covering the required client privileges, supported flags and allowed mount points.</span></p><h3 class="BGxMwKFqAI-c49 BGxMwKFqAI-c8" id="h.2op3yuzfi1wb"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c22">Standard hive loading</span></h3>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The most important distinction for the NtLoadKey* system calls </span><span>is whether</span><span>&nbsp;the hive is being loaded as an app hive (</span><span>REG_APP_HIVE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;flag set) or not. If it&#39;s not, then it&#39;s considered as &quot;standard&quot; hive loading, the only type that existed prior to Windows Vista.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.hg8z4bvr9nrr"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Privileges</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">The official documentation for RegLoadKey states that both SeRestorePrivilege and SeBackupPrivilege privileges are required to use the function. In practice, however, only SeRestorePrivilege is checked. This is still a privilege that is granted to administrators only, so loading any globally visible hives is not possible for a normal user. As evidence, attempting to use the &#39;File &gt; Load Hive...&#39; option in Regedit without administrative privileges results in an &#39;Insufficient privileges&#39; error. This might also explain, at least in part, why the Configuration Manager may not be entirely robust against malformed hives. The original developers likely assumed the code would need to gracefully handle random data corruption, but not necessarily malicious files from untrusted sources.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>It is also worth keeping in mind that while a local attacker cannot </span><span class="BGxMwKFqAI-c14">directly</span><span>&nbsp;load a normal hive, they may be able to entice the Profile Service to load it on their behalf thanks to </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows/win32/shell/mandatory-user-profiles">Mandatory User Profiles</a></span><span>. This mechanism causes the system to prioritize the NTUSER.MAN hive file (if it exists in the user directory) over NTUSER.DAT, and loads it as the user hive when the user signs in. It is thus possible to plant a specially crafted hive under NTUSER.MAN, log out, and log back in to have it loaded by Windows. This comes with some limitations, as the hive needs to have a valid, basic structure expected of the HKCU, and the attacker must be able to create files in %USERPROFILE% and to log in and out (so it precludes certain sandbox escapes etc.). Nevertheless, it may be a valid attack vector, and it was in fact used to demonstrate the practical exploitability of issues </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2047">#2047</a></span><span>, </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2048">#2048</a></span><span>, </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2297">#2297</a></span><span>, </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2366">#2366</a></span><span>, </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2419">#2419</a></span><span>, </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2445">#2445</a></span><span>&nbsp;and </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2492">#2492</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">. An even more extreme idea of this kind could involve two local, cooperating users who grant each other access to their respective NTUSER.DAT files and modify them while the other user is signed out (when the hive is not locked). However this is even less practical so we won&#39;t spend more time on this scenario.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.41tb7873wc7r"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Mount Points</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>One of the core invariants of the Windows registry is that hives may only be mounted within the master hive (</span><span>CmpMasterHive</span><span>). This is enforced by </span><span>CmpDoParseKey</span><span>&nbsp;when trying to link the new hive into the global tree, and it means that </span><span>hives</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;cannot be loaded relative to other hives. If we look at the list of the top-level HKEY keys, the only two that represent the master hive are HKEY_LOCAL_MACHINE and HKEY_USERS. And indeed, the &#39;File &gt; Load Hive...&#39; option in Regedit is only enabled when the focus is on one of the two keys, otherwise it is grayed out:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYzpoESexXclZYcCR3F92ihsaQlDVsBS544l1bjMDeiUXgeakPbyjcgcKLA-jHhKEy8cOREWmsR6s0a__CdCW8r9702PatbiOWAFvT-OrnyRAR7rgflb96mZmhbDggMXebSA2y5H1HqbZTD3-Yo6fL9fpJhuddQXq2Yeq-vlFt2jGEp0mncZuzgZsUREg/s294/image5.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="Image of Registry Editor menu in Windows with &quot;Load Hive...&quot; option highlighted" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYzpoESexXclZYcCR3F92ihsaQlDVsBS544l1bjMDeiUXgeakPbyjcgcKLA-jHhKEy8cOREWmsR6s0a__CdCW8r9702PatbiOWAFvT-OrnyRAR7rgflb96mZmhbDggMXebSA2y5H1HqbZTD3-Yo6fL9fpJhuddQXq2Yeq-vlFt2jGEp0mncZuzgZsUREg/s294/image5.png" style="max-height: 750px; max-width: 600px;" title="Image of Registry Editor menu in Windows with &quot;Load Hive...&quot; option highlighted" /></a></span></p>
 <p class="BGxMwKFqAI-c37 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>As mentioned earlier, the current convention is that all hives in the system are typically mounted on the third level of the global registry tree, i.e. below one of </span><span>\Registry\{A,MACHINE,USER,WC}</span><span>. However, there is nothing preventing a privileged program from loading a hive directly under the </span><span>\Registry</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;root, too.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.41tb7873wc7r"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Flags</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In standard hive loading, there are almost no restrictions on the flags that can be used. The only requirement is that if the </span><span>REG_FLUSH_HIVE_FILE_GROWTH</span><span>&nbsp;flag is set, then both </span><span>REG_HIVE_SINGLE_LOG</span><span>&nbsp;and </span><span>REG_BOOT_HIVE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;must be set, too.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.8wrioj49inha"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Unloading</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Normal hives stay loaded until they are manually unloaded or the system is shut down. The former can be achieved with the RegUnLoadKey API, or one of the underlying system calls: NtUnloadKey (since Windows NT 3.1), NtUnloadKeyEx (since Windows XP), or NtUnloadKey2 (since Windows Server 2003). Their prototypes are shown below:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">NTSTATUS NtUnloadKey(</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">&nbsp; &nbsp; POBJECT_ATTRIBUTES TargetKey</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">);</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">NTSTATUS NtUnloadKeyEx(</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">&nbsp; &nbsp; POBJECT_ATTRIBUTES TargetKey,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">&nbsp; &nbsp; HANDLE Event</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">);</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">NTSTATUS NtUnloadKey2(</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">&nbsp; &nbsp; POBJECT_ATTRIBUTES TargetKey,</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">&nbsp; &nbsp; ULONG Flags</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">);</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The first syscall simply takes the path of the target key, the second adds an event that will be signaled when the hive is actually unloaded (in case any references to it are still open and the system call returns </span><span>STATUS_PENDING</span><span>), and the third one makes it possible to pass a </span><span>REG_FORCE_UNLOAD</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;(0x1) flag to force the unload even if any handles are open. All of them require SeRestorePrivilege to call successfully, so a local attacker has no way of using them directly.</span></p><h3 class="BGxMwKFqAI-c49 BGxMwKFqAI-c8" id="h.brie3oqv33df"><span class="BGxMwKFqAI-c22 BGxMwKFqAI-c6">Application hive loading</span></h3>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Application hives are undoubtedly one of the most security-relevant aspects of the registry, as they allow normal users to load fully controlled binary hives in the system. They played a crucial role in my research, having been useful in demonstrating the practical exploitability of 15 vulnerabilities reported to Microsoft.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In technical terms, every hive that is loaded with the </span><span>REG_APP_HIVE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;flag is an app hive, and they get special treatment from the kernel in several respects. Let&#39;s examine some of the apphive-specific behaviors in the sections below.</span></p><h4 class="BGxMwKFqAI-c8 BGxMwKFqAI-c44" id="h.lbol6cgzhmg7"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Privileges</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Contrary to normal hives, loading application hives requires no specific privileges from the caller. The only precondition is that the client has access to at least one file that is encoded as a regf, and the kernel can also open the file with the security token of the process for reading, and potentially writing. This is a trivial prerequisite if the attacker starts with full control over a local user account in the system, but may be potentially more difficult in more constrained environments such as security sandboxes.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Another consideration specific to application hives are their security descriptors. The documentation of the RegLoadAppKey function states:</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p><table class="BGxMwKFqAI-c43"><tr class="BGxMwKFqAI-c13"><td class="BGxMwKFqAI-c39" colspan="1" rowspan="1">
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c14">All keys inside the hive must have the same security descriptor, otherwise the function will fail. This security descriptor must grant the caller the access specified by the samDesired parameter or the function will fail. You cannot use the RegSetKeySecurity function on any key inside the hive.</span></p></td></tr></table>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>This doesn&#39;t </span><span>matter much from a security perspective, because if the caller is attempting to load the hive, they most likely already have write access to that file. So regardless of its contents, if the caller is determined to load the hive, they can just modify it accordingly (e.g. change the security descriptors). But it is interesting to note that the above statement is only partially correct: </span><span>indeed, no new security descriptors can be added to an active app hive, either through a RegSetKeySecurity call or by creating a new key with a custom descriptor (e.g. with a RegCreateKeyEx call with a non-NULL </span><span>lpSecurityAttributes</span><span>&nbsp;parameter). However, it is not quite right that RegLoadAppKey will fail if there is more than one security descriptor: currently, there are no such restrictions enforced and app hives can be successfully loaded with any number of descriptors. Furthermore, only </span><span>KEY_READ</span><span>&nbsp;access is checked rather than the </span><span>samDesired</span><span>&nbsp;mask specified by the caller, and only against the root key instead of all keys in the hive (this ties to there potentially being more than one descriptor). This has been reported to </span><span>Microsoft in </span><span class="BGxMwKFqAI-c5"><a href="https://github.com/googleprojectzero/p0tools/tree/master/WinRegLowSeverityBugs/Reports/20_App_hive_security_inconsistencies">Windows Kernel enforcement of registry app hive security is inconsistent with documentation</a></span><span>, and has been acknowledged as a discrepancy between documentation and implementation, but it is unclear if/when any steps will be taken to address it.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.sf9k64tstl2s"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Mount Points</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Application hives are subject to even stricter requirements with regards to mount points than normal hives: not only do they have to be mounted in the master hive, but it has to be specifically under </span><span>\Registry\A</span><span>. This &quot;A&quot; key is unique in that it and its subkeys are explicitly protected from opening by name. The check takes place in CmpParseKey, and the specific routine responsible for verifying the path is CmpDoesParseEnterRegistryA. Some of these rigorous checks were added and/or refined in response to James&#39;s issues </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=865">#865</a></span><span>&nbsp;and </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=870">#870</a></span><span>&nbsp;discovered in 2016</span><span>. This means that the only way to obtain a handle to a key within </span><span>\Registry\A</span><span>&nbsp;is through the </span><span>RootHandle</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;argument to NtLoadKeyEx / NtLoadKey3, which ensures maximum privacy for the application hives. Since the names of the mount points are not used for anything, the only important property is that they don&#39;t collide with each other. This is guaranteed by KernelBase.dll in the internal BuildRootKeyName function, which picks the mount point name by generating a random 128-bit number and formatting it as a GUID string.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Another interesting feature of app hives is their ability to be shared between processes. If multiple processes load the same hive without the </span><span>REG_PROCESS_APPKEY</span><span>&nbsp;flag, they&#39;ll all access the same underlying data. In practice, if an app hive is first loaded at </span><span>\Registry\A\Test1</span><span>, and another program tries to load the same hive at </span><span>\Registry\A\Test2</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">, the kernel will effectively reuse the existing &quot;Test1&quot; hive, providing the caller with a handle to it. Because the mount point is irrelevant to the client after loading, this approach is both safe and efficient.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.sf9k64tstl2s"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Flags</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In addition to the flag restrictions imposed on normal hives, application hives disallow </span><span>REG_NO_LAZY_FLUSH</span><span>&nbsp;(0x4), </span><span>REG_START_JOURNAL</span><span>&nbsp;(0x40) and </span><span>REG_BOOT_HIVE</span><span>&nbsp;(0x400), which means that </span><span>REG_FLUSH_HIVE_FILE_GROWTH</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;(0x1000) is also prohibited. This leaves 0xEBB0 as the supported set of flags.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>It&#39;s also worth noting that even though it is allowed, </span><span>REG_HIVE_NO_RM</span><span>&nbsp;(0x100) doesn&#39;t do anything for app hives because KTM transactions are disabled for them anyway. Furthermore, there seems to be a minor bug where specifying both the </span><span>REG_APP_HIVE</span><span>&nbsp;(0x10) and </span><span>REG_LOAD_HIVE_OPEN_HANDLE</span><span>&nbsp;(0x800) flags will cause the hive to stay loaded indefinitely. This proved useful as an exploitation primitive in issue </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2378">#2378</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">, but in general it simply leads to a memory leak and locking the hive file until the next reboot.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.yf98f385jsrt"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Unloading</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Application hives don&#39;t need to be manually unloaded with any of the NtUnloadKey* system calls, but instead they are automatically unloaded when all handles to the hive&#39;s keys are closed. Internally, this is achieved by checking if the reference count of the root key&#39;s KCB has dropped to a near-zero value, and scheduling the CmpLateUnloadHiveWorker function to perform the actual cleanup.</span></p><h3 class="BGxMwKFqAI-c8 BGxMwKFqAI-c49" id="h.py3q4qzaamuq"><span class="BGxMwKFqAI-c22 BGxMwKFqAI-c6">Differencing hive loading</span></h3>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">Differencing hives are the third major category of hives and the most recent one, introduced in Windows 10 1607. They are similar to application hives in that they are invisible to the naked eye (you won&#39;t typically see them in Regedit), but they are also much more complex, both for loading and operating on. Let&#39;s see how they compare to the other types of hives we have discussed so far.</span></p><h4 class="BGxMwKFqAI-c44 BGxMwKFqAI-c8" id="h.n4854jrjg0om"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c27">Privileges</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>I have to start by saying that it is impossible to load a differencing hive with any of the standard NtLoadKey-family syscalls. These special hives need to be overlaid on top of other hives, and must also be configured as either </span><span class="BGxMwKFqAI-c14">writethrough</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;or not. Instead of adding yet another system call or extending an existing one to accommodate these settings, Microsoft decided to take a different approach. This explains why none of the REG_* flags listed above reference differencing hives in any way.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>In order to support registry containerization, the vendor added a driver called &quot;VRegDriver&quot; that is built into the ntoskrnl.exe executable image. It consists of two main parts: an IOCTL interface accessible at </span><span>\Device\VRegDriver</span><span>&nbsp;allowing communication with other system components, and a </span><span class="BGxMwKFqAI-c5"><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/filtering-registry-calls">registry callback</a></span><span>&nbsp;(VrpRegistryCallback) that implements the namespace redirection functionality. The generic IOCTL handler is VrpIoctlDeviceDispatch, and it supports nine different operations. One of them is 0x220008, handled by VrpHandleIoctlLoadDifferencingHive. This is the IOCTL used by the AppInfo service to load differencing hives on behalf of a starting </span><span class="BGxMwKFqAI-c14">Centennial</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;application, and it does so by taking an undocumented structure on input, extracting the necessary information from it and calling directly into the internal CmLoadDifferencingKey routine to load the hive &ndash; the same one that NtLoadKey* use, too. (On a side note, there is a similar IOCTL 0x220020 handled by VrpHandleIoctlLoadDifferencingHiveForHost, but it&#39;s currently unclear how it&#39;s used or how it differs from 0x220008.)</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Given all this, directly loading a differencing hive requires the ability to open the </span><span>\Device\VRegDriver</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;object (only accessible to administrators), as well as having the SeBackupPrivilege and SeRestorePrivilege rights (enforced by the IOCTL handler). Thus, it&#39;s clear that the option is not available to normal users. Alternatively, one can take advantage of the legitimate uses of the mechanism &ndash; &nbsp;bundle a malicious hive with a MSIX-packaged app or a Docker container that gets installed on the victim machine, and have it loaded as part of normal system operation. Naturally, this significantly limits the attack&#39;s practicality and also imposes further constraints on how the hive is loaded.</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>That said, loading custom differencing hives may not be necessarily required to exploit vulnerabilities related to layered keys. The </span><span>\Registry\WC</span><span>&nbsp;key is not locked down the same way as </span><span>\Registry\A</span><span>&nbsp;is, so it can be freely enumerated, and its subkeys can be opened and accessed according to their security descriptors. Furthermore, there are a number of default programs in Windows that make use of differencing hives, and in many cases an attacker can simply reuse one of them for their own purposes. For example, out of the </span><span class="BGxMwKFqAI-c5"><a href="https://project-zero.issues.chromium.org/issues?q=id:(42451588%20%7C%2042451589%20%7C%2042451590%20%7C%2042451592%20%7C%2042451596%20%7C%2042451607%20%7C%2042451608%20%7C%2042451609%20%7C%2042451611%20%7C%2042451625)">10 bugs</a></span><span>&nbsp;I found that involved layered keys, only </span><span class="BGxMwKFqAI-c5"><a href="https://project-zero.issues.chromium.org/issues?q=id:(42451596%20%7C%2042451625)">2</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;of them required the ability to load custom differencing hives.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.lhqjp53jtunt"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Mount Points</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>None of the kernel-mode components enforce any specific requirements with regards to the differencing hive mount points, other than them being located in the master hive (as for every other hive). This means that in theory, they could be loaded anywhere within </span><span>\Registry</span><span>&nbsp;or one of its four subkeys. In practice, all services using these hives for their intended purpose always load them under </span><span>\Registry\WC</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">.</span></p><h4 class="BGxMwKFqAI-c28 BGxMwKFqAI-c8" id="h.lhqjp53jtunt"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Flags</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Let&#39;s take a look at my reverse-engineered definition of the input structure expected by VrpHandleIoctlLoadDifferencingHive on Windows 11, which can be found in the </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/attachmentText?aid=608460">CreateAndLoadDifferencingHive.cpp</a></span><span>&nbsp;proof-of-concept exploit for issue </span><span class="BGxMwKFqAI-c5"><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2479">#2479</a></span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c20 BGxMwKFqAI-c46">struct</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">VRP_LOAD_DIFFERENCING_HIVE_INPUT</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">{</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x00</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/HANDLE</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">hJob;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x08</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/DWORD</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">Unused1;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x0c</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/DWORD</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">DiffHiveFlags;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x10</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/DWORD</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">LoadFlags;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x14</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/WORD</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">MountPointLength;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x16</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/WORD</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">HivePathLength;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x18</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/WORD</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">BaseLayerPathLength;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x1a</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/WORD</span><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">Unused2;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x1c</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/DWORD</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">Unused3;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x20</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/HANDLE</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">hToken;</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c20">&nbsp; </span><span class="BGxMwKFqAI-c1">/*</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">+</span><span class="BGxMwKFqAI-c3">0x28</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">*/WCHAR</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">Buffer[</span><span class="BGxMwKFqAI-c3">1</span><span class="BGxMwKFqAI-c1">];</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6">};</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c1 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Here at offset 0x10, </span><span>LoadFlags</span><span>&nbsp;represents the same information that is normally passed via the </span><span>Flags</span><span>&nbsp;argument to NtLoadKey* system calls. The set of legal flags for differencing hives is very narrow and consists of only three of them: </span><span>REG_HIVE_NO_RM </span><span>(0x100), </span><span>REG_OPEN_READ_ONLY</span><span>&nbsp;(0x2000) and </span><span>REG_IMMUTABLE</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;(0x4000).</span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>Moreover, there is also an extra </span><span>DiffHiveFlags</span><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">&nbsp;member at offset 0xc that specifies the flags specific to differencing hives. So far, I have observed three supported flags and deduced their meaning to be as follows:</span></p>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6"></span></p>
 <code><p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">DIFF_HIVE_ADD_TO_TRUST_CLASS</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c3">1</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">DIFF_HIVE_WRITETHROUGH</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="BGxMwKFqAI-c3">2</span></p>
 <p class="BGxMwKFqAI-c0"><span class="BGxMwKFqAI-c1">#define</span><span class="BGxMwKFqAI-c20">&nbsp;</span><span class="BGxMwKFqAI-c1">DIFF_HIVE_TRUSTED</span><span class="BGxMwKFqAI-c20">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="BGxMwKFqAI-c3 BGxMwKFqAI-c6">4</span></p></code>
 <p class="BGxMwKFqAI-c0 BGxMwKFqAI-c18"><span class="BGxMwKFqAI-c3 BGxMwKFqAI-c6"></span></p>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span>The first and third flags are related to trust classes and the following of symbolic links, while the second one defines whether the hive is writethrough, which is a special type of differencing hive that redirects all write operations on its keys to the lower layers. If </span><span>DIFF_HIVE_WRITETHROUGH</span><span>&nbsp;is set in </span><span>DiffHiveFlags</span><span>, then </span><span>REG_IMMUTABLE</span><span>&nbsp;must be set in </span><span>LoadFlags</span><span>.</span></p><h4 class="BGxMwKFqAI-c8 BGxMwKFqAI-c28" id="h.32srse6twnfm"><span class="BGxMwKFqAI-c27 BGxMwKFqAI-c6">Unloading</span></h4>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">According to my experimentation, differencing hives are generally unloaded when the corresponding silo is destroyed: either by a system service invoking the 0x220018 IOCTL (VrpHandleIoctlUnloadDynamicallyLoadedHives) tearing down the container, or automatically when cleaning up the corresponding job object, which ends up in the internal VrpUnloadDifferencingHive routine. Eventually, both functions call ZwUnloadKey* (a kernel-mode wrapper around NtUnloadKey*), following the standard hive unloading procedure.</span></p><h2 class="BGxMwKFqAI-c36 BGxMwKFqAI-c8" id="h.y702uucex0ko"><span class="BGxMwKFqAI-c6 BGxMwKFqAI-c35 BGxMwKFqAI-c40">Conclusion</span></h2>
 <p class="BGxMwKFqAI-c4 BGxMwKFqAI-c8"><span class="BGxMwKFqAI-c11 BGxMwKFqAI-c6">In this post, I tried to shed some light on the structure of the registry tree, both at the high-level (WinAPI) and low-level (internal system libraries and the kernel). As shown, the relationship between these two views is complicated and contains many unexpected quirks. At the same time, becoming familiar with this design is invaluable for understanding some of the more advanced registry features and their security ramifications. I haven&#39;t been able to find a resource that systematically covers this subject, so I hope the blog post was helpful. In the next installment in the series, I will explain the internal structure of the hives and the many things that may surprise you there.</span></p>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/08975904405228580347' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/08975904405228580347' rel='author' title='author profile'>
<span itemprop='name'>Google Project Zero</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html' itemprop='url'/>
<a class='timestamp-link' href='https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2024-10-25T10:30:00-07:00'>10:30&#8239;AM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1053444070'>
<a href='https://www.blogger.com/post-edit.g?blogID=4838136820032157985&postID=1716815613826485459&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=1716815613826485459&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=1716815613826485459&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=1716815613826485459&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=1716815613826485459&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=1716815613826485459&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/4838136820032157985?po=1716815613826485459&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2315299244-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/java                   '>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://googleprojectzero.blogspot.com/2024/10/from-naptime-to-big-sleep.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://googleprojectzero.blogspot.com/2024/10/effective-fuzzing-dav1d-case-study.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://googleprojectzero.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://googleprojectzero.blogspot.com/feeds/1716815613826485459/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search This Blog</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://googleprojectzero.blogspot.com/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://googleprojectzero.blogspot.com/p/about-project-zero.html'>About Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/working-at-project-zero.html'>Working at Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/0day.html'>0day "In the Wild"</a>
</li>
<li>
<a href='https://googleprojectzero.github.io/0days-in-the-wild/rca.html'>0day Exploit Root Cause Analyses</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html'>Vulnerability Disclosure FAQ</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Archives</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/'>
2024
</a>
<span class='post-count' dir='ltr'>(8)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='posts'>
<li><a href='https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html'>The Windows Registry Adventure #4: Hives and the r...</a></li>
<li><a href='https://googleprojectzero.blogspot.com/2024/10/effective-fuzzing-dav1d-case-study.html'>Effective Fuzzing: A Dav1d Case Study</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/'>
2023
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/08/'>
August
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/'>
2022
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/11/'>
November
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/'>
2021
</a>
<span class='post-count' dir='ltr'>(24)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/01/'>
January
</a>
<span class='post-count' dir='ltr'>(10)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/'>
2020
</a>
<span class='post-count' dir='ltr'>(36)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/08/'>
August
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/07/'>
July
</a>
<span class='post-count' dir='ltr'>(8)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/06/'>
June
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/02/'>
February
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/01/'>
January
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(27)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/08/'>
August
</a>
<span class='post-count' dir='ltr'>(11)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/'>
2018
</a>
<span class='post-count' dir='ltr'>(22)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/12/'>
December
</a>
<span class='post-count' dir='ltr'>(7)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/10/'>
October
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/08/'>
August
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(19)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/03/'>
March
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(33)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/08/'>
August
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/07/'>
July
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/06/'>
June
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/02/'>
February
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/07/'>
July
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script type='text/javascript'>
//<![CDATA[
(function(){
  let archive_list = document.getElementById('ArchiveList');
  if (archive_list == null) return;
  let cur_year = archive_list.querySelector('.post-count-link').innerText.trim() - 0;
  let last_year = 2014;
  let elements = [];
  const MONTHS = ',Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'.split(',');

  let parent = document.getElementById('ArchiveList');
  while (parent.childNodes.length) parent.removeChild(parent.childNodes[0]);

  function fetch_next_year() {
    let url = 'https://googleprojectzero.blogspot.com/?action=getTitles&widgetId=BlogArchive1&widgetType=BlogArchive&responseType=js&path=https%3A%2F%2Fgoogleprojectzero.blogspot.com%2F'+cur_year;
    fetch(url).then(resp => {
      if (!resp.ok) {
        console.log('http error');
        return;
      }
      resp.text().then(text => {
        let scope = {
          _WidgetManager: {
            _HandleControllerResult: (name, method, results) => {
              elements.push(document.createElement('hr'));
              let year_header = document.createElement('div');
              year_header.appendChild(document.createTextNode(cur_year));
              year_header.style.fontSize = 'large';
              elements.push(year_header);

              let list = document.createElement('ul');
              elements.push(list);

              for (let obj of results.posts) {
                let link_parts = obj.url.split('/');
                let year = link_parts[3];
                let month = link_parts[4];

                let el = document.createElement(/*'div'*/'li');
                el.style.listStyleType = 'square';
                el.style.listStylePosition = 'inside';
                let link = document.createElement('a');
                el.appendChild(link);
                link.appendChild(document.createTextNode(obj.title));
                link.href = obj.url;
                let date_trailer = document.createElement('span');
                el.appendChild(date_trailer);
                //date_trailer.appendChild(document.createTextNode(' ('+year+'-'+month+')'));
                date_trailer.appendChild(document.createTextNode(' ('+MONTHS[parseInt(month, 10)]+')'));
                //date_trailer.style.textAlign = 'right';
                //elements.push(el);
                list.appendChild(el);
              }
            }
          }
        };
        with (scope) { eval(text); }
        if (cur_year == last_year) {
          finish();
        } else {
          cur_year--;
          fetch_next_year();
        }
      });
    });
  }
  fetch_next_year();
  function finish() {
    for (let obj of elements) {
      parent.appendChild(obj);
    }
    console.log(elements);
  }
})();
//]]>
</script>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-1'></div>
</td>
<td class='columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar no-items section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/2591855913-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY5aZdDOeEDng_u3stVHBPWIU2KBgg:1730592955146';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d4838136820032157985','//googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html','4838136820032157985');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4838136820032157985', 'title': 'Project Zero', 'url': 'https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html', 'canonicalUrl': 'https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html', 'homepageUrl': 'https://googleprojectzero.blogspot.com/', 'searchUrl': 'https://googleprojectzero.blogspot.com/search', 'canonicalHomepageUrl': 'https://googleprojectzero.blogspot.com/', 'blogspotFaviconUrl': 'https://googleprojectzero.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-240546891-1', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Project Zero - RSS\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/4838136820032157985/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/1716815613826485459/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/6eb7ce967db05cf0', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '1716815613826485459', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/s72-c/image3.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/s1200/image3.png', 'pageName': 'The Windows Registry Adventure #4: Hives and the registry layout', 'pageTitle': 'Project Zero: The Windows Registry Adventure #4: Hives and the registry layout'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'The Windows Registry Adventure #4: Hives and the registry layout', 'description': '  Posted by Mateusz Jurczyk, Google Project Zero     To a normal user or even a Win32 application developer, the registry layout may seem si...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3DcA4NRlJwRBwZj_EfcUNKjvc_9LuRBEDgidTVSPDGLOqKyspZ1Xl3QNx3n9eXGTHLnRctQ49HyrBmXcRTc-_g2S_vBbm0Uo67bScEqCV15lcRWWb_eNVGb7K7bc9caSF0lKuRDH5GXlJsyMzZ6DqYVkR_JVP8wIYWuqAgUSuXM1x6BXcaJeAZWHADu8/s1200/image3.png', 'url': 'https://googleprojectzero.blogspot.com/2024/10/the-windows-registry-adventure-4-hives.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 1716815613826485459}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/3386964323-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/13464135-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/about-project-zero.html', 'id': '4384467920505278144', 'title': 'About Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/working-at-project-zero.html', 'id': '2459334498880008057', 'title': 'Working at Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/0day.html', 'id': '3414239791814532209', 'title': '0day \x22In the Wild\x22'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.github.io/0days-in-the-wild/rca.html', 'title': '0day Exploit Root Cause Analyses'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html', 'id': '2935252455704572784', 'title': 'Vulnerability Disclosure FAQ'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>