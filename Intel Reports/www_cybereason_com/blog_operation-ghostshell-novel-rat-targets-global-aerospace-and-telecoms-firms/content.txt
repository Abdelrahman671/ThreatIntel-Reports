<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Nocturnus">
    <meta name="description" content="The highly-targeted attacks against aerospace and telecoms firms by new Iranian threat actor MalKamak includes newly discovered malware that evaded security tools since 2018 and abuses Dropbox services for command and control...">
    <meta name="generator" content="HubSpot">
    <title>Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="The highly-targeted attacks against aerospace and telecoms firms by new Iranian threat actor MalKamak includes newly discovered malware that evaded security tools since 2018 and abuses Dropbox services for command and control...">
    <meta property="og:title" content="Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms">
    <meta name="twitter:description" content="The highly-targeted attacks against aerospace and telecoms firms by new Iranian threat actor MalKamak includes newly discovered malware that evaded security tools since 2018 and abuses Dropbox services for command and control...">
    <meta name="twitter:title" content="Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386203/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443237/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1642017327438/module_48386556055_CR_-_HTML_PopUp_Window_--_IOCs.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042214535/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1669911113479/module_86933076631_CR_-_Sticky_CTA_Bar.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/34473990280/1704383554067/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/BLOG%20%20SOCIAL%20SET%20-%20News%20%281%29-1.png">

<meta name="twitter:image" content="https://www.cybereason.com/hubfs/BLOG%20%20SOCIAL%20SET%20-%20News%20%281%29-1.png">


<meta property="og:url" content="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@cr_nocturnus">

<link rel="canonical" href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hub/7052064/hub_generated/template_assets/1729622897632/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470223313/1696396395659/__CR_Web_Platform/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470477360/1710134689941/__CR_Web_Platform/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35275979682/1642096258129/__CR_Web_Platform/CSS/ionicons.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42760289143/1724041950600/__CR_Web_Platform/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470224480/1635957556830/__CR_Web_Platform/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35291999472/1696396871390/__CR_Web_Platform/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42363645447/1635957556555/__CR_Web_Platform/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507091846/1635957557027/__CR_Web_Platform/CSS/animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column:nth-of-type(2) img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-56540216169 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/BLOG%20%20SOCIAL%20SET%20-%20News%20%281%29-1.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Nocturnus</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>In July 2021, the Cybereason Nocturnus and Incident Response Teams responded to <em>Operation GhostShell</em>, a highly-targeted cyber espionage campaign targeting the Aerospace and Telecommunications industries mainly in the Middle East, with additional victims in the U.S., Russia and Europe.&nbsp;</p>
<!--more-->
<p>The Operation GhostShell campaign aims to steal sensitive information about critical assets, organizations’ infrastructure and technology. During the investigation, the Nocturnus Team uncovered a previously undocumented and stealthy RAT (Remote Access Trojan) dubbed <em>ShellClient</em> which was employed as the primary espionage tool.&nbsp;</p>
<p>The Nocturnus Team found evidence that the ShellClient RAT has been under ongoing development since at least 2018, with several iterations that introduced new functionalities, while it evaded antivirus tools and managed to remain undetected and publicly unknown.</p>
<p>Assessments as to the identity of the operators and authors of ShellClient resulted in the identification of a new Iranian threat actor dubbed <em>MalKamak </em>that has operated since at least 2018 and remained publicly unknown thus far. In addition, our research points out possible connections to other Iranian state-sponsored APT threat actors such as Chafer APT (APT39) and Agrius APT. However, we assess that MalKamak has distinct features that separate it from the other Iranian groups.&nbsp;</p>
<h2 style="font-size: 24px; font-weight: bold;">Key Findings</h2>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>New Iranian Threat Actor MalKamak: </strong>A newly discovered Iranian threat actor dubbed <em>MalKamak</em> that has been operating since at least 2018 and remained unknown thus far. In addition, the investigation draws possible connections to other Iranian state-sponsored threat actors including Chafer APT (APT39) and Agrius APT.</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>Discovery of New ShellClient RAT: </strong>The Cybereason Nocturnus team discovered a sophisticated and previously undocumented RAT (Remote Access Trojan) dubbed <em>ShellClient</em> used for highly targeted cyber espionage operations.</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>Targeting Aerospace and Telecom Companies: </strong>Based on the telemetry, this threat has been predominantly observed in the Middle East region, but has also been observed targeting organizations in the U.S., Russia and Europe, with a focus on the Aerospace and Telecommunications industries.&nbsp;</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>Ongoing Development Since 2018: </strong>Our investigation revealed this threat was first operationalized in 2018, and since then has been under active development with each new version adding more features and stealth. This threat is still active as of September 2021.&nbsp;</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>Abusing Cloud Services for C2:</strong> The most recent ShellClient versions were observed to be abusing cloud-based storage services for Command and Control (C2), in this case the popular Dropbox service, in order to remain undetected by blending in with legitimate network traffic.</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>Designed for Stealth: </strong>The authors of ShellClient invested a lot of effort into making it stealthy to evade detection by antivirus and other security tools by leveraging multiple obfuscation techniques and recently implementing a Dropbox client for command and control (C2), making it very hard to detect.&nbsp;</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 style="text-align: left; font-size: 24px; font-weight: bold;">ShellClient: The Silent RAT</h2>
<p>The following sections recap the recently observed Operation GhostShell campaign and the evolution of this stealthy ShellClient RAT, which has been operationalized and actively developed since at least November 2018.</p>
<h3 style="font-size: 24px;">Recent Campaign</h3>
<p>In July 2021, Cybereason encountered an unidentified threat actor carrying out a cyber espionage operation using a previously undocumented and stealthy RAT dubbed <em>ShellClient</em>.&nbsp;</p>
<p>Using this RAT, the threat actors were first observed conducting reconnaissance and the exfiltration of sensitive data from leading Aerospace and Telecommunications companies in the Middle East region, and was later observed targeting the same industries in other regions including the U.S, Russia and Europe.</p>
<p>When first inspecting the ShellClient RAT, the malicious binary was found to be running on victim machines as “svchost.exe” while its internal name was disguised as “RuntimeBroker.exe”:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image35-3.png?width=609&amp;name=image35-3.png" alt="image35-3" width="609" loading="lazy" style="width: 609px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image35-3.png?width=305&amp;name=image35-3.png 305w, https://www.cybereason.com/hs-fs/hubfs/image35-3.png?width=609&amp;name=image35-3.png 609w, https://www.cybereason.com/hs-fs/hubfs/image35-3.png?width=914&amp;name=image35-3.png 914w, https://www.cybereason.com/hs-fs/hubfs/image35-3.png?width=1218&amp;name=image35-3.png 1218w, https://www.cybereason.com/hs-fs/hubfs/image35-3.png?width=1523&amp;name=image35-3.png 1523w, https://www.cybereason.com/hs-fs/hubfs/image35-3.png?width=1827&amp;name=image35-3.png 1827w" sizes="(max-width: 609px) 100vw, 609px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient RAT internal name masquerades as a legitimate Microsoft RuntimeBroker.exe binary</em></span></p>
<p>This executable was determined to have been compiled on May 22nd, 2021, and was observed to be executing adjacent to additional TTPs.&nbsp;</p>
<h3 style="font-size: 24px;"><span style="color: #666666;">ShellClient Structure and Configuration</span></h3>
<p>The ShellClient RAT is a modular PE leveraging <a href="https://github.com/Fody/Costura" rel="noopener" target="_blank" style="font-style: italic;">Costura</a>&nbsp;to compress each of the modules using <a href="https://docs.python.org/3/library/zlib.html#zlib.compressobj" rel="noopener" target="_blank"><em><span>zlib:</span></em></a></p>
<p><em><img src="https://www.cybereason.com/hs-fs/hubfs/image5-Oct-01-2021-06-01-05-16-PM.png?width=676&amp;name=image5-Oct-01-2021-06-01-05-16-PM.png" alt="image5-Oct-01-2021-06-01-05-16-PM" width="676" loading="lazy" style="width: 676px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image5-Oct-01-2021-06-01-05-16-PM.png?width=338&amp;name=image5-Oct-01-2021-06-01-05-16-PM.png 338w, https://www.cybereason.com/hs-fs/hubfs/image5-Oct-01-2021-06-01-05-16-PM.png?width=676&amp;name=image5-Oct-01-2021-06-01-05-16-PM.png 676w, https://www.cybereason.com/hs-fs/hubfs/image5-Oct-01-2021-06-01-05-16-PM.png?width=1014&amp;name=image5-Oct-01-2021-06-01-05-16-PM.png 1014w, https://www.cybereason.com/hs-fs/hubfs/image5-Oct-01-2021-06-01-05-16-PM.png?width=1352&amp;name=image5-Oct-01-2021-06-01-05-16-PM.png 1352w, https://www.cybereason.com/hs-fs/hubfs/image5-Oct-01-2021-06-01-05-16-PM.png?width=1690&amp;name=image5-Oct-01-2021-06-01-05-16-PM.png 1690w, https://www.cybereason.com/hs-fs/hubfs/image5-Oct-01-2021-06-01-05-16-PM.png?width=2028&amp;name=image5-Oct-01-2021-06-01-05-16-PM.png 2028w" sizes="(max-width: 676px) 100vw, 676px"></em></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient RAT utilizing Costura</em></span></p>
<p>Two of the references are DLLs containing supporting functionalities:&nbsp;</p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>ExtensionLib.dll</strong> contains utilities and functionalities such as:</span>
<ul style="font-size: 18px;">
<li aria-level="2">AES Encryption, including an AES Key and an Initialization Vector (IV)</li>
<li aria-level="2">Hashing</li>
<li aria-level="2">File Operations</li>
<li aria-level="2">Registry Operations</li>
<li aria-level="2">Process Creation</li>
<li aria-level="2">Serialization</li>
</ul>
</li>
</ul>
</li>
</ul>
<p style="text-align: center; padding-left: 40px;"><img src="https://www.cybereason.com/hs-fs/hubfs/image28-3.png?width=404&amp;name=image28-3.png" alt="image28-3" width="404" loading="lazy" style="width: 404px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image28-3.png?width=202&amp;name=image28-3.png 202w, https://www.cybereason.com/hs-fs/hubfs/image28-3.png?width=404&amp;name=image28-3.png 404w, https://www.cybereason.com/hs-fs/hubfs/image28-3.png?width=606&amp;name=image28-3.png 606w, https://www.cybereason.com/hs-fs/hubfs/image28-3.png?width=808&amp;name=image28-3.png 808w, https://www.cybereason.com/hs-fs/hubfs/image28-3.png?width=1010&amp;name=image28-3.png 1010w, https://www.cybereason.com/hs-fs/hubfs/image28-3.png?width=1212&amp;name=image28-3.png 1212w" sizes="(max-width: 404px) 100vw, 404px"></p>
<p style="text-align: center; padding-left: 40px;"><span style="font-size: 16px;"><em>ExtensionLib.dll</em></span></p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>ClientCore.dll</strong> holds other core functionalities of the the client such as:</span>
<ul style="font-size: 18px;">
<li aria-level="2">Fingerprinting</li>
<li aria-level="2">File Operations</li>
<li aria-level="2">User Impersonation</li>
<li aria-level="2">Token Handling</li>
<li aria-level="2">FTP Client</li>
<li aria-level="2">Telnet Client</li>
<li aria-level="2">Settings &amp; Strings</li>
</ul>
</li>
</ul>
</li>
</ul>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image25-3.png?width=380&amp;name=image25-3.png" alt="image25-3" width="380" loading="lazy" style="width: 380px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image25-3.png?width=190&amp;name=image25-3.png 190w, https://www.cybereason.com/hs-fs/hubfs/image25-3.png?width=380&amp;name=image25-3.png 380w, https://www.cybereason.com/hs-fs/hubfs/image25-3.png?width=570&amp;name=image25-3.png 570w, https://www.cybereason.com/hs-fs/hubfs/image25-3.png?width=760&amp;name=image25-3.png 760w, https://www.cybereason.com/hs-fs/hubfs/image25-3.png?width=950&amp;name=image25-3.png 950w, https://www.cybereason.com/hs-fs/hubfs/image25-3.png?width=1140&amp;name=image25-3.png 1140w" sizes="(max-width: 380px) 100vw, 380px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ClientCore.dll</em></span></p>
<p>The executable stores most of the its strings, including configuration strings, as bytes and then converts them in real-time to Unicode/ASCII to evade antivirus strings detection:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image7-Oct-01-2021-06-06-36-68-PM.png?width=870&amp;name=image7-Oct-01-2021-06-06-36-68-PM.png" alt="image7-Oct-01-2021-06-06-36-68-PM" width="870" loading="lazy" style="width: 870px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image7-Oct-01-2021-06-06-36-68-PM.png?width=435&amp;name=image7-Oct-01-2021-06-06-36-68-PM.png 435w, https://www.cybereason.com/hs-fs/hubfs/image7-Oct-01-2021-06-06-36-68-PM.png?width=870&amp;name=image7-Oct-01-2021-06-06-36-68-PM.png 870w, https://www.cybereason.com/hs-fs/hubfs/image7-Oct-01-2021-06-06-36-68-PM.png?width=1305&amp;name=image7-Oct-01-2021-06-06-36-68-PM.png 1305w, https://www.cybereason.com/hs-fs/hubfs/image7-Oct-01-2021-06-06-36-68-PM.png?width=1740&amp;name=image7-Oct-01-2021-06-06-36-68-PM.png 1740w, https://www.cybereason.com/hs-fs/hubfs/image7-Oct-01-2021-06-06-36-68-PM.png?width=2175&amp;name=image7-Oct-01-2021-06-06-36-68-PM.png 2175w, https://www.cybereason.com/hs-fs/hubfs/image7-Oct-01-2021-06-06-36-68-PM.png?width=2610&amp;name=image7-Oct-01-2021-06-06-36-68-PM.png 2610w" sizes="(max-width: 870px) 100vw, 870px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient using Unicode/ASCII to evade antivirus strings detection</em></span></p>
<h3 style="font-size: 24px;"><span style="color: #666666;">Execution Flow</span></h3>
<p>The ShellClient RAT executes according to the following arguments:</p>
<ul>
<ul style="font-size: 18px;">
<li aria-level="1">If <strong>no arguments</strong> are provided, the binary executes itself using <em>InstallUtil.exe</em> to install and run a malicious <em>nhdService</em> service</li>
<li aria-level="1">If there is <strong>one argument and it is equal to </strong><strong><em>-c</em></strong>, the binary will be executed using the <em>Service Control Manager (SCM)</em> to create a reverse shell, communicating with a configured Dropbox storage as a C2</li>
</ul>
</ul>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">If there is <strong>one argument and it is equal to </strong><strong><em>-d</em></strong>, the binary will execute as a regular process</li>
</ul>
</li>
</ul>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image16-Oct-01-2021-06-08-59-58-PM.png?width=514&amp;name=image16-Oct-01-2021-06-08-59-58-PM.png" alt="image16-Oct-01-2021-06-08-59-58-PM" width="514" loading="lazy" style="width: 514px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image16-Oct-01-2021-06-08-59-58-PM.png?width=257&amp;name=image16-Oct-01-2021-06-08-59-58-PM.png 257w, https://www.cybereason.com/hs-fs/hubfs/image16-Oct-01-2021-06-08-59-58-PM.png?width=514&amp;name=image16-Oct-01-2021-06-08-59-58-PM.png 514w, https://www.cybereason.com/hs-fs/hubfs/image16-Oct-01-2021-06-08-59-58-PM.png?width=771&amp;name=image16-Oct-01-2021-06-08-59-58-PM.png 771w, https://www.cybereason.com/hs-fs/hubfs/image16-Oct-01-2021-06-08-59-58-PM.png?width=1028&amp;name=image16-Oct-01-2021-06-08-59-58-PM.png 1028w, https://www.cybereason.com/hs-fs/hubfs/image16-Oct-01-2021-06-08-59-58-PM.png?width=1285&amp;name=image16-Oct-01-2021-06-08-59-58-PM.png 1285w, https://www.cybereason.com/hs-fs/hubfs/image16-Oct-01-2021-06-08-59-58-PM.png?width=1542&amp;name=image16-Oct-01-2021-06-08-59-58-PM.png 1542w" sizes="(max-width: 514px) 100vw, 514px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient RAT arguments</em></span></p>
<p>When either of the <strong><em>-c</em></strong> or <strong><em>-d</em></strong> arguments are provided, the malware performs basic fingerprinting using <em>WMI </em>to collect:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">Hardware information such as BIOS information, Mac address, etc.</li>
<li aria-level="1">Networking Information including a request to <em>ipinfo[.]io/ip</em> to retrieve the public IP address of the infected machine</li>
<li aria-level="1">Which antivirus products are installed&nbsp;</li>
</ul>
</li>
</ul>
<p>The abovementioned collected information is also used to create a unique agent identifier for each infected machine:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image30-2.png?width=1143&amp;name=image30-2.png" alt="image30-2" width="1143" loading="lazy" style="width: 1143px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image30-2.png?width=572&amp;name=image30-2.png 572w, https://www.cybereason.com/hs-fs/hubfs/image30-2.png?width=1143&amp;name=image30-2.png 1143w, https://www.cybereason.com/hs-fs/hubfs/image30-2.png?width=1715&amp;name=image30-2.png 1715w, https://www.cybereason.com/hs-fs/hubfs/image30-2.png?width=2286&amp;name=image30-2.png 2286w, https://www.cybereason.com/hs-fs/hubfs/image30-2.png?width=2858&amp;name=image30-2.png 2858w, https://www.cybereason.com/hs-fs/hubfs/image30-2.png?width=3429&amp;name=image30-2.png 3429w" sizes="(max-width: 1143px) 100vw, 1143px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Creating a unique identifier</em></span></p>
<h3 style="font-size: 24px;"><span style="color: #666666;">Command and Control (C2) Communications</span></h3>
<p>The C2 communications this malware implements are quite unique, as they rely on “cold files” being saved to a remote Dropbox, instead of a common interactive session. This method of communication is an interesting Operational Security (OPSEC) solution, making it difficult to trace the threat actor’s infrastructure by utilizing a public service such as Dropbox.</p>
<p>To communicate with Dropbox, ShellClient uses Dropbox’s API with a unique embedded API key. Before communicating, it encrypts the data using an hardcoded AES encryption key.</p>
<p>The Dropbox storage contains 3 folders:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1"><strong>AS Folder </strong>(Agents Folder): Stores uploaded information on infected machines</li>
<li aria-level="1"><strong>CS Folder</strong> (Commands Folder): Stores commands to be fetched, executed and then deleted by ShellClient</li>
<li aria-level="1"><strong>RS Folder</strong> (Results Folder): Stores the output of commands executed by ShellClient</li>
</ul>
</li>
</ul>
<p>Every 2 seconds, the victim machine checks the commands folder, retrieves files that represent commands, parses their content, then deletes them from the remote folder and enables them for execution:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image27-4.png?width=812&amp;name=image27-4.png" alt="image27-4" width="812" loading="lazy" style="width: 812px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image27-4.png?width=406&amp;name=image27-4.png 406w, https://www.cybereason.com/hs-fs/hubfs/image27-4.png?width=812&amp;name=image27-4.png 812w, https://www.cybereason.com/hs-fs/hubfs/image27-4.png?width=1218&amp;name=image27-4.png 1218w, https://www.cybereason.com/hs-fs/hubfs/image27-4.png?width=1624&amp;name=image27-4.png 1624w, https://www.cybereason.com/hs-fs/hubfs/image27-4.png?width=2030&amp;name=image27-4.png 2030w, https://www.cybereason.com/hs-fs/hubfs/image27-4.png?width=2436&amp;name=image27-4.png 2436w" sizes="(max-width: 812px) 100vw, 812px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient C2 Communications</em></span></p>
<p>After executing the commands, the executable uploads the results to the corresponding folder with a randomly generated file name based on the unique victim ID that the threat actor calls as <em>HardwareID</em>:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image24-Oct-01-2021-06-15-02-76-PM.png?width=1057&amp;name=image24-Oct-01-2021-06-15-02-76-PM.png" alt="image24-Oct-01-2021-06-15-02-76-PM" width="1057" loading="lazy" style="width: 1057px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image24-Oct-01-2021-06-15-02-76-PM.png?width=529&amp;name=image24-Oct-01-2021-06-15-02-76-PM.png 529w, https://www.cybereason.com/hs-fs/hubfs/image24-Oct-01-2021-06-15-02-76-PM.png?width=1057&amp;name=image24-Oct-01-2021-06-15-02-76-PM.png 1057w, https://www.cybereason.com/hs-fs/hubfs/image24-Oct-01-2021-06-15-02-76-PM.png?width=1586&amp;name=image24-Oct-01-2021-06-15-02-76-PM.png 1586w, https://www.cybereason.com/hs-fs/hubfs/image24-Oct-01-2021-06-15-02-76-PM.png?width=2114&amp;name=image24-Oct-01-2021-06-15-02-76-PM.png 2114w, https://www.cybereason.com/hs-fs/hubfs/image24-Oct-01-2021-06-15-02-76-PM.png?width=2643&amp;name=image24-Oct-01-2021-06-15-02-76-PM.png 2643w, https://www.cybereason.com/hs-fs/hubfs/image24-Oct-01-2021-06-15-02-76-PM.png?width=3171&amp;name=image24-Oct-01-2021-06-15-02-76-PM.png 3171w" sizes="(max-width: 1057px) 100vw, 1057px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient C2 Communications</em></span></p>
<p>The destinations for these communications will be <em>api.dropboxdapi[.]com</em> and <em>content.dropboxapi[.]com</em>.</p>
<h3 style="font-size: 24px;"><span style="color: #666666;">Persistence and Privilege Escalation</span></h3>
<p>The ShellClient RAT achieves persistence and privilege escalation to run with SYSTEM privileges on victim machines by creating the <em>nhdService</em> disguised as <em>Network Hosts Detection Service</em>:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1"><strong>Service Name</strong>: nhdService</li>
<li aria-level="1"><strong>Display Name</strong>: Network Hosts Detection Service</li>
<li aria-level="1"><strong>Description: </strong>Searches and manages hosts in the Network and Dial-Up Connections folder, where both local area network and remote connections are viewable</li>
<li aria-level="1"><strong>Start Type</strong>: Automatic</li>
<li aria-level="1"><strong>Account: </strong>LocalSystem</li>
</ul>
</li>
</ul>
<p style="font-size: 24px;">&nbsp;</p>
<h3 style="font-size: 24px;"><span style="color: #666666;">Supported Commands</span></h3>
<p>The executable contains multiple command functions that enable its capabilities, including arbitrary command execution, FTP/Telnet clients, lateral movement, file manipulation, etc.&nbsp;</p>
<p>In addition, the malware contains several command functions that seem to do nothing and have no reference in the code; this could indicate that the malware is still under development.</p>
<p>The following table describes the purpose of each command:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; height: 1062.15px; width: 1059px;">
<tbody>
<tr style="height: 76.9965px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 77px; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="text-decoration: underline;">Command</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 77px; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="text-decoration: underline;">Description</span></strong></span></p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code10</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Query hostname, malware version, executable path, IP address and Antivirus products&nbsp;</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code11</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Execute an updated version of ShellClient</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code12</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Self delete using InstallUtil.exe</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code13</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Restart the ShellClient service</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code20</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Start a CMD shell</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code21</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Start a PowerShell shell</p>
</td>
</tr>
<tr style="height: 50.9896px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 51px;">
<p>code22</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 51px;">
<p>Add to the results message the following line: “Microsoft Windows Command Prompt Alternative Started …”</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code23</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Open a TCP Client</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code24</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Start a FTP client</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code25</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Start a Telnet client</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>Code26</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Execute a shell command</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code29</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Kill active CMD or PowerShell shell</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code31</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Query files and directories</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code32</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Create a Directory</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code33</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Delete files and folders</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code34</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Download a file to the infected machine</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code35</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Upload a File to Dropbox</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code36</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Does nothing</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code37</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Download a file to the infected machine and execute it</p>
</td>
</tr>
<tr style="height: 49.0972px;">
<td style="border: 1pt solid #000000; width: 122.969px; height: 49px;">
<p>code38</p>
</td>
<td style="border: 1pt solid #000000; width: 935.99px; height: 49px;">
<p>Lateral movement using WMI</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 8px; line-height: 1;">&nbsp;</p>
<p style="text-align: center; font-size: 16px;"><em>ShellClient C2 Commands</em></p>
<h3 style="font-size: 24px;"><span style="color: #434343;">Additional TTPs Observed with ShellClient</span></h3>
<p>Using the ShellClient RAT, the threat actor deployed additional tools to perform various activities to support their operation such as reconnaissance, lateral movement, data collection and more.</p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Lateral Movement</span><span style="color: #666666;"></span></h4>
<p>The attackers were observed using <a href="https://www.poweradmin.com/paexec/" rel="noopener" target="_blank"><span>PAExec</span></a> and “<a href="https://attack.mitre.org/software/S0039/"><span>net</span></a> use” for lateral movement. PAExec is a redistributable version of the famous Sysinternals <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" rel="noopener" target="_blank"><span>PsExec</span></a>, with some additional options.&nbsp;</p>
<p>The attackers leveraged PAExec to:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1"><strong>Execute a CMD shell as SYSTEM </strong>on remote machines</li>
<li aria-level="1"><strong>Perform remote service related operations</strong> like start, stop, restart, status and more</li>
<li aria-level="1"><strong>Exfiltrate organizational Active Directory structure</strong> using a remotely executed <em>csvde.exe -f &lt; output file &gt;</em> command</li>
<li aria-level="1"><strong>Check internet connectivity</strong> using <a href="https://attack.mitre.org/software/S0097/" rel="noopener" target="_blank"><span>ping</span></a> to reach Google.com</li>
<li aria-level="1"><strong>Gather host information</strong> by executing <a href="https://attack.mitre.org/software/S0100/" rel="noopener" target="_blank"><span>ipconfig</span></a>, <a href="https://attack.mitre.org/software/S0057/" rel="noopener" target="_blank"><span>tasklist</span></a> and net use</li>
</ul>
</li>
</ul>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image21-Oct-01-2021-06-16-43-67-PM.png?width=758&amp;name=image21-Oct-01-2021-06-16-43-67-PM.png" alt="image21-Oct-01-2021-06-16-43-67-PM" width="758" loading="lazy" style="width: 758px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image21-Oct-01-2021-06-16-43-67-PM.png?width=379&amp;name=image21-Oct-01-2021-06-16-43-67-PM.png 379w, https://www.cybereason.com/hs-fs/hubfs/image21-Oct-01-2021-06-16-43-67-PM.png?width=758&amp;name=image21-Oct-01-2021-06-16-43-67-PM.png 758w, https://www.cybereason.com/hs-fs/hubfs/image21-Oct-01-2021-06-16-43-67-PM.png?width=1137&amp;name=image21-Oct-01-2021-06-16-43-67-PM.png 1137w, https://www.cybereason.com/hs-fs/hubfs/image21-Oct-01-2021-06-16-43-67-PM.png?width=1516&amp;name=image21-Oct-01-2021-06-16-43-67-PM.png 1516w, https://www.cybereason.com/hs-fs/hubfs/image21-Oct-01-2021-06-16-43-67-PM.png?width=1895&amp;name=image21-Oct-01-2021-06-16-43-67-PM.png 1895w, https://www.cybereason.com/hs-fs/hubfs/image21-Oct-01-2021-06-16-43-67-PM.png?width=2274&amp;name=image21-Oct-01-2021-06-16-43-67-PM.png 2274w" sizes="(max-width: 758px) 100vw, 758px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient leveraging PAExec as observed in the Cybereason Defense Platform</em></span></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Credential Dumping Tool</span></h4>
<p>During the observed attacks, the ShellClient RAT activity group deployed and executed an unknown executable named <em>lsa.exe</em> to perform credential dumping. <em>Lsa.exe</em> dumped the memory of <em>lsass.exe</em> to a file named <em>debug.bin</em> and was observed executing with the following command-line arguments:</p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1">
<p><span style="font-size: 18px;">lsa.exe -d&nbsp;</span></p>
</li>
<li aria-level="1">
<p><span style="font-size: 18px;"></span><span style="font-size: 18px;">lsa.exe -m</span></p>
</li>
</ul>
</li>
</ul>
<p>Although the Cybereason Nocturnus team was unable to retrieve the <em>lsa.exe</em> executable, we speculate the tool might be a variation of the tool <a href="https://github.com/GhostPack/SafetyKatz" rel="noopener" target="_blank"><span>SafetyKatz</span></a> based on the <em>debug.bin</em> dump file the tool creates, which is also the name of the dump file created by SafetyKatz that was previously tied to Iranian threat actors:</p>
<p style="text-align: center;"><span style="color: #1d1c1d;"><img src="https://www.cybereason.com/hs-fs/hubfs/image13-Oct-01-2021-06-18-15-23-PM.png?width=769&amp;name=image13-Oct-01-2021-06-18-15-23-PM.png" alt="image13-Oct-01-2021-06-18-15-23-PM" width="769" loading="lazy" style="width: 769px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image13-Oct-01-2021-06-18-15-23-PM.png?width=385&amp;name=image13-Oct-01-2021-06-18-15-23-PM.png 385w, https://www.cybereason.com/hs-fs/hubfs/image13-Oct-01-2021-06-18-15-23-PM.png?width=769&amp;name=image13-Oct-01-2021-06-18-15-23-PM.png 769w, https://www.cybereason.com/hs-fs/hubfs/image13-Oct-01-2021-06-18-15-23-PM.png?width=1154&amp;name=image13-Oct-01-2021-06-18-15-23-PM.png 1154w, https://www.cybereason.com/hs-fs/hubfs/image13-Oct-01-2021-06-18-15-23-PM.png?width=1538&amp;name=image13-Oct-01-2021-06-18-15-23-PM.png 1538w, https://www.cybereason.com/hs-fs/hubfs/image13-Oct-01-2021-06-18-15-23-PM.png?width=1923&amp;name=image13-Oct-01-2021-06-18-15-23-PM.png 1923w, https://www.cybereason.com/hs-fs/hubfs/image13-Oct-01-2021-06-18-15-23-PM.png?width=2307&amp;name=image13-Oct-01-2021-06-18-15-23-PM.png 2307w" sizes="(max-width: 769px) 100vw, 769px"></span></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em><span style="color: #1d1c1d;">ShellClient credential dumping as observed in the Cybereason Defense Platform</span></em></span></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Staging</span></h4>
<p>In order to exfiltrate data, the attackers used WinRar to compress important files before data exfiltration using a renamed <em>rar.exe</em> WinRar file:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image1-3.png?width=769&amp;name=image1-3.png" alt="image1-3" width="769" loading="lazy" style="width: 769px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image1-3.png?width=385&amp;name=image1-3.png 385w, https://www.cybereason.com/hs-fs/hubfs/image1-3.png?width=769&amp;name=image1-3.png 769w, https://www.cybereason.com/hs-fs/hubfs/image1-3.png?width=1154&amp;name=image1-3.png 1154w, https://www.cybereason.com/hs-fs/hubfs/image1-3.png?width=1538&amp;name=image1-3.png 1538w, https://www.cybereason.com/hs-fs/hubfs/image1-3.png?width=1923&amp;name=image1-3.png 1923w, https://www.cybereason.com/hs-fs/hubfs/image1-3.png?width=2307&amp;name=image1-3.png 2307w" sizes="(max-width: 769px) 100vw, 769px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>ShellClient using WinRar to compress data before exfiltration</em></span></p>
<h2 style="font-size: 24px; font-weight: bold;">The Evolution of ShellClient and Finding the Missing Link</h2>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image22-Oct-01-2021-06-20-27-51-PM.png?width=821&amp;name=image22-Oct-01-2021-06-20-27-51-PM.png" alt="image22-Oct-01-2021-06-20-27-51-PM" width="821" loading="lazy" style="width: 821px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image22-Oct-01-2021-06-20-27-51-PM.png?width=411&amp;name=image22-Oct-01-2021-06-20-27-51-PM.png 411w, https://www.cybereason.com/hs-fs/hubfs/image22-Oct-01-2021-06-20-27-51-PM.png?width=821&amp;name=image22-Oct-01-2021-06-20-27-51-PM.png 821w, https://www.cybereason.com/hs-fs/hubfs/image22-Oct-01-2021-06-20-27-51-PM.png?width=1232&amp;name=image22-Oct-01-2021-06-20-27-51-PM.png 1232w, https://www.cybereason.com/hs-fs/hubfs/image22-Oct-01-2021-06-20-27-51-PM.png?width=1642&amp;name=image22-Oct-01-2021-06-20-27-51-PM.png 1642w, https://www.cybereason.com/hs-fs/hubfs/image22-Oct-01-2021-06-20-27-51-PM.png?width=2053&amp;name=image22-Oct-01-2021-06-20-27-51-PM.png 2053w, https://www.cybereason.com/hs-fs/hubfs/image22-Oct-01-2021-06-20-27-51-PM.png?width=2463&amp;name=image22-Oct-01-2021-06-20-27-51-PM.png 2463w" sizes="(max-width: 821px) 100vw, 821px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Known ShellClient RAT version history timeline</em></span></p>
<p>One of the questions that came up during the investigations was regarding how far back the use of the malware can be observed. At first it was thought to have been developed recently since there was no publicly available documentation or any mention of it available. However, the code indicates that the sample we analyzed was version 4.0, which implies there should be several previous versions.</p>
<p>With that in mind, the investigation revealed the missing link in a <em>.NET GUID</em> that appeared in the metadata of the observed sample. Pivoting on this unique identifier, we were able to uncover an older instance (version 3.1, <a href="https://www.virustotal.com/gui/file/a541afa0e73c3942b8c3645a3ba1ea59c4d6e1110e271be34fdb6a8c02a299e2" rel="noopener" target="_blank"><span>VT link</span></a>) that used the same .NET TypeLibID GUID, a unique ID generated by Visual Studio per project - <span style="font-style: italic;">fd01304b-571f-4454-b52b-19cfb8af44a9:</span></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image19-Oct-01-2021-06-21-29-63-PM.png?width=771&amp;name=image19-Oct-01-2021-06-21-29-63-PM.png" alt="image19-Oct-01-2021-06-21-29-63-PM" width="771" loading="lazy" style="width: 771px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image19-Oct-01-2021-06-21-29-63-PM.png?width=386&amp;name=image19-Oct-01-2021-06-21-29-63-PM.png 386w, https://www.cybereason.com/hs-fs/hubfs/image19-Oct-01-2021-06-21-29-63-PM.png?width=771&amp;name=image19-Oct-01-2021-06-21-29-63-PM.png 771w, https://www.cybereason.com/hs-fs/hubfs/image19-Oct-01-2021-06-21-29-63-PM.png?width=1157&amp;name=image19-Oct-01-2021-06-21-29-63-PM.png 1157w, https://www.cybereason.com/hs-fs/hubfs/image19-Oct-01-2021-06-21-29-63-PM.png?width=1542&amp;name=image19-Oct-01-2021-06-21-29-63-PM.png 1542w, https://www.cybereason.com/hs-fs/hubfs/image19-Oct-01-2021-06-21-29-63-PM.png?width=1928&amp;name=image19-Oct-01-2021-06-21-29-63-PM.png 1928w, https://www.cybereason.com/hs-fs/hubfs/image19-Oct-01-2021-06-21-29-63-PM.png?width=2313&amp;name=image19-Oct-01-2021-06-21-29-63-PM.png 2313w" sizes="(max-width: 771px) 100vw, 771px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Shared .NET TypeLib Id GUID between the recent and the older version of ShellClient</em></span></p>
<p>From there, finding the other previous versions of ShellClient was achieved by pivoting searching for string and code similarities. This pivoting process proved that ShellClient has been under continuous development since at least November of 2018, marking almost three years of development work to evolve the malware from a simple standalone reverse shell to a stealthy modular espionage tool.&nbsp;</p>
<p>In each new iteration of the malware, the authors added new features and capabilities, attempting to use various exfiltration protocols and methods, such as using an FTP client and a Dropbox account to hide in plain site. In addition, from version 4.0.0 and up, the authors made significant design and architecture changes like introducing modular design.&nbsp;</p>
<p>Below is a summary of the variants that were discovered so far:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; height: 733.316px; width: 1036px;">
<tbody>
<tr style="height: 105px;">
<td style="border: 0.99609pt solid #000000; height: 105px; width: 80.1042px; vertical-align: middle;">
<p><strong><span style="text-decoration: underline;">VT Link</span></strong></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 105.139px; vertical-align: middle;">
<p><strong><span style="text-decoration: underline;">Variant Version</span></strong></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 145.226px; vertical-align: middle;">
<p><strong><span style="text-decoration: underline;">Name</span></strong></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 165.226px; vertical-align: middle;">
<p><strong><span style="text-decoration: underline;">Compilation Date</span></strong></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 135.191px; vertical-align: middle;">
<p><strong><span style="text-decoration: underline;">First Submission Date</span></strong></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 403.785px; vertical-align: middle;">
<p><strong><span style="text-decoration: underline;">PDB Path&nbsp;</span></strong></p>
</td>
</tr>
<tr style="height: 101.997px;">
<td style="border: 0.99609pt solid #000000; height: 102px; width: 80.1042px;">
<p><a href="https://www.virustotal.com/gui/file/21cc9c0ae5f97b66d69f1ff99a4fed264551edfe0a5ce8d5449942bf8f0aefb2" rel="noopener" target="_blank"><span>VT link</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 102px; width: 105.139px;">
<p>Earliest</p>
<p>variant</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 102px; width: 145.226px;">
<p>svchost.exe</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 102px; width: 165.226px;">
<p>2018-11-06 21:35:41</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 102px; width: 135.191px;">
<p>2018-11-11 15:28:46</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 102px; width: 403.785px;"><br><br></td>
</tr>
<tr style="height: 105px;">
<td style="border: 0.99609pt solid #000000; height: 105px; width: 80.1042px;">
<p><a href="https://www.virustotal.com/gui/file/5d5ff74906d2666be0fbfe420c5d225684aa1cb516fffc32cfeee9e788e4b6e4" rel="noopener" target="_blank"><span>VT link</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 105.139px;">
<p>1</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 145.226px;">
<p>svchost.exe</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 165.226px;">
<p>2018-11-29 23:41:15</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 135.191px;">
<p>2020-04-15 23:22:13</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 403.785px;">
<p>D:\projects\07 - Reverse Shell\ShellClientServer_HTTP\obj\Release\svchost.pdb</p>
</td>
</tr>
<tr style="height: 105px;">
<td style="border: 0.99609pt solid #000000; height: 105px; width: 80.1042px;">
<p><a href="https://www.virustotal.com/gui/file/186ab2a5662c5e3994ee1cbfcf9e7842f1e41b1a4041c67f808914dfc8850706" rel="noopener" target="_blank"><span>VT link</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 105.139px;">
<p>2.1</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 145.226px;">
<p>svchost.exe</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 165.226px;">
<p>2018-12-16 11:19:14</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 135.191px;">
<p>2020-04-14 22:59:49</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 403.785px;">
<p>E:\Projects (Confidential)\07 - Reverse Shell\ShellClientServer_HTTP.v2\obj\Release\svchost.pdb</p>
</td>
</tr>
<tr style="height: 105px;">
<td style="border: 0.99609pt solid #000000; height: 105px; width: 80.1042px;">
<p><a href="https://www.virustotal.com/gui/file/a541afa0e73c3942b8c3645a3ba1ea59c4d6e1110e271be34fdb6a8c02a299e2" rel="noopener" target="_blank"><span>VT link</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 105.139px;">
<p>3.1</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 145.226px;">
<p>svchost.exe</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 165.226px;">
<p>2019-01-12 18:37:20</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 135.191px;">
<p>2019-01-17 22:53:43</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 403.785px;">
<p>D:\Visual Studio 2017\v3.1\ShellClient\obj\Release\svchost.pdb</p>
</td>
</tr>
<tr style="height: 105px;">
<td style="border: 0.99609pt solid #000000; height: 105px; width: 80.1042px;">
<p><a href="https://www.virustotal.com/gui/file/49c41771e8e348b30de43d1112221c71a6497794b541fead7f3b2eab706afba3/detection" rel="noopener" target="_blank"><span>VT link</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 105.139px;">
<p>4.0.0</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 145.226px;">
<p>RuntimeBroker.exe / svchost.exe</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 165.226px;">
<p>2021-08-10 11:14:51</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 135.191px;">
<p>2021-09-22 09:18:59</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 403.785px;"><br><br></td>
</tr>
<tr style="height: 105px;">
<td style="border: 0.99609pt solid #000000; height: 105px; width: 80.1042px;">
<p><a href="https://www.virustotal.com/gui/file/2a1044e9e6e87a032f80c6d9ea6ae61bbbb053c0a21b186ecb3b812b49eb03b7" rel="noopener" target="_blank"><span>VT link</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 105.139px;">
<p>4.0.1</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 145.226px;">
<p>RuntimeBroker.exe / svchost.exe</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 165.226px;">
<p>2021-05-22 12:06:05</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 135.191px;">
<p>2021-07-20 16:16:06</p>
</td>
<td style="border: 0.99609pt solid #000000; height: 105px; width: 403.785px;"><br><br></td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 8px; line-height: 1;">&nbsp;</p>
<p style="text-align: center; font-size: 16px;"><em>Known ShellClient RAT version history</em></p>
<h2 style="font-size: 30px;"><span style="color: #434343;">Overview of ShellClient Evolution&nbsp;</span></h2>
<h3 style="font-size: 24px;"><span style="color: #666666;">Earliest Variant (November 2018)</span></h3>
<p>The earliest variant traced was compiled on November 06, 2018, and was purposefully named <em>svchost.exe</em> to allow it to masquerade as a legitimate Windows binary. This early variant is not very rich in features and lacks the sophistication and functionality that are manifested in its successors. In essence, it is a rather simple <a href="https://www.netsparker.com/blog/web-security/understanding-reverse-shells/" rel="noopener" target="_blank"><span>reverse shell</span></a>.&nbsp;</p>
<p style="font-size: 18px; font-weight: bold;">Main Features:</p>
<ul>
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>File name: </strong>svchost.exe</span></li>
</ul>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>File description: </strong>Windows Defender Service</span></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>Core functionality:</strong> Simple websocket-based reverse shell</span></li>
<li aria-level="1"><span style="font-size: 18px;"><strong>Hardcoded C2 domain:</strong> azure.ms-tech[.]us:80</span></li>
</ul>
</li>
</ul>
<h3 style="font-size: 18px;">&nbsp;</h3>
<h3 style="font-size: 24px;"><span style="color: #666666;">Variant V1 (November 2018)</span></h3>
<p>The second oldest variant emerged about 3 weeks after the initial version. This variant is more mature and contains capabilities of both of a client and a server, including a new service persistence method disguising as a Windows Defender Update service. This version of ShellClient also communicates with the following C2 domain: <em>azure.ms-tech[.]us:80</em>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>Main Updates:</strong></span></p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1"><strong>File description: </strong>Host Process For Windows Processes</li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><strong>Core functionalities:</strong>&nbsp;
<ul style="font-size: 18px;">
<li aria-level="2">Predefined set of C2 commands</li>
<li aria-level="2">Executing arbitrary commands via CMD shell or PowerShell</li>
<li aria-level="2">Client and Server components</li>
<li aria-level="2">Persistence via Windows Service, masquerading as Windows Defender</li>
<li aria-level="2">Base64 encoding/decoding for data sent from / to C2<br><br></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 style="font-size: 24px;"><span style="color: #666666;">Version V2.1 (December 2018)</span></h3>
<p>Compiled approximately 2 weeks after variant V1, this variant keeps the same name and description attributes but shows further progress in development by adding a variety of new capabilities, including FTP and Telnet clients, AES encryption, self-update capabilities and more. This version of ShellClient also communicates with the following C2 domain: <em>azure.ms-tech[.]us:80</em>&nbsp;</p>
<p><strong>Main Changes:</strong></p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><strong>Core functionalities:</strong>&nbsp;
<ul style="font-size: 18px;">
<li aria-level="2">Implementing FTP and Telnet clients</li>
<li aria-level="2">AES encryption of data sent to the C2</li>
<li aria-level="2">Self-updating feature</li>
<li aria-level="2">Client ID and versioning attributes added</li>
<li aria-level="2">Extended set of predefined C2 commands<br><br></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 style="font-size: 24px;"><span style="color: #666666;">Variant V3.1 (January 2019)</span></h3>
<p>About a month after the emergence of variant V2.1, the V3.1 variant was seen in January of 2019. It has mostly minor changes in regards to functionality. The main difference is the removal of the “Server” component from the executable, as well as new code obfuscation and an upgraded commands menu. This version of ShellClient also communicates with the following C2 domain: <em>azure.ms-tech[.]us:80</em>&nbsp;</p>
<p><strong>Main Changes:</strong></p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><strong>Core functionality:</strong>&nbsp;
<ul>
<li aria-level="2">Removal of the Server component</li>
<li aria-level="2">Introduction of command-line arguments</li>
<li aria-level="2">First attempts of code obfuscation</li>
<li aria-level="2">More predefined C2 commands</li>
<li aria-level="2">OS fingerprinting via WMI<br><br></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 style="font-size: 24px;"><span style="color: #666666;">Variant V4.0.0 (August 2021)</span></h3>
<p>Perhaps one of the biggest advancements in the ShellClient evolution came with version V4.0.0 and continued with its successor V4.0.1, in which the malware authors implemented many changes and improvements, adding new capabilities, enhancing code obfuscation and code protection using Costura packer, as well as abandoning the C2 domain that was active since 2018.&nbsp;</p>
<p>The traditional C2 communications were replaced with a Dropbox built-in client, abusing the popular online platform to send commands to ShellClient as well as storing the stolen data exfiltrated to a designated Dropbox account. This ultimately makes it harder to detect since the network traffic would appear legitimate to security analysts as well as most security solutions.&nbsp;</p>
<p><strong><em>Note: For full analysis of the variants, please refer to Appendix A in the IOCs popup in lower right of your screen.&nbsp;</em></strong></p>
<h2 style="text-align: left; font-size: 24px; font-weight: bold;">Attribution</h2>
<p>During the investigation, efforts were made to identify instances of the ShellClient code and to determine its origin or affiliation with known threat actors. Given the fact that ShellClient was previously undocumented and unknown at the time of the investigation, and the identity of the threat actor behind the attack was unclear, the Nocturnus Team first attempted to find links to known adversary groups that have carried out similar attacks in the past against this industry and the affected regions.&nbsp;</p>
<p>While some possible connections to known Iranian threat actors were observed, our conclusion is that <em>MalKamak </em>is a new and distinct activity group, with unique characteristics that distinguish it from the other known Iranian threat actors. In publishing this data, it is hoped that more attention will be given to this threat and over time more information about ShellClient origins will emerge.&nbsp;</p>
<h3 style="font-size: 24px; font-weight: bold;">Likely Nation State-Sponsored Threat Actor</h3>
<p>The current working assumption is that ShellClient was created and maintained by a nation-state sponsored threat actor, or Advanced Persistent Threat (APT). The intrusions analyzed by Cybereason suggest that the motivation is cyber espionage against a very small set of carefully selected targets. This is supported by the fact that there are very few samples found in the telemetry or in-the-wild since 2018, in contrast to commodity malware that can usually be found in abundance.&nbsp;</p>
<p>In addition, the PDB path that is embedded in some of the ShellClient samples suggests that this malware is part of a restricted or classified project that could be related to military or intelligence agency operations:&nbsp;</p>
<p style="padding-left: 40px; font-size: 18px;"><em>E:\</em><strong><em>Projects (Confidential)</em></strong><em>\07 - Reverse Shell\ShellClientServer_HTTP.v2\obj\Release\svchost.pdb</em></p>
<h3 style="font-size: 24px;">Russian Turla Connection or a Yara False Positive?&nbsp;</h3>
<p>In examining some “low hanging fruit, ”the first clue examined was a Yara rule comment that appeared in VirusTotal along with some of the older variants of ShellClient. The Yara rule that was indicated is named <strong><em>APT_Turla_MSTCSS_Malware_Jun19_1</em></strong><em>:</em></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image23-Oct-01-2021-06-22-55-22-PM.png?width=714&amp;name=image23-Oct-01-2021-06-22-55-22-PM.png" alt="image23-Oct-01-2021-06-22-55-22-PM" width="714" loading="lazy" style="width: 714px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image23-Oct-01-2021-06-22-55-22-PM.png?width=357&amp;name=image23-Oct-01-2021-06-22-55-22-PM.png 357w, https://www.cybereason.com/hs-fs/hubfs/image23-Oct-01-2021-06-22-55-22-PM.png?width=714&amp;name=image23-Oct-01-2021-06-22-55-22-PM.png 714w, https://www.cybereason.com/hs-fs/hubfs/image23-Oct-01-2021-06-22-55-22-PM.png?width=1071&amp;name=image23-Oct-01-2021-06-22-55-22-PM.png 1071w, https://www.cybereason.com/hs-fs/hubfs/image23-Oct-01-2021-06-22-55-22-PM.png?width=1428&amp;name=image23-Oct-01-2021-06-22-55-22-PM.png 1428w, https://www.cybereason.com/hs-fs/hubfs/image23-Oct-01-2021-06-22-55-22-PM.png?width=1785&amp;name=image23-Oct-01-2021-06-22-55-22-PM.png 1785w, https://www.cybereason.com/hs-fs/hubfs/image23-Oct-01-2021-06-22-55-22-PM.png?width=2142&amp;name=image23-Oct-01-2021-06-22-55-22-PM.png 2142w" sizes="(max-width: 714px) 100vw, 714px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Yara rule comment that appeared in VirusTotal</em></span></p>
<p>The Nocturnus Team examined the possibility that the ShellClient malware might have been created by the Russian APT group Turla. However, upon careful analysis of known Turla malware, and even more specifically the ones indicated in a <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/waterbug-espionage-governments" rel="noopener" target="_blank"><span>Symantec report</span></a> referenced in the Yara rule, the team did not find any significant similarities or evidence that can tie Turla to ShellClient or the activity that was observed in the intrusion investigated.&nbsp;</p>
<h3 style="font-size: 24px;">An Iranian Connection</h3>
<p>Given that most of the victims were located in the Middle East region and considering the affected industries, the unique profile of the attacked organizations, as well as other characteristics related to the intrusion and the malware, the team also examined the possibility that an Iranian state-sponsored threat actor might be behind the Operation GhostShell intrusions.&nbsp;</p>
<p>The Nocturnus team compared our observations with previous campaigns that were attributed to known Iranian threat actors, and was able to point out some interesting similarities between ShellClient and previously reported Iranian malware and threat actors.&nbsp;</p>
<p>However, at this point, our estimation is that this operation was carried out by a separate activity group, dubbed <em>MalKamak</em>, which has its own distinct characteristics that distinguish it from the other groups.</p>
<p>Nonetheless, we believe that highlighting the possible connections between various Iranian threat actors could be beneficial. Whether such connection is a result of a direct collaboration among these threat actors is currently unknown.&nbsp;</p>
<p>These connections can also be explained in other ways, which are less direct, for example - a cyber mercenary who codes for multiple threat actors - could also be a likely explanation that can account for some of these observed overlaps.&nbsp;</p>
<h3 style="font-size: 24px;"><span style="color: #434343;">Meet MalKamak: A New Iranian Threat Actor</span></h3>
<p style="font-size: 8px;"><img src="https://www.cybereason.com/hs-fs/hubfs/image12-Oct-04-2021-03-18-44-06-PM.png?width=1570&amp;name=image12-Oct-04-2021-03-18-44-06-PM.png" alt="image12-Oct-04-2021-03-18-44-06-PM" width="1570" loading="lazy" style="width: 1570px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image12-Oct-04-2021-03-18-44-06-PM.png?width=785&amp;name=image12-Oct-04-2021-03-18-44-06-PM.png 785w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-04-2021-03-18-44-06-PM.png?width=1570&amp;name=image12-Oct-04-2021-03-18-44-06-PM.png 1570w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-04-2021-03-18-44-06-PM.png?width=2355&amp;name=image12-Oct-04-2021-03-18-44-06-PM.png 2355w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-04-2021-03-18-44-06-PM.png?width=3140&amp;name=image12-Oct-04-2021-03-18-44-06-PM.png 3140w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-04-2021-03-18-44-06-PM.png?width=3925&amp;name=image12-Oct-04-2021-03-18-44-06-PM.png 3925w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-04-2021-03-18-44-06-PM.png?width=4710&amp;name=image12-Oct-04-2021-03-18-44-06-PM.png 4710w" sizes="(max-width: 1570px) 100vw, 1570px"></p>
<p style="font-size: 16px; text-align: center;"><em>MalKamak Diamond Model Summary</em></p>
<p>Using the famous diamond model of attribution, the Nocturnus team was able to determine that the attacks were carried out by a new activity group, dubbed <em>MalKamak</em>, which was unknown thus far and believed to be operating on behalf of Iranian interests. Following is a quick summary of its main characteristics:&nbsp;</p>
<ul>
<ul style="font-size: 18px;">
<li aria-level="1"><strong>Country of Origin:</strong> Iran&nbsp;</li>
<li aria-level="1"><strong>Years of Activity: </strong>Since at least 2018</li>
<li aria-level="1"><strong>Motivation: </strong>Cyber Espionage</li>
</ul>
</ul>
<ul style="font-size: 18px;">
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><strong>Victimology:&nbsp;</strong></li>
</ul>
</li>
</ul>
<ul style="font-size: 18px;">
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="2"><strong>Affected Regions: </strong>Predominantly the Middle East, with victims in the US, Europe and Russia.&nbsp;</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul style="font-size: 18px;">
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="2"><strong>Affected Industries: </strong>Aerospace and Telecommunications</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul style="font-size: 18px;">
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><strong>Unique Tools:</strong> ShellClient (evolving from a simple reverse shell to a complex RAT)</li>
</ul>
</li>
</ul>
<ul style="font-size: 18px;">
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><strong>Generic Tools: </strong>SafetyKatz, <a href="https://www.poweradmin.com/paexec/" rel="noopener" target="_blank"><span>PAExec</span></a>, <a href="https://attack.mitre.org/software/S0097/" rel="noopener" target="_blank"><span>ping</span></a>, <a href="https://attack.mitre.org/software/S0100/" rel="noopener" target="_blank"><span>ipconfig</span></a>, <a href="https://attack.mitre.org/software/S0057/" rel="noopener" target="_blank"><span>tasklist</span></a>, <a href="https://attack.mitre.org/software/S0039/" rel="noopener" target="_blank"><span>net</span></a>, and <a href="https://www.win-rar.com/start.html?&amp;L=0" rel="noopener" target="_blank"><span>WinRAR</span></a>.</li>
</ul>
</li>
</ul>
<ul style="font-size: 18px;">
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><strong>Known Infrastructure:</strong></li>
</ul>
</li>
</ul>
<ul style="font-size: 18px;">
<li style="list-style-type: none;">
<ul>
<li aria-level="2"><strong>2018-2020: </strong>ms-tech[.].us<span style="color: #4d4d4d;">&nbsp;</span></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li style="color: #4d4d4d;" aria-level="2"><strong>2021:</strong> DropBox C2</li>
</ul>
</li>
</ul>
</li>
</ul>
<p style="padding-left: 40px;"><span style="font-style: italic;">*MalKamak is derived from </span><a href="https://www.worldhistory.org/article/1484/twelve-ancient-persian-mythological-creatures/" rel="noopener" target="_blank" style="font-style: italic;">Kamak, </a><span style="font-style: italic;">the name of an ancient Persian mythological creature thought responsible for droughts and spreading chaos.</span></p>
<h3 style="font-size: 24px;"><span style="color: #434343;">Similarities to Previous Chafer APT-Related Campaigns</span></h3>
<p>During the analysis, it was observed that there were some potentially interesting links and similarities to an Iranian threat actor called <a href="https://attack.mitre.org/groups/G0087/" rel="noopener" target="_blank"><span>Chafer APT</span></a> (also known as APT39, ITG07 or Remix Kitten).&nbsp;</p>
<p>The group has been active since at least 2014, and is believed to be linked to the <em>Rana Intelligence Computing Company</em>, a <span style="font-size: 18px;">Teheran-based company, <a href="https://www.iranwatch.org/library/governments/united-states/executive-branch/department-justice/indicators-compromise-associated-rana-intelligence-computing-also-known-advanced" rel="noopener" target="_blank">previously known to serve as a front company</a> for the Iranian Ministry of Intelligence and Security </span>(MOIS). The Chafer APT is known to attack targets in the Middle East as well as the U.S. and Europe.&nbsp;</p>
<p>Examining past campaigns, such as the one analyzed in <a href="https://www.bitdefender.com/files/News/CaseStudies/study/332/Bitdefender-Whitepaper-Chafer-creat4491-en-EN-interactive.pdf" rel="noopener" target="_blank"><span>Bitdefender</span></a>’s Chafer APT report, the team noticed interesting overlaps with observations in this investigation, as detailed in the following sections.</p>
<p>Our current assessment is that while these overlaps are interesting, they are not enough to establish attribution with an adequate certainty.</p>
<h4 style="font-size: 24px;"><span style="color: #666666;">Credential Dumping</span></h4>
<p>Chafer has been <a href="https://www.bitdefender.com/files/News/CaseStudies/study/332/Bitdefender-Whitepaper-Chafer-creat4491-en-EN-interactive.pdf" rel="noopener" target="_blank"><span>known to use</span></a> the <a href="https://github.com/GhostPack/SafetyKatz" rel="noopener" target="_blank"><span>SafetyKatz</span></a> tool to harvest credentials from compromised endpoints. As mentioned previously in this report, there are indications that the threat actor analyzed here used the same tool.&nbsp;</p>
<h4 style="font-size: 24px;"><span style="color: #666666;">Obfuscated Persistence</span></h4>
<p>In both of the investigations, the threat actors maintained persistence by obfuscating the malware as legitimate Windows-related components on victims’ systems. To achieve that, both operations used the <em>Windows Defender Update</em> name to disguise their activity:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="border: 1pt solid #000000;">
<p><strong><span style="text-decoration: underline;">ShellClient Disguised Persistence</span></strong></p>
</td>
<td style="border: 1pt solid #000000;">
<p><a href="https://www.bitdefender.com/files/News/CaseStudies/study/332/Bitdefender-Whitepaper-Chafer-creat4491-en-EN-interactive.pdf" rel="noopener" target="_blank"><strong><span>Previous Chafer APT</span></strong></a><strong><span style="text-decoration: underline;"> Disguised Persistence</span></strong></p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><strong>WIndows Defender Update</strong> service</p>
</td>
<td style="border: 1pt solid #000000;">
<p><strong>Defender Update</strong> scheduled task</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 8px; line-height: 1;">&nbsp;</p>
<p style="text-align: center; font-size: 16px; line-height: 1.75;"><em>Obfuscated Persistence</em></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">PDBs</span></h4>
<p>Executable in both of the operations were found to be compiled from similar paths, particularly containing the “projects” folder under a root drive:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; height: 261.134px;" width="784" height="173">
<tbody>
<tr style="height: 49.2857px;">
<td style="border: 1pt solid #000000; width: 391.339px; height: 49px;">
<p><strong><span style="text-decoration: underline;">ShellClient PDB Paths</span></strong></p>
</td>
<td style="border: 1pt solid #000000; width: 391.339px; height: 49px;">
<p><strong><span style="text-decoration: underline;">Chafer APT Disguised Persistence</span></strong></p>
</td>
</tr>
<tr style="height: 105.268px;">
<td style="width: 391.339px; height: 105px;">
<p><strong>D:</strong>\<strong>projects</strong>\07 - Reverse Shell\ShellClientServer_HTTP\obj\Release\svchost.pdb</p>
</td>
<td style="border: 1pt solid #000000; width: 391.339px; height: 105px;">
<p><strong>F:</strong>\<strong>Projects</strong>\94-06\RCE\bin\Release\x64\mas.pdb</p>
</td>
</tr>
<tr style="height: 105.268px;">
<td style="border: 0.99609pt solid #000000; width: 391.339px; height: 105px;">
<p><strong>E:</strong>\<strong>Projects</strong> (Confidential)\07 - Reverse Shell\ShellClientServer_HTTP.v2\obj\Release\svchost.pdb</p>
</td>
<td style="width: 391.339px; height: 105px;">
<p><strong>F:</strong>\<strong>Projects</strong>\94-08\XNet\bin\Release\Win32\XNet.pdb</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 8px; line-height: 1;">&nbsp;</p>
<p style="text-align: center; font-size: 16px;"><em>PDB Evidence</em></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #434343;">Similarities to Agrius APT-Related Campaigns</span></h4>
<p>Another Iranian threat actor that was examined is a relatively new activity group known as <a href="https://apt.thaicert.or.th/cgi-bin/showcard.cgi?g=Agrius" rel="noopener" target="_blank"><span>Agrius APT</span></a>. The group has been known to attack mainly Israeli organizations and companies, carrying out destructive operations under the guise of ransomware attacks.&nbsp;</p>
<p>A <a href="https://www.sentinelone.com/labs/from-wiper-to-ransomware-the-evolution-of-agrius/" rel="noopener" target="_blank"><span>report</span></a> about Agrius attacks mentions a custom .NET backdoor called <em>IPsec Helper</em>. Although the <em>IPsec Helper</em> backdoor and ShellClient are quite different, there were some interesting similarities in the coding style and naming conventions, which may indicate a link between the two malware and the possibility that they were authored by developers from the same or adjacent teams.&nbsp;</p>
<p>These interesting code similarities could indicate a similar developer was also behind the ShellClient, or at the very least indicate a person who had access to the code of the two malware. That being said, the TTPs and the intrusions conducted by Agrius seem very different than the TTPs and intrusions observed in Operation GhostShell - and therefore we concluded that it is unlikely that Agrius is behind this operation.&nbsp;</p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Possible Coding Style Overlap</span></h4>
<p>When comparing the command parsing function of both <em>IPsec Helper</em> and ShellClient, a similar code structure and logic can be seen:&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image18-Oct-01-2021-06-24-46-23-PM.png?width=753&amp;name=image18-Oct-01-2021-06-24-46-23-PM.png" alt="image18-Oct-01-2021-06-24-46-23-PM" width="753" loading="lazy" style="width: 753px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image18-Oct-01-2021-06-24-46-23-PM.png?width=377&amp;name=image18-Oct-01-2021-06-24-46-23-PM.png 377w, https://www.cybereason.com/hs-fs/hubfs/image18-Oct-01-2021-06-24-46-23-PM.png?width=753&amp;name=image18-Oct-01-2021-06-24-46-23-PM.png 753w, https://www.cybereason.com/hs-fs/hubfs/image18-Oct-01-2021-06-24-46-23-PM.png?width=1130&amp;name=image18-Oct-01-2021-06-24-46-23-PM.png 1130w, https://www.cybereason.com/hs-fs/hubfs/image18-Oct-01-2021-06-24-46-23-PM.png?width=1506&amp;name=image18-Oct-01-2021-06-24-46-23-PM.png 1506w, https://www.cybereason.com/hs-fs/hubfs/image18-Oct-01-2021-06-24-46-23-PM.png?width=1883&amp;name=image18-Oct-01-2021-06-24-46-23-PM.png 1883w, https://www.cybereason.com/hs-fs/hubfs/image18-Oct-01-2021-06-24-46-23-PM.png?width=2259&amp;name=image18-Oct-01-2021-06-24-46-23-PM.png 2259w" sizes="(max-width: 753px) 100vw, 753px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Code similarities between IPsec Helper and ShellClient</em></span></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Naming Conventions&nbsp;</span></h4>
<p>Both ShellClient and <em>IPsec Helper</em> use a similar naming convention for the classes used to launch the malware as a service:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/image33-Oct-01-2021-06-27-38-17-PM.png?width=433&amp;name=image33-Oct-01-2021-06-27-38-17-PM.png" alt="image33-Oct-01-2021-06-27-38-17-PM" width="433" loading="lazy" style="width: 433px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image33-Oct-01-2021-06-27-38-17-PM.png?width=217&amp;name=image33-Oct-01-2021-06-27-38-17-PM.png 217w, https://www.cybereason.com/hs-fs/hubfs/image33-Oct-01-2021-06-27-38-17-PM.png?width=433&amp;name=image33-Oct-01-2021-06-27-38-17-PM.png 433w, https://www.cybereason.com/hs-fs/hubfs/image33-Oct-01-2021-06-27-38-17-PM.png?width=650&amp;name=image33-Oct-01-2021-06-27-38-17-PM.png 650w, https://www.cybereason.com/hs-fs/hubfs/image33-Oct-01-2021-06-27-38-17-PM.png?width=866&amp;name=image33-Oct-01-2021-06-27-38-17-PM.png 866w, https://www.cybereason.com/hs-fs/hubfs/image33-Oct-01-2021-06-27-38-17-PM.png?width=1083&amp;name=image33-Oct-01-2021-06-27-38-17-PM.png 1083w, https://www.cybereason.com/hs-fs/hubfs/image33-Oct-01-2021-06-27-38-17-PM.png?width=1299&amp;name=image33-Oct-01-2021-06-27-38-17-PM.png 1299w" sizes="(max-width: 433px) 100vw, 433px"></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image12-Oct-01-2021-06-28-38-20-PM.png?width=474&amp;name=image12-Oct-01-2021-06-28-38-20-PM.png" alt="image12-Oct-01-2021-06-28-38-20-PM" width="474" loading="lazy" style="width: 474px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image12-Oct-01-2021-06-28-38-20-PM.png?width=237&amp;name=image12-Oct-01-2021-06-28-38-20-PM.png 237w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-01-2021-06-28-38-20-PM.png?width=474&amp;name=image12-Oct-01-2021-06-28-38-20-PM.png 474w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-01-2021-06-28-38-20-PM.png?width=711&amp;name=image12-Oct-01-2021-06-28-38-20-PM.png 711w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-01-2021-06-28-38-20-PM.png?width=948&amp;name=image12-Oct-01-2021-06-28-38-20-PM.png 948w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-01-2021-06-28-38-20-PM.png?width=1185&amp;name=image12-Oct-01-2021-06-28-38-20-PM.png 1185w, https://www.cybereason.com/hs-fs/hubfs/image12-Oct-01-2021-06-28-38-20-PM.png?width=1422&amp;name=image12-Oct-01-2021-06-28-38-20-PM.png 1422w" sizes="(max-width: 474px) 100vw, 474px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Similarities between ShellClient and IPsec Helper naming conventions</em></span></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Kill Techniques&nbsp;</span></h4>
<p>Both ShellClient and IPsec Helper use <em>InstallUtil.exe</em> in the self kill mechanism. When ShellClient receives a self kill command, It executes InstallUtil.exe in order to delete the service created and remove itself from the infected machine. When IPsec Helper receives a self kill command, it creates and executes a batch script named “remover.bat”. The script uses <em>InstallUtil.exe</em> to delete the service created for the malware.</p>
<h4 style="font-size: 18px; line-height: 1.75;"><span style="color: #666666;"><span style="font-size: 24px;">Data Decoding and Encryption</span>&nbsp;</span></h4>
<p>Both ShellClient and <em>IPsec Helper</em> use Base64 and AES to encode and encrypt data sent to the C2. In addition, both malware have a separate class for Base64 encoding and decoding, and for AES encryption and decryption:</p>
<p style="text-align: center; padding-left: 80px;"><img src="https://www.cybereason.com/hs-fs/hubfs/image9-Oct-01-2021-06-29-42-26-PM.png?width=504&amp;name=image9-Oct-01-2021-06-29-42-26-PM.png" alt="image9-Oct-01-2021-06-29-42-26-PM" width="504" loading="lazy" style="width: 504px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image9-Oct-01-2021-06-29-42-26-PM.png?width=252&amp;name=image9-Oct-01-2021-06-29-42-26-PM.png 252w, https://www.cybereason.com/hs-fs/hubfs/image9-Oct-01-2021-06-29-42-26-PM.png?width=504&amp;name=image9-Oct-01-2021-06-29-42-26-PM.png 504w, https://www.cybereason.com/hs-fs/hubfs/image9-Oct-01-2021-06-29-42-26-PM.png?width=756&amp;name=image9-Oct-01-2021-06-29-42-26-PM.png 756w, https://www.cybereason.com/hs-fs/hubfs/image9-Oct-01-2021-06-29-42-26-PM.png?width=1008&amp;name=image9-Oct-01-2021-06-29-42-26-PM.png 1008w, https://www.cybereason.com/hs-fs/hubfs/image9-Oct-01-2021-06-29-42-26-PM.png?width=1260&amp;name=image9-Oct-01-2021-06-29-42-26-PM.png 1260w, https://www.cybereason.com/hs-fs/hubfs/image9-Oct-01-2021-06-29-42-26-PM.png?width=1512&amp;name=image9-Oct-01-2021-06-29-42-26-PM.png 1512w" sizes="(max-width: 504px) 100vw, 504px"></p>
<p style="text-align: center; padding-left: 80px;"><span style="font-size: 16px;"><em>ShellClient and IPsec Helper data decoding and encryption similarities</em></span></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Other Similar Functions</span><strong><span style="color: #666666;">&nbsp;</span></strong></h4>
<p>Some functions of ShellClient, <em>IPsec Helper</em> and <em>Apostle</em> malware are very similar, for example the <em>Serialize</em> function, which is found on all three malware variants.</p>
<p style="text-align: center; padding-left: 40px;"><img src="https://www.cybereason.com/hs-fs/hubfs/image4-Oct-01-2021-06-30-45-41-PM.png?width=615&amp;name=image4-Oct-01-2021-06-30-45-41-PM.png" alt="image4-Oct-01-2021-06-30-45-41-PM" width="615" loading="lazy" style="width: 615px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image4-Oct-01-2021-06-30-45-41-PM.png?width=308&amp;name=image4-Oct-01-2021-06-30-45-41-PM.png 308w, https://www.cybereason.com/hs-fs/hubfs/image4-Oct-01-2021-06-30-45-41-PM.png?width=615&amp;name=image4-Oct-01-2021-06-30-45-41-PM.png 615w, https://www.cybereason.com/hs-fs/hubfs/image4-Oct-01-2021-06-30-45-41-PM.png?width=923&amp;name=image4-Oct-01-2021-06-30-45-41-PM.png 923w, https://www.cybereason.com/hs-fs/hubfs/image4-Oct-01-2021-06-30-45-41-PM.png?width=1230&amp;name=image4-Oct-01-2021-06-30-45-41-PM.png 1230w, https://www.cybereason.com/hs-fs/hubfs/image4-Oct-01-2021-06-30-45-41-PM.png?width=1538&amp;name=image4-Oct-01-2021-06-30-45-41-PM.png 1538w, https://www.cybereason.com/hs-fs/hubfs/image4-Oct-01-2021-06-30-45-41-PM.png?width=1845&amp;name=image4-Oct-01-2021-06-30-45-41-PM.png 1845w" sizes="(max-width: 615px) 100vw, 615px"></p>
<p style="text-align: center; padding-left: 40px;"><span style="font-size: 16px;"><em>ShellClient, IPsech Helper and Apostle malware similarities</em></span></p>
<h4 style="font-size: 24px; line-height: 1.75;"><span style="color: #666666;">Possible Infrastructure Connection</span></h4>
<p>Another interesting connection identified between these malware is based on past IP address resolutions of the domain used by ShellClient <em>azure.ms-tech[.]us</em> and a domain used by <em>IPsec Helper</em> <em>whynooneistherefornoneofthem[.]com</em>. Both of these domains have been resolved to both of the IP addresses 139.162.120.150 and 50.116.17.41.&nbsp;</p>
<p>Upon examination of these IP addresses, they function as a <a href="https://en.wikipedia.org/wiki/DNS_sinkhole" rel="noopener" target="_blank"><span>sinkhole</span></a>. Further examination of other domains that were resolved to these IP addresses in the past revealed a significant number of malicious domains that were used by Iranian APTs.</p>
<h2 style="text-align: left; font-size: 30px; font-weight: bold;">Conclusion</h2>
<p>In the Operation GhostShell report, the Cybereason Nocturnus and Incident Response Teams discovered a sophisticated new Remote Access Trojan (RAT) dubbed ShellClient that was used in highly targeted attacks against a select few Aerospace and Telecommunications companies mainly in the Middle East, with other victims located in the U.S., Russia and Europe. Our current assessment is that the attacks were perpetrated by a newly discovered Iranian activity group dubbed <em>MalKamak</em> that has been operating since at least 2018 and remained in the dark until now.</p>
<p>The investigation into Operation GhostShell also revealed that ShellClient dates back to at least 2018, and has been continuously evolving ever since while successfully evading most security tools and remaining completely unknown. By studying the ShellClient development cycles, the researchers were able to observe how ShellClient has morphed over time from a rather simple reverse shell to a sophisticated RAT used to facilitate cyber espionage operations while remaining undetected.&nbsp;</p>
<p>The most recent ShellClient versions observed in Operation GhostShell follow the trend of abusing cloud-based storage services, in this case the popular Dropbox service. The ShellClient authors chose to abandon their previous C2 domain and replace the command and control mechanism of the malware with a more simple yet more stealthy C2 channel using Dropbox to exfiltrate the stolen data as well as to send commands to the malware. This trend has been increasingly adopted by many threat actors due to its simplicity and the ability to effectively blend in with legitimate network traffic.&nbsp;</p>
<p>It is the intention of the researchers that the information provided in the Operation GhostShell report will inspire further research regarding ShellClient and the newly identified <em>MalKamak </em>activity group, and that it will ultimately assist in shedding more light on this mysterious malware that was kept well-hidden for many years.&nbsp;</p>
<h2 style="font-size: 30px; font-weight: bold;">authors</h2>
<p><span style="font-weight: bold;"><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/image%20(34).png?width=160&amp;name=image%20(34).png" alt="image (34)" width="160" loading="lazy" style="width: 160px; float: left; margin: 0px 7px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image%20(34).png?width=80&amp;name=image%20(34).png 80w, https://www.cybereason.com/hs-fs/hubfs/image%20(34).png?width=160&amp;name=image%20(34).png 160w, https://www.cybereason.com/hs-fs/hubfs/image%20(34).png?width=240&amp;name=image%20(34).png 240w, https://www.cybereason.com/hs-fs/hubfs/image%20(34).png?width=320&amp;name=image%20(34).png 320w, https://www.cybereason.com/hs-fs/hubfs/image%20(34).png?width=400&amp;name=image%20(34).png 400w, https://www.cybereason.com/hs-fs/hubfs/image%20(34).png?width=480&amp;name=image%20(34).png 480w" sizes="(max-width: 160px) 100vw, 160px">TOM FAKTERMAN, THREAT RESEARCHER</span><br><br>Tom Fakterman, Cyber Security Analyst with the Cybereason Nocturnus Research Team, specializes in protecting critical networks and incident response. Tom has experience in researching malware, computer forensics and developing scripts and tools for automated cyber investigations.</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;"><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1.png?width=177&amp;name=Daniel-F-HS-1-1.png" alt="Daniel-F-HS-1-1" width="177" loading="lazy" style="width: 177px; float: left; margin: 0px 6px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1.png?width=89&amp;name=Daniel-F-HS-1-1.png 89w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1.png?width=177&amp;name=Daniel-F-HS-1-1.png 177w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1.png?width=266&amp;name=Daniel-F-HS-1-1.png 266w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1.png?width=354&amp;name=Daniel-F-HS-1-1.png 354w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1.png?width=443&amp;name=Daniel-F-HS-1-1.png 443w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1.png?width=531&amp;name=Daniel-F-HS-1-1.png 531w" sizes="(max-width: 177px) 100vw, 177px">DANIEL FRANK, SENIOR MALWARE RESEARCHER</span><br><br>With a decade in malware research, Daniel uses his expertise with malware analysis and reverse engineering to understand APT activity and commodity cybercrime attackers. Daniel has previously shared research at RSA Conference, the Microsoft Digital Crimes Consortium, and Rootcon.</p>
<p>&nbsp;</p>
<p style="font-weight: normal;"><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/image%20(35).png?width=165&amp;name=image%20(35).png" alt="image (35)" width="165" loading="lazy" style="width: 165px; float: left; margin: 0px 7px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image%20(35).png?width=83&amp;name=image%20(35).png 83w, https://www.cybereason.com/hs-fs/hubfs/image%20(35).png?width=165&amp;name=image%20(35).png 165w, https://www.cybereason.com/hs-fs/hubfs/image%20(35).png?width=248&amp;name=image%20(35).png 248w, https://www.cybereason.com/hs-fs/hubfs/image%20(35).png?width=330&amp;name=image%20(35).png 330w, https://www.cybereason.com/hs-fs/hubfs/image%20(35).png?width=413&amp;name=image%20(35).png 413w, https://www.cybereason.com/hs-fs/hubfs/image%20(35).png?width=495&amp;name=image%20(35).png 495w" sizes="(max-width: 165px) 100vw, 165px"><span style="font-weight: bold;">CHEN ERLICH, INCIDENT RESPONSE ENGINEER</span></p>
<p>Chen has almost a decade of experience in Threat Intelligence &amp; Research, Incident Response and Threat Hunting. Before joining to Cybereason, Chen spent three years dissecting APTs, investigating underground cybercriminal groups and discovering security vulnerabilities in known vendors. Previously, he served as a Security Researcher in the <span style="color: #33475b;"><span style="background-color: #faa52d;">military forces</span></span>.</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;"><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/assaf.jpg?width=176&amp;name=assaf.jpg" alt="assaf" width="176" loading="lazy" style="width: 176px; float: left; margin: 0px 7px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/assaf.jpg?width=88&amp;name=assaf.jpg 88w, https://www.cybereason.com/hs-fs/hubfs/assaf.jpg?width=176&amp;name=assaf.jpg 176w, https://www.cybereason.com/hs-fs/hubfs/assaf.jpg?width=264&amp;name=assaf.jpg 264w, https://www.cybereason.com/hs-fs/hubfs/assaf.jpg?width=352&amp;name=assaf.jpg 352w, https://www.cybereason.com/hs-fs/hubfs/assaf.jpg?width=440&amp;name=assaf.jpg 440w, https://www.cybereason.com/hs-fs/hubfs/assaf.jpg?width=528&amp;name=assaf.jpg 528w" sizes="(max-width: 176px) 100vw, 176px">ASSAF DAHAN, HEAD OF THREAT RESEARCH</span></p>
<p>Assaf has over 15 years in the InfoSec industry. He started his career in the military forces&nbsp;Cybersecurity unit where he developed extensive experience in offensive security. Later in his career he led Red Teams, developed penetration testing methodologies, and specialized in malware analysis and reverse engineering.</p>
<h2 style="font-size: 24px; font-weight: bold;">INDICATORS OF COMPROMISE</h2>
<p style="font-weight: bold;"><em>Open the chatbot on the bottom right corner of your screen to access the Ghostshell IOCs and Appendix A.</em></p>
<h2 style="text-align: left; font-size: 24px; font-weight: bold;">MITRE ATT&amp;CK BREAKDOWN</h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; height: 307.101px; width: 974px;">
<tbody>
<tr style="height: 76.9965px;">
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 255.469px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Execution</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 175.33px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Persistence</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 161.285px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Privilege Escalation</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 233.438px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Defense Evasion</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 147.361px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Credential Access</span></strong></span></p>
</td>
</tr>
<tr style="height: 100px;">
<td style="border: 0.75pt solid #99acc2; width: 255.469px; height: 100px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1059/" style="color: #00a0df;">Command-line interface</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 175.33px; height: 100px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1543/003/" style="color: #00a0df;">Windows Service</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 161.285px; height: 100px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1078/" style="color: #00a0df;">Valid Accounts</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 233.438px; height: 100px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;">&nbsp; <a href="https://attack.mitre.org/techniques/T1027/" style="color: #00a0df;">Obfuscated Files or Information</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 147.361px; height: 100px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1003/" style="color: #00a0df;">Credential Dumping</a></span></p>
</td>
</tr>
<tr style="height: 76.9965px;">
<td style="border: 0.75pt solid #99acc2; width: 255.469px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1047/" style="color: #00a0df;">Windows Management Instrumentation</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 175.33px; height: 77px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 161.285px; height: 77px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 233.438px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1036/" style="color: #00a0df;">Masquerading</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 147.361px; height: 77px;">&nbsp;</td>
</tr>
<tr style="height: 51.9965px;">
<td style="border: 0.75pt solid #99acc2; width: 255.469px; height: 52px;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1086/" style="color: #00a0df;">PowerShell</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 175.33px; height: 52px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 161.285px; height: 52px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 233.438px; height: 52px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 147.361px; height: 52px;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; width: 789px; height: 569.973px;">
<tbody>
<tr style="height: 76.9955px;">
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 180px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Discovery</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 171px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;"> Lateral Movement</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 135px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Collection</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 141px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Command and Control</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 162px; height: 77px;">
<p style="text-align: center;"><span style="font-size: 18px;"><strong><span style="color: #596a6f;">Exfiltration</span></strong></span></p>
</td>
</tr>
<tr style="height: 129px;">
<td style="border: 0.75pt solid #99acc2; width: 180px; height: 129px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1518/001/" style="color: #00a0df;" rel="noopener" target="_blank">Security Software Discovery</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 171px; height: 129px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1021/002/" style="color: #00a0df;" rel="noopener" target="_blank">SMB/Windows Admin Shares</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 135px; height: 129px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1560/" style="color: #00a0df;" rel="noopener" target="_blank">Archive Collected Data</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 141px; height: 129px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1132/" style="color: #00a0df;" rel="noopener" target="_blank">Data Encoding</a></span></p>
<br><br></td>
<td style="width: 162px; height: 129px; vertical-align: middle;"><br>
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1567/" style="color: #00a0df;" rel="noopener" target="_blank">Exfiltration Over Web Service</a></span></p>
</td>
</tr>
<tr style="height: 153px;">
<td style="border: 0.75pt solid #99acc2; width: 180px; height: 153px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1082/" style="color: #00a0df;" rel="noopener" target="_blank">System Information Discovery</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 171px; height: 153px; vertical-align: middle;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 135px; height: 153px; vertical-align: middle;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 141px; height: 153px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1573/" style="color: #00a0df;" rel="noopener" target="_blank">Encrypted Channel</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 162px; height: 153px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1041/" style="color: #00a0df;" rel="noopener" target="_blank">Exfiltration Over C2 Channe</a><span style="color: #00a0df;">l</span></span></p>
<br><br></td>
</tr>
<tr style="height: 132.991px;">
<td style="border: 0.75pt solid #99acc2; width: 180px; height: 133px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1016/" style="color: #00a0df;" rel="noopener" target="_blank">System Network Configuration Discovery</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 171px; height: 133px; vertical-align: middle;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 135px; height: 133px; vertical-align: middle;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 141px; height: 133px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1071/002/" style="color: #00a0df;" rel="noopener" target="_blank">File Transfer Protocols</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 162px; height: 133px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1048/" style="color: #00a0df;" rel="noopener" target="_blank">Exfiltration Over Alternative Protocol</a></span></p>
</td>
</tr>
<tr style="height: 76.9955px;">
<td style="border: 0.75pt solid #99acc2; width: 180px; height: 77px; vertical-align: middle;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 171px; height: 77px; vertical-align: middle;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 135px; height: 77px; vertical-align: middle;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 141px; height: 77px; vertical-align: middle;">
<p style="text-align: center;"><span style="font-size: 18px;"><a href="https://attack.mitre.org/techniques/T1071/001/" style="color: #00a0df;" rel="noopener" target="_blank">Web Protocols</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 162px; height: 77px; vertical-align: middle;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p></span>
          
          <!-- IOC PopUp Modal -->
          
          
            <div id="hs_cos_wrapper_module_162281712252340" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- Button -->



<div class="cr-modal" id="iocs">
  <div class="cr-modal-overlay cr-modal-toggle"></div>
  <div class="cr-modal-wrapper cr-modal-transition">
    <div class="cr-modal-header">
      <button class="cr-modal-close cr-modal-toggle" id="ioc-close">X</button>
    </div>

    <div class="cr-modal-body">
      <div class="cr-modal-content">
        <h3 style="line-height: 1; font-size: 30px;"><span style="color: #000000;">Indicators of Compromise</span></h3>
<p><strong>SHA-256 Hashes</strong></p>
<ul>
<li aria-level="1">21cc9c0ae5f97b66d69f1ff99a4fed264551edfe0a5ce8d5449942bf8f0aefb2 - V0</li>
<li aria-level="1">5d5ff74906d2666be0fbfe420c5d225684aa1cb516fffc32cfeee9e788e4b6e4 - V1</li>
<li aria-level="1">186ab2a5662c5e3994ee1cbfcf9e7842f1e41b1a4041c67f808914dfc8850706 - V2.1</li>
<li aria-level="1">A541afa0e73c3942b8c3645a3ba1ea59c4d6e1110e271be34fdb6a8c02a299e2 - V3.1</li>
<li aria-level="1">49c41771e8e348b30de43d1112221c71a6497794b541fead7f3b2eab706afba3 - V4.0.0</li>
<li aria-level="1">2a1044e9e6e87a032f80c6d9ea6ae61bbbb053c0a21b186ecb3b812b49eb03b7 - V4.0.1</li>
<li aria-level="1">19e040305fb57592bb62b41c24e9b64162e1e082230a356a304a3193743b102d - ClientCore.dll (V4.0.1)</li>
<li aria-level="1">d7aa669de0f8a0cdb898cf33ac38ae65461de3c8c0c313c82ee8d48e408e4c4d - ExtensionLib.dll (V4.0.0 and V4.0.1)</li>
<li aria-level="1">6b7b6e973779c1a07891cc1fa7b3e4078a1308c4114296eb3ea429e08793efe0 - ClientCore.dll (V4.0.0)</li>
</ul>
<p><strong>Domains</strong></p>
<ul>
<li aria-level="1">azure.ms-tech[.]us</li>
<li aria-level="1">ms-tech[.].us</li>
</ul>
<p><strong>User Agents (V4.0.1)</strong></p>
<ul>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:67.0) Gecko/20100101 Firefox/67.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; rv:66.0) Gecko/20100101 Firefox/66.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 h1atfoAh-17 Firefox/66.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:66.0) Gecko/20100101 Firefox/66.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:65.0) Gecko/20100101 Firefox/65.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; rv:65.0) Gecko/20100101 Firefox/65.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3790.0 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3782.0 Safari/537.36 Edg/76.0.152.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3730.0 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.108 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.75 Safari/537.36</li>
</ul>
<p><strong>Service Names</strong></p>
<ul>
<li aria-level="1">WinDefUpd</li>
<li aria-level="1">nhdService</li>
</ul>
<p><strong>ShellClient V4 Encryption IOCs</strong></p>
<ul>
<li aria-level="1"><span style="text-decoration: underline;">Encryption key</span></li>
</ul>
<p style="padding-left: 40px;">158 98 64 73 240 26 162 43 95 71 180 125 45 225 114 84 107 246 64 39 14 173 113 32 153 101 212 45 242 46 234 67</p>
<ul>
<li aria-level="2"><span style="text-decoration: underline;">Decoded</span>: .b@Ið.¢+_G´}-árTkö@'..q .eÔ-ò.êC</li>
</ul>
<ul>
<li aria-level="1"><span style="text-decoration: underline;">IV</span></li>
</ul>
<p style="padding-left: 40px;">122 86 251 223 55 35 147 167 215 71 111 210 28 161 154 55</p>
<ul>
<li aria-level="2"><span style="text-decoration: underline;">Decoded</span>: zVûß7#.§×GoÒ.¡.7</li>
</ul>
<p><a href="/hubfs/dam/images/images-web/blog-images/GhostShell%20Appendix%20PDF.pdf" rel="noopener" target="_blank">Click here</a> to download the Appendix for Operation GhostShell</p>
      </div>
    </div>
  </div>
</div></div>
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png" alt="Cybereason Nocturnus">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Nocturnus</h4>
                
                  <a class="social" href="https://www.linkedin.com/company/cybereason" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/cr_nocturnus" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-nocturnus">All Posts by Cybereason Nocturnus</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%286%29.png" alt="Threat Analysis Report: DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike"></a>
    <h4><a href="https://www.cybereason.com/blog/research/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike"><span class="underline">Threat Analysis Report: DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike</span></a></h4>
     <p>After exploitation of ProxyShell, attackers used Exchange to distribute phishing emails with the QBot payload and DatopLoader, a loader previously used to distribute the Cobalt Strike malware...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/featured-images/cuckoo-spear-pt-2-featured.png" alt="CUCKOO SPEAR Part 2: Threat Actor Arsenal"></a>
    <h4><a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal"><span class="underline">CUCKOO SPEAR Part 2: Threat Actor Arsenal</span></a></h4>
     <p>In this report, Cybereason confirms the ties between Cuckoo Spear and APT10 Intrusion Set by tying multiple incidents together and disclosing new information about this group’s new arsenal and techniques.</p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/malicious-life-podcast-operation-snow-white-part-2" class="post-name"><span class="underline">Malicious Life Podcast: Operation Snow White, Part 2</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware" class="post-name"><span class="underline">THREAT ANALYSIS: Beast Ransomware</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal" class="post-name"><span class="underline">CUCKOO SPEAR Part 2: Threat Actor Arsenal</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%286%29.png" alt="Threat Analysis Report: DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike"></a>
    <h4><a href="https://www.cybereason.com/blog/research/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike"><span class="underline">Threat Analysis Report: DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike</span></a></h4>
     <p>After exploitation of ProxyShell, attackers used Exchange to distribute phishing emails with the QBot payload and DatopLoader, a loader previously used to distribute the Cobalt Strike malware...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/featured-images/cuckoo-spear-pt-2-featured.png" alt="CUCKOO SPEAR Part 2: Threat Actor Arsenal"></a>
    <h4><a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal"><span class="underline">CUCKOO SPEAR Part 2: Threat Actor Arsenal</span></a></h4>
     <p>In this report, Cybereason confirms the ties between Cuckoo Spear and APT10 Intrusion Set by tying multiple incidents together and disclosing new information about this group’s new arsenal and techniques.</p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2024. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507089303/1644440411417/__CR_Web_Platform/JS/animatedModal/animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386128/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443113/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/48386556055/1642017327401/module_48386556055_CR_-_HTML_PopUp_Window_--_IOCs.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042213858/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/86933076631/1669911113440/module_86933076631_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/research\/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"]);
_hsq.push(["setPageId", "56540216169"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 56540216169,
    "legacyPageId": "56540216169",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 56540216169,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "98eb794d-08ff-4da0-9610-c321e7dac7f7",
    ticks: 1729738957776,
    page_id: 56540216169,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    analytics_page_id: "56540216169",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=2&cb=1396060705" async></script></body></html>