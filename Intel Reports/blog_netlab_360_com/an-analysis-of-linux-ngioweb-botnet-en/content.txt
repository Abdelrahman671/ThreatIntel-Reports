<!DOCTYPE html>
<html lang="en">
<head>

    <title>An Analysis of Linux.Ngioweb Botnet</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=42b57cac00" />

    <link rel="icon" href="https://blog.netlab.360.com/content/images/size/w256h256/2019/02/netlab_xs-2.png" type="image/png">
    <link rel="canonical" href="https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/amp/">
    
    <meta property="og:site_name" content="360 Netlab Blog - Network Security Research Lab at 360">
    <meta property="og:type" content="article">
    <meta property="og:title" content="An Analysis of Linux.Ngioweb Botnet">
    <meta property="og:description" content="Background


On May 27, 2019, Our Unknown Threat Detect System highlighted a suspicious ELF file, and till this day, the detection rate on VT is still only one with a very generic name. We determined that this is a Proxy Botnet, and it is a Linux version variant of the">
    <meta property="og:url" content="https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/">
    <meta property="og:image" content="https://blog.netlab.360.com/content/images/2019/02/astronomy-constellation-dark-998641-4.jpg">
    <meta property="article:published_time" content="2019-06-21T10:45:43.000Z">
    <meta property="article:modified_time" content="2022-02-09T07:12:34.000Z">
    <meta property="article:tag" content="Botnet">
    <meta property="article:tag" content="en">
    <meta property="article:tag" content="Linux.Ngioweb">
    <meta property="article:tag" content="Proxy Botnet">
    <meta property="article:tag" content="honeypot">
    <meta property="article:tag" content="Import 2022-11-30 11:16">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="An Analysis of Linux.Ngioweb Botnet">
    <meta name="twitter:description" content="Background


On May 27, 2019, Our Unknown Threat Detect System highlighted a suspicious ELF file, and till this day, the detection rate on VT is still only one with a very generic name. We determined that this is a Proxy Botnet, and it is a Linux version variant of the">
    <meta name="twitter:url" content="https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/">
    <meta name="twitter:image" content="https://blog.netlab.360.com/content/images/2019/02/astronomy-constellation-dark-998641-4.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Alex.Turing">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Botnet, en, Linux.Ngioweb, Proxy Botnet, honeypot, Import 2022-11-30 11:16">
    <meta name="twitter:site" content="@360Netlab">
    <meta name="twitter:creator" content="@TuringAlex">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="800">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "360 Netlab Blog - Network Security Research Lab at 360",
        "url": "https://blog.netlab.360.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Alex.Turing",
        "image": {
            "@type": "ImageObject",
            "url": "https://blog.netlab.360.com/content/images/2019/06/turing.PNG",
            "width": 1200,
            "height": 1200
        },
        "url": "https://blog.netlab.360.com/author/alex/",
        "sameAs": [
            "https://twitter.com/TuringAlex"
        ]
    },
    "headline": "An Analysis of Linux.Ngioweb Botnet",
    "url": "https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/",
    "datePublished": "2019-06-21T10:45:43.000Z",
    "dateModified": "2022-02-09T07:12:34.000Z",
    "keywords": "Botnet, en, Linux.Ngioweb, Proxy Botnet, honeypot, Import 2022-11-30 11:16",
    "description": "Background\n\n\nOn May 27, 2019, Our Unknown Threat Detect System highlighted a suspicious ELF file, and till this day, the detection rate on VT is still only one with a very generic name. We determined that this is a Proxy Botnet, and it is a Linux version variant of the Win32.Ngioweb[1] malware. We named it Linux.Ngioweb. It shares a lot of code with Win32.Ngioweb, except that it has DGA features. We registered one of the DGA C2 domain names (enutofish-pronadimoful-multihitision.org) and was able",
    "mainEntityOfPage": "https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/"
}
    </script>

    <meta name="generator" content="Ghost 5.76">
    <link rel="alternate" type="application/rss+xml" title="360 Netlab Blog - Network Security Research Lab at 360" href="https://blog.netlab.360.com/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="db8c743e6bb1457403d255d83f" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://blog.netlab.360.com/" crossorigin="anonymous"></script>
    
    <link href="https://blog.netlab.360.com/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=42b57cac00"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=42b57cac00">
    <style type='text/css'>
	#ghost-portal-root {
        display: none;
    }
</style><style>:root {--ghost-accent-color: #eca265;}</style>

</head>
<body class="post-template tag-botnet tag-en tag-linux-ngioweb tag-proxy-botnet tag-honeypot tag-import-2022-11-30-11-16 has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <nav class="gh-head-inner inner">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="https://blog.netlab.360.com">
                        <img src="https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png" alt="360 Netlab Blog - Network Security Research Lab at 360" />
                </a>
                <div class="gh-head-brand-wrapper">
                    <button class="gh-search" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <a class="gh-burger" role="button">
                        <div class="gh-burger-box">
                            <div class="gh-burger-inner"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-botnet"><a href="https://blog.netlab.360.com/tag/botnet/">Botnet</a></li>
    <li class="nav-dnsmon"><a href="https://blog.netlab.360.com/tag/dnsmon/">DNSMon</a></li>
    <li class="nav-ddos"><a href="https://blog.netlab.360.com/tag/ddos/">DDoS</a></li>
    <li class="nav-passivedns"><a href="https://blog.netlab.360.com/tag/pdns/">PassiveDNS</a></li>
    <li class="nav-mirai"><a href="https://blog.netlab.360.com/tag/mirai/">Mirai</a></li>
    <li class="nav-dta"><a href="https://blog.netlab.360.com/tag/dta/">DTA</a></li>
</ul>

            </div>
            <div class="gh-head-actions">
                <div class="gh-social">
                        <a class="gh-social-link gh-social-twitter" href="https://twitter.com/360Netlab" title="Twitter" target="_blank" rel="me noopener"><svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg></a>
                        <a class="gh-social-link gh-social-feedly" href="https://feedly.com/i/subscription/feed/https://blog.netlab.360.com/rss/" title="RSS" target="_blank" rel="me noopener"><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</a>
                </div>
            </div>
        </nav>
    </header>

    <div class="site-content">
             <div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://blog.netlab.360.com">
                <img src="/content/images/size/w30/2019/02/netlab_xs-2.png" alt="360 Netlab Blog - Network Security Research Lab at 360 icon" />
            <span>360 Netlab Blog - Network Security Research Lab at 360</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">An Analysis of Linux.Ngioweb Botnet</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=An%20Analysis%20of%20Linux.Ngioweb%20Botnet&amp;url=https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg>        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"/></svg>        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


  <main id="site-main" class="site-main">
    <article class="article post tag-botnet tag-en tag-linux-ngioweb tag-proxy-botnet tag-honeypot tag-import-2022-11-30-11-16 no-image ">

      <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
          <span class="post-card-primary-tag">
            <a href="/tag/botnet/">Botnet</a>
          </span>
        </div>

        <h1 class="article-title">An Analysis of Linux.Ngioweb Botnet</h1>


        <div class="article-byline">
          <section class="article-byline-content">

            <ul class="author-list">
              <li class="author-list-item">
                <a href="/author/alex/" class="author-avatar">
                  <img class="author-profile-image" src="/content/images/2019/06/turing.PNG" alt="Alex.Turing" />
                </a>
              </li>
              <li class="author-list-item">
                <a href="/author/yegenshen/" class="author-avatar">
                  <img class="author-profile-image" src="/content/images/2017/10/1662072805.jpg" alt="Genshen Ye" />
                </a>
              </li>
            </ul>

            <div class="article-byline-meta">
              <h4 class="author-name"><a href="/author/alex/">Alex.Turing</a>, <a href="/author/yegenshen/">Genshen Ye</a></h4>
              <div class="byline-meta-content">
                <time class="byline-meta-date" datetime=" 2019-06-21">Jun 21, 2019</time>
                <span class="byline-reading-time"><span class="bull">&bull;</span> 14 min read</span>
              </div>
            </div>

          </section>
        </div>


      </header>

      <section class="gh-content gh-canvas">
        <!--kg-card-begin: markdown--><h3 id="background">Background</h3>
<p>On May 27, 2019, Our Unknown Threat Detect System highlighted a suspicious ELF file, and till this day, the detection rate on VT is still only one with a very generic name. We determined that this is a Proxy Botnet, and it is a Linux version variant of the Win32.Ngioweb[<a href="https://research.checkpoint.com/ramnits-network-proxy-servers/?ref=blog.netlab.360.com">1]</a> malware. We named it Linux.Ngioweb. It shares a lot of code with Win32.Ngioweb, except that it has DGA features. We registered one of the DGA C2 domain names (enutofish-pronadimoful-multihitision.org) and was able to observe the Bot connections.</p>
<p>In addition, we have observed that Linux.Ngioweb malware has been implanted into a large number of WordPress Web servers.</p>
<p>Although the Bot program is loaded with the privilege of the user group corresponding to the Web container, it still works and runs as Rotating Proxy node[<a href="https://stormproxies.com/rotating_reverse_proxies.html?ref=blog.netlab.360.com">2]</a>.</p>
<p>We don’t know why the attacker runs this proxy botnet, but it is possible that everything goes through the proxy is being recorded by the attacker.</p>
<h3 id="overviewoflinuxngioweb">Overview of Linux.Ngioweb</h3>
<p>The main functionality of the Linux.Ngioweb Bot sample is to implement Back-Connect Proxy[<a href="https://hide-ip-proxy.com/what-is-a-backconnect-proxy/?ref=blog.netlab.360.com">3]</a>.on the victim's machine. The attacker builds multiple Bots into a Proxies Pool and controls it through a two-tier C2 protocol, then provides a Rotating Proxy Service.</p>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/Linux.Ngioweb-1.png"><img src="https://blog.netlab.360.com/content/images/2019/06/Linux.Ngioweb-1.png" class="kg-image"></a></p>
<h3 id="reverseengineeringonlinuxngioweb">Reverse engineering on Linux.Ngioweb</h3>
<h4 id="basicinformation">Basic information</h4>
<ul>
<li>MD5: 827ecf99001fa66de513fe5281ce064d</li>
</ul>
<blockquote>
<p>ELF 64-bit LSB executable, AMD x86-64, version 1 (SYSV), statically linked, stripped</p>
</blockquote>
<h4 id="antireverseengineeringtechnique">Anti-reverse engineering technique</h4>
<ul>
<li>
<p>Uses a niche library named musl libc<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/1.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/1.PNG" class="kg-image"></a></p>
</li>
<li>
<p>Stores its functions in the function table in advance<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/2.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/2-3.PNG" class="kg-image"></a></p>
</li>
<li>
<p>Uses Stack Strings Obfuscation<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/3.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/3-2.PNG" class="kg-image"></a></p>
</li>
<li>
<p>Generates constant table used by CRC and AES<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/crypt-1.png"><img src="https://blog.netlab.360.com/content/images/2019/06/crypt-1.png" class="kg-image"></a></p>
</li>
<li>
<p>Uses a two-tier C2 protocol, where Stage-2 C2 is determined by the CONNECT instruction of Stage-1 C2</p>
</li>
<li>
<p>Stage-2 C2 uses a two-layer encrypted communication protocol</p>
</li>
</ul>
<h4 id="stage1c2protocolanalysis">Stage-1 C2 protocol analysis</h4>
<p>At this stage, the main behavior of the sample is to establish communication with Stage-1 C2, and proceed to the next step according to the instructions returned by C2.</p>
<h6 id="communicationattempt">Communication attempt</h6>
<ul>
<li>
<p>Try to establish communication with the following hardcoded C2 IP every 60 seconds<br>
169.239.128.166:443<br>
185.244.149.73:443</p>
</li>
<li>
<p>Try to establish communication with the domain name generated by DGA (Domain Generation Algorithm) every 73 seconds. When the number of DGA domain names reaches 300, the Seed will be reset. So the total number of DGA domain names is 300.<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/4.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/4-1.PNG" class="kg-image"></a></p>
</li>
</ul>
<h6 id="dgaimplementation">DGA implementation</h6>
<pre><code class="language-c">uint64_t GenSeed(uint32_t&amp; seed, uint32_t mod)
{
      uint32_t tmp = 0x41C64E6D * seed + 0x3039;
      seed = tmp;
      return tmp % mod;
}
string dga(uint32_t&amp; seed)
{
      char* HeadBuf[] = { &quot;un&quot;, &quot;under&quot;, &quot;re&quot;, &quot;in&quot;, &quot;im&quot;, &quot;il&quot;, &quot;ir&quot;, &quot;en&quot;, &quot;em&quot;,
                          &quot;over&quot;, &quot;mis&quot;, &quot;dis&quot;, &quot;pre&quot;, &quot;post&quot;, &quot;anti&quot;,&quot;inter&quot;,
                          &quot;sub&quot;, &quot;ultra&quot;, &quot;non&quot;, &quot;de&quot;,&quot;pro&quot;, &quot;trans&quot;, &quot;ex&quot;,
                          &quot;macro&quot;, &quot;micro&quot;, &quot;mini&quot;,&quot;mono&quot;, &quot;multi&quot;, &quot;semi&quot;, &quot;co&quot; };

      char* BodyBufA[] = {&quot;able&quot;,&quot;ant&quot;,&quot;ate&quot;,&quot;age&quot;,&quot;ance&quot;,&quot;ancy&quot;,&quot;an&quot;,&quot;ary&quot;,
                          &quot;al&quot;,&quot;en&quot;,&quot;ency&quot;,&quot;er&quot;,&quot;etn&quot;, &quot;ed&quot;, &quot;ese&quot;,&quot;ern&quot;,&quot;ize&quot;,
                          &quot;ify&quot;,&quot;ing&quot;,&quot;ish&quot;,&quot;ity&quot;,&quot;ion&quot;,&quot;ian&quot;,&quot;ism&quot;,&quot;ist&quot;,&quot;ic&quot;,&quot;ical&quot;,
                          &quot;ible&quot;,&quot;ive&quot;,&quot;ite&quot;,&quot;ish&quot;,&quot;ian&quot;,&quot;or&quot;,&quot;ous&quot;,&quot;ure&quot; };

      char* BodyBufB[] = {&quot;dom&quot;,&quot;hood&quot;,&quot;less&quot;,&quot;like&quot;,&quot;ly&quot;,&quot;fy&quot;,&quot;ful&quot;,&quot;ness&quot;,
                          &quot;ment&quot;,&quot;sion&quot;,&quot;ssion&quot;,&quot;ship&quot;,&quot;ty&quot;,&quot;th&quot;,&quot;tion&quot;,&quot;ward&quot; };

      char* TailBuf[] = { &quot;.net&quot;,&quot;.info&quot;,&quot;.com&quot;,&quot;.biz&quot;,&quot;.org&quot;,&quot;.name&quot; };

      string BlockBufA = &quot;aeiou&quot;;
      string BlockBufB = &quot;bcdfghklmnprstvxz&quot;;
      string domain;
      uint32_t dashloop = GenSeed(seed, 3) + 1;
      while (dashloop--)
      {
              domain += HeadBuf[GenSeed(seed, 0x1e)];
              int flag = 0;
              int i = 0;
              if (BlockBufA.find(domain.back()) == string::npos)
                      flag = 1;
              int fillcnt = GenSeed(seed, 0x3) + 4;
              while (fillcnt &gt; i)
              {

                      if (flag + i &amp; 1)
                              domain += BlockBufA[GenSeed(seed, 0x5)];
                      else
                              domain += BlockBufB[GenSeed(seed, 0x11)];
                      i++;
              }
              if (BlockBufA.find(domain.back()) == string::npos)
                      domain += BodyBufA[GenSeed(seed, 0x23)];
              else
                      domain += BodyBufB[GenSeed(seed, 0x10)];
              if (dashloop != 0)
                      domain += &quot;-&quot;;
      }
      return domain += TailBuf[GenSeed(seed, 0x6)];
}

</code></pre>
<h6 id="communicationprotocol">Communication Protocol</h6>
<p>This phase of communication is based on the HTTP protocol and the parameters are Base64 encoded.</p>
<h6 id="packetsoverview">Packets overview</h6>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/5.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/5-1.PNG" class="kg-image"></a></p>
<h6 id="sentpacketsdecode">Sent Packets decode</h6>
<p>After decoded the parameter content by Base64, we get the following information.<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/6.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/6-1.PNG" class="kg-image"></a></p>
<ul>
<li>
<p>id=machine-id[0:15]</p>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/7.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/7.PNG" class="kg-image"></a></p>
</li>
<li>
<p>v=x86_64, hardcoded, architecture</p>
</li>
<li>
<p>sv=5003, hardcoded, version number</p>
</li>
<li>
<p>&amp;qlohmzalwdepupwf, random 16-byte data, the algorithm is as follows</p>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/8.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/8-1.PNG" class="kg-image"></a></p>
</li>
<li>
<p>User-Agent, hardcoded</p>
<pre><code>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0
</code></pre>
</li>
</ul>
<h6 id="receivedpacketsdecode">Received Packets decode</h6>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/a.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/a-1.PNG" class="kg-image"></a></p>
<p>Command Supported</p>
<ul>
<li>WAIT</li>
<li>CONNECT</li>
<li>DISCONNECT</li>
<li>CERT</li>
</ul>
<h4 id="stage2c2protocolanalysis">Stage-2 C2 protocol analysis</h4>
<p>At this stage, the main action of the sample is to establish communication with the C2 of Stage-2 and enable the Back-Connect Proxy function. C2 of stage-2 is specified by the CONNECT command.</p>
<h6 id="communicationprotocol">Communication Protocol</h6>
<p>At this stage, the communication is combined by double-layer encryption. The inner layer is XOR and the outer layer is AES.</p>
<h6 id="packetsoverview">Packets overview</h6>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/b.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/b-1.PNG" class="kg-image"></a></p>
<h6 id="encryptionalgorithm">Encryption Algorithm</h6>
<p>The XOR key is generated by a random algorithm:<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/d.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/d-1.PNG" class="kg-image"></a></p>
<p>The algorithm is:<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/c.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/c-1.PNG" class="kg-image"></a></p>
<p>AES uses ECB mode, no padding. The key is:<strong>qwerasdfzxcqwerasdftyuirfdsdsdss</strong></p>
<h6 id="packetstructure">Packet Structure</h6>
<p>The packet consists of two parts: “header” and “msg”.</p>
<p>“header” structure:</p>
<pre><code class="language-c">#le-&gt;little endian
#be-&gt;big endian
struct header
{
	uint32_le xorkey;
	uint32_be msgcrc32;
	uint32_be len;
	uint16_be msgcode
	uint16_be magic
};
</code></pre>
<p>“msg” consists of chunks, and the chunks supported by the sample are as follows:</p>
<table>
<thead>
<tr>
<th>Chunk  Type</th>
<th>Chunk Length</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>BYTE</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>WORD big endian</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>DWORD big endian</td>
</tr>
<tr>
<td>4</td>
<td>8</td>
<td>QWORD big endian</td>
</tr>
<tr>
<td>5</td>
<td>N+4</td>
<td>Bytes array.The first 4 bytes of chunk are the big endian-encoded length (N) of the array</td>
</tr>
</tbody>
</table>
<p>A “msg” can have one or more chunks, and different “msg”s are made up by different chunks .</p>
<p>The “msg” types uses by this sample are “recv” and “send”.</p>
<ul>
<li>
<p>recv<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/msgrecv.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/msgrecv-1.PNG" class="kg-image"></a></p>
</li>
<li>
<p>send<br>
<a href="https://blog.netlab.360.com/content/images/2019/06/msgsend.PNG"><img src="https://blog.netlab.360.com/content/images/2019/06/msgsend-1.PNG" class="kg-image"></a></p>
</li>
</ul>
<p>See the table below for a summary of different “msg”s:</p>
<table>
<thead>
<tr>
<th>msgcode</th>
<th>Driection</th>
<th>Description</th>
<th>Fromat</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x1010</td>
<td>recv</td>
<td>set channel id</td>
<td>3 chunks:(QWORD ConnId, Array IPAddr,WORD Port)</td>
</tr>
<tr>
<td>0x1011</td>
<td>recv</td>
<td>start proxy request</td>
<td>5 chunks:(QWORD RequestId, BYTE reason,BYTE AddrType,Array Addr, WORD port)</td>
</tr>
<tr>
<td>0x1012</td>
<td>recv</td>
<td>close connection</td>
<td>1 chunk:(QWORD ConnId)</td>
</tr>
<tr>
<td>0x10</td>
<td>send</td>
<td>check-in</td>
<td>1 chunk:(QWORD BotId)</td>
</tr>
<tr>
<td>0x11</td>
<td>send</td>
<td>set-channel ack</td>
<td>1 chunk:(DWORD VersionId)</td>
</tr>
<tr>
<td>0x14</td>
<td>send</td>
<td>tcp server started</td>
<td>5 chunks:(DWORD ConnectionId, QWORD RequestId, BYTE AddrType, Array Addr, WORD Port)</td>
</tr>
<tr>
<td>0x15</td>
<td>send</td>
<td>error</td>
<td>2 chunks:(DWORD RequestId,BYTE reason )</td>
</tr>
<tr>
<td>0x16</td>
<td>send</td>
<td>udp server started</td>
<td>5 chunks:(DWORD ConnectionId, QWORD RequestId, BYTE AddrType, Array Addr, WORD Port)</td>
</tr>
</tbody>
</table>
<h6 id="sentpacketssampleanalysis">Sent packets sample analysis</h6>
<ul>
<li>
<p>Raw data</p>
<pre><code> packet[0:31]:
 6c 52 8c 08 3e 80 a9 3c 00 00 00 10 00 10 fa 51 
 04 dd b0 b4 9d 10 ec 42 c3 00 00 00 00 00 00 00
 header		---&gt;packet[0:15]
 	xorkey		---&gt;0x088c526c
 	msgcrc32	---&gt;0x3e80a93c
 	msglen		---&gt;0x00000010
 	msgcode		---&gt;0x0010,check-in 
 	magic		---&gt;0xfa51
 msg		---&gt;packet[16:31]
 	1st chunk
 		chunktype	---&gt;0x4
 		content		---&gt;0xddb0b49d10ec42c3
 
</code></pre>
</li>
<li>
<p>After XOR encryption</p>
<pre><code>6c 52 8c 08 36 0c fb 50 08 8c 52 7c 08 9c a8 3d 
0c 51 e2 d8 95 9c be 2e cb 8c 52 6c 08 8c 52 6c
</code></pre>
</li>
<li>
<p>After AES encryption</p>
<pre><code>c1 d3 78 71 2d f6 5b bb  16 ca ff 8b ef 69 bb 26
3b 01 f0 22 70 09 38 dc  e7 06 89 de 2b 55 eb 8e
</code></pre>
</li>
</ul>
<h6 id="receivedpacketssampleanalysis">Received packets sample analysis</h6>
<ul>
<li>
<p>Raw data</p>
<pre><code>c5 ad 4a bf 30 C2 3a 43 9b 6e 22 08 73 e0 b9 5d 
3c e6 b7 f0 74 76 53 43 3a 79 0e 82 80 1a c3 84 
ba a4 85 05 4a 63 b1 d6 d1 94 ad 53 be 7a 9a 88
</code></pre>
</li>
<li>
<p>After AES decryption</p>
<pre><code>59 8b e5 6d 4a ee bf ef 6d e5 8b 79 7d f5 71 08
69 b8 81 aa 92 ed 65 fb 29 e0 8b 59 6d e1 51 47
19 e1 89 d8 29 e5 8b 59 6d e5 8b 59 6d e5 8b 59
</code></pre>
</li>
<li>
<p>After XOR decryption</p>
<pre><code>  packet[0:47]
    59 8b e5 6d 27 0b 34 b6 00 00 00 20 10 10 fa 51
    04 5d 0a f3 ff 08 ee a2 44 05 00 00 00 04 da 1e
    74 04 02 81 44 00 00 00 00 00 00 00 00 00 00 00

  header		---&gt;packet[0:15]
    xorkey		---&gt;0x6de58b59
    msgcrc32	---&gt;0x270b34b6
    msglen		---&gt;0x00000020
    msgcode		---&gt;0x1010,set channel id
    magic		---&gt;0xfa51

  msg			---&gt;packet[16:47]
    1st chunk
        chunktype	---&gt;0x04
        content		---&gt;0x5d0af3ff08eea244
    2nt chunk
        chunktype	---&gt;0x05
        content		---&gt;len:0x00000004 buf:0xda1e7404
    3rd chunk
        chunktype	---&gt;0x02
        content		---&gt;0x8144
</code></pre>
</li>
</ul>
<h3 id="stage2c2associationanalysis">Stage-2 C2 association analysis</h3>
<p>We obtained the following 6 Stage-2 C2 addresses by visiting the Stage-1 C2 URL (<a href="http://185.244.149.73:443/min.js?ref=blog.netlab.360.com">http://185.244.149.73:443/min.js</a>).</p>
<pre><code>5.135.58.119
5.135.58.121
5.135.58.123
5.135.58.124
91.134.157.11
193.70.73.115
</code></pre>
<p>We looked up this md5 (9017804333c820e3b4249130fc989e00) in our GraphicQuery platform and was able to find more IPs which host the same file, we then sent specific crafted packets to these IPs and was able to ID another 18 Stage-2 C2s.</p>
<pre><code>5.135.35.160
5.196.194.209
51.254.57.83
54.36.244.84
54.36.244.85
54.36.244.91
91.121.36.212
91.121.236.219
92.222.151.63
145.239.108.241
163.172.201.184
163.172.202.116
178.33.101.176
178.33.101.177
178.33.101.178
178.33.101.182
188.165.5.123
188.165.163.20
</code></pre>
<p>We found that these Stage-2 C2 IP address are providing Socks5 proxy service by looking them up on free-socks.in</p>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/free-proxy.png"><img src="https://blog.netlab.360.com/content/images/2019/06/free-proxy.png" class="kg-image"></a></p>
<p>As we tested, all these Socks5 proxy IPs are properly functioning. Also, they accessed the C2 domain we own(enutofish-pronadimoful-multihitision.org)  via the Stage-1 C2 protocol, so it can be said that they are all Linux.Ngioweb Bots.</p>
<pre><code class="language-bash">root@localhost:~# curl --socks5 91.134.157.11:50880 ifconfig.me
31.170.123.49

root@localhost:~# curl --socks5 91.134.157.11:62012 ifconfig.me
208.113.197.88

root@localhost:~# curl --socks5 91.134.157.11:18278 ifconfig.me
45.58.190.100

root@localhost:~# curl --socks5 91.134.157.11:64380 ifconfig.me
72.29.64.29

root@localhost:~# curl --socks5 91.134.157.11:47067 ifconfig.me
54.38.101.17

root@localhost:~# curl --socks5 91.134.157.11:63862 ifconfig.me
88.99.212.97

root@localhost:~# curl --socks5 91.134.157.11:49475 ifconfig.me
23.91.65.240
</code></pre>
<h3 id="infectedipsinformation">Infected IPs information</h3>
<p>By listening on C2 domain (enutofish-pronadimoful-multihitision.org), we have observed a total of 2692 Bot IPs.</p>
<p><a href="https://blog.netlab.360.com/content/images/2019/06/bot.png"><img src="https://blog.netlab.360.com/content/images/2019/06/bot.png" class="kg-image"></a></p>
<p>The following is a detailed list of countries/regions with number of infected IPs:</p>
<pre><code>US 1306
BR 156
RU 152
DE 133
FR 102
SG 98
NL 80
GB 66
CA 66
IT 64
VN 42
AU 36
PL 31
TR 28
JP 26
IN 26
ZA 21
ID 19
ES 18
UA 15
</code></pre>
<p>By probing the infected IPs, we found out that almost all Bot IPs are web servers and have WordPress programs deployed. We did not look into how the attacker took control of these WordPress sites though.</p>
<p>We contacted some infected users and found multiple WebShells on their Web servers.<br>
These WebShells are highly obscured, but the techniques, encryption, and code share similar characters.<br>
Combined with the accessing characteristics (such as time, order) the infected IPs made to the our sinkhole DGA domain, we speculate that the attacker will periodically issue commands to the WebShells on the victim websites, as well as running the Linux.Ngioweb program.</p>
<h3 id="solutionsandsuggestions">Solutions and Suggestions</h3>
<p>We recommend that readers do not use the Socks5 proxy service provided by these Stage-2 C2 IP.</p>
<p>We recommend that WordPress users back up the website article database (delete backdoor users such as wp.service.controller.*), reinstall the latest version of WordPress program, enhance user password complexity, enhance WebShell detection capabilities, and disable PHP commands to execute related functions;</p>
<h4 id="contactus">Contact us</h4>
<p>Relevant security and law enforcement agencies are welcomed to contact netlab[at]360.cn for a list of infected IP addresses.</p>
<p>Readers are always welcomed to reach us on <a href="https://twitter.com/360Netlab?ref=blog.netlab.360.com"><strong>twitter</strong></a>, WeChat 360Netlab or email to netlab at 360 dot cn.</p>
<h4 id="ioclist">IoC list</h4>
<p>Sample MD5</p>
<pre><code>827ecf99001fa66de513fe5281ce064d
</code></pre>
<p>Stage-1 C2 (Hardcoded IP)</p>
<pre><code>169.239.128.166     	South Africa        	ASN 61138           	Zappie Host LLC
185.244.149.73      	Romania             	ASN 60117           	Host Sailor Ltd.
</code></pre>
<p>Stage-2 C2</p>
<pre><code>163.172.201.184     	France              	ASN 12876           	Online S.a.s.
163.172.202.116     	France              	ASN 12876           	Online S.a.s.
5.135.35.160        	France              	ASN 16276           	OVH SAS
5.135.58.119        	France              	ASN 16276           	OVH SAS
5.135.58.121        	France              	ASN 16276           	OVH SAS
5.135.58.123        	France              	ASN 16276           	OVH SAS
5.135.58.124        	France              	ASN 16276           	OVH SAS
5.196.194.209       	France              	ASN 16276           	OVH SAS
51.254.57.83        	France              	ASN 16276           	OVH SAS
54.36.244.84        	France              	ASN 16276           	OVH SAS
54.36.244.85        	France              	ASN 16276           	OVH SAS
54.36.244.91        	France              	ASN 16276           	OVH SAS
91.121.36.212       	France              	ASN 16276           	OVH SAS
91.121.236.219      	France              	ASN 16276           	OVH SAS
91.134.157.11       	France              	ASN 16276           	OVH SAS
92.222.151.63       	France              	ASN 16276           	OVH SAS
145.239.108.241     	Germany             	ASN 16276           	OVH SAS
178.33.101.176      	Ireland             	ASN 16276           	OVH SAS
178.33.101.177      	Ireland             	ASN 16276           	OVH SAS
178.33.101.178      	Ireland             	ASN 16276           	OVH SAS
178.33.101.182      	Ireland             	ASN 16276           	OVH SAS
188.165.5.123       	Ireland             	ASN 16276           	OVH SAS
188.165.163.20      	France              	ASN 16276           	OVH SAS
193.70.73.115       	France              	ASN 16276           	OVH SAS
</code></pre>
<p>Stage-1 C2 (DGA)</p>
<pre><code>enutofish-pronadimoful-multihitision.org
exaraxexese-macrobacaward-exafosuness.net
nonafudazage.name
demigelike.net
emuvufehood.net
subolukobese.biz
inogepicor-prorarurument.biz
overahudulize-unazibezize-overuzozerish.org
imunolance-postodinenetn-antifipuketn.net
antizerolant-monogevudom.info
transavecaful-transinenation-transikaduhern.com
subogonance.info
inoxodusor-misehupukism.info
devikoviward-semibazegily-copaxugage.name
eniguzeless-inecimanable.net
subilebesion-irogipate.biz
colozosion-antigobunaful.name
inudiduty-dezaviness.org
irelizaring-enipulical-monovuxehossion.info
ilenudavous-monoxoxapal-semimihupution.info
ultrapadupize.biz
covategal-dezakedify-enebugassion.name
transivesudom-macropimuship.org
rezolezation-transapupirify-seminecation.name
macrolutoxous-overefimety.name
coxumumage-dexolalite.name
cotexafical-postirutuvian-emimimous.biz
copubuloness-misumusal-disokozian.com
nonecuzuking-enekopofen-imakozity.info
dezohipal-ultrazebebive.name
cosazalike-antifoxirer-subudikic.biz
underotutilism-monoceraretion-underosociful.name
overugiror.net
emuzixucize.biz
disicevament-desizigasion-recadihuful.biz
decehoward-microhikodely-overokerezant.com
microlasokadom-ultralarumous.info
minixecision-iruzaxuhood.net
profusonuty.info
multifipakency-conovofy-prorakikate.com
antiseramoment.info
postavutetn-emedarevous.biz
inolugoty-inidiverible.com
prodipamament.biz
overogobity-imivocurify-disovizution.biz
decozaness-antihazation-overetalovical.net
nonesolafy.com
unihatosancy.name
interiragocern-micropuxotion-transogorion.org
seminamatity-enogibely.name
inosebovion.net
exofifure-postirexument.info
transirirenern-semizafunic-nonivubed.biz
enegizize-microtizobity.name
macrohuseded-multipazaseship.com
imefihured-macrohixuhood.org
microlulition-macrokiguxable.biz
multizesumefy-emebefion.biz
underebelassion-postizoziless.info
dezuvazen.name
decotusion-exexavihood-exevozebant.name
disuzepuly.info
inuviging-antizoluly.biz
multisotiren-ilazufist.org
predepussion.info
inidozadom.name
interikuhaful.info
cozuheming.biz
multiruxuth.org
monozogeced.org
mononoredom.info
postarubixage-monocinamety-overogefesal.com
prebekokian-misadepepive-transilogify.com
monohatodom-cohotiship.com
exebasusion.org
unahodoness-emevuzeward-emuzeduness.com
exemidexous-underiposapite-unegatature.name
interocugopist-misugexadic-ilobipegency.org
monokifomancy-misagefism-macrobepoth.com
antizekussion-minipusaral-copofuxoship.com
relutodom-comakitize.name
multikezusion.org
emopumical-enohecical.org
semitegopish.net
recepatission.info
inoluvary.com
seminitotuful.info
interanubing-emelulotal-transugotuzern.com
subefehity-iledutession.name
ultrapapiten.biz
transuvarusish-prozumoxety.info
transisigern.org
imirotiship-microhopulive-emotomeship.com
presefavution.info
enevifaking.org
misidogive-coxecovor-dexefoxan.name
overazadudom-deliromohood.com
emakanuward.com
emitohage-overasuhorure-antitipenoless.info
ultrasesebible.biz
multihadekite.name
iluvused-iravoxish.info
postobagoly-detovaward-unixohible.biz
underasusogen.com
imovaman-multimihivoship-imeduxian.biz
dedunuguhood.com
prevukition.info
underehugavish.org
misoxomelical-iluxubism.net
microcolacoful-postabitition.name
overurohely-overadolure-iruraluness.org
unurodable-dekipuhic-postuxufous.org
unitucihern-postadagen-imupuduth.org
imukokuship.org
prenubocetion-ultrahahohood.com
monofugition-underefogukic.org
irofetufy.com
irobigelike.org
presifament.biz
overetigution.info
enuvopan-imixesoward-irarupipary.biz
inorofizian.com
monopadecotion-multicecihood-imuzicasion.com
exofosehance-minimezazofy.org
monokacofudom-inuvinable.com
emisucosion-prohosexite-imorekusion.net
semiledoduly.info
multivapufy-promumuly-enonuben.net
subebodency.info
cofexasish-inodehed.net
unutexupify-conofubusion.com
misebonure-iluborize-rezericify.com
exunaxian.info
colanizity-postosecive-nonuresible.info
dedaliward-imipusen-inacaliver.com
refusovize.org
monokuvission-transodigical-semihehamussion.biz
transalavudom-multilavezuhood.net
exusizeward.net
unisimor.name
minipihagaship.com
recusigetion-transubeviful.info
multixizitufy-microtomuly-multixoleward.com
microxulodish-semibahoty.biz
macrokunith-proxobivive.net
preginaxodom.name
transimapeful-cotalision.com
prefinazuly.name
inucasazing-microhesunian-semidikokement.biz
disitirotion-transekarenate.org
unehihify-antimepavable-nonubovafy.net
misunotelike-nonugidant.info
enogosudom-macrogekabive.biz
postozokipetn-microdomobaly.biz
interunavission-ininibecist.org
microhinoler.org
prosihamish-noneguhaness.com
preberekous-microkagibant-imemahal.name
iletegifage.org
emikuraran.biz
overokigoty-ilecavish.net
nonikofucable-postelihuzism-rexecigism.net
imixifure.info
minirabupeness-nonitefuward.org
misasugegify-underazosuzish-exuvexezical.info
multipocihood-monomuhunible.org
nonohacutancy-postuxikitan-microseditoless.info
overasobament.info
overulurotion.biz
disepadely-disuzirovor.net
repetepian-irelucify.biz
enikobadom-postolixement.name
inunatogite-imoboraness.net
irimarefy.net
monohiloless-demodefy.com
previbetian-misunohigate.info
multivunuhance-inabiber.com
semicasinaty-ilibaholy.biz
transupovetn-monozeruduless.biz
debapesetn-underisaxufical-imukugamism.info
multibibetefy.com
exanonish.name
interanulish-imazekalike-unisukugate.info
inokevidage.org
monofipuly-underubihal.net
profobekify-subebobefy-exozufous.name
macrovetecuship-emebudemical-underaxakament.biz
demeficiward-retitisily-macromuvaward.org
monosumuly-ilenusuty-dedabaness.net
exapofaran-postulusadify.com
microhobament-postevofafity.com
rebezusaly-overidirity-ultrahiseness.org
unafacigage-transihicical-prebokity.info
interazution-irudegufy-antinefoly.biz
minizecidish-macrolafukish-depovased.biz
derirepous-cosideship-semibiseless.biz
overupazadity-irativorical.name
coseviness-nonikunant-macrorasihood.net
nonesocern-macrotocipity.info
interuzoputy.info
inicinic-misuluzan-ultrakuxuness.com
sububesebism-ultrabutath.com
misacireship.org
exuxuburan-miniravuhood-exosoxen.info
macrozigahood-monosulopancy.com
unegoping-detunusion-antimuruseful.biz
macrozixaward-semivanimoly-underekutoty.biz
ultratipuxian-inosilission-multiridith.net
microtonagament.info
cobemesion-redacocoful.name
disicogure-seminedasoly.biz
dekacify.net
emegamilike-imupogazance-ultrapanacesion.org
unocelibable-underelatucance.com
irodetolike-imisocatite-inecolafian.com
antikuzucen-irokarance-transitupikible.org
semiralety-macrorobinant-ultrapixutency.biz
transisomuless.name
ilebigument-macroripakesion.org
profebarable.org
nonixigefy-protisumiless.biz
corahicohood.com
pretuvution-disafatutical-irehopuvese.name
miniregath-anticesuty-postudagily.biz
coguvilaship-recakubodom.name
overipugoful-interizihing.org
imipadaness-iralikoward-semitolicoly.info
interupefity-semigiduly.info
macromosoriship.net
antigizepist.net
subuluhic-disomokate.net
irunucudor-macrogocudern-comoxizish.name
underedofobate.net
prolapuzern-progobutiful-dehifasion.org
irucasian-macrofevasion.net
unogoxeness-semixocapency.org
rehofocese.org
exebutian-interomifenism.org
subihefahood-subenopure-ultramoherihood.net
nonezogeward.com
exasavate-minidevilefy-subanevous.biz
enodenission-overucelancy-microvitasission.info
ultrafakitesion-misesuzahical-transanafetion.biz
interinipoly-minimorovor-debininess.com
prenedelission-interugefable-repekosossion.name
postifozible-irololuship.com
unozolasion.org
unobelaness-prepifavety.info
cofukosable.info
iloletible-imakeben.info
ultraronupity.name
minikisision-monobavunism-micronepavage.org
unufepaness-misedepugance.biz
inafolage.com
semifolofic-unaraxal.biz
enerivosism-imenufanist-macrovonahood.org
monobocution.info
cosuzuness-prepurizor-unasulal.name
inopivic-antimaporary-subavocobive.biz
covogidish-iletinassion.biz
defizalike-unodatage-inarabevous.com
unuvirisern-interusalosize-misucakiness.org
ireninenish-multicemath-prezucetussion.biz
interodekive.com
iramilahood-antirotuxary-misobegesion.name
multidafadite-postagoker.org
monobagehance.net
emixuvidite-ilofikency-subolubify.biz
postugihucency-emademify.name
cotefehood-imocakitency.biz
enikavely-inosifuty-postaviraly.info
transabusossion.biz
interitebure.net
unehumugage-ultraburosion.com
subutavahen-inuhabish.org
subifefer-devufoward-probelalance.org
emefimafible.biz
ilibefudom.biz
postemivaxage.net
monofudumossion.info
inuxazodom-macrodexaxahood.org
semibugegetn-monohifutuly.biz
macromohazaship-subonohion-disonixucing.com
emosacekant-cokebohood-nonetakive.biz
interozecifist-antipinukity-multifekemath.net
refedomous-antifaliless.name
ultraxekevohood-nonizerosion-exovigant.name
interarogous-unuculuhood.org
semipulimian.com
monocalacaless.biz
disevolikency-retipegation.biz
cosituxath-misuxunor.info
ultraporader-conapefy-prolobeziless.info
ilucasure.com
reletohite-misosulahood-antitedudom.info
minivucilous-inafafomism.net
monorifutaless-ilocamussion.name
inohufohese-imufilahood-antifidupite.com
emegemaxed-transigifuty-multitumolith.net
exotacible-denitokolike.com
</code></pre>
<!--kg-card-end: markdown-->
      </section>



      <div id="disqus_thread" class="disqus-comments gh-canvas"></div>
      <script>
        var disqus_config = function () {
          this.page.url = "https://blog.netlab.360.com/an-analysis-of-linux-ngioweb-botnet-en/";
          this.page.identifier = "ghost-5d0ca0070bbc140007c57b8e"
        };
        (function () {
          var d = document, s = d.createElement('script');
          s.src = 'https://blog-netlab-360.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    </article>

  </main>


    <aside class="read-more-wrap outer">
      <div class="inner">
        <div class="read-more-feed">
            <article class="read-more-card" 
                  style="background-image: url(/content/images/2019/02/astronomy-constellation-dark-998641-4.jpg)" 
              >
              <header class="read-more-card-header">
                <small class="read-more-card-header-sitetitle">&mdash; 360 Netlab Blog - Network Security Research Lab at 360 &mdash;</small>
                <h3 class="read-more-card-header-title"><a href="/tag/botnet/">Botnet</a></h3>
              </header>
              <div class="read-more-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
              <div class="read-more-card-content">
                <ul>
                  <li><a href="/911s5/">僵尸网络911 S5的数字遗产</a></li>
                  <li><a href="/headsup_xdr33_variant_of_ciahive_emeerges/">Heads up! Xdr33, A Variant Of CIA’s HIVE  Attack Kit Emerges</a></li>
                  <li><a href="/warning-hive-variant-xdr33-is-coming_cn/">警惕：魔改后的CIA攻击套件Hive进入黑灰产领域</a></li>
                </ul>
              </div>
              <footer class="read-more-card-footer">
                <a href="/tag/botnet/">See all 114 posts →</a>
              </footer>
            </article>

          
<article class="post-card post tag-honeypot tag-import-2022-11-30-11-16 no-image">


  <div class="post-card-content">

    <a class="post-card-content-link" href="/an-analysis-of-linux-ngioweb-botnet/">
      <header class="post-card-header">
        <div class="post-card-tags">
          <span class="post-card-primary-tag">honeypot</span>
        </div>
        <h2 class="post-card-title">
          Linux.Ngioweb分析报告
        </h2>
      </header>
      <div class="post-card-excerpt">背景介绍


2019年5月27号，360Netlab 未知威胁检测系统发现一个可疑的ELF文件，目前仅有一款杀毒引擎检测识别。通过详细分析，我们确定这是一款Proxy Botnet，并且是Win32.Ngioweb[1]恶意软件的Linux版本变种，我们将它命名为Linux.Ngioweb。它与Win32.Ngioweb共用了大量代码，不同的是它新增了DGA特性。我们注册了其中一个DGA C2域名(enutofish-pronadimoful-multihitision.org)，并对它进行Sinkhole处理以此来观察Bot连接情况。


此外，我们还观察到大量部署WordPress的Web服务器被植入Linux.Ngioweb 恶意软件。尽管Bot程序由Web容器对应的用户组运行并且权限很小但还是能够正常工作，并被充当Rotating Reverse Proxy[2]节点。


目前，我们还没有看清楚Linux.Ngioweb攻击者的目的，但我们猜测他可能会监听代理网络流量。



Linux.Ngioweb概览


Linux.Ngioweb Bot样本的主要功能是在受害者的机</div>
    </a>

    <footer class="post-card-meta">
      <ul class="author-list">
        <li class="author-list-item">
          <div class="author-name-tooltip">
            Alex.Turing
          </div>

          <a href="/author/alex/" class="static-avatar">
            <img class="author-profile-image" src="/content/images/2019/06/turing.PNG" alt="Alex.Turing" />
          </a>
        </li>
        <li class="author-list-item">
          <div class="author-name-tooltip">
            Genshen Ye
          </div>

          <a href="/author/yegenshen/" class="static-avatar">
            <img class="author-profile-image" src="/content/images/2017/10/1662072805.jpg" alt="Genshen Ye" />
          </a>
        </li>
      </ul>
      <time class="post-card-meta-date" datetime=" 2019-06-21">Jun 21, 2019</time>
      <span class="post-card-meta-length">15 min read</span>
    </footer>

  </div>

</article>
          
<article class="post-card post tag-dnsmon tag-en tag-data-leakage tag-import-2022-11-30-11-16">

  <a class="post-card-image-link" href="/ongoing-credit-card-data-leak-continues/">

    <img class="post-card-image" srcset="/content/images/2019/05/credit.title-1.jpeg 300w, /content/images/size/w600/2019/05/credit.title-1.jpeg
      600w, /content/images/size/w1000/2019/05/credit.title-1.jpeg 1000w, /content/images/size/w2000/2019/05/credit.title-1.jpeg 2000w"
      sizes="(max-width: 1000px) 400px, 800px" src="/content/images/2019/05/credit.title-1.jpeg"
      alt="Ongoing Credit Card Data Leak [Continues]" loading="lazy" />


  </a>

  <div class="post-card-content">

    <a class="post-card-content-link" href="/ongoing-credit-card-data-leak-continues/">
      <header class="post-card-header">
        <div class="post-card-tags">
          <span class="post-card-primary-tag">DNSMon</span>
        </div>
        <h2 class="post-card-title">
          Ongoing Credit Card Data Leak [Continues]
        </h2>
      </header>
      <div class="post-card-excerpt">DNSMon is a network-wide DNS malicious domain analysis system we build here at 360Netlab. With the 10%+ total DNS traffic coverage in China, plus the other multi-dimensional security data and security analysis capabilities we have accumulated over the years, we can &quot;see&quot; what is happening in the whole</div>
    </a>

    <footer class="post-card-meta">
      <ul class="author-list">
        <li class="author-list-item">
          <div class="author-name-tooltip">
            YANG XU
          </div>

          <a href="/author/xuy1202/" class="static-avatar">
            <img class="author-profile-image" src="/content/images/2019/04/head.jpg" alt="YANG XU" />
          </a>
        </li>
        <li class="author-list-item">
          <div class="author-name-tooltip">
            ba0jy
          </div>

          <a href="/author/ba0jy/" class="static-avatar">
            <img class="author-profile-image" src="/content/images/2019/04/----_20190426104845.jpg" alt="ba0jy" />
          </a>
        </li>
      </ul>
      <time class="post-card-meta-date" datetime=" 2019-05-14">May 14, 2019</time>
      <span class="post-card-meta-length">3 min read</span>
    </footer>

  </div>

</article>
        </div>
      </div>
    </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://blog.netlab.360.com">360 Netlab Blog - Network Security Research Lab at 360</a> &copy; 2024</section>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=42b57cac00"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();

    // floating-header
    // Start fitVids
      var $postContent = $(".gh-content");
      $postContent.fitVids();
      // End fitVids

      var progressBar = document.querySelector('#reading-progress');
      var header = document.querySelector('.floating-header');
      var title = document.querySelector('.article-title');

      var lastScrollY = window.scrollY;
      var lastWindowHeight = window.innerHeight;
      var lastDocumentHeight = $(document).height();
      var ticking = false;

      function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
      }

      function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
      }

      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(update);
        }
        ticking = true;
      }

      function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
          header.classList.add('floating-active');
        } else {
          header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
      }

      window.addEventListener('scroll', onScroll, { passive: true });
      window.addEventListener('resize', onResize, false);

      update();
});
</script>



</body>
</html>
