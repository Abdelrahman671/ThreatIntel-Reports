<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>BlackSuit Ransomware &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="bdd5951e1d0317a7b0650ce4-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/37582" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=37582' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F08%2F26%2Fblacksuit-ransomware%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F08%2F26%2Fblacksuit-ransomware%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="bdd5951e1d0317a7b0650ce4-text/javascript"></script>
		<script type="bdd5951e1d0317a7b0650ce4-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="bdd5951e1d0317a7b0650ce4-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=CD27BFBB4CF78BBFD39062B51EC2DA2E');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="BlackSuit Ransomware" />
<meta property="og:url" content="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/" />
<meta property="og:description" content="Key Takeaways In December 2023, we observed an intrusion that started with the execution of a Cobalt Strike beacon and ended in the deployment of BlackSuit ransomware. The threat actor leveraged va…" />
<meta property="article:published_time" content="2024-08-26T00:30:32+00:00" />
<meta property="article:modified_time" content="2024-08-27T12:18:08+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2024/08/26364_048.png" />
<meta property="og:image:width" content="1614" />
<meta property="og:image:height" content="1080" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="BlackSuit Ransomware" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2024/08/26364_048.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-37582 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Friday, October 25, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-37582" class="post-37582 post type-post status-publish format-standard hentry category-adfind category-blacksuit category-cobaltstrike category-ransomware entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
		
			<a class="category-color-133" href="https://thedfirreport.com/category/blacksuit/">blacksuit</a>
		
			<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
		
			<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">BlackSuit Ransomware</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/" rel="bookmark"><time class="entry-date published" datetime="2024-08-26T00:30:32+00:00">August 26, 2024</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 id="key" class="wp-block-heading"><a href="#key">Key Takeaways</a></h2>
<ul>
<li>In December 2023, we observed an intrusion that started with the execution of a Cobalt Strike beacon and ended in the deployment of BlackSuit ransomware.</li>
<li>The threat actor leveraged various tools, including Sharphound, Rubeus, SystemBC, Get-DataInfo.ps1, Cobalt Strike, and ADFind, along with built-in system tools.</li>
<li>Command and control traffic was proxied through CloudFlare to conceal their Cobalt Strike server.</li>
<li><span class="ql-comment" data-comment-ids="90130064953559" data-comment-unresolved-ids="">Fifteen days after initial access, BlackSuit ransomware was deployed by copying files over SMB to admin shares and executing them through RDP sessions.</span></li>
<li><span class="ql-comment ql-comment_active ql-comment_overlap" data-comment-ids="90130064937294" data-comment-unresolved-ids="90130064937294">Three rules were added to our private ruleset related to this case.</span></li>
</ul>



<p>An audio version of this report can be found on <a href="https://podcasters.spotify.com/pod/show/the-dfir-report/" target="_blank" rel="noreferrer noopener">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/reports/id1728699064" target="_blank" rel="noreferrer noopener">Apple</a>, <a href="https://www.youtube.com/@TheDFIRReport/videos" target="_blank" rel="noreferrer noopener">YouTube</a>, <a href="https://www.audible.com/pd/Reports-Podcast/B0CSZBRCFX?action_code=ASSGB149080119000H&amp;share_location=pdp" target="_blank" rel="noreferrer noopener">Audible</a>, &amp; <a href="https://music.amazon.com/podcasts/c4fe897d-a4b4-4ceb-908d-d1a78af8cb6d/reports" target="_blank" rel="noreferrer noopener">Amazon</a>. </p>



<h2 id="services" class="wp-block-heading"><a href="#services">The DFIR Report Services</a></h2>



<ul class="wp-block-list">
<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>: Over 20 private DFIR reports annually.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>: Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>: Includes everything from Private Threat Briefs and Threat Feed, plus private events, opendir reports, long-term tracking, data clustering, and other curated intel.</li>



<li><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>: Features 100+ Sigma rules derived from 40+ cases, mapped to ATT&amp;CK with test examples.</li>



<li><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>: Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>



<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noreferrer noopener">Contact us</a> today for pricing or a demo!</p>

<h4>Table of Contents:</h4>
<ul>
<li><a href="#case-summary">Case Summary</a></li>
<li><a href="#services">Services</a></li>
<li><a href="#analysts">Analysts</a></li>
<li><a href="#initial-access">Initial Access</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#persistence">Persistence</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#defense-evasion">Defense Evasion</a></li>
<li><a href="#credential-access">Credential Access</a></li>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#lateral-movement">Lateral Movement</a></li>
<li><a href="#collection">Collection</a></li>
<li><a href="#command-and-control">Command and Control</a></li>
<li><a href="#exfiltration">Exfiltration</a></li>
<li><a href="#impact">Impact</a></li>
<li><a href="#timeline">Timeline</a></li>
<li><a href="#diamond-model">Diamond Model</a></li>
<li><a href="#indicators">Indicators</a></li>
<li><a href="#detections">Detections</a></li>
<li><a href="#mitre">MITRE ATT&amp;CK</a></li>
</ul>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The intrusion began in December 2023, with the initial sign being the execution of an unusually large-sized Cobalt Strike beacon. After the beacon&#8217;s execution, there was no immediate follow-up activity. The initial access delivery method for the intrusion remains unclear, as there was no evidence available. The Cobalt Strike C2 traffic beaconed to IP addresses managed by CloudFlare, which acted as proxy server between the victim network and their team server.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Approximately six hours after the initial execution, the threat actor used Windows utilities, such as systeminfo and nltest to perform enumeration on the system and environment. After, they conducted AS-REP Roasting and Kerberoasting attacks against two of the domain controllers, utilizing Rubeus, which was executed in memory via Cobalt Strike. Following this, the threat actor ran Sharphound in memory through the Cobalt Strike beacon, and saved the output to disk.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Around ten minutes after the initial discovery, the threat actor carried out their first lateral movement. They transferred a Cobalt Strike beacon via SMB and executed it through a service to compromise another workstation. On that workstation, they accessed LSASS to obtain credentials from memory. Throughout the second day of the intrusion, the threat actor deployed multiple Cobalt Strike beacons on workstations and servers and also used RDP for further lateral movement.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The threat actor deployed multiple SystemBC executables on one of the file servers. The second executable, established persistence through a registry run key and opened a new command and control channel. After a busy second day of activity, the intrusion went silent. On the seventh day, the Cobalt Strike command and control domain stopped using CloudFlare and switched to an Amazon AWS IP address, for the remainder of the intrusion.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On the eighth day, the threat actors deployed a new PowerShell Cobalt Strike beacon on a domain controller, this time pointing to a separate command and control server. After two days of inactivity, the intrusion resumed with more Cobalt Strike beacons being distributed, along with several RDP logins. More discovery activity was noticed when Sharphound was executed again. The threat actor attempted multiple times to run ADFind but failed in each instance.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Five days later, the threat actor returned to finalize their objectives. This time, ADFind was executed successfully, followed by the execution of the PowerShell script Get-DataInfo.ps1. The final step was the deployment of the BlackSuit ransomware binary, qwe.exe, which was distributed via SMB to remote systems through the C$ share. The attacker then manually connected to these systems using RDP to execute the ransomware. Upon execution, the ransomware used vssadmin to delete shadow copies before encrypting the hosts. The Time to Ransomware (TTR) was just under 328 hours, spanning 15 calendar days, with files being encrypted and the BlackSuit ransom note left on desktops and folders across the systems.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you would like to get an email when we publish a new report, please subscribe <a href="https://thedfirreport.com/subscribe/" target="_blank" rel="noreferrer noopener">here</a>. Follow us on <a href="https://www.linkedin.com/in/the-dfir-report" target="_blank" rel="noopener">LinkedIn</a> for additional insights and notifications!</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="analysts" class="wp-block-heading"><a href="#analysts">Analysts</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Analysis and reporting completed by <a href="https://twitter.com/MetallicHack" target="_blank" rel="noreferrer noopener">@MetallicHack</a>, <a href="https://twitter.com/yatinwad" target="_blank" rel="noreferrer noopener">@yatinwad</a>, and <a href="https://twitter.com/malforsec" target="_blank" rel="noreferrer noopener">@malforsec</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The earliest sign of the threat actor&#8217;s presence was the execution of a Cobalt Strike beacon, identified as RtWin64.exe. Despite thorough investigation, the initial access point for the beacon&#8217;s deployment could not be determined.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_001.png"><img decoding="async" class="aligncenter size-full wp-image-37678" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_001.png" alt="" width="330" height="45" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_001.png 330w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_001-300x41.png 300w" sizes="(max-width: 330px) 100vw, 330px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Cobalt Strike PsExec</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Cobalt Strike served as the primary tool utilized by the threat actor, with a particular focus on its capabilities that mimic Sysinternals PsExec. These features, including psexec and psexec_psh, enable remote process execution across systems. The psexec module functions by uploading a binary to the target system, then creating and launching a Windows service to execute the file.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The eventID 7045 in Windows System logs shows the services created on the system:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_002.png"><img decoding="async" class="aligncenter size-full wp-image-37677" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_002.png" alt="" width="315" height="112" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_002.png 315w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_002-300x107.png 300w" sizes="(max-width: 315px) 100vw, 315px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_003.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-37676" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_003.png" alt="" width="605" height="190" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_003.png 605w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_003-300x94.png 300w" sizes="(max-width: 605px) 100vw, 605px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The psexec command spawned a rundll32.exe process.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37675" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_004.png" alt="" width="497" height="150" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_004.png 497w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_004-300x91.png 300w" sizes="(max-width: 497px) 100vw, 497px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37674" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_005.png" alt="" width="215" height="152" /></a></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The psexec_psh module doesn&#8217;t copy a binary to the target, but instead executes a PowerShell one-liner. The pattern it uses is %COMSPEC% /b /c start /b /min powershell -nop -w hidden -encodedcommand &#8230;</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37673" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_006.png" alt="" width="675" height="67" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_006.png 675w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_006-300x30.png 300w" sizes="(max-width: 675px) 100vw, 675px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Registry Run Key</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>To ensure persistent access to the environment, the threat actor created a run key named &#8220;socks5&#8221; within the Current User registry hive. The registry key&#8217;s configuration indicated that PowerShell would be used to launch a SystemBC backdoor named socks32.exe.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 13 (<em>Registry value set</em>) shows changes to a registry key value:</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-37734" src="https://thedfirreport.com/wp-content/uploads/2025/08/123.png" alt="" width="704" height="163" srcset="https://thedfirreport.com/wp-content/uploads/2025/08/123.png 704w, https://thedfirreport.com/wp-content/uploads/2025/08/123-300x69.png 300w" sizes="(max-width: 704px) 100vw, 704px" /></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>One interesting thing to mention is that the registry value name <code>socks5</code> created under the <code>Run</code> key is hard coded.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37671" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_008.png" alt="" width="902" height="85" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_008.png 902w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_008-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_008-768x72.png 768w" sizes="(max-width: 902px) 100vw, 902px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The data is a string (type <code>REG_SZ</code>) which starts with <code>powershell.exe windowstyle -hidden Command</code> concatenated with the current executable name, which is obtained using <code><a href="https://learn.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamea" target="_blank" rel="noreferrer noopener">GetModuleFileNameA</a></code> with a null <code>hModule</code> first parameter.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37670" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_009.png" alt="" width="1007" height="115" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_009.png 1007w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_009-300x34.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_009-768x88.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_009-1000x115.png 1000w" sizes="(max-width: 1007px) 100vw, 1007px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Scheduled Task</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>SystemBC possesses the ability to create scheduled tasks using COM, as demonstrated in the following example. While <a href="https://www.kroll.com/en/insights/publications/cyber/inside-the-systembc-malware-server" target="_blank" rel="noreferrer noopener">other reports</a> have noted SystemBC utilizing this feature, it likely wasn&#8217;t employed in our case, as no evidence of scheduled task creation was observed during our investigation.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37669" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_010.png" alt="" width="1447" height="382" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_010.png 1447w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_010-300x79.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_010-1024x270.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_010-768x203.png 768w" sizes="(max-width: 1447px) 100vw, 1447px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37668" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_011.png" alt="" width="1335" height="195" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_011.png 1335w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_011-300x44.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_011-1024x150.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_011-768x112.png 768w" sizes="(max-width: 1335px) 100vw, 1335px" /></a></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>It first uses the function <code>CoCreateInstance</code> to create an instance of an <code>ITaskScheduler</code> object and then call the method <code>NewWorkItem</code> to create a scheduled task.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="privilege-escalation" class="wp-block-heading"><a href="#privilege-escalation">Privilege Escalation</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>On a workstation that the threat actor moved laterally to, we observed use of named pipes.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37667" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_012.png" alt="" width="390" height="40" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_012.png 390w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_012-300x31.png 300w" sizes="(max-width: 390px) 100vw, 390px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Usually, when observing this behavior from Cobalt Strike, this tends to be usage of the getsystem command to elevate privileges; however, in this case we observed the parent process to not be services.exe and the threat actor was already running as SYSTEM. This activity was seen in correlation to pass-the-hash behavior listed in <a href="#lateral-movement">Lateral Movement</a>. The threat actor changed to the context of a domain administrator and then was observed moving laterally again using Cobalt Strike, so we attribute this activity to pass-the-hash command execution activity rather than getsystem.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Modify Registry</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor employed an encoded PowerShell command to modify the registry, enabling Remote Desktop Protocol (RDP) access to a file server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37666" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_013.png" alt="" width="1927" height="50" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_013.png 1927w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_013-300x8.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_013-1024x27.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_013-768x20.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_013-1536x40.png 1536w" sizes="(max-width: 1927px) 100vw, 1927px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Setting the registry key &#8220;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&#8221; DenyTSConnections to 0 will allow terminal server connections to the host.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Process Injection</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Given the threat actor&#8217;s extensive use of Cobalt Strike beacons, we anticipated the use of process injection as a method of evading detection by hiding within legitimate processes.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Upon analyzing process injections and access patterns from Cobalt Strike-generated processes, we successfully identified the suspicious activity we were searching for.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37665" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_014.png" alt="" width="947" height="590" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_014.png 947w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_014-300x187.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_014-768x478.png 768w" sizes="(max-width: 947px) 100vw, 947px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>These injections can then be confirmed using things like YARA memory scanning:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37664" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_015.png" alt="" width="1500" height="561" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_015.png 1500w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_015-300x112.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_015-1024x383.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_015-768x287.png 768w" sizes="(max-width: 1500px) 100vw, 1500px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor undertook multiple actions to obtain valid credentials, primarily leveraging Rubeus as the key tool. During our investigation, we discovered that Rubeus had been loaded into mstsc.exe—a process previously injected by Cobalt Strike—functioning as a <a href="https://learn.microsoft.com/en-us/dotnet/standard/clr" target="_blank" rel="noreferrer noopener">CLR module</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37663" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_016.png" alt="" width="1637" height="107" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_016.png 1637w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_016-300x20.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_016-1024x67.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_016-768x50.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_016-1536x100.png 1536w" sizes="(max-width: 1637px) 100vw, 1637px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">AS-REP roasting</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/as-rep-roasting-using-rubeus-and-hashcat" target="_blank" rel="noreferrer noopener">AS-REP roasting</a> was the first credential access activity performed by the threat actor. This was done with Rubeus on the beachhead host targeting a domain controller.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Rubeus writing the result of AS-REP roasting output to a file:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37662" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_017.png" alt="" width="447" height="42" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_017.png 447w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_017-300x28.png 300w" sizes="(max-width: 447px) 100vw, 447px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Indications of AS-REP roasting can be found by looking for windows eventID 4768 on the target domain controller. The request is for Authentication tickets(TGT) with &#8220;Pre-Authentication Type&#8221; set to 0, meaning no password is required.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37661" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_018.png" alt="" width="472" height="405" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_018.png 472w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_018-300x257.png 300w" sizes="(max-width: 472px) 100vw, 472px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>A lot of Kerberos Authentication Tickets were requested during AS-REP Roasting:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37660" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_019.png" alt="" width="532" height="665" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_019.png 532w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_019-240x300.png 240w" sizes="(max-width: 532px) 100vw, 532px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Kerberoasting</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor used Rubeus to conduct a Kerberoasting attack. During this period of time, we observed numerous Kerberos ticket requests, specifically using encryption type 0x17, which corresponds to RC4 encryption. These RC4 encryption requests coincided with the execution of Rubeus and targeted multiple accounts across the domain</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Rubeus executed in memory by Cobalt Strike creating kerberoast output:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37659" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_020.png" alt="" width="452" height="45" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_020.png 452w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_020-300x30.png 300w" sizes="(max-width: 452px) 100vw, 452px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>EventID 4769 on a domain controller showing request for tickets with weak encryption:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37658" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_021.png" alt="" width="472" height="315" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_021.png 472w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_021-300x200.png 300w" sizes="(max-width: 472px) 100vw, 472px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">LSASS memory access</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor accessed LSASS memory on a workstation with a specific access request of 0x1010, where 0x0010 is necessary to read memory using ReadProcessMemory. This request originated from a process that had been injected with Cobalt Strike.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 10 shows mstsc.exe accessing lsass with the access mask 0x1010</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37657" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_022.png" alt="" width="552" height="40" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_022.png 552w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_022-300x22.png 300w" sizes="(max-width: 552px) 100vw, 552px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Discovery plays a critical role for the threat actor in assessing the environment they have infiltrated. Throughout the intrusion, the attacker conducted discovery activities across multiple systems, gathering valuable intelligence on the network and its assets.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Hands On Keyboard</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Discovery began on the beachhead host approximately six hours after initial access. The first command executed was &#8220;systeminfo,&#8221; aimed at gathering details about the local system. Shortly after, the command &#8220;nltest /dclist&#8221; was issued to identify the domain controllers within the environment.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 shows evidence of running the commands:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37656" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_023.png" alt="" width="1217" height="65" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_023.png 1217w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_023-300x16.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_023-1024x55.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_023-768x41.png 768w" sizes="(max-width: 1217px) 100vw, 1217px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Sharphound</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Once the threat actor identified the domain controllers, they wasted no time and promptly loaded Sharphound into memory via Cobalt Strike. This allowed them to conduct further discovery activities within the environment, expanding their reconnaissance efforts.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We have some proof showing mstsc.exe loading Sharphound as a CLR(Common Language Runtime) module. mstsc.exe is the child process of Cobalt Strike beacon RtWin64.exe. The below screenshot taken from the EDR telemetry depicts that:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37655" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_024.png" alt="" width="1660" height="90" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_024.png 1660w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_024-300x16.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_024-1024x56.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_024-768x42.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_024-1536x83.png 1536w" sizes="(max-width: 1660px) 100vw, 1660px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Output from Sharphound was stored in &#8220;C:\Windows\Temp\Dogi\&#8221;. The recurring use of this directory aligns with behaviors documented in a different report, <a href="https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/" target="_blank" rel="noreferrer noopener">BazarCall to Conti Ransomware chain</a>. This suggests a potential operational signature or TTP (Tactics, Techniques, and Procedures) common to this threat actor group or its operators. Based on the output files created, `it looks like it was run in default mode as described below.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 11 showing the files created:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37654" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_025.png" alt="" width="820" height="227" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_025.png 820w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_025-300x83.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_025-768x213.png 768w" sizes="(max-width: 820px) 100vw, 820px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Sharphound appeared to be running in its default mode, which involves enumerating local group memberships by querying the Windows Security Accounts Manager (SAM) database remotely through the samr pipe on the target host. This pipe is exposed via the IPC$ share, and corresponding activity can be detected by monitoring Windows security events with event ID 5145. A similar approach is used to discover logged-on users; however, in this case, Sharphound communicates with the srvsvc pipe, utilizing the Server Service Remote Protocol.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Windows eventlog eventID 5145 showing Sharphound enumeration activity:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37653" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_026.png" alt="" width="512" height="60" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_026.png 512w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_026-300x35.png 300w" sizes="(max-width: 512px) 100vw, 512px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>When Sharphound enumerates the Active Directory through LDAP searches, it performs an excess amount of queries.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Example of Sharphound LDAP searches:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">"(|(samaccounttype=268435456)(samaccounttype=268435457)(samaccounttype=536870912)(samaccounttype=536870913))", "(BuildString("(primarygroupid=*)"
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Sharphound executed in memory by Cobalt Strike, performing LDAP queries:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37652" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_027.png" alt="" width="822" height="537" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_027.png 822w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_027-300x196.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_027-768x502.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_027-765x500.png 765w" sizes="(max-width: 822px) 100vw, 822px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37651" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_028.png" alt="" width="1081" height="163" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_028.png 1081w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_028-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_028-1024x154.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_028-768x116.png 768w" sizes="(max-width: 1081px) 100vw, 1081px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Sharphound was initially executed on the beachhead host. Later in the intrusion, the threat actor ran Sharphound two more times, this time on a domain controller. The output from the first run was saved to &#8220;C:\Windows\System32\&#8221;, while the second run&#8217;s results were directed to &#8220;C:\Perflogs\&#8221;.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Again Sysmon eventID 11 caught the files created by Sharphound:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37650" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_029.png" alt="" width="795" height="212" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_029.png 795w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_029-300x80.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_029-768x205.png 768w" sizes="(max-width: 795px) 100vw, 795px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37649" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_030.png" alt="" width="712" height="210" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_030.png 712w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_030-300x88.png 300w" sizes="(max-width: 712px) 100vw, 712px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Windows Security eventID 4799 shows Sharphound performing discovery on local security-enabled groups:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37648" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_031.png" alt="" width="735" height="110" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_031.png 735w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_031-300x45.png 300w" sizes="(max-width: 735px) 100vw, 735px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>More information on how Sharphound functions can be found here:</p>
<!-- /wp:paragraph -->

<!-- wp:embed {"url":"https://blog.compass-security.com/2022/05/bloodhound-inner-workings-part-1"} -->
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://blog.compass-security.com/2022/05/bloodhound-inner-workings-part-1">https://blog.compass-security.com/2022/05/bloodhound-inner-workings-part-1</a></div>
</figure>
<!-- /wp:embed -->

<!-- wp:embed {"url":"https://blog.compass-security.com/2022/05/bloodhound-inner-workings-part-2"} -->
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://blog.compass-security.com/2022/05/bloodhound-inner-workings-part-2">https://blog.compass-security.com/2022/05/bloodhound-inner-workings-part-2</a></div>
<div> </div>
</figure>
<!-- /wp:embed -->

<!-- wp:paragraph -->
<p>More ways to detect LDAP queries generally in this great article here:</p>
<!-- /wp:paragraph -->

<!-- wp:embed {"url":"https://falconforce.nl/falconfriday-detecting-active-directory-data-collection-0xff21"} -->
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://falconforce.nl/falconfriday-detecting-active-directory-data-collection-0xff21">https://falconforce.nl/falconfriday-detecting-active-directory-data-collection-0xff21</a></div>
<div> </div>
</figure>
<!-- /wp:embed -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">ADFind</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>ADFind, a tool frequently used by threat actors, was also employed in this intrusion to conduct enumeration and discovery. After gaining access to the second domain controller, the threat actor created &#8220;ADFind.exe&#8221; and &#8220;adf.bat&#8221; in an attempt to gather further Active Directory information.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 11 showing creation of ADFind.exe and adf.bat by Cobalt Strike:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37647" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_032.png" alt="" width="487" height="67" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_032.png 487w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_032-300x41.png 300w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>A few seconds after creation of the files, the threat actor was eager to collect the desired information and executed <code>adf.bat</code> via <code>cmd.exe</code>:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37646" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_033.png" alt="" width="1165" height="65" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_033.png 1165w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_033-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_033-1024x57.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_033-768x43.png 768w" sizes="(max-width: 1165px) 100vw, 1165px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>No additional commands were observed after each batch file execution. This indicates the operator may have encountered difficulties, as the batch file was executed twice within just over a minute of the initial attempt, suggesting potential issues or missteps during execution.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 11 shows the creation of the files with the output of ADFind:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_034.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37645" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_034.png" alt="" width="537" height="170" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_034.png 537w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_034-300x95.png 300w" sizes="(max-width: 537px) 100vw, 537px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>It&#8217;s possible that the files ended up being empty, causing the threat actor to reconsider their approach. About 15 minutes later, the operator tried running ADFind.exe directly from the command line, likely to verify whether the tool would execute properly.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_035.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37644" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_035.png" alt="" width="977" height="45" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_035.png 977w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_035-300x14.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_035-768x35.png 768w" sizes="(max-width: 977px) 100vw, 977px" /></a></p>
<p><img /> After failing to determine the cause of the issue, the threat actor stayed quiet until the next day. The operator likely made an error by trying to run &#8220;<code>adf.bat</code>&#8221; from &#8220;<code>C:\Windows\System32\</code>&#8221; when both &#8220;adf.bat&#8221; and &#8220;ADFind.exe&#8221; were actually located in &#8220;<code>C:\Perflogs\adf\"</code>. Because of this, &#8220;<code>ADFind.exe</code>&#8221; probably couldn&#8217;t be found as an executable in the wrong directory, leading to the error.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37643" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_036.png" alt="" width="490" height="65" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_036.png 490w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_036-300x40.png 300w" sizes="(max-width: 490px) 100vw, 490px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37642" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_037.png" alt="" width="1165" height="67" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_037.png 1165w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_037-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_037-1024x59.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_037-768x44.png 768w" sizes="(max-width: 1165px) 100vw, 1165px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph --><!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>After several days, the threat actor decided to give ADFind another try. This time, on the file server the operator was successful in running <code>adf.bat</code> correctly to find <code>ADFind.exe</code> and perform the desired discovery activity:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 showing threat actor running adf.bat:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37641" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_038.png" alt="" width="1015" height="42" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_038.png 1015w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_038-300x12.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_038-768x32.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_038-1000x42.png 1000w" sizes="(max-width: 1015px) 100vw, 1015px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Resulting in several adfind.exe process events:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37640" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_039.png" alt="" width="1152" height="172" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_039.png 1152w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_039-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_039-1024x153.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_039-768x115.png 768w" sizes="(max-width: 1152px) 100vw, 1152px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Get-DataInfo.ps1</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor also used a PowerShell script to enumerate local systems. Together with a batch script called &#8220;<code>start.bat</code>&#8221; the threat actor ran <a href="https://github.com/Zorg08/collection/blob/master/Get-Datainfo.ps1" target="_blank" rel="noreferrer noopener">Get-DataInfo.ps1</a> on both a domain controller and a different servers in the environment. We have seen this PowerShell script used <a href="https://thedfirreport.com/?s=get-datainfo" target="_blank" rel="noreferrer noopener">several times before</a>. Interestingly, PowerShell was initiated using the start.bat file. However, the start.bat file did not work as intended and passed the &#8220;method&#8221; parameter to the Get-DataInfo.ps1 script, which is not recognized as a valid parameter. As a result, it ran in default mode. This behavior may have confused the operator at the keyboard, as well as the batch script that was run several times in a row on both servers.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon EventID 1 shows <code>start.bat</code> executes <code>Get-DataInfo.ps1</code> with parameter method:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_040.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37639" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_040.png" alt="" width="1190" height="90" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_040.png 1190w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_040-300x23.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_040-1024x77.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_040-768x58.png 768w" sizes="(max-width: 1190px) 100vw, 1190px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The start.bat script tries to set a variable called method to the discovery method chosen by the user if the method is not typed on the command line:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37638" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_041.png" alt="" width="735" height="295" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_041.png 735w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_041-300x120.png 300w" sizes="(max-width: 735px) 100vw, 735px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The issue with the script arises from the fact that the variable &#8220;method&#8221; does not receive the user-chosen value until after the IF condition is complete. Additionally, the variable must be referenced as <code>%method%</code> to capture the user input correctly. This oversight explains why the PowerShell command initiating <code>Get-DataInfo.ps1</code> includes &#8220;<em>method</em>&#8221; as a parameter on the command line:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37637" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_042.png" alt="" width="442" height="25" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_042.png 442w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_042-300x17.png 300w" sizes="(max-width: 442px) 100vw, 442px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The below will end up running the Get-DataInfo.ps1 script in default mode:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37636" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_043.png" alt="" width="1112" height="160" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_043.png 1112w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_043-300x43.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_043-1024x147.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_043-768x111.png 768w" sizes="(max-width: 1112px) 100vw, 1112px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The default mode will run the <code>Test-LHost</code>, <code>Get-DiskInfo</code> and <code>Get-Software</code> functions in the script before calling the last function, <code>Compress-Result</code>:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37635" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_044.png" alt="" width="900" height="110" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_044.png 900w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_044-300x37.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_044-768x94.png 768w" sizes="(max-width: 900px) 100vw, 900px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 showing the execution:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37634" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_045.png" alt="" width="1592" height="45" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_045.png 1592w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_045-300x8.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_045-1024x29.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_045-768x22.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_045-1536x43.png 1536w" sizes="(max-width: 1592px) 100vw, 1592px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 process create showing several runs of start.bat:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_046-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37763" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_046-1.png" alt="" width="1760" height="627" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_046-1.png 1760w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_046-1-300x107.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_046-1-1024x365.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_046-1-768x274.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_046-1-1536x547.png 1536w" sizes="(max-width: 1760px) 100vw, 1760px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Windows Utilities</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor performed several discovery commands using various Windows utilities at various times during the intrusion.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">C:\Windows\system32\\cmd.exe /C systeminfo	
C:\Windows\system32\cmd.exe /C net group "domain admins" /domain
C:\Windows\system32\cmd.exe /C nltest /dclist &lt;domainname redacted&gt;
nltest  /domain_trusts /all_trusts
C:\Windows\system32\cmd.exe /C net group "enterprise admins" /domain
C:\Windows\system32\cmd.exe /C ping &lt;hostname redacted&gt;
C:\Windows\system32\taskmgr.exe /4
C:\Windows\system32\cmd.exe /C All windows Import-Module ActiveDirectory Get-ADComputer -Filter {enabled -eq $true} -properties *|select Name, DNSHostName, OperatingSystem, LastLogonDate, IPv4Address | Export-CSV C:\Users\AllWindows.csv -NoTypeInformation -Encoding UTF8
C:\Windows\system32\cmd.exe /C route print
C:\Windows\system32\cmd.exe /C ping http://&lt;IP redacted&gt;/
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Administrator Consoles</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>On the final day of the intrusion, the threat actor accessed the administrative consoles for both DNS and Group Policy. Shortly after, they proceeded to deploy ransomware across the environment.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">C:\Windows\system32\mmc.exe C:\Windows\system32\dsa.msc 
C:\Windows\system32\mmc.exe C:\Windows\System32\gpedit.msc
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading -->
<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Pass the hash</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>An examination of logon activity within the environment revealed evidence pointing to pass-the-hash attacks. Specifically, Windows Security logs with event ID 4624, showing logon type 9 and the Logon Process listed as &#8220;seclogo,&#8221; serve as solid indicators of the pass-the-hash technique employed by the threat actor.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_047.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37632" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_047.png" alt="" width="490" height="635" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_047.png 490w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_047-231x300.png 231w" sizes="(max-width: 490px) 100vw, 490px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The threat actor used three main methods for lateral movement. First, Cobalt Strike utilized SMB ADMIN$ shares to move beacons laterally, along with distributing both SMB and HTTPS beacons. Secondly, they used Remote Desktop Protocol to access a file server and a backup server, where they performed discovery activity. Lastly, the threat actor used the hidden SMB share C$ to distribute the ransomware executable to strategic endpoints within the infrastructure.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>A domain controller was used as the main pivot point by the threat actor.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Overview of lateral movement involving SMB ADMIN$ shares and RDP:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_048.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37631" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_048.png" alt="" width="1614" height="1080" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_048.png 1614w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_048-300x201.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_048-1024x685.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_048-768x514.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_048-1536x1028.png 1536w" sizes="(max-width: 1614px) 100vw, 1614px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>To investigate access to the SMB ADMIN$ share, the Windows event log proves invaluable. By examining System event ID 5145, which indicates &#8220;A network share object was checked&#8230;,&#8221; We can track the movement of beacons by the threat actor across the network, gaining essential insight into their lateral movements and activities.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_049.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37630" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_049.png" alt="" width="612" height="150" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_049.png 612w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_049-300x74.png 300w" sizes="(max-width: 612px) 100vw, 612px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>The RDP Activity can be identified with windows security eventID 4624 where the logon type equals 10 RemoteInteractive &#8211; &#8220;A user logged on to this computer remotely using Terminal Services or Remote Desktop.&#8221;</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_050.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37629" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_050.png" alt="" width="467" height="650" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_050.png 467w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_050-216x300.png 216w" sizes="(max-width: 467px) 100vw, 467px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Windows security event ID 5145 was used to demonstrate lateral movement once again, showing SMB C$ share usage.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_051.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37628" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_051.png" alt="" width="375" height="105" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_051.png 375w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_051-300x84.png 300w" sizes="(max-width: 375px) 100vw, 375px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Cobalt Strike SMB beacons, used for lateral movement, were distributed on the beachhead and on a domain controller:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The configuration of the SMB beacons:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">xorkey b'.' 2e
0x0001 payload type                     0x0001 0x0002 2 windows-beacon_smb-bind_pipz
0x0002 port                             0x0001 0x0002 4444
0x0003 sleeptime                        0x0002 0x0004 10000
0x0004 maxgetsize                       0x0002 0x0004 2048576
0x0005 jitter                           0x0001 0x0002 0
0x0006 maxdns                           0x0001 0x0002 0
0x0007 publickey                        0x0003 0x0100 30819f300d06092a864886f70d010101050003818d0030818902818100b8783383addbd675fb86964aae676bcaf31237e8cb4edf428d39816f41810d852974f73e9ae1e7fd525c02221b9761a8f157db0728039c1103f31bb8adae4b4fed45f670943616de985e5dfc034982f3eb8ff643db4433fb59f2a45058eeed09af9881931dd32d999279172b79739f60628e57c311f4234fe65ea8eab3b7d19b020301000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0x0008 server,get-uri                   0x0003 0x0100 (NULL ...)
0x0009 useragent                        0x0003 0x0080 (NULL ...)
0x000a post-uri                         0x0003 0x0040 (NULL ...)
0x000b Malleable_C2_Instructions        0x0003 0x0100
  Transform Input: [7:Input]
0x000c http_get_header                  0x0003 0x0100
0x000d http_post_header                 0x0003 0x0100
0x000e SpawnTo                          0x0003 0x0010 (NULL ...)
0x001d spawnto_x86                      0x0003 0x0040 '%windir%\\syswow64\\SyncHost.exe'
0x001e spawnto_x64                      0x0003 0x0040 '%windir%\\sysnative\\mstsc.exe'
0x000f pipename                         0x0003 0x0080 '\\\\.\\pipe\\WkSvcPipeMgr_JORW2e'
0x001f CryptoScheme                     0x0001 0x0002 0
0x0037 EXIT_FUNK                        0x0001 0x0002 0
0x0028 killdate                         0x0002 0x0004 0
0x0025 license-id                       0x0002 0x0004 674054486 Stats uniques -&gt; ips/hostnames: 60 publickeys: 47
0x0024 deprecated                       0x0003 0x0020 'bfnETSwzb1Xsa2g6gr+auA=='
0x0026 bStageCleanup                    0x0001 0x0002 1
0x0027 bCFGCaution                      0x0001 0x0002 0
0x0029 textSectionEnd                   0x0002 0x0004 1
0x002a ObfuscateSectionsInfo            0x0003 0x0028 '\x00\x10\x00\x00\x95`\x02\x00\x00p\x02\x00À\n\x03\x00\x00\x10\x03\x00\x00Í\x03\x00\x00Ð\x03\x00lî\x03'
0x003a TCP_FRAME_HEADER                 0x0003 0x0080 '\x00\x0fk\x1d^ôá±\x81Bª\x1da'
0x0039 SMB_FRAME_HEADER                 0x0003 0x0080 '\x00\x1ek\x01oÿ&gt;ñëb±\x1b ×\x85\x8e¥X\x1eOQË©¶¦\x13ø1'
0x002b process-inject-start-rwx         0x0001 0x0002 4 PAGE_READWRITE
0x002c process-inject-use-rwx           0x0001 0x0002 32 PAGE_EXECUTE_READ
0x002d process-inject-min_alloc         0x0002 0x0004 13891
0x002e process-inject-transform-x86     0x0003 0x0100 '\x00\x00\x00U\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1f@\x00\x0f\x1f\x80\x00\x00\x00\x00PX\x0f\x1fD\x00\x00f\x90f\x90\x90\x90f\x0f\x1fD\x00\x00f\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1f@\x00\x0f\x1fD\x00\x00PXf\x0f\x1fD\x00\x00\x0f\x1fD\x00\x00\x00\x00\x00KPX\x0f\x1fD\x00\x00f\x0f\x1fD\x00\x00PX\x0f\x1fD\x00\x00f\x0f\x1fD\x00\x00f\x90\x90\x0f\x1fD\x00\x00\x0f\x1f\x80\x00\x00\x00\x00f\x90\x90\x90PXPX\x0f\x1fD\x00\x00f\x90\x0f\x1fD\x00\x00\x90\x0f\x1f\x00\x0f\x1fD\x00\x00\x0f\x1fD'
0x002f process-inject-transform-x64     0x0003 0x0100 '\x00\x00\x00\x16f\x90f\x0f\x1fD\x00\x00f\x90\x0f\x1f\x00f\x0f\x1f\x84\x00\x00\x00\x00\x00\x00\x00\x00Zf\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1f\x80\x00\x00\x00\x00\x0f\x1f\x84\x00\x00\x00\x00\x00PX\x0f\x1fD\x00\x00\x0f\x1f\x00f\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1f\x84\x00\x00\x00\x00\x00f\x0f\x1fD\x00\x00\x90f\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1fD\x00\x00\x0f\x1f\x80\x00\x00\x00\x00f\x0f\x1fD\x00\x00\x90\x0f\x1f@'
0x0035 process-inject-stub              0x0003 0x0010 'ÅNí/½Ée\\\x0c\x13U\x0f\x04Ç,('
0x0033 process-inject-execute           0x0003 0x0080 '\x06\x04\x07\x00\x00\x00\x06ntdll\x00\x00\x00\x00\x13RtlUserThreadStart\x00\x01\x08\x03\x04'
0x0034 process-inject-allocation-method 0x0001 0x0002 0
0x0030 DEPRECATED_PROCINJ_ALLOWED       0x0001 0x0002 1
0x0010 killdate_year                    0x0001 0x0002 0
0x004a                                  0x0003 0x0020 'ÌÑ¶\x8f½ÉeDc~buq®FJô\x16\x9ccß\x82+\td\x7ff_J°\x11\x15'
0x0000
Guessing Cobalt Strike version: 4.4 (max 0x004a)
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The threat actor&#8217;s use of RDP and tunnels via SystemBC left behind crucial artifacts that helped identify their activities. Notably, we detected two hostnames, &#8220;DESKTOP-0MEMSEA&#8221; and &#8220;DESKTOP-BIFFSC7&#8221;, which were used during the intrusion. These artifacts appeared in various logs, including Sysmon event ID 24 (clipboard change), Windows Security event ID 4624 (logon), event ID 4778 (terminal session reconnect), and event ID 4779 (terminal server disconnect), providing multiple points of evidence linking the threat actor&#8217;s presence across the environment.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Here is an overview of the RDP sessions where the threat actor used these two hosts:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_052.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37627" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_052.png" alt="" width="415" height="292" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_052.png 415w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_052-300x211.png 300w" sizes="(max-width: 415px) 100vw, 415px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading -->
<h2 id="collection" class="wp-block-heading"><a href="#collection">Collection</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Archiving</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor used 7z to archive data output from running the Get-DataInfo.ps1 PowerShell script.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 showing execution of 7z.exe archiving data:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_053.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37626" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_053.png" alt="" width="1305" height="40" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_053.png 1305w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_053-300x9.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_053-1024x31.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_053-768x24.png 768w" sizes="(max-width: 1305px) 100vw, 1305px" /></a><img alt="" /></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Looking for interesting files</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In their pursuit of valuable data, the threat actor browsed through file systems, selectively opening files they deemed interesting. Documents containing passwords, financial information, and other sensitive data were specifically targeted, as these types of files typically hold high value for the intruders.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 showing Notepad and Wordpad used to open and look at files:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/08/26364_054_001.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37693" src="https://thedfirreport.com/wp-content/uploads/2025/08/26364_054_001.png" alt="" width="1450" height="125" srcset="https://thedfirreport.com/wp-content/uploads/2025/08/26364_054_001.png 1450w, https://thedfirreport.com/wp-content/uploads/2025/08/26364_054_001-300x26.png 300w, https://thedfirreport.com/wp-content/uploads/2025/08/26364_054_001-1024x88.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/08/26364_054_001-768x66.png 768w" sizes="(max-width: 1450px) 100vw, 1450px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading -->
<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>For command and control, the threat actor used two main tools, Cobalt Strike and SystemBC.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_055.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37624" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_055.png" alt="" width="1963" height="1072" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_055.png 1963w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_055-300x164.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_055-1024x559.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_055-768x419.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_055-1536x839.png 1536w" sizes="(max-width: 1963px) 100vw, 1963px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Cobalt Strike</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Overview of Cobalt Strike traffic beaconing pattern over intrusion:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_056.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37623" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_056.png" alt="" width="2545" height="390" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_056.png 2545w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_056-300x46.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_056-1024x157.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_056-768x118.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_056-1536x235.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_056-2048x314.png 2048w" sizes="(max-width: 2545px) 100vw, 2545px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>The initial Cobalt Strike beacon, delivered via RtWin64.exe on the beachhead host, maintained a continuous command and control domain at svchorst[.]com throughout the entire infection. The IP address associated with the domain changed over time, and the communication process also shifted as queries were injected into different processes by RtWin64.exe.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>To further obfuscate its presence, the threat actor initially routed the Cobalt Strike command and control traffic through CloudFlare&#8217;s CDN service, effectively attempting to hide in plain sight by blending into legitimate web traffic.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The 104[.]21.76.140 and 172[.]67.196.25 addresses belonged to Cloudflare.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_057.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37622" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_057.png" alt="" width="412" height="225" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_057.png 412w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_057-300x164.png 300w" sizes="(max-width: 412px) 100vw, 412px" /></a> <a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_058.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37621" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_058.png" alt="" width="428" height="165" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_058.png 428w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_058-300x116.png 300w" sizes="(max-width: 428px) 100vw, 428px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Later in the intrusion, the command and control (C2) server moved away from CloudFlare, and subsequently, the domain resolved to an AWS IP address.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_059.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37620" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_059.png" alt="" width="1843" height="883" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_059.png 1843w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_059-300x144.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_059-1024x491.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_059-768x368.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_059-1536x736.png 1536w" sizes="(max-width: 1843px) 100vw, 1843px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>DNS queries performed for svchorst[.]com:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_060.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37619" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_060.png" alt="" width="612" height="85" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_060.png 612w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_060-300x42.png 300w" sizes="(max-width: 612px) 100vw, 612px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Network connections to svchorst[.]com:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_061.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37618" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_061.png" alt="" width="445" height="82" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_061.png 445w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_061-300x55.png 300w" sizes="(max-width: 445px) 100vw, 445px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Using Didier Steven&#8217;s great tool <a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/1768.py" target="_blank" rel="noreferrer noopener">1768.py</a>, we successfully extracted the configuration of the Cobalt Strike beacon, which validated the host artifacts discovered on the beachhead host.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">xorkey b'.' 2e
0x0001 payload type                     0x0001 0x0002 8 windows-beacon_https-reverse_https
0x0002 port                             0x0001 0x0002 443
0x0003 sleeptime                        0x0002 0x0004 50408
0x0004 maxgetsize                       0x0002 0x0004 4103260
0x0005 jitter                           0x0001 0x0002 30
0x0007 publickey                        0x0003 0x0100 30819f300d06092a864886f70d010101050003818d0030818902818100b8783383addbd675fb86964aae676bcaf31237e8cb4edf
428d39816f41810d852974f73e9ae1e7fd525c02221b9761a8f157db0728039c1103f31bb8adae4b4fed45f670943616de985e5dfc034982f3eb8ff643db4433fb59f2a45058eeed09af9881931dd3
2d999279172b79739f60628e57c311f4234fe65ea8eab3b7d19b0203010001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0x0008 server,get-uri                   0x0003 0x0100 'svchorst.com,/shiatzu/v2.41'
0x0043 DNS_STRATEGY                     0x0001 0x0002 0
0x0044 DNS_STRATEGY_ROTATE_SECONDS      0x0002 0x0004 -1
0x0045 DNS_STRATEGY_FAIL_X              0x0002 0x0004 -1
0x0046 DNS_STRATEGY_FAIL_SECONDS        0x0002 0x0004 -1
0x000e SpawnTo                          0x0003 0x0010 (NULL ...)
0x001d spawnto_x86                      0x0003 0x0040 '%windir%\\syswow64\\SyncHost.exe'
0x001e spawnto_x64                      0x0003 0x0040 '%windir%\\sysnative\\mstsc.exe'
0x001f CryptoScheme                     0x0001 0x0002 0
0x001a get-verb                         0x0003 0x0010 'GET'
0x001b post-verb                        0x0003 0x0010 'POST'
0x001c HttpPostChunk                    0x0002 0x0004 0
0x0025 license-id                       0x0002 0x0004 674054486
0x0024 deprecated                       0x0003 0x0020 'bfnETSwzb1Xsa2g6gr+auA=='
0x0026 bStageCleanup                    0x0001 0x0002 1
0x0027 bCFGCaution                      0x0001 0x0002 0
0x0047 MAX_RETRY_STRATEGY_ATTEMPTS      0x0002 0x0004 0
0x0048 MAX_RETRY_STRATEGY_INCREASE      0x0002 0x0004 0
0x0049 MAX_RETRY_STRATEGY_DURATION      0x0002 0x0004 0
0x0009 useragent                        0x0003 0x0100 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Sa
fari/537.36'
0x000a post-uri                         0x0003 0x0040 '/unobservedly/v10.78'
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>In the rest of the infrastructure, two distinct types of Cobalt Strike beacons were deployed: HTTPS beacons and SMB beacons. The HTTPS beacons appeared to communicate with three different domains—wq[.]regsvcast[.]com, as[.]regsvcast[.]com, and zx[.]regsvcast[.]com—though, in reality, only wq[.]regsvcast[.]com was actively used, resolving to IP address 147.78.47[.]178. This Cobalt Strike server was tracked as active by the DFIR Threat Feeds from December 21st through Jan 6th, 2024.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon event ID 22 helped document the DNS queries related to the *regsvcast[.]com domains, providing further insight into the network activity tied to the Cobalt Strike infrastructure.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_062-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37764" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_062-1.png" alt="" width="975" height="130" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_062-1.png 975w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_062-1-300x40.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_062-1-768x102.png 768w" sizes="(max-width: 975px) 100vw, 975px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Sysmon event ID 3 logs every network connection made, provided it&#8217;s not disabled in the Sysmon configuration. This can be particularly useful, as some EDR solutions apply rate limits to this type of artifact.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Since Cobalt Strike beacons can generate significant traffic, the volume of network connections for each beacon can be observed in the final column of these logs, highlighting the frequency and noisiness of the communication between beacons and command and control infrastructure.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_063.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37616" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_063.png" alt="" width="670" height="150" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_063.png 670w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_063-300x67.png 300w" sizes="(max-width: 670px) 100vw, 670px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Below is the configuration of the beacon from DC Y which communicated encrypted over https on port 443:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">File: b7bcee8.exe
payloadType: 0x00002810
payloadSize: 0x00040405
intxorkey: 0xe43ebc19
id2: 0x00000000
MZ header found position 9
Config found: xorkey b'.' 0x0003ac30 0x000403fc
0x0001 payload type                     0x0001 0x0002 8 windows-beacon_https-reverse_https
0x0002 port                             0x0001 0x0002 443
0x0003 sleeptime                        0x0002 0x0004 63612
0x0004 maxgetsize                       0x0002 0x0004 2796542
0x0005 jitter                           0x0001 0x0002 39
0x0007 publickey                        0x0003 0x0100 30819f300d06092a864886f70d010101050003818d0030818902818100a208a5996fa9e52ff4f19fb148b97176ab0a7e2cfc1d59fcc661e4d1afad0c6636fc952b6cab7b88bc62e7c5ad34441750e74eab69ab68acc39f005cfd315edda934ad438245830fd29688df4a4f2b89154cb81ea126d04804015e2660f55136d1cce8fb14126d1677ac0b38746b7a5543753c53dae05552e142d8ba74c34569020301000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0x0008 server,get-uri                   0x0003 0x0100 'qw.regsvcast.com,/hr,as.regsvcast.com,/hr,zx.regsvcast.com,/hr'
0x0043 DNS_STRATEGY                     0x0001 0x0002 0
0x0044 DNS_STRATEGY_ROTATE_SECONDS      0x0002 0x0004 -1
0x0045 DNS_STRATEGY_FAIL_X              0x0002 0x0004 -1
0x0046 DNS_STRATEGY_FAIL_SECONDS        0x0002 0x0004 -1
0x000e SpawnTo                          0x0003 0x0010 (NULL ...)
0x001d spawnto_x86                      0x0003 0x0040 '%windir%\\syswow64\\runonce.exe'
0x001e spawnto_x64                      0x0003 0x0040 '%windir%\\sysnative\\runonce.exe'
0x001f CryptoScheme                     0x0001 0x0002 0
0x001a get-verb                         0x0003 0x0010 'GET'
0x001b post-verb                        0x0003 0x0010 'POST'
0x001c HttpPostChunk                    0x0002 0x0004 0
0x0025 license-id                       0x0002 0x0004 1580103824 Stats uniques -&gt; ips/hostnames: 316 publickeys: 148
0x0026 bStageCleanup                    0x0001 0x0002 1
0x0027 bCFGCaution                      0x0001 0x0002 0
0x0009 useragent                        0x0003 0x0100 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.246'
0x000a post-uri                         0x0003 0x0040 '/rw'
0x000b Malleable_C2_Instructions        0x0003 0x0100
  Transform Input: [7:Input,4,2:338,3,11]
   Print
   Remove 338 bytes from begin
   BASE64
   NETBIOS uppercase
0x000c http_get_header                  0x0003 0x0200
  Const_header Connection: close
  Const_header Accept-Encoding: br
  Build Metadata: [7:Metadata,13,3,2:wordpress_logged_in=,6:Cookie]
   BASE64 URL
   BASE64
   Prepend wordpress_logged_in=
   Header Cookie
0x000d http_post_header                 0x0003 0x0200
  Const_header Connection: close
  Const_header Accept-Language: en-US
  Const_header Content-Type: text/plain
  Build Output: [7:Output,3,3,4]
   BASE64
   BASE64
   Print
  Build SessionId: [7:SessionId,3,2:__session__id=,6:Cookie]
   BASE64
   Prepend __session__id=
   Header Cookie
0x0036 HostHeader                       0x0003 0x0080 (NULL ...)
0x0032 UsesCookies                      0x0001 0x0002 1
0x0023 proxy_type                       0x0001 0x0002 2 IE settings
0x003a TCP_FRAME_HEADER                 0x0003 0x0080 '\x00\x04'
0x0039 SMB_FRAME_HEADER                 0x0003 0x0080 '\x00\x04'
0x0037 EXIT_FUNK                        0x0001 0x0002 0
0x0028 killdate                         0x0002 0x0004 0
0x0029 textSectionEnd                   0x0002 0x0004 179426
0x002a ObfuscateSectionsInfo            0x0003 0x0028 '\x00À\x02\x00â¸\x03\x00\x00À\x03\x00H\x92\x04\x00\x00\xa0\x04\x00dÀ\x04\x00\x00Ð\x04\x00hß\x04'
0x002b process-inject-start-rwx         0x0001 0x0002 4 PAGE_READWRITE
0x002c process-inject-use-rwx           0x0001 0x0002 32 PAGE_EXECUTE_READ
0x002d process-inject-min_alloc         0x0002 0x0004 18046
0x002e process-inject-transform-x86     0x0003 0x0100 '\x00\x00\x00\x05\x90\x90\x90\x90\x90'
0x002f process-inject-transform-x64     0x0003 0x0100 '\x00\x00\x00\x05\x90\x90\x90\x90\x90'
0x0035 process-inject-stub              0x0003 0x0010 '"+\x8f\'Ûßº\x8dÝU\x9eì¢~¦H'
0x0033 process-inject-execute           0x0003 0x0080 '\x01\x04\x03'
0x0034 process-inject-allocation-method 0x0001 0x0002 0
0x0000
Guessing Cobalt Strike version: 4.3 (max 0x0046)
Sanity check Cobalt Strike config: OK
Public key config entry found: 0x0003ac65 (xorKey 0x2e) (LSFIF: b'././.,.&amp;.,./.,/')
Public key header found: 0x0003ac6b (xorKey 0x2e) (LSFIF: b'././.,.&amp;.,./.,/')
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>One C2 connection from the Cobalt Strike beacons stands out from the rest: it originates from PowerShell but communicates over HTTP to port 80.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_064.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37615" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_064.png" alt="" width="670" height="150" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_064.png 670w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_064-300x67.png 300w" sizes="(max-width: 670px) 100vw, 670px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Communicating in clear text gives us the opportunity to look at what is going on. The threat actor used PowerShell to perform the download:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_065.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37614" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_065.png" alt="" width="1617" height="50" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_065.png 1617w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_065-300x9.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_065-1024x32.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_065-768x24.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_065-1536x47.png 1536w" sizes="(max-width: 1617px) 100vw, 1617px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Using Wireshark to view the exact HTTP query to the C2 server:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_066.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37613" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_066.png" alt="" width="1341" height="281" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_066.png 1341w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_066-300x63.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_066-1024x215.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_066-768x161.png 768w" sizes="(max-width: 1341px) 100vw, 1341px" /></a> <a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_067.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37612" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_067.png" alt="" width="1340" height="117" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_067.png 1340w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_067-300x26.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_067-1024x89.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_067-768x67.png 768w" sizes="(max-width: 1340px) 100vw, 1340px" /></a><img alt="" /></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>A PowerShell script was downloaded that decodes a Base64-encoded blob using `FromBase64String`. At the end of the script, the decoded data is decompressed, which can easily be done using tools like `gunzip`. This behavior is highly indicative of a Cobalt Strike PowerShell stager. Upon decoding the Base64 blob, we uncovered another embedded PowerShell script.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_068.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37611" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_068.png" alt="" width="330" height="25" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_068.png 330w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_068-300x23.png 300w" sizes="(max-width: 330px) 100vw, 330px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_069.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37610" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_069.png" alt="" width="1140" height="650" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_069.png 1140w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_069-300x171.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_069-1024x584.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_069-768x438.png 768w" sizes="(max-width: 1140px) 100vw, 1140px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_070.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37609" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_070.png" alt="" width="1142" height="440" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_070.png 1142w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_070-300x116.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_070-1024x395.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_070-768x296.png 768w" sizes="(max-width: 1142px) 100vw, 1142px" /></a><img alt="" /></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>This PowerShell script decodes another base64 blob, but as we can see it also performs XOR operations on the bytes. XOR with decimal 35(0x23) is a well known key for Cobalt Strike PowerShell stagers.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_071.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37608" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_071.png" alt="" width="992" height="20" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_071.png 992w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_071-300x6.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_071-768x15.png 768w" sizes="(max-width: 992px) 100vw, 992px" /></a><img /></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After decoding the final base64 blob we get the Cobalt Strike beacon and can get the configuration (as the configuration is the same on all HTTP beacons the config is extracted with <a href="https://github.com/strozfriedberg/cobaltstrike-config-extractor" target="_blank" rel="noreferrer noopener">csce</a>):</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_072.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37607" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_072.png" alt="" width="297" height="25" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">{
  "beacontype": [
    "HTTPS"
  ],
  "sleeptime": 63612,
  "jitter": 39,
  "maxgetsize": 2796542,
  "spawnto": "AAAAAAAAAAAAAAAAAAAAAA==",
  "license_id": 1580103824,
  "cfg_caution": false,
  "kill_date": null,
  "server": {
    "hostname": "qw.regsvcast.com",
    "port": 443,
    "publickey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCiCKWZb6nlL/Txn7FIuXF2qwp+LPwdWfzGYeTRr60MZjb8lStsq3uIvGLnxa00RBdQ506raatorMOfAFz9MV7dqTStQ4JFgw/SlojfSk8riRVMuB6hJtBIBAFeJmD1UTbRzOj7FBJtFnesCzh0a3pVQ3U8U9rgVVLhQti6dMNFaQIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
  },
  "host_header": "",
  "useragent_header": null,
  "http-get": {
    "uri": "/hr",
    "verb": "GET",
    "client": {
      "headers": null,
      "metadata": null
    },
    "server": {
      "output": [
        "print",
        "prepend 338 characters",
        "base64",
        "netbiosu"
      ]
    }
  },
  "http-post": {
    "uri": "/ch",
    "verb": "POST",
    "client": {
      "headers": null,
      "id": null,
      "output": null
    }
  },
  "tcp_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=",
  "crypto_scheme": 0,
  "proxy": {
    "type": null,
    "username": null,
    "password": null,
    "behavior": "Use IE settings"
  },
  "http_post_chunk": 0,
  "uses_cookies": true,
  "post-ex": {
    "spawnto_x86": "%windir%\\syswow64\\runonce.exe",
    "spawnto_x64": "%windir%\\sysnative\\runonce.exe"
  },
  "process-inject": {
    "allocator": "VirtualAllocEx",
    "execute": [
      "CreateThread",
      "RtlCreateUserThread",
      "CreateRemoteThread"
    ],
    "min_alloc": 18046,
    "startrwx": false,
    "stub": "IiuPJ9vfuo3dVZ7son6mSA==",
    "transform-x86": [
      "prepend '\\x90\\x90\\x90\\x90\\x90'"
    ],
    "transform-x64": [
      "prepend '\\x90\\x90\\x90\\x90\\x90'"
    ],
    "userwx": false
  },
  "dns-beacon": {
    "dns_idle": null,
    "dns_sleep": null,
    "maxdns": null,
    "beacon": null,
    "get_A": null,
    "get_AAAA": null,
    "get_TXT": null,
    "put_metadata": null,
    "put_output": null
  },
  "pipename": null,
  "smb_frame_header": "AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=",
  "stage": {
    "cleanup": true
  },
  "ssh": {
    "hostname": null,
    "port": null,
    "username": null,
    "password": null,
    "privatekey": null
  }
}
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">SytemBC</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Another command and control channel utilized by the threat actor in this intrusion was SystemBC, a tool frequently favored by ransomware groups. One of its most commonly used features is its proxy functionality. This allowed the threat actor to leverage their own external computers and, through the SystemBC malware deployed on the file server, establish proxy connections to access the local network, facilitating further actions within the compromised environment.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_073.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37606" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_073.png" alt="" width="1112" height="675" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_073.png 1112w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_073-300x182.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_073-1024x622.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_073-768x466.png 768w" sizes="(max-width: 1112px) 100vw, 1112px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The threat actor first brought in SystemBC as a file named SC.exe. This was executed manually by the threat actor after logging into the file server from DC X.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Security EventID 4624 showing RDP logon and Logon ID:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_074.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37605" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_074.png" alt="" width="478" height="662" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_074.png 478w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_074-217x300.png 217w" sizes="(max-width: 478px) 100vw, 478px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The threat actor manually started SystemBC with name SC.exe:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_075.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37604" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_075.png" alt="" width="1349" height="386" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_075.png 1349w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_075-300x86.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_075-1024x293.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_075-768x220.png 768w" sizes="(max-width: 1349px) 100vw, 1349px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Notice that the original name is different and that the LogonID is the same as from the RDP login above.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Shortly after the threat actor brought another SystemBC file, with the name socks32.exe. That was moved to the file server from DC X.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>socks32.exe moved over SMB C$ share:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_076.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37603" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_076.png" alt="" width="425" height="44" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_076.png 425w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_076-300x31.png 300w" sizes="(max-width: 425px) 100vw, 425px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Once again execution is done manually after logging in through RDP.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>RDP logon:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_077.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37602" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_077.png" alt="" width="277" height="40" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Manual execution:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_078.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37601" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_078.png" alt="" width="903" height="39" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_078.png 903w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_078-300x13.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_078-768x33.png 768w" sizes="(max-width: 903px) 100vw, 903px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>If the SystemBC sample is compiled without modifications, it should be feasible to extract the configuration from the implant by examining the exe file, as all information is presented in plain text.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Port and host configuration for SystemBC in the socks32.exe implant:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_079.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37600" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_079.png" alt="" width="1228" height="68" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_079.png 1228w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_079-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_079-1024x57.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_079-768x43.png 768w" sizes="(max-width: 1228px) 100vw, 1228px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="impact" class="wp-block-heading"><a href="#impact">Impact</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor&#8217;s primary objective in this case was financial gain through ransom. They introduced an executable named qwe.exe, which we later identified as BlackSuit ransomware.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This ransomware was strategically distributed across key endpoints within the infrastructure and executed, initiating the ransom demands.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_080-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37746" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_080-1.png" alt="" width="1563" height="1044" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_080-1.png 1563w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_080-1-300x200.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_080-1-1024x684.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_080-1-768x513.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_080-1-1536x1026.png 1536w" sizes="(max-width: 1563px) 100vw, 1563px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Windows security eventID 5145 shows the distribution of the BlackSuit ransom executable via SMB C$ shares:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_081.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37598" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_081.png" alt="" width="367" height="102" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_081.png 367w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_081-300x83.png 300w" sizes="(max-width: 367px) 100vw, 367px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>To avoid any errors during the final stage of their operation, the threat actor refrained from manually typing the command to execute the ransomware with the necessary command line arguments. Instead, to ensure accuracy and eliminate the risk of typos, they also moved a file named 123.txt along with qwe.exe, likely using it as a script or reference to guarantee the correct execution of the ransomware.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Windows security eventID 5145 shows distribution of 123.exe to the c:\users directory:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_082.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37597" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_082.png" alt="" width="375" height="105" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_082.png 375w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_082-300x84.png 300w" sizes="(max-width: 375px) 100vw, 375px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Movement of the 123.txt file seen from the network side. Including the content. The id is redacted.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_083.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37596" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_083.png" alt="" width="417" height="80" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_083.png 417w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_083-300x58.png 300w" sizes="(max-width: 417px) 100vw, 417px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_084.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37595" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_084.png" alt="" width="420" height="52" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_084.png 420w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_084-300x37.png 300w" sizes="(max-width: 420px) 100vw, 420px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>After staging the ransomware executable qwe.exe and the helper file 123.txt, the threat actor used RDP from DC X to log onto various systems. Once logged in, they opened 123.txt in Notepad, copied the command from the file, and executed the ransomware. This method ensured the correct command line arguments were used, reducing the risk of mistakes during the final execution phase.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 showing notepad.exe opening 123.txt:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_085.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37594" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_085.png" alt="" width="865" height="77" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_085.png 865w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_085-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_085-768x68.png 768w" sizes="(max-width: 865px) 100vw, 865px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Sysmon eventID 1 showing execution of qwe.exe</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_086.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37593" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_086.png" alt="" width="1045" height="125" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_086.png 1045w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_086-300x36.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_086-1024x122.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_086-768x92.png 768w" sizes="(max-width: 1045px) 100vw, 1045px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>Once the ransomware was executed a lot of ransom notes where created:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_087.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37592" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_087.png" alt="" width="725" height="472" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_087.png 725w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_087-300x195.png 300w" sizes="(max-width: 725px) 100vw, 725px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:paragraph -->
<p>readme.blacksuit.txt looked like:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_088.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37591" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_088.png" alt="" width="1836" height="1058" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_088.png 1836w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_088-300x173.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_088-1024x590.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_088-768x443.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_088-1536x885.png 1536w" sizes="(max-width: 1836px) 100vw, 1836px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading -->
<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37748" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1.png" alt="" width="3202" height="5222" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1.png 3202w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1-184x300.png 184w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1-628x1024.png 628w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1-768x1252.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1-942x1536.png 942w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_089-1-1256x2048.png 1256w" sizes="(max-width: 3202px) 100vw, 3202px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:heading -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading -->
<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_090.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37589" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_090.png" alt="" width="3778" height="1496" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_090.png 3778w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_090-300x119.png 300w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_090-1024x405.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_090-768x304.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_090-1536x608.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_090-2048x811.png 2048w" sizes="(max-width: 3778px) 100vw, 3778px" /></a></p>
<!-- /wp:heading -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading -->
<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Atomic</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">SystemBC C2
  137.220.61[.]94

Cobalt Strike C2
  svchorst[.]com        - 15.197.130[.]221
  as.regsvcast[.]com    - 147.78.47[.]178
  zx.regsvcast[.]com    - 147.78.47[.]178
  qw.regsvcast[.]com    - 147.78.47[.]178

</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Computed</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">RtWin64.exe	- Cobalt Strike Beacon
  md5:b5266cd35d1b3770b05  ad6870c0c4bde	
  sha1:2bb6c8b6461edc49e22f3d0c7dc45904b2ed8a2b
  sha256:55cde638e9bcc335c79c605a564419819abf5d569c128b95b005b2f48ccc43c1
  imphash:6015e6e85d0d93e60041fa68c6a89776

7f02ab2.exe	- Cobalt Strike Beacon	
  md5:3bf1142b3294c23852852053135ec0df	
  sha1:a3b617eb4248aba34c28c48886116ac97e55e932
  sha256:6c884e4a9962441155af0ac8e7eea4ac84b1a8e71faee0beafc4dd95c4e4753f  
  imphash:1b2b0fc8f126084d18c48b4f458c798b

7341ac3.exe	- Cobalt Strike Beacon
  md5:519dc779533b4ff0fc67727fecadba82	
  sha1:586ea19ea4776300962e20cfc9e7017a50888ecb
  sha256:a39dc30bd672b66dc400f4633dfa4bdd289b5e79909c2e25e9c08b44d99b8953
  imphash:1b2b0fc8f126084d18c48b4f458c798b

61185c1.exe	- Cobalt Strike Beacon
  md5:820cfde780306e759bb434da509f7a91	
  sha1:4e38b98965a4d4756e6f4a8259df62cbca7de559
  sha256:e92912153cf82e70d52203a1a5c996e68b7753818c831ac7415aedbe6f3f007d
  imphash:1b2b0fc8f126084d18c48b4f458c798b

b7bcee8.exe	- Cobalt Strike Beacon
  md5:b54240c98ca23202e58a1580135ad14c	
  sha1:cd55256904f1964b90b51089b46f1a933fec3e8e
  sha256:27e300fa67828d8ffd72d0325c6957ff54d2dc6a060bbf6fc7aa5965513468e0
  imphash:bed5688a4a2b5ea6984115b458755e90

e225857.exe	- Cobalt Strike Beacon
  md5:3900ebc7766f3894fb1eb300460376ad	
  sha1:e63732fb38d2e823348529a264b4c4718e0c0b4a
  sha256:f474241a5d082500be84a62f013bc2ac5cde7f18b50bf9bb127e52bf282fffbf
  imphash:bed5688a4a2b5ea6984115b458755e90

7341ac3.exe	- Cobalt Strike Beacon
  md5:519dc779533b4ff0fc67727fecadba82	
  sha1:586ea19ea4776300962e20cfc9e7017a50888ecb
  sha256:a39dc30bd672b66dc400f4633dfa4bdd289b5e79909c2e25e9c08b44d99b8953
  imphash:1b2b0fc8f126084d18c48b4f458c798b

AdFind.exe	
  md5:9b02dd2a1a15e94922be3f85129083ac
  sha1:2cb6ff75b38a3f24f3b60a2742b6f4d6027f0f2a
  sha256:b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682
  imphash:4fbf3f084fbbb2470b80b2013134df35

SharpHound.exe
  md5:76a2363d509cc7174c4abee9a7d7ae68
  sha1:286588a50b9b128d07aa0f8851f2d7ee91dfa372
  sha256:3b873bc8c7ee12fe879ab175d439b5968c8803fbb92e414de39176e2371896b2
  imphash:f34d5f2d4577ed6d9ceec516c1f5a744

socks32.exe
  md5:ed44877077716103973cbbebd531f38e
  sha1:ceb8c699a57193aa3be2a1766b03050cde3c738a
  sha256:9493b512d7d15510ebee5b300c55b67f9f2ff1dda64bddc99ba8ba5024113300
  imphash:d66000edfed0a9938162b2b453ffa516

qwe.exe
  md5:0bb61c0cff022e73b7c29dd6f1ccf0e2
  sha1:8dde03600a18a819b080a41effc24f42fa960a3e
  sha256:60dcbfb30802e7f4c37c9cdfc04ddb411060918d19e5b309a5be6b4a73c8b18a
  imphash:ecc488e51fbb2e01a7aac2b35d5f10bd

</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} --><!-- /wp:heading -->

<!-- wp:heading -->
<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Network</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">ET CURRENT_EVENTS [Fireeye] HackTool.TCP.Rubeus.[nonce]
ET CURRENT_EVENTS [Fireeye] HackTool.TCP.Rubeus.[nonce 2]
ET Threatview.io High Confidence Cobalt Strike C2 IP group 3
ET Threatview.io High Confidence Cobalt Strike C2 IP group 2
ET POLICY SMB Executable File Transfer
ET RPC DCERPC SVCCTL - Remote Service Control Manager Access
ET POLICY SMB2 NT Create AndX Request For a .bat File
ET POLICY SMB2 NT Create AndX Request For an Executable File In a Temp Directory
ET POLICY Powershell Command With Hidden Window Argument Over SMB - Likely Lateral Movement
ET POLICY PE EXE or DLL Windows file download HTTP
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Sigma</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Search rules on <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a> or <a href="https://sigmasearchengine.com/" target="_blank" rel="noreferrer noopener">sigmasearchengine.com</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>DFIR Public Rules Repo:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">50046619-1037-49d7-91aa-54fc92923604 : AdFind Discovery
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>DFIR Private Rules:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">03be05e6-4977-44cd-8ee4-a79400a5ceb0 : Detection of Cobalt Strike Execution<br />ded07dbe-bcd4-4d15-a27b-1669445d3215 : Enabling RDP service via reg.exe command execution<br />feee5785-1381-4119-95d0-ca0c3fffe2f2 : Potential Kerberoasting Attack Detected<br />f8fd3970-d558-40c8-86e2-a989cd53daea : RDP Session from Host with Default Hostname<br />194e0132-ddee-433c-ac98-3e544c5a2a3a : Suspicious Powershell Execution in Run Key</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Sigma Repo:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">903076ff-f442-475a-b667-4f246bcc203b : Nltest.EXE Execution
5cc90652-4cbd-4241-aa3b-4b462fa5a248 : Potential Recon Activity Via Nltest.EXE
9a132afa-654e-11eb-ae93-0242ac130002 : PUA - AdFind Suspicious Execution
d5601f8c-b26f-4ab0-9035-69e11a8d4ad2 : CobaltStrike Named Pipe
496a0e47-0a33-4dca-b009-9e6ca3591f39 : Suspicious Kerberos RC4 Ticket Encryption
8eef149c-bd26-49f2-9e5a-9b00e3af499b : Pass the Hash Activity 2
f376c8a7-a2d0-4ddc-aa0c-16c17236d962 : HackTool - Bloodhound/Sharphound Execution
02773bed-83bf-469f-b7ff-e676e7d78bab : BloodHound Collection Files
0d894093-71bc-43c3-8c4d-ecfc28dcf5d9 : Mimikatz Detection LSASS Access
a18dd26b-6450-46de-8c91-9659150cf088 : Potentially Suspicious GrantedAccess Flags On LSASS
098d7118-55bc-4912-a836-dc6483a8d150 : Access To ADMIN$ Network Share
61a7697c-cb79-42a8-a2ff-5f0cdfae0130 : Potential CobaltStrike Service Installations - Registry
1d61f71d-59d2-479e-9562-4ff5f4ead16b : Suspicious Service Installation
4aafb0fa-bff5-4b9d-b99e-8093e659c65f : Writing Local Admin Share
ca2092a1-c273-4878-9b4b-0d60115bf5ea : Suspicious Encoded PowerShell Command Line
0ef56343-059e-4cb6-adc1-4c3c967c5e46 : Suspicious Execution of Systeminfo
bbb7e38c-0b41-4a11-b306-d2a457b7ac2b : Suspicious File Created In PerfLogs
3dfd06d2-eaf4-4532-9555-68aca59f57c4 : Process Execution From A Potentially Suspicious Folder
0d5675be-bc88-4172-86d3-1e96a4476536 : Potential Tampering With RDP Related Registry Keys Via Reg.EXE
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Yara</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>File Scan Results:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>DFIR Report:</p>
<p>https://github.com/The-DFIR-Report/Yara-Rules/compare/26364</p>
<p><a href="https://github.com/search?q=repo%3AThe-DFIR-Report%2FYara-Rules+get-data&amp;type=code">https://github.com/search?q=repo%3AThe-DFIR-Report%2FYara-Rules+get-data&amp;type=code</a></p>
<p><a href="https://github.com/search?q=repo%3AThe-DFIR-Report%2FYara-Rules%20netscan&amp;type=code">https://github.com/search?q=repo%3AThe-DFIR-Report%2FYara-Rules%20netscan&amp;type=code</a></p>
<!-- /wp:embed -->

<!-- wp:paragraph -->
<p><a href="https://yarahq.github.io/" target="_blank" rel="noreferrer noopener">YARA Forge</a>:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">DITEKSHEN_MALWARE_Win_EXEPWSH_Dlagent
ELASTIC_Windows_Trojan_Cobaltstrike_1787Eef5
ELASTIC_Windows_Trojan_Cobaltstrike_7F8Da98A
EMBEERESEARCH_Win_Cobaltstrike_Pipe_Strings_Nov_2023
GCTI_Cobaltstrike_Resources_Artifact64_V3_14_To_V4_X
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Memory Scan Results:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">HKTL_CobaltStrike_SleepMask_Jul22
CobaltStrike_Sleep_Decoder_Indicator
Windows_Trojan_CobaltStrike_b54b94ac
HKTL_CobaltStrike_Beacon_4_2_Decrypt
CobaltStrike_Sleeve_Beacon_x64_v4_4_v_4_5_and_v4_6
Windows_Trojan_CobaltStrike_663fc95d
Windows_Trojan_CobaltStrike_3dc22d14
HKTL_CobaltStrike_Beacon_Strings
HKTL_Win_CobaltStrike
SUSP_PS1_JAB_Pattern_Jun22_1
WiltedTulip_WindowsTask
CobaltStrike_Resources_Command_Ps1_v2_5_to_v3_7_and_Resources_Compress_Ps1_v3_8_to_v4_x
Cobaltbaltstrike_Payload_Encoded
Msfpayloads_msf_ref
CobaltStrike_Resources_Template_x64_Ps1_v3_0_to_v4_x_excluding_3_12_3_13
Windows_Shellcode_Generic_8c487e57
Cobaltbaltstrike_RAW_Payload_smb_stager_x86
Windows_Trojan_Metasploit_38b8ceec
CobaltStrike_Resources_Smbstager_Bin_v2_5_through_v4_x
Windows_Trojan_CobaltStrike_f0b627fc
CobaltStrike_Sleeve_BeaconLoader_HA_x64_o_v4_3_v4_4_v4_5_and_v4_6
CobaltStrike_C2_Encoded_XOR_Config_Indicator
SUSP_XORed_Mozilla
SUSP_PowerShell_IEX_Download_Combo
CobaltStrike_Sleeve_Beacon_Dll_v4_3_v4_4_v4_5_and_v4_6
Windows_Trojan_Metasploit_7bc0f998
Windows_Trojan_Metasploit_c9773203
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Rule authors:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Neo23x0/signature-base/blob/master/yara/apt_cobaltstrike_evasive.yar" target="_blank" rel="noreferrer noopener"><span class="__cf_email__" data-cfemail="aad3cbd8cbead999c984d0cb84c4cfde">[email&#160;protected]</span></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/elastic/protections-artifacts/tree/main/yara" target="_blank" rel="noreferrer noopener">Elastic Security</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/chronicle/GCTI/tree/main" target="_blank" rel="noreferrer noopener"><span class="__cf_email__" data-cfemail="046377776d6a67686544636b6b6368612a676b69">[email&#160;protected]</span></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/volexity/threat-intel/tree/main" target="_blank" rel="noreferrer noopener"><span class="__cf_email__" data-cfemail="91e5f9e3f4f0e5f8ffe5f4fdd1e7fefdf4e9f8e5e8bff2fefc">[email&#160;protected]</span></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Neo23x0/signature-base" target="_blank" rel="noreferrer noopener">Florian Roth (Nextron Systems)</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/avast/ioc/blob/master/CobaltStrike/yara_rules/cs_rules.yar" target="_blank" rel="noreferrer noopener">Avast Threat Intel Team</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE ATT&amp;CK</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-37749" src="https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1.png" alt="" width="1668" height="2228" srcset="https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1.png 1668w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1-225x300.png 225w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1-767x1024.png 767w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1-768x1026.png 768w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1-1150x1536.png 1150w, https://thedfirreport.com/wp-content/uploads/2024/08/26364_091-1-1533x2048.png 1533w" sizes="(max-width: 1668px) 100vw, 1668px" /></a></p>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">Abuse Elevation Control Mechanism - T1548
Archive Collected Data - T1560
AS-REP Roasting - T1558.004
Data Encrypted for Impact - T1486
Domain Groups - T1069.002
Domain Trust Discovery - T1482
Inhibit System Recovery - T1490
Kerberoasting - T1558.003
LSASS Memory - T1003.001
Malicious File - T1204.002
Modify Registry - T1112
PowerShell - T1059.001
Process Injection - T1055
Proxy - T1090
Registry Run Keys / Startup Folder - T1547.001
Remote Desktop Protocol - T1021.001
Remote System Discovery - T1018
Security Software Discovery - T1518.001
Service Execution - T1569.002
SMB/Windows Admin Shares - T1021.002
Software Discovery - T1518
System Information Discovery - T1082
Web Protocols - T1071.001
Windows Command Shell - T1059.003
Pass the Hash - T1550.002
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Internal case #TB29364 #PR31354</p>
<!-- /wp:paragraph --><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-37582" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-37582" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-37582" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-37582 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/" rel="prev">Threat Actors&#8217; Toolkit: Leveraging Sliver, PoshC2 &#038; Batch Scripts</a></div><div class="nav-next"><a href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/" rel="next">Nitrogen Campaign Drops Sliver and Ends With BlackCat Ransomware</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="1265e6b2da" /><input type="hidden" name="_wp_http_referer" value="/2024/08/26/blacksuit-ransomware/" /><input type="hidden" name="post_id" value="37582"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="bdd5951e1d0317a7b0650ce4-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2024\/08\/26\/blacksuit-ransomware\/":37582};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"37582\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "37582" ]);
/* ]]> */
</script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="bdd5951e1d0317a7b0650ce4-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="bdd5951e1d0317a7b0650ce4-|49" defer></script></body>
</html>
