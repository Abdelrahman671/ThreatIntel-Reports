<!DOCTYPE html><html
	class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light"
	lang="en-us"
	dir="ltr"
	data-authenticated="false"
	data-auth-status-determined="false"
	data-target="docs"
	x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Manage mail flow rules in Exchange Online" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/manage-mail-flow-rules" /><meta property="og:description" content="Admins can learn how to view, create, modify, remove enable or disable, and import or export mail flow rules in Exchange Online." /><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />

	<meta property="og:image:alt" content="Microsoft Learn" />

	<meta name="twitter:card" content="summary_large_image" />

	<meta name="twitter:site" content="@MicrosoftLearn" />

	<meta name="color-scheme" content="light dark"><meta name="audience" content="ITPro" />
<meta name="author" content="AshaIyengar21" />
<meta name="breadcrumb_path" content="/exchange/breadcrumb/toc.json" />
<meta name="depot_name" content="office.OfficeDocs-Exchange" />
<meta name="description" content="Admins can learn how to view, create, modify, remove enable or disable, and import or export mail flow rules in Exchange Online." />
<meta name="document_id" content="736d8598-4bde-5f1c-5eef-2f9b648912f6" />
<meta name="document_version_independent_id" content="eb74141c-161c-d1db-e95c-032f3dfdf8ec" />
<meta name="f1.keywords" content="NOCSH" />
<meta name="feedback_help_link_type" content="" />
<meta name="feedback_help_link_url" content="" />
<meta name="feedback_product_url" content="" />
<meta name="feedback_system" content="None" />
<meta name="git_commit_id" content="a24c7eb790f1a89adb05a350b80eb914f14b1c12" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/OfficeDocs-Exchange-pr/blob/a24c7eb790f1a89adb05a350b80eb914f14b1c12/Exchange/ExchangeOnline/security-and-compliance/mail-flow-rules/manage-mail-flow-rules.md" />
<meta name="locale" content="en-us" />
<meta name="manager" content="serdars" />
<meta name="Manager" content="serdars" />
<meta name="ms.assetid" content="e7a81372-b6d7-4d1f-bc9e-a845a7facac2" />
<meta name="ms.author" content="serdars" />
<meta name="ms.collection" content="exchange-online" />
<meta name="ms.collection" content="M365-email-calendar" />
<meta name="ms.date" content="8/28/2023" />
<meta name="ms.devlang" content="powershell" />
<meta name="ms.localizationpriority" content="medium" />
<meta name="ms.reviewer" content="" />
<meta name="ms.service" content="exchange-online" />
<meta name="ms.subservice" content="" />
<meta name="ms.topic" content="article" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/OfficeDocs-Exchange-pr/blob/live/Exchange/ExchangeOnline/security-and-compliance/mail-flow-rules/manage-mail-flow-rules.md" />
<meta name="page_type" content="conceptual" />
<meta name="pdf_url_template" content="https://learn.microsoft.com/pdfstore/en-us/office.OfficeDocs-Exchange/{branchName}{pdfName}" />
<meta name="recommendations" content="true" />
<meta name="ROBOTS" content="INDEX,FOLLOW" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="toc_rel" content="../../onlinetoc/toc.json" />
<meta name="uhfHeaderId" content="MSDocsHeader-Exchange" />
<meta name="updated_at" content="2024-02-23 06:40 PM" />
<meta name="word_count" content="2821" />
<meta name="persistent_id" content="1d58e732-3e9c-6fca-26cb-b25432b1401d" />
	
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/1ae5c491-970a-4062-8301-6336e69f9026" data-source="generated" />
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/cf9b82c5-b6dc-45f3-b005-b1bc5fc03bea" data-source="generated" />
	
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/f2c3e52e-3667-4e8a-bf11-20b9eaccdc8c" data-source="generated" />
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/0c85d34e-bfd2-4466-957c-f0b61e9692df" data-source="generated" />
	<meta name="scope" content="Exchange" /><meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/OfficeDocs-Exchange-pr/blob/live/Exchange/ExchangeOnline/security-and-compliance/mail-flow-rules/manage-mail-flow-rules.md" /><link href="https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/manage-mail-flow-rules" rel="canonical"><title>Manage mail flow rules in Exchange Online | Microsoft Learn</title><link rel="stylesheet" href="/static/assets/0.4.028516059/styles/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: true,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',extendBreadcrumb: true,isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,contributors: [{ name: "AshaIyengar21", url: "https://github.com/AshaIyengar21" },{ name: "v-smandalika", url: "https://github.com/v-smandalika" },{ name: "chrisda", url: "https://github.com/chrisda" },{ name: "arindamthokder", url: "https://github.com/arindamthokder" },{ name: "get-itips", url: "https://github.com/get-itips" },{ name: "robmazz", url: "https://github.com/robmazz" },{ name: "chrfox", url: "https://github.com/chrfox" },{ name: "JoanneHendrickson", url: "https://github.com/JoanneHendrickson" },{ name: "DCtheGeek", url: "https://github.com/DCtheGeek" },{ name: "Benny-54", url: "https://github.com/Benny-54" },{ name: "dariomws", url: "https://github.com/dariomws" },{ name: "mattpennathe3rd", url: "https://github.com/mattpennathe3rd" },{ name: "Ajayan1008", url: "https://github.com/Ajayan1008" },{ name: "tiburd", url: "https://github.com/tiburd" },{ name: "TomonoriAbe", url: "https://github.com/TomonoriAbe" },{ name: "msdmaguire", url: "https://github.com/msdmaguire" },{ name: "AndreaBarr", url: "https://github.com/AndreaBarr" },{ name: "SharS", url: "https://github.com/SharS" }],},
		functions:{}
	};
	</script><script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script><script src="/static/assets/0.4.028516059/global/deprecation.js"></script><script src="/static/assets/0.4.028516059/scripts/en-us/index-docs.js"></script></head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a><div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">Download Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">More info about Internet Explorer and Microsoft Edge</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
			<div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button>
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none">

										</div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs><div id="article-header-page-actions"  class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
											id="lang-link-tablet"
											class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
											title="Read in English" data-bi-name="language-toggle"
											data-read-in-link
											hidden>
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon>
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text>Read in English</span>
										</a><button
												type="button"
												class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet"
												data-list-type="collection"
												data-bi-name="collection"
												title="Add to collection">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Save</span>
											</button><a	data-contenteditbtn
												class="button button-clear button-sm text-decoration-none button-primary display-none display-inline-flex-tablet"
												aria-label="Edit"
												title="Edit This Document"
												data-bi-name="edit"
													hidden
														href="https://github.com/MicrosoftDocs/OfficeDocs-Exchange-pr/blob/live/Exchange/ExchangeOnline/security-and-compliance/mail-flow-rules/manage-mail-flow-rules.md">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-edit-outline"></span>
												</span>
											</a>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button
														data-page-action-item="overflow-mobile"
														type="button"
														class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
														data-bi-name="contents-expand"
														data-contents-button
														data-popover-close>
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span></button><a
													id="lang-link-overflow"
													class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
													title="Read in English" data-bi-name="language-toggle"
													data-page-action-item="overflow-mobile"
													data-check-hidden="true"
													data-read-in-link
													hidden
													>
													<span class="icon" aria-hidden="true" data-read-in-link-icon>
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text>Read in English</span>
												</a><button
														type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="collection"
														data-bi-name="collection"
														title="Save"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Save</span>
													</button>

			 										
													<button
													 	type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="plan"
														data-bi-name="plan"
														title="Add to Plan"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close
														hidden>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">Add to Plan</span>
													</button><a	data-contenteditbtn
														class="button button-clear button-block button-sm has-inner-focus justify-content-flex-start text-decoration-none display-none-tablet"
														aria-label="Edit"
														title="Edit This Document"
														data-bi-name="edit"
															hidden
																href="https://github.com/MicrosoftDocs/OfficeDocs-Exchange-pr/blob/live/Exchange/ExchangeOnline/security-and-compliance/mail-flow-rules/manage-mail-flow-rules.md">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-edit-outline"></span>
														</span>
														<span>Edit</span>
													</a><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs" />
														<h4 class="font-size-sm padding-left-xxs">Share via</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">Email</span>
														</a><hr />
													<button
														class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
														title="Print"
														type="button"
														aria-label="Print"
														data-bi-name="print"
														data-page-action-item="overflow-all"
														data-popover-close
														data-print-page
														data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">Print</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button hidden>
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="manage-mail-flow-rules-in-exchange-online">Manage mail flow rules in Exchange Online</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr"><li>Article</li><li class="visibility-hidden-visual-diff"><time class="is-invisible" data-article-date aria-label="Article review date" datetime="2024-02-09T10:02:00Z" data-article-date-source="calculated">02/09/2024</time>
															</li><li class="contributors-holder display-none-print">
															<button aria-label="View all contributors" class="contributors-button link-button" data-bi-name="contributors" title="View all contributors">18 contributors</button>
														</li></ul>
										</div>
<div id="user-feedback" class="margin-block-xxs display-none-print" data-hide-on-archived>
	<button
		id="user-feedback-button"
		data-test-id="conceptual-feedback-button"
		class="button button-sm button-clear button-primary"
		type="button"
		data-bi-name="user-feedback-button"
		data-user-feedback-button
	>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-like"></span>
		</span>
		<span>Feedback</span>
	</button>
</div></div><nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav><!-- <content> --><p>In Exchange Online organizations or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, you can use Exchange mail flow rules (also known as transport rules) to look for specific conditions on messages that pass through your organization and take action on them.</p>
<p>This article shows you how to <a href="#create-a-mail-flow-rule" data-linktype="self-bookmark">create</a>, <a href="#use-the-eac-to-copy-a-mail-flow-rule" data-linktype="self-bookmark">copy</a>, <a href="#set-the-priority-of-a-mail-flow-rule" data-linktype="self-bookmark">adjust the order</a>, <a href="#enable-or-disable-a-mail-flow-rule" data-linktype="self-bookmark">enable or disable</a>, <a href="#remove-a-mail-flow-rule" data-linktype="self-bookmark">delete</a>, <a href="#import-or-export-a-mail-flow-rule-collection-in-exchange-online" data-linktype="self-bookmark">import or export</a> rules, and <a href="#monitor-rule-usage" data-linktype="self-bookmark">monitor rule usage</a>.</p>
<div class="TIP">
<p>Tip</p>
<p>To ensure that your rules work the way you expect, ensure that you thoroughly test each rule and interactions between rules.</p>
</div>
<h2 id="what-do-you-need-to-know-before-you-begin">What do you need to know before you begin?</h2>
<ul>
<li><p>Estimated time to complete each procedure: 5 minutes.</p>
</li>
<li><p>For information about how to access the Exchange admin center (EAC), see <a href="../../exchange-admin-center" data-linktype="relative-path">Exchange admin center in Exchange Online</a>. To connect to Exchange Online PowerShell, see <a href="/en-us/powershell/exchange/connect-to-exchange-online-powershell" data-linktype="absolute-path">Connect to Exchange Online PowerShell</a>. To connect to standalone EOP PowerShell, see <a href="/en-us/powershell/exchange/connect-to-exchange-online-protection-powershell" data-linktype="absolute-path">Connect to standalone Exchange Online Protection PowerShell</a>.</p>
</li>
<li><p>You need to be assigned permissions before you can perform these procedures. To see what permissions you need, see the "Mail flow" entry in <a href="../../permissions-exo/feature-permissions" data-linktype="relative-path">Feature permissions in Exchange Online</a>.</p>
</li>
<li><p>For information about keyboard shortcuts that may apply to the procedures in this article, see <a href="../../accessibility/keyboard-shortcuts-in-admin-center" data-linktype="relative-path">Keyboard shortcuts for the Exchange admin center</a>.</p>
</li>
</ul>
<div class="TIP">
<p>Tip</p>
<p>Having problems? Ask for help in the Exchange forums. Visit the forums at <a href="/en-us/answers/articles/office-exchange-server-itpro.html" data-linktype="absolute-path">Exchange Online</a> or <a href="https://social.technet.microsoft.com/forums/forefront/home?forum=FOPE" data-linktype="external">Exchange Online Protection</a>.</p>
</div>
<h2 id="create-a-mail-flow-rule">Create a mail flow rule</h2>
<p>You can create a mail flow rule in the EAC or in PowerShell. In the EAC, you can also create a mail flow rule by copying an existing rule.</p>
<div class="NOTE">
<p>Note</p>
<p>After you create or copy a mail flow rule, it might take 30 minutes or more for the new rule to be applied to emails.</p>
</div>
<h3 id="use-the-eac-to-create-a-mail-flow-rule">Use the EAC to create a mail flow rule</h3>
<p>The EAC allows you to create mail flow rules by selecting a template or starting from scratch.</p>
<ol>
<li><p>In the new EAC at <a href="https://admin.exchange.microsoft.com" data-linktype="external">https://admin.exchange.microsoft.com</a>, go to <strong>Mail flow</strong> &gt; <strong>Rules</strong>. Or, to go directly to the <strong>Rules</strong> page, use <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>.</p>
</li>
<li><p>On the <strong>Rules</strong> page, create the rule by using one of the following options:</p>
<ul>
<li>To create a rule from a template, select <strong>Add a rule</strong> <img src="../../exchangeonline/media/itpro_eac_addicon.gif" alt="Add Icon." data-linktype="relative-path"> and select a template from the drop-down list.</li>
<li>To create a new rule from scratch, select <strong>Add a rule</strong> <img src="../../exchangeonline/media/itpro_eac_addicon.gif" alt="Add Icon." data-linktype="relative-path"> &gt; <strong>Create a new rule</strong>.</li>
</ul>
<p>The new rule wizard opens.</p>
</li>
<li><p>On the <strong>Set rule conditions</strong> page, enter a unique name for the rule in the <strong>Name</strong> box, and then select the conditions, exceptions, and actions for the rule:</p>
<ul>
<li><p><strong>Apply this rule if...</strong>: Select a condition from the list.</p>
<ul>
<li>Some conditions require other values. For example, if you select <strong>The sender is...</strong>, you also need to specify a sender address. If you're adding a word or phrase, trailing spaces aren't allowed.</li>
<li>To add more conditions, select <strong>Add condition</strong> <img src="../../exchangeonline/media/itpro_eac_addicon.gif" alt="Add Icon." data-linktype="relative-path"> and then repeat this step.</li>
<li>Select <strong>Delete condition</strong> <img src="../../exchangeonline/media/itpro_eac_deleteicon.gif" alt="Delete icon." data-linktype="relative-path"> to remove the condition.</li>
<li>To apply to all messages in the organization, select the <strong>Apply to all messages</strong> condition.</li>
</ul>
</li>
<li><p><strong>Do the following...</strong>: Select an action from the list.</p>
<ul>
<li>Some actions require other values. For example, if you select <strong>Forward the message for approval to...</strong>, you need to select a recipient in your organization.</li>
<li>To add more actions, select <strong>Add action</strong> <img src="../../exchangeonline/media/itpro_eac_addicon.gif" alt="Add Icon." data-linktype="relative-path"> and then repeat this step.</li>
<li>Select <strong>Delete action</strong> <img src="../../exchangeonline/media/itpro_eac_deleteicon.gif" alt="Delete icon." data-linktype="relative-path"> to remove the action.</li>
</ul>
</li>
<li><p><strong>Except if...</strong>: Use this setting to specify any exceptions to the rule. The available exceptions are identical to the available conditions.</p>
<ul>
<li>Some exceptions require other values. For example, if you select <strong>The sender is...</strong>, you also need to specify a sender address. If you're adding a word or phrase, trailing spaces aren't allowed.</li>
<li>To add more exceptions, select <strong>Add exception</strong> <img src="../../exchangeonline/media/itpro_eac_addicon.gif" alt="Add Icon." data-linktype="relative-path"> and then repeat this step.</li>
<li>Select <strong>Delete exception</strong> <img src="../../exchangeonline/media/itpro_eac_deleteicon.gif" alt="Delete icon." data-linktype="relative-path"> to remove the exception.</li>
</ul>
</li>
</ul>
<p>When you're finished on the <strong>Set rule conditions</strong> page, select <strong>Next</strong>.</p>
</li>
<li><p>On the <strong>Set rule settings</strong> page, configure the following settings:</p>
<ul>
<li><p><strong>Rule mode</strong>: Select one of the following values:</p>
<ul>
<li><strong>Enforce</strong>: Turn on the rule and start processing messages immediately. All actions on the rule are taken.</li>
<li><strong>Test with Policy Tips</strong>: Turn on the rule, and any Policy Tip actions ( <strong>Notify the sender with a Policy Tip</strong>) are sent, but no actions related to message delivery are taken.</li>
<li><strong>Test without Policy Tips</strong>: Only the <strong>Generate incident report</strong> action is enforced. No actions related to message delivery are taken.</li>
</ul>
</li>
<li><p><strong>Severity</strong>: Select a severity level for this rule. Rule matches are grouped by severity level in activity reports. Severity level is just a filter to make the reports easier to use. The severity level has no impact on the priority that the rule is processed in.</p>
<ul>
<li><strong>Not specified</strong></li>
<li><strong>Low</strong></li>
<li><strong>Medium</strong></li>
<li><strong>High</strong></li>
<li><strong>Not audit</strong>: Rule matches don't appear in rule reports.</li>
</ul>
</li>
<li><p><strong>Activate this rule on</strong> and <strong>Deactivate this rule on</strong>: Use these settings to turn the rule on and off for a specific time period. If you create the rule before <strong>Activate this rule on</strong> date, the rule is enabled but it isn't processed. After the <strong>Deactivate this rule on</strong> date, the rule remains enabled but it isn't processed.</p>
</li>
<li><p><strong>Stop processing more rules</strong>: Use this setting to prevent additional rules from being applied to the message after this rule. If a message is processed by this rule, no subsequent rules are processed for that message.</p>
</li>
<li><p><strong>Defer the message if rule processing doesn't complete</strong>: Specify how the message should be handled if rule processing can't finish. By default, the rule is ignored and processing of the message by other rules continues. If you select this option, the message is resubmitted for processing.</p>
</li>
<li><p><strong>Match sender address in message</strong>: Specify which email address is evaluated by conditions or exceptions that inspect the sender's email address:</p>
<ul>
<li><strong>Header</strong>: Only the message headers are examined.</li>
<li><strong>Envelope</strong>: Only the SMTP message envelope is examined.</li>
<li><strong>Header or envelope</strong>: Both the message headers and SMTP message envelope are examined.</li>
</ul>
</li>
<li><p><strong>Comments</strong>: Add an optional comment to the rule.</p>
</li>
</ul>
<p>When you're finished on the <strong>Set rule settings</strong> page, select <strong>Next</strong>.</p>
</li>
<li><p>On the <strong>Review and finish</strong> page, verify the settings. Select <strong>Back</strong> or use the <strong>Edit rule conditions</strong> or <strong>Edit rule settings</strong> links to modify the settings.</p>
<p>When you're finished on the <strong>Review and finish</strong> page, select <strong>Finish</strong>.</p>
</li>
<li><p>On the confirmation page, select <strong>Done</strong>.</p>
</li>
</ol>
<h3 id="use-exchange-online-powershell-to-create-a-mail-flow-rule">Use Exchange Online PowerShell to create a mail flow rule</h3>
<p>The following example creates a new mail flow rule that prepends the text <code>External message to Sales DG:</code> to the Subject line of external messages that are sent to the Sales Department distribution group:</p>
<pre><code class="lang-PowerShell">New-TransportRule -Name "Mark messages from the Internet to Sales DG" -FromScope NotInOrganization -SentTo "Sales Department" -PrependSubject "External message to Sales DG:"
</code></pre>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/new-transportrule" data-linktype="absolute-path">New-TransportRule</a>.</p>
<div class="NOTE">
<p>Note</p>
<p>The parameters and action used in the previous example are for illustration only. Review all the available mail flow rule conditions and actions to determine which ones meet your requirements.</p>
</div>
<h3 id="use-the-eac-to-copy-a-mail-flow-rule">Use the EAC to copy a mail flow rule</h3>
<ol>
<li><p>In the new EAC at <a href="https://admin.exchange.microsoft.com" data-linktype="external">https://admin.exchange.microsoft.com</a>, go to <strong>Mail flow</strong> &gt; <strong>Rules</strong>. Or, to go directly to the <strong>Rules</strong> page, use <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>.</p>
</li>
<li><p>On the <strong>Rules</strong> page, select the rule by selecting the radio button that appears next to the <strong>Status</strong> value, and then select the <strong>Duplicate</strong> <img src="../../exchangeonline/media/itpro_eac_copyicon.gif" alt="Copy Icon." data-linktype="relative-path"> action that appears.</p>
</li>
<li><p>In the <strong>Make a copy of "&lt;Rule Name&gt;"</strong> flyout that opens, the values on the <strong>Conditions</strong> and <strong>Settings</strong> tabs are filled in with the settings of the copied rule. The default name is <strong>Copy of &lt;Rule Name&gt;</strong>. You can change any of the rule settings. The available settings are identical to creating a new rule as explained in the <a href="#use-the-eac-to-create-a-mail-flow-rule" data-linktype="self-bookmark">Use the EAC to create a mail flow rule</a> section.</p>
</li>
<li><p>When you finished editing the settings of the rule, select <strong>Make copy</strong> at the bottom of the flyout.</p>
</li>
<li><p>In the confirmation flyout that opens, select <strong>Duplicate</strong>.</p>
</li>
<li><p>In the success flyout that opens, select <strong>Close X</strong>.</p>
</li>
</ol>
<h3 id="how-do-you-know-that-youve-successfully-created-a-mail-flow-rule">How do you know that you've successfully created a mail flow rule?</h3>
<p>To verify that you've successfully created a mail flow rule, do either of the following steps:</p>
<ul>
<li><p>On the <strong>Rules</strong> page in the EAC at <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>, verify that the mail flow rule you created or copied is listed.</p>
</li>
<li><p>In Exchange Online PowerShell, replace &lt;New Rule Name&gt; with the name of the rule that you created or copied and run the following command:</p>
<pre><code class="lang-PowerShell">Get-TransportRule -Identity "&lt;New Rule Name&gt;""
</code></pre>
</li>
</ul>
<h2 id="view-or-modify-a-mail-flow-rule">View or modify a mail flow rule</h2>
<div class="NOTE">
<p>Note</p>
<p>After you modify a mail flow rule, it might take 30 minutes or more for the updated rule to be applied to emails.</p>
</div>
<h3 id="use-the-eac-to-view-or-modify-a-mail-flow-rule">Use the EAC to view or modify a mail flow rule</h3>
<ol>
<li>In the new EAC at <a href="https://admin.exchange.microsoft.com" data-linktype="external">https://admin.exchange.microsoft.com</a>, go to <strong>Mail flow</strong> &gt; <strong>Rules</strong>. Or, to go directly to the <strong>Rules</strong> page, use <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>.</li>
<li>On the <strong>Rules</strong> page, select a rule from the list by clicking anywhere in the row other than the round checkbox next to the name.</li>
<li>In the details flyout that opens you can see the existing settings and make changes by selecting <strong>Edit rule conditions</strong> and <strong>Edit rule settings</strong> at the top of the flyout. The available settings are identical to creating a new rule as explained in the <a href="#use-the-eac-to-create-a-mail-flow-rule" data-linktype="self-bookmark">Use the EAC to create a mail flow rule</a> section.</li>
</ol>
<h3 id="use-exchange-online-powershell-to-view-or-modify-a-mail-flow-rule">Use Exchange Online PowerShell to view or modify a mail flow rule</h3>
<p>The following example returns a summary list of all mail flow rules in the organization:</p>
<pre><code class="lang-PowerShell">Get-TransportRule
</code></pre>
<p>To view the detailed information about a specific mail flow rule, provide the unique identifier for the rule (for example, Name, DistinguishedName, or GUID). It's helpful to send the output to the <strong>Format-List</strong> cmdlet to format the properties.</p>
<p>The following example returns all the properties of the specified mail flow rule:</p>
<pre><code class="lang-PowerShell">Get-TransportRule -Identity "Sender is a member of marketing" | Format-List
</code></pre>
<p>The following example adds an exception to the existing rule named "Sender is a member of marketing" so that it doesn't apply to messages sent by the user Kelly Rollin:</p>
<pre><code class="lang-PowerShell">Set-TransportRule -Identity "Sender is a member of marketing" -ExceptIfFrom "Kelly Rollin"
</code></pre>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/set-transportrule" data-linktype="absolute-path">Set-TransportRule</a>.</p>
<h3 id="how-do-you-know-that-youve-successfully-modified-a-mail-flow-rule">How do you know that you've successfully modified a mail flow rule?</h3>
<p>To verify that you've successfully modified a mail flow rule, do either of the following steps:</p>
<ul>
<li><p>On the <strong>Rules</strong> page in the EAC at <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>, select the rule that you modified by clicking anywhere in the row other than the radio button next to the <strong>Status</strong> value. In the details flyout that opens, confirm the settings.</p>
</li>
<li><p>In Exchange Online PowerShell, replace &lt;Rule Name&gt; with the name of the rule that you modified and run the following command:</p>
<pre><code class="lang-PowerShell">Get-TransportRule -Identity "&lt;Rule Name&gt;" | Format-List Name,ExceptIfFrom
</code></pre>
</li>
</ul>
<h2 id="set-the-priority-of-a-mail-flow-rule">Set the priority of a mail flow rule</h2>
<p>On the <strong>Rules</strong> page in the EAC, mail flow rules are shown in the order that they're processed. The rule at the top of the list has the <strong>Priority</strong> value 0 and is processed first.</p>
<h3 id="use-the-eac-to-set-the-priority-of-a-rule">Use the EAC to set the priority of a rule</h3>
<ol>
<li>In the EAC at <a href="https://admin.exchange.microsoft.com" data-linktype="external">https://admin.exchange.microsoft.com</a>, go to <strong>Mail flow</strong> &gt; <strong>Rules</strong>. Or, to go directly to the <strong>Rules</strong> page, use <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>.</li>
<li>On the <strong>Rules</strong> page, select a rule by selecting the radio button next to the <strong>Status</strong> value, and then select the <strong>Move up</strong> or <strong>Move down</strong> actions to move the rule up or down the list.</li>
</ol>
<h3 id="use-exchange-online-powershell-to-set-the-priority-of-a-rule">Use Exchange Online PowerShell to set the priority of a rule</h3>
<p>The following example sets the priority of the specified mail flow rule to 2:</p>
<pre><code class="lang-PowerShell">Set-TransportRule -Identity "Sender is a member of Marketing" -Priority "2"
</code></pre>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/set-transportrule" data-linktype="absolute-path">Set-TransportRule</a>.</p>
<h3 id="how-do-you-know-that-youve-successfully-set-the-priority-of-a-mail-flow-rule">How do you know that you've successfully set the priority of a mail flow rule</h3>
<p>To verify that you've successfully set the priority of a mail flow rule, do either of the following steps:</p>
<ul>
<li><p>On the <strong>Rules</strong> page in the EAC at <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>, verify the order of the rules.</p>
</li>
<li><p>In Exchange Online PowerShell, run the following command:</p>
<pre><code class="lang-PowerShell">Get-TransportRule | Format-List Name,Priority
</code></pre>
</li>
</ul>
<h2 id="enable-or-disable-a-mail-flow-rule">Enable or disable a mail flow rule</h2>
<p>By default, the status of mail flow rule is disabled when you create them using EAC. This is done so that you can review the rule one more time before finally enabling it. You can enable the rule after the rule creation is complete.</p>
<h3 id="use-the-eac-to-enable-or-disable-a-mail-flow-rule">Use the EAC to enable or disable a mail flow rule</h3>
<ol>
<li>In the EAC at <a href="https://admin.exchange.microsoft.com" data-linktype="external">https://admin.exchange.microsoft.com</a>, go to <strong>Mail flow</strong> &gt; <strong>Rules</strong>. Or, to go directly to the <strong>Rules</strong> page, use <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>.</li>
<li>On the <strong>Rules</strong> page, select the rule by clicking anywhere in the row other than the radio button next to the name. The <strong>Status</strong> value of the rule is <strong>Enabled</strong> or <strong>Disabled</strong>.</li>
<li>In the details flyout that opens, use the toggle in the <strong>Enable or disable rule</strong> section near the top of the flyout to enable or disable the rule.</li>
</ol>
<h3 id="use-exchange-online-powershell-to-enable-or-disable-a-mail-flow-rule">Use Exchange Online PowerShell to enable or disable a mail flow rule</h3>
<p>The following example disables the specified mail flow rule:</p>
<pre><code class="lang-PowerShell">Disable-TransportRule -Identity "Sender is a member of marketing"
</code></pre>
<p>The following example enables the specified mail flow rule:</p>
<pre><code class="lang-PowerShell">Enable-TransportRule -Identity "Sender is a member of marketing"
</code></pre>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/disable-transportrule" data-linktype="absolute-path">Disable-TransportRule</a> and <a href="/en-us/powershell/module/exchange/enable-transportrule" data-linktype="absolute-path">Enable-TransportRule</a>.</p>
<h3 id="how-do-you-know-youve-successfully-enabled-or-disabled-a-mail-flow-rule">How do you know you've successfully enabled or disabled a mail flow rule?</h3>
<p>To verify that you've successfully enabled or disabled a mail flow rule, do either of the following steps:</p>
<ul>
<li><p>On the <strong>Rules</strong> page in the EAC at <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>, verify the value in the <strong>Status</strong> column.</p>
</li>
<li><p>In Exchange Online PowerShell, run the following command to return a list of all rules in your organization along with their status values:</p>
<pre><code class="lang-PowerShell">Get-TransportRule | Format-Table Name,State
</code></pre>
</li>
</ul>
<h2 id="remove-a-mail-flow-rule">Remove a mail flow rule</h2>
<h3 id="use-the-eac-to-remove-a-mail-flow-rule">Use the EAC to remove a mail flow rule</h3>
<ol>
<li>In the EAC at <a href="https://admin.exchange.microsoft.com" data-linktype="external">https://admin.exchange.microsoft.com</a>, go to <strong>Mail flow</strong> &gt; <strong>Rules</strong>. Or, to go directly to the <strong>Rules</strong> page, use <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>.</li>
<li>On the <strong>Rules</strong> page, select the rule by selecting the radio button next to the <strong>Status</strong> value, and then select the <strong>Delete</strong> <img src="../../exchangeonline/media/itpro_eac_deleteicon.gif" alt="Delete icon." data-linktype="relative-path"> action that appears.</li>
<li>In the confirmation flyout that opens, select <strong>Confirm</strong>.</li>
</ol>
<h3 id="use-exchange-online-powershell-to-remove-a-mail-flow-rule">Use Exchange Online PowerShell to remove a mail flow rule</h3>
<p>The following example removes the specified mail flow rule:</p>
<pre><code class="lang-PowerShell">Remove-TransportRule -Identity "Sender is a member of marketing"
</code></pre>
<p>For detailed syntax and parameter information, see <a href="/en-us/powershell/module/exchange/remove-transportrule" data-linktype="absolute-path">Remove-TransportRule</a>.</p>
<h3 id="how-do-you-know-that-youve-successfully-removed-a-mail-flow-rule">How do you know that you've successfully removed a mail flow rule?</h3>
<p>To verify that you've successfully removed the mail flow rule, do either of the following steps:</p>
<ul>
<li><p>On the <strong>Rules</strong> page of the EAC at <a href="https://admin.exchange.microsoft.com/#/transportrules" data-linktype="external">https://admin.exchange.microsoft.com/#/transportrules</a>, verify that the rule you removed is no longer listed.</p>
</li>
<li><p>In Exchange Online PowerShell, run the following command and verify that the rule you removed is no longer listed:</p>
<pre><code class="lang-PowerShell">Get-TransportRule
</code></pre>
</li>
</ul>
<h2 id="monitor-rule-usage">Monitor rule usage</h2>
<p>You can check the number of times each rule is matched by using <strong>Exchange Transport Rule report</strong> in the EAC. For a rule to be included in the report, a rule can't have the <strong>Severity</strong> value <strong>Not audit</strong> (all other values are OK). You can view the report online, or download report data to a .csv file.</p>
<div class="NOTE">
<p>Note</p>
<p>While most data is in the report within 24 hours, some data may take as long as 5 days to appear.</p>
</div>
<ol>
<li>In the EAC at <a href="https://admin.exchange.microsoft.com" data-linktype="external">https://admin.exchange.microsoft.com</a>, go to <strong>Reports</strong> &gt; <strong>Mail flow</strong>. Or, to go directly to the <strong>Mail flow reports</strong> page, use <a href="https://admin.exchange.microsoft.com/#/reports/mailflowreportsmain" data-linktype="external">https://admin.exchange.microsoft.com/#/reports/mailflowreportsmain</a>.</li>
<li>On the <strong>Mail flow reports</strong> page, find and select <strong>Exchange Transport Rule report</strong>.</li>
</ol>
<p>For details about the report, see <a href="../../monitoring/mail-flow-reports/mfr-exchange-transport-rule-report" data-linktype="relative-path">Exchange transport rule report in the new Exchange admin center in Exchange Online</a>.</p>
<h2 id="import-or-export-a-mail-flow-rule-collection-in-exchange-online">Import or export a mail flow rule collection in Exchange Online</h2>
<p>Use the <strong>Export-TransportRuleCollection</strong> cmdlet in <a href="/en-us/powershell/exchange/connect-to-exchange-online-powershell" data-linktype="absolute-path">Exchange Online PowerShell</a> to export all of the mail flow rules in the organization to an XML file. For more information, see <a href="/en-us/powershell/module/exchange/export-transportrulecollection" data-linktype="absolute-path">Export-TransportRuleCollection</a>.</p>
<p>The <strong>Import-TransportRuleCollection</strong> cmdlet will be deprecated from Exchange Online PowerShell. To manually import a mail flow rules collection XML file in Exchange Online PowerShell, do the following steps:</p>
<ol>
<li><p>Back up all existing mail flow rules using the <strong>Export-TransportRuleCollection</strong> cmdlet (the next step removes all existing mail flow rules, just like the <strong>Import-TransportRuleCollection</strong> cmdlet did). For example:</p>
<pre><code class="lang-powershell">$file = Export-TransportRuleCollection

[System.IO.File]::WriteAllBytes('C:\MailFlowRuleCollections\BackupRuleCollection.xml', $file.FileData)
</code></pre>
</li>
<li><p>Remove all existing mail flow rules in the organization by running the following command:</p>
<pre><code class="lang-powershell">Get-TransportRule | foreach {Remove-TransportRule $_.Guid -Confirm:$false}
</code></pre>
</li>
<li><p>Copy the following text into Notepad:</p>
<pre><code class="lang-powershell">if ((Get-TransportRule).Count -ne 0)

{
   Write-Host "Please remove your current mail flow rules first."

    return
}

[xml]$xml = Get-Content "C:\MailFlowRuleCollections\RuleCollectionToImport.xml"

$rulesToImport = $xml.SelectNodes("//rules/rule")

if ($rulesToImport.Count -eq 0)

{
    Write-Host "There are no mail flow rules to be imported."

    return
}

Write-Host "Importing $($rulesToImport.Count) mail flow rules."

$index = 0

foreach ($rule in $rulesToImport)

{
    $index++

    Write-Host "Importing rule '$($rule.Name)' $index/$($rulesToImport.Count)."

    Invoke-Expression $($rule.version.commandBlock.InnerText) | Out-Null
}
</code></pre>
</li>
<li><p>Update the following line with the path and filename of the mail flow rule XML collection that you want to import:</p>
<pre><code class="lang-powershell">[xml]$xml = Get-Content "C:\MailFlowRuleCollections\RuleCollectionToImport.xml"
</code></pre>
</li>
<li><p>Save the file as .ps1 in a location that's easy for you to find (for example, <code>C:\Data\Import-Rules.ps1</code>).</p>
</li>
<li><p>In PowerShell, use the following syntax to run the script:</p>
<pre><code class="lang-powershell">&amp; "&lt;Path to script file&gt;\&lt;FileName&gt;.ps1"
</code></pre>
<p>For example:</p>
<pre><code class="lang-powershell">&amp; "C:\Data\Import-Rules.ps1"
</code></pre>
</li>
</ol>
<h2 id="need-more-help">Need more help?</h2>
<p><a href="mail-flow-rules" data-linktype="relative-path">Mail flow rules (transport rules) in Exchange Online</a></p>
<p><a href="conditions-and-exceptions" data-linktype="relative-path">Mail flow rule conditions and exceptions (predicates) in Exchange Online</a></p>
<p><a href="mail-flow-rule-actions" data-linktype="relative-path">Mail flow rule actions in Exchange Online</a></p>
<p><a href="/en-us/office365/servicedescriptions/exchange-online-service-description/exchange-online-limits#journal-transport-and-inbox-rule-limits" data-linktype="absolute-path">Journal, transport, and inbox rule limits</a></p>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside
								id="ms--additional-resources-mobile"
								aria-label="Additional resources"
								class="display-none-desktop display-none-print"
							>
								<hr class="hr" hidden />
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer></div></div><div
							id="ms--additional-resources"
							class="right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Additional resources"
						>
							<div id="affixed-right-container" class="margin-top-sm-tablet" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden>Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer>

	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>