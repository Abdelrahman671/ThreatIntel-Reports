<!doctype html>
<html lang="en-US">

<head>
      <meta charset="UTF-8">
      <link rel="shortcut icon" type="image/x-icon" href="https://securityintelligence.com/wp-content/themes/sapphire/images/favicon.ico" sizes="32x32" />      <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1">

      <!-- DEFINITIONS -->
      <title>Stealthy WailingCrab Malware misuses MQTT Messaging Protocol</title>

            <!--<meta name="description" content="">-->


     

      <!-- THEME COLOR -->
      <meta name="theme-color" content="#000000">

      <!-- REFERRER POLICY -->
      <meta name="referrer" content="no-referrer-when-downgrade">

      <script src="https://1.www.s81c.com/common/stats/ibm-common.js" type="text/javascript" async="async"></script>

      <!-- LANGUAGE/TRANSLATIONS -->

      <!-- AMP SCRIPTS -->
      <script async src="https://cdn.ampproject.org/v0.js"></script>
      <script async custom-element="amp-list" src="https://cdn.ampproject.org/v0/amp-list-0.1.js"></script>
      <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"></script>
      <script async custom-element="amp-accordion" src="https://cdn.ampproject.org/v0/amp-accordion-0.1.js"></script>
      <script custom-element="amp-animation" src="https://cdn.ampproject.org/v0/amp-animation-0.1.js" async></script>
      <script custom-element="amp-position-observer" src="https://cdn.ampproject.org/v0/amp-position-observer-0.1.js" async></script>
      <script async custom-element="amp-bind" src="https://cdn.ampproject.org/v0/amp-bind-0.1.js"></script>
      <script async custom-element="amp-autocomplete" src="https://cdn.ampproject.org/v0/amp-autocomplete-0.1.js"></script>
      <script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>
      <script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/version/v1.35.0/card-section-simple.min.js"></script>
      <script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/tag/v1/latest/card-section-simple.min.js"></script>
      <script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/tag/v1/next/card-section-simple.min.js"></script>
      <script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/version/v2.11.0/card.min.js"></script>
      <script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/version/v2.11.0/image.min.js"></script>

      

      
      
      
                  <script async custom-element="amp-lightbox-gallery" src="https://cdn.ampproject.org/v0/amp-lightbox-gallery-0.1.js"></script>
            <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
            <script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script>
            <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
                              <link rel="preload" as="image" href="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/Closeup-on-modern-female-with-laptop-writing-code-300x158.jpeg.webp" media="(max-width: 300px)">
                  <link rel="preload" as="image" href="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/Closeup-on-modern-female-with-laptop-writing-code-630x330.jpeg.webp" media="(max-width: 1200px) and (min-width: 301px)">
                  <link rel="preload" as="image" href="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/Closeup-on-modern-female-with-laptop-writing-code.jpeg.webp" media="(max-width: 2400px) and (min-width: 631px)">
                  <link rel="preload" as="image" href="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/Closeup-on-modern-female-with-laptop-writing-code.jpeg.webp" media="(max-width: 2400px) and (min-width: 1201px)">
                  
      
      <!-- FONTS -->
      <!-- <link rel="preload" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans+Condensed:300,400,500|IBM+Plex+Sans:300,400,500&display=swap" rel="stylesheet"> -->

      <!-- ANALYTICS -->
      <script>
      
      // Digital Registry
      digitalData = {
            "page": {
                  "category": {
                        "primaryCategory": "Threat Intelligence"
                  },
                  "pageInfo": {
                        "language": "en-US",
                        "country": "US",
                        "version": "custom",
                        "effectiveDate": "2023-11-21",
                        "publishDate": "2023-11-21",
                        "optimizely": {
                              "enabled": "false",
                        },
                        "ibm": {
                              "contentDelivery": "WordPress",
                              "contentProducer": "Hand coded",
                              "owner": "",
                              "siteID": "SECURITYINTELLIGENCE",
                              "type": "Xforce",
                                                      }
                  }
            }
      }

      
      // Custom Click Tagging
      // Collect and send clicks not detectable by ida_stats.js
      function sendClickTag(section, feature, destination) {
            console.log(section + " " + feature)
            var config = {
                  type: 'ELEMENT',
                  primaryCategory: section, // e_a1 - Element Category
                  eventName: feature, // e_a2 - Element Name
                  targetURL: destination, // e_a7 - Element Attribute: ibmEvTarget
            };
            ibmStats.event(config);
      }

      // Custom Click Tagging
      // Collect and send clicks not detectable by ida_stats.js
      // function sendClickConversion(feature, title) {
      //   var config = {
      //         type               : 'pageclick',
      //         primaryCategory    : 'PAGE CLICK',
      //         eventCategoryGroup : "TIMELINE - SECURITY INTELLIGENCE",
      //         eventName          : feature,
      //         targetTitle        : title
      //       };
      //   ibmStats.event(config);
      // }

      // Custom Link Event
      // Add clicktag event on every link inside the element
      function tagAllLinks(element, section, feature) {
            var element = document.querySelectorAll(element);
            if (typeof(element) != 'undefined' && element != null) {
                  for (var i = 0; i < element.length; i++) {
                        var elements = element[i].querySelectorAll("a:not(.btn)");
                        for (var o = 0; o < elements.length; o++) {
                              if (elements[o].getAttribute('listener') !== 'true') {
                                    var destination = elements[o].getAttribute('href');
                                    elements[o].addEventListener('click', function() {
                                          if (this.getAttribute('listener') === 'true') {
                                                sendClickTag(section, feature, this.getAttribute('href'));
                                                this.setAttribute('listener', 'false');
                                          }
                                    }, false);
                                    elements[o].setAttribute('listener', 'true');
                              }
                        }
                  }
            }
      }

      window.onload = function() {

            // Call to action click tag
            var ctaButton = document.querySelectorAll(".single__content a");
            if (typeof(ctaButton) != 'undefined' && ctaButton != null && ctaButton.length !== 0) {
                  for (var i = 0; i < ctaButton.length; i++) {
                        ctaButton[i].addEventListener('click', function() {
                              if (this.getAttribute('listener') === 'true') {
                                    sendClickTag("BODY", "CALL TO ACTION");
                                    this.setAttribute('listener', 'false');
                              }
                        }, false);
                        ctaButton[i].setAttribute('listener', 'true');
                  }
            }

            // Read more click tag
            var readButton = document.querySelectorAll(".continue-reading button");
            if (typeof(readButton) != 'undefined' && readButton != null && readButton.length !== 0) {
                  for (var i = 0; i < readButton.length; i++) {
                        readButton[i].addEventListener('click', function() {
                              if (this.getAttribute('listener') === 'true') {
                                    sendClickTag("BODY", "READ-MORE");
                                    this.setAttribute('listener', 'false');
                              }
                        }, false);
                        readButton[i].setAttribute('listener', 'true');
                  }
            }


            //  LISTICLES tag - Arrows
            //left arrow
            var leftArrow = document.getElementById("prev");
            if (typeof(leftArrow) != 'undefined' && leftArrow != null) {
                  //for (var i = 0; i < leftArrow.length; i++) {
                  leftArrow.addEventListener('click', function() {
                        if (this.getAttribute('listener') === 'true' && leftArrow.id == "prev") {
                              sendClickTag("BODY", "LISTICLE-LEFT-ARROW");
                              this.setAttribute('listener', 'false');
                        }
                  }, false);
                  leftArrow.setAttribute('listener', 'true');
                  //}
            }
            //right arrow
            var rightArrow = document.getElementById("next");
            if (typeof(rightArrow) != 'undefined' && rightArrow != null) {
                  //for (var i = 0; i < rightArrow.length; i++) {
                  rightArrow.addEventListener('click', function() {
                        if (this.getAttribute('listener') === 'true' && rightArrow.id == "next") {
                              sendClickTag("BODY", "LISTICLE-RIGHT-ARROW");
                              this.setAttribute('listener', 'false');
                        }
                  }, false);
                  rightArrow.setAttribute('listener', 'true');
                  //}
            }



            //  LISTICLES tag - numbers
            var listicleTopButton = document.querySelectorAll(".listicle__pagination__numbers");
            if (typeof(listicleTopButton) != 'undefined' && listicleTopButton != null && listicleTopButton.length !== 0) {
                  for (var i = 0; i < listicleTopButton.length; i++) {
                        var currentSlide = 1;

                        listicleTopButton[i].addEventListener('click', function() {

                              if (this.getAttribute('listener') === 'true') {
                                    currentSlide++;
                                    var total = i;

                                    // var clickedSlides=currentSlide/2;
                                    // console.log(clickedSlides.toFixed());

                                    //I'm removing 2 because 2 arrows on the listicle are unclickable, but present on the DOM
                                    // clickableArrows = i-2;
                                    // clickableArrows = i-1;
                                    // I'm deviding by 2 because on each slide we have 2 arrows, so we were actually sendind the double of tags
                                    // clickableArrows= clickableArrows/2;
                                    // console.log(i);
                                    // clickableArrows.toFixed();

                                    if (currentSlide <= total) {
                                          sendClickTag("PAGE CLICK", "LISTICLE-NAVIGATION-SLIDE" + currentSlide);
                                          this.setAttribute('listener', 'false');
                                    } else {
                                          sendClickTag("PAGE CLICK", "LISTICLE-NAVIGATION-END");
                                          this.setAttribute('listener', 'false');
                                    }


                              }
                        }, false);
                        listicleTopButton[i].setAttribute('listener', 'true');
                  }
            }
            // // Timeline box click tag
            // var boxButton = document.querySelectorAll(".timeline__content .box");
            // if (typeof(boxButton) != 'undefined' && boxButton != null && boxButton.length !== 0) {
            //   for (var i = 0; i < boxButton.length; i++) {
            //     boxButton[i].addEventListener('click', function(){
            //       if (this.getAttribute('listener') === 'true') {
            //         sendClickConversion("DETAILED VIEW", this.getAttribute('data-title'));
            //         this.setAttribute('listener', 'false');
            //       }
            //     }, false);
            //     boxButton[i].setAttribute('listener', 'true');
            //   }
            // }

      };
</script>

<!-- COREMETRICS -->
      <script defer src="https://1.www.s81c.com/common/stats/ida_stats.js" type="text/javascript"></script>

      <!-- AMP DEFAULT CSS -->
      <style amp-boilerplate>
            body {
                  -webkit-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
                  -moz-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
                  -ms-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
                  animation: -amp-start 8s steps(1, end) 0s 1 normal both
            }

            @-webkit-keyframes -amp-start {
                  from {
                        visibility: hidden
                  }

                  to {
                        visibility: visible
                  }
            }

            @-moz-keyframes -amp-start {
                  from {
                        visibility: hidden
                  }

                  to {
                        visibility: visible
                  }
            }

            @-ms-keyframes -amp-start {
                  from {
                        visibility: hidden
                  }

                  to {
                        visibility: visible
                  }
            }

            @-o-keyframes -amp-start {
                  from {
                        visibility: hidden
                  }

                  to {
                        visibility: visible
                  }
            }

            @keyframes -amp-start {
                  from {
                        visibility: hidden
                  }

                  to {
                        visibility: visible
                  }
            }
      </style><noscript>
            <style amp-boilerplate>
                  body {
                        -webkit-animation: none;
                        -moz-animation: none;
                        -ms-animation: none;
                        animation: none
                  }
            </style>
      </noscript>

      <link rel="stylesheet" href="https://securityintelligence.com/wp-content/themes/sapphire/minifications/modules.css?v=1715191630">

      <!-- CUSTOM CSS -->
      <meta name='robots' content='max-image-preview:large' />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/securityintelligence.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://securityintelligence.com/wp-includes/css/dist/block-library/style.min.css?ver=6.6.2' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='taxonomy-image-plugin-public-css' href='https://securityintelligence.com/wp-content/plugins/taxonomy-images/css/style.css?ver=0.9.6' type='text/css' media='screen' />
<script type="text/javascript" src="https://securityintelligence.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://securityintelligence.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://securityintelligence.com/wp-content/themes/sapphire/app/javascript/si-theme-cookie.js?ver=6.6.2" id="si-cookie-consent-js"></script>
<link rel="https://api.w.org/" href="https://securityintelligence.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://securityintelligence.com/wp-json/wp/v2/xforce/446739" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://securityintelligence.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel='shortlink' href='https://securityintelligence.com/?p=446739' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://securityintelligence.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurityintelligence.com%2Fx-force%2Fwailingcrab-malware-misues-mqtt-messaging-protocol%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://securityintelligence.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurityintelligence.com%2Fx-force%2Fwailingcrab-malware-misues-mqtt-messaging-protocol%2F&#038;format=xml" />
<script async src="//analytics.newscred.com/analytics_c7caef17012f48e99285467c1b6d8423.js"></script><link rel="icon" href="https://securityintelligence.com/wp-content/uploads/2016/04/SI_primary_rgb-80x80.png" sizes="32x32" />
<link rel="icon" href="https://securityintelligence.com/wp-content/uploads/2016/04/SI_primary_rgb.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://securityintelligence.com/wp-content/uploads/2016/04/SI_primary_rgb.png" />
<meta name="msapplication-TileImage" content="https://securityintelligence.com/wp-content/uploads/2016/04/SI_primary_rgb.png" />
<style amp-custom>@import url('https://fonts.googleapis.com/css?family=IBM+Plex+Sans:200,300,400,500,600');@import url('https://fonts.googleapis.com/css?family=IBM+Plex+Sans+Condensed:300,400,500,600,700');@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Serif&display=swap')</style><link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://securityintelligence.com/wp-content/themes/sapphire/minifications/single.css?v=1722279696">
      <!-- YOAST SEO -->
      
<!-- This site is optimized with the Yoast SEO Premium plugin v13.1 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="IBM X-Force researchers have been tracking developments in the WailingCrab malware family, also known as a WikiLoader. Learn about the teams&#039; discoveries here."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Stealthy WailingCrab Malware misuses MQTT Messaging Protocol" />
<meta property="og:description" content="IBM X-Force researchers have been tracking developments in the WailingCrab malware family, also known as a WikiLoader. Learn about the teams&#039; discoveries here." />
<meta property="og:url" content="https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/" />
<meta property="og:site_name" content="Security Intelligence" />
<meta property="article:tag" content="Data Protection" />
<meta property="article:tag" content="Data Security" />
<meta property="article:tag" content="IBM X-Force Research" />
<meta property="article:tag" content="Security Intelligence" />
<meta property="article:tag" content="security intelligence &amp; analytics" />
<meta property="article:tag" content="X-Force" />
<meta property="article:section" content="Threat Intelligence" />
<meta property="fb:app_id" content="3703311399714818" />
<meta property="og:image" content="https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg" />
<meta property="og:image:secure_url" content="https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="IBM X-Force researchers have been tracking developments in the WailingCrab malware family, also known as a WikiLoader. Learn about the teams&#039; discoveries here." />
<meta name="twitter:title" content="Stealthy WailingCrab Malware misuses MQTT Messaging Protocol" />
<meta name="twitter:image" content="https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg" />
<script type='application/ld+json' class='yoast-schema-graph yoast-schema-graph--main'>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://securityintelligence.com/#website","url":"https://securityintelligence.com/","name":"Security Intelligence","inLanguage":"en-US","description":"Analysis and Insight for Information Security Professionals","potentialAction":{"@type":"SearchAction","target":"https://securityintelligence.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/#primaryimage","inLanguage":"en-US","url":"https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg","width":1200,"height":630,"caption":"A circuit board showing a glowing red software bug icon"},{"@type":"WebPage","@id":"https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/#webpage","url":"https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/","name":"Stealthy WailingCrab Malware misuses MQTT Messaging Protocol","isPartOf":{"@id":"https://securityintelligence.com/#website"},"inLanguage":"en-US","primaryImageOfPage":{"@id":"https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/#primaryimage"},"datePublished":"2023-11-21T14:00:00+00:00","dateModified":"2023-11-29T22:39:55+00:00","description":"IBM X-Force researchers have been tracking developments in the WailingCrab malware family, also known as a WikiLoader. Learn about the teams' discoveries here."}]}</script>
<!-- / Yoast SEO Premium plugin. -->


</head>

<body class="si_body" >
    <nav id="navigation" class="navigation navigation--homepage " aria-label="Security Intelligence">
        <div class="container">
            <div class="row">

                <!-- LOGO -->
                <div class="navigation__brand">
                    <a href="https://securityintelligence.com" title="Security Intelligence" tabindex="1">
                        <amp-img width="280" height="31" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/logo-white.svg" alt="Security Intelligence Logo">
                            <div fallback>
                                <h6>Security Intelligence</h6>                            </div>
                        </amp-img>
                    </a>
                </div>

                <!-- DESKTOP MENU - HOVER -->
                <div class="navigation__menu" onmouseleave="delete localStorage['megamenu-status']">
                    <a tabindex="2" id="nav-news" href="/news/" class="navigation__button " data-menu="megamenu__news" onclick="localStorage['megamenu-status'] = 'first-interaction';">News</a>

                    <a tabindex="4" id="nav-topics" href="/category/topics/" class="navigation__button " data-menu="megamenu__topics" onclick="localStorage['megamenu-status'] = 'first-interaction';">Topics</a>
                    <a tabindex="5" id="nav-x-force" href="/x-force/" class="navigation__button " data-menu="megamenu__threat" onclick="localStorage['megamenu-status'] = 'first-interaction';">X-Force</a>
                    <a tabindex="6" id="nav-media" href="/media/" class="navigation__button " data-menu="megamenu__podcast" onclick="localStorage['megamenu-status'] = 'first-interaction';">Podcast</a>
                    <button aria-label="search Button" class="navigation__search" onclick="document.getElementById('search__input').focus()" on="tap:search.toggleClass(class='megamenu__open')" role="link" tabindex="-1" type="button">
                        <amp-img tabindex="7" width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/search.svg" alt="Click to open the search bar"></amp-img>
                    </button>
                </div>

                <!-- TABLET MENU - TAP/CLICK -->
                <div id="search-tablet" class="navigation__menu navigation__menu--tablet" tabindex="-1">
                    <button type="button" class="navigation__button " data-menu="megamenu__news">News</button>
                    
                    <button type="button" class="navigation__button " data-menu="megamenu__topics" on="tap:megamenu__news.hide, megamenu__series.hide, megamenu__topics.show, megamenu__industries.hide, megamenu__threat.hide, megamenu__podcast.hide, megamenu__events.hide, megamenu__mask.show" role="link" tabindex="0">Topics</button>
                    <button type="button" class="navigation__button " data-menu="megamenu__threat" on="tap:megamenu__news.hide, megamenu__series.hide, megamenu__topics.hide, megamenu__industries.hide, megamenu__threat.show, megamenu__podcast.hide, megamenu__events.hide, megamenu__mask.show" role="link" tabindex="0">Threat Research</button>
                    <button type="button" class="navigation__button " data-menu="megamenu__podcast" on="tap:megamenu__news.hide, megamenu__series.hide, megamenu__topics.hide, megamenu__industries.hide, megamenu__threat.hide, megamenu__podcast.show, megamenu__events.hide, megamenu__mask.show" role="link" tabindex="0">Podcast</button>
                    <button type="button" aria-labelledby="search-tablet" class="navigation__search" onclick="document.getElementById('search__input').focus()" on="tap:search.toggleClass(class='megamenu__open')" role="link" tabindex="0">
                        <amp-img width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/search.svg" alt="Search"></amp-img>
                    </button>
                </div>

                <!-- SEARCH -->
                <form id="search" class="search " method="GET" action="/" target="_top" tabindex="-1">
                    <amp-autocomplete filter="prefix" src="https://securityintelligence.com/wp-content/themes/sapphire/app/jsons/suggestions.json" suggest-first submit-on-enter on="select:search.submit" tabindex="-1">
                        <input id="search__input" tabindex="-1" type="text" name="s" autocomplete="on" placeholder="What would you like to search for?" aria-label="Search" oninput="validateInput(this)" required>
                    </amp-autocomplete>

                    <button tabindex="-1" value="submit" type="submit" class="search__submit" aria-label="Click to search">
                        <amp-img width="20" height="20" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/search.svg" alt="Search"></amp-img>
                        <span>Search</span>
                    </button>
                    <button tabindex="-1" value="reset" class="search__close" type="reset" aria-labelledby="search" on="tap:search.toggleClass(class='megamenu__open')" role="link">
                        <amp-img width="14" height="14" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/close.svg" alt="Close"></amp-img>
                    </button>
                </form>






                <!-- MEGAMENU -->
                <div id="navigation__mega">

                    <!-- NEWS -->
                    <section id="megamenu__news" class="megamenu" data-menu="nav-news" on="tap:megamenu__news.show, megamenu__mask.show" role="link" tabindex="0">
                        <amp-list layout="responsive" width="1440" height="248" credentials="include" src="https://securityintelligence.com/wp-content/themes/sapphire/app/jsons/posts.php?quantity=4&type=ibm_news" binding="no">
                            <template type="amp-mustache">
                                <div class="row">

                                    <!-- ARTICLES -->
                                    {{#articles}}
                                        <article class="megamenu__article">
                                            <a href="{{permalink}}" class="megamenu__link">
                                                <div class="megamenu__image">
                                                    <amp-img width="630" height="330" layout="responsive" src="{{image}}" alt="{{image_alt}}"></amp-img>
                                                </div>
                                                <h3 class="megamenu__title">{{title}}</h3>
                                            </a>
                                        </article>
                                    {{/articles}}

                                    <!-- VIEW MORE -->
                                    <a href="/news/" class="megamenu__more">
                                        <amp-img width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/post-type-icons/news.svg" alt="News"></amp-img>
                                        <span>View All News</span>
                                    </a>

                                </div>
                            </template>
                        </amp-list>
                    </section>

                    <!-- SERIES -->


                    <!-- TOPICS -->
                    <section id="megamenu__topics" class="megamenu" data-menu="nav-topics" on="tap: megamenu__topics.show, megamenu__mask.show" role="link" tabindex="0">
                        <div class="row">

                            <!-- LISTS -->
                            <div class="megamenu__list">
                                <a href="/category/app-security/">Application Security</a>
                                <a href="/category/artificial-intelligence/">Artificial Intelligence</a>
                                <a href="/category/ciso-corner/">CISO</a>
                                <a href="/category/cloud-protection/">Cloud Security</a>
                                <a href="/category/data-protection/">Data Protection</a>
                                <a href="/category/endpoint/">Endpoint</a>
                            </div>
                            <div class="megamenu__list">
                                <a href="/category/fraud-protection/">Fraud Protection</a>
                                <a href="/category/identity-access/">Identity & Access</a>
                                <a href="/category/incident-response/">Incident Response</a>
                                <a href="/category/mainframe/">Mainframe</a>
                                <a href="/category/network/">Network</a>
                                <a href="/category/risk-management/">Risk Management</a>
                            </div>
                            <div class="megamenu__list">
                                <a href="/category/security-intelligence-analytics/">Intelligence & Analytics</a>
                                <a href="/category/security-services/">Security Services</a>
                                <a href="/category/threat-hunting/">Threat Hunting</a>
                                <a href="/category/topics/zero-trust/">Zero Trust</a>
                                <a href="/infographic-zero-trust-policy/">Infographic: Zero trust policy</a>
                                <a href="/timeline/state-local-government-cyberattacks/">Timeline: Local Government Cyberattacks</a>
                            </div>
                            <div class="megamenu__list">
                                <span>Industries</span>
                                <a href="/category/banking-financial-services-industry/">Banking & Finance</a>
                                <a href="/category/energy-utility-industry/">Energy & Utility</a>
                                <a href="/category/government/">Government</a>
                                <a href="/category/health-care-industry/">Healthcare</a>
                            </div>

                            <!-- VIEW MORE -->
                            <a href="/category/topics/" class="megamenu__more">
                                <amp-img width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/post-type-icons/topics.svg" alt="Topics"></amp-img>
                                <span>View All Topics</span>
                            </a>

                        </div>
                    </section>

                    <!-- THREAT RESEARCH -->
                    <section id="megamenu__threat" class="megamenu" data-menu="nav-x-force" on="tap:megamenu__threat.show, megamenu__mask.show" role="link" tabindex="0">
                        <amp-list layout="responsive" width="1440" height="248" credentials="include" src="https://securityintelligence.com/wp-content/themes/sapphire/app/jsons/posts.php?quantity=4&category=x-force" binding="no">
                            <template type="amp-mustache">
                                <div class="row">

                                    <!-- ARTICLES -->
                                    {{#articles}}
                                        <article class="megamenu__article">
                                            <a href="{{permalink}}" class="megamenu__link">
                                                <div class="megamenu__image">
                                                    <amp-img width="630" height="330" layout="responsive" src="{{image}}" alt="{{image_alt}}"></amp-img>
                                                </div>
                                                <h3 class="megamenu__title">{{title}}</h3>
                                            </a>
                                        </article>
                                    {{/articles}}

                                    <!-- VIEW MORE -->
                                    <a href="/x-force/" class="megamenu__more">
                                        <amp-img width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/post-type-icons/threat-research.svg" alt="Threat Research"></amp-img>
                                        <span>View More From X-Force</span>
                                    </a>

                                </div>
                            </template>
                        </amp-list>
                    </section>

                    <!-- PODCAST -->
                    <section id="megamenu__podcast" class="megamenu" data-menu="nav-media" on="tap:megamenu__podcast.show, megamenu__mask.show" role="link" tabindex="0">
                        <amp-list layout="responsive" width="1440" height="248" credentials="include" src="https://securityintelligence.com/wp-content/themes/sapphire/app/jsons/posts.php?quantity=4&type=ibm_media" binding="no">
                            <template type="amp-mustache">
                                <div class="row">

                                    <!-- ARTICLES -->
                                    {{#articles}}
                                        <article class="megamenu__article">
                                            <a href="{{permalink}}" class="megamenu__link">
                                                <div class="megamenu__image">
                                                    <amp-img width="630" height="330" layout="responsive" src="{{image}}" alt="{{image_alt}}"></amp-img>
                                                </div>
                                                <h3 class="megamenu__title">{{title}}</h3>
                                            </a>
                                        </article>
                                    {{/articles}}

                                    <!-- VIEW MORE -->
                                    <a href="/media/" class="megamenu__more">
                                        <amp-img width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/post-type-icons/podcast.svg" alt="Podcast"></amp-img>
                                        <span>View All Episodes</span>
                                    </a>

                                </div>
                            </template>
                        </amp-list>
                    </section>

                </div>

                <!-- MASK -->
                <div id="megamenu__mask" class="navigation__mask  " hidden></div>

                <!-- MEGAMENU SCRIPTS -->
                <script type="text/javascript">
                   
                    function validateInput(inputElement) {
                        // Regular expression to allow only letters (both uppercase and lowercase) and numbers
                        var regex = /^[A-Za-z0-9 ]*$/;

                        // Get the current value of the input field
                        var inputValue = inputElement.value;

                        // Check if the input value matches the allowed pattern
                        if (!regex.test(inputValue)) {
                            // If the input contains special characters, remove them
                            inputElement.value = inputValue.replace(/[^A-Za-z0-9 ]/g, '');
                        }
                    }
                    // DESKTOP MENU LINKS - HOVER ACTION
                    var elementList = document.querySelectorAll('.navigation__menu .navigation__button');
                    for (i = 0; i < elementList.length; i++) {

                        elementList[i].addEventListener('mouseenter', function() {
                            if (localStorage['megamenu-status'] !== 'first-interaction') {
                                var mega = document.getElementById("navigation__mega");
                                var menu_elements = document.getElementById(this.dataset.menu);
                                var mask = document.getElementById("megamenu__mask");
                                menu_elements.click();
                                mega.classList.add('amp-open');
                                menu_elements.classList.add('amp-open');
                                mask.classList.add('amp-open');
                            }
                        });

                        elementList[i].addEventListener('mouseleave', function() {
                            if (localStorage['megamenu-status'] !== 'first-interaction') {
                                var mega = document.getElementById("navigation__mega");
                                var menu_elements = document.getElementById(this.dataset.menu);
                                var mask = document.getElementById("megamenu__mask");
                                mega.classList.remove('amp-open');
                                menu_elements.classList.remove('amp-open');
                                mask.classList.remove('amp-open');
                            }
                        });
                    }

                    // TABLET MENU LINKS - CLICK ACTION
                    var elementList = document.querySelectorAll('.navigation__menu--tablet .navigation__button');
                    for (i = 0; i < elementList.length; i++) {

                        elementList[i].addEventListener('click', function() {
                            var mega = document.getElementById("navigation__mega");
                            var menu_elements = document.getElementById(this.dataset.menu);
                            var mask = document.getElementById("megamenu__mask");
                            menu_elements.click();
                            mega.classList.add('amp-open');
                            menu_elements.classList.add('amp-open');
                            mask.classList.add('amp-open');
                        });
                    }

                    // OPPENED MEGAMENU - HOVER ACTION
                    var elementList = document.querySelectorAll('.megamenu');
                    for (i = 0; i < elementList.length; i++) {

                        elementList[i].addEventListener('mouseenter', function() {
                            var mega = document.getElementById("navigation__mega");
                            var nav_elements = document.getElementById(this.dataset.menu);
                            var mask = document.getElementById("megamenu__mask");
                            this.classList.add('amp-open');
                            mega.classList.add('amp-open');
                            mask.classList.add('amp-open');
                            nav_elements.classList.add('amp-open');
                        });

                        elementList[i].addEventListener('mouseleave', function() {
                            var mega = document.getElementById("navigation__mega");
                            var nav_elements = document.getElementById(this.dataset.menu);
                            var mask = document.getElementById("megamenu__mask");
                            this.classList.remove('amp-open');
                            mega.classList.remove('amp-open');
                            mask.classList.remove('amp-open');
                            nav_elements.classList.remove('amp-open');
                        });
                    }
                </script>

                <!-- MOBILE ICON -->
                <button type="button" aria-labelledby="search-tablet" class="search__mobile__icon" onclick="document.getElementById('search__input').focus()" on="tap:search.toggleClass(class='megamenu__open')" role="link" tabindex="0">
                    <amp-img width="18" height="18" layout="fixed" src="https://securityintelligence.com/wp-content/themes/sapphire/images/search.svg" alt="Search"></amp-img>
                </button>

                <div class="navigation__mobile-icon" on="tap:navigation__mobile.toggleVisibility, navigation__hamburguer.toggleVisibility,
                  navigation__close.toggleVisibility " role="link" tabindex="0">
                    <amp-img id="navigation__hamburguer" width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/hamburguer.svg" alt="Menu"></amp-img>
                    <amp-img id="navigation__close" width="24" height="24" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/close.svg" alt="Close" hidden></amp-img>
                </div>

                <!-- MOBILE LIST -->
                <section id="navigation__mobile" class="navigation__mobile-list" hidden>
                    <div class="container">
                        <a href="/news/">News</a>

                        <!-- ACCORDIONS -->
                        <amp-accordion disable-session-states>
                            <!-- TOPICS -->
                            <section class="navigation__accordion">
                                <h2>Topics</h2>
                                <div class="navigation__accordion-content">
                                    <div class="row">
                                        <a href="/category/topics/">All Categories</a>
                                        <a href="/category/app-security/">Application Security</a>
                                        <a href="/category/identity-access/">Identity & Access</a>
                                        <a href="/category/artificial-intelligence/">Artificial Intelligence</a>
                                        <a href="/category/incident-response/">Incident Response</a>
                                        <a href="/category/ciso-corner/">CISO</a>
                                        <a href="/category/mainframe/">Mainframe</a>
                                        <a href="/category/cloud-protection/">Cloud Security</a>
                                        <a href="/category/mobile-security-podcasts/">Mobile Security</a>
                                        <a href="/category/data-protection/">Data Protection</a>
                                        <a href="/category/network/">Network</a>
                                        <a href="/category/endpoint/">Endpoint</a>
                                        <a href="/category/risk-management/">Risk Management</a>
                                        <a href="/category/fraud-protection/">Fraud Protection</a>
                                        <a href="/category/threat-hunting/">Threat Hunting</a>
                                        <a href="/category/security-services/">Security Services</a>
                                        <a href="/category/security-intelligence-analytics/">Security Intelligence & Analytics</a>
                                    </div>
                                    <div class="row">
                                        <span>Industries</span>
                                        <a href="/category/industries/banking-financial-services-industry/">Banking & Finance</a>
                                        <a href="/category/energy-utility-industry/">Energy & Utility</a>
                                        <a href="/category/government/">Government</a>
                                        <a href="/category/health-care-industry/">Healthcare</a>
                                    </div>
                                </div>
                            </section>
                        </amp-accordion>

                        <a href="/x-force/">X-Force</a>
                        <a href="/media/">Podcast</a>
                </section>
            </div>
        </div>
    </nav>
<!-- BACK TO TOP -->
<div class="scroll-to-top ">

    <!-- TOP VIEWER TRIGGER -->
    <div id="top-viewer" class="scroll-to-top__viewer"></div>

    <!-- BUTTON -->
    <div class="sticky" style="height: 100%;">
            
            <button     id="scrollToTopButton" 
                        on="tap:top-viewer.scrollTo(duration=200, position=bottom)" 
                        class="tap_target ">
                        
                        <div class="scroll-to-top__button">
                              <amp-img width="12" height="16" layout="fixed" alt="Back-to-top" src="https://securityintelligence.com/wp-content/themes/sapphire/images/scroll-to-top.svg"></amp-img>
                        </div>
            </button>

    </div>

    <!-- SCROLL SHOW/HIDE ANIMATION -->
    <amp-animation id="showAnim" layout="nodisplay">
        <script type="application/json">
            {
                "duration": "200ms",
                "fill": "both",
                "iterations": "1",
                "direction": "alternate",
                "animations": [{
                    "selector": "#scrollToTopButton",
                    "keyframes": [{
                        "opacity": "1",
                        "visibility": "visible"
                    }]
                }]
            }
        </script>
    </amp-animation>
    <amp-animation id="hideAnim" layout="nodisplay">
        <script type="application/json">
            {
                "duration": "200ms",
                "fill": "both",
                "iterations": "1",
                "direction": "alternate",
                "animations": [{
                    "selector": "#scrollToTopButton",
                    "keyframes": [{
                        "opacity": "0",
                        "visibility": "hidden"
                    }]
                }]
            }
        </script>
    </amp-animation>
</div>

<!-- CHECK PAGE POSITION -->
<amp-position-observer target="top-viewer" intersection-ratios="0" on="enter:hideAnim.start; exit:showAnim.start" layout="nodisplay"></amp-position-observer>

<!-- SCHEMA -->
<script id="post-schema" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "Article",
      "headline": "Stealthy WailingCrab Malware misuses MQTT Messaging Protocol",
      "mainEntityOfPage": "https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/",
      "author": {
            "@type": "Person",
            "name": "Charlotte Hammond"
      },
      "datePublished": "2023-11-21T09:00:00-05:00",
      "dateModified": "2023-11-29T17:39:55-05:00",
      "publisher": {
            "@type": "Organization",
            "name": "Security Intelligence",
            "logo":{
                  "@type": "ImageObject",
                  "url": "https://securityintelligence.com/wp-content/themes/security-intelligence/assets/img/logo.png"
            }
      },
      "image": [ "https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering-630x330.jpeg" ],
      "articleBody": "&lt;p&gt;&lt;em&gt;This article was made possible thanks to the hard work of writer Charlotte Hammond and contributions from Ole Villadsen and Kat Metrick.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;IBM X-Force researchers have been tracking developments to the WailingCrab malware family, in particular, those relating to its C2 communication mechanisms, which include misusing the Internet-of-Things (IoT) messaging protocol MQTT.&lt;/p&gt;
&lt;p&gt;WailingCrab, also known as &lt;a href=&quot;https://www.proofpoint.com/us/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion&quot;&gt;WikiLoader&lt;/a&gt;, is a sophisticated, multi-component malware delivered almost exclusively by an initial access broker that X-Force tracks as Hive0133, which overlaps with TA544. WailingCrab was first observed in December 2022, and since then it has been used extensively in email campaigns to deliver the Gozi backdoor often against Italian targets. In recent months, Hive0133 has targeted organizations beyond Italy with email campaigns delivering WailingCrab, frequently using themes such as overdue delivery or shipping invoices.&lt;/p&gt;
&lt;p&gt;The malware authors have focused on stealth and anti-analysis techniques in the continued development of the WailingCrab malware. The malware itself is split into multiple components, including a loader, injector, downloader and backdoor, and successful requests to C2-controlled servers are often necessary to retrieve the next stage. Legitimate, hacked websites are used for initial C2 communications to lower the chance of network detection, and payloads are often hosted on well-known platforms such as Discord. C2 servers are often taken down quickly or stop responding soon after a campaign which may prevent threat researchers from accessing them and retrieving the next stages of the malware. Additionally, WailingCrab makes use of code obfuscation, anti-analysis, and anti-sandbox techniques throughout its code.&lt;/p&gt;
&lt;p&gt;WailingCrab&#039;s core component is its backdoor, which is installed on the system only if the malware&#039;s initial stages are completed successfully. Since mid-2023, WailingCrab&#039;s backdoor component has communicated with the C2 using the &lt;a href=&quot;https://mqtt.org/&quot;&gt;MQTT protocol&lt;/a&gt; which is a lightweight IoT messaging protocol. MQTT uses a publish/subscribe architecture, whereby messages are published to &#039;topics&#039; and received by subscribers, with message distribution handled by a centralized broker. In this instance, WailingCrab uses the legitimate, third-party broker, &lt;b&gt;broker.emqx[.]io&lt;/b&gt;, which allows it to hide the true address of the C2 server.&lt;/p&gt;
&lt;p&gt;WailingCrab&#039;s use of the MQTT is notable, as this protocol is not commonly used by malware. There have only been a handful of instances reported, with the most recent being the &lt;a href=&quot;https://www.welivesecurity.com/2023/03/02/mqsttang-mustang-panda-latest-backdoor-treads-new-ground-qt-mqtt/&quot;&gt;MQsTTang backdoor&lt;/a&gt; attributed to the threat actor Mustang Panda. As a result of this, the protocol&#039;s use may not be monitored as closely by security teams, allowing the backdoor&#039;s C2 communications to fly under the radar.&lt;/p&gt;
&lt;p&gt;This blog provides an overview of WailingCrab and its C2 communications, with a focus on its use of the MQTT &lt;a&gt;protocol.&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Delivery&lt;/h2&gt;
&lt;p&gt;Since its inception, WailingCrab has been distributed via email spam campaigns using &lt;a href=&quot;https://www.proofpoint.com/us/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion&quot;&gt;Microsoft Excel attachments, Microsoft OneNote attachments or PDF attachments&lt;/a&gt;. In recent months, Hive0133 has favored the use of PDF attachments containing malicious URLs in their email campaigns delivering WailingCrab. When clicked, the links will download and execute JScript files, which in turn will download and execute the WailingCrab loader, which is usually hosted as an attachment file on Discord. Below is an example of a Hive0133 email campaign delivering WailingCrab on 19 October.&lt;/p&gt;
&lt;div&gt;
&lt;div id=&quot;_com_1&quot;&gt;
&lt;p&gt;&lt;img src=&quot;https://images2.cmp.optimizely.com/Zz0wZThmNzNkODg1ODIxMWVlODBlMThhMDI0YzVjM2RjMQ==&quot; alt=&quot;WailingCrab_Email.png&quot; width=&quot;596.7914438502675&quot; height=&quot;550&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;i&gt;Figure 1: Hive0133 Email from 10/19/2023 delivering WailingCrab Loader.&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;&lt;i&gt;&lt;img src=&quot;https://images1.cmp.optimizely.com/Zz0yMTFmMGViNDg1ODIxMWVlOTBhNzJhMjA0ODg2Y2YyOA==&quot; alt=&quot;WailingCrab_PDF.png&quot; width=&quot;564.0080428954424&quot; height=&quot;550&quot; /&gt;&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;&lt;i&gt;Figure 2: Hive0133 Email PDF Attachment with Malicious Link Leading to WailingCrab Loader.&lt;/i&gt;&lt;/p&gt;
&lt;h2&gt;WailingCrab components&lt;/h2&gt;
&lt;p&gt;Many of the technical details of WailingCrab&#039;s operation and early variants have already been discussed &lt;a href=&quot;https://www.proofpoint.com/uk/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion&quot;&gt;in other research&lt;/a&gt;, therefore in this blog, we will focus on new developments and those aspects which have not already been reported on.&lt;/p&gt;
&lt;p&gt;The primary samples used for this research are &lt;b&gt;24c5f4868dc5af255edbb993d98de51a&lt;/b&gt; and &lt;b&gt;f6ea7ec5d94bc65bf82a6b42b57a6c82&lt;/b&gt;, which were from campaigns in September, and &lt;b&gt;f6d0b9617405f35bb846d671edda75d3&lt;/b&gt; which was observed in July and is the reference for the earlier version of the MQTT protocol use. These samples are all first-stage WailingCrab Loaders, which were hosted on Discord and downloaded via spam campaigns like the one described above. The subsequent WailingCrab components discussed in this blog were all unpacked or downloaded by these loaders.&lt;/p&gt;
&lt;h3&gt;WailingCrab loader&lt;/h3&gt;
&lt;p&gt;The first component of WailingCrab is its loader, which commonly uses a legitimate DLL file as a template, with the malicious code patched over one of the DLL&#039;s exported functions. Its purpose is to load the second stage which is stored within the DLL as an encrypted shellcode.&lt;/p&gt;
&lt;p&gt;This initial loader component of WailingCrab has received a few updates in more recent samples. In the previous version, the loader would overwrite its own data section in memory with the code for its second-stage component. In the new version, the malware first loads a legitimate Windows DLL, such as &lt;b&gt;BingMaps.dll&lt;/b&gt;, and then overwrites the code for one of the DLL&#039;s exported functions with WailingCrab&#039;s second-stage shellcode. It also patches the code at the DLL&#039;s original entry point such that it returns immediately rather than running its original code, allowing execution to proceed unimpeded to the maliciously patched export function.&lt;/p&gt;
&lt;p&gt;The WailingCrab loader then creates a new thread to run its second-stage shellcode within the context of the legitimate loaded DLL.&lt;/p&gt;
&lt;h3&gt;WailingCrab injector&lt;/h3&gt;
&lt;p&gt;The second stage is the WailingCrab injector, the functionality of which has not changed much from the previous version.&lt;/p&gt;
&lt;p&gt;The Injector component starts by looping through the currently running processes on the host system and creates a hash of each process filename until it finds one that matches its target hash, which in the analyzed sample corresponds to &lt;b&gt;explorer.exe&lt;/b&gt;. At this point, the malware will also compare the hash of each running process name to a list of hashes associated with sandbox or debugging applications, and will not continue if any of these are found.&lt;/p&gt;
&lt;p&gt;Once it identifies its target process, WailingCrab opens it and allocates memory within the process space. It then decrypts its third-stage component using XOR and writes the decrypted payload contents to the allocated memory region, along with a string containing the file path of the initial loader.&lt;/p&gt;
&lt;p&gt;Next, WailingCrab searches the DLLs loaded within the target process (i.e. explorer.exe) and looks for ntdll.dll. Within the ntdll.dll instance, it finds the address of a target API function, in this case, &lt;b&gt;RtlWow64GetCurrentMachine&lt;/b&gt;. It then overwrites the contents of this function with 12 bytes of trampoline hook code, the purpose of which is to jump to the start of the copied payload.&lt;/p&gt;
&lt;p&gt;The malware then creates a new thread within the target process. The start address of the thread is set to that of the hooked API function, e.g. &lt;b&gt;RtlWow64GetCurrentMachine&lt;/b&gt;. Upon creation, the new thread executes the target API function, which now contains the hook code, and this then transfers execution to the payload, which is the next WailingCrab component.&lt;/p&gt;
&lt;h3&gt;WailingCrab downloader&lt;/h3&gt;
&lt;p&gt;The third WailingCrab component is a Downloader/Loader, which is responsible for loading the Backdoor component. The code for this stage is run within the context of the injected process; in this case, &lt;b&gt;explorer.exe&lt;/b&gt;.&lt;/p&gt;
&lt;p&gt;Much of the functionality of the downloader is the same as in previous versions, however, there have been some updates. In prior versions, this component would download the backdoor, which would be hosted as an attachment on the Discord CDN.  However, the latest version of WailingCrab already contains the backdoor component encrypted with AES, and it instead reaches out to its C2 to download a decryption key to decrypt the backdoor.&lt;/p&gt;
&lt;p&gt;The WailingCrab downloader starts in the same manner as prior versions, by sleeping for a set period, and then deleting the original loader file on disk. It also creates a mutex, where the mutex name is a hardcoded numeric string, for example, &quot;&lt;b&gt;823264&quot;&lt;/b&gt;.&lt;/p&gt;
&lt;p&gt;At this point in the previous version, WailingCrab would then perform connectivity and anti-sandbox checks by attempting to connect to &lt;a href=&quot;https://www.wikipedia.org/&quot;&gt;https://www.wikipedia.org/&lt;/a&gt; and also a non-existent domain and confirming that the results of both are what it expects. However, these checks have been removed from the new version, and the malware proceeds straight to C2 communication.&lt;/p&gt;
&lt;p&gt;WailingCrab proceeds to register with the C2. It randomly generates bot ID values and also gathers basic system information including domain, hostname, username, language and system time. These values are then formatted into a pipe-delimited string, along with an eight-digit campaign ID which is hardcoded into the malware.&lt;/p&gt;
&lt;p&gt;In the previous version, the randomly generated bot ID was a single eight-digit string, however in the new variant three 16-digit strings are generated instead, and these will be used later on by the backdoor component as MQTT topic names during its communication with the C2.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Previous Version:&lt;/b&gt;&lt;/p&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&lt;campaign_id&gt;||&lt;botid&gt;||&lt;domain&gt;||&lt;hostname&gt;||&lt;username&gt;||&lt;admin_status&gt;||&lt;language_id&gt;||&lt;system_time&gt;||&lt;os_version&gt;||&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;e.g.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;84234775&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;52270349&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||-||DESKTOP-JGLLJLD||admin||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1033&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2023.07&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;12&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;+&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;06&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;50&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;10.00&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;19044&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;b&gt;New Version:&lt;/b&gt;&lt;/p&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&lt;campaign_id&gt;||&lt;16_digit_bot_value1&gt;&lt;16_digit_bot_value2&gt;&lt;16_digit_bot_value3&gt;||domain||&lt;hostname&gt;||&lt;username&gt;||&lt;admin_status&gt;||&lt;language_id&gt;||&lt;system_time&gt;||&lt;os_version&gt;||&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;e.g.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;63785091&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;258318294498701539673492921154037193237834753421&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||-||DESKTOP-JGLLJLD||admin||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1033&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2023.09&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;15&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;+&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;11&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;32&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;10.00&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;19045&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This string is then base64 encoded and added to the Cookie field in the HTTP registration request sent to the C2. The C2 URL is chosen at random from a list, and the following URLs were present in the analyzed sample:&lt;/p&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;border: 1pt dashed #6199c9; width: 88.8081%; height: 103px;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 100%; border: none; padding: 8.65pt 5pt 12.95pt 2.9pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;https[:]&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #008200;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;//epikurgroup[.]com/plugins/content/jw_allvideos/jw_allvideos/tmpl/Res&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #008200;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;ponsive/oiyqnk182.php?id=1 &lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;https[:]&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #008200;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;//rgjllc[.]pro/wp-&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #008200;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;content/themes/sydney/inc/notices/uiqbw123udibjk1d2.php?id=1&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;https[:]&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #008200;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;//advocates4consumerprotection[.]com/wp-&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #008200;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;includes/js/tinymce/skins/iudjh9iwd182.php?id=1&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The C2 registration domains are usually legitimate Wordpress-based websites that have been compromised by the threat actor to include a malicious PHP file that processes the requests from the WailingCrab malware. When a request is made to one of these URLs with the correct cookie set, the malicious PHP code inserts a comment into the source code of the returned webpage which contains the response data for the downloader.&lt;/p&gt;
&lt;p&gt;The below image shows a request being made to one of the C2 URLs, where the cookie field contains the base64 encoded registration string.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2.cmp.optimizely.com/Zz02NGVkYjQwYTg1ODMxMWVlOTE2MDZlYWNlYmFkZmYxNQ==&quot; alt=&quot;231106-wailingcrab-download-c2.PNG&quot; width=&quot;678&quot; height=&quot;130&quot; /&gt;&lt;/p&gt;
&lt;p&gt;If the registration request is successful, the source code of the returned web page will contain a comment containing the word &#039;gmail&#039; followed by a base64 string, similar to that seen in the below image.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2.cmp.optimizely.com/Zz05MDFlZDY5MDg1ODMxMWVlOGU1ZTZlYWNlYmFkZmYxNQ==&quot; alt=&quot;231106-wailingcrab-download-c2-response.PNG&quot; width=&quot;666&quot; height=&quot;213&quot; /&gt;&lt;/p&gt;
&lt;p&gt;In prior versions of WailingCrab, the base64 response would be decoded to reveal a Discord CDN URL path which the next stage of the malware could be downloaded from.&lt;/p&gt;
&lt;p&gt;In the new version, the decoded base64 instead contains an encrypted AES key. In this case, the first 8 bytes of the decoded data are XOR&#039;d together, and the final value is then used to XOR-decrypt the remaining 32 bytes of the data which is the AES key.&lt;/p&gt;
&lt;p&gt;The AES key is then used by WailingCrab to decrypt the backdoor component using AES-256 in CBC mode with a null-byte IV. The backdoor code is then executed.&lt;/p&gt;
&lt;h3&gt;WailingCrab backdoor&lt;/h3&gt;
&lt;p&gt;The WailingCrab backdoor is a sophisticated piece of malware responsible for installing persistence and beaconing to the C2. The backdoor installs itself in a randomly named subdirectory of either the user&#039;s %AppData% folder or the %ProgramData% folder. WailingCrab copies several files to this directory and modifies some by overwriting them with chunks of its code:&lt;/p&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;C:\ProgramData\&lt;malware_dir&gt;\version.dll (copied from C:\WINDOWS\system32\version.dll and modified)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;C:\ProgramData\&lt;malware_dir&gt;\&lt;random_name&gt;.exe (copied from C:\WINDOWS\system32\printfilterpipelinesvc.exe)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;C:\ProgramData\&lt;malware_dir&gt;\xpspushlayer.dll (copied from C:\ProgramData\&lt;malware_dir&gt;\version.dll)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;C:\ProgramData\&lt;malware_dir&gt;\thumbs.db (contains encrypted WailingCrab code)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;C:\ProgramData\&lt;malware_dir&gt;\&lt;random_name&gt;.dll (copied from C:\ProgramData\&lt;malware_dir&gt;\version.dll and modified)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;WailingCrab installs persistence by creating a randomly named subkey under the registry Run key and adding the file path of the copied and randomly renamed &lt;b&gt;printfilterpipelinesvc.exe&lt;/b&gt; file. When this file is executed it loads the modified version.dll file via DLL hijacking, and execution then jumps between the various WailingCrab code chunks loaded from the other files, eventually ending up within an injected &lt;b&gt;explorer.exe&lt;/b&gt; instance. The full technical details of this process are beyond the scope of this blog but are available in our full malware report on &lt;a href=&quot;https://exchange.xforce.ibmcloud.com/malware-analysis/guid:dc1430e695fffa811866bda9578aaa1b&quot;&gt;X-Force Exchange&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;MQTT communication&lt;/h2&gt;
&lt;p&gt;Communication between the WailingCrab backdoor component and the C2 is performed using the &lt;a href=&quot;https://mqtt.org/&quot;&gt;MQTT protocol&lt;/a&gt; which is a lightweight IoT messaging protocol. MQTT uses a publish/subscribe architecture, with message distribution handled by a centralized broker. WailingCrab uses a third-party broker, &lt;b&gt;broker.emqx[.]io&lt;/b&gt;, which allows it to hide the true address of the C2 server.&lt;/p&gt;
&lt;p&gt;The basics of the MQTT protocol are quite straightforward. The client starts by sending a connect request to the broker, specifying its client ID, which the broker then acknowledges. After that the client can either publish messages to specific &#039;topics&#039;, or it can request to subscribe to a topic. Any clients who are subscribed to a topic will then receive future messages published on that topic.&lt;/p&gt;
&lt;h3&gt;Previous version&lt;/h3&gt;
&lt;p&gt;We initially observed WailingCrab using the MQTT protocol in mid-2023, and this version of the backdoor communicated with the C2 using the following procedure.&lt;/p&gt;
&lt;ol start=&quot;1&quot; type=&quot;1&quot;&gt;
&lt;li&gt;The backdoor starts by sending a connect request to broker.emqx[.]io using a randomly generated client ID.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Connect packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Protocol version &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Randomly generated Client ID, e.g. xMMRYbWc&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;2&quot; type=&quot;1&quot;&gt;
&lt;li&gt;It then registers with the C2 by publishing a message to a topic named using the same campaign ID string found in the WailingCrab downloader. The registration message is 25 characters long and consists of the number &#039;1&#039;, which is likely the message type, followed by a randomly generated 16-digit string, followed by the eight-digit bot ID generated by the downloader. For example:&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io (Campaign Topic) -&gt; C2&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Campaign ID (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;84234775&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Registration type message, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;1852460395177254652270349&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit message type = &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;1&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; (registration message)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;16&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit randomly generated string, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;8524603951772546&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit bot ID, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;52270349&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;3&quot; type=&quot;1&quot;&gt;
&lt;li&gt;The purpose of the randomly generated 16-digit string (8524603951782546) is for it to be a client-specific topic name for the C2 and backdoor to communicate via, as opposed to the campaign name topic which is shared by all samples in the same campaign. The backdoor sends a subscribe request to the MQTT broker with the topic name set to this 16-digit string, which means that the broker will forward any future messages published to this topic to the backdoor. Once the subscription request is sent, the broker will then respond with a &#039;subscribe ack&#039; packet to acknowledge the subscription request.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Subscribe packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Subscribe Topic: Generated client-specific topic name e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;8524603951772546&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;4&quot; type=&quot;1&quot;&gt;
&lt;li&gt;The backdoor then publishes a general &#039;check-in&#039; type message to the campaign topic, which consists of the character &#039;2&#039; followed by the eight-digit bot ID.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io (Campaign Topic) -&gt; C2&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Campaign ID (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;84234775&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Check-in type message, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;252270349&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit message type = &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;2&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; (check-in message)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit bot ID, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;52270349&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;5&quot; type=&quot;1&quot;&gt;
&lt;li&gt;At this point, the backdoor checks for any received messages. The C2 will publish any messages for the target to the client-specific topic, which the broker will then forward to the backdoor since it has subscribed to that topic. The messages from the C2 take the form of the character &#039;0&#039; if the C2 does not have any further instructions for the client, or the character &#039;2&#039; followed by a download path:&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;C2 -&gt; broker.emqx.io (Client Topic) -&gt; Backdoor&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Client Specific (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;8524603951772546&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Either &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;0&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; or payload message, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;2+1135578349968818269+1143152400132210688+djibh1ud21dORD1s.iso|1&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit message type = &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;0&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; or &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;2&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        Download path with &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;/&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; characters replaced by &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;+&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;+1135578349968818269+1143152400132210688+djibh1ud21dORD1s.iso&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        Pipe delimiter, followed by single digit, usually &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;1&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; or &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;2&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    &lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;6&quot; type=&quot;1&quot;&gt;
&lt;li&gt;If the backdoor receives a download path from the C2 it will append the received path string to the URL https[:]//cdn.discordapp[.]com/attachments/ to create the full download URL. Any &#039;+&#039; characters in the path are converted to &#039;/&#039;. The backdoor will then download a payload from the constructed URL, decode it using base64 and then decrypt it using the same XOR-based algorithm used throughout the malware. The malware will generate a random filename with the .log extension, write the payload to the user&#039;s Temp directory, and then execute the file by creating a new process with the following command:&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;rundll32.exe &lt;payload_filepath&gt;, DllRegisterServer&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;7&quot; type=&quot;1&quot;&gt;
&lt;li&gt;The backdoor will then report the status back to the C2 by publishing a message to the campaign channel. If the payload download and execution operation was a success then it will send a message consisting of the character &#039;3&#039; followed by the bot ID. Otherwise, if there was an error, it will send the character &#039;4&#039; followed by the bot ID.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io (Campaign Topic) -&gt; C2&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Campaign ID (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;84234775&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Result type message, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;352270349&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit message type = &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;3&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; or &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;4&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit bot ID, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;52270349&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;8&quot; type=&quot;1&quot;&gt;
&lt;li&gt;The malware will then disconnect the MQTT connection and then sleep for a fixed period of time before checking in with the C2 again.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;&lt;strong&gt;New version&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;Newer versions of WailingCrab, observed from September 2023 onwards, use an updated protocol when communicating with the C2.&lt;/p&gt;
&lt;p&gt;As described above, in the previous version, all clients infected by a specific campaign would register with and send regular check-in messages to a single centralized MQTT topic named after the campaign ID. The initial registration message sent by each client would then contain a randomly generated 16-character numeric string which would then serve as the name of a client-specific topic where the C2 could send commands/payloads to the respective client.&lt;/p&gt;
&lt;p&gt;In the new version, the use of the centralized topic has been removed, and infected clients and the C2 now communicate solely via client-specific topics, the names of which are taken from the three randomly generated 16-digit strings created by the downloader component and shared with the C2 as part of its initial request to the WordPress C2 URL.&lt;/p&gt;
&lt;p&gt;For example, if the initial registration request sent by the downloader component contained the following:&lt;/p&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;63785091&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;258318294498701539673492921154037193237834753421&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||-||DESKTOP-JGLLJLD||admin||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1033&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2023.09&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;15&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;+&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;11&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;32&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;10.00&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;19045&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Then the three client-specific topic names would be:&lt;/p&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2583182944987015&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3967349292115403&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;7193237834753421&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The use of Discord for hosting payloads has also been removed from this stage of the malware, and the backdoor now receives a shellcode-based payload directly from the C2 via MQTT rather than a Discord-based download path.&lt;/p&gt;
&lt;p&gt;A full breakdown of the new C2 communication protocol is as follows:&lt;/p&gt;
&lt;ol start=&quot;1&quot; type=&quot;1&quot;&gt;
&lt;li&gt;As with the previous version, the backdoor starts by sending an MQTT connect packet to broker.emqx[.]io via TCP port 1883 using a randomly generated eight-character client ID.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Connect packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Protocol version &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Randomly generated Client ID, e.g. xMMRYbWc&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;2&quot; type=&quot;1&quot;&gt;
&lt;li&gt;It then retrieves the local time of the infected system and constructs a datetime structure which it encodes using base64. The backdoor then publishes a message containing the base64 string, with the topic set to the second of the randomly generated topic names.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io (Client Topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;) -&gt; C2&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Client topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3967349292115403&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Check-in message, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;AgAcABwAFAAKAOcH&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        Base64 encoded datetime value, e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;02&lt;/span&gt;&lt;/span&gt; &lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;00&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; 1c &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;00&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; 1c &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;00&lt;/span&gt;&lt;/span&gt; &lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;14&lt;/span&gt;&lt;/span&gt; &lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;00&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; 0a &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;00&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; e7 &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;07&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        Breaks down as six &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #336699; font-weight: bold;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; values: Hour Min Sec Day Month Year&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;3&quot; type=&quot;1&quot;&gt;
&lt;li&gt;The backdoor then sends a subscribe request to the third topic.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Subscribe packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Subscribe Topic: Client topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;7193237834753421&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;4&quot; type=&quot;1&quot;&gt;
&lt;li&gt;The backdoor checks to see if it has received any messages via the subscribed topic, and then sends a disconnect packet. If no message is received, the malware proceeds to sleep and then restart the communications loop. If a message has been received, the backdoor checks that the length is greater than 128 bytes, and if so proceeds to decode it from base64. The first 8 bytes of the decoded payload contain a payload ID value, and the second set of 8 bytes is used to calculate the XOR key to decrypt the rest of the payload data. The backdoor expects the decrypted payload to be another shellcode component which it then executes in a new thread.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;C2 -&gt; broker.emqx.io (Client Topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;) -&gt; Backdoor&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Client topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;7193237834753421&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Base64 encoded shellcode payload&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Disconnect packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&quot;5&quot; type=&quot;1&quot;&gt;
&lt;li&gt;If a payload is received then, the backdoor reconnects to the MQTT client using a new randomly generated client ID. It then publishes a message with the character &#039;0&#039; to the third client-specific topic acknowledging receipt of the payload, and publishes a second message to the first client-specific topic with the results of loading the payload. This message consists of the eight-byte payload ID followed by either the character &#039;3&#039; if the payload was executed successfully, or the character &#039;4&#039; if an error was encountered. The backdoor then sends a disconnect packet and proceeds to sleep before restarting the communications loop.&lt;/li&gt;
&lt;/ol&gt;
&lt;table class=&quot;ScrollCode&quot; style=&quot;margin-left: .5in; border: dashed #6199C9 1.0pt;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;&quot; valign=&quot;top&quot;&gt;
&lt;div style=&quot;border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;&quot;&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Connect packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Protocol version &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Randomly generated Client ID&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io (Client Topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;) -&gt; C2&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Client topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;7193237834753421&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Acknowledgement of payload &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;0&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io (Client Topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;) -&gt; C2&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Publish packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Topic: Client topic &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; (e.g. &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;2583182944987015&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - Message: Result type message&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit message type = &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;3&#039;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; or &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #003366;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;&#039;4&#039;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;        &lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: #009900;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; digit payload ID&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;Backdoor -&gt; broker.emqx.io&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;&quot;&gt;&lt;span style=&quot;color: black;&quot;&gt;&lt;span style=&quot;font-size: 9.0pt; line-height: 107%; font-family: &#039;Courier New&#039;;&quot;&gt;    - MQTT Disconnect packet&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The move to using the MQTT protocol by WailingCrab represents a focused effort on stealth and detection evasion. The MQTT protocol is currently not commonly used by malware. It therefore is unlikely to come under much scrutiny by existing security solutions, especially in environments that use MQTT for legitimate IoT traffic. However, as MQTT is primarily used for IoT traffic, this may also make malicious use of it easier to detect in environments or systems that should not have IoT-related activity.&lt;/p&gt;
&lt;p&gt;The newer variants of WailingCrab also remove the callouts to Discord for retrieving payloads, further increasing its stealthiness. Discord has become an increasingly common choice for threat actors looking to host malware, and as such it is likely that file downloads from the domain will start coming under higher levels of scrutiny. Therefore, it is not surprising that the developers of WailingCrab decided on an alternative approach.&lt;/p&gt;
&lt;p&gt;The upgrades to the C2 communication protocol have also been an unfortunate blow to security researchers. In the initial version, the use of the communal campaign topic made it relatively straightforward to observe the malware&#039;s activity. The fact that WailingCrab uses a public broker means that anyone could subscribe to the campaign topic and monitor the messages being sent to it. In the new version the developers have switched to communicating via client-specific topics only, and unfortunately removing this wider visibility of the malware&#039;s activity.&lt;/p&gt;
&lt;h2&gt;Recommendations&lt;/h2&gt;
&lt;ul type=&quot;disc&quot;&gt;
&lt;li&gt;Ensure anti-virus software and associated files are up to date&lt;/li&gt;
&lt;li&gt;Search for existing signs of the indicated IOCs in your environment&lt;/li&gt;
&lt;li&gt;Consider blocking and or setting up detection for all URL and IP-based IOCs&lt;/li&gt;
&lt;li&gt;Consider blocking or monitoring the use of the MQTT protocol, especially in environments or systems that should not have IoT-related activity&lt;/li&gt;
&lt;li&gt;Keep applications and operating systems running at the current released patch level&lt;/li&gt;
&lt;li&gt;Exercise caution with attachments and links in emails.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt; &lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;!-- wp:heading --&gt;
&lt;h2 class=&quot;wp-block-heading&quot;&gt;IOCs&lt;/h2&gt;
&lt;!-- /wp:heading --&gt;

&lt;!-- wp:table --&gt;
&lt;figure class=&quot;wp-block-table&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Indicator&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;Indicator Type&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;Context&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;24c5f4868dc5af255edbb993d98de51a&lt;/td&gt;&lt;td&gt;MD5&lt;/td&gt;&lt;td&gt;WailingCrab Loader&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;f6ea7ec5d94bc65bf82a6b42b57a6c82&lt;/td&gt;&lt;td&gt;MD5&lt;/td&gt;&lt;td&gt;WailingCrab Loader&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;f6d0b9617405f35bb846d671edda75d3&lt;/td&gt;&lt;td&gt;MD5&lt;/td&gt;&lt;td&gt;WailingCrab Loader&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;971dd6c48909adf98861fb8457125faa&lt;/td&gt;&lt;td&gt;MD5&lt;/td&gt;&lt;td&gt;WailingCrab Loader&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;f03e8c10c84f7ba65caa84e194831a34&lt;/td&gt;&lt;td&gt;MD5&lt;/td&gt;&lt;td&gt;WailingCrab Backdoor&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;9e20801f9f4dc6f871d67470583dde0c&lt;/td&gt;&lt;td&gt;MD5&lt;/td&gt;&lt;td&gt;WailingCrab Backdoor&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//epikurgroup[.]com/plugins/content/jw_allvideos/jw_allvideos/tmpl/Responsive/oiyqnk182.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//rgjllc[.]pro/wp-content/themes/sydney/inc/notices/uiqbw123udibjk1d2.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//advocates4consumerprotection[.]com/wp-includes/js/tinymce/skins/iudjh9iwd182.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//inspiration-canopee[.]fr/vendor/fields/assets/idnileeal/sifyhewmiyq/3jnd9021j9dj129.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//www.p-e-c[.]nl/wp-content/themes/twentytwentyone/hudiiiwj1.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//vivalisme[.]fr/forms/forms/kiikxnmlogx/frrydjqb/vendor/9818hd218hd21.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//tournadre.dc1-mtp[.]fr/wp-content/plugins/kona-instagram-feed-for-gutenbargwfn/4dionaq9d0219d.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//studiolegalecarduccimacuzzi[.]it/Requests/tmetovcqhnisl/vendor/gyuonfuv/languages/vgwtdpera/Requests/5i8ndio12niod21.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//erbilmail[.]com/ind9010j29d0j2.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//www.flow[.]enterprises/wp-admin/css/piudbnui91nid2s1.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//luna-render[.]com/wp-admin/css/pinqidnmwm1192.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//loopmatrix[.]in/dbh9182hdj1o2mde.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//humandata[.]solutions/wp-admin/js/diub890hd91222.php?id=1&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab C2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;broker.emqx[.]io&lt;/td&gt;&lt;td&gt;Domain&lt;/td&gt;&lt;td&gt;MQTT Broker Misused by WailingCrab&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//cdn.discordapp[.]com/attachments/1128405963062378558/1128406314452799499/dw4qdkjbqwijhdhbwqjid.iso&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab Loader Download URL&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//cdn.discordapp[.]com/attachments/1148282858646016085/1148283708323938354/dj12iodd12iond.pic&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab Loader Download URL&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//cdn.discordapp[.]com/attachments/1151584859765080094/1151616346656886885/d17b28d9d2m9od92.avi&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab Loader Download URL&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;https[:]//cdn.discordapp[.]com/attachments/1124390807626076192/1128383419970240662/s42.iso&lt;/td&gt;&lt;td&gt;URL&lt;/td&gt;&lt;td&gt;WailingCrab Loader Download URL&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;!-- /wp:table --&gt;"
      }
</script>

<!-- BREADCRUMB SCHEMA -->
<script id="post-schema" type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://securityintelligence.com/"
            },
                    ]
    }
</script>
<div id="progressbar">
    <amp-animation id="progress-animation" layout="nodisplay">
        <script type="application/json">
            {
                "duration": "1s",
                "iterations": "1",
                "fill": "both",
                "direction": "alternate",
                "animations": [{
                    "selector": "#progressbar",
                    "keyframes": [{
                        "transform": "translateX(0)"
                    }]
                }]
            }
        </script>
    </amp-animation>
</div>
<amp-position-observer target="post__content" intersection-ratios="0" viewport-margins="25vh 75vh" on="scroll:progress-animation.seekTo(percent=event.percent)" layout="nodisplay"></amp-position-observer>

<div class="dark_background"  style="background:black;"></div>
<div class="container grid" style="background:black;">
      <!-- Breadcrumbs -->
      
<aside class="breadcrumbs ">
      <h1 class="breadcrumbs__page_title">Stealthy WailingCrab Malware misuses MQTT Messaging Protocol</h1>      </aside>
</div>
<div class="container grid hero_background ">
      <div class="grid__content post ">
            <div class="post__thumbnail">                
                <amp-img alt="A circuit board showing a glowing red software bug icon" width="1200" height="630" layout="responsive" src="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering-630x330.jpeg.webp" srcset="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering-300x158.jpeg.webp 300w,
                    /wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering-630x330.jpeg.webp 630w,
                    /wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg.webp 1200w,
                    /wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg.webp 2400w">
                    <amp-img fallback alt="A circuit board showing a glowing red software bug icon" width="1200" height="630" layout="responsive" src="https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering-630x330.jpeg" srcset="https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering-300x158.jpeg 300w,
                            https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering-630x330.jpeg 630w,
                            https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg 1200w,
                            https://securityintelligence.com/wp-content/uploads/2023/11/software-bug.-Circuit-board-bug-icon-hologram-3D-Rendering.jpeg 2400w">
                    </amp-img>
                </amp-img>
            </div>            <div class="new_categoy">
            <div class="category-container">
            
      <div class="category">
                  <div class="theme">
                        <div class="form-check form-switch">
                        <div class="link-container">
                              <a href="#" class="theme-link" id="light-theme-link">Light</a>
                              <a href="#" class="theme-link" id="dark-theme-link">Dark</a>
                        </div>
                        </div>
                  </div>
                  <hr class="separator">
                  <div class="author_date">
                        <div class="information">
                        <span class="date">November 21, 2023</span>
                        <span class="author_category">By <a href="https://securityintelligence.com/author/charlotte-hammond/" >Charlotte Hammond</a>
                        <span class="author_comma"></span><br>
                                    <!--== Co-Authors ==-->
                                    <!-- <br /> -->
                                    
                                                                              <a href="https://securityintelligence.com/author/ole-villadsen/">Ole Villadsen</a>
                                                <span class="author_comma"></span><br>
                                                                              <a href="https://securityintelligence.com/author/kat-metrick/">Kat Metrick</a>
                                                <br>
                                                                                    </span>
                        <span  class="author_category"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 14</span> <span class="rt-label rt-postfix">min read</span></span></span>
                        </div>
                  </div>
                  <hr class="separator">
                  <div class="title">
                  <a href="https://securityintelligence.com/category/x-force/threat-intelligence/"><span class="name_category">Threat Intelligence<br>
                                               <a href="https://securityintelligence.com/category/x-force/"><span class="name_other_category">X-Force<br>
                                          
                  </span></a>
                  
                  </div>
                  <div class="social-container" style="visibility: hidden;">
                  <hr class="separator">
                  <div class="social">
                                                                        <!-- Social ICONS -->
                              <a href="https://twitter.com/intent/tweet?text=Stealthy WailingCrab Malware misuses MQTT Messaging Protocol&url=https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/" target="_blank" rel="noopener noreferrer"><amp-img class="arrow" layout="fixed" height="26" width="26" src="https://securityintelligence.com/wp-content/themes/sapphire/images/social-icons/twitter.svg" alt="twitter"></amp-img></a>
                              <a href="https://www.linkedin.com/shareArticle?url=https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/" target="_blank" rel="noopener noreferrer"><amp-img class="arrow" layout="fixed" height="26" width="26" src="https://securityintelligence.com/wp-content/themes/sapphire/images/social-icons/linkedin.svg" alt="Linkedin" ></amp-img></a>
                              <a href="https://www.facebook.com/sharer/sharer.php?u=https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/" target="_blank" rel="noopener noreferrer"><amp-img class="arrow" layout="fixed" height="26" width="26" src="https://securityintelligence.com/wp-content/themes/sapphire/images/social-icons/facebook.svg" alt="facebook"></amp-img></a>
                              <a href="https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/" target="_blank" rel="noopener noreferrer"><amp-img class="arrow" layout="fixed" height="26" width="26" src="https://securityintelligence.com/wp-content/themes/sapphire/images/social-icons/link.svg" alt="An arrow pointing up"></amp-img></a>

                                          </div>
                  </div>
            </div>
      <script>
            window.addEventListener('scroll', function() {
            var category = document.querySelector('.category');
            var scrollPosition = window.scrollY;

            if (scrollPosition >= 0) {
                  category.classList.add('sticky');
            } else {
                  category.classList.remove('sticky');
            }
            });

            // Function to set the light theme
            function setLightTheme(event, toSaveLocalStorage = true) {
                  event.preventDefault();
                  const body = document.body;
                  body.classList.remove('dark-theme');
                  // Save the user's theme preference in localStorage
                  if (toSaveLocalStorage && !location.href.includes("/x-force/")) {
                        setSiTheme('light');
                  }
            }

            // Function to set the dark theme
            function setDarkTheme(event, toSaveLocalStorage = true) {
                  event.preventDefault();
                  const body = document.body;
                  body.classList.add('dark-theme');
                  // Save the user's theme preference in localStorage
                  if (toSaveLocalStorage && !location.href.includes("/x-force/")) {
                        setSiTheme('dark');
                  }
            }

            // Add click event listeners to the theme links
            document.getElementById('light-theme-link').addEventListener('click', (event) => setLightTheme(event));
            document.getElementById('dark-theme-link').addEventListener('click', (event) => setDarkTheme(event));

            // Check localStorage to set the initial theme preference
            const themePreference = localStorage.getItem('si-theme-mode');

            // Function to simulate a click event
            function simulateClick(handler, toSaveLocalStorage) {
                  const event = new Event('click');
                  handler(event, toSaveLocalStorage);
            }

            // Apply the correct theme based on URL and preference
            if (location.href.includes("/x-force/")) {
                  simulateClick(setDarkTheme, false); // Apply the dark theme for all x-force posts
            } else if (themePreference === 'dark') {
                  simulateClick(setDarkTheme, true); // Apply the dark theme based on user preference
            } else if (themePreference === 'light') {
                  simulateClick(setLightTheme, true); // Apply the light theme based on user preference (default)
            } else {
                  simulateClick(setLightTheme, true); // Apply the light theme by default
            }
      </script>
<script>
      const cookies = JSON.parse(localStorage.getItem("truste.eu.cookie.notice_preferences"));
      if (cookies && cookies.value === '2:') {
            document.querySelector('.social-container').style.visibility = 'visible';
      }
</script>            </div>
            <main class="post__content   post__content--continue_reading" id="post__content">
                  


<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><p><em>This article was made possible thanks to the hard work of writer Charlotte Hammond and contributions from Ole Villadsen and Kat Metrick.</em></p>
<p>IBM X-Force researchers have been tracking developments to the WailingCrab malware family, in particular, those relating to its C2 communication mechanisms, which include misusing the Internet-of-Things (IoT) messaging protocol MQTT.</p>
<p>WailingCrab, also known as <a href="https://www.proofpoint.com/us/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion" target="_blank" rel="noopener nofollow" >WikiLoader</a>, is a sophisticated, multi-component malware delivered almost exclusively by an initial access broker that X-Force tracks as Hive0133, which overlaps with TA544. WailingCrab was first observed in December 2022, and since then it has been used extensively in email campaigns to deliver the Gozi backdoor often against Italian targets. In recent months, Hive0133 has targeted organizations beyond Italy with email campaigns delivering WailingCrab, frequently using themes such as overdue delivery or shipping invoices.</p>
<p>The malware authors have focused on stealth and anti-analysis techniques in the continued development of the WailingCrab malware. The malware itself is split into multiple components, including a loader, injector, downloader and backdoor, and successful requests to C2-controlled servers are often necessary to retrieve the next stage. Legitimate, hacked websites are used for initial C2 communications to lower the chance of network detection, and payloads are often hosted on well-known platforms such as Discord. C2 servers are often taken down quickly or stop responding soon after a campaign which may prevent threat researchers from accessing them and retrieving the next stages of the malware. Additionally, WailingCrab makes use of code obfuscation, anti-analysis, and anti-sandbox techniques throughout its code.</p>
<p>WailingCrab&rsquo;s core component is its backdoor, which is installed on the system only if the malware&rsquo;s initial stages are completed successfully. Since mid-2023, WailingCrab&rsquo;s backdoor component has communicated with the C2 using the <a href="https://mqtt.org/" target="_blank" rel="noopener nofollow" >MQTT protocol</a> which is a lightweight IoT messaging protocol. MQTT uses a publish/subscribe architecture, whereby messages are published to &lsquo;topics&rsquo; and received by subscribers, with message distribution handled by a centralized broker. In this instance, WailingCrab uses the legitimate, third-party broker, <b>broker.emqx[.]io</b>, which allows it to hide the true address of the C2 server.</p>
<p>WailingCrab&rsquo;s use of the MQTT is notable, as this protocol is not commonly used by malware. There have only been a handful of instances reported, with the most recent being the <a href="https://www.welivesecurity.com/2023/03/02/mqsttang-mustang-panda-latest-backdoor-treads-new-ground-qt-mqtt/" target="_blank" rel="noopener nofollow" >MQsTTang backdoor</a> attributed to the threat actor Mustang Panda. As a result of this, the protocol&rsquo;s use may not be monitored as closely by security teams, allowing the backdoor&rsquo;s C2 communications to fly under the radar.</p>
<p>This blog provides an overview of WailingCrab and its C2 communications, with a focus on its use of the MQTT <a >protocol.</a></p>
<h2>Delivery</h2>
<p>Since its inception, WailingCrab has been distributed via email spam campaigns using&nbsp;<a href="https://www.proofpoint.com/us/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion" target="_blank" rel="noopener nofollow" >Microsoft Excel attachments, Microsoft OneNote attachments or PDF attachments</a>. In recent months, Hive0133 has favored the use of PDF attachments containing malicious URLs in their email campaigns delivering WailingCrab. When clicked, the links will download and execute JScript files, which in turn will download and execute the WailingCrab loader, which is usually hosted as an attachment file on Discord. Below is an example of a Hive0133 email campaign delivering WailingCrab on 19 October.</p>
<div>
<div id="_com_1">
<p><amp-img src="https://images2.cmp.optimizely.com/Zz0wZThmNzNkODg1ODIxMWVlODBlMThhMDI0YzVjM2RjMQ==" layout="intrinsic" class="" alt="WailingCrab_Email.png" width="596.7914438502675" height="550" lightbox="lightbox"></amp-img></p>
<p><i>Figure 1: Hive0133 Email from 10/19/2023 delivering WailingCrab Loader.</i></p>
<p><i><amp-img src="https://images1.cmp.optimizely.com/Zz0yMTFmMGViNDg1ODIxMWVlOTBhNzJhMjA0ODg2Y2YyOA==" layout="intrinsic" class="" alt="WailingCrab_PDF.png" width="564.0080428954424" height="550" lightbox="lightbox"></amp-img></i></p>
<p><i>Figure 2: Hive0133 Email PDF Attachment with Malicious Link Leading to WailingCrab Loader.</i></p>
<h2>WailingCrab components</h2>
<p>Many of the technical details of WailingCrab&rsquo;s operation and early variants have already been discussed <a href="https://www.proofpoint.com/uk/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion" target="_blank" rel="noopener nofollow" >in other research</a>, therefore in this blog, we will focus on new developments and those aspects which have not already been reported on.</p>
<p>The primary samples used for this research are <b>24c5f4868dc5af255edbb993d98de51a</b> and <b>f6ea7ec5d94bc65bf82a6b42b57a6c82</b>, which were from campaigns in September, and <b>f6d0b9617405f35bb846d671edda75d3</b> which was observed in July and is the reference for the earlier version of the MQTT protocol use. These samples are all first-stage WailingCrab Loaders, which were hosted on Discord and downloaded via spam campaigns like the one described above. The subsequent WailingCrab components discussed in this blog were all unpacked or downloaded by these loaders.</p>
<h3>WailingCrab loader</h3>
<p>The first component of WailingCrab is its loader, which commonly uses a legitimate DLL file as a template, with the malicious code patched over one of the DLL&rsquo;s exported functions. Its purpose is to load the second stage which is stored within the DLL as an encrypted shellcode.</p>
<p>This initial loader component of WailingCrab has received a few updates in more recent samples. In the previous version, the loader would overwrite its own data section in memory with the code for its second-stage component. In the new version, the malware first loads a legitimate Windows DLL, such as <b>BingMaps.dll</b>, and then overwrites the code for one of the DLL&rsquo;s exported functions with WailingCrab&rsquo;s second-stage shellcode. It also patches the code at the DLL&rsquo;s original entry point such that it returns immediately rather than running its original code, allowing execution to proceed unimpeded to the maliciously patched export function.</p>
<p>The WailingCrab loader then creates a new thread to run its second-stage shellcode within the context of the legitimate loaded DLL.</p>
<h3>WailingCrab injector</h3>
<p>The second stage is the WailingCrab injector, the functionality of which has not changed much from the previous version.</p>
<p>The Injector component starts by looping through the currently running processes on the host system and creates a hash of each process filename until it finds one that matches its target hash, which in the analyzed sample corresponds to <b>explorer.exe</b>. At this point, the malware will also compare the hash of each running process name to a list of hashes associated with sandbox or debugging applications, and will not continue if any of these are found.</p>
<p>Once it identifies its target process, WailingCrab opens it and allocates memory within the process space. It then decrypts its third-stage component using XOR and writes the decrypted payload contents to the allocated memory region, along with a string containing the file path of the initial loader.</p>
<p>Next, WailingCrab searches the DLLs loaded within the target process (i.e. explorer.exe) and looks for ntdll.dll. Within the ntdll.dll instance, it finds the address of a target API function, in this case, <b>RtlWow64GetCurrentMachine</b>. It then overwrites the contents of this function with 12 bytes of trampoline hook code, the purpose of which is to jump to the start of the copied payload.</p>
<p>The malware then creates a new thread within the target process. The start address of the thread is set to that of the hooked&nbsp;API function, e.g. <b>RtlWow64GetCurrentMachine</b>.&nbsp;Upon creation, the new thread executes the target API function, which now contains the hook code, and this then transfers execution to the payload, which is the next WailingCrab component.</p>
<h3>WailingCrab downloader</h3>
<p>The third WailingCrab component is a Downloader/Loader, which is responsible for loading the Backdoor component. The code for this stage is run within the context of the injected process; in this case, <b>explorer.exe</b>.</p>
<p>Much of the functionality of the downloader is the same as in previous versions, however, there have been some updates. In prior versions, this component would download the backdoor, which would be hosted as an attachment on the Discord CDN.&nbsp; However, the latest version of WailingCrab already contains the backdoor component encrypted with AES, and it instead reaches out to its C2 to download a decryption key to decrypt the backdoor.</p>
<p>The WailingCrab downloader starts in the same manner as prior versions, by sleeping for a set period, and then deleting the original loader file on disk. It also creates a mutex, where the mutex name is a hardcoded numeric string, for example, &ldquo;<b>823264&Prime;</b>.</p>
<p>At this point in the previous version, WailingCrab would then perform connectivity and anti-sandbox checks by attempting to connect to <a href="https://www.wikipedia.org/" target="_blank" rel="noopener nofollow" >https://www.wikipedia.org/</a> and also a non-existent domain and confirming that the results of both are what it expects. However, these checks have been removed from the new version, and the malware proceeds straight to C2 communication.</p>
<p>WailingCrab proceeds to register with the C2. It randomly generates bot ID values and also gathers basic system information including domain, hostname, username, language and system time. These values are then formatted into a pipe-delimited string, along with an eight-digit campaign ID which is hardcoded into the malware.</p>
<p>In the previous version, the randomly generated bot ID was a single eight-digit string, however in the new variant three 16-digit strings are generated instead, and these will be used later on by the backdoor component as MQTT topic names during its communication with the C2.</p>
<p><b>Previous Version:</b></p>
<table class="ScrollCode" style="border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;">
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lt;campaign_id&gt;||&lt;botid&gt;||&lt;domain&gt;||&lt;hostname&gt;||&lt;username&gt;||&lt;admin_status&gt;||&lt;language_id&gt;||&lt;system_time&gt;||&lt;os_version&gt;||</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">e.g.</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">84234775</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">52270349</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||-||DESKTOP-JGLLJLD||admin||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">0</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1033</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2023.07</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">.</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">12</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">+</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">06</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">:</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">50</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">10.00</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">.</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">19044</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<p><b>New Version:</b></p>
<table class="ScrollCode" style="border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;">
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lt;campaign_id&gt;||&lt;16_digit_bot_value1&gt;&lt;16_digit_bot_value2&gt;&lt;16_digit_bot_value3&gt;||domain||&lt;hostname&gt;||&lt;username&gt;||&lt;admin_status&gt;||&lt;language_id&gt;||&lt;system_time&gt;||&lt;os_version&gt;||</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">e.g.</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">63785091</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">258318294498701539673492921154037193237834753421</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||-||DESKTOP-JGLLJLD||admin||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">0</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1033</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2023.09</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">.</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">15</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">+</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">11</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">:</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">32</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">10.00</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">.</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">19045</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<p>This string is then base64 encoded and added to the Cookie field in the HTTP registration request sent to the C2. The C2 URL is chosen at random from a list, and the following URLs were present in the analyzed sample:</p>
<table class="ScrollCode" style="border: 1pt dashed #6199c9; width: 88.8081%; height: 103px;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 100%; border: none; padding: 8.65pt 5pt 12.95pt 2.9pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;">
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">https[:]</span></span><span style="color: #008200;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">//epikurgroup[.]com/plugins/content/jw_allvideos/jw_allvideos/tmpl/Res</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #008200;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">ponsive/oiyqnk182.php?id=1&nbsp;</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">https[:]</span></span><span style="color: #008200;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">//rgjllc[.]pro/wp-</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #008200;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">content/themes/sydney/inc/notices/uiqbw123udibjk1d2.php?id=1</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">https[:]</span></span><span style="color: #008200;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">//advocates4consumerprotection[.]com/wp-</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #008200;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">includes/js/tinymce/skins/iudjh9iwd182.php?id=1</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<p>The C2 registration domains are usually legitimate WordPress-based websites that have been compromised by the threat actor to include a malicious PHP file that processes the requests from the WailingCrab malware. When a request is made to one of these URLs with the correct cookie set, the malicious PHP code inserts a comment into the source code of the returned webpage which contains the response data for the downloader.</p>
<p>The below image shows a request being made to one of the C2 URLs, where the cookie field contains the base64 encoded registration string.</p>
<p><amp-img src="https://images2.cmp.optimizely.com/Zz02NGVkYjQwYTg1ODMxMWVlOTE2MDZlYWNlYmFkZmYxNQ==" layout="intrinsic" class="" alt="231106-wailingcrab-download-c2.PNG" width="678" height="130" lightbox="lightbox"></amp-img></p>
<p>If the registration request is successful, the source code of the returned web page will contain a comment containing the word &lsquo;gmail&rsquo; followed by a base64 string, similar to that seen in the below image.</p>
<p><amp-img src="https://images2.cmp.optimizely.com/Zz05MDFlZDY5MDg1ODMxMWVlOGU1ZTZlYWNlYmFkZmYxNQ==" layout="intrinsic" class="" alt="231106-wailingcrab-download-c2-response.PNG" width="666" height="213" lightbox="lightbox"></amp-img></p>
<p>In prior versions of WailingCrab, the base64 response would be decoded to reveal a Discord CDN URL path which the next stage of the malware could be downloaded from.</p>
<p>In the new version, the decoded base64 instead contains an encrypted AES key. In this case, the first 8 bytes of the decoded data are XOR&rsquo;d together, and the final value is then used to XOR-decrypt the remaining 32 bytes of the data which is the AES key.</p>
<p>The AES key is then used by WailingCrab to decrypt the backdoor component using AES-256 in CBC mode with a null-byte IV. The backdoor code is then executed.</p>
<h3>WailingCrab backdoor</h3>
<p>The WailingCrab backdoor is a sophisticated piece of malware responsible for installing persistence and beaconing to the C2. The backdoor installs itself in a randomly named subdirectory of either the user&rsquo;s %AppData% folder or the %ProgramData% folder. WailingCrab copies several files to this directory and modifies some by overwriting them with chunks of its code:</p>
<table class="ScrollCode" style="border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;">
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">C:\ProgramData\&lt;malware_dir&gt;\version.dll (copied from C:\WINDOWS\system32\version.dll and modified)</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">C:\ProgramData\&lt;malware_dir&gt;\&lt;random_name&gt;.exe (copied from C:\WINDOWS\system32\printfilterpipelinesvc.exe)</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">C:\ProgramData\&lt;malware_dir&gt;\xpspushlayer.dll (copied from C:\ProgramData\&lt;malware_dir&gt;\version.dll)</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">C:\ProgramData\&lt;malware_dir&gt;\thumbs.db (contains encrypted WailingCrab code)</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">C:\ProgramData\&lt;malware_dir&gt;\&lt;random_name&gt;.dll (copied from C:\ProgramData\&lt;malware_dir&gt;\version.dll and modified)</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<p>WailingCrab installs persistence by creating a randomly named subkey under the registry Run key and adding the file path of the copied and randomly renamed&nbsp;<b>printfilterpipelinesvc.exe</b>&nbsp;file. When this file is executed it loads the modified version.dll file via DLL hijacking, and execution then jumps between the various WailingCrab code chunks loaded from the other files, eventually ending up within an injected <b>explorer.exe</b> instance. The full technical details of this process are beyond the scope of this blog but are available in our full malware report on <a href="https://exchange.xforce.ibmcloud.com/malware-analysis/guid:dc1430e695fffa811866bda9578aaa1b" target="_blank" rel="noopener nofollow" >X-Force Exchange</a>.</p>
<h2>MQTT communication</h2>
<p>Communication between the WailingCrab backdoor component and the C2 is performed using the&nbsp;<a href="https://mqtt.org/" target="_blank" rel="noopener nofollow" >MQTT protocol</a> which is a lightweight IoT messaging protocol. MQTT uses a publish/subscribe architecture, with message distribution handled by a centralized broker. WailingCrab uses a third-party broker,&nbsp;<b>broker.emqx[.]io</b>, which allows it to hide the true address of the C2 server.</p>
<p>The basics of the MQTT protocol are quite straightforward. The client starts by sending a connect request to the broker, specifying its client ID, which the broker then acknowledges. After that the client can either publish messages to specific &lsquo;topics&rsquo;, or it can request to subscribe to a topic. Any clients who are subscribed to a topic will then receive future messages published on that topic.</p>
<h3>Previous version</h3>
<p>We initially observed WailingCrab using the MQTT protocol in mid-2023, and this version of the backdoor communicated with the C2 using the following procedure.</p>
<ol start="1" type="1">
<li>The backdoor starts by sending a connect request to&nbsp;broker.emqx[.]io&nbsp;using a randomly generated client ID.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Connect packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Protocol version </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">5</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Randomly generated Client ID, e.g. xMMRYbWc</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="2" type="1">
<li>It then registers with the C2 by publishing a message to a topic named using the same campaign ID string found in the WailingCrab downloader. The registration message is 25 characters long and consists of the number &lsquo;1&rsquo;, which is likely the message type, followed by a randomly generated 16-digit string, followed by the eight-digit bot ID generated by the downloader. For example:</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io (Campaign Topic) -&gt; C2</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Campaign ID (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">84234775</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Registration type message, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;1852460395177254652270349&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp; &nbsp; &nbsp; &nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit message type = </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;1&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> (registration message)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">16</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit randomly generated string, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;8524603951772546&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">8</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit bot ID, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;52270349&rsquo;</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="3" type="1">
<li>The purpose of the randomly generated 16-digit string (8524603951782546) is for it to be a client-specific topic name for the C2 and backdoor to communicate via, as opposed to the campaign name topic which is shared by all samples in the same campaign. The backdoor sends a subscribe request to the MQTT broker with the topic name set to this 16-digit string, which means that the broker will forward any future messages published to this topic to the backdoor. Once the subscription request is sent, the broker will then respond with a &lsquo;subscribe ack&rsquo; packet to acknowledge the subscription request.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Subscribe packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Subscribe Topic: Generated client-specific topic name e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">8524603951772546</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="4" type="1">
<li>The backdoor then publishes a general &lsquo;check-in&rsquo; type message to the campaign topic, which consists of the character &lsquo;2&rsquo; followed by the eight-digit bot ID.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io (Campaign Topic) -&gt; C2</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Campaign ID (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">84234775</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Check-in type message, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;252270349&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp; &nbsp; &nbsp; &nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit message type = </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;2&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> (check-in message)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">8</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit bot ID, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;52270349&rsquo;</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="5" type="1">
<li>At this point, the backdoor checks for any received messages. The C2 will publish any messages for the target to the client-specific topic, which the broker will then forward to the backdoor since it has subscribed to that topic. The messages from the C2 take the form of the character &lsquo;0&rsquo; if the C2 does not have any further instructions for the client, or the character &lsquo;2&rsquo; followed by a download path:</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">C2 -&gt; broker.emqx.io (Client Topic) -&gt; Backdoor</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Client Specific (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">8524603951772546</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Either </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;0&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> or payload message, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;2+1135578349968818269+1143152400132210688+djibh1ud21dORD1s.iso|1&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit message type = </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;0&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> or </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;2&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Download path with </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;/&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> characters replaced by </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;+&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;+1135578349968818269+1143152400132210688+djibh1ud21dORD1s.iso&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pipe delimiter, followed by single digit, usually </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;1&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> or </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;2&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; </span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="6" type="1">
<li>If the backdoor receives a download path from the C2 it will append the received path string to the URL https[:]//cdn.discordapp[.]com/attachments/ to create the full download URL. Any &lsquo;+&rsquo; characters in the path are converted to &lsquo;/&rsquo;. The backdoor will then download a payload from the constructed URL, decode it using base64 and then decrypt it using the same XOR-based algorithm used throughout the malware.&nbsp;The malware will generate a random filename with the .log extension, write the payload to the user&rsquo;s Temp directory, and&nbsp;then execute the file by creating a new process with the following command:</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">rundll32.exe &lt;payload_filepath&gt;, DllRegisterServer</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="7" type="1">
<li>The backdoor will then report the status back to the C2 by publishing a message to the campaign channel. If the payload download and execution operation was a success then it will send a message consisting of the character &lsquo;3&rsquo; followed by the bot ID. Otherwise, if there was an error, it will send the character &lsquo;4&rsquo; followed by the bot ID.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io (Campaign Topic) -&gt; C2</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Campaign ID (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">84234775</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Result type message, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;352270349&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp; &nbsp; &nbsp; &nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit message type = </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;3&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> or </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;4&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">8</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit bot ID, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;52270349&rsquo;</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="8" type="1">
<li>The malware will then disconnect the MQTT connection and then sleep for a fixed period of time before checking in with the C2 again.</li>
</ol>
<h3><strong>New version</strong></h3>
<p>Newer versions of WailingCrab, observed from September 2023 onwards, use an updated protocol when communicating with the C2.</p>
<p>As described above, in the previous version, all clients infected by a specific campaign would register with and send regular check-in messages to a single centralized MQTT topic named after the campaign ID. The initial registration message sent by each client would then contain a randomly generated 16-character numeric string which would then serve as the name of a client-specific topic where the C2 could send commands/payloads to the respective client.</p>
<p>In the new version, the use of the centralized topic has been removed, and infected clients and the C2 now communicate solely via client-specific topics, the names of which are taken from the three randomly generated 16-digit strings created by the downloader component and shared with the C2 as part of its initial request to the WordPress C2 URL.</p>
<p>For example, if the initial registration request sent by the downloader component contained the following:</p>
<table class="ScrollCode" style="border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;">
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">63785091</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">258318294498701539673492921154037193237834753421</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||-||DESKTOP-JGLLJLD||admin||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">0</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1033</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2023.09</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">.</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">15</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">+</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">11</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">:</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">32</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">10.00</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">.</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">19045</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">||</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<p>Then the three client-specific topic names would be:</p>
<table class="ScrollCode" style="border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 447.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 2.9pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: 12.0pt; margin-right: 0in;">
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2583182944987015</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3967349292115403</span></span></p>
<p style="margin: 0in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">7193237834753421</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<p>The use of Discord for hosting payloads has also been removed from this stage of the malware, and the backdoor now receives a shellcode-based payload directly from the C2 via MQTT rather than a Discord-based download path.</p>
<p>A full breakdown of the new C2 communication protocol is as follows:</p>
<ol start="1" type="1">
<li>As with the previous version, the backdoor starts by sending an MQTT connect packet to broker.emqx[.]io via TCP port 1883 using a randomly generated eight-character client ID.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Connect packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Protocol version </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">5</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Randomly generated Client ID, e.g. xMMRYbWc</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="2" type="1">
<li>It then retrieves the local time of the infected system and constructs a datetime structure which it encodes using base64. The backdoor then publishes a message containing the base64 string, with the topic set to the second of the randomly generated topic names.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io (Client Topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">) -&gt; C2</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Client topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3967349292115403</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Check-in message, e.g. </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;AgAcABwAFAAKAOcH&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp; &nbsp; &nbsp; &nbsp; Base64 encoded datetime value, e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">02</span></span> <span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">00</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> 1c </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">00</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> 1c </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">00</span></span> <span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">14</span></span> <span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">00</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> 0a </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">00</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> e7 </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">07</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Breaks down as six </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&ndash;</span></span><span style="color: #336699; font-weight: bold;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">byte</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> values: Hour Min Sec Day Month Year</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="3" type="1">
<li>The backdoor then sends a subscribe request to the third topic.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Subscribe packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Subscribe Topic: Client topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">7193237834753421</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="4" type="1">
<li>The backdoor checks to see if it has received any messages via the subscribed topic, and then sends a disconnect packet. If no message is received, the malware proceeds to sleep and then restart the communications loop. If a message has been received, the backdoor checks that the length is greater than 128 bytes, and if so proceeds to decode it from base64. The first 8 bytes of the decoded payload contain a payload ID value, and the second set of 8 bytes is used to calculate the XOR key to decrypt the rest of the payload data. The backdoor expects the decrypted payload to be another shellcode component which it then executes in a new thread.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">C2 -&gt; broker.emqx.io (Client Topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">) -&gt; Backdoor</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Client topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">7193237834753421</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Base64 encoded shellcode payload</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;</span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Disconnect packet</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<ol start="5" type="1">
<li>If a payload is received then, the backdoor reconnects to the MQTT client using a new randomly generated client ID. It then publishes a message with the character &lsquo;0&rsquo; to the third client-specific topic acknowledging receipt of the payload, and publishes a second message to the first client-specific topic with the results of loading the payload. This message consists of the eight-byte payload ID followed by either the character &lsquo;3&rsquo; if the payload was executed successfully, or the character &lsquo;4&rsquo; if an error was encountered. The backdoor then sends a disconnect packet and proceeds to sleep before restarting the communications loop.</li>
</ol>
<table class="ScrollCode" style="margin-left: .5in; border: dashed #6199C9 1.0pt;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 411.3pt; border: none; padding: 8.65pt 5.0pt 12.95pt 20.0pt;" valign="top">
<div style="border: none; border-left: none windowtext 1.0pt; padding: 0in 0in 0in 12.0pt; margin-left: -6.0pt; margin-right: 0in;">
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Connect packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Protocol version </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">5</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Randomly generated Client ID</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;</span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io (Client Topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">) -&gt; C2</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Client topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">3</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">7193237834753421</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Acknowledgement of payload </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;0&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;</span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io (Client Topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">) -&gt; C2</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Publish packet</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Topic: Client topic </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> (e.g. </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">2583182944987015</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">)</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; Message: Result type message</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">1</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit message type = </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;3&rsquo;</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> or </span></span><span style="color: #003366;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&lsquo;4&rsquo;</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="color: #009900;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">8</span></span><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';"> digit payload ID</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;</span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">Backdoor -&gt; broker.emqx.io</span></span></p>
<p style="margin: 0in 0in 0in 0.25in; text-indent: -0.25in; line-height: 107%; break-after: avoid; border: none; padding: 0in; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="color: black;"><span style="font-size: 9.0pt; line-height: 107%; font-family: 'Courier New';">&nbsp;&nbsp;&nbsp; &ndash; MQTT Disconnect packet</span></span></p>
</div>
</td>
</tr>
</tbody>
</table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div>
<h2>Conclusion</h2>
<p>The move to using the MQTT protocol by WailingCrab represents a focused effort on stealth and detection evasion. The MQTT protocol is currently not commonly used by malware. It therefore is unlikely to come under much scrutiny by existing security solutions, especially in environments that use MQTT for legitimate IoT traffic. However, as MQTT is primarily used for IoT traffic, this may also make malicious use of it easier to detect in environments or systems that should not have IoT-related activity.</p>
<p>The newer variants of WailingCrab also remove the callouts to Discord for retrieving payloads, further increasing its stealthiness. Discord has become an increasingly common choice for threat actors looking to host malware, and as such it is likely that file downloads from the domain will start coming under higher levels of scrutiny. Therefore, it is not surprising that the developers of WailingCrab decided on an alternative approach.</p>
<p>The upgrades to the C2 communication protocol have also been an unfortunate blow to security researchers. In the initial version, the use of the communal campaign topic made it relatively straightforward to observe the malware&rsquo;s activity. The fact that WailingCrab uses a public broker means that anyone could subscribe to the campaign topic and monitor the messages being sent to it. In the new version the developers have switched to communicating via client-specific topics only, and unfortunately removing this wider visibility of the malware&rsquo;s activity.</p>
<h2>Recommendations</h2>
<ul type="disc">
<li>Ensure anti-virus software and associated files are up to date</li>
<li>Search for existing signs of the indicated IOCs in your environment</li>
<li>Consider blocking and or setting up detection for all URL and IP-based IOCs</li>
<li>Consider blocking or monitoring the use of the MQTT protocol, especially in environments or systems that should not have IoT-related activity</li>
<li>Keep applications and operating systems running at the current released patch level</li>
<li>Exercise caution with attachments and links in emails.</li>
</ul>
<p>&nbsp;</p>
</div>
</div>


<h2 class="wp-block-heading">IOCs</h2>



<figure class="wp-block-table"><table><tbody><tr><td><strong>Indicator</strong></td><td><strong>Indicator Type</strong></td><td><strong>Context</strong></td></tr><tr><td>24c5f4868dc5af255edbb993d98de51a</td><td>MD5</td><td>WailingCrab Loader</td></tr><tr><td>f6ea7ec5d94bc65bf82a6b42b57a6c82</td><td>MD5</td><td>WailingCrab Loader</td></tr><tr><td>f6d0b9617405f35bb846d671edda75d3</td><td>MD5</td><td>WailingCrab Loader</td></tr><tr><td>971dd6c48909adf98861fb8457125faa</td><td>MD5</td><td>WailingCrab Loader</td></tr><tr><td>f03e8c10c84f7ba65caa84e194831a34</td><td>MD5</td><td>WailingCrab Backdoor</td></tr><tr><td>9e20801f9f4dc6f871d67470583dde0c</td><td>MD5</td><td>WailingCrab Backdoor</td></tr><tr><td>https[:]//epikurgroup[.]com/plugins/content/jw_allvideos/jw_allvideos/tmpl/Responsive/oiyqnk182.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//rgjllc[.]pro/wp-content/themes/sydney/inc/notices/uiqbw123udibjk1d2.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//advocates4consumerprotection[.]com/wp-includes/js/tinymce/skins/iudjh9iwd182.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//inspiration-canopee[.]fr/vendor/fields/assets/idnileeal/sifyhewmiyq/3jnd9021j9dj129.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//www.p-e-c[.]nl/wp-content/themes/twentytwentyone/hudiiiwj1.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//vivalisme[.]fr/forms/forms/kiikxnmlogx/frrydjqb/vendor/9818hd218hd21.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//tournadre.dc1-mtp[.]fr/wp-content/plugins/kona-instagram-feed-for-gutenbargwfn/4dionaq9d0219d.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//studiolegalecarduccimacuzzi[.]it/Requests/tmetovcqhnisl/vendor/gyuonfuv/languages/vgwtdpera/Requests/5i8ndio12niod21.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//erbilmail[.]com/ind9010j29d0j2.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//www.flow[.]enterprises/wp-admin/css/piudbnui91nid2s1.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//luna-render[.]com/wp-admin/css/pinqidnmwm1192.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//loopmatrix[.]in/dbh9182hdj1o2mde.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>https[:]//humandata[.]solutions/wp-admin/js/diub890hd91222.php?id=1</td><td>URL</td><td>WailingCrab C2</td></tr><tr><td>broker.emqx[.]io</td><td>Domain</td><td>MQTT Broker Misused by WailingCrab</td></tr><tr><td>https[:]//cdn.discordapp[.]com/attachments/1128405963062378558/1128406314452799499/dw4qdkjbqwijhdhbwqjid.iso</td><td>URL</td><td>WailingCrab Loader Download URL</td></tr><tr><td>https[:]//cdn.discordapp[.]com/attachments/1148282858646016085/1148283708323938354/dj12iodd12iond.pic</td><td>URL</td><td>WailingCrab Loader Download URL</td></tr><tr><td>https[:]//cdn.discordapp[.]com/attachments/1151584859765080094/1151616346656886885/d17b28d9d2m9od92.avi</td><td>URL</td><td>WailingCrab Loader Download URL</td></tr><tr><td>https[:]//cdn.discordapp[.]com/attachments/1124390807626076192/1128383419970240662/s42.iso</td><td>URL</td><td>WailingCrab Loader Download URL</td></tr></tbody></table><div class="table-scroll-help-text"><span>Scroll to view full table </span></div></figure>
</body></html>
<div id="nc_pixel"></div><div class="post__tags">
        <a href="https://securityintelligence.com/tag/data-protection/" rel="tag">Data Protection</a><span>&nbsp;|&nbsp;</span><a href="https://securityintelligence.com/tag/data-security/" rel="tag">Data Security</a><span>&nbsp;|&nbsp;</span><a href="https://securityintelligence.com/tag/ibm-x-force-research/" rel="tag">IBM X-Force Research</a><span>&nbsp;|&nbsp;</span><a href="https://securityintelligence.com/tag/security-intelligence/" rel="tag">Security Intelligence</a><span>&nbsp;|&nbsp;</span><a href="https://securityintelligence.com/tag/security-intelligence-analytics/" rel="tag">security intelligence &amp; analytics</a><span>&nbsp;|&nbsp;</span><a href="https://securityintelligence.com/tag/x-force/" rel="tag">X-Force</a></div>


<div class="post__author author co-authors ">
      <div class="author__box">
            <div class="author__photo" style="background-image:  url(https://securityintelligence.com/wp-content/themes/sapphire/images/default-pic.jpg);"></div>
            <div class="author__infos">

                  <div class="author__name"><a href="https://securityintelligence.com/author/charlotte-hammond/" >Charlotte Hammond</a></div>
                  <div class="author__role">Malware Reverse Engineer, IBM Security</div>
            </div>
      </div>


                    
                                                    
                                          <div class="author__box">
                        <div class="author__photo" style="background-image:  url(https://securityintelligence.com/wp-content/uploads/2019/07/ole-villadsen.png);"></div>
                        <div class="author__infos">
                              <div class="author__name"><a href="https://securityintelligence.com/author/ole-villadsen/">Ole Villadsen</a></div>
                              <div class="author__role">Cyber Threat Hunt Analyst, IBM Security</div>
                        </div>
                  </div>
                                          <div class="author__box">
                        <div class="author__photo" style="background-image:  url(https://securityintelligence.com/wp-content/themes/sapphire/images/default-pic.jpg);"></div>
                        <div class="author__infos">
                              <div class="author__name"><a href="https://securityintelligence.com/author/kat-metrick/">Kat Metrick</a></div>
                              <div class="author__role">Security Consultant, IBM X-Force</div>
                        </div>
                  </div>
                                          
      </div>
<!-- CONTINUE READING -->
       <style type="text/css">
            .post__content--continue_reading{
                  max-height: 725px;
                  overflow:hidden;
                  transition: max-height cubic-bezier(0.9, 0, 1, 1) 2s;

                  
            }
            @media (max-width: 768px) {
                  .post__content--continue_reading{
                        max-height: 1225px;
                  }
            }
      </style>

      <div class="continue_reading_wrapper" id="continue_reading">
            <button on="tap: post__content.toggleClass(class=post__content--continue_reading),
                        continue_reading.toggleClass(class=continue_reading_wrapper--clicked)" 
                        tabindex="0" role="button">Continue Reading</button>
      </div>

 
            </main>
            </div>

            
      </div>

      
<aside class="grid__sidebar post__sidebar ">
      <div class="mobile_divider"></div>
      <header class="post__sidebar__header">POPULAR</header>

      

      <!-- ARTICLES  -->
      
      <article class="article article_grid article__mobile--card">
            <!-- IMG -->
            <a class="exclusive_article__category_link" href="https://securityintelligence.com/articles/cybersecurity-skills-gap-contributed-increase-average-breach-costs/" aria-label="The cybersecurity skills gap contributed to a $1.76 million increase in average breach costs">
                  <div class="article__img">                <amp-img alt="An Asian man working in an office with several empty cubicles behind him" width="1200" height="630" layout="responsive" src="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/man-working-in-office-630x330.jpeg.webp">
                    <amp-img fallback alt="An Asian man working in an office with several empty cubicles behind him" width="1200" height="630" layout="responsive" src="https://securityintelligence.com/wp-content/uploads/2024/10/man-working-in-office-630x330.jpeg">
                    </amp-img>
                </amp-img>
            </div>
            </a>
            <!-- TXT -->
            <div class="article__text_container" style="-webkit-box-orient: vertical;">
                  <!-- CAT -->
                                                                  <a class="article__category_link" href="https://securityintelligence.com/category/topics/data-protection/" aria-label="https://securityintelligence.com/category/topics/data-protection/">
                              Data Protection  
                        </a>

                                    <!-- DATE  -->
                  <span class="article__date">
                        October 17, 2024                  </span>
                  <!-- TITLE & EXCERPT -->
                  <a href="https://securityintelligence.com/articles/cybersecurity-skills-gap-contributed-increase-average-breach-costs/" class="article__content_link" aria-label="The cybersecurity skills gap contributed to a $1.76 million increase in average breach costs">
                        <h2 class="article__title">The cybersecurity skills gap contributed to a $1.76 million increase in average breach costs</h2>
                        <p class="article__excerpt" style="-webkit-box-orient: vertical;">
                              <span class="article__read_time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 4</span> <span class="rt-label rt-postfix">min read</span></span> - </span>Understaffing in cybersecurity &mdash; the &ldquo;skills gap&rdquo; &mdash; is driving up the cost of data breaches in recent years, according to a decade of reports by IBM. The 2024 IBM Data Breach Report found that more than half of breached&hellip;                        </p>
                  </a>
            </div>
      </article>

      <article class="article article_grid article__mobile--card">
            <!-- IMG -->
            <a class="exclusive_article__category_link" href="https://securityintelligence.com/articles/whats-behind-51-drop-in-ransomware-attacks/" aria-label="What&#8217;s behind the 51% drop in ransomware attacks?">
                  <div class="article__img">                <amp-img alt="Malware Detected Warning Screen with abstract binary code 3d digital concept" width="1200" height="630" layout="responsive" src="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/Abstract-Warning-of-a-detected-Ransomware-concept-630x330.jpeg.webp">
                    <amp-img fallback alt="Malware Detected Warning Screen with abstract binary code 3d digital concept" width="1200" height="630" layout="responsive" src="https://securityintelligence.com/wp-content/uploads/2024/10/Abstract-Warning-of-a-detected-Ransomware-concept-630x330.jpeg">
                    </amp-img>
                </amp-img>
            </div>
            </a>
            <!-- TXT -->
            <div class="article__text_container" style="-webkit-box-orient: vertical;">
                  <!-- CAT -->
                                                                  <a class="article__category_link" href="https://securityintelligence.com/category/topics/data-protection/" aria-label="https://securityintelligence.com/category/topics/data-protection/">
                              Data Protection  
                        </a>

                                    <!-- DATE  -->
                  <span class="article__date">
                        October 18, 2024                  </span>
                  <!-- TITLE & EXCERPT -->
                  <a href="https://securityintelligence.com/articles/whats-behind-51-drop-in-ransomware-attacks/" class="article__content_link" aria-label="What&#8217;s behind the 51% drop in ransomware attacks?">
                        <h2 class="article__title">What&#8217;s behind the 51% drop in ransomware attacks?</h2>
                        <p class="article__excerpt" style="-webkit-box-orient: vertical;">
                              <span class="article__read_time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 4</span> <span class="rt-label rt-postfix">min read</span></span> - </span>In a world where cyber threats feel omnipresent, a recent report has revealed some unexpected good news: ransomware attacks on state and local governments have dropped by 51% in 2024. Still, this decline does not signal the end of the&hellip;                        </p>
                  </a>
            </div>
      </article>

      <article class="article article_grid article__mobile--card">
            <!-- IMG -->
            <a class="exclusive_article__category_link" href="https://securityintelligence.com/articles/how-governance-risk-compliance-addresses-growing-liability-concerns/" aria-label="How governance, risk and compliance (GRC) addresses growing data liability concerns">
                  <div class="article__img">                <amp-img alt="A man sitting in the dark working on a computer lighting him up & reflecting on his glasses" width="1200" height="630" layout="responsive" src="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/Data-Governance-630x330.jpeg.webp">
                    <amp-img fallback alt="A man sitting in the dark working on a computer lighting him up & reflecting on his glasses" width="1200" height="630" layout="responsive" src="https://securityintelligence.com/wp-content/uploads/2024/10/Data-Governance-630x330.jpeg">
                    </amp-img>
                </amp-img>
            </div>
            </a>
            <!-- TXT -->
            <div class="article__text_container" style="-webkit-box-orient: vertical;">
                  <!-- CAT -->
                                                                  <a class="article__category_link" href="https://securityintelligence.com/category/topics/data-protection/" aria-label="https://securityintelligence.com/category/topics/data-protection/">
                              Data Protection  
                        </a>

                                    <!-- DATE  -->
                  <span class="article__date">
                        October 11, 2024                  </span>
                  <!-- TITLE & EXCERPT -->
                  <a href="https://securityintelligence.com/articles/how-governance-risk-compliance-addresses-growing-liability-concerns/" class="article__content_link" aria-label="How governance, risk and compliance (GRC) addresses growing data liability concerns">
                        <h2 class="article__title">How governance, risk and compliance (GRC) addresses growing data liability concerns</h2>
                        <p class="article__excerpt" style="-webkit-box-orient: vertical;">
                              <span class="article__read_time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 4</span> <span class="rt-label rt-postfix">min read</span></span> - </span>In an era where businesses increasingly rely on artificial intelligence (AI) and advanced data capabilities, the effectiveness of IT services is more critical than ever. Yet despite the advancements in technology, business leaders are increasingly dissatisfied with their IT departments.&hellip;                        </p>
                  </a>
            </div>
      </article>

      <!-- ADVERTISEMENT -->
                  <div class="billboard_wrapper">
                  <a href="https://www.ibm.com/reports/data-breach?utm_medium=OSocial&utm_source=Blog&utm_content=RSRWW&utm_id=si-blog-right-rail " aria-label="A SPONSORED flag ">
                        <amp-img layout='responsive' widht='300' height='250' src="https://securityintelligence.com/wp-content/uploads/2024/07/SIB_CODB_rightrail_banners2024-think_600x1200.png" alt="CODB right rail banner with red, blue, &amp; purple lines in a wide circular pattern">
                        </amp-img>
                  </a>
            </div>
      
</aside>
</div>
<script>
      const kaltura = document.querySelectorAll("[data-widget=\"videoplayer\"]")
      if (kaltura != null) {
            kaltura.forEach(function(item){
                  const kId = item.id + '--' + item.dataset.videoid;
                  document.getElementById(item.id).id = kId;
                  getKalturaVideo(item);
            })
      }
      
</script>

<div class="card_container_background ">
    <section class="container cards">
        <h3>More from Threat Intelligence</h3>
        <div class="cards__wrapper">
            
<article class="article article--card cards__article_grid ">
            <!-- IMG -->
            <a class="exclusive_article__category_link" href="https://securityintelligence.com/x-force/hive0147-serving-juicy-picanha-with-side-of-mekotio/">
                <div class="article__img">
                                    <amp-img alt="Closeup on a laptop screen displaying green code in a dimly red-lit room" width="1200" height="630" layout="responsive" src="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/10/Closeup-on-modern-female-with-laptop-writing-code-630x330.jpeg.webp">
                    <amp-img fallback alt="Closeup on a laptop screen displaying green code in a dimly red-lit room" width="1200" height="630" layout="responsive" src="https://securityintelligence.com/wp-content/uploads/2024/10/Closeup-on-modern-female-with-laptop-writing-code-630x330.jpeg">
                    </amp-img>
                </amp-img>
                            </div>
            </a>
            <!-- TXT -->
            <div class="article__text_container" style="-webkit-box-orient: vertical;">
                <!-- CAT AND DATE -->
                <div class="article__eyebrow">
                                        <span class="article__date">
                        October 16, 2024                    </span>
                </div>
                <!-- TITLE & EXCERPT -->
                <a href="https://securityintelligence.com/x-force/hive0147-serving-juicy-picanha-with-side-of-mekotio/" class="article__content_link">
                    <div class="article__direction">
                        <h2 class="article__title">
                            Hive0147 serving juicy Picanha with a side of Mekotio                        </h2>
                        <p class="article__excerpt" style="-webkit-box-orient: vertical;">
                            <span class="article__read_time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 17</span> <span class="rt-label rt-postfix">min read</span></span> - </span>IBM X-Force tracks multiple threat actors operating within the flourishing Latin American (LATAM) threat landscape. X-Force has observed Hive0147 to be one of the most active threat groups operating in the region, targeting employee inboxes at scale, with a primary focus on phishing and malware distribution. After a 3-month break, Hive0147 returned in July with even larger campaign volumes, and the debut of a new malicious downloader X-Force named "Picanha,” likely under continued development, deploying the Mekotio banking trojan. Hive0147&hellip;                        </p>
                    </div>
                </a>
            </div>
        </article>
      
<article class="article article--card cards__article_grid ">
            <!-- IMG -->
            <a class="exclusive_article__category_link" href="https://securityintelligence.com/news/fysa-critical-rce-flaw-in-gnu-linux-systems/">
                <div class="article__img">
                                    <amp-img alt="Closeup on a red computer screen displaying code covered by a large ALERT message" width="1200" height="630" layout="responsive" src="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/07/computer-security-630x330.jpeg.webp">
                    <amp-img fallback alt="Closeup on a red computer screen displaying code covered by a large ALERT message" width="1200" height="630" layout="responsive" src="https://securityintelligence.com/wp-content/uploads/2024/07/computer-security-630x330.jpeg">
                    </amp-img>
                </amp-img>
                            </div>
            </a>
            <!-- TXT -->
            <div class="article__text_container" style="-webkit-box-orient: vertical;">
                <!-- CAT AND DATE -->
                <div class="article__eyebrow">
                                        <span class="article__date">
                        September 26, 2024                    </span>
                </div>
                <!-- TITLE & EXCERPT -->
                <a href="https://securityintelligence.com/news/fysa-critical-rce-flaw-in-gnu-linux-systems/" class="article__content_link">
                    <div class="article__direction">
                        <h2 class="article__title">
                            FYSA &#8211; Critical RCE Flaw in GNU-Linux Systems                        </h2>
                        <p class="article__excerpt" style="-webkit-box-orient: vertical;">
                            <span class="article__read_time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 2</span> <span class="rt-label rt-postfix">min read</span></span> - </span>Summary The first of a series of blog posts has been published detailing a vulnerability in the Common Unix Printing System (CUPS), which purportedly allows attackers to gain remote access to UNIX-based systems. The vulnerability, which affects various UNIX-based operating systems, can be exploited by sending a specially crafted HTTP request to the CUPS service. Threat Topography Threat Type: Remote code execution vulnerability in CUPS service Industries Impacted: UNIX-based systems across various industries, including but not limited to, finance, healthcare,&hellip;                        </p>
                    </div>
                </a>
            </div>
        </article>
      
<article class="article article--card cards__article_grid ">
            <!-- IMG -->
            <a class="exclusive_article__category_link" href="https://securityintelligence.com/x-force/hive0137-on-ai-journey/">
                <div class="article__img">
                                    <amp-img alt="Closeup on a pair of silver metallic robot hands typing on a keyboard" width="1200" height="630" layout="responsive" src="/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2024/07/Ai-working-with-keyboard-630x330.jpeg.webp">
                    <amp-img fallback alt="Closeup on a pair of silver metallic robot hands typing on a keyboard" width="1200" height="630" layout="responsive" src="https://securityintelligence.com/wp-content/uploads/2024/07/Ai-working-with-keyboard-630x330.jpeg">
                    </amp-img>
                </amp-img>
                            </div>
            </a>
            <!-- TXT -->
            <div class="article__text_container" style="-webkit-box-orient: vertical;">
                <!-- CAT AND DATE -->
                <div class="article__eyebrow">
                                        <span class="article__date">
                        July 26, 2024                    </span>
                </div>
                <!-- TITLE & EXCERPT -->
                <a href="https://securityintelligence.com/x-force/hive0137-on-ai-journey/" class="article__content_link">
                    <div class="article__direction">
                        <h2 class="article__title">
                            Hive0137 and AI-supplemented malware distribution                        </h2>
                        <p class="article__excerpt" style="-webkit-box-orient: vertical;">
                            <span class="article__read_time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix">min read</span></span> - </span>IBM X-Force tracks dozens of threat actor groups. One group in particular, tracked by X-Force as Hive0137, has been a highly active malware distributor since at least October 2023. Nominated by X-Force as having the “Most Complex Infection Chain” in a campaign in 2023, Hive0137 campaigns deliver DarkGate, NetSupport, T34-Loader and Pikabot malware payloads, some of which are likely used for initial access in ransomware attacks. The crypters used in the infection chains also suggest a close relationship with former&hellip;                        </p>
                    </div>
                </a>
            </div>
        </article>
              </div>
    </section>
</div>
<!--SI Newsletters -->
<script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/version/v1.31.0-rc.0/cta-section.min.js"></script>
      <script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/tag/v1/latest/cta-section.min.js"></script>
      <script type="module" src="https://1.www.s81c.com/common/carbon-for-ibm-dotcom/tag/v1/next/cta-section.min.js"></script>
      <div style="background-color: #161616;">
      <dds-cta-section data-autoid="dds--cta-section" children-custom-class="" class="container SI_padding">
                  <dds-cta-block no-border="" data-autoid="dds--cta-block">
                        <dds-content-block-heading class="copy" role="heading" aria-level="2" data-autoid="dds--content-block__heading" slot="heading">
                        <h2 >Topic updates</h2>
                        </dds-content-block-heading>
                        
                              <dds-content-block-copy data-autoid="dds--content-block__copy" size="md" slot="copy">
                                    <dds-content-block-paragraph data-autoid="dds--content-block-paragraph" class="copy">
                                    Get email updates and stay ahead of the latest threats to the security landscape, thought leadership and research.
                                    </dds-content-block-paragraph>
                                    <div role="list" class="list_newletter">
                                          <dds-button-cta data-autoid="dds-cta" cta-style="button" class="copy" cta-type="local" href="https://www.ibm.com/account/reg/us-en/signup?formid=news-urx-51966" kind="primary" icon-layout="" size="">
                                                Subscribe today
                                          </dds-button-cta>
                                    </div>
                              </dds-content-block-copy>    
                  </dds-cta-block>
            </dds-cta-section>
      </div>
            
      <dds-footer-container></dds-footer-container>
      <script>
            
            document.addEventListener('DOMContentLoaded', () => {
            const boxstyle = document.querySelector('.button2');
            const removePadding = document.querySelector('dds-cta-section');
            
            if (boxstyle) {
                  const shadowRoot = boxstyle.shadowRoot;
                  const bxContentSsectionDOM = shadowRoot.querySelector('.bx--btn');
			 if (bxContentSsectionDOM) {
                        bxContentSsectionDOM.style.color = 'white'; 
                        bxContentSsectionDOM.style.borderColor = 'white'; 
                        bxContentSsectionDOM.addEventListener('mouseover', () => {
                        bxContentSsectionDOM.style.color = 'white';
                        bxContentSsectionDOM.style.borderColor = 'white';
                        bxContentSsectionDOM.style.backgroundColor = 'rgba(141, 141, 141, 0.16)'; //
                        
                        });

                        // when mouse leave the element
                        bxContentSsectionDOM.addEventListener('mouseout', () => {
                        bxContentSsectionDOM.style.color = 'white';
                        bxContentSsectionDOM.style.borderColor = 'white';
                        bxContentSsectionDOM.style.backgroundColor = 'transparent'; // Reset background color
                        });
		      }
            
            }
            if(removePadding){
                  const shadowRoot = removePadding.shadowRoot;
                  const removespace = shadowRoot.querySelector('.bx--content-section__leading');
                  if(removespace){
                        removespace.style.display = 'none';
                  }
            }
            });

            document.querySelector("dds-footer-container").size = 'default';

            //Uncomment this to add a custom links.
            // document.querySelector("dds-footer-container").adjunctLinks = [{
            //             'title': 'IBM Custom Link',
            //             'link': 'https://ibm.com'
            //       },
            //       {
            //             'title': 'IBM Custom Link2',
            //             'link': 'https://ibm.com'
            //       }
            // ];
      </script>
<!--SI close Newsletters-->

      <div style="background-color: #13171a;">
            <div class="container">

                  <!-- FOOTER -->
                  <section id="footer" class="footer">
                        <!-- LOGO -->
                        <div class="footer__logo">
                              <amp-img width="280" height="31" layout="responsive" src="https://securityintelligence.com/wp-content/themes/sapphire/images/logo-white.svg" alt="Security Intelligence"></amp-img>
                        </div>

                        <!-- COPY  -->
                        <div class="footer__copy"><p>Analysis and insights from hundreds of the brightest minds in the cybersecurity industry to help you prove compliance, grow business and stop threats.</p>
</div>

                        <!-- LINKS -->
                        <div class="footer__list">
                              <a href="/news/" class="footer__link">Cybersecurity News</a>
                              <a href="/category/topics/" class="footer__link">By Topic</a>
                              <a href="/category/industries/" class="footer__link">By Industry</a>
                              <a href="/series/" class="footer__link">Exclusive Series</a>
                              <a href="/x-force/" class="footer__link">X-Force</a>
                              <a href="/media/" class="footer__link">Podcast</a>
                              <a href="/events/" class="footer__link">Events</a>
                              <a href="/about-us/" class="footer__link">Contact</a>
                              <a href="/about-us/" class="footer__link">About Us</a>
                        </div>


                        <!-- SOCIAL NETWORKS -->
                        <div class="footer__social-networks">
                              <div class="headline">Follow us on social</div>

                              <a href="http://www.twitter.com/ibmsecurity" aria-label="Twitter" class="footer__icon" style="left:-4px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" fill="#FFFFFF">
                                          <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
                                    </svg>
                              </a>
                              <a href="http://www.linkedin.com/company/ibm-security" aria-label="LinkedIn" class="footer__icon" style="justify-self: center;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" fill="#FFFFFF">
                                          <path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z" />
                                    </svg>
                              </a>
                              <a href="https://www.youtube.com/@IBMTechnology" aria-label="YouTube" class="footer__icon" style="justify-self: end;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" fill="#FFFFFF">
                                          <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" />
                                    </svg>
                              </a>
                        </div>

                  </section>
            </div>
      </div>


      <div style="background-color:black">
            <div class="container">

                  <!-- UTILITIES BAR -->
                  <section class="utility_bar">

                        <!-- LINKS -->
                        <div class="utility_bar__links" aria-label="Footer Navigation">
                              <a href="http://www.ibm.com?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US" target="_blank" rel="noopener, noreferrer">© 2024 IBM</a>
                              <a href="https://www.ibm.com/contact/?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US" target="_blank" rel="noopener, noreferrer">Contact</a>
                              <a href="https://www.ibm.com/privacy/?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US" target="_blank" rel="noopener, noreferrer">Privacy</a>
                              <a href="https://www.ibm.com/legal/?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US&cm_mc_uid=03001744655915532865554&cm_mc_sid_50200000=84159441565120380187" target="_blank" rel="noopener, noreferrer">Terms of use</a>
                              <a href="https://www.ibm.com/accessibility/?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US" target="_blank" rel="noopener, noreferrer">Accessibility</a>
                              <a href="#" onclick="truste.eu.clickListener();return false;" target="_blank" rel="noopener, noreferrer">Cookie Preferences</a>
                        </div>

                        <!-- Sponsor credits -->
                        <div class="utility_bar__sponsor">
                              <a href="http://ibm.com/security?ce=ISM0484&amp;ct=SWG&amp;cmp=IBMSocial&amp;cm=h&amp;cr=Security&amp;ccy=US" target="_blank" data-icon="B" class="icon ibm" rel="noopener, noreferrer" style="padding-right:0px">
                                    <span>Sponsored by
                                          <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 31.97 14.06">
                                                <defs>
                                                      <style>
                                                            .cls-1 {
                                                                  fill: #fff;
                                                            }
                                                      </style>
                                                </defs>
                                                <title>si-icon-eightbarfeature</title>
                                                <path class="cls-1" d="M27.17,12.6h4.21v.84H27.17Zm0-1.68h4.21v.84H27.17Zm0-1.68h2.52v.84H27.17Zm0-1.69h2.52V8.4H27.17Zm0-1.68h2.52v.84H27.17Zm-.84-4.2.28-.85h4.77v.85Zm-.56,1.68.29-.84h5.32v.84ZM25.22,5l.28-.84h4.19V5Zm-.56,1.68L25,5.87h2.22l-.27.84Zm0,6.73-.28-.84H25Zm-.55-1.68-.29-.84H25.5l-.28.84Zm-.56-1.68-.27-.84H26l-.27.84ZM23,8.4l-.29-.85h3.9l-.28.85Zm-.57-1.69-.27-.84h2.22l.28.84Zm-2.8,2.53h2.53v.84H19.63Zm0-1.69h2.53V8.4H19.63Zm0-1.68h2.53v.84H19.63Zm0-.84V4.19h4.19l.29.84ZM18,12.6h4.21v.84H18Zm0-1.68h4.21v.84H18Zm0-7.57V2.51h5.32l.28.84Zm0-1.68V.82h4.76l.29.85ZM14.16,9.24H17a2.23,2.23,0,0,1,.07.37,2.49,2.49,0,0,1,0,.47H14.16Zm0-5h2.95a2.38,2.38,0,0,1,0,.46A2.18,2.18,0,0,1,17,5H14.16ZM9.11,9.24h2.52v.84H9.11Zm0-1.69H16a5,5,0,0,1,.4.4,2,2,0,0,1,.32.45H9.11Zm0-1.68h7.57a2,2,0,0,1-.32.45,4.89,4.89,0,0,1-.4.39H9.11Zm0-1.68h2.52V5H9.11ZM7.42,12.6H16a3.09,3.09,0,0,1-1,.62,3.73,3.73,0,0,1-1.32.22H7.42Zm0-1.68H17a2.47,2.47,0,0,1-.15.46,2.24,2.24,0,0,1-.21.38H7.42Zm0-8.41h9.22a1.91,1.91,0,0,1,.21.38,2.47,2.47,0,0,1,.15.46H7.42Zm0-1.69H13.6a3.73,3.73,0,0,1,1.32.23,3.09,3.09,0,0,1,1,.62H7.42Zm-5,8.42H4.9v.84H2.38Zm0-1.69H4.9V8.4H2.38Zm0-1.68H4.9v.84H2.38Zm0-1.68H4.9V5H2.38ZM.69,12.6H6.58v.84H.69Zm0-1.68H6.58v.84H.69Zm0-8.41H6.58v.84H.69ZM.69.82H6.58v.85H.69Z" />
                                          </svg>
                                    </span>
                              </a>
                        </div>
                  </section>

            </div>
      </div>


<script>
                  window._appInfo = window._appInfo || {};
            window._appInfo.newsCredAPIKey = "YXJ0aWNsZT1iMTc3MDIyNDg1NjgxMWVlODM1MzhlZWU4OWYyMDdlOA==";
      </script>


<!-- FOOTER SCRIPTS -->
<script type="text/javascript" id="qppr_frontend_scripts-js-extra">
/* <![CDATA[ */
var qpprFrontData = {"linkData":{"https:\/\/securityintelligence.com\/defining-security-intelligence\/":[0,0,"https:\/\/securityintelligence.com\/defintion-security-intelligence\/#.VS_NwpNnuZA"],"https:\/\/securityintelligence.com\/security-vulnerability-management-its-about-outcomes-not-activity\/":[0,0,""]},"siteURL":"https:\/\/securityintelligence.com","siteURLq":"https:\/\/securityintelligence.com"};
/* ]]> */
</script>
<script type="text/javascript" src="https://securityintelligence.com/wp-content/plugins/quick-pagepost-redirect-plugin/js/qppr_frontend_script.min.js?ver=5.2.4" id="qppr_frontend_scripts-js"></script>

<script>
      setTimeout(() => {
            document.querySelector(".related_content").style.visibility = 'visible';
            document.querySelector(".related_content.article.article_grid.article__mobile--card.article--IBM_blog > c4d-card > c4d-card-footer").shadowRoot.querySelector("#link").style.justifyContent = 'flex-start';
      }, 100);

</script>

</body>

</html>
