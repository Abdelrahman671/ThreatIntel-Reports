<!doctype html><html lang="en"><head><script type="application/javascript" id="hs-cookie-banner-scan" data-hs-allowed="true" src="/_hcms/cookie-banner/auto-blocking.js?portalId=8272645&amp;domain=www.huntandhackett.com"></script>
    <meta charset="utf-8">
    <title>Advanced IP Scanner: the preferred scanner in the A(P)T toolbox</title>
    <link rel="shortcut icon" href="https://www.huntandhackett.com/hubfs/HH_Icon.png">
    <meta name="description" content="This blogpost is about the forensic traces left by Advanced IP Scanner and how you can detect it in your network">
    
    
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Lato:regular|Playfair+Display:regular&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link href="https://fonts.googleapis.com/css?family=Lato:regular|Playfair+Display:regular&amp;display=swap" rel="stylesheet" type="text/css">
    </noscript>

    
		
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="This blogpost is about the forensic traces left by Advanced IP Scanner and how you can detect it in your network">
    <meta property="og:title" content="Advanced IP Scanner: the preferred scanner in the A(P)T toolbox">
    <meta name="twitter:description" content="This blogpost is about the forensic traces left by Advanced IP Scanner and how you can detect it in your network">
    <meta name="twitter:title" content="Advanced IP Scanner: the preferred scanner in the A(P)T toolbox">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.huntandhackett.com/hs-fs/hubfs/hub_generated/template_assets/1/33930362451/1742399583186/template_main.css">
<link rel="stylesheet" href="https://www.huntandhackett.com/hs-fs/hubfs/hub_generated/module_assets/1/33930691666/1742402465615/module_Atomic_-_Header.min.css">
<link class="hs-async-css" rel="preload" href="https://www.huntandhackett.com/hs-fs/hubfs/hub_generated/template_assets/1/33924883556/1742399579382/template__header_row_01_01.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.huntandhackett.com/hs-fs/hubfs/hub_generated/template_assets/1/33924883556/1742399579382/template__header_row_01_01.min.css"></noscript>

		<style>
			.atmc-header {
				
				  position: absolute;
				
			}
			.atmc-header.sticky {
				background-color: #FFFFFF;
			}
			.atmc-header-default {
				background-color: #FFFFFF;
			}
			@media (max-width: 991px) {
				.atmc-header {
					background-color: #FFFFFF;
				}
				.atmc-header-transparent {
					
					  position: absolute;
					
				}
			}
		</style>
	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick-theme.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hamburgers/1.1.3/hamburgers.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.0/animate.min.css">
<style>
  @font-face {
    font-family: "Lato";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Lato/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Lato/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Playfair Display";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Playfair_Display/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Playfair_Display/regular.woff") format("woff");
  }
</style>

    <script type="application/ld+json">
{
  "mainEntityOfPage" : {
    "@type" : "WebPage",
    "@id" : "https://www.huntandhackett.com/blog/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox"
  },
  "author" : {
    "name" : "Krijn de Mik",
    "url" : "https://www.huntandhackett.com/blog/author/krijn-de-mik",
    "@type" : "Person"
  },
  "headline" : "Advanced IP Scanner: the preferred scanner in the A(P)T toolbox",
  "datePublished" : "2021-10-22T08:23:58.000Z",
  "dateModified" : "2021-10-26T09:26:41.289Z",
  "publisher" : {
    "name" : "Hunt & Hackett",
    "logo" : {
      "url" : "https://f.hubspotusercontent40.net/hubfs/8272645/HH_Logo_OnWhite.svg",
      "@type" : "ImageObject"
    },
    "@type" : "Organization"
  },
  "@context" : "https://schema.org",
  "@type" : "BlogPosting",
  "image" : [ "https://f.hubspotusercontent40.net/hubfs/8272645/pexels-cottonbro-4543136.jpg" ]
}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/3.3.2/jquery-migrate.min.js"></script>

    
<!--  Added by GoogleAnalytics4 integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;


if (!window._hsGoogleConsentRunOnce) {
  window._hsGoogleConsentRunOnce = true;

  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'wait_for_update': waitForUpdateMillis
  });

  if (useGoogleConsentModeV2) {
    _hsp.push(['useGoogleConsentModeV2'])
  } else {
    _hsp.push(['addPrivacyConsentListener', function(consent){
      var hasAnalyticsConsent = consent && (consent.allowed || (consent.categories && consent.categories.analytics));
      var hasAdsConsent = consent && (consent.allowed || (consent.categories && consent.categories.advertisement));

      gtag('consent', 'update', {
        'ad_storage': hasAdsConsent ? 'granted' : 'denied',
        'analytics_storage': hasAnalyticsConsent ? 'granted' : 'denied',
        'ad_user_data': hasAdsConsent ? 'granted' : 'denied',
        'ad_personalization': hasAdsConsent ? 'granted' : 'denied'
      });
    }]);
  }
}

gtag('js', new Date());
gtag('set', 'developer_id.dZTQ1Zm', true);
gtag('config', 'G-LNLGEXPMWF');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LNLGEXPMWF"></script>

<!-- /Added by GoogleAnalytics4 integration -->


<!-- Hotjar Tracking Code for https://www.huntandhackett.com/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3872078,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<meta property="og:image" content="https://www.huntandhackett.com/hubfs/pexels-cottonbro-4543136.jpg">
<meta property="og:image:width" content="2560">
<meta property="og:image:height" content="1080">

<meta name="twitter:image" content="https://www.huntandhackett.com/hubfs/pexels-cottonbro-4543136.jpg">


<meta property="og:url" content="https://www.huntandhackett.com/blog/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox">
<meta name="twitter:card" content="summary_large_image">

<link rel="canonical" href="https://www.huntandhackett.com/blog/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox">
<meta name="twitter:card" content="summary_large_image">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism.min.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-core.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/autoloader/prism-autoloader.min.js"></script>
<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.huntandhackett.com/blog/rss.xml">
<meta name="twitter:domain" content="www.huntandhackett.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">






    
  <meta name="generator" content="HubSpot"></head>
	
	
	
	
  
	
		

		

		
			
		
	
	
	
	
	
	
		
  <body style="margin: 0; padding: 0;" class="atmc-body-header-transparent">
    
    <div class="body-wrapper   hs-content-id-57866858903 hs-blog-post hs-blog-id-33584457015">
		
			<div data-global-resource-path="Hunt and Hackett/templates/partials/header.html">

  
  







  

  
	<header class="atmc-header atmc-header_static atmc-header-transparent atmc-header-dark">
		<div class="atmc-header_container">		

			
			<div class="atmc-header_logo">
				
				<a href="https://www.huntandhackett.com" class="atmc-header_logo_white">
					
					  
					  
					  <img src="https://www.huntandhackett.com/hubfs/HH_Logo_OnDark.svg" alt="Logo Hunt &amp; Hackett" width="200" height="64">
					
				</a>
				
				<a href="https://www.huntandhackett.com" class="atmc-header_logo_dark">
					
					  
					
					  <img src="https://www.huntandhackett.com/hubfs/HH_Logo_OnWhite.svg" alt="Logo Hunt &amp; Hackett" width="150" height="48">
					
				</a>
			</div>

			
			
			<div class="atmc-header_menu-wrapper">
				<div class="atmc-header_navigation">
					<div class="atmc-header_menu">
						<div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="default" data-menu-id="33889628180" aria-label="Navigation Menu">
 <ul role="menu" class="active-branch">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.huntandhackett.com/services" aria-haspopup="true" aria-expanded="false" role="menuitem">SERVICES</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/mdr" role="menuitem">Managed Detection &amp; Response (MDR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/bas" role="menuitem">Breach &amp; Attack Simulation (BAS)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/th" role="menuitem">Threat Hunting (TH)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/ir" role="menuitem">Incident Response (IR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/spga" role="menuitem">Security Program Gap Assessment (SPGA)</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.huntandhackett.com/threats" aria-haspopup="true" aria-expanded="false" role="menuitem">THREATS</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:;" role="menuitem">Sector-based threat landscape</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/agriculture" role="menuitem">Agriculture</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/energy" role="menuitem">Energy</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/maritime" role="menuitem">Maritime</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/manufacturing" role="menuitem">Manufacturing</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/technology" role="menuitem">Technology</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/logistics" role="menuitem">Logistics</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/governments" role="menuitem">Governments</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:;" role="menuitem">Country threat profiles</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/russia" role="menuitem">Russian Federation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/china" role="menuitem">China</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/iran" role="menuitem">Iran</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/north-korea" role="menuitem">North Korea</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/united-states" role="menuitem">United States</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/israel" role="menuitem">Israel</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:;" role="menuitem">Threat actor profiles</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt28" role="menuitem">Fancy Bear/APT28</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt29" role="menuitem">Cozy Bear/APT29</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt34" role="menuitem">OilRig/APT34</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/charming-kitten" role="menuitem">Charming Kitten/APT35</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt38" role="menuitem">Lazarus/APT38</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt41" role="menuitem">Double Dragon/APT4</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/sandworm" role="menuitem">Sandworm</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/seaturtle" role="menuitem">Seaturtle</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/silent-librarian" role="menuitem">Silent Librarian</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children active-branch" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">RESOURCES</a>
   <ul role="menu" class="hs-menu-children-wrapper active-branch">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/members" role="menuitem">Member portal</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/downloads" role="menuitem">Downloads</a></li>
    <li class="hs-menu-item hs-menu-depth-2 active active-branch" role="none"><a href="https://www.huntandhackett.com/blog" role="menuitem">Blogs</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/cyberconnect" role="menuitem">CyberConnect Roundtables</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/events" role="menuitem">Events</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/about-us" role="menuitem">ABOUT US</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/contact" role="menuitem">CONTACT</a></li>
 </ul>
</div>
					</div>
				</div>
			</div>
			

			
			<div class="atmc-header_right">
				<div class="atmc-header_language-switcher-wrapper h-full"></div>
				
				  
				
			</div>
			
			
			
				<div class="atmc-mega-menu">
					
						<div class="atmc-mega-menu_box atmc-mega-menu_box-col atmc-bg-gray700" data-target="0">
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:void(0);" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Managed Services:</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/mdr" role="menuitem" target="_self">Managed Detection &amp; Response (MDR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/bas" role="menuitem" target="_self">Breach &amp; Attack Simulation (BAS)</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:void(0);" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Professional Services:</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/th" role="menuitem" target="_self">Threat Hunting (TH)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/ir" role="menuitem" target="_self">Incident Response (IR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/spga" role="menuitem" target="_self">Security Program Gap Assessment (SPGA)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:void(0);" role="menuitem" target="_self">&nbsp;</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
							
								<a href="https://www.huntandhackett.com/services" class="atmc-mega-menu_image" style="background-image:url('https://www.huntandhackett.com/hubfs/pexels-johannes-plenio-1133499.webp');">
									<p class="atmc-btn atmc-btn-outline-white">Our Approach</p>
								</a>
							
						</div>
					
						<div class="atmc-mega-menu_box atmc-mega-menu_box-col atmc-bg-gray700" data-target="1">
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Sector-based threat landscape</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/agriculture" role="menuitem" target="_self">Agriculture</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/energy" role="menuitem" target="_self">Energy</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/maritime" role="menuitem" target="_self">Maritime</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/manufacturing" role="menuitem" target="_self">Manufacturing</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/technology" role="menuitem" target="_self">Technology</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/logistics" role="menuitem" target="_self">Logistics</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/governments" role="menuitem" target="_self">Governments</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Country threat profiles</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/russia" role="menuitem" target="_self">Russian Federation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/china" role="menuitem" target="_self">China</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/north-korea" role="menuitem" target="_self">North Korea</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/iran" role="menuitem" target="_self">Iran</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/united-states" role="menuitem" target="_self">United States</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/israel" role="menuitem" target="_self">Israel</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Threat actor profiles</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt28" role="menuitem" target="_self">Fancy Bear/APT28</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt29" role="menuitem" target="_self">Cozy Bear/APT29</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt34" role="menuitem" target="_self">OilRig/APT34</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/charming-kitten" role="menuitem" target="_self">Charming Kitten/APT35</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt38" role="menuitem" target="_self">Lazarus/APT38</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt41" role="menuitem" target="_self">Double Dragon/APT41</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/sandworm" role="menuitem" target="_self">Sandworm</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/seaturtle" role="menuitem" target="_self">Seaturtle</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/silent-librarian" role="menuitem" target="_self">Silent Librarian</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
							
						</div>
					
						<div class="atmc-mega-menu_box atmc-mega-menu_box-col atmc-bg-gray700" data-target="2">
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Resources</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/members" role="menuitem" target="_self">Member Portal</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/downloads" role="menuitem" target="_self">Downloads</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/blog" role="menuitem" target="_self">Blogs</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/cyberconnect" role="menuitem" target="_self">CyberConnect Roundtables</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/events" role="menuitem" target="_self">Events</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
							
								<a href="https://www.huntandhackett.com/definitive-guide-to-ransomware" class="atmc-mega-menu_image" style="background-image:url('https://www.huntandhackett.com/hubfs/CCS%235%20Header%20Ransomware.jpg');">
									<p class="atmc-btn atmc-btn-outline-white">Definitive Guide to Ransomware</p>
								</a>
							
						</div>
					
				</div>
			

		</div>
	</header>

  
  










  
	
	<div class="atmc-header-hidden hidden">
		
	</div>

	

</div>
			
			

      
<div class="atmc-blog-template-01">
  
  <!-- Hero with Post Image-->
  <div class="atmc-container atmc-container atmc-blog-hero atmc-blog-post_image" style="background-image: url('https://www.huntandhackett.com/hubfs/pexels-cottonbro-4543136.jpg')"></div>
  <div class="atmc-divider-01-header">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1920 80"><path fill="#fcaf15" fill-opacity="1" d="M-10,0C960,60,1930,20,1930,20V60S960,20,-10,80Z"></path></svg>
	</div>

	<div class="dnd-section">
    
		<div class="atmc-container atmc-container-m">
			
      <!-- Post Header -->
			<div class="mb-12">
				<h1 class="atmc-headline-03"><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Advanced IP Scanner: the preferred scanner in the A(P)T toolbox</span></h1>

				<div class="atmc-blog-post_meta atmc-cap-07 mb-12">
					
						<a href="https://www.huntandhackett.com/blog/author/krijn-de-mik">
							Krijn de Mik
						</a> @&nbsp; 
					
					<div class="atmc-blog-post_timestamp">
						Oct 22, 2021 10:23:58 AM
					</div>
				</div>
        <div class="atmc-blog-post_intro atmc-intro mb-20">
					
				</div>
			</div>
    </div>
   
			
		<div class="atmc-container atmc-container-m">
      <!-- Post Body -->
			<div class="atmc-blog-post">
			  <div id="" class="atmc-social-links-01 text-left blog-share ">
	
	<div class="inline-flex items-center ds:flex-row">
		
		
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://www.facebook.com/sharer/sharer.php?u=https://www.huntandhackett.com/blog/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 264 512" aria-hidden="true"><g id="facebook-f1_layer"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229" /></g></svg>
					</a>
				</div>
			
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://twitter.com/intent/tweet?url=&amp;text=https://www.huntandhackett.com/blog/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" aria-hidden="true"><g id="twitter2_layer"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" /></g></svg>
					</a>
				</div>
			
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://pinterest.com/pin/create/button/?url=https://www.huntandhackett.com/blog/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 496 512" aria-hidden="true"><g id="pinterest3_layer"><path d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z" /></g></svg>
					</a>
				</div>
			
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.huntandhackett.com/blog/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512" aria-hidden="true"><g id="linkedin-in4_layer"><path d="M100.3 480H7.4V180.9h92.9V480zM53.8 140.1C24.1 140.1 0 115.5 0 85.8 0 56.1 24.1 32 53.8 32c29.7 0 53.8 24.1 53.8 53.8 0 29.7-24.1 54.3-53.8 54.3zM448 480h-92.7V334.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V480h-92.8V180.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V480z" /></g></svg>
					</a>
				</div>
			
		
		
	</div>
	
</div>
				<div class="atmc-blog-post_body mt-8">
					<span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><h2 style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 40px;"><span>1. Introduction</span></h2>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span><br>Hunt &amp; Hackett has been working on a wide variety of targeted ransomware cases. During these targeted ransomware cases, ‘Advanced IP Scanner’ (AIS)<a href="#sources" rel="noopener"><sup>1</sup></a> was regularly used as reconnaissance tool for Active Scanning (<a href="https://attack.mitre.org/techniques/T1595/">T1595</a>) and Network Service Scanning (<a href="https://attack.mitre.org/techniques/T1046/">T1046</a>). This has not only been observed by Hunt &amp; Hackett, but also by other incident response parties</span><span>. </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><!--more--></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;">&nbsp;</p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span>Groups that have (had) used Advanced IP Scanner include: </span></p>
<ul>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>Conti<a href="#sources" rel="noopener"><sup>2</sup></a></span></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>Darkside/UNC2465<a href="#sources" rel="noopener"><sup>3</sup></a></span></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>Egregor<a href="#sources" rel="noopener"><sup>4</sup></a></span></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>Hades/ Evilcorp<a href="#sources" rel="noopener"><sup>5</sup></a></span></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>REvil<a href="#sources" rel="noopener"><sup>6</sup></a></span></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>Ryuk/ UNC1878<a href="#sources" rel="noopener"><sup>7</sup></a></span></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>UNC2447<a href="#sources" rel="noopener"><sup>7</sup></a></span></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;">UNC Iranian actor<a href="#sources" rel="noopener"><sup>8</sup></a></li>
<li style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm;"><span>Dharma<a href="#sources" rel="noopener"><sup>9</sup></a></span></li>
</ul>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span>This small write-up focuses on some of the forensic traces left by AIS that Hunt &amp; Hackett observed during Incident Response cases. The artefacts might be useful during an investigation, and can shine some (minor) light on threat actors’ activities. Furthermore, this blogpost provides some pointers related to detecting Advanced IP Scanner. </span><span><br></span></p>
<h2 style="padding-left: 0cm;"><span>2. Advanced IP Scanner</span></h2>
<p><span>Advanced IP Scanner (AIS) is freely available online<a href="#sources" rel="noopener"><sup>1</sup></a> and can be executed as an installer and as a portable version. Both have been used by threat actors. After the installation / execution of AIS, the end user is presented with an overview as </span><span>shown in </span><em><span>Figure 1</span></em><span>. </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span>&nbsp;<img loading="lazy" src="https://www.huntandhackett.com/hs-fs/hubfs/Picture%201.png?width=644&amp;name=Picture%201.png" alt="Picture 1" width="644" style="width: 644px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.huntandhackett.com/hs-fs/hubfs/Picture%201.png?width=322&amp;name=Picture%201.png 322w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%201.png?width=644&amp;name=Picture%201.png 644w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%201.png?width=966&amp;name=Picture%201.png 966w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%201.png?width=1288&amp;name=Picture%201.png 1288w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%201.png?width=1610&amp;name=Picture%201.png 1610w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%201.png?width=1932&amp;name=Picture%201.png 1932w" sizes="(max-width: 644px) 100vw, 644px"></span></p>
<p style="text-align: center;"><span style="color: #ff9902;"><span style="font-weight: bold;"><em>Figure </em><em>1</em></span> - GUI of Advanced IP Scanner.</span></p>
<p>&nbsp;</p>
<p><span>AIS is a simple and user-friendly IP scanner, which provides the end user with a concise overview of the systems found in the network. From a high-level perspective, AIS provides the user with the following functionality:</span></p>
<ol>
<li><u><span>IP scanning</span></u><span>: scan the given range for systems that are alive, or dead;</span></li>
<li><u><span>Tools</span></u><span>: provide functionality to ping an IP, perform a Tracert, or connect with Telnet / SSH;</span></li>
<li><u><span>Remote connections</span></u><span>: connect to the corresponding IP address via HTTP, HTTPS, FTP, RDP, or RADMIN (only works if RADMIN is installed).</span></li>
<li><u><span>(Re)boot/ Wake-On-Lan</span></u><span>: the user can boot / reboot a system if the user is authorized to do so, or can send Wake-On-Lan (WOL) packages to a system. If enabled, this provides the user with functionality to remotely boot a system. </span></li>
</ol>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span>The fact that there is a portable version of Advanced IP Scanner, that it has a GUI and that the tool supports a variety of ways to interact with identified systems probably contributes to it popularity. </span></p>
<h2 style="padding-left: 0cm;"><span>3. Forensic traces</span></h2>
<p><span>AIS leaves traces on a host system when it is executed. This section describes the traces that are created during usage of the AIS tool and more specifically, the Windows registry keys that are being created. Do note that for both the portable version as well as the installer version, the same traces are created in the Windows registry. </span></p>
<h3>3.1 AIS registry keys</h3>
<p><span>After the installation of AIS, keys and subkeys are created in the </span><code>HKEY_USERS</code><span> hive of the user under which account AIS was installed. Data </span><span></span><span>is more specifically stored at the following location:</span></p>
<p><code>Computer\HKEY_USERS\&lt;SID&gt;\SOFTWARE\famatech\advanced_ip_scanner</code></p>
<p><span>The mentioned registry keys are created, by both the installer version of AIS and the portable version, after the first usage of the application and subsequently some (sub)keys are updated after using AIS. While looking at it graphically, multiple keys and subkeys are created as shown in </span><em>Figure 2</em><span>. The most relevant traces from a forensic perspective are either stored under the ‘</span><code>advanced_ip_scanner</code><span>’, or the ‘</span><code>State</code><span>’ key. </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span><img loading="lazy" src="https://www.huntandhackett.com/hs-fs/hubfs/Picture%202.png?width=274&amp;name=Picture%202.png" alt="Picture 2" width="274" style="width: 274px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.huntandhackett.com/hs-fs/hubfs/Picture%202.png?width=137&amp;name=Picture%202.png 137w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%202.png?width=274&amp;name=Picture%202.png 274w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%202.png?width=411&amp;name=Picture%202.png 411w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%202.png?width=548&amp;name=Picture%202.png 548w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%202.png?width=685&amp;name=Picture%202.png 685w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%202.png?width=822&amp;name=Picture%202.png 822w" sizes="(max-width: 274px) 100vw, 274px"></span></p>
<p style="font-weight: normal; text-align: center;"><span style="color: #ff9902;"><em><span style="font-weight: bold;">Figure 2</span> – Overview of keys created with regards to AIS.</em></span></p>
<h3>3.2 The ‘advanced_ip_scanner’ keys and subkeys</h3>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span>If we look at the subkeys of the </span><code>advanced_ip_scanner</code><span> key, we are presented with the keys as shown in <em>T</em></span><em>able 2</em><span>. This table shows the name and type of the subkeys, together with the value (data) of the subkey, a comment with what the subkey represents and what the function is within AIS. Especially the </span><span><code>locale</code> </span><span>subkey might be of relevance, since this could potentially reveal something about the background of the threat actor, as well as the </span><code>locale_timestamp</code><span>&nbsp;key since this gives an indication of when the application has been used for the first time.</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;">&nbsp;</p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%;">
<table style="width: 100%; border-collapse: collapse; border: 1px solid #eff1f4; height: 627px;">
<tbody>
<tr style="height: 75px;">
<td style="border: 1px solid #EFF1F4; width: 20%; height: 75px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Name</strong></span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 10%; height: 75px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Type</strong></span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 17%; height: 75px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Data</strong></span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 53%; height: 75px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Comment</strong></span></div>
</td>
</tr>
<tr style="height: 74px;">
<td style="border: 1px solid #EFF1F4; width: 20%; height: 74px; padding: 8px;">
<div><code><span style="font-size: 18px;">locale</span></code></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 10%; height: 74px; padding: 8px;">
<div><span style="font-size: 18px;">REG_SZ</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 17%; height: 74px; padding: 8px;">
<div><span style="font-size: 18px;">en_us</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 53%; height: 74px; padding: 8px;">
<div><span style="font-size: 18px;">Concerns the language settings of AIS as set by the user.</span></div>
</td>
</tr>
<tr style="height: 164px;">
<td style="border: 1px solid #EFF1F4; width: 20%; height: 164px; padding: 8px;">
<div><code><span style="font-size: 18px;">locale_timestamp</span></code></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 10%; height: 164px; padding: 8px;">
<div><span style="font-size: 18px;">REG_SZ</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 17%; height: 164px; padding: 8px;">
<div><span style="font-size: 18px;">1629953831432</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 53%; height: 164px; padding: 8px;">
<div><span style="font-size: 18px;">The first time the application has been started in epoch time, which translates to UTC +0. After starting the application for the first time, Hunt &amp; Hackett hasn’t observed any updates to this value in subsequent restarts of the application.</span></div>
</td>
</tr>
<tr style="height: 104px;">
<td style="border: 1px solid #EFF1F4; width: 20%; height: 104px; padding: 8px;">
<div><code><span style="font-size: 18px;">show_alive</span></code></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 10%; height: 104px; padding: 8px;">
<div><span style="font-size: 18px;">REG_SZ</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 17%; height: 104px; padding: 8px;">
<div><span style="font-size: 18px;">true</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 53%; height: 104px; padding: 8px;">
<div><span style="font-size: 18px;">Indicates whether found hosts, which are probably reachable, with the status ‘alive’ should be represented in the GUI. This is an option in the ‘View’ menu.</span></div>
</td>
</tr>
<tr style="height: 104px;">
<td style="border: 1px solid #EFF1F4; width: 20%; height: 104px; padding: 8px;">
<div><code><span style="font-size: 18px;">show_dead</span></code></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 10%; height: 104px; padding: 8px;">
<div><span style="font-size: 18px;">REG_SZ</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 17%; height: 104px; padding: 8px;">
<div><span style="font-size: 18px;">true</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 53%; height: 104px; padding: 8px;">
<div><span style="font-size: 18px;">Indicates whether found hosts, which aren’t reachable, with the status ‘alive’ should be represented in the GUI. This is an option in the ‘View’ menu.</span></div>
</td>
</tr>
<tr style="height: 105px;">
<td style="border: 1px solid #EFF1F4; width: 20%; height: 105px; padding: 8px;">
<div><code><span style="font-size: 18px;">show_unknown</span></code></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 10%; height: 105px; padding: 8px;">
<div><span style="font-size: 18px;">REG_SZ</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 17%; height: 105px; padding: 8px;">
<div><span style="font-size: 18px;">false</span></div>
</td>
<td style="border: 1px solid #EFF1F4; width: 53%; height: 105px; padding: 8px;">
<div><span style="font-size: 18px;">Indicates whether found hosts with the status ‘unknown’ should be represented in the GUI. This is an option in the ‘View’ menu.</span></div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="font-weight: normal; text-align: center;"><span style="color: #fcaf15;"><em><span style="font-weight: bold;">Table 2</span>: Overview of the AIS registry key ‘advanced_ip_scanner’ under HKEY_USERS hive.</em></span></p>
<h3>3.3 The ‘advanced_ip_scanner\State’ keys and subkeys</h3>
<p style="font-weight: normal;"><span>A variety of subkeys are listed under the key </span><code>advanced_ip_scanner/State</code><span>, as shown in </span><em>Table 3</em><span>. This table shows the name of subkeys together with the type of subkeys, the value (data) of the subkey, a comment with what the subkey represents and what the function is within AIS. All the keys, except for </span><code>LastRangeUsed</code><span>&nbsp;are created upon the first time the application is started. The key </span><code>LastRangeUsed</code><span>&nbsp;is created upon the first time a scan is performed with AIS. </span></p>
<p><span>The three registry keys </span><code>IpRangesMruList</code><span>, </span><code>LastRangeUsed</code><span> and </span><code>SearchMruList</code><span> under the key </span><code>advanced_ip_scanner\State</code><span> are especially interesting, as they could be of relevance during an IR assignment. </span></p>
<ul>
<li><code>LastRangeUsed</code><span>: this key represents the last scan that is being performed and shows the range that has been scanned. </span></li>
<li><code>IpRangesMruList</code><span>: this key represents all ranges scanned by AIS, including the frequency. Every range scanned has a prefix of </span><code>[digit]-[digit]</code><span>, followed by </span><code>[start IP address]-[IP range]</code><span>. The first digit of the prefix represents the number of times a range has been scanned, which will be increased after every subsequent scan. The range </span><code>192.168.227.1-254</code><span>&nbsp;in </span><em>Table 3</em><span> has for example been scanned five times. It’s unknown what the second digit represents, since this digit remained ‘static’ throughout the different tests performed. The scanned IP-range is stored in memory while the application is still running. Upon closure of the application, the data is written from a buffer in memory to the registry. The order in which the scanned IP ranges are stored is unknown.</span></li>
<li><code>SearchMruList</code><span>: This key contains an overview of all IP-addresses searched for by the user. These are added upon closure of the AIS application. Besides the last searched IP address, also other historical searches are saved here. Do note that a similar prefix is added to IP address, just like for the key </span><code>IpRangesMruList</code><span>. However, it’s unknown what this prefix represents. </span></li>
</ul>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;">&nbsp;</p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="border-collapse: collapse; width: 100%; border: 1px solid #eff1f4; height: 1147px;">
<tbody>
<tr style="height: 47px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; height: 47px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Name</strong></span></div>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; height: 47px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Type</strong></span></div>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; height: 47px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Data</strong></span></div>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; height: 47px; padding: 8px; background-color: #eff1f4;">
<div><span style="color: #4866a0; font-size: 18px;"><strong>Comment</strong></span></div>
</td>
</tr>
<tr style="height: 481px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; padding: 8px; height: 481px;" width="196">
<p style="font-weight: bold;"><code>IpRangesMruList</code></p>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; padding: 8px; height: 481px;" width="115">
<p style="font-weight: bold;">REG_SZ</p>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; padding: 8px; height: 481px;" width="185">
<p style="font-weight: bold;">5-1<br>192.168.227.1-254</p>
<p style="font-weight: bold;">2-1<br>192.168.250.1-254</p>
<p style="font-weight: bold;">1-1<br>192.168.116.1-254</p>
<p style="font-weight: bold;">1-1<br>192.168.228.1-254</p>
<p style="font-weight: bold;">1-1<br>192.168.240.1-254</p>
<p style="font-weight: bold;">1-1<br>192.168.230.1-254</p>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; padding: 8px; height: 481px;" width="97">
<p style="font-weight: bold;">All ranges scanned by the tool are stored in this subkey. Additionally, the first digit of the prefix indicates how frequent the range has been scanned.</p>
</td>
</tr>
<tr style="height: 113px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; padding: 8px; height: 113px;" width="196">
<p style="font-weight: bold;"><code>LastActiveTab</code></p>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; padding: 8px; height: 113px;" width="115">
<p><span>REG_DWORD</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; padding: 8px; height: 113px;" width="185">
<p><span>0x00000000 (0)</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; padding: 8px; height: 113px;" width="97">
<p><span>The tab (either ‘results’ or ‘favorites’) that was active upon closure of AIS process.</span></p>
</td>
</tr>
<tr style="height: 83px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; padding: 8px; height: 83px;" width="196">
<p style="font-weight: bold;"><code>LastRangeUsed</code></p>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; padding: 8px; height: 83px;" width="115">
<p><span>REG_SZ</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; padding: 8px; height: 83px;" width="185">
<p><span>192.168.226.1-254</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; padding: 8px; height: 83px;" width="97">
<p><span>This key is created after executing the first scan. </span></p>
</td>
</tr>
<tr style="height: 83px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; padding: 8px; height: 83px;" width="196">
<p style="font-weight: bold;"><code>lock_toolbars</code></p>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; padding: 8px; height: 83px;" width="115">
<p><span>REG_SZ</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; padding: 8px; height: 83px;" width="185">
<p><span>true</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; padding: 8px; height: 83px;" width="97">
<p><span>A menu item that could be selected to lock the toolbars</span></p>
</td>
</tr>
<tr style="height: 83px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; padding: 8px; height: 83px;" width="196">
<p style="font-weight: bold;"><code>results_col_size_init</code></p>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; padding: 8px; height: 83px;" width="115">
<p><span>REG_SZ</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; padding: 8px; height: 83px;" width="185">
<p><span>true</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; padding: 8px; height: 83px;" width="97">
<p><span>Unknown what this key represents.</span></p>
</td>
</tr>
<tr style="height: 143px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; padding: 8px; height: 143px;" width="196">
<p style="font-weight: bold;"><code>SearchMruList</code></p>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; padding: 8px; height: 143px;" width="115">
<p><span>REG_SZ</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; padding: 8px; height: 143px;" width="185">
<p><span>(empty)</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; padding: 8px; height: 143px;" width="97">
<p><span>The IP-addresses searched for via the GUI search field. A prefix is added to the searched IP represented as </span><code>[digit]-[digit]</code>. <span>It’s unknown to Hunt &amp; Hackett what the prefix represents.</span></p>
</td>
</tr>
<tr style="height: 113px;">
<td style="border: 1px solid #eff1f4; width: 22.5833%; padding: 8px; height: 113px;" width="196">
<p style="font-weight: bold;"><code>window_state</code></p>
</td>
<td style="border: 1px solid #eff1f4; width: 12.5%; padding: 8px; height: 113px;" width="115">
<p><span>REG_BINARY</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 17.4999%; padding: 8px; height: 113px;" width="185">
<p><span>40 00 42 00 79 00 74 00 64 00 41 00 …</span></p>
</td>
<td style="border: 1px solid #eff1f4; width: 47.3334%; padding: 8px; height: 113px;" width="97">
<p><span>Holds the state (dimensions) of the application windows upon closure of the application. </span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p style="padding-left: 0cm; text-align: center;"><span style="color: #ff9902;"><em><span style="font-weight: bold;">Table 3</span><span style="font-weight: normal;"> -</span>&nbsp;Overview of the AIS registry State key under HKEY_USERS hive.</em></span></p>
<h2 style="padding-left: 0cm;"><span>4. Detection</span></h2>
<p><span>Detection of the Advanced IP Scanner process is trivial. Here at Hunt &amp; Hackett, we also try to come up with better, behavioral detection methods that do not rely on static signatures for individual applications.</span></p>
<h3 style="padding-left: 0cm;"><span>4.1 Port scanning </span><span>detection using Chronicle</span></h3>
<p><span>Detection should not only focus on the characteristics of individual pieces of software, but also on behavior of applications. This means we also try to identify internal port scanning itself, and not merely the execution of Advanced IP Scanner.&nbsp;</span><span>As part of our detection engineering efforts, we experiment with custom YARA-L<a href="#sources" rel="noopener"><sup>10</sup></a> rules for Chronicle<a href="#sources" rel="noopener"><sup>11</sup></a> to detect internal port scans.</span></p>
<h4 style="padding-left: 0cm;"><span>Experimenting with horizontal port scanning detection</span></h4>
<p><span>Internal port scanning of entire ranges results in a large number of network connections from the scanning machine to other machines in a corporate network. We can use build-in functionality of Chronicle to experiment with YARA-L rules capable of detecting internal scanning behavior.</span></p>
<p><span>In large enough networks, we can attempt to detect hosts that have performed a large number of connection attempts to other internal machines, which is indicative of internal port scans.</span></p>
<p><span>The experimental YARA-L rule depicted in </span><em>Figure 3</em><span> for example triggers when a machine has made more than 100 internal connections or connection attempts within 10 minutes. Real-world testing shows that this approach can detect (some) internal port scans, though heavy tuning is required to filter out benign machines / processes that perform internal network discovery for legitimate reasons.</span></p>
<p style="text-align: center;"><span><br></span><span></span><span><img loading="lazy" src="https://www.huntandhackett.com/hs-fs/hubfs/Picture%203.png?width=655&amp;name=Picture%203.png" alt="Picture 3" width="655" style="width: 655px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.huntandhackett.com/hs-fs/hubfs/Picture%203.png?width=328&amp;name=Picture%203.png 328w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%203.png?width=655&amp;name=Picture%203.png 655w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%203.png?width=983&amp;name=Picture%203.png 983w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%203.png?width=1310&amp;name=Picture%203.png 1310w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%203.png?width=1638&amp;name=Picture%203.png 1638w, https://www.huntandhackett.com/hs-fs/hubfs/Picture%203.png?width=1965&amp;name=Picture%203.png 1965w" sizes="(max-width: 655px) 100vw, 655px"></span><span style="color: #fcaf15;"><em><span style="font-weight: bold;">Figure 3</span> - Experimental YARA-L rule for detecting internal port scans</em></span></p>
<h4 style="padding-left: 0cm;"><span>Limitations of detection attempts</span></h4>
<p><span>With some filtering effort, we can use Chronicle to detect internal port scans at customers, though this approach is impractical and requires heavy tuning. Additionally, our detection attempt is not foolproof and can be circumvented by a determined attacker.</span></p>
<p><span>Some methods of bypassing this detection attempt include:</span></p>
<ul>
<li><span>Slow scanning to circumvent any time-based detection thresholds.</span></li>
<li><span>Scanning of small IP blocks at a time to bypass any count-based thresholds.</span></li>
</ul>
<h3 style="padding-left: 0cm;"><span>4.2 Port scanning detection using Canary tokens</span></h3>
<p><span>In the previous section, we concluded that it is not feasible to detect all internal port scans using only network connections data and threshold-based detection rules. To enhance detection, we can place canary tokens at strategic places in an organization’s network. Whenever a canary token is scanned, the cyber defense center will receive an alert and an analyst can investigate why a canary token was triggered. </span></p>
<p><span>Whenever an alert is deemed malicious, this indicates an attacker is performing active reconnaissance in an organization’s network. Though, whenever a canary token is triggered, this does not automatically mean a network has been breached. Canary tokens can also be triggered by benign activities, including:</span></p>
<ul>
<li><span>Misspelled IP addresses or server names</span></li>
<li><span>Applications that (for various reasons) contain network discovery functionality</span></li>
<li><span>System administrators or other users performing network scans for legitimate reasons</span></li>
</ul>
<h2 style="padding-left: 0cm;"><span>5. Detection rules</span></h2>
<p><span>This section contains an overview of different rules in both Carbon Black as well as Yara-L format. </span></p>
<p><span>Additionally, you can find an already existing Sigma rule in the Sigma rule repository </span><code>https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_advanced_ip_scanner.yml</code><span>. For completeness the Sigma rules is listed in this section as well. </span></p>
<h3 style="padding-left: 0cm;"><span>5.1 Sigma<br></span></h3>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="border-collapse: collapse; border: 1px solid #eff1f4; width: 100%;">
<tbody>
<tr>
<td style="border: 1px solid #EFF1F4; width: 100%; background-color: #eff1f4;" width="643">
<p><code>action: global</code></p>
<p><code>title: Advanced IP Scanner</code></p>
<p><code>status: experimental</code></p>
<p><code>description: Detects the use of Advanced IP Scanner. Seems to be a popular tool for ransomware groups.</code></p>
<p><code>references:</code></p>
<p><code>&nbsp;&nbsp; - https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/</code></p>
<p><code>&nbsp;&nbsp; - https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html</code></p>
<p><code>&nbsp;&nbsp; - https://labs.f-secure.com/blog/prelude-to-ransomware-systembc</code></p>
<p><code>&nbsp;&nbsp; - https://assets.documentcloud.org/documents/20444693/fbi-pin-egregor-ransomware-bc-01062021.pdf</code></p>
<p><code>&nbsp;&nbsp; - https://thedfirreport.com/2021/01/18/all-that-for-a-coinminer</code></p>
<p><code>author: '@ROxPinTeddy'</code></p>
<p><code>date: 2020/05/12</code></p>
<p><code>modified: 2021/05/11</code></p>
<p><code>tags:</code></p>
<p><code>&nbsp;&nbsp; - attack.discovery</code></p>
<p><code>&nbsp;&nbsp; - attack.t1046</code></p>
<p><code>falsepositives:</code></p>
<p><code>&nbsp;&nbsp; - Legitimate administrative use</code></p>
<p><code>level: medium</code></p>
<p><code>---</code></p>
<p><code>id: bef37fa2-f205-4a7b-b484-0759bfd5f86f</code></p>
<p><code>logsource:</code></p>
<p><code>&nbsp;&nbsp; category: process_creation</code></p>
<p><code>&nbsp;&nbsp; product: windows</code></p>
<p><code>detection:</code></p>
<p><code>&nbsp;&nbsp; selection:</code></p>
<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Image|contains: '\advanced_ip_scanner'</code></p>
<p><code>&nbsp;&nbsp; condition: selection</code></p>
<p><code>---</code></p>
<p><code>id: fed85bf9-e075-4280-9159-fbe8a023d6fa</code></p>
<p><code>logsource:</code></p>
<p><code>&nbsp;&nbsp; category: file_event</code></p>
<p><code>&nbsp;&nbsp; product: windows</code></p>
<p><code>detection:</code></p>
<p><code>&nbsp;&nbsp; selection:</code></p>
<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TargetFilename|contains: '\AppData\Local\Temp\Advanced IP Scanner 2'</code></p>
<p><code>&nbsp;&nbsp; condition: selection</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<h3 style="padding-left: 0cm;"><span>5.2 CarbonBlack</span></h3>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="border-collapse: collapse; border: 1px solid #99acc2; width: 100%; height: 394px;">
<tbody>
<tr style="height: 91px;">
<td style="border: 1px solid #EFF1F4; width: 21%; height: 91px;" width="132">
<p><strong><span>Action</span></strong></p>
</td>
<td style="border: 1px solid #EFF1F4; width: 79%; height: 91px;" width="510">
<p><strong><span>CarbonBlack query</span></strong></p>
</td>
</tr>
<tr style="height: 181px;">
<td style="border: 1px solid #eff1f4; width: 21%; height: 181px;" width="132">
<p><strong><span>Advanced IP Scanner execution</span></strong></p>
</td>
<td style="width: 79%; height: 181px; border: 1px solid #eff1f4; background-color: #eff1f4;" width="510">
<p><code><span>(process_name:advanced_ip_scanner.exe OR process_publisher:"Famatech Corp.") OR (process_file_description:"Advanced IP Scanner" OR process_original_filename:advanced_ip_scanner.exe OR process_internal_name:"Advanced IP Scanner" OR process_product_name:"Advanced IP Scanner")</span></code></p>
</td>
</tr>
<tr style="height: 121px;">
<td style="border: 1px solid #eff1f4; width: 21%; height: 121px;" width="132">
<p><strong><span>Advanced IP Scanner registry access</span></strong></p>
</td>
<td style="width: 79%; height: 121px; border: 1px solid #eff1f4; background-color: #eff1f4;" width="510">
<p><code>regmod_name:*\\famatech\\advanced_ip_scanner\\*</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<h3>5.3 Chronicle</h3>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="border-collapse: collapse; border: 1px solid #99acc2; width: 100%;">
<tbody>
<tr>
<td style="border: solid #BFBFBF 1.0pt; width: 100%; border-color: #EFF1F4; background-color: #eff1f4;" width="642">
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>rule advanced_ip_scanner_execution {</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp; meta:</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; author = "Hunt &amp; Hackett"</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description = "Detects execution of Advanced IP Scanner"</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp; events:</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $event.metadata.event_type = "PROCESS_LAUNCH"</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp; &nbsp; &nbsp; &nbsp;($event.principal.process.file.full_path = /Advanced_IP_Scanner/ nocase or</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $event.principal.process.command_line = /Advanced_IP_Scanner/ nocase or</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $event.target.process.file.full_path = /Advanced_IP_Scanner/ nocase or</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $event.target.process.command_line = /Advanced_IP_Scanner/ nocase)</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp; condition:</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $event</span></code></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>}</span></code></p>
</td>
</tr>
<tr>
<td style="border: solid #BFBFBF 1.0pt; width: 100%; border-color: #EFF1F4; background-color: #eff1f4;" width="642">
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><code><span>rule portscan_internal_horizontal {</span></code><br><code><span> &nbsp; meta:</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; author = "Hunt &amp; Hackett"</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description = "Detects internal horizontal portscans (experimental)"<br></span></code><br><code><span> &nbsp; events:</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $e.metadata.event_type = "NETWORK_CONNECTION"</span></code><br><code><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$e.principal.ip = $src_ip</code><br><code> &nbsp;&nbsp;&nbsp; &nbsp; $e.principal.port = $src_port</code><br><code> &nbsp;&nbsp;&nbsp; &nbsp; $e.target.ip = $dest_ip</code><br><code> &nbsp;&nbsp;&nbsp; &nbsp; $e.target.port = $dest_port</code><br><br><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>// Filter on internal source IPs</span></code><br><code><span> &nbsp;&nbsp;&nbsp; &nbsp; (net.ip_in_range_cidr($e.principal.ip, "10.0.0.0/8") or<br></span><span>&nbsp; &nbsp; &nbsp; net.ip_in_range_cidr($e.principal.ip, "172.16.0.0/12") or</span></code><br><code><span>&nbsp; &nbsp; &nbsp; net.ip_in_range_cidr($e.principal.ip, "192.168.0.0/16"))</span></code><br><br><code><span>&nbsp; &nbsp; &nbsp; // Filter on internal destination IPs</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (net.ip_in_range_cidr($e.target.ip, "10.0.0.0/8") or</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; net.ip_in_range_cidr($e.target.ip, "172.16.0.0/12") or</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; net.ip_in_range_cidr($e.target.ip, "192.168.0.0/16"))</span></code><br><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Source port should be an ephemeral port </span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $src_port &gt; 20000</span></code><br><br><code><span>&nbsp; &nbsp; &nbsp; // Exclusions for tuning</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // not net.ip_in_range_cidr($e.principal.ip, "__IP_RANGE__")</span></code><br><br><code><span>&nbsp;&nbsp; match:</span></code><br><code><span> &nbsp; &nbsp; &nbsp; // Look for connections from source </span></code><br><code><span> &nbsp;&nbsp; &nbsp;&nbsp; // in time period of 10 minutes</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $src_ip over 10m</span></code><br><code><span><br> &nbsp; condition:</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Threshold on destination IPs</span></code><br><code><span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #dest_ip &gt;= 100</span></code><br><code><span>}</span></code></p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #bfbfbf; width: 100%; padding: 4px;">
<p><span>&nbsp;</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<h2 id="sources" style="padding-left: 0cm;"><span>Sources</span></h2>
<ol>
<li><span><a href="https://www.advanced-ip-scanner.com/" rel="noopener">https://www.advanced-ip-scanner.com/</a></span></li>
<li><span>Based on H2-CERT findings during IR assignment</span></li>
<li><span><a href="https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html" rel="noopener">https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html</a></span></li>
<li><span><a href="https://www.ic3.gov/Media/News/2021/210108.pdf" rel="noopener">https://www.ic3.gov/Media/News/2021/210108.pdf</a></span></li>
<li><span><a href="https://www.bankinfosecurity.com/hades-ransomware-has-targeted-7-large-companies-a-16977" rel="noopener">https://www.bankinfosecurity.com/hades-ransomware-has-targeted-7-large-companies-a-16977</a></span></li>
<li><span><a href="/blog/revil-the-usage-of-legitimate-remote-admin-tooling" rel="noopener">https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling</a></span></li>
<li><span><a href="https://www.logpoint.com/en/blog/detecting-fivehands-ransomware-at-different-stages-of-the-kill-chain/" rel="noopener">https://www.logpoint.com/en/blog/detecting-fivehands-ransomware-at-different-stages-of-the-kill-chain/</a></span></li>
<li><span><a href="https://us-cert.cisa.gov/ncas/alerts/aa20-259a" rel="noopener">https://us-cert.cisa.gov/ncas/alerts/aa20-259a</a></span></li>
<li><span><a href="https://www.crowdstrike.com/blog/targeted-dharma-ransomware-intrusions-exhibit-consistent-techniques/" rel="noopener">https://www.crowdstrike.com/blog/targeted-dharma-ransomware-intrusions-exhibit-consistent-techniques/</a></span></li>
<li><span><a href="https://cloud.google.com/chronicle/docs/detection/yara-l-2-0-syntax" rel="noopener">https://cloud.google.com/chronicle/docs/detection/yara-l-2-0-syntax</a></span></li>
<li><span><a href="https://chronicle.security/" rel="noopener">https://chronicle.security/</a></span></li>
</ol></span>
				</div>
				
			</div>
		</div>
	</div>
	
	

	
	

  <div class="atmc-divider-01-prefooter">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1920 80"><path fill="#EFF1F4" fill-opacity="1" d="M-10,0C960,90,1920,30,1930,30V90S960,30,-10,120Z"></path></svg>
	</div>
  
  <div class="dnd-section text-center" style="background-color: #EFF1F4">
    <h2 class="atmc-headline-03 atmc-headline-03-primary text-center mb-12">
      Keep me informed
    </h2>
    <p>
      <a href="/keep-me-informed/" class="cta_button atmc-btn-secondary atmc-btn-m">Sign up for the newsletter</a>
    </p>    
  </div>
  
  <div class="atmc-divider-01-footer">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1920 80"><path fill="#fcaf15" fill-opacity="1" d="M-10,0C960,60,1930,20,1930,20V60S960,20,-10,80Z"></path></svg>
	</div>
		
</div>



      <div data-global-resource-path="Hunt and Hackett/templates/partials/footer.html"><footer class="footer atmc-parallax  text-white" style="
					
            background-color:#4a5278;
					
	      ">
    
	 
    <div class="atmc-site-footer">
			<div class="atmc-container">
				<div class="row-fluid">
				
					<div class="span4 mb:mb-8">
						
						
						  <div class="">
								
								
								  
									<p><img src="https://www.huntandhackett.com/hubfs/HH_Logo_OnDark.svg" alt="HH_Logo_OnDark" width="280" style="width: 280px; margin: 0px;" loading="lazy"></p>
<p>&nbsp;</p>
								  
								
						  </div>
						
						
					</div>
				
					<div class="span8 mb:mb-8">
						
						
						  <div class="">
								
								
									
							<div class="atmc-footer_menu_HH">
              <span id="hs_cos_wrapper_footer-module_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer-module_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/hubfs/20231214_H2_privacy_statement.pdf" role="menuitem" target="_self">Privacy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/press" role="menuitem" target="_self">Press</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/jobs" role="menuitem" target="_self">Jobs</a></li>
 </ul>
</div></span>
									</div>
                								  
								
						  </div>
						
						  <div class="mt-8">
								
								
									
							<div class="atmc-footer_menu_HH">
              <span id="hs_cos_wrapper_footer-module_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer-module_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.linkedin.com/company/huntandhackett/" role="menuitem" target="_blank" rel="noopener">LinkedIn</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://twitter.com/huntandhackett" role="menuitem" target="_blank" rel="noopener">X</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://mastodon.social/@huntandhackett@mastodon.social" role="menuitem" target="_blank" rel="noopener">Mastodon</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://bsky.app/profile/huntandhackett.com" role="menuitem" target="_blank" rel="noopener">Bluesky</a></li>
 </ul>
</div></span>
									</div>
                								  
								
						  </div>
						
						
					</div>
				
			  </div>
			</div>
    </div>
	
		
		<div class="atmc-footer" style="background-color:#4a5278;">
      <div class="atmc-container">
        <div class="row-fluid">
          <div class="span7">
						<div class="footer__copyright">
							MADE IN EUROPE
						</div>
          </div>
					
						<div class="span5">
							<div class="atmc-footer_menu">
								<span id="hs_cos_wrapper_footer-module_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer-module_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com" role="menuitem" target="_self">COPYRIGHT 2025 HUNT &amp; HACKETT</a></li>
 </ul>
</div></span>
							</div>
						</div>
					
        </div>
      </div>
    </div>

		
	
</footer></div>
    </div>
    
		
		
    
		
		
		
		
		
		
		
    
		
    
		
		
    
    
    
		
		
		
    

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.huntandhackett.com/hs-fs/hubfs/hub_generated/module_assets/1/33930691666/1742402465615/module_Atomic_-_Header.min.js"></script>
<script src="/hs/hsstatic/keyboard-accessible-menu-flyouts/static-1.17/bundles/project.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.matchHeight/0.7.2/jquery.matchHeight-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://www.huntandhackett.com/hs-fs/hubfs/hub_generated/template_assets/1/33930818457/1742399593381/template_main.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.huntandhackett.com\/blog\/advanced-ip-scanner-the-preferred-scanner-in-the-apt-toolbox"]);
_hsq.push(["setPageId", "57866858903"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 57866858903,
    "legacyPageId": "57866858903",
    "contentFolderId": null,
    "contentGroupId": 33584457015,
    "abTestId": null,
    "languageVariantId": 57866858903,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/8272645.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "1e832536-9cd8-487a-a737-4891840e1a58",
    ticks: 1742475073602,
    page_id: 57866858903,
    
    content_group_id: 33584457015,
    portal_id: 8272645,
    app_hs_base_url: "https://app-eu1.hubspot.com",
    cp_hs_base_url: "https://cp-eu1.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "57866858903",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>






<script type="text/javascript">
_linkedin_partner_id = "3581561";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(l) {
if (!l){window.lintrk = function(a,b){window.lintrk.q.push([a,b])};
window.lintrk.q=[]}
var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})(window.lintrk);
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=3581561&amp;fmt=gif">
</noscript>

<style>
/* Increase cookie bar font size on mobile */
/* This can only be fixed here */
@media screen and (max-width: 480px) {
	div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p { font-size: 14px !important; }
}
</style>
<style>
/* Increase cookie bar font size on mobile */
/* This can only be fixed here */
@media screen and (max-width: 480px) {
	div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p { font-size: 14px !important; }
}
</style>
<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 



    <style>
      #loadOverlay{display: none;}
    </style>
  
</body></html>